{"version":3,"sources":["node_modules/socialcalc/SocialCalc.js","third-party/class-js/lib/Class.js","third-party/wikiwyg/lib/Document/Emitter.js","third-party/wikiwyg/lib/Document/Emitter/HTML.js","third-party/wikiwyg/lib/Document/Parser.js","third-party/wikiwyg/lib/Document/Parser/Wikitext.js","static/jquery.js","static/vex.combined.min.js"],"names":["root","factory","define","amd","console","log","bind","this","module","exports","call","SocialCalc","window","Constants","cellDataType","v","n","t","f","c","textdatadefaulttype","s_BrowserNotSupported","s_InternalError","s_pssUnknownColType","s_pssUnknownRowType","s_pssUnknownLineType","s_cfspUnknownCellType","doCanonicalizeSheet","s_escUnknownSheetCmd","s_escUnknownSetCoordCmd","s_escUnknownCmd","s_caccCircRef","defaultRowNameWidth","defaultAssumedRowHeight","defaultCellIDPrefix","defaultCellLayout","defaultCellFontStyle","defaultCellFontSize","defaultCellFontFamily","defaultPaneDividerWidth","defaultPaneDividerHeight","defaultGridCSS","defaultCommentClass","defaultCommentStyle","defaultCommentNoGridClass","defaultCommentNoGridStyle","defaultReadonlyClass","defaultReadonlyStyle","defaultReadonlyNoGridClass","defaultReadonlyNoGridStyle","defaultReadonlyComment","defaultColWidth","defaultMinimumColWidth","defaultHighlightTypeCursorClass","defaultHighlightTypeCursorStyle","defaultHighlightTypeRangeClass","defaultHighlightTypeRangeStyle","defaultColnameClass","defaultColnameStyle","defaultSelectedColnameClass","defaultSelectedColnameStyle","defaultRownameClass","defaultRownameStyle","defaultSelectedRownameClass","defaultSelectedRownameStyle","defaultUpperLeftClass","defaultUpperLeftStyle","defaultSkippedCellClass","defaultSkippedCellStyle","defaultPaneDividerClass","defaultPaneDividerStyle","defaultUnhideLeftClass","defaultUnhideLeftStyle","defaultUnhideRightClass","defaultUnhideRightStyle","defaultUnhideTopClass","defaultUnhideTopStyle","defaultUnhideBottomClass","defaultUnhideBottomStyle","defaultColResizeBarClass","defaultRowResizeBarClass","s_rcMissingSheet","defaultLinkFormatString","defaultPageLinkFormatString","defaultFormatp","defaultFormatc","defaultFormatdt","defaultFormatd","defaultFormatt","defaultDisplayTRUE","defaultDisplayFALSE","defaultImagePrefix","defaultTableEditorIDPrefix","defaultPageUpDnAmount","AllowCtrlS","defaultTableControlThickness","cteGriddivClass","s_statusline_executing","s_statusline_displaying","s_statusline_ordering","s_statusline_calculating","s_statusline_calculatingls","s_statusline_doingserverfunc","s_statusline_incell","s_statusline_calcstart","s_statusline_sum","s_statusline_recalcneeded","s_statusline_circref","s_statusline_sendemail","s_inputboxdisplaymultilinetext","defaultInputEchoClass","defaultInputEchoStyle","defaultInputEchoPromptClass","defaultInputEchoPromptStyle","defaultInputEchoHintClass","defaultInputEchoHintStyle","ietUnknownFunction","CH_radius1","CH_radius2","s_CHfillAllTooltip","s_CHfillContentsTooltip","s_CHmovePasteAllTooltip","s_CHmovePasteContentsTooltip","s_CHmoveInsertAllTooltip","s_CHmoveInsertContentsTooltip","s_CHindicatorOperationLookup","Fill","FillC","Move","MoveI","MoveC","MoveIC","s_CHindicatorDirectionLookup","Down","Right","Horizontal","Vertical","defaultTCSliderThickness","defaultTCButtonThickness","defaultTCThumbThickness","TCmainStyle","TCmainClass","TCendcapStyle","TCendcapClass","TCpanesliderClass","s_panesliderTooltiph","s_panesliderTooltipv","TClessbuttonStyle","TClessbuttonClass","TClessbuttonRepeatWait","TClessbuttonRepeatInterval","TCmorebuttonStyle","TCmorebuttonClass","TCmorebuttonRepeatWait","TCmorebuttonRepeatInterval","TCscrollareaStyle","TCscrollareaClass","TCscrollareaRepeatWait","TCscrollareaRepeatInterval","TCthumbClass","TCthumbStyle","TCPStrackinglineClass","TCPStrackinglineStyle","TCPStrackinglineThickness","TCTDFSthumbstatusvClass","TCTDFSthumbstatusvStyle","TCTDFSthumbstatushClass","TCTDFSthumbstatushStyle","TCTDFSthumbstatusrownumClass","TCTDFSthumbstatusrownumStyle","TCTDFStopOffsetv","TCTDFSleftOffsetv","s_TCTDFthumbstatusPrefixv","TCTDFStopOffseth","TCTDFSleftOffseth","s_TCTDFthumbstatusPrefixh","TooltipOffsetX","TooltipOffsetY","TDpopupElementClass","TDpopupElementStyle","SCToolbarbackground","SCTabbackground","SCTabselectedCSS","SCTabplainCSS","SCToolbartext","SCFormulabarheight","SCStatuslineheight","SCStatuslineCSS","SCFormatNumberFormats","SCFormatTextFormats","SCFormatPadsizes","SCFormatFontsizes","SCFormatFontfamilies","SCFormatFontlook","SCFormatTextAlignhoriz","SCFormatNumberAlignhoriz","SCFormatAlignVertical","SCFormatColwidth","SCFormatRecalc","SCFormatUserMaxCol","SCFormatUserMaxRow","ISCButtonNormalBackground","ISCButtonBorderNormal","ISCButtonBorderHover","ISCButtonBorderDown","ISCButtonDownBackground","s_PopupListCancel","s_PopupListCustom","s_loc_align_center","s_loc_align_left","s_loc_align_right","s_loc_alignment","s_loc_audit","s_loc_audit_trail_this_session","s_loc_auto","s_loc_auto_sum","s_loc_auto_wX_commas","s_loc_automatic","s_loc_background","s_loc_bold","s_loc_bold_XampX_italics","s_loc_bold_italic","s_loc_borders","s_loc_borders_off","s_loc_borders_on","s_loc_bottom","s_loc_bottom_border","s_loc_cell_settings","s_loc_csv_format","s_loc_cancel","s_loc_category","s_loc_center","s_loc_clear","s_loc_clear_socialcalc_clipboard","s_loc_clipboard","s_loc_color","s_loc_column_","s_loc_comment","s_loc_copy","s_loc_custom","s_loc_cut","s_loc_default","s_loc_default_alignment","s_loc_default_column_width","s_loc_default_font","s_loc_default_format","s_loc_default_padding","s_loc_delete","s_loc_delete_column","s_loc_delete_contents","s_loc_delete_row","s_loc_description","s_loc_display_clipboard_in","s_loc_down","s_loc_edit","s_loc_existing_names","s_loc_family","s_loc_fill_down","s_loc_fill_right","s_loc_font","s_loc_format","s_loc_formula","s_loc_function_list","s_loc_functions","s_loc_grid","s_loc_hidden","s_loc_hide_column","s_loc_hide_row","s_loc_horizontal","s_loc_insert_column","s_loc_insert_row","s_loc_italic","s_loc_last_sort","s_loc_left","s_loc_left_border","s_loc_link","s_loc_link_input_box","s_loc_list","s_loc_load_socialcalc_clipboard_with_this","s_loc_lock_cell","s_loc_major_sort","s_loc_manual","s_loc_merge_cells","s_loc_middle","s_loc_minor_sort","s_loc_move_insert","s_loc_move_paste","s_loc_multiXline_input_box","s_loc_name","s_loc_names","s_loc_no_padding","s_loc_normal","s_loc_number","s_loc_number_horizontal","s_loc_ok","s_loc_padding","s_loc_page_name","s_loc_paste","s_loc_paste_formats","s_loc_plain_text","s_loc_recalc","s_loc_recalculation","s_loc_redo","s_loc_right","s_loc_right_border","s_loc_sheet_settings","s_loc_save","s_loc_save_to","s_loc_set_cell_contents","s_loc_set_cells_to_sort","s_loc_set_value_to","s_loc_set_to_link_format","s_loc_setXclear_move_from","s_loc_show_cell_settings","s_loc_show_sheet_settings","s_loc_show_in_new_browser_window","s_loc_size","s_loc_socialcalcXsave_format","s_loc_sort","s_loc_sort_","s_loc_sort_cells","s_loc_swap_colors","s_loc_tabXdelimited_format","s_loc_text","s_loc_text_horizontal","s_loc_this_is_aXbrXsample","s_loc_top","s_loc_top_border","s_loc_undone_steps","s_loc_url","s_loc_undo","s_loc_unlock_cell","s_loc_unmerge_cells","s_loc_up","s_loc_value","s_loc_vertical","s_loc_wikitext","s_loc_workspace","s_loc_XnewX","s_loc_XnoneX","s_loc_Xselect_rangeX","SVStatuslineheight","SVStatuslineCSS","FormatNumber_separatorchar","FormatNumber_decimalchar","FormatNumber_defaultCurrency","s_FormatNumber_daynames","s_FormatNumber_daynames3","s_FormatNumber_monthnames","s_FormatNumber_monthnames3","s_FormatNumber_am","s_FormatNumber_am1","s_FormatNumber_pm","s_FormatNumber_pm1","s_parseerrexponent","s_parseerrchar","s_parseerrstring","s_parseerrspecialvalue","s_parseerrtwoops","s_parseerrmissingopenparen","s_parseerrcloseparennoopen","s_parseerrmissingcloseparen","s_parseerrmissingoperand","s_parseerrerrorinformula","s_calcerrerrorvalueinformula","s_parseerrerrorinformulabadval","s_formularangeresult","s_calcerrnumericnan","s_calcerrnumericoverflow","s_sheetunavailable","s_calcerrcellrefmissing","s_calcerrsheetnamemissing","s_circularnameref","s_calcerrunknownname","s_calcerrincorrectargstofunction","s_sheetfuncunknownfunction","s_sheetfunclnarg","s_sheetfunclog10arg","s_sheetfunclogsecondarg","s_sheetfunclogfirstarg","s_sheetfuncroundsecondarg","s_sheetfuncddblife","s_sheetfuncslnlife","s_fdef_ABS","s_fdef_ACOS","s_fdef_AND","s_fdef_ASIN","s_fdef_ATAN","s_fdef_ATAN2","s_fdef_AVERAGE","s_fdef_CHOOSE","s_fdef_COLUMNS","s_fdef_COS","s_fdef_COUNT","s_fdef_COUNTA","s_fdef_COUNTBLANK","s_fdef_COUNTIF","s_fdef_DATE","s_fdef_DAVERAGE","s_fdef_DAY","s_fdef_DCOUNT","s_fdef_DCOUNTA","s_fdef_DDB","s_fdef_DEGREES","s_fdef_DGET","s_fdef_DMAX","s_fdef_DMIN","s_fdef_DPRODUCT","s_fdef_DSTDEV","s_fdef_DSTDEVP","s_fdef_DSUM","s_fdef_DVAR","s_fdef_DVARP","s_fdef_EVEN","s_fdef_EXACT","s_fdef_EXP","s_fdef_FACT","s_fdef_FALSE","s_fdef_FIND","s_fdef_FV","s_fdef_HLOOKUP","s_fdef_HOUR","s_fdef_IF","s_fdef_INDEX","s_fdef_INT","s_fdef_IRR","s_fdef_ISBLANK","s_fdef_ISERR","s_fdef_ISERROR","s_fdef_ISLOGICAL","s_fdef_ISNA","s_fdef_ISNONTEXT","s_fdef_ISNUMBER","s_fdef_ISTEXT","s_fdef_LEFT","s_fdef_LEN","s_fdef_LN","s_fdef_LOG","s_fdef_LOG10","s_fdef_LOWER","s_fdef_MATCH","s_fdef_MAX","s_fdef_MID","s_fdef_MIN","s_fdef_MINUTE","s_fdef_MOD","s_fdef_MONTH","s_fdef_N","s_fdef_NA","s_fdef_NOT","s_fdef_NOW","s_fdef_NPER","s_fdef_NPV","s_fdef_ODD","s_fdef_OR","s_fdef_PI","s_fdef_PMT","s_fdef_POWER","s_fdef_PRODUCT","s_fdef_PROPER","s_fdef_PV","s_fdef_RADIANS","s_fdef_RATE","s_fdef_REPLACE","s_fdef_REPT","s_fdef_RIGHT","s_fdef_ROUND","s_fdef_ROWS","s_fdef_SECOND","s_fdef_SIN","s_fdef_SLN","s_fdef_SQRT","s_fdef_STDEV","s_fdef_STDEVP","s_fdef_SUBSTITUTE","s_fdef_SUM","s_fdef_SUMIF","s_fdef_SYD","s_fdef_T","s_fdef_TAN","s_fdef_TIME","s_fdef_TODAY","s_fdef_TRIM","s_fdef_TRUE","s_fdef_TRUNC","s_fdef_UPPER","s_fdef_VALUE","s_fdef_VAR","s_fdef_VARP","s_fdef_VLOOKUP","s_fdef_WEEKDAY","s_fdef_YEAR","s_fdef_SUMPRODUCT","s_fdef_CEILING","s_fdef_FLOOR","s_farg_v","s_farg_vn","s_farg_xy","s_farg_choose","s_farg_range","s_farg_rangec","s_farg_date","s_farg_dfunc","s_farg_ddb","s_farg_find","s_farg_fv","s_farg_hlookup","s_farg_iffunc","s_farg_index","s_farg_irr","s_farg_tc","s_farg_log","s_farg_match","s_farg_mid","s_farg_nper","s_farg_npv","s_farg_pmt","s_farg_pv","s_farg_rate","s_farg_replace","s_farg_vp","s_farg_valpre","s_farg_csl","s_farg_cslp","s_farg_subs","s_farg_sumif","s_farg_hms","s_farg_txt","s_farg_vlookup","s_farg_weekday","s_farg_dt","s_farg_rangen","s_farg_vsig","function_classlist","s_fclass_all","s_fclass_stat","s_fclass_lookup","s_fclass_datetime","s_fclass_financial","s_fclass_test","s_fclass_math","s_fclass_text","s_fclass_action","s_fclass_gui","lastone","ConstantsDefaultClasses","defaultComment","defaultCommentNoGrid","defaultHighlightTypeCursor","defaultHighlightTypeRange","defaultColname","defaultSelectedColname","defaultRowname","defaultSelectedRowname","defaultUpperLeft","defaultSkippedCell","defaultPaneDivider","cteGriddiv","defaultInputEcho","classname","style","TCmain","TCendcap","TCpaneslider","TClessbutton","TCmorebutton","TCscrollarea","TCthumb","TCPStrackingline","TCTDFSthumbstatus","TDpopupElement","ConstantsSetClasses","prefix","item","defaults","scc","undefined","ConstantsSetImagePrefix","imagePrefix","replace","Callbacks","expand_wiki","expand_markup","displayvalue","sheetobj","linkstyle","default_expand_markup","MakePageLink","NormalizeSheetName","Cell","coord","datavalue","datatype","formula","valuetype","readonly","CellProperties","errors","comment","bt","br","bb","bl","layout","font","color","bgcolor","cellformat","nontextvalueformat","textvalueformat","colspan","rowspan","cssc","csss","mod","displaystring","parseinfo","hcolspan","hrowspan","CellPropertiesTable","Sheet","ResetSheet","statuscallback","statuscallbackparams","sheet","cells","attribs","lastcol","lastrow","defaultlayout","usermaxcol","usermaxrow","rowattribs","hide","height","colattribs","width","names","layouts","layouthash","fonts","fonthash","colors","colorhash","borderstyles","borderstylehash","cellformats","cellformathash","valueformats","valueformathash","matched_cells","selected_search_cell","copiedfrom","changes","UndoStack","renderneeded","changedrendervalues","recalcchangedavalue","hiddencolrow","sci","SheetCommandInfo","ioEventTree","ioParameterList","prototype","AddCell","newcell","LastCol","last_col","cell_id","cr","coordToCr","col","LastRow","last_row","row","GetAssuredCell","ParseSheetSave","savedsheet","CellFromStringParts","cell","parts","j","CreateSheetSave","range","canonicalize","CellToString","CanonicalizeSheet","full","EncodeCellAttributes","EncodeSheetAttributes","DecodeCellAttributes","DecodeSheetAttributes","ScheduleSheetCommands","cmd","saveundo","SheetUndo","SheetRedo","CreateAuditString","GetStyleNum","atype","GetStyleString","num","RecalcSheet","line","i","name","lines","split","length","defaultcolwidth","defaultrowheight","defaulttextformat","defaultnontextformat","defaultfont","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","circularreferencecell","recalc","needsrecalc","decodeFromSave","toUpperCase","desc","definition","match","alert","charAt","ro","toLowerCase","sheetfields","sheetfieldsshort","sheetfieldsxlat","sheetfieldsxlatshort","sheetfieldsxlatxlt","cr1","cr2","value","prange","result","xlt","ParseRange","maxrow","maxcol","push","crToCoord","rcColname","encodeForSave","newborderstyles","newcellformats","newcolors","newfonts","newlayouts","newvalueformats","namesorder","join","r","b","l","borderstylesxlat","layoutsxlat","fontsxlat","colorsxlat","cellformatsxlat","valueformatsxlat","filled","an","a","newa","newxlat","used","ahash","alist","sort","Array","colorsUsed","borderstylesUsed","fontsUsed","layoutsUsed","cellformatsUsed","valueformatsUsed","unshift","InitAttrib","def","val","InitAttribs","namelist","SetAttrib","SetAttribStar","rowheight","newattribs","changed","CheckChanges","attribname","oldval","cmdname","DoCmd","cmdstr","str","alignvert","padtop","padright","padbottom","padleft","fontlook","fontsize","fontfamily","timerobj","firsttimerdelay","timerdelay","maxtimeslice","CmdExtensionCallbacks","parseobj","Parse","PushChange","setTimeout","SheetCommandsTimerRoutine","errortext","starttime","Date","EOF","ExecuteSheetCommand","NextLine","increment_amount","down","valid_datatype","type","editor","GetSpreadsheetControlObject","range2","returnval","hasrange","startcell","endcell","bottom","top","left","right","Range2Remove","cmd1","rest","what","attrib","pos","pos2","undostart","fillright","rowstart","colstart","crbase","rowoffset","coloffset","basecell","clipsheet","cliprange","numcols","numrows","attribtable","colend","rowend","newcolstart","newrowstart","newcolend","newrowend","rownext","colnext","colthis","rowbefore","colbefore","oldformula","oldcr","cols","dirs","lastsortcol","sortlist","sortcells","sortvalues","sorttypes","sortfunction","valtype","originalrow","sortedcr","v1","v2","cmdextension","undoNum","trackLine","cellProperties","RestOfStringNoMove","AddDo","NextToken","RestOfString","AddUndo","test","indexOf","substring","celldisplayneeded","Clipboard","clipboard","inc","OffsetFormulaCoords","Math","max","slast","a1","b1","ta","cresult","tb","AdjustFormulaCoords","tempRenderContext","RenderContext","CalculateCellSkipData","cellsToExpand","skipCell","cellskip","skipCellCR","mergerCellCoords","cellsToShrink","mergerCellCR","coordToCR","movingcells","dest","destcr","inserthoriz","insertvert","pushamount","movedto","ReplaceFormulaCoords","recalconce","parseInt","context","rowpanes","first","timeout","SetRowPaneFirstLast","griddiv","document","getElementById","removeChild","FitToEditTable","colpanes","SetColPaneFirstLast","func","data","tos","TOS","undo","Undo","didredo","Redo","command","stack","ttext","ttype","newcr","updatedformula","scf","Formula","tokentype","TokenType","token_op","op","token_string","string","token_coord","tokenOpExpansion","TokenOpExpansion","ParseFormulaIntoTokens","text","sheetref","RecalcInfo","currentState","state","idle","start_calc","order","calc","start_wait","done_wait","recalctimer","timeslicedelay","queue","LoadSheet","RecalcData","inrecalc","celllist","celllistitem","calclist","calclistlength","firstcalc","lastcalc","nextcalc","count","checkinfo","RecalcCheckInfo","oldcoord","parsepos","inrange","inrangestart","c1","c2","r1","r2","scri","FreshnessInfoReset","RecalcClearTimeout","RecalcSetTimeout","RecalcTimerRoutine","clearTimeout","RecalcLoadedSheet","sheetname","recalcneeded","live","AddSheetToCache","SheetCache","waitingForLoading","previousrecalcsheet","eresult","err","status","recalcdata","do_statuscallback","arg","RecalcCheckCell","total","evaluate_parsed_formula","RemoteFunctionInfo","waitingForServer","funcname","error","FreshnessInfo","recalc_completed","shift","startcoord","rangecoord","coordvals","token_name","mainloop","LookupName","delimiter","lineEnd","pos1","oldpos","maxRedo","maxUndo","pop","args","arguments","hideRowsCols","showGrid","showRCHeaders","rownamewidth","pixelsPerRow","colwidth","totalwidth","totalheight","colunhideleft","colunhideright","rowunhidetop","rowunhidebottom","highlights","cursorsuffix","highlightTypes","cursor","className","cursorinsertup","cursorinsertleft","cellIDprefix","defaultlinkstyle","defaultHTMLlinkstyle","defaultfontstyle","defaultfontsize","defaultfontfamily","defaultpanedividerwidth","defaultpanedividerheight","gridCSS","commentClassName","commentCSS","commentNoGridClassName","commentNoGridCSS","readonlyClassName","readonlyCSS","readonlyNoGridClassName","readonlyNoGridCSS","readonlyComment","classnames","colname","rowname","selectedcolname","selectedrowname","upperleft","skippedcell","panedivider","unhideleft","unhideright","unhidetop","unhidebottom","colresizebar","rowresizebar","explicitStyles","needcellskip","needprecompute","last","PrecomputeSheetFontsAndLayouts","CalculateColWidthData","CalculateRowHeightData","panenum","CoordInPane","rowpane","colpane","CellInPane","InitializeTable","tableobj","RenderSheet","oldtable","RenderColGroup","RenderColHeaders","RenderSizingRow","RenderRow","rownum","RenderSpacingRow","RenderCell","colnum","noElement","layoutre","dparts","sparts","s","weight","size","family","skiprow","skipcol","skipcoord","borderCollapse","cellSpacing","cellPadding","newrow","colgroupobj","tbodyobj","parentnode","createElement","appendChild","parentNode","replaceChild","newcol","newdiv","cssText","verticalAlign","innerHTML","container","position","unhide","fixPosition","resizeBar","overflow","w","span","sheetattribs","stylestr","CreatePseudoElement","id","colSpan","rowSpan","FormatValueForDisplay","title","classList","add","setStyles","panerowlimits","panecollimits","collow","colhigh","floor","String","fromCharCode","letters","coordToCol","coordToRow","ch","charCodeAt","decodeFromAjax","special_chars","Lookup","list","element","part","GetViewportInfo","innerWidth","innerHeight","horizontalScroll","pageXOffset","verticalScroll","pageYOffset","documentElement","clientWidth","clientHeight","scrollLeft","scrollTop","body","GetElementPosition","offsetLeft","offsetTop","GetComputedStyle","offsetParent","GetElementPositionWithScroll","rect","getBoundingClientRect","GetElementFixedParent","tagName","computedStyle","currentStyle","defaultView","getComputedStyle","LookupElement","array","AssignID","obj","idPrefix","GetCellContents","cellobj","valueformat","valuesubtype","valueinputwidget","formula_name","html_display_value","html_formated_value","format_text_for_display","format_number_for_display","formula_details","FunctionList","cell_html","checkedValue","rawvalue","dvsc","dvue","textval","encodeURI","expand_text_link","u","FormatNumber","formatNumberWithFormat","DetermineValueType","tvalue","matches","year","hour","minute","second","denom","intgr","constr","isNaN","slice","navigator","convert_date_gregorian_to_julian","InputConstants","TRUE","FALSE","#N/A","#NULL!","#NUM!","#DIV/0!","#VALUE!","#REF!","#NAME?","url","ParseCellLinkText","pagename","newwin","workspacename","workspace","pageform","urlend","descstart","lastlt","lastIndexOf","lastbrkt","lastbrace","descend","wsend","ConvertSaveToOtherFormat","savestr","outputformat","dorecalc","clipextents","div","ele","ConvertOtherFormatToSave","inputstr","inputformat","inquote","maxc","SetConvertedCell","TableEditor","toplevel","fullgrid","noEdit","tablewidth","tableheight","inputBox","inputEcho","verticaltablecontrol","horizontaltablecontrol","logo","cellhandles","busy","ensureecell","deferredCommands","deferredEmailCommands","gridposition","headposition","firstscrollingrow","firstscrollingrowtop","lastnonscrollingrow","lastvisiblerow","firstscrollingcol","firstscrollingcolleft","lastnonscrollingcol","lastvisiblecol","rowpositions","colpositions","ecell","workingvalues","imageprefix","pageUpDnAmount","recalcFunction","EditorSheetStatusCallback","ctrlkeyFunction","charname","sel","cliptext","pasteTextarea","GetEditorCellElement","ECellReadonly","EditorScheduleSheetCommands","display","focus","select","blur","KeyboardFocus","pastescclipboard","clipstr","ntvf","newntvf","prompt","CtrlSEditor","StatusCallback","MoveECellCallback","RangeChangeCallback","SettingsCallbacks","CreateTableEditor","ResizeTableEditor","SaveEditorSettings","LoadEditorSettings","flags","EditorRenderSheet","ignorebusy","EditorStepSet","GetStatuslineString","params","EditorGetStatuslineString","EditorMouseRegister","EditorMouseUnregister","EditorMouseRange","EditorProcessKey","e","EditorAddToInput","DisplayCellContents","EditorDisplayCellContents","EditorSaveEdit","EditorApplySetCommandsToRange","cmdline","MoveECellWithKey","MoveECell","_app","ReplaceCell","UpdateCellCSS","SetECellHeaders","selected","EnsureECellVisible","RangeAnchor","RangeExtend","RangeRemove","CalculateEditorPositions","ScheduleRender","renderwidgets","widgetsClean","DoRenderStep","SchedulePositionCalculations","DoPositionCalculations","CalculateRowPositions","positions","sizes","CalculateColPositions","ScrollRelative","vertical","amount","ScrollRelativeBoth","vamount","hamount","PageRelative","direction","LimitLastPanes","ScrollTableUpOneRow","ScrollTableDownOneRow","ScrollTableLeftOneCol","ScrollTableRightOneCol","StopPropagation","SetMouseMoveUp","RemoveMouseMoveUp","TableControl","CreateTableControl","main","table","tbody","tr","td","layouttable","background","TooltipRegister","firstChild","InputEcho","CellHandles","userAgent","removeEventListener","SafariPasteFunction","addEventListener","MouseWheelRegister","WheelMove","EditorProcessMouseWheel","KeyboardSetFocus","preventDefault","setting","anchorcoord","save","anchorrow","anchorcol","load","reRenderCellList","index","prevvaluetype","cmdTokens","TriggerIoAction","Email","dcmd","signalstatus","emailcmd","sstr","progress","circ","sum","emailing","emailreponse","calculating","EditorMouseInfo","registeredElements","ignore","mousedowncoord","mouselastcoord","mouseresizecol","mouseresizeclientx","mouseresizedisplay","mouseinfo","ProcessEditorMouseDown","ProcessEditorDblClick","attachEvent","oldelement","detachEvent","splice","event","stopPropagation","cancelBubble","returnValue","move","up","setCapture","releaseCapture","mobj","target","srcElement","clientX","clientY","GridMousePosition","rowheader","rowselect","ProcessEditorRowselectMouseDown","ProcessEditorRowsizeMouseDown","colheader","colselect","ProcessEditorColselectMouseDown","ProcessEditorColsizeMouseDown","shiftKey","CmdGotFocus","clickedCell","cell_widget","ProcessEditorMouseMove","ProcessEditorMouseUp","inputtext","wval","GetText","partialexpr","SetText","Blur","ShowInputBox","ShowCellHandles","SetDragAutoRepeat","mouseresizecolnum","coltoresize","mousedownclientx","mousecoltounhide","coltounhide","sizedisplay","zIndex","lastChild","childNodes","ProcessEditorColsizeMouseMove","ProcessEditorColsizeMouseUp","newsize","FinishColRowSize","coord1","coord2","coord3","ProcessEditorRowselectMouseMove","ProcessEditorRowselectMouseUp","ProcessEditorColselectMouseMove","ProcessEditorColselectMouseUp","spreadsheetDiv","offsetHeight","mouseresizerownum","rowtoresize","mouseresizerow","mousedownclienty","mouserowtounhide","rowtounhide","ProcessEditorRowsizeMouseMove","ProcessEditorRowsizeMouseUp","AutoRepeatInfo","timer","repeatinterval","repeatcallback","callback","repeatinfo","rowfooter","colfooter","distance","DragAutoRepeat","EditorOpenCellEdit","disabled","Focus","Select","ecoord","erow","ecol","substr","skipOne","valueinfo","fch","oldvalue","EditedTriggerCell","actionFormulaCells","editedCellRef","actionCellId","parameters","function_name","delta","mousewheelinfo","wobj","functionobj","ceil","offsetWidth","controlborder","headerColOffset","headerRowOffset","rowindex","colindex","shifted","min","newelement","headercell","totalrows","needed","ComputeTableControlPositions","PositionTableControlElements","toprow","offset","trowobj","leftcol","cellposition","dv","dh","vplen","vlimit","hplen","hlimit","newfirst","totalsize","current","panes","lastpane","lastvisible","sizearray","defaultsize","plen","oldrownum","newbottomrow","oldchild","bottomrownum","rowneedsrefresh","maxrowspan","newrownum","insertBefore","InputBox","onmousedown","InputBoxOnMouseDown","formulabar","InputBoxDisplayCellContents","show","ShowInputEcho","newtext","InputBoxFocus","selection","createRange","duplicate","moveToElementText","collapse","selectionStart","selectionEnd","inputbox","Keyboard","focusTable","interval","hint","functionbox","DragRegister","MouseDown","DragFunctionStart","MouseMove","DragFunctionPosition","MouseUp","Disabled","positionobj","SetInputEchoText","inputecho","clearInterval","setInterval","InputEchoHeartbeat","fname","fstr","newstr","FillFunctionInfo","FunctionArgString","InputEchoMouseDown","noCursorSuffix","movedmouse","draghandle","imagetype","dragpalette","dragtooltip","fillinghandle","CellHandlesMouseMoveOnHandle","CellHandlesMouseDown","moveshow","doshow","colinc","rowinc","mouseDown","whichhandle","SegmentDivHit","CellHandlesHoverTimeout","tooltipstimer","tooltipswhichhandle","CellHandlesTooltipsTimeout","segtable","divWithMouseHit","x","y","len","sqrt","pow","quadrant","dragtype","filltype","startingcoord","startingX","startingY","CellHandlesMouseMove","CellHandlesMouseUp","crstart","crend","CellHandlesDragAutoRepeat","abs","newcoord","vscroll","hscroll","cstr","cmdtype","cmdtype2","sizec","sizer","deltac","deltar","endcap","paneslider","lessbutton","morebutton","scrollarea","thumb","endcapstart","panesliderstart","lessbuttonstart","morebuttonstart","scrollareastart","scrollareaend","scrollareasize","thumbpos","controlthickness","sliderthickness","buttonthickness","thumbthickness","minscrollingpanesize","control","functions","etype","vh","backgroundImage","TCPSDragFunctionStart","TCPSDragFunctionMove","TCPSDragFunctionStop","repeatwait","normalstyle","downstyle","hoverstyle","Repeat","ButtonRegister","ScrollAreaClick","TCTDragFunctionStart","TCTDragFunctionMove","TCTDragFunctionStop","buttoninfo","bobj","clickpos","border","realend","draginfo","dobj","trackingline","offsetY","offsetX","thumbstatus","rowmsgele","rowpreviewele","thumbcontext","pane","TCTDragFunctionRowSetStatus","msg","thumbrowshown","DragInfo","draggingElement","startX","startY","startZ","relativeOffset","horizontal","parent","DragMouseDown","DragUnregister","DragMouseMove","DragMouseUp","TooltipInfo","registered","tooltipElement","popupElement","tiptext","tooltipinfo","TooltipMouseMove","tobj","TooltipHide","ButtonInfo","buttonDown","TooltipWaitDone","TooltipMouseDown","TooltipDisplay","offsetx","offsety","viewport","buttonElement","doingHover","paramobj","ButtonMouseDown","ButtonMouseOver","ButtonMouseOut","MouseOver","MouseOut","ButtonMouseUp","ButtonRepeat","MouseWheelInfo","ProcessMouseWheel","passThru","wheelDelta","detail","keyboardTables","specialKeysCommon",8,9,13,25,27,33,34,35,36,37,38,39,40,45,46,113,"specialKeysIE","controlKeysIE",67,83,86,88,90,"specialKeysOpera","controlKeysOpera","specialKeysSafari",63232,63233,63234,63235,63272,63273,63275,63276,63277,63237,"controlKeysSafari",99,115,118,120,122,"ignoreKeysSafari",63236,63238,63239,63240,63241,63242,63243,63244,63245,63246,63247,63289,"specialKeysFirefox","controlKeysFirefox","ignoreKeysFirefox",16,17,18,20,19,44,91,92,112,114,116,117,119,121,123,144,145,224,"areListener","didProcessKey","statusFromProcessKey","repeatingKeyPress","chForProcessKey","onkeydown","ProcessKeyDown","onkeypress","ProcessKeyPress","kt","which","keyCode","ctrlKey","ProcessKey","metaKey","charCode","ft","format_definitions","separatorchar","decimalchar","daynames","daynames3","monthnames3","monthnames","allowedcolors","BLACK","BLUE","CYAN","GREEN","MAGENTA","RED","WHITE","YELLOW","alloweddates","H","M","MM","S","SS","commands","copy","integer_placeholder","fraction_placeholder","decimal","currency","general","separator","date","comparison","section","datevalues","julian_offset","seconds_in_a_day","seconds_in_an_hour","format_string","currency_char","operandstr","fromend","cval","operandstrlc","startval","estartval","hrs","mins","secs","ehrs","emins","esecs","ampmstr","ymd","minOK","thisformat","gotcomparison","compop","compval","cpos","oppos","sectioninfo","decimalscale","scaledvalue","strvalue","strparts","integervalue","fractionvalue","integerdigits2","integerpos","fractionpos","textcolor","textstyle","scfn","isFinite","negativevalue","zerovalue","FormatNumber_DefaultCurrency","parse_format_string","hascomparison","operators","operands","commas","percent","fractiondigits","integerdigits","hasdate","convert_date_julian_to_gregorian","mspos","sectionstart","thousandssep","factor","LOG10E","day","month","format_defs","lastwasinteger","lastwasslash","lastwasasterisk","lastwasunderscore","quotestr","inbracket","bracketstr","bracketdata","ingeneral","indate","chpos","integerpart","parse_format_bracket","operator","operand","ampstr","juliandate","intFunc","L","N","I","J","K","ParseState","alpha","stringquote","numexp1","numexp2","alphanumeric","specialvalue","space","CharClass","numstart","eof","incoord","quote","specialstart","CharClassTable"," ","!","\"","'","#","$","%","&","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7",":","<","=",">","A","B","C","D","E","F","G","O","P","Q","R","T","U","V","W","X","Y","Z","^","_","d","g","h","k","m","o","p","q","z","UpperCaseTable","SpecialConstants","TokenPrecedence","TypeLookupTable","unaryminus","n*","e*","t*","unaryplus","unarypercent","plus","n%","nd","nt","ndt","n$","nl","concat","th","tw","tl","oneargnumeric","twoargnumeric","propagateerror","cclass","haddecimal","last_token","last_token_type","last_token_text","parsestate","charclass","charclasstable","uppercasetable","pushtoken","ParsePushToken","coordregex","topcode","opcode","allowrangereturn","revpolish","ConvertInfixToPolish","EvaluatePolish","pii","tprecedence","tstackprecedence","token_precedence","parsestack","function_start","debug_log","DebugLog","logObject","rii","prii","value1","value2","tostype","tostype2","resulttype","cond","vmatch","smatch","lookup_result_type","LookupResultType","typelookup","operand_as_number","OperandAsNumber","operand_as_text","OperandAsText","operand_value_and_type","OperandValueAndType","operands_as_coord_on_sheet","OperandsAsCoordOnSheet","missingOperandError","PushOperand","parameterInfo","OperandsAsRangeOnSheet","CalculateFunction","type1","type2","table1","TopOfStackValueAndType","stacklen","operandinfo","cellvtype","coordsheet","StepThroughRangeDown","FindInSheetCache","PlainCoord","OperandAsCoord","OperandAsType","OperandAsRange","operandtype","othersheet","OperandAsSheetName","nvalue","isEnd","specialc","startedwalk","checknamecirc","rangevalue","sequence","sheet1","rp","OrderRangeParts","DecodeRangeParts","sheetdata","coordsheetdata","col1num","ncols","row1num","nrows","FunctionClasses","FunctionArgDefs","StoreIoEventFormula","operand_reverse","io_parameters","Clone","reverse","ioTimeTriggerList","PushTriggerTime","coordA1","sheetData","triggerTimeCellId","currentTriggerTimeList","rangeinfo","cellCoord","ArrayValuesEqual","timeZoneOffsetMins","getTimezoneOffset","start_1_1_1970","triggerUTCTimeList","toString","triggerCellId","PushTriggerCord","cellcr","formDataViewer","CurrentSpreadsheetControlObject","CurrentSpreadsheetViewerObject","loaded","formFields","LoadFormFields","formFieldName","sheetCmd","formFieldsLength","headerCoord","valueCoord","sheetCmdTwo","destination","source","property","A1","A2","fobj","foperand","ffunc","argnum","CopyFunctionArgs","FunctionArgsError","FunctionSpecificError","errortype","CheckForErrorValue","classes","cname","items","nargs","fdata","adef","SeriesFunctions","maxval","minval","mk","sk","mk1","sk1","typelookupplus","resulttypesum","counta","countblank","product","SumProductFunction","products","DSeriesFunctions","dbrange","fieldname","criteriarange","dbinfo","criteriainfo","fieldasnum","targetcol","criteriafieldnums","testok","criteriacr","criteria","testcol","testcr","countmatches","FieldToColnum","criterianum","CRITERIAROW","TestCriteria","fieldtype","LookupFunctions","lookupvalue","rangelookup","offsetvalue","cincr","rincr","previousOK","csave","rsave","IndexFunction","indexinfo","CountifSumifFunctions","sumrange","f2operand","IfFunction","op1","op2","DateFunction","TimeFunction","hours","minutes","seconds","DMYFunctions","dtype","doffset","datevalue","HMSFunctions","fraction","datetime","ExactFunction","v1type","v2type","ArgList","FIND","LEFT","LEN","LOWER","MID","PROPER","REPLACE","REPT","RIGHT","SUBSTITUTE","TRIM","HEXCODE","UPPER","StringFunctions","start","numargs","argdef","operand_value","operand_type","word","fulltext","oldtext","code","next","IsFunctions","NTVFunctions","Math1Functions","acos","asin","atan","cos","PI","exp","sin","tan","Math2Functions","xval","yval","quotient","atan2","LogFunction","RoundFunction","round","CeilingFloorFunctions","sig","AndOrFunctions","NotFunction","ChooseFunction","cindex","ColumnsRowsFunctions","ZeroArgFunctions","tzoffset","nowdays","getTime","volatile","NOW","TODAY","DDBFunction","method","depreciation","accumulateddepreciation","cost","salvage","lifetime","period","SLNFunction","SYDFunction","sumperiods","InterestFunctions","dval","eval","fval","pv","fv","rate","payment","paytype","guess","part1","part2","part3","part4","part5","olddelta","maxloop","tries","oldrate","aval","bval","epsilon","NPVFunction","resulttypenpv","IRRFunction","oldsum","rangeoperand","cashflows","IoFunctions","argList","BUTTON","EMAIL","EMAILIF","EMAILONEDIT","EMAILAT","EMAILONEDITIF","EMAILATIF","SUBMIT","TEXTBOX","CHECKBOX","COPYVALUE","COPYFORMULA","Button","spreadsheet","sheetCommand","cellValueType","cellDataValue","cellFormula","trim","sourceCell","destinationCell","emailFormulaCellId","optionalTriggerCellId","ss","parameterValues","parameterCellRefs","maxRangeSize","rangeSizeCounter","conditionIndex","toAddressParamOffset","setStatusBarMessage","emailContentsList","rangeIndex","conditionRangeIndex","toaddressRangeIndex","subjectsRangeIndex","bodyRangeIndex","emailContents","Submit","formDataValues","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","colIndex","TextBox","textBoxCellId","getHTMLTextBoxCellValue","textBoxWidget","updateInputWidgetFormula","CheckBox","checkBoxCellId","getHTMLCheckBoxCellValue","checkBoxWidget","checked","widgetCellId","getHTMLWidgetCellValue","cell_textbox","inputValue","UpdateFormDataSheet","formCellId","sheets","constants","asloaded","recalcing","recalcdone","loadsheet","sfsc","nsheetname","newsheet","sfscc","newsheetname","recalcstate","scffi","scfsc","comparitor","basestring","basevalue","testvalue","search","RegExp","Popup","Types","Controls","Current","LocalizeString","Create","pt","SetValue","sp","spt","spc","spcdata","changedcallback","SetDisabled","Hide","GetValue","Initialize","Reset","CClick","Show","Close","Cancel","CreatePopupDiv","mainele","backgroundColor","moveable","dragregistered","EnsurePosition","GetLayoutValues","popup","popupele","DestroyPopupDiv","RGBToHex","rgbvals","ToHex","HexDigits","FromHex","HexToRGB","makeRGB","splitRGB","rgb","List","spcid","options","custom","skip","cancel","MakeCustom","customele","listdiv","contentele","MakeList","ensureWithin","bg","SPLoc","ItemClicked","oele","nele","CustomToList","CustomOK","rowele","ColorChooser","spca","sampleWidth","sampleHeight","img","backgroundImageDefault","backgroundPosition","backgroundImageDisabled","CreateGrid","padding","grid","fontSize","borderRight","backgroundRepeat","marginTop","defaultbox","onclick","DefaultClicked","CustomClicked","CloseOK","GridMouseDown","DetermineColors","SetColors","gridToG","sptc","steps","commonrgb","mousedown","gpos","newrgb","oldrgb","ControlClicked","cid","CustomToGrid","SpreadsheetControl","requestedHeight","requestedWidth","requestedSpaceBelow","viewheight","tabs","tabnums","tabreplacements","currentTab","views","editorDiv","sortrange","moverange","multipartBoundary","toolbarbackground","tabbackground","tabselectedCSS","tabplainCSS","toolbartext","formulabarheight","statuslineheight","statuslineCSS","ExportCallback","statusline","SpreadsheetControlStatuslineCallback","statuslineid","recalcid1","recalcid2","movefrom","formulabuttons","formulafunctions","image","tooltip","DoFunctionList","multilineinput","DoMultiline","link","DoLink","DoSum","findbuttons","SearchUp","SearchDown","edit","html","oncreate","settings","view","SettingsControls","SettingControlReset","cellattribs","SettingsControlLoadPanel","values","sheetspanel","cellspanel","SpreadsheetControlSettingsSwitch","onclickFocus","viewobj","colorchooser","formatnumber","initialdata","formattext","textalignhoriz","numberalignhoriz","cformatnumber","cformattext","cfontfamily","cfontlook","cfontsize","calignhoriz","calignvert","ctextcolor","cbgcolor","cbt","cbr","cbb","cbl","cpadtop","cpadright","cpadbottom","cpadleft","SettingsControlInitializePanel","replacements","itemtitle","regex","replacement","sectiontitle","parttitle","itembody","bodypart","divStyle","SpreadsheetControlSortOnclick","SpreadsheetControlSortSave","SpreadsheetControlSortLoad","audit","SCLoc","ObjToSource","check","na","SpreadsheetControlCommentOnclick","onunclick","SpreadsheetControlCommentOnunclick","SpreadsheetControlNamesOnclick","SpreadsheetControlNamesOnunclick","SpreadsheetControlClipboardOnclick","InitializeSpreadsheetControl","node","spacebelow","DoOnResize","SizeSSDiv","ExecuteCommand","combostr","SpreadsheetControlExecuteCommand","CreateSheetHTML","SpreadsheetControlCreateSheetHTML","CreateSpreadsheetSave","otherparts","SpreadsheetControlCreateSpreadsheetSave","DecodeSpreadsheetSave","SpreadsheetControlDecodeSpreadsheetSave","CreateCellHTML","SpreadsheetControlCreateCellHTML","CreateCellHTMLSave","SpreadsheetControlCreateCellHTMLSave","child","vname","button","bele","SCLocSS","LocalizeSubstrings","Buttons","button_undo","button_redo","button_copy","button_cut","button_paste","button_pasteformats","button_lock","button_unlock","button_delete","button_filldown","button_fillright","button_movefrom","button_movepaste","button_moveinsert","button_alignleft","button_aligncenter","button_alignright","button_borderon","button_borderoff","button_swapcolors","button_merge","button_insertrow","button_insertcol","button_deleterow","button_deletecol","button_hiderow","button_hidecol","button_recalc","ISCButtonHoverBackground","DoButtonCmd","formulabarDiv","src","skipImagePrefix","marginLeft","input","searchBar","append","formulabardiv","on","FindInSheet","keyup","CalculateSheetNonViewHeight","nonviewheight","appViewDiv","formDataDiv","SpreadsheetViewer","InitializeSpreadsheetViewer","statuslineDiv","paddingTop","paddingBottom","SetSpreadsheetControlObject","nodeIndex","LocalizeStringList","csco","needresize","resized","nodestyle","newval","fudgefactorX","fudgefactorY","marginBottom","marginRight","SetTab","newtab","tname","newtabnum","newview","menutabs","tools","needsresize","onresize","rele1","rele2","UpdateSortRangeProposal","LoadColumnChoosers","nrange","rparts","sele","oldindex","selectedIndex","Option","cl","clele","slist","slistele","rele","lele","SpreadsheetCmdTable","slists","min_col","max_col","min_row","max_row","visibility","SpreadsheetCmdLookup","SpreadsheetCmdSLookup","cut","paste","pasteformats","lock","unlock","delete","filldown","erase","borderon","borderoff","merge","unmerge","align-left","align-center","align-right","align-default","insertrow","insertcol","deleterow","deletecol","hiderow","hidecol","redo","eobj","cellHTML","fcl","idp","GetFunctionNamesStr","GetFunctionInfoStr","vp","FillFunctionNames","scsc","FunctionClassChosen","FunctionChosen","HideFunctions","DoFunctionPaste","mele","HideMultiline","DoMultilineClear","DoMultilinePaste","setformat","HideLink","DoLinkClear","DoLinkPaste","ltsym","gtsym","obsym","cbsym","descele","urlele","pagenameele","workspaceele","formatele","foundvalue","searchstatus","search_cells","cellvalue","SearchSheet","selected_cell","new_cell","textContent","n_options","SpreadsheetControlCommentMoveECell","SpreadsheetControlCommentDisplay","SpreadsheetControlCommentSet","SpreadsheetControlNamesRangeChange","SpreadsheetControlNamesFillNameList","SpreadsheetControlNamesChangedName","currentname","SpreadsheetControlNamesSetValue","SpreadsheetControlNamesSave","SpreadsheetControlNamesDelete","clipele","SpreadsheetControlClipboardFormat","SpreadsheetControlClipboardLoad","savetype","SpreadsheetControlClipboardClear","SpreadsheetControlClipboardExport","sheettable","celltable","sheettoolbar","celltoolbar","SettingsControlSetCurrentPanel","SettingsControlSave","sc","panelobj","CurrentPanel","SettingsControlUnloadPanel","partname","extranl","otherpartsstr","otherpartsnames","mpregex","searchinfo","boundary","boundaryregex","blanklineregex","ending","partlist","lastIndex","exec","pnum","end","PopupChangeCallback","ctrlname","ctrl","str1","str2","cv","fontFamily","paddingRight","paddingLeft","borderTop","borderBottom","borderLeft","BorderSideGetValue","textAlign","fontStyle","fontWeight","PopupListSetValue","PopupListGetValue","ctl","PopupListInitialize","otext","InitialData","optionvals","PopupListReset","PopupList","OnReset","ChangedCallback","ColorChooserSetValue","ColorChooserGetValue","ColorChooserInitialize","ColorChooserReset","BorderSideSetValue","idname","idstart","BorderSideInitialize","SettingsControlOnchangeBorder","nameparts","ctrlidsuffix","ctrltype","BorderSide","OnClick","ColorComboOnClick","thickness","OtherSaveParts","whichpart","strtoedit","editbox","ebta","CtrlSEditorDone","idprefix","edittextarea","_view","SpreadsheetViewerStatuslineCallback","hasStatusLine","statuslineHTML","statuslineFull","noRecalc","repeatingMacroTimer","repeatingMacroInterval","repeatingMacroCommands","LoadSave","SpreadsheetViewerLoadSave","SpreadsheetViewerDecodeSpreadsheetSave","spreadsheetobj","rmstr","t2","startupmacro","repeatingmacro","SpreadsheetViewerDoRepeatingMacro","GetSpreadsheetViewerObject","repeatmacro","SpreadsheetViewerRepeatMacroCommand","SpreadsheetViewerStopRepeatingMacro","SpreadsheetViewerDoButtonCmd","csvo","slstr","SpreadsheetViewerCreateSheetHTML","hasreturnonly","self","thread","cb","ms","nextTick","Class","classDefinition","classWrapper","$1","baseClassName","$2","$3","incValues","strict","option","klass","global","init","isa","baseName","superFunc","addGlobal","newGlobals","extend","pairs","ii","ll","eval_strict","apply","last_key","globals","globals_after","proto","instantiate","output","content","insert","receiver","begin_node","tag","_wafl","onload","_label","imageName","_href","end_node","text_node","parse","grammar","create_grammar","parse_blocks","container_type","types","blocks","matched","find_match","handle_match","JSON","stringify","subparse","filter","matched_func","re","capture","lookbehind","parse_phrases","phrases","begin","filtered_text","parser","matched_block","matched_phrase","$4","all_blocks","all_phrases","re_huggy","brace1","brace2","im_types","yahoo","ymsgr","callto","callme","skype","aim","im_label","im_re","key","re_list","bullet","filter_out","exclusion","_all_blocks","_all_phrases","ol","ul","blockquote","subl","li","li2","_html","pre","hr","hx","empty","else","waflparagraph","waflphrase","asis","wikilink","wikilink2","file","href","im","mail","tt","del","Error","isWindow","nodeType","isFunction","grep","inArray","each","readyState","ready","getAttribute","parseJSON","isEmptyObject","acceptData","expando","cache","guid","toJSON","noop","camelCase","isArray","map","cleanData","deleteExpando","db","activeElement","eb","fb","createDocumentFragment","vb","getElementsByTagName","querySelectorAll","nodeName","wb","defaultChecked","xb","ownerDocument","yb","find","attr","zb","qb","removeAttribute","Ab","_data","Bb","hasData","events","handle","Cb","noCloneEvent","removeEvent","outerHTML","html5Clone","defaultSelected","defaultValue","Fb","appendTo","getDefaultComputedStyle","css","detach","Gb","Eb","Db","contentWindow","contentDocument","write","close","Mb","get","Vb","Ub","Wb","Xb","Qb","Yb","Zb","Jb","boxSizing","Kb","Ib","boxSizingReliable","parseFloat","$b","gc","_b","now","hc","opacity","ic","fc","jc","_queueHooks","unqueued","fire","always","overflowX","overflowY","inlineBlockNeedsLayout","zoom","shrinkWrapBlocks","bc","hidden","done","_removeData","kc","cssHooks","expand","lc","ec","Deferred","elem","startTime","duration","tweens","run","notifyWith","resolveWith","promise","props","opts","specialEasing","originalProperties","originalOptions","createTween","Tween","easing","stop","rejectWith","fx","anim","complete","fail","Mc","Nc","dataTypes","Jc","Oc","ajaxSettings","flatOptions","Pc","contents","mimeType","getResponseHeader","converters","Qc","responseFields","dataFilter","dataType","Wc","Sc","$c","XMLHttpRequest","_c","ActiveXObject","ed","parentWindow","hasOwnProperty","fn","jquery","constructor","selector","toArray","pushStack","prevObject","eq","isPlainObject","random","isReady","isNumeric","ownLast","globalEval","execScript","makeArray","Object","proxy","support","getElementsByClassName","qsa","ob","setAttribute","pb","mb","cacheLength","gb","hb","attrHandle","ib","sourceIndex","nextSibling","jb","kb","lb","nb","preFilter","dir","rb","sb","ub","relative","TAG","uniqueSort","getById","ID","ab","needsContext","CLASS","ATTR","PSEUDO","CHILD","bool","isXML","setDocument","attributes","createComment","getElementsByName","getAttributeNode","matchesSelector","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","msMatchesSelector","disconnectedMatch","compareDocumentPosition","contains","sortDetached","specified","detectDuplicates","sortStable","getText","nodeValue","selectors","createPseudo","~","pseudos","setFilters","not","has","innerText","lang","location","hash","hasFocus","tabIndex","enabled","header","even","odd","lt","gt","nth","radio","checkbox","password","submit","reset","filters","compile","expr","unique","isXMLDoc","is","parseHTML","children","prev","sibling","closest","prevAll","addBack","parents","parentsUntil","nextAll","nextUntil","prevUntil","siblings","once","memory","stopOnFalse","disable","remove","locked","fireWith","fired","then","resolve","reject","notify","pipe","when","readyWait","holdReady","trigger","off","frameElement","doScroll","noData","applet ","embed ","object ","removeData","dequeue","clearQueue","access","leadingWhitespace","htmlSerialize","cloneNode","appendChecked","noCloneChecked","checkClone","click","change","focusin","handler","triggered","dispatch","special","delegateType","bindType","origType","namespace","delegateCount","setup","teardown","Event","isTrigger","namespace_re","noBubble","isPropagationStopped","isDefaultPrevented","_default","fix","delegateTarget","preDispatch","handlers","currentTarget","isImmediatePropagationStopped","handleObj","postDispatch","fixHooks","mouseHooks","keyHooks","fromElement","pageX","clientLeft","pageY","clientTop","relatedTarget","toElement","beforeunload","originalEvent","simulate","isSimulated","defaultPrevented","getPreventDefault","timeStamp","stopImmediatePropagation","mouseenter","mouseleave","submitBubbles","form","_submit_bubble","changeBubbles","propertyName","_just_changed","focusinBubbles","one","triggerHandler","legend","area","param","thead","optgroup","tfoot","colgroup","caption","clone","buildFragment","createTextNode","domManip","prepend","before","after","replaceWith","_evalUrl","prependTo","insertAfter","replaceAll","cssFloat","backgroundClip","clearCloneStyle","Hb","Lb","getPropertyValue","minWidth","maxWidth","runtimeStyle","pixelLeft","swap","reliableHiddenOffsets","pixelPosition","reliableMarginRight","Nb","Ob","Pb","Rb","Sb","Tb","letterSpacing","cssNumber","columnCount","fillOpacity","lineHeight","orphans","widows","cssProps","float","set","margin","toggle","prop","cur","unit","propHooks","step","linear","swing","ac","cc","dc","Animation","tweener","prefilter","speed","speeds","old","fadeTo","animate","finish","timers","slideDown","slideUp","slideToggle","fadeIn","fadeOut","fadeToggle","tick","slow","fast","delay","getSetAttribute","hrefNormalized","checkOn","optSelected","enctype","optDisabled","radioValue","mc","valHooks","scrollHeight","nc","oc","pc","qc","rc","removeAttr","attrHooks","propFix","setAttributeNode","createAttribute","coords","contenteditable","tc","uc","removeProp","for","class","vc","addClass","removeClass","toggleClass","hasClass","hover","unbind","delegate","undelegate","wc","xc","yc","Function","parseXML","DOMParser","parseFromString","async","loadXML","zc","Ac","Bc","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Kc","Lc","active","lastModified","etag","isLocal","processData","contentType","accepts","xml","json","* text","text html","text json","text xml","ajaxSetup","ajaxPrefilter","ajaxTransport","ajax","ifModified","statusText","statusCode","getAllResponseHeaders","setRequestHeader","overrideMimeType","abort","success","crossDomain","traditional","hasContent","headers","beforeSend","send","getJSON","getScript","throws","wrapAll","wrapInner","wrap","unwrap","visible","Rc","Tc","Uc","Vc","encodeURIComponent","serialize","serializeArray","xhr","Xc","Yc","Zc","cors","open","username","xhrFields","onreadystatechange","responseText","script","text script","head","scriptCharset","charset","ad","bd","jsonp","jsonpCallback","cd","animated","dd","setOffset","using","scrollTo","Height","Width","andSelf","fd","jQuery","gd","noConflict","animation","WebkitAnimation","MozAnimation","MsAnimation","OAnimation","closeByEscape","globalID","animationEndEvent","baseClassNames","vex","overlay","closing","defaultOptions","showCloseButton","escapeButtonCloses","overlayClosesOnClick","appendLocation","overlayClassName","overlayCSS","contentClassName","contentCSS","closeClassName","closeCSS","$vex","$vexOverlay","$vexContent","$closeButton","setupBodyClassName","afterOpen","getAllVexes","getVexByID","closeByID","closeAll","beforeClose","afterClose","hideLoading","showLoading","require","buttons","YES","NO","message","onSubmit","getFormValueOnSubmit","focusFirstInput","defaultAlertOptions","defaultConfirmOptions","buildDialogForm","confirm","label","placeholder","buttonsToDOM","dialog"],"mappings":"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","sourcesContent":["// Taken from https://github.com/umdjs/umd/blob/master/templates/returnExports.js\n// (c) by The UMD contributors\n// MIT License: https://github.com/umdjs/umd/blob/master/LICENSE.md\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        console.log('AMD');\n        // AMD. Register as an anonymous module.\n        define([], factory.bind(root, this));\n    } else if (typeof module === 'object' && module.exports) {\n        console.log('Node');\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory.call(root, this);\n    } else {\n        console.log('Root');\n        // Browser globals (root is window)\n        root.SocialCalc = factory.call(root, this);\n  }\n}(this, function (window) {\n//\n/*\n// The module of the SocialCalc package with customizable constants, strings, etc.\n// This is where most of the common localizations are done.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\nvar SocialCalc;\nif (!SocialCalc) SocialCalc = {};\n\n// *************************************\n//\n// TO LEARN HOW TO LOCALIZE OR CUSTOMIZE SOCIALCALC, PLEASE READ THIS:\n//\n// The constants are all properties of the SocialCalc.Constants object.\n// They are grouped here by what they are for, which module uses them, etc.\n//\n// Properties whose names start with \"s_\" are strings, or arrays of strings,\n// that are good candidates for translation from the English.\n//\n// Other properties relate to visual settings, localization parameters, etc.\n//\n// These values are not used when SocialCalc modules are first loaded.\n// They may be modified before the first use of the routines that use them,\n// e.g., before creating SocialCalc objects.\n//\n// The exceptions are:\n//    TooltipOffsetX and TooltipOffsetY, as described with their definitions.\n//\n// SocialCalc IS NOT DESIGNED FOR USE WITH A TRANSLATION FUNCTION each time a string\n// is used. Instead, language translations may be done by modifying this object.\n//\n// To customize SocialCalc, you may either replace this file with a modified version\n// or you can overwrite the values before use. An example would be to\n// iterate over all the properties looking for names that start with \"s_\" and\n// use some other mechanism to obtain a localized string and replace the values\n// here with those translated values.\n//\n// There is also a function, SocialCalc.ConstantsSetClasses, that may be used\n// to easily switch SocialCalc from using explicit CSS styles for many things\n// to using CSS classes. See the function, below, for more information.\n//\n// *************************************\n\nSocialCalc.Constants = {\n\n//\n// Main SocialCalc module, socialcalc-3.js:\n//\n\n// eddy cellDataType {\n//    datatype: if present, v=numeric value, t=text value, f=formula,\n//              or c=constant that is not a simple number (like \"$1.20\")\n   cellDataType: { \n\tv:\"value\",\n\tn:\"value\",\n\tt:\"text\",\n\tf:\"formula\",\n\tc:\"constant\"\t\n   },\n// }   \n   \n   //*** Common Constants\n\n   textdatadefaulttype: \"t\", // This sets the default type for text on reading source file\n                             // It should normally be \"t\"\n\n   //*** Common error messages\n\n   s_BrowserNotSupported: \"Browser not supported.\", // error thrown if browser can't handle events like IE or Firefox.\n   s_InternalError: \"Internal SocialCalc error (probably an internal bug): \", // hopefully unlikely, but a test failed\n\n   //*** SocialCalc.ParseSheetSave\n\n   // Errors thrown on unexpected value in save file:\n\n   s_pssUnknownColType: \"Unknown col type item\",\n   s_pssUnknownRowType: \"Unknown row type item\",\n   s_pssUnknownLineType: \"Unknown line type\",\n\n   //*** SocialCalc.CellFromStringParts\n\n   // Error thrown on unexpected value in save file:\n\n   s_cfspUnknownCellType: \"Unknown cell type item\",\n\n   //*** SocialCalc.CanonicalizeSheet\n\n   doCanonicalizeSheet: true, // if true, do the canonicalization calculations\n\n   //*** ExecuteSheetCommand\n\n   s_escUnknownSheetCmd: \"Unknown sheet command: \",\n   s_escUnknownSetCoordCmd: \"Unknown set coord command: \",\n   s_escUnknownCmd: \"Unknown command: \",\n\n   //*** SocialCalc.CheckAndCalcCell\n\n   s_caccCircRef: \"Circular reference to \", // circular reference found during recalc\n\n   //*** SocialCalc.RenderContext\n\n   defaultRowNameWidth: \"30\", // used to set minimum width of the row header column - a string in pixels\n   defaultAssumedRowHeight: 15, // used when guessing row heights - number\n   defaultCellIDPrefix: \"cell_\", // if non-null, each cell will render with an ID starting with this\n\n   // Default sheet display values\n\n   defaultCellLayout: \"padding:2px 2px 1px 2px;vertical-align:top;\",\n   defaultCellFontStyle: \"normal normal\",\n   defaultCellFontSize: \"small\",\n   defaultCellFontFamily: \"Verdana,Arial,Helvetica,sans-serif\",\n\n   defaultPaneDividerWidth: \"3\", // a string\n   defaultPaneDividerHeight: \"3\", // a string\n\n   defaultGridCSS: \"1px solid #C0C0C0;\", // used as style to set each border when grid enabled (was #ECECEC)\n\n   defaultCommentClass: \"\", // class added to cells with non-null comments when grid enabled\n   defaultCommentStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);\", // style added to cells with non-null comments when grid enabled\n   defaultCommentNoGridClass: \"\", // class added to cells with non-null comments when grid not enabled\n   defaultCommentNoGridStyle: \"\", // style added to cells with non-null comments when grid not enabled\n\n   defaultReadonlyClass: \"\", // class added to readonly cells when grid enabled\n   defaultReadonlyStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);\", // style added to readonly cells when grid enabled\n   defaultReadonlyNoGridClass: \"\", // class added to readonly cells when grid not enabled\n   defaultReadonlyNoGridStyle: \"\", // style added to readonly cells when grid not enabled\n   defaultReadonlyComment: \"Locked cell\",\n\n   defaultColWidth: \"80\", // text\n   defaultMinimumColWidth: 10, // numeric\n\n   // For each of the following default sheet display values at least one of class and/or style are needed\n\n   defaultHighlightTypeCursorClass: \"\",\n   defaultHighlightTypeCursorStyle: \"color:#FFF;backgroundColor:#A6A6A6;\",\n   defaultHighlightTypeRangeClass: \"\",\n   defaultHighlightTypeRangeStyle: \"color:#000;backgroundColor:#E5E5E5;\",\n\n   defaultColnameClass: \"\", // regular column heading letters, needs a cursor property \n   defaultColnameStyle: \"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;\",\n   defaultSelectedColnameClass: \"\", // column with selected cell, needs a cursor property \n   defaultSelectedColnameStyle: \"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;\",\n   defaultRownameClass: \"\", // regular row heading numbers\n   defaultRownameStyle: \"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;\",\n   defaultSelectedRownameClass: \"\", // column with selected cell, needs a cursor property \n   defaultSelectedRownameStyle: \"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;\",\n   defaultUpperLeftClass: \"\", // Corner cell in upper left\n   defaultUpperLeftStyle: \"font-size:small;\",\n   defaultSkippedCellClass: \"\", // used if present for spanned cells peeking into a pane (at least one of class/style needed)\n   defaultSkippedCellStyle: \"font-size:small;background-color:#CCC\", // used if present\n   defaultPaneDividerClass: \"\", // used if present for the look of the space between panes (at least one of class/style needed)\n   defaultPaneDividerStyle: \"font-size:small;background-color:#C0C0C0;padding:0px;\", // used if present\n   defaultUnhideLeftClass: \"\",\n   defaultUnhideLeftStyle: \"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;\", // used if present\n   defaultUnhideRightClass: \"\",\n   defaultUnhideRightStyle: \"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;\", // used if present\n   defaultUnhideTopClass: \"\",\n   defaultUnhideTopStyle: \"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;\",\n   defaultUnhideBottomClass: \"\",\n   defaultUnhideBottomStyle: \"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;\",\n\n   defaultColResizeBarClass: \"col-resize-bar\",\n   defaultRowResizeBarClass: \"row-resize-bar\",\n\n   s_rcMissingSheet: \"Render Context must have a sheet object\", // unlikely thrown error\n\n   //*** SocialCalc.format_text_for_display\n\n   defaultLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Link</span>', // used for format \"text-link\"; you could make this an img tag if desired\n//   defaultLinkFormatString: '<img src=\"images/sc-linkout.gif\" border=\"0\" alt=\"Link out\" title=\"Link out\">',\n   defaultPageLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Page</span>', // used for format \"text-link\"; you could make this an img tag if desired\n\n   //*** SocialCalc.format_number_for_display\n\n   defaultFormatp: '#,##0.0%',\n   defaultFormatc: '[$$]#,##0.00',\n   defaultFormatdt: 'd-mmm-yyyy h:mm:ss',\n   defaultFormatd: 'd-mmm-yyyy',\n   defaultFormatt: '[h]:mm:ss',\n   defaultDisplayTRUE: 'TRUE', // how TRUE shows when rendered\n   defaultDisplayFALSE: 'FALSE',\n\n//\n// SocialCalc Table Editor module, socialcalctableeditor.js:\n//\n\n   //*** SocialCalc.TableEditor\n\n   defaultImagePrefix: \"images/sc_\", // URL prefix for images (e.g., \"/images/sc\")\n   defaultTableEditorIDPrefix: \"te_\", // if present, many TableEditor elements are assigned IDs with this prefix\n   defaultPageUpDnAmount: 15, // number of rows to move cursor on PgUp/PgDn keys (numeric)\n\n   AllowCtrlS: true, // turns on Ctrl-S trapdoor for setting custom numeric formats and commands if true\n\n   //*** SocialCalc.CreateTableEditor\n\n   defaultTableControlThickness: 20, // the short size for the scrollbars, etc. (numeric in pixels)\n   cteGriddivClass: \"\", // if present, the class for the TableEditor griddiv element\n\n   //** SocialCalc.EditorGetStatuslineString -- strings shown on status line\n\n   s_statusline_executing: \"Executing...\",\n   s_statusline_displaying: \"Displaying...\",\n   s_statusline_ordering: \"Ordering...\",\n   s_statusline_calculating: \"Calculating...\",\n   s_statusline_calculatingls: \"Calculating... Loading Sheet...\",\n   s_statusline_doingserverfunc: \"doing server function \",\n   s_statusline_incell: \" in cell \",\n   s_statusline_calcstart: \"Calculation start...\",\n   s_statusline_sum: \"SUM\",\n   s_statusline_recalcneeded: '<span style=\"color:#999;\">(Recalc needed)</span>',\n   s_statusline_circref: '<span style=\"color:red;\">Circular reference: ',\n   s_statusline_sendemail: \"Sending Email \",  // eddy\n   //** SocialCalc.InputBoxDisplayCellContents\n\n   s_inputboxdisplaymultilinetext: \"[Multi-line text: Click icon on right to edit]\",\n\n   //** SocialCalc.InputEcho\n\n   defaultInputEchoClass: \"\", // if present, the class of the popup inputEcho div\n   defaultInputEchoStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;\"+\n      \"fontSize:small;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\n   defaultInputEchoPromptClass: \"\", // if present, the class of the popup inputEcho div\n   defaultInputEchoPromptStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;\"+\n      \"borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;\"+\n      \"fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\n   defaultInputEchoHintClass: \"\", // if present, the class of the popup inputEcho div\n   defaultInputEchoHintStyle: \"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;\"+\n      \"fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;\", // if present, pseudo style\n\n   //** SocialCalc.InputEchoText\n\n   ietUnknownFunction: \"Unknown function \", // displayed when typing \"=unknown(\"\n\n   //** SocialCalc.CellHandles\n\n   CH_radius1: 29.0, // extent of inner circle within 90px image\n   CH_radius2: 41.0, // extent of outer circle within 90px image\n   s_CHfillAllTooltip: \"Fill Contents and Formats Down/Right\", // tooltip for fill all handle\n   s_CHfillContentsTooltip: \"Fill Contents Only Down/Right\", // tooltip for fill formulas handle\n   s_CHmovePasteAllTooltip: \"Move Contents and Formats\", // etc.\n   s_CHmovePasteContentsTooltip: \"Move Contents Only\",\n   s_CHmoveInsertAllTooltip: \"Slide Contents and Formats within Row/Col\",\n   s_CHmoveInsertContentsTooltip: \"Slide Contents within Row/Col\",\n   s_CHindicatorOperationLookup: {\"Fill\": \"Fill\", \"FillC\": \"Fill Contents\",\n                                  \"Move\": \"Move\", \"MoveI\": \"Slide\", \n                                  \"MoveC\": \"Move Contents\", \"MoveIC\": \"Slide Contents\"}, // short form of operation to follow drag\n   s_CHindicatorDirectionLookup: {\"Down\": \" Down\", \"Right\": \" Right\",\n                                  \"Horizontal\": \" Horizontal\", \"Vertical\": \" Vertical\"}, // direction that modifies operation during drag\n\n   //*** SocialCalc.TableControl\n\n   defaultTCSliderThickness: 9, // length of pane slider (numeric in pixels)\n   defaultTCButtonThickness: 20, // length of scroll +/- buttons (numeric in pixels)\n   defaultTCThumbThickness: 15, // length of thumb (numeric in pixels)\n\n   //*** SocialCalc.CreateTableControl\n\n   TCmainStyle: \"backgroundColor:#EEE;\", // if present, pseudo style (text-align is textAlign) for main div of a table control\n   TCmainClass: \"\", // if present, the CSS class of the main div for a table control\n   TCendcapStyle: \"backgroundColor:#FFF;\", // backgroundColor may be used while waiting for image that may not come\n   TCendcapClass: \"\",\n   TCpanesliderClass: \"tc-paneslider\",\n   s_panesliderTooltiph: \"Drag to lock pane vertically\", // tooltip for horizontal table control pane slider\n   s_panesliderTooltipv: \"Drag to lock pane horizontally\",\n   TClessbuttonStyle: \"backgroundColor:#AAA;\",\n   TClessbuttonClass: \"\",\n   TClessbuttonRepeatWait: 300, // in milliseconds\n   TClessbuttonRepeatInterval: 20,//100, // in milliseconds\n   TCmorebuttonStyle: \"backgroundColor:#AAA;\",\n   TCmorebuttonClass: \"\",\n   TCmorebuttonRepeatWait: 300, // in milliseconds\n   TCmorebuttonRepeatInterval: 20,//100, // in milliseconds\n   TCscrollareaStyle: \"backgroundColor:#DDD;\",\n   TCscrollareaClass: \"\",\n   TCscrollareaRepeatWait: 500, // in milliseconds\n   TCscrollareaRepeatInterval: 100, // in milliseconds\n   TCthumbClass: \"\",\n   TCthumbStyle: \"backgroundColor:#CCC;\",\n\n   //*** SocialCalc.TCPSDragFunctionStart\n\n   TCPStrackinglineClass: \"tracklingine\", // at least one of class/style for pane slider tracking line display in table control\n   TCPStrackinglineStyle: \"overflow:hidden;position:absolute;zIndex:100;\",\n                           // if present, pseudo style (text-align is textAlign)\n   TCPStrackinglineThickness: \"2px\", // narrow dimension of trackling line (string with units)\n\n\n   //*** SocialCalc.TCTDragFunctionStart\n\n   TCTDFSthumbstatusvClass: \"\", // at least one of class/style for vertical thumb dragging status display in table control\n   TCTDFSthumbstatusvStyle: \"height:20px;width:auto;border:3px solid #808080;overflow:hidden;\"+\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\n                           // if present, pseudo style (text-align is textAlign)\n   TCTDFSthumbstatushClass: \"\", // at least one of class/style for horizontal thumb dragging status display in table control\n   TCTDFSthumbstatushStyle: \"height:20px;width:auto;border:1px solid black;padding:2px;\"+\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\n                           // if present, pseudo style (text-align is textAlign)\n   TCTDFSthumbstatusrownumClass: \"\", // at least one of class/style for thumb dragging status display in table control\n   TCTDFSthumbstatusrownumStyle: \"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;\", // if present, real style\n   TCTDFStopOffsetv: 0, // offsets for thumbstatus display while dragging\n   TCTDFSleftOffsetv: -80,\n   s_TCTDFthumbstatusPrefixv: \"Row \", // Text Control Drag Function text before row number\n   TCTDFStopOffseth: -30,\n   TCTDFSleftOffseth: 0,\n   s_TCTDFthumbstatusPrefixh: \"Col \", // Text Control Drag Function text before col number\n\n   //*** SocialCalc.TooltipInfo\n\n   // Note: These two values are used to set the TooltipInfo initial values when the code is first read in.\n   // Modifying them here after loading has no effect -- you need to modify SocialCalc.TooltipInfo directly\n   // to dynamically set them. This is different than most other constants which may be modified until use.\n\n   TooltipOffsetX: 2, // offset in pixels from mouse position (to right on left side of screen, to left on right)\n   TooltipOffsetY: 10, // offset in pixels above mouse position for lower edge\n\n   //*** SocialCalc.TooltipDisplay\n\n   TDpopupElementClass: \"\", // at least one of class/style for tooltip display\n   TDpopupElementStyle: \"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;\"+\n                        \"fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;\"+\n                        \"position:absolute;width:auto;zIndex:110;\",\n                        // if present, pseudo style (text-align is textAlign)\n\n\n//\n// SocialCalc Spreadsheet Control module, socialcalcspreadsheetcontrol.js:\n//\n\n   //*** SocialCalc.SpreadsheetControl\n\n   SCToolbarbackground: \"background-color:#ffffff;\",\n   SCTabbackground: \"background-color:#CCC;\",\n   SCTabselectedCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;\",\n   SCTabplainCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;\",\n   SCToolbartext: \"font-size:x-small;font-weight:bold;color:#888\",\n\n   SCFormulabarheight: 30, // in pixels, will contain a text input box\n\n   SCStatuslineheight: 20, // in pixels\n   SCStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\n\n   // Constants for default Format tab (settings)\n   //\n   // *** EVEN THOUGH THESE DON'T START WITH s_: ***\n   //\n   // These should be carefully checked for localization. Make sure you understand what they do and how they work!\n   // The first part of \"first:second|first:second|...\" is what is displayed and the second is the value to be used.\n   // The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\n   // they are commands to SocialCalc.SettingsControls.PopupListInitialize \n\n   SCFormatNumberFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|\"+\n            \"00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:\"+\n            \"1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|\"+\n            \"[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|\"+\n            \"[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|\"+\n            \"(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|\"+\n            \"($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|\"+\n            \"[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|\"+\n            \"[break]:|1\\\\c23:h:mm|1\\\\c23 PM:h:mm AM/PM|1\\\\c23\\\\c45:h:mm:ss|01\\\\c23\\\\c45:hh:mm:ss|26\\\\c23 (h\\\\cm):[hh]:mm|69\\\\c45 (m\\\\cs):[mm]:ss|69 (s):[ss]|\"+\n            \"[newcol]:|2006-01-04 01\\\\c23\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\",\n   SCFormatTextFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|\"+\n            \"HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\",\n   SCFormatPadsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|\"+\n            \"[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|\"+\n            \"6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\n            \"12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|\"+\n            \"18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\n   SCFormatFontsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|\"+\n                  \"[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|\"+\n                  \"[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|\"+\n                  \"[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\n                  \"12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|\"+\n                  \"18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\n   SCFormatFontfamilies: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|\"+\n                  \"Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\",\n   SCFormatFontlook: \"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|\"+\n                  \"%loc!Bold Italic!:italic bold\",\n   SCFormatTextAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\n   SCFormatNumberAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\n   SCFormatAlignVertical: \"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\",\n   SCFormatColwidth: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\n                  \"20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|\"+\n                  \"[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\",\n   SCFormatRecalc: \"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\",\n   SCFormatUserMaxCol: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\n                  \"Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\",\n   SCFormatUserMaxRow: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\n                  \"Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\",\n\n   //*** SocialCalc.InitializeSpreadsheetControl\n\n   ISCButtonNormalBackground: \"transparent\",\n   ISCButtonBorderNormal: \"none\",\n   ISCButtonBorderHover: \"none\",\n   ISCButtonBorderDown: \"none\",\n   ISCButtonDownBackground: \"#888\",\n\n   //*** SocialCalc.SettingsControls.PopupListInitialize\n\n   s_PopupListCancel: \"[Cancel]\",\n   s_PopupListCustom: \"Custom\",\n\n   // ***\n   //\n   // s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\n   //\n   // Used extensively by socialcalcspreadsheetcontrol.js\n   //\n   // ***\n\n   s_loc_align_center: \"Align Center\",\n   s_loc_align_left: \"Align Left\",\n   s_loc_align_right: \"Align Right\",\n   s_loc_alignment: \"Alignment\",\n   s_loc_audit: \"Audit\",\n   s_loc_audit_trail_this_session: \"Audit Trail This Session\",\n   s_loc_auto: \"Auto\",\n   s_loc_auto_sum: \"Auto Sum\",\n   s_loc_auto_wX_commas: \"Auto w/ commas\",\n   s_loc_automatic: \"Automatic\",\n   s_loc_background: \"Background\",\n   s_loc_bold: \"Bold\",\n   s_loc_bold_XampX_italics: \"Bold &amp; Italics\",\n   s_loc_bold_italic: \"Bold Italic\",\n   s_loc_borders: \"Borders\",\n   s_loc_borders_off: \"Borders Off\",\n   s_loc_borders_on: \"Borders On\",\n   s_loc_bottom: \"Bottom\",\n   s_loc_bottom_border: \"Bottom Border\",\n   s_loc_cell_settings: \"CELL SETTINGS\",\n   s_loc_csv_format: \"CSV format\",\n   s_loc_cancel: \"Cancel\",\n   s_loc_category: \"Category\",\n   s_loc_center: \"Center\",\n   s_loc_clear: \"Clear\",\n   s_loc_clear_socialcalc_clipboard: \"Clear SocialCalc Clipboard\",\n   s_loc_clipboard: \"Clipboard\",\n   s_loc_color: \"Color\",\n   s_loc_column_: \"Column \",\n   s_loc_comment: \"Comment\",\n   s_loc_copy: \"Copy\",\n   s_loc_custom: \"Custom\",\n   s_loc_cut: \"Cut\",\n   s_loc_default: \"Default\",\n   s_loc_default_alignment: \"Default Alignment\",\n   s_loc_default_column_width: \"Default Column Width\",\n   s_loc_default_font: \"Default Font\",\n   s_loc_default_format: \"Default Format\",\n   s_loc_default_padding: \"Default Padding\",\n   s_loc_delete: \"Delete\",\n   s_loc_delete_column: \"Delete Column\",\n   s_loc_delete_contents: \"Delete Cell Contents\",\n   s_loc_delete_row: \"Delete Row\",\n   s_loc_description: \"Description\",\n   s_loc_display_clipboard_in: \"Display Clipboard in\",\n   s_loc_down: \"Down\",\n   s_loc_edit: \"Edit\",\n   s_loc_existing_names: \"Existing Names\",\n   s_loc_family: \"Family\",\n   s_loc_fill_down: \"Fill Down\",\n   s_loc_fill_right: \"Fill Right\",\n   s_loc_font: \"Font\",\n   s_loc_format: \"Format\",\n   s_loc_formula: \"Formula\",\n   s_loc_function_list: \"Function List\",\n   s_loc_functions: \"Functions\",\n   s_loc_grid: \"Grid\",\n   s_loc_hidden: \"Hidden\",\n   s_loc_hide_column: \"Hide Column\",\n   s_loc_hide_row: \"Hide Row\",\n   s_loc_horizontal: \"Horizontal\",\n   s_loc_insert_column: \"Insert Column Before\",\n   s_loc_insert_row: \"Insert Row Before\",\n   s_loc_italic: \"Italic\",\n   s_loc_last_sort: \"Last Sort\",\n   s_loc_left: \"Left\",\n   s_loc_left_border: \"Left Border\",\n   s_loc_link: \"Link\",\n   s_loc_link_input_box: \"Link Input Box\",\n   s_loc_list: \"List\",\n   s_loc_load_socialcalc_clipboard_with_this: \"Load SocialCalc Clipboard With This\",\n   s_loc_lock_cell: \"Lock Cell\",\n   s_loc_major_sort: \"Major Sort\",\n   s_loc_manual: \"Manual\",\n   s_loc_merge_cells: \"Merge/Unmerge Cells\",\n   s_loc_middle: \"Middle\",\n   s_loc_minor_sort: \"Minor Sort\",\n   s_loc_move_insert: \"Move Insert\",\n   s_loc_move_paste: \"Move Paste\",\n   s_loc_multiXline_input_box: \"Multi-line Input Box\",\n   s_loc_name: \"Name\",\n   s_loc_names: \"Names\",\n   s_loc_no_padding: \"No padding\",\n   s_loc_normal: \"Normal\",\n   s_loc_number: \"Number\",\n   s_loc_number_horizontal: \"Number Horizontal\",\n   s_loc_ok: \"OK\",\n   s_loc_padding: \"Padding\",\n   s_loc_page_name: \"Page Name\",\n   s_loc_paste: \"Paste\",\n   s_loc_paste_formats: \"Paste Formats\",\n   s_loc_plain_text: \"Plain Text\",\n   s_loc_recalc: \"Recalc\",\n   s_loc_recalculation: \"Recalculation\",\n   s_loc_redo: \"Redo\",\n   s_loc_right: \"Right\",\n   s_loc_right_border: \"Right Border\",\n   s_loc_sheet_settings: \"SHEET SETTINGS\",\n   s_loc_save: \"Save\",\n   s_loc_save_to: \"Save to\",\n   s_loc_set_cell_contents: \"Set Cell Contents\",\n   s_loc_set_cells_to_sort: \"Set Cells To Sort\",\n   s_loc_set_value_to: \"Set Value To\",\n   s_loc_set_to_link_format: \"Set to Link format\",\n   s_loc_setXclear_move_from: \"Set/Clear Move From\",\n   s_loc_show_cell_settings: \"Show Cell Settings\",\n   s_loc_show_sheet_settings: \"Show Sheet Settings\",\n   s_loc_show_in_new_browser_window: \"Show in new browser window\",\n   s_loc_size: \"Size\",\n   s_loc_socialcalcXsave_format: \"SocialCalc-save format\",\n   s_loc_sort: \"Sort\",\n   s_loc_sort_: \"Sort \",\n   s_loc_sort_cells: \"Sort Cells\",\n   s_loc_swap_colors: \"Swap Colors\",\n   s_loc_tabXdelimited_format: \"Tab-delimited format\",\n   s_loc_text: \"Text\",\n   s_loc_text_horizontal: \"Text Horizontal\",\n   s_loc_this_is_aXbrXsample: \"This is a<br>sample\",\n   s_loc_top: \"Top\",\n   s_loc_top_border: \"Top Border\",\n   s_loc_undone_steps: \"UNDONE STEPS\",\n   s_loc_url: \"URL\",\n   s_loc_undo: \"Undo\",\n   s_loc_unlock_cell: \"Unlock Cell\",\n   s_loc_unmerge_cells: \"Unmerge Cells\",\n   s_loc_up: \"Up\",\n   s_loc_value: \"Value\",\n   s_loc_vertical: \"Vertical\",\n   s_loc_wikitext: \"Wikitext\",\n   s_loc_workspace: \"Workspace\",\n   s_loc_XnewX: \"[New]\",\n   s_loc_XnoneX: \"[None]\",\n   s_loc_Xselect_rangeX: \"[select range]\",\n\n//\n// SocialCalc Spreadsheet Viewer module, socialcalcviewer.js:\n//\n\n   //*** SocialCalc.SpreadsheetViewer\n\n   SVStatuslineheight: 20, // in pixels\n   SVStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\n\n//\n// SocialCalc Format Number module, formatnumber2.js:\n//\n\n   FormatNumber_separatorchar: \",\", // the thousands separator character when formatting numbers for display\n   FormatNumber_decimalchar: \".\", // the decimal separator character when formatting numbers for display\n   FormatNumber_defaultCurrency: \"$\", // the currency string used if none specified\n\n   // The following constants are arrays of strings with the short (3 character) and full names of days and months\n\n   s_FormatNumber_daynames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n   s_FormatNumber_daynames3: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n   s_FormatNumber_monthnames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\n                                      \"October\", \"November\", \"December\"],\n   s_FormatNumber_monthnames3: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n   s_FormatNumber_am: \"AM\",\n   s_FormatNumber_am1: \"A\",\n   s_FormatNumber_pm: \"PM\",\n   s_FormatNumber_pm1: \"P\",\n\n//\n// SocialCalc Spreadsheet Formula module, formula1.js:\n//\n\n   s_parseerrexponent: \"Improperly formed number exponent\",\n   s_parseerrchar: \"Unexpected character in formula\",\n   s_parseerrstring: \"Improperly formed string\",\n   s_parseerrspecialvalue: \"Improperly formed special value\",\n   s_parseerrtwoops: \"Error in formula (two operators inappropriately in a row)\",\n   s_parseerrmissingopenparen: \"Missing open parenthesis in list with comma(s). \",\n   s_parseerrcloseparennoopen: \"Closing parenthesis without open parenthesis. \",\n   s_parseerrmissingcloseparen: \"Missing close parenthesis. \",\n   s_parseerrmissingoperand: \"Missing operand. \",\n   s_parseerrerrorinformula: \"Error in formula.\",\n   s_calcerrerrorvalueinformula: \"Error value in formula\",\n   s_parseerrerrorinformulabadval: \"Error in formula resulting in bad value\",\n   s_formularangeresult: \"Formula results in range value:\",\n   s_calcerrnumericnan: \"Formula results in an bad numeric value\",\n   s_calcerrnumericoverflow: \"Numeric overflow\",\n   s_sheetunavailable: \"Sheet unavailable:\", // when FindSheetInCache returns null\n   s_calcerrcellrefmissing: \"Cell reference missing when expected.\",\n   s_calcerrsheetnamemissing: \"Sheet name missing when expected.\",\n   s_circularnameref: \"Circular name reference to name\",\n   s_calcerrunknownname: \"Unknown name\",\n   s_calcerrincorrectargstofunction: \"Incorrect arguments to function\",\n   s_sheetfuncunknownfunction: \"Unknown function\",\n   s_sheetfunclnarg: \"LN argument must be greater than 0\",\n   s_sheetfunclog10arg: \"LOG10 argument must be greater than 0\",\n   s_sheetfunclogsecondarg: \"LOG second argument must be numeric greater than 0\",\n   s_sheetfunclogfirstarg: \"LOG first argument must be greater than 0\",\n   s_sheetfuncroundsecondarg: \"ROUND second argument must be numeric\",\n   s_sheetfuncddblife: \"DDB life must be greater than 1\",\n   s_sheetfuncslnlife: \"SLN life must be greater than 1\",\n\n   // Function definition text\n\n   s_fdef_ABS: 'Absolute value function. ',\n   s_fdef_ACOS: 'Trigonometric arccosine function. ',\n   s_fdef_AND: 'True if all arguments are true. ',\n   s_fdef_ASIN: 'Trigonometric arcsine function. ',\n   s_fdef_ATAN: 'Trigonometric arctan function. ',\n   s_fdef_ATAN2: 'Trigonometric arc tangent function (result is in radians). ',\n   s_fdef_AVERAGE: 'Averages the values. ',\n   s_fdef_CHOOSE: 'Returns the value specified by the index. The values may be ranges of cells. ',\n   s_fdef_COLUMNS: 'Returns the number of columns in the range. ',\n   s_fdef_COS: 'Trigonometric cosine function (value is in radians). ',\n   s_fdef_COUNT: 'Counts the number of numeric values, not blank, text, or error. ',\n   s_fdef_COUNTA: 'Counts the number of non-blank values. ',\n   s_fdef_COUNTBLANK: 'Counts the number of blank values. (Note: \"\" is not blank.) ',\n   s_fdef_COUNTIF: 'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). ',\n   s_fdef_DATE: 'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\n   s_fdef_DAVERAGE: 'Averages the values in the specified field in records that meet the criteria. ',\n   s_fdef_DAY: 'Returns the day of month for a date value. ',\n   s_fdef_DCOUNT: 'Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ',\n   s_fdef_DCOUNTA: 'Counts the number of non-blank values in the specified field in records that meet the criteria. ',\n   s_fdef_DDB: 'Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ',\n   s_fdef_DEGREES: 'Converts value in radians into degrees. ',\n   s_fdef_DGET: 'Returns the value of the specified field in the single record that meets the criteria. ',\n   s_fdef_DMAX: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DMIN: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DPRODUCT: 'Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DSTDEV: 'Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DSTDEVP: 'Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DSUM: 'Returns the sum of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DVAR: 'Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_DVARP: 'Returns the variance of the numeric values in the specified field in records that meet the criteria. ',\n   s_fdef_EVEN: 'Rounds the value up in magnitude to the nearest even integer. ',\n   s_fdef_EXACT: 'Returns \"true\" if the values are exactly the same, including case, type, etc. ',\n   s_fdef_EXP: 'Returns e raised to the value power. ',\n   s_fdef_FACT: 'Returns factorial of the value. ',\n   s_fdef_FALSE: 'Returns the logical value \"false\". ',\n   s_fdef_FIND: 'Returns the starting position within string2 of the first occurrence of string1 at or after \"start\". If start is omitted, 1 is assumed. ',\n   s_fdef_FV: 'Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\n   s_fdef_HLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ',\n   s_fdef_HOUR: 'Returns the hour portion of a time or date/time value. ',\n   s_fdef_IF: 'Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ',\n   s_fdef_INDEX: 'Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ',\n   s_fdef_INT: 'Returns the value rounded down to the nearest integer (towards -infinity). ',\n   s_fdef_IRR: 'Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\n   s_fdef_ISBLANK: 'Returns \"true\" if the value is a reference to a blank cell. ',\n   s_fdef_ISERR: 'Returns \"true\" if the value is of type \"Error\" but not \"NA\". ',\n   s_fdef_ISERROR: 'Returns \"true\" if the value is of type \"Error\". ',\n   s_fdef_ISLOGICAL: 'Returns \"true\" if the value is of type \"Logical\" (true/false). ',\n   s_fdef_ISNA: 'Returns \"true\" if the value is the error type \"NA\". ',\n   s_fdef_ISNONTEXT: 'Returns \"true\" if the value is not of type \"Text\". ',\n   s_fdef_ISNUMBER: 'Returns \"true\" if the value is of type \"Number\" (including logical values). ',\n   s_fdef_ISTEXT: 'Returns \"true\" if the value is of type \"Text\". ',\n   s_fdef_LEFT: 'Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ',\n   s_fdef_LEN: 'Returns the number of characters in the text value. ',\n   s_fdef_LN: 'Returns the natural logarithm of the value. ',\n   s_fdef_LOG: 'Returns the logarithm of the value using the specified base. ',\n   s_fdef_LOG10: 'Returns the base 10 logarithm of the value. ',\n   s_fdef_LOWER: 'Returns the text value with all uppercase characters converted to lowercase. ',\n   s_fdef_MATCH: 'Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ',\n   s_fdef_MAX: 'Returns the maximum of the numeric values. ',\n   s_fdef_MID: 'Returns the specified number of characters from the text value starting from the specified position. ',\n   s_fdef_MIN: 'Returns the minimum of the numeric values. ',\n   s_fdef_MINUTE: 'Returns the minute portion of a time or date/time value. ',\n   s_fdef_MOD: 'Returns the remainder of the first value divided by the second. ',\n   s_fdef_MONTH: 'Returns the month part of a date value. ',\n   s_fdef_N: 'Returns the value if it is a numeric value otherwise an error. ',\n   s_fdef_NA: 'Returns the #N/A error value which propagates through most operations. ',\n   s_fdef_NOT: 'Returns FALSE if value is true, and TRUE if it is false. ',\n   s_fdef_NOW: 'Returns the current date/time. ',\n   s_fdef_NPER: 'Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ',\n   s_fdef_NPV: 'Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ',\n   s_fdef_ODD: 'Rounds the value up in magnitude to the nearest odd integer. ',\n   s_fdef_OR: 'True if any argument is true ',\n   s_fdef_PI: 'The value 3.1415926... ',\n   s_fdef_PMT: 'Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\n   s_fdef_POWER: 'Returns the first value raised to the second value power. ',\n   s_fdef_PRODUCT: 'Returns the result of multiplying the numeric values. ',\n   s_fdef_PROPER: 'Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ',\n   s_fdef_PV: 'Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\n   s_fdef_RADIANS: 'Converts value in degrees into radians. ',\n   s_fdef_RATE: 'Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\n   s_fdef_REPLACE: 'Returns text1 with the specified number of characters starting from the specified position replaced by text2. ',\n   s_fdef_REPT: 'Returns the text repeated the specified number of times. ',\n   s_fdef_RIGHT: 'Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ',\n   s_fdef_ROUND: 'Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ',\n   s_fdef_ROWS: 'Returns the number of rows in the range. ',\n   s_fdef_SECOND: 'Returns the second portion of a time or date/time value (truncated to an integer). ',\n   s_fdef_SIN: 'Trigonometric sine function (value is in radians) ',\n   s_fdef_SLN: 'Returns the amount of depreciation at each period of time using the straight-line method. ',\n   s_fdef_SQRT: 'Square root of the value ',\n   s_fdef_STDEV: 'Returns the sample standard deviation of the numeric values. ',\n   s_fdef_STDEVP: 'Returns the standard deviation of the numeric values. ',\n   s_fdef_SUBSTITUTE: 'Returns text1 with the all occurrences of oldtext replaced by newtext. If \"occurrence\" is present, then only that occurrence is replaced. ',\n   s_fdef_SUM: 'Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ',\n   s_fdef_SUMIF: 'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',\n   s_fdef_SYD: 'Depreciation by Sum of Year\\'s Digits method. ',\n   s_fdef_T: 'Returns the text value or else a null string. ',\n   s_fdef_TAN: 'Trigonometric tangent function (value is in radians) ',\n   s_fdef_TIME: 'Returns the time value given the specified hour, minute, and second. ',\n   s_fdef_TODAY: 'Returns the current date (an integer). Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\n   s_fdef_TRIM: 'Returns the text value with leading, trailing, and repeated spaces removed. ',\n   s_fdef_TRUE: 'Returns the logical value \"true\". ',\n   s_fdef_TRUNC: 'Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ',\n   s_fdef_UPPER: 'Returns the text value with all lowercase characters converted to uppercase. ',\n   s_fdef_VALUE: 'Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ',\n   s_fdef_VAR: 'Returns the sample variance of the numeric values. ',\n   s_fdef_VARP: 'Returns the variance of the numeric values. ',\n   s_fdef_VLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ',\n   s_fdef_WEEKDAY: 'Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ',\n   s_fdef_YEAR: 'Returns the year part of a date value. ',\n   s_fdef_SUMPRODUCT: 'Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.',\n   s_fdef_CEILING: 'Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)',\n   s_fdef_FLOOR: 'Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)',\n\n   s_farg_v: \"value\",\n   s_farg_vn: \"value1, value2, ...\",\n   s_farg_xy: \"valueX, valueY\",\n   s_farg_choose: \"index, value1, value2, ...\",\n   s_farg_range: \"range\",\n   s_farg_rangec: \"range, criteria\",\n   s_farg_date: \"year, month, day\",\n   s_farg_dfunc: \"databaserange, fieldname, criteriarange\",\n   s_farg_ddb: \"cost, salvage, lifetime, period, [factor]\",\n   s_farg_find: \"string1, string2, [start]\",\n   s_farg_fv: \"rate, n, payment, [pv, [paytype]]\",\n   s_farg_hlookup: \"value, range, row, [rangelookup]\",\n   s_farg_iffunc: \"logical-expression, true-value, [false-value]\",\n   s_farg_index: \"range, rownum, colnum\",\n   s_farg_irr: \"range, [guess]\",\n   s_farg_tc: \"text, count\",\n   s_farg_log: \"value, base\",\n   s_farg_match: \"value, range, [rangelookup]\",\n   s_farg_mid: \"text, start, length\",\n   s_farg_nper: \"rate, payment, pv, [fv, [paytype]]\",\n   s_farg_npv: \"rate, value1, value2, ...\",\n   s_farg_pmt: \"rate, n, pv, [fv, [paytype]]\",\n   s_farg_pv: \"rate, n, payment, [fv, [paytype]]\",\n   s_farg_rate: \"n, payment, pv, [fv, [paytype, [guess]]]\",\n   s_farg_replace: \"text1, start, length, text2\",\n   s_farg_vp: \"value, [precision]\",\n   s_farg_valpre: \"value, precision\",\n   s_farg_csl: \"cost, salvage, lifetime\",\n   s_farg_cslp: \"cost, salvage, lifetime, period\",\n   s_farg_subs: \"text1, oldtext, newtext, [occurrence]\",\n   s_farg_sumif: \"range1, criteria, [range2]\",\n   s_farg_hms: \"hour, minute, second\",\n   s_farg_txt: \"text\",\n   s_farg_vlookup: \"value, range, col, [rangelookup]\",\n   s_farg_weekday: \"date, [type]\",\n   s_farg_dt: \"date\",\n   s_farg_rangen: \"range1, range2, ...\",\n   s_farg_vsig: 'value, [significance]',\n\n   function_classlist: [\"all\", \"stat\", \"lookup\", \"datetime\", \"financial\", \"test\", \"math\", \"text\", \"gui\", \"action\"], // order of function classes\n\n   s_fclass_all: \"All\",\n   s_fclass_stat: \"Statistics\",\n   s_fclass_lookup: \"Lookup\",\n   s_fclass_datetime: \"Date & Time\",\n   s_fclass_financial: \"Financial\",\n   s_fclass_test: \"Test\",\n   s_fclass_math: \"Math\",\n   s_fclass_text: \"Text\",\n   s_fclass_action: \"Email & Copy\",\n   s_fclass_gui: \"Button & Input\",\n\n   lastone: null\n\n   };\n\n// Default classnames for use with SocialCalc.ConstantsSetClasses:\n\nSocialCalc.ConstantsDefaultClasses = {\n   defaultComment: \"\",\n   defaultCommentNoGrid: \"\",\n   defaultHighlightTypeCursor: \"\",\n   defaultHighlightTypeRange: \"\",\n   defaultColname: \"\",\n   defaultSelectedColname: \"\",\n   defaultRowname: \"\",\n   defaultSelectedRowname: \"\", \n   defaultUpperLeft: \"\",\n   defaultSkippedCell: \"\",\n   defaultPaneDivider: \"\",\n   cteGriddiv: \"\", // this one has no Style version with it\n   defaultInputEcho: {classname: \"\", style: \"filter:alpha(opacity=90);opacity:.9;\"}, // so FireFox won't show warning\n   TCmain: \"\",\n   TCendcap: \"\",\n   TCpaneslider: \"\",\n   TClessbutton: \"\",\n   TCmorebutton: \"\",\n   TCscrollarea: \"\",\n   TCthumb: \"\",\n   TCPStrackingline: \"\",\n   TCTDFSthumbstatus: \"\",\n   TDpopupElement: \"\"\n   };\n\n//\n// SocialCalc.ConstantsSetClasses(prefix)\n//\n// This routine goes through all of the xyzClass/xyzStyle pairs and sets the Class to a default and\n// turns off the Style, if present. The prefix is put before each default.\n// The list of items to set is in SocialCalc.ConstantsDefaultClasses. The names there\n// correspond to the \"xyz\" parts. If there is a value, it is the default to set. If the\n// default is a null, no change is made. If the default is the null string (\"\"), the\n// name of the item is used (e.g., \"defaultComment\" would use the classname \"defaultComment\").\n// If the default is an object, then it expects {classname: classname, style: stylestring} - this\n// lets you combine both.\n//\n\nSocialCalc.ConstantsSetClasses = function(prefix) {\n\n   var defaults = SocialCalc.ConstantsDefaultClasses;\n   var scc = SocialCalc.Constants;\n   var item;\n\n   prefix = prefix || \"\";\n\n   for (item in defaults) {\n      if (typeof defaults[item] == \"string\") {\n         scc[item+\"Class\"] = prefix + (defaults[item] || item);\n         if (scc[item+\"Style\"] !== undefined) {\n            scc[item+\"Style\"] = \"\";\n            }\n         }\n      else if (typeof defaults[item] == \"object\") {\n         scc[item+\"Class\"] = prefix + (defaults[item].classname || item);\n         scc[item+\"Style\"] = defaults[item].style;\n         }\n      }\n   }\n\n// Set the image prefix on all images.\n\nSocialCalc.ConstantsSetImagePrefix = function(imagePrefix) {\n\n   var scc = SocialCalc.Constants;\n\n   for (var item in scc) {\n      if (typeof scc[item] == \"string\") {\n         scc[item] = scc[item].replace(scc.defaultImagePrefix, imagePrefix);\n         }\n      }\n   scc.defaultImagePrefix = imagePrefix;\n\n   }\n\n//\n// The main SocialCalc code module of the SocialCalc package\n//\n/*\n// (c) Copyright 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of\n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n \n/*\n\n**** Overview ****\n\nThis is the beginning of a library of routines for displaying and editing spreadsheet\ndata in a browser. The HTML that includes this does not need to have anything\nspecific to the spreadsheet or editor already present -- everything is dynamically\nadded to the DOM by this code, including the rendered sheet and any editing controls.\n\nThe library has a few parts. This is the main SocialCalc code module.\nOther parts are the Table Editor module, the Formula module, and the Format Number module.\nNote: The Table Editor module is licensed under a different license than this module.\n\nThe class/object style is derived from O'Reilly's JavaScript by Flanagan, 5th Edition,\nsection 9.3, page 157.\n\nAll of the data, object definitions, functions, etc., are stored as properties of the SocialCalc\nobject so as not to clutter up the global variables nor conflict with other names.\n\nA design goal (not tested yet for success) is to make it possible to have more than one\nspreadsheet active on a page, perhaps even open for editing. It is assumed, though, that\nthere is only one mouse and one keyboard (a good assumption on most PCs today but not in the\nnew \"touch and surface world\" Apple and Microsoft are working towards).\n\nThe testing has been on Windows Firefox (2 and 3),\nInternet Explorer (6 and 7), Opera (9.23 and mainly later), Mac Safari (3.1), and Mac Firefox (2.0.0.6).\nThere are small issues with Firefox before 2.0 (cosmetic with drag handles) and larger ones\nwith Opera before 9.5 (the Delete key isn't recognized in some cases -- the 9.5 version was still\nin beta and this bug affects other products like GMail, I believe).\n\nThe data is stored in a SocialCalc.Sheet object. The data is organized in a form similar to that\nused by SocialCalc 1.1.0. There is a function for converting a normal SocialCalc spreadsheet\nsave data string (the spreadsheet part of a SocialCalc data file) into this internal form.\n\nThe SocialCalc.RenderContext class provides methods for rendering a table into the DOM representing\npart of the spreadsheet. It is assumed that the spreadsheet could possibly be very large\nand that rendering the whole thing at once could be too time consuming. It is also set up so\nthat it might be possible to have some of the sheet data only be loaded on demand (such as by Ajax).\nThe rendering can render cells to the right and below the already active area of the spreadsheet\nso that you can scroll to that \"clean\" area without explicitly doing \"add row/column\". The class also\ndoes simple operations such as \"scrolling\" within that table. The table may optionally include\nrow and column headers and may be split into panes. Most of the code assumes any number of panes,\nbut only the rightmost pane has scrolling code. In normal operation there would be one or two\npanes horizontally and vertically. The panes may start on any row/column, though a given row/column\nshould only appear in one pane at a time (not all code enforces this, yet).\n\nThe RenderContext is designed to be rendered as part of a SocialCalc.TableEditor. The TableEditor\nincludes the spreadsheet grid as well as scrollbars, pane sliders, and (eventually) editing controls.\nThe layout is dynamic and may be recomputed on the fly, such as in response to resizing the browser\nwindow.\n\nThe scrollbars and pane sliders are created using SocialCalc.TableControl objects. These in turn\nmake use of Dragging, ToolTip, Button, and MouseWheel functions.\n\nThe keyboard input is handled by keyboard code.\n\nThere are also some helper routines.\n\nMore comments yet to come...\n\n*/\n\n\nvar SocialCalc;\nif (!SocialCalc) SocialCalc = {};\n\n// *************************************\n//\n// Shared values\n//\n// These are \"global\" values shared by the classes, including default settings\n//\n// *************************************\n\n// Callbacks\n\nSocialCalc.Callbacks = {\n\n   // The next two are used by SocialCalc.format_text_for_display\n\n   // The function to expand wiki text - should be set if you want wikitext expansion\n   // The form is: expand_wiki(displayvalue, sheetobj, linkstyle, valueformat)\n   //    valueformat is text-wiki followed by optional sub-formats, e.g., text-wikipagelink\n\n   expand_wiki: null,\n\n   expand_markup: function(displayvalue, sheetobj, linkstyle) // the old function to expand wiki text - may be replaced\n                   {return SocialCalc.default_expand_markup(displayvalue, sheetobj, linkstyle);},\n\n   // MakePageLink is used to create the href for a link to another \"page\"\n   // The form is: MakePageLink(pagename, workspacename, linktyle, valueformat), returns string\n\n   MakePageLink: null,\n\n   // NormalizeSheetName is used to make different variations of sheetnames use the same cache slot\n\n   NormalizeSheetName: null // use default - lowercase\n\n   };\n\n// Shared flags\n\n   // none at present\n\n\n// *************************************\n//\n// Cell class:\n//\n// *************************************\n\n//\n// Class SocialCalc.Cell\n//\n// Usage: var s = new SocialCalc.Cell(coord);\n//\n// Cell attributes include:\n//\n//    coord: the column/row as a string, e.g., \"A1\"\n//    datavalue: the value to be used for computation and formatting for display,\n//               string or numeric (tolerant of numbers stored as strings)\n//    datatype: if present, v=numeric value, t=text value, f=formula,\n//              or c=constant that is not a simple number (like \"$1.20\")\n//    formula: if present, the formula (without leading \"=\") for computation or the constant\n//    valuetype: first char is main type, the following are sub-types.\n//               Main types are b=blank cell, n=numeric, t=text, e=error\n//               Examples of using sub-types would be \"nt\" for a numeric time value, \"n$\" for currency, \"nl\" for logical\n//    readonly: if present, whether the current cell is read-only of writable\n//    displayvalue: if present, rendered version of datavalue with formatting attributes applied\n//    parseinfo: if present, cached parsed version of formula\n//\n//    The following optional values, if present, are mainly used in rendering, overriding defaults:\n//\n//    bt, br, bb, bl: number of border's definition\n//    layout: layout (vertical alignment, padding) definition number\n//    font: font definition number\n//    color: text color definition number\n//    bgcolor: background color definition number\n//    cellformat: cell format (horizontal alignment) definition number\n//    nontextvalueformat: custom format definition number for non-text values, e.g., numbers\n//    textvalueformat: custom format definition number for text values\n//    colspan, rowspan: number of cells to span for merged cells (only on main cell)\n//    cssc: custom css classname for cell, as text (no special chars)\n//    csss: custom css style definition\n//    mod: modification allowed flag \"y\" if present\n//    comment: cell comment string\n//\n\n// Eddy - SocialCalc.Cell\n\nSocialCalc.Cell = function(coord) {\n\n   this.coord = coord;\n   this.datavalue = \"\";\n   this.datatype = null;\n   this.formula = \"\";\n   this.valuetype = \"b\";\n   this.readonly = false;\n\n   }\n\n// The types of cell properties\n//\n// Type 1: Base, Type 2: Attribute, Type 3: Special (e.g., displaystring, parseinfo)\n\nSocialCalc.CellProperties = {\n   coord: 1, datavalue: 1, datatype: 1, formula: 1, valuetype: 1, errors: 1, comment: 1, readonly: 1,\n   bt: 2, br: 2, bb: 2, bl: 2, layout: 2, font: 2, color: 2, bgcolor: 2,\n   cellformat: 2, nontextvalueformat: 2, textvalueformat: 2, colspan: 2, rowspan: 2,\n   cssc: 2, csss: 2, mod: 2,\n   displaystring: 3, // used to cache rendered HTML of cell contents\n   parseinfo: 3, // used to cache parsed formulas\n   hcolspan: 3, hrowspan: 3 // spans taking hidden cols/rows into account (!!! NOT YET !!!)\n   };\n\nSocialCalc.CellPropertiesTable = {\n   bt: \"borderstyle\", br: \"borderstyle\", bb: \"borderstyle\", bl: \"borderstyle\",\n   layout: \"layout\", font: \"font\", color: \"color\", bgcolor: \"color\",\n   cellformat: \"cellformat\", nontextvalueformat: \"valueformat\", textvalueformat: \"valueformat\"\n   };\n\n// *************************************\n//\n// Sheet class:\n//\n// *************************************\n\n//\n// Class SocialCalc.Sheet\n//\n// Usage: var s = new SocialCalc.Sheet();\n//\n\nSocialCalc.Sheet = function() {\n\n   SocialCalc.ResetSheet(this);\n\n   // Set other values:\n   //\n   // sheet.statuscallback(data, status, arg, this.statuscallbackparams) is called\n   // during recalc and commands.\n   //\n   // During recalc, data is the current recalcdata.\n   // The values for status and the corresponding arg are:\n   //\n   //    calcorder, {coord: coord, total: celllist length, count: count} [0 or more times per recalc]\n   //    calccheckdone, calclist length [once per recalc]\n   //    calcstep, {coord: coord, total: calclist length, count: count} [0 or more times per recalc]\n   //    calcloading, {sheetname: name-of-sheet}\n   //    calcserverfunc, {funcname: name-of-function, coord: coord, total: calclist length, count: count}\n   //    calcfinished, time in milliseconds [once per recalc]\n   //\n   // During commands, data is SocialCalc.SheetCommandInfo.\n   // These values for status and arg are:\n   //\n   //    cmdstart, cmdstr\n   //    cmdend\n   //\n\n   this.statuscallback = null; // routine called with cmdstart, calcstart, etc., status and args:\n                                // sheet.statuscallback(data, status, arg, params)\n   this.statuscallbackparams = null; // parameters passed to that routine\n\n   }\n\n//\n// SocialCalc.ResetSheet(sheet)\n//\n// Resets (and/or initializes) sheet data values.\n// \n\nSocialCalc.ResetSheet = function(sheet, reload) {\n\n   // properties:\n\n   sheet.cells = {}; // at least one for each non-blank cell: coord: cell-object\n   sheet.attribs = // sheet attributes\n      {\n         lastcol: 1,\n         lastrow: 1,\n         defaultlayout: 0,\n         usermaxcol: 0,\n         usermaxrow: 0\n\n      };\n   sheet.rowattribs =\n      {\n         hide: {}, // access by row number\n         height: {}\n      };\n   sheet.colattribs =\n      {\n         width: {}, // access by col name\n         hide: {}\n      };\n   sheet.names={}; // Each is: {desc: \"optional description\", definition: \"B5, A1:B7, or =formula\"}\n   sheet.layouts=[];\n   sheet.layouthash={};\n   sheet.fonts=[];\n   sheet.fonthash={};\n   sheet.colors=[];\n   sheet.colorhash={};\n   sheet.borderstyles=[];\n   sheet.borderstylehash={};\n   sheet.cellformats=[];\n   sheet.cellformathash={};\n   sheet.valueformats=[];\n   sheet.valueformathash={};\n   sheet.matched_cells=[];\n   sheet.selected_search_cell=undefined;\n\n   sheet.copiedfrom = \"\"; // if a range, then this was loaded from a saved range as clipboard content\n\n   sheet.changes = new SocialCalc.UndoStack();\n\n   sheet.renderneeded = false;\n\n   sheet.changedrendervalues = true; // if true, spans and/or fonts have changed (set by ExecuteSheetCommand & GetStyle)\n\n   sheet.recalcchangedavalue = false; // true if a recalc resulted in a change to a cell's calculated value\n\n   sheet.hiddencolrow = \"\"; // \"col\" or \"row\" if it was hidden\n\n   sheet.sci = new SocialCalc.SheetCommandInfo(sheet);\n\n   sheet.ioEventTree ={};\n   sheet.ioParameterList = {}; \n\n   }\n\n// Methods:\n\nSocialCalc.Sheet.prototype.ResetSheet = function() {SocialCalc.ResetSheet(this);};\nSocialCalc.Sheet.prototype.AddCell = function(newcell) {return this.cells[newcell.coord]=newcell;};\nSocialCalc.Sheet.prototype.LastCol = function() { \n    var last_col = 1;\n    for (var cell_id  in this.cells) {\n        var cr = SocialCalc.coordToCr(cell_id);\n        if (cr.col > last_col) {\n            last_col = cr.col;\n        }\n    }\n    return last_col;\n}\nSocialCalc.Sheet.prototype.LastRow = function() { \n    var last_row = 1;\n    for (var cell_id  in this.cells) {\n        var cr = SocialCalc.coordToCr(cell_id);\n        if (cr.row > last_row) {\n            last_row = cr.row;\n        }\n    }\n    return last_row;\n} \nSocialCalc.Sheet.prototype.GetAssuredCell = function(coord) {\n   return this.cells[coord] || this.AddCell(new SocialCalc.Cell(coord));\n   };\nSocialCalc.Sheet.prototype.ParseSheetSave = function(savedsheet) {SocialCalc.ParseSheetSave(savedsheet,this);};\nSocialCalc.Sheet.prototype.CellFromStringParts = function(cell, parts, j) {return SocialCalc.CellFromStringParts(this, cell, parts, j);};\nSocialCalc.Sheet.prototype.CreateSheetSave = function(range, canonicalize) {return SocialCalc.CreateSheetSave(this, range, canonicalize);};\nSocialCalc.Sheet.prototype.CellToString = function(cell) {return SocialCalc.CellToString(this, cell);};\nSocialCalc.Sheet.prototype.CanonicalizeSheet = function(full) {return SocialCalc.CanonicalizeSheet(this, full);};\nSocialCalc.Sheet.prototype.EncodeCellAttributes = function(coord) {return SocialCalc.EncodeCellAttributes(this, coord);};\nSocialCalc.Sheet.prototype.EncodeSheetAttributes = function() {return SocialCalc.EncodeSheetAttributes(this);};\nSocialCalc.Sheet.prototype.DecodeCellAttributes = function(coord, attribs, range) {return SocialCalc.DecodeCellAttributes(this, coord, attribs, range);};\nSocialCalc.Sheet.prototype.DecodeSheetAttributes = function(attribs) {return SocialCalc.DecodeSheetAttributes(this, attribs);};\n\nSocialCalc.Sheet.prototype.ScheduleSheetCommands = function(cmd, saveundo) {return SocialCalc.ScheduleSheetCommands(this, cmd, saveundo);};\nSocialCalc.Sheet.prototype.SheetUndo = function() {return SocialCalc.SheetUndo(this);};\nSocialCalc.Sheet.prototype.SheetRedo = function() {return SocialCalc.SheetRedo(this);};\nSocialCalc.Sheet.prototype.CreateAuditString = function() {return SocialCalc.CreateAuditString(this);};\nSocialCalc.Sheet.prototype.GetStyleNum = function(atype, style) {return SocialCalc.GetStyleNum(this, atype, style);};\nSocialCalc.Sheet.prototype.GetStyleString = function(atype, num) {return SocialCalc.GetStyleString(this, atype, num);};\nSocialCalc.Sheet.prototype.RecalcSheet = function() {return SocialCalc.RecalcSheet(this);};\n\n//\n// Sheet save format:\n//\n// linetype:param1:param2:...\n//\n// Linetypes are:\n//\n//    version:versionname - version of this format. Currently 1.4.\n//\n//    cell:coord:type:value...:type:value... - Types are as follows:\n//\n//       v:value - straight numeric value\n//       t:value - straight text/wiki-text in cell, encoded to handle \\, :, newlines\n//       vt:fulltype:value - value with value type/subtype\n//       vtf:fulltype:value:formulatext - formula resulting in value with value type/subtype, value and text encoded\n//       vtc:fulltype:value:valuetext - formatted text constant resulting in value with value type/subtype, value and text encoded\n//       vf:fvalue:formulatext - formula resulting in value, value and text encoded (obsolete: only pre format version 1.1)\n//          fvalue - first char is \"N\" for numeric value, \"T\" for text value, \"H\" for HTML value, rest is the value\n//       e:errortext - Error text. Non-blank means formula parsing/calculation results in error.\n//       b:topborder#:rightborder#:bottomborder#:leftborder# - border# in sheet border list or blank if none\n//       l:layout# - number in cell layout list\n//       f:font# - number in sheet fonts list\n//       c:color# - sheet color list index for text\n//       bg:color# - sheet color list index for background color\n//       cf:format# - sheet cell format number for explicit format (align:left, etc.)\n//       cvf:valueformat# - sheet cell value format number (obsolete: only pre format v1.2)\n//       tvf:valueformat# - sheet cell text value format number\n//       ntvf:valueformat# - sheet cell non-text value format number\n//       colspan:numcols - number of columns spanned in merged cell\n//       rowspan:numrows - number of rows spanned in merged cell\n//       cssc:classname - name of CSS class to be used for cell when published instead of one calculated here\n//       csss:styletext - explicit CSS style information, encoded to handle :, etc.\n//       mod:allow - if \"y\" allow modification of cell for live \"view\" recalc\n//       comment:value - encoded text of comment for this cell (added in v1.5)\n//\n//    col:\n//       w:widthval - number, \"auto\" (no width in <col> tag), number%, or blank (use default)\n//       hide: - yes/no, no is assumed if missing\n//    row:\n//       hide - yes/no, no is assumed if missing\n//\n//    sheet:\n//       c:lastcol - number\n//       r:lastrow - number\n//       w:defaultcolwidth - number, \"auto\", number%, or blank (default->80)\n//       h:defaultrowheight - not used\n//       tf:format# - cell format number for sheet default for text values\n//       ntf:format# - cell format number for sheet default for non-text values (i.e., numbers)\n//       layout:layout# - default cell layout number in cell layout list\n//       font:font# - default font number in sheet font list\n//       vf:valueformat# - default number value format number in sheet valueformat list (obsolete: only pre format version 1.2)\n//       ntvf:valueformat# - default non-text (number) value format number in sheet valueformat list\n//       tvf:valueformat# - default text value format number in sheet valueformat list\n//       color:color# - default number for text color in sheet color list\n//       bgcolor:color# - default number for background color in sheet color list\n//       circularreferencecell:coord - cell coord with a circular reference\n//       recalc:value - on/off (on is default). If not \"off\", appropriate changes to the sheet cause a recalc\n//       needsrecalc:value - yes/no (no is default). If \"yes\", formula values are not up to date\n//       usermaxcol:value - maximum column to display, 0 for unlimited (default=0)\n//       usermaxrow:value - maximum row to display, 0 for unlimited (default=0)\n//\n//    name:name:description:value - name definition, name in uppercase, with value being \"B5\", \"A1:B7\", or \"=formula\";\n//                                  description and value are encoded.\n//    font:fontnum:value - text of font definition (style weight size family) for font fontnum\n//                         \"*\" for \"style weight\", size, or family, means use default (first look to sheet, then builtin)\n//    color:colornum:rgbvalue - text of color definition (e.g., rgb(255,255,255)) for color colornum\n//    border:bordernum:value - text of border definition (thickness style color) for border bordernum\n//    layout:layoutnum:value - text of vertical alignment and padding style for cell layout layoutnum (* for default):\n//                             vertical-alignment:vavalue;padding:topval rightval bottomval leftval;\n//    cellformat:cformatnum:value - text of cell alignment (left/center/right) for cellformat cformatnum\n//    valueformat:vformatnum:value - text of number format (see FormatValueForDisplay) for valueformat vformatnum (changed in v1.2)\n//    clipboardrange:upperleftcoord:bottomrightcoord - ignored -- from wikiCalc\n//    clipboard:coord:type:value:... - ignored -- from wikiCalc\n//\n// If this is clipboard contents, then there is also information to facilitate pasting:\n//\n//    copiedfrom:upperleftcoord:bottomrightcoord - range from which this was copied\n//\n\n// Functions:\n\nSocialCalc.ParseSheetSave = function(savedsheet,sheetobj) {\n\n   var lines=savedsheet.split(/\\r\\n|\\n/);\n   var parts=[];\n   var line;\n   var i, j, t, v, coord, cell, attribs, name;\n   var scc = SocialCalc.Constants;\n\n   for (i=0;i<lines.length;i++) {\n      line=lines[i];\n      parts = line.split(\":\");\n      switch (parts[0]) {\n         case \"cell\":\n            cell=sheetobj.GetAssuredCell(parts[1]);\n            j=2;\n            sheetobj.CellFromStringParts(cell, parts, j);\n            break;\n\n         case \"col\":\n            coord=parts[1];\n            j=2;\n            while (t=parts[j++]) {\n               switch (t) {\n                  case \"w\":\n                     sheetobj.colattribs.width[coord]=parts[j++]; // must be text - could be auto or %, etc.\n                     break;\n                  case \"hide\":\n                     sheetobj.colattribs.hide[coord]=parts[j++];\n                     break;\n                  default:\n                     throw scc.s_pssUnknownColType+\" '\"+t+\"'\";\n                     break;\n                  }\n               }\n            break;\n\n         case \"row\":\n            coord=parts[1]-0;\n            j=2;\n            while (t=parts[j++]) {\n               switch (t) {\n                  case \"h\":\n                     sheetobj.rowattribs.height[coord]=parts[j++]-0;\n                     break;\n                  case \"hide\":\n                     sheetobj.rowattribs.hide[coord]=parts[j++];\n                     break;\n                  default:\n                     throw scc.s_pssUnknownRowType+\" '\"+t+\"'\";\n                     break;\n                  }\n               }\n            break;\n\n         case \"sheet\":\n            attribs=sheetobj.attribs;\n            j=1;\n            while (t=parts[j++]) {\n               switch (t) {\n                  case \"c\":\n                     attribs.lastcol=parts[j++]-0;\n                     break;\n                  case \"r\":\n                     attribs.lastrow=parts[j++]-0;\n                     break;\n                  case \"w\":\n                     attribs.defaultcolwidth=parts[j++]+\"\";\n                     break;\n                  case \"h\":\n                     attribs.defaultrowheight=parts[j++]-0;\n                     break;\n                  case \"tf\":\n                     attribs.defaulttextformat=parts[j++]-0;\n                     break;\n                  case \"ntf\":\n                     attribs.defaultnontextformat=parts[j++]-0;\n                     break;\n                  case \"layout\":\n                     attribs.defaultlayout=parts[j++]-0;\n                     break;\n                  case \"font\":\n                     attribs.defaultfont=parts[j++]-0;\n                     break;\n                  case \"tvf\":\n                     attribs.defaulttextvalueformat=parts[j++]-0;\n                     break;\n                  case \"ntvf\":\n                     attribs.defaultnontextvalueformat=parts[j++]-0;\n                     break;\n                  case \"color\":\n                     attribs.defaultcolor=parts[j++]-0;\n                     break;\n                  case \"bgcolor\":\n                     attribs.defaultbgcolor=parts[j++]-0;\n                     break;\n                  case \"circularreferencecell\":\n                     attribs.circularreferencecell=parts[j++];\n                     break;\n                  case \"recalc\":\n                     attribs.recalc=parts[j++];\n                     break;\n                  case \"needsrecalc\":\n                     attribs.needsrecalc=parts[j++];\n                     break;\n                  case \"usermaxcol\":\n                     attribs.usermaxcol=parts[j++]-0;\n                     break;\n                  case \"usermaxrow\":\n                     attribs.usermaxrow=parts[j++]-0;\n                     break;\n                  default:\n                     j+=1;\n                     break;\n                  }\n               }\n            break;\n\n         case \"name\":\n            name = SocialCalc.decodeFromSave(parts[1]).toUpperCase();\n            sheetobj.names[name] = {desc: SocialCalc.decodeFromSave(parts[2])};\n            sheetobj.names[name].definition = SocialCalc.decodeFromSave(parts[3]);\n            break;\n\n         case \"layout\":\n            parts=lines[i].match(/^layout\\:(\\d+)\\:(.+)$/); // layouts can have \":\" in them\n            sheetobj.layouts[parts[1]-0]=parts[2];\n            sheetobj.layouthash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"font\":\n            sheetobj.fonts[parts[1]-0]=parts[2];\n            sheetobj.fonthash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"color\":\n            sheetobj.colors[parts[1]-0]=parts[2];\n            sheetobj.colorhash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"border\":\n            sheetobj.borderstyles[parts[1]-0]=parts[2];\n            sheetobj.borderstylehash[parts[2]]=parts[1]-0;\n            break;\n\n         case \"cellformat\":\n            v=SocialCalc.decodeFromSave(parts[2]);\n            sheetobj.cellformats[parts[1]-0]=v;\n            sheetobj.cellformathash[v]=parts[1]-0;\n            break;\n\n         case \"valueformat\":\n            v=SocialCalc.decodeFromSave(parts[2]);\n            sheetobj.valueformats[parts[1]-0]=v;\n            sheetobj.valueformathash[v]=parts[1]-0;\n            break;\n\n         case \"version\":\n            break;\n\n         case \"copiedfrom\":\n            sheetobj.copiedfrom = parts[1]+\":\"+parts[2];\n            break;\n\n         case \"clipboardrange\": // in save versions up to 1.3. Ignored.\n         case \"clipboard\":\n            break;\n\n         case \"\":\n            break;\n\n         default:\nalert(scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\");\n            throw scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\";\n            break;\n         }\n      parts = null;\n      }\n\n   }\n\n//\n// SocialCalc.CellFromStringParts(sheet, cell, parts, j)\n//\n// Takes string that has been split by \":\" in parts, starting at item j,\n// and fills in cell assuming save format.\n//\n\nSocialCalc.CellFromStringParts = function(sheet, cell, parts, j) {\n\n   var cell, t, v;\n\n   while (t=parts[j++]) {\n      switch (t) {\n         case \"v\":\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n            cell.datatype=\"v\";\n            cell.valuetype=\"n\";\n            break;\n         case \"t\":\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n            cell.datatype=\"t\";\n            cell.valuetype=SocialCalc.Constants.textdatadefaulttype; \n            break;\n         case \"vt\":\n            v=parts[j++];\n            cell.valuetype=v;\n            if (v.charAt(0)==\"n\") {\n               cell.datatype=\"v\";\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n               }\n            else {\n               cell.datatype=\"t\";\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n               }\n            break;\n         case \"vtf\":\n            v=parts[j++];\n            cell.valuetype=v;\n            if (v.charAt(0)==\"n\") {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n               }\n            else {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n               }\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\n            cell.datatype=\"f\";\n            break;\n         case \"vtc\":\n            v=parts[j++];\n            cell.valuetype=v;\n            if (v.charAt(0)==\"n\") {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\n               }\n            else {\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\n               }\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\n            cell.datatype=\"c\";\n            break;\n         case \"ro\":\n            ro=SocialCalc.decodeFromSave(parts[j++]);\n            cell.readonly=ro.toLowerCase()==\"yes\";\n            break;\n         case \"e\":\n            cell.errors=SocialCalc.decodeFromSave(parts[j++]);\n            break;\n         case \"b\":\n            cell.bt=parts[j++]-0;\n            cell.br=parts[j++]-0;\n            cell.bb=parts[j++]-0;\n            cell.bl=parts[j++]-0;\n            break;\n         case \"l\":\n            cell.layout=parts[j++]-0;\n            break;\n         case \"f\":\n            cell.font=parts[j++]-0;\n            break;\n         case \"c\":\n            cell.color=parts[j++]-0;\n            break;\n         case \"bg\":\n            cell.bgcolor=parts[j++]-0;\n            break;\n         case \"cf\":\n            cell.cellformat=parts[j++]-0;\n            break;\n         case \"ntvf\":\n            cell.nontextvalueformat=parts[j++]-0;\n            break;\n         case \"tvf\":\n            cell.textvalueformat=parts[j++]-0;\n            break;\n         case \"colspan\":\n            cell.colspan=parts[j++]-0;\n            break;\n         case \"rowspan\":\n            cell.rowspan=parts[j++]-0;\n            break;\n         case \"cssc\":\n            cell.cssc=parts[j++];\n            break;\n         case \"csss\":\n            cell.csss=SocialCalc.decodeFromSave(parts[j++]);\n            break;\n         case \"mod\":\n            j+=1;\n            break;\n         case \"comment\":\n            cell.comment=SocialCalc.decodeFromSave(parts[j++]);\n            break;\n         default:\n            throw SocialCalc.Constants.s_cfspUnknownCellType+\" '\"+t+\"'\";\n            break;\n         }\n      }\n\n   }\n\n\nSocialCalc.sheetfields = [\"defaultrowheight\", \"defaultcolwidth\", \"circularreferencecell\", \"recalc\", \"needsrecalc\", \"usermaxcol\", \"usermaxrow\"];\nSocialCalc.sheetfieldsshort = [\"h\", \"w\", \"circularreferencecell\", \"recalc\", \"needsrecalc\", \"usermaxcol\", \"usermaxrow\"];\n\nSocialCalc.sheetfieldsxlat = [\"defaulttextformat\", \"defaultnontextformat\",\n                              \"defaulttextvalueformat\", \"defaultnontextvalueformat\",\n                              \"defaultcolor\", \"defaultbgcolor\", \"defaultfont\", \"defaultlayout\"];\nSocialCalc.sheetfieldsxlatshort = [\"tf\", \"ntf\", \"tvf\", \"ntvf\", \"color\", \"bgcolor\", \"font\", \"layout\"];\nSocialCalc.sheetfieldsxlatxlt = [\"cellformat\", \"cellformat\", \"valueformat\", \"valueformat\",\n                                  \"color\", \"color\", \"font\", \"layout\"];\n\n//\n// sheetstr = SocialCalc.CreateSheetSave(sheetobj, range, canonicalize)\n//\n// Creates a text representation of the sheetobj data.\n// If the range is present then only those cells are saved\n// (as clipboard data with \"copiedfrom\" set).\n//\n\nSocialCalc.CreateSheetSave = function(sheetobj, range, canonicalize) {\n\n   var cell, cr1, cr2, row, col, coord, attrib, line, value, formula, i, t, r, b, l, name, blanklen;\n   var result=[];\n\n   var prange;\n\n   sheetobj.CanonicalizeSheet(canonicalize || SocialCalc.Constants.doCanonicalizeSheet);\n   var xlt = sheetobj.xlt;\n\n   if (range) {\n      prange = SocialCalc.ParseRange(range);\n      }\n   else {\n      prange = {cr1: {row: 1, col:1},\n                cr2: {row: xlt.maxrow, col: xlt.maxcol}};\n      }\n   cr1 = prange.cr1;\n   cr2 = prange.cr2;\n\n   result.push(\"version:1.5\");\n\n   for (row=cr1.row; row <= cr2.row; row++) {\n      for (col=cr1.col; col <= cr2.col; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         cell=sheetobj.cells[coord];\n         if (!cell) continue;\n         line=sheetobj.CellToString(cell);\n         if (line.length==0) continue; // ignore completely empty cells\n         line=\"cell:\"+coord+line;\n         result.push(line);\n         }\n      }\n\n   for (col=1; col <= xlt.maxcol; col++) {\n      coord = SocialCalc.rcColname(col);\n      if (sheetobj.colattribs.width[coord])\n         result.push(\"col:\"+coord+\":w:\"+sheetobj.colattribs.width[coord]);\n      if (sheetobj.colattribs.hide[coord])\n         result.push(\"col:\"+coord+\":hide:\"+sheetobj.colattribs.hide[coord]);\n      }\n\n   for (row=1; row <= xlt.maxrow; row++) {\n      if (sheetobj.rowattribs.height[row])\n         result.push(\"row:\"+row+\":h:\"+sheetobj.rowattribs.height[row]);\n      if (sheetobj.rowattribs.hide[row])\n         result.push(\"row:\"+row+\":hide:\"+sheetobj.rowattribs.hide[row]);\n      }\n\n   line=\"sheet:c:\"+xlt.maxcol+\":r:\"+xlt.maxrow;\n\n   for (i=0; i<SocialCalc.sheetfields.length; i++) { // non-xlated values\n      value = SocialCalc.encodeForSave(sheetobj.attribs[SocialCalc.sheetfields[i]]);\n      if (value) line+=\":\"+SocialCalc.sheetfieldsshort[i]+\":\"+value;\n      }\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // xlated values\n      value = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\n      if (value) line+=\":\"+SocialCalc.sheetfieldsxlatshort[i]+\":\"+xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sxlat\"][value];\n      }\n\n   result.push(line);\n\n   for (i=1;i<xlt.newborderstyles.length;i++) {\n      result.push(\"border:\"+i+\":\"+xlt.newborderstyles[i]);\n      }\n\n   for (i=1;i<xlt.newcellformats.length;i++) {\n      result.push(\"cellformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newcellformats[i]));\n      }\n\n   for (i=1;i<xlt.newcolors.length;i++) {\n      result.push(\"color:\"+i+\":\"+xlt.newcolors[i]);\n      }\n\n   for (i=1;i<xlt.newfonts.length;i++) {\n      result.push(\"font:\"+i+\":\"+xlt.newfonts[i]);\n      }\n\n   for (i=1;i<xlt.newlayouts.length;i++) {\n      result.push(\"layout:\"+i+\":\"+xlt.newlayouts[i]);\n      }\n\n   for (i=1;i<xlt.newvalueformats.length;i++) {\n      result.push(\"valueformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newvalueformats[i]));\n      }\n\n   for (i=0; i<xlt.namesorder.length; i++) {\n      name = xlt.namesorder[i];\n      result.push(\"name:\"+SocialCalc.encodeForSave(name).toUpperCase()+\":\"+\n                   SocialCalc.encodeForSave(sheetobj.names[name].desc)+\":\"+\n                   SocialCalc.encodeForSave(sheetobj.names[name].definition));\n      }\n\n   if (range) {\n      result.push(\"copiedfrom:\"+SocialCalc.crToCoord(cr1.col, cr1.row)+\":\"+\n                  SocialCalc.crToCoord(cr2.col, cr2.row));\n      }\n\n   result.push(\"\"); // one extra to get extra \\n\n\n   delete sheetobj.xlt; // clean up\n\n   return result.join(\"\\n\");\n   }\n\n//\n// line = SocialCalc.CellToString(sheet, cell)\n//\n\nSocialCalc.CellToString = function(sheet, cell) {\n\n   var cell, line, value, formula, t, r, b, l, xlt;\n\n   line = \"\";\n\n   if (!cell) return line;\n\n   value = SocialCalc.encodeForSave(cell.datavalue);\n   if (cell.datatype==\"v\") {\n      if (cell.valuetype==\"n\") line += \":v:\"+value;\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\n      }\n   else if (cell.datatype==\"t\") {\n      if (cell.valuetype==SocialCalc.Constants.textdatadefaulttype)\n         line += \":t:\"+value;\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\n      }\n   else {\n      formula = SocialCalc.encodeForSave(cell.formula);\n      if (cell.datatype==\"f\") {\n         line += \":vtf:\"+cell.valuetype+\":\"+value+\":\"+formula;\n         }\n      else if (cell.datatype==\"c\") {\n         line += \":vtc:\"+cell.valuetype+\":\"+value+\":\"+formula;\n         }\n      }\n   if (cell.readonly) {\n      line += \":ro:yes\";\n      }\n   if (cell.errors) {\n      line += \":e:\"+SocialCalc.encodeForSave(cell.errors);\n      }\n   t = cell.bt || \"\";\n   r = cell.br || \"\";\n   b = cell.bb || \"\";\n   l = cell.bl || \"\";\n\n   if (sheet.xlt) { // if have canonical save info\n      xlt = sheet.xlt;\n      if (t || r || b || l)\n      line += \":b:\"+xlt.borderstylesxlat[t||0]+\":\"+xlt.borderstylesxlat[r||0]+\":\"+xlt.borderstylesxlat[b||0]+\":\"+xlt.borderstylesxlat[l||0];\n      if (cell.layout) line += \":l:\"+xlt.layoutsxlat[cell.layout];\n      if (cell.font) line += \":f:\"+xlt.fontsxlat[cell.font];\n      if (cell.color) line += \":c:\"+xlt.colorsxlat[cell.color];\n      if (cell.bgcolor) line += \":bg:\"+xlt.colorsxlat[cell.bgcolor];\n      if (cell.cellformat) line += \":cf:\"+xlt.cellformatsxlat[cell.cellformat];\n      if (cell.textvalueformat) line += \":tvf:\"+xlt.valueformatsxlat[cell.textvalueformat];\n      if (cell.nontextvalueformat) line += \":ntvf:\"+xlt.valueformatsxlat[cell.nontextvalueformat];\n      }\n   else {\n      if (t || r || b || l)\n      line += \":b:\"+t+\":\"+r+\":\"+b+\":\"+l;\n      if (cell.layout) line += \":l:\"+cell.layout;\n      if (cell.font) line += \":f:\"+cell.font;\n      if (cell.color) line += \":c:\"+cell.color;\n      if (cell.bgcolor) line += \":bg:\"+cell.bgcolor;\n      if (cell.cellformat) line += \":cf:\"+cell.cellformat;\n      if (cell.textvalueformat) line += \":tvf:\"+cell.textvalueformat;\n      if (cell.nontextvalueformat) line += \":ntvf:\"+cell.nontextvalueformat;\n      }\n   if (cell.colspan) line += \":colspan:\"+cell.colspan;\n   if (cell.rowspan) line += \":rowspan:\"+cell.rowspan;\n   if (cell.cssc) line += \":cssc:\"+cell.cssc;\n   if (cell.csss) line += \":csss:\"+SocialCalc.encodeForSave(cell.csss);\n   if (cell.mod) line += \":mod:\"+cell.mod;\n   if (cell.comment) line += \":comment:\"+SocialCalc.encodeForSave(cell.comment);\n\n   return line;\n\n   }\n\n//\n// SocialCalc.CanonicalizeSheet(sheetobj, full)\n//\n// Goes through the sheet and fills in sheetobj.xlt with the following:\n//\n//   .maxrow, .maxcol - lastrow and lastcol are as small as possible\n//   .newlayouts - new version of sheetobj.layouts without unused ones and all in ascending order\n//   .layoutsxlat - maps old layouts index to new one\n//   same \".new\" and \".xlat\" for fonts, colors, borderstyles, cell and value formats\n//   .namesorder - array with names sorted\n//\n// If full or SocialCalc.Constants.doCanonicalizeSheet are not true, then the values will leave things unchanged (to save time, etc.)\n//\n// sheetobj.xlt should be deleted when you are finished using it\n//\n\nSocialCalc.CanonicalizeSheet = function(sheetobj, full) {\n\n   var l, coord, cr, cell, filled, an, a, newa, newxlat, used, ahash, i, v;\n   var maxrow = 0;\n   var maxcol = 0;\n   var alist = [\"borderstyle\", \"cellformat\", \"color\", \"font\", \"layout\", \"valueformat\"];\n\n   var xlt = {};\n\n   xlt.namesorder = []; // always return a sorted list\n   for (a in sheetobj.names) {\n      xlt.namesorder.push(a);\n      }\n   xlt.namesorder.sort();\n\n   if (!SocialCalc.Constants.doCanonicalizeSheet || !full) { // return make-no-changes values if not wanted\n      for (an=0; an<alist.length; an++) {\n         a = alist[an];\n         xlt[\"new\"+a+\"s\"] = sheetobj[a+\"s\"];\n         l = sheetobj[a+\"s\"].length;\n         newxlat = new Array(l);\n         newxlat[0] = \"\";\n         for (i=1; i<l; i++) {\n            newxlat[i] = i;\n            }\n         xlt[a+\"sxlat\"] = newxlat;\n         }\n\n      xlt.maxrow = sheetobj.attribs.lastrow;\n      xlt.maxcol = sheetobj.attribs.lastcol;\n\n      sheetobj.xlt = xlt;\n\n      return;\n      }\n\n   for (an=0; an<alist.length; an++) {\n      a = alist[an];\n      xlt[a+\"sUsed\"] = {};\n      }\n\n   var colorsUsed = xlt.colorsUsed;\n   var borderstylesUsed = xlt.borderstylesUsed;\n   var fontsUsed = xlt.fontsUsed;\n   var layoutsUsed = xlt.layoutsUsed;\n   var cellformatsUsed = xlt.cellformatsUsed;\n   var valueformatsUsed = xlt.valueformatsUsed;\n\n   for (coord in sheetobj.cells) { // check all cells to see which values are used\n      cr = SocialCalc.coordToCr(coord);\n      cell = sheetobj.cells[coord];\n      filled = false;\n\n      if (cell.valuetype && cell.valuetype!=\"b\") filled = true;\n\n      if (cell.color) {\n         colorsUsed[cell.color] = 1;\n         filled = true;\n         }\n\n      if (cell.bgcolor) {\n         colorsUsed[cell.bgcolor] = 1;\n         filled = true;\n         }\n\n      if (cell.bt) {\n         borderstylesUsed[cell.bt] = 1;\n         filled = true;\n         }\n      if (cell.br) {\n         borderstylesUsed[cell.br] = 1;\n         filled = true;\n         }\n      if (cell.bb) {\n         borderstylesUsed[cell.bb] = 1;\n         filled = true;\n         }\n      if (cell.bl) {\n         borderstylesUsed[cell.bl] = 1;\n         filled = true;\n         }\n\n      if (cell.layout) {\n         layoutsUsed[cell.layout] = 1;\n         filled = true;\n         }\n\n      if (cell.font) {\n         fontsUsed[cell.font] = 1;\n         filled = true;\n         }\n\n      if (cell.cellformat) {\n         cellformatsUsed[cell.cellformat] = 1;\n         filled = true;\n         }\n\n      if (cell.textvalueformat) {\n         valueformatsUsed[cell.textvalueformat] = 1;\n         filled = true;\n         }\n\n      if (cell.nontextvalueformat) {\n         valueformatsUsed[cell.nontextvalueformat] = 1;\n         filled = true;\n         }\n\n      if (filled) {\n         if (cr.row > maxrow) maxrow = cr.row;\n         if (cr.col > maxcol) maxcol = cr.col;\n         }\n      }\n\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // do sheet values, too\n      v = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\n      if (v) {\n         xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sUsed\"][v] = 1;\n         }\n      }\n\n   a = {\"height\": 1, \"hide\": 1}; // look at explicit row settings\n   for (v in a) {\n      for (cr in sheetobj.rowattribs[v]) {\n         if (cr > maxrow) maxrow = cr;\n         }\n      }\n   a = {\"hide\": 1, \"width\": 1}; // look at explicit col settings\n   for (v in a) {\n      for (coord in sheetobj.colattribs[v]) {\n         cr = SocialCalc.coordToCr(coord+\"1\");\n         if (cr.col > maxcol) maxcol = cr.col;\n         }\n      }\n\n   for (an=0; an<alist.length; an++) { // go through the attribs we want\n      a = alist[an];\n\n      newa = [];\n      used = xlt[a+\"sUsed\"];\n      for (v in used) {\n         newa.push(sheetobj[a+\"s\"][v]);\n         }\n      newa.sort();\n      newa.unshift(\"\");\n\n      newxlat = [\"\"];\n      ahash = sheetobj[a+\"hash\"];\n\n      for (i=1; i<newa.length; i++) {\n         newxlat[ahash[newa[i]]] = i;\n         }\n\n      xlt[a+\"sxlat\"] = newxlat;\n      xlt[\"new\"+a+\"s\"] = newa;\n\n      }\n\n   xlt.maxrow = maxrow || 1;\n   xlt.maxcol = maxcol || 1;\n\n   sheetobj.xlt = xlt; // leave for use by caller\n\n   }\n\n//\n// result = SocialCalc.EncodeCellAttributes(sheet, coord)\n//\n// Returns the cell's attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n\nSocialCalc.EncodeCellAttributes = function(sheet, coord) {\n\n   var value, i, b, bb;\n   var result = {};\n\n   var InitAttrib = function(name) {\n      result[name] = {def: true, val: \"\"};\n      }\n\n   var InitAttribs = function(namelist) {\n      for (var i=0; i<namelist.length; i++) {\n         InitAttrib(namelist[i]);\n         }\n      }\n\n   var SetAttrib = function(name, v) {\n      result[name].def = false;\n      result[name].val = v || \"\";\n      }\n\n   var SetAttribStar = function(name, v) {\n      if (v==\"*\") return;\n      result[name].def = false;\n      result[name].val = v;\n      }\n\n   var cell = sheet.GetAssuredCell(coord);\n\n   // cellformat: alignhoriz\n\n   InitAttrib(\"alignhoriz\");\n   if (cell.cellformat) {\n      SetAttrib(\"alignhoriz\", sheet.cellformats[cell.cellformat]);\n      }\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\n   if (cell.layout) {\n      parts = sheet.layouts[cell.layout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\n      SetAttribStar(\"padtop\", parts[1]);\n      SetAttribStar(\"padright\", parts[2]);\n      SetAttribStar(\"padbottom\", parts[3]);\n      SetAttribStar(\"padleft\", parts[4]);\n      SetAttribStar(\"alignvert\", parts[5]);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\n   if (cell.font) {\n      parts = sheet.fonts[cell.font].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\n      SetAttribStar(\"fontfamily\", parts[3]);\n      SetAttribStar(\"fontsize\", parts[2]);\n      SetAttribStar(\"fontlook\", parts[1]);\n      }\n\n   // color: textcolor\n\n   InitAttrib(\"textcolor\");\n   if (cell.color) {\n      SetAttrib(\"textcolor\", sheet.colors[cell.color]);\n      }\n\n   // bgcolor: bgcolor\n\n   InitAttrib(\"bgcolor\");\n   if (cell.bgcolor) {\n      SetAttrib(\"bgcolor\", sheet.colors[cell.bgcolor]);\n      }\n\n   // formatting: numberformat, textformat\n\n   InitAttribs([\"numberformat\", \"textformat\"]);\n   if (cell.nontextvalueformat) {\n      SetAttrib(\"numberformat\", sheet.valueformats[cell.nontextvalueformat]);\n      }\n   if (cell.textvalueformat) {\n      SetAttrib(\"textformat\", sheet.valueformats[cell.textvalueformat]);\n      }\n\n   // merges: colspan, rowspan\n\n   InitAttribs([\"colspan\", \"rowspan\"]);\n   SetAttrib(\"colspan\", cell.colspan || 1);\n   SetAttrib(\"rowspan\", cell.rowspan || 1);\n\n   // borders: bXthickness, bXstyle, bXcolor for X = t, r, b, and l\n\n   for (i=0; i<4; i++) {\n      b = \"trbl\".charAt(i);\n      bb = \"b\"+b;\n      InitAttrib(bb);\n      SetAttrib(bb, cell[bb] ? sheet.borderstyles[cell[bb]] : \"\");\n      InitAttrib(bb+\"thickness\");\n      InitAttrib(bb+\"style\");\n      InitAttrib(bb+\"color\");\n      if (cell[bb]) {\n         parts = sheet.borderstyles[cell[bb]].match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\n         SetAttrib(bb+\"thickness\", parts[1]);\n         SetAttrib(bb+\"style\", parts[2]);\n         SetAttrib(bb+\"color\", parts[3]);\n         }\n      }\n \n   // misc: cssc, csss, mod\n\n   InitAttribs([\"cssc\", \"csss\", \"mod\"]);\n   SetAttrib(\"cssc\", cell.cssc || \"\"); \n   SetAttrib(\"csss\", cell.csss || \"\");\n   SetAttrib(\"mod\", cell.mod || \"n\");\n\n   return result;\n\n   }\n\n//\n// result = SocialCalc.EncodeSheetAttributes(sheet)\n//\n// Returns the sheet's attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n\nSocialCalc.EncodeSheetAttributes = function(sheet) {\n\n   var value;\n   var attribs = sheet.attribs;\n   var result = {};\n\n   var InitAttrib = function(name) {\n      result[name] = {def: true, val: \"\"};\n      }\n\n   var InitAttribs = function(namelist) {\n      for (var i=0; i<namelist.length; i++) {\n         InitAttrib(namelist[i]);\n         }\n      }\n\n   var SetAttrib = function(name, v) {\n      result[name].def = false;\n      result[name].val = v || value;\n      }\n\n   var SetAttribStar = function(name, v) {\n      if (v==\"*\") return;\n      result[name].def = false;\n      result[name].val = v;\n      }\n\n   // sizes: colwidth, rowheight\n\n   InitAttrib(\"colwidth\");\n   if (attribs.defaultcolwidth) {\n      SetAttrib(\"colwidth\", attribs.defaultcolwidth);\n      }\n\n   InitAttrib(\"rowheight\");\n   if (attribs.rowheight) {\n      SetAttrib(\"rowheight\", attribs.defaultrowheight);\n      }\n\n   // cellformat: textalignhoriz, numberalignhoriz\n\n   InitAttrib(\"textalignhoriz\");\n   if (attribs.defaulttextformat) {\n      SetAttrib(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat]);\n      }\n\n   InitAttrib(\"numberalignhoriz\");\n   if (attribs.defaultnontextformat) {\n      SetAttrib(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat]);\n      }\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\n   if (attribs.defaultlayout) {\n      parts = sheet.layouts[attribs.defaultlayout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\n      SetAttribStar(\"padtop\", parts[1]);\n      SetAttribStar(\"padright\", parts[2]);\n      SetAttribStar(\"padbottom\", parts[3]);\n      SetAttribStar(\"padleft\", parts[4]);\n      SetAttribStar(\"alignvert\", parts[5]);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\n   if (attribs.defaultfont) {\n      parts = sheet.fonts[attribs.defaultfont].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\n      SetAttribStar(\"fontfamily\", parts[3]);\n      SetAttribStar(\"fontsize\", parts[2]);\n      SetAttribStar(\"fontlook\", parts[1]);\n      }\n\n   // color: textcolor\n\n   InitAttrib(\"textcolor\");\n   if (attribs.defaultcolor) {\n      SetAttrib(\"textcolor\", sheet.colors[attribs.defaultcolor]);\n      }\n\n   // bgcolor: bgcolor\n\n   InitAttrib(\"bgcolor\");\n   if (attribs.defaultbgcolor) {\n      SetAttrib(\"bgcolor\", sheet.colors[attribs.defaultbgcolor]);\n      }\n\n   // formatting: numberformat, textformat\n\n   InitAttribs([\"numberformat\", \"textformat\"]);\n   if (attribs.defaultnontextvalueformat) {\n      SetAttrib(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat]);\n      }\n   if (attribs.defaulttextvalueformat) {\n      SetAttrib(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat]);\n      }\n\n   // recalc: recalc\n\n   InitAttrib(\"recalc\");\n   if (attribs.recalc) {\n      SetAttrib(\"recalc\", attribs.recalc);\n      }\n\n   // usermaxcol, usermaxrow\n   InitAttrib(\"usermaxcol\");\n   if (attribs.usermaxcol) {\n      SetAttrib(\"usermaxcol\", attribs.usermaxcol);\n      }\n   InitAttrib(\"usermaxrow\");\n   if (attribs.usermaxrow) {\n      SetAttrib(\"usermaxrow\", attribs.usermaxrow);\n      }\n\n   return result;\n\n   }\n\n//\n// cmdstr = SocialCalc.DecodeCellAttributes(sheet, coord, attribs, range)\n//\n// Takes cell attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n// and returns the sheet commands to make the actual attributes correspond.\n// Returns a non-null string if any commands are to be executed, null otherwise.\n//\n// If range is provided, the commands are executed on the whole range.\n//\n\nSocialCalc.DecodeCellAttributes = function(sheet, coord, newattribs, range) {\n\n   var value, b, bb;\n\n   var cell = sheet.GetAssuredCell(coord);\n\n   var changed = false;\n\n   var CheckChanges = function(attribname, oldval, cmdname) {\n      var val;\n      if (newattribs[attribname]) {\n         if (newattribs[attribname].def) {\n            val = \"\";\n            }\n         else {\n            val = newattribs[attribname].val;\n            }\n         if (val != (oldval || \"\")) {\n            DoCmd(cmdname+\" \"+val);\n            }\n         }\n      }\n\n   var cmdstr = \"\";\n\n   var DoCmd = function(str) {\n      if (cmdstr) cmdstr += \"\\n\";\n      cmdstr += \"set \"+(range || coord)+\" \"+str;\n      changed = true;\n      }\n\n   // cellformat: alignhoriz\n\n   CheckChanges(\"alignhoriz\", sheet.cellformats[cell.cellformat], \"cellformat\");\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\n      value = \"padding:\" +\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\n         \";vertical-align:\" +\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.layouts[cell.layout] || \"\")) {\n      DoCmd(\"layout \"+value);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\n      value =\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.fonts[cell.font] || \"\")) {\n      DoCmd(\"font \"+value);\n      }\n\n   // color: textcolor\n\n   CheckChanges(\"textcolor\", sheet.colors[cell.color], \"color\");\n\n   // bgcolor: bgcolor\n\n   CheckChanges(\"bgcolor\", sheet.colors[cell.bgcolor], \"bgcolor\");\n\n   // formatting: numberformat, textformat\n\n   CheckChanges(\"numberformat\", sheet.valueformats[cell.nontextvalueformat], \"nontextvalueformat\");\n\n   CheckChanges(\"textformat\", sheet.valueformats[cell.textvalueformat], \"textvalueformat\");\n\n   // merges: colspan, rowspan - NOT HANDLED: IGNORED!\n\n   // borders: bX for X = t, r, b, and l; bXthickness, bXstyle, bXcolor ignored\n\n   for (i=0; i<4; i++) {\n      b = \"trbl\".charAt(i);\n      bb = \"b\"+b;\n      CheckChanges(bb, sheet.borderstyles[cell[bb]], bb);\n      }\n\n   // misc: cssc, csss, mod\n\n   CheckChanges(\"cssc\", cell.cssc, \"cssc\");\n\n   CheckChanges(\"csss\", cell.csss, \"csss\");\n\n   if (newattribs.mod) {\n      if (newattribs.mod.def) {\n         value = \"n\";\n         }\n      else {\n         value = newattribs.mod.val;\n         }\n      if (value != (cell.mod || \"n\")) {\n         if (value==\"n\") value = \"\"; // restrict to \"y\" and \"\" normally\n         DoCmd(\"mod \"+value);\n         }\n      }\n\n   // if any changes return command(s)\n\n   if (changed) {\n       return cmdstr;\n      }\n   else {\n      return null;\n      }\n\n   }\n\n\n//\n// changed = SocialCalc.DecodeSheetAttributes(sheet, newattribs)\n//\n// Takes sheet attributes in an object, each in the following form:\n//\n//    attribname: {def: true/false, val: full-value}\n//\n// and returns the sheet commands to make the actual attributes correspond.\n// Returns a non-null string if any commands were executed, null otherwise.\n//\n\nSocialCalc.DecodeSheetAttributes = function(sheet, newattribs) {\n\n   var value;\n   var attribs = sheet.attribs;\n   var changed = false;\n\n   var CheckChanges = function(attribname, oldval, cmdname) {\n      var val;\n      if (newattribs[attribname]) {\n         if (newattribs[attribname].def) {\n            val = \"\";\n            }\n         else {\n            val = newattribs[attribname].val;\n            }\n         if (val != (oldval || \"\")) {\n            DoCmd(cmdname+\" \"+val);\n            }\n         }\n      }\n\n   var cmdstr = \"\";\n\n   var DoCmd = function(str) {\n      if (cmdstr) cmdstr += \"\\n\";\n      cmdstr += \"set sheet \"+str;\n      changed = true;\n      }\n\n   // sizes: colwidth, rowheight\n\n   CheckChanges(\"colwidth\", attribs.defaultcolwidth, \"defaultcolwidth\");\n\n   CheckChanges(\"rowheight\", attribs.defaultrowheight, \"defaultrowheight\");\n\n   // cellformat: textalignhoriz, numberalignhoriz\n\n   CheckChanges(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat], \"defaulttextformat\");\n\n   CheckChanges(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat], \"defaultnontextformat\");\n\n   // layout: alignvert, padtop, padright, padbottom, padleft\n\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\n      value = \"padding:\" +\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\n         \";vertical-align:\" +\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.layouts[attribs.defaultlayout] || \"\")) {\n      DoCmd(\"defaultlayout \"+value);\n      }\n\n   // font: fontfamily, fontlook, fontsize\n\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\n      value =\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\n      }\n   else {\n      value = \"\";\n      }\n\n   if (value != (sheet.fonts[attribs.defaultfont] || \"\")) {\n      DoCmd(\"defaultfont \"+value);\n      }\n\n   // color: textcolor\n\n   CheckChanges(\"textcolor\", sheet.colors[attribs.defaultcolor], \"defaultcolor\");\n\n   // bgcolor: bgcolor\n\n   CheckChanges(\"bgcolor\", sheet.colors[attribs.defaultbgcolor], \"defaultbgcolor\");\n\n   // formatting: numberformat, textformat\n\n   CheckChanges(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat], \"defaultnontextvalueformat\");\n\n   CheckChanges(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat], \"defaulttextvalueformat\");\n\n   // recalc: recalc\n\n   CheckChanges(\"recalc\", sheet.attribs.recalc, \"recalc\");\n\n   // usermaxcol, usermaxrow\n\n   CheckChanges(\"usermaxcol\", sheet.attribs.usermaxcol, \"usermaxcol\");\n   CheckChanges(\"usermaxrow\", sheet.attribs.usermaxrow, \"usermaxrow\");\n\n   // if any changes return command(s)\n\n   if (changed) {\n       return cmdstr;\n      }\n   else {\n      return null;\n      }\n\n   }\n\n// *************************************\n//\n// Sheet command routines\n//\n// *************************************\n\n//\n// SocialCalc.SheetCommandInfo - object with information used during command execution\n//\n\nSocialCalc.SheetCommandInfo = function(sheetobj) {\n\n   this.sheetobj = sheetobj; // sheet being operated on\n   this.timerobj = null; // used for timeslicing\n   this.firsttimerdelay = 50; // wait before starting cmds (for Chrome - to give time to update)\n   this.timerdelay = 1; // wait between slices\n   this.maxtimeslice = 100; // do another slice after this many milliseconds\n   this.saveundo = false; // arg for ExecuteSheetCommand\n\n   this.CmdExtensionCallbacks = {}; // for startcmdextension, in form: cmdname, {func:function(cmdname, data, sheet, SocialCalc.Parse object, saveundo), data:whatever}\n\n//   statuscallback: null, // called during execution - obsolete: use sheet obj's\n//   statuscallbackparams: null\n\n   };\n\n//\n// SocialCalc.ScheduleSheetCommands\n//\n// statuscallback is called at the beginning (cmdstart) and end (cmdend).\n//\n\nSocialCalc.ScheduleSheetCommands = function(sheet, cmdstr, saveundo) {\n\n   var sci = sheet.sci;\n\n   var parseobj = new SocialCalc.Parse(cmdstr);\n\n   if (sci.sheetobj.statuscallback) { // notify others if requested\n      sheet.statuscallback(sci, \"cmdstart\", \"\", sci.sheetobj.statuscallbackparams);\n      }\n\n   if (saveundo) {\n      sci.sheetobj.changes.PushChange(\"\"); // add a step to undo stack\n      }\n\n   sci.timerobj = window.setTimeout(function() {\n      SocialCalc.SheetCommandsTimerRoutine(sci, parseobj, saveundo);\n   }, sci.firsttimerdelay);\n\n   }\n\nSocialCalc.SheetCommandsTimerRoutine = function(sci, parseobj, saveundo) {\n\n   var errortext;\n   var starttime = new Date();\n   sci.timerobj = null;\n\n   while (!parseobj.EOF()) { // go through all commands (separated by newlines)\n\n      errortext = SocialCalc.ExecuteSheetCommand(sci.sheetobj, parseobj, saveundo);\n      // Error - Use  log on server   OR  alert on client \n      if (errortext) {\n        if (typeof(alert) == \"function\")  {\n          alert(errortext);\n        } else {\n          console.log(errortext)\n        }\n      }\n\n      parseobj.NextLine();\n\n      if (((new Date()) - starttime) >= sci.maxtimeslice) { // if taking too long, give up CPU for a while\n         sci.timerobj = window.setTimeout(function() {\n            SocialCalc.SheetCommandsTimerRoutine(sci, parseobj, saveundo);\n         }, sci.timerdelay);\n         return;\n         }\n      }\n\n   if (sci.sheetobj.statuscallback) { // notify others if requested\n      sci.sheetobj.statuscallback(sci, \"cmdend\", \"\", sci.sheetobj.statuscallbackparams);\n      }\n\n   }\n\n//\n// errortext = SocialCalc.ExecuteSheetCommand(sheet, cmd, saveundo)\n//\n// cmd is a SocialCalc.Parse object.\n//\n// Executes commands that modify the sheet data.\n// Sets sheet \"needsrecalc\" as needed.\n// Sets sheet \"changedrendervalues\" as needed.\n//\n// The cmd string may be multiple commands, separated by newlines. In that case\n// only one \"step\" is put on the undo stack representing all the commands.\n// Note that because of this, in \"set A1 text ...\" and \"set A1 comment ...\" text is\n// treated as encoded (newline => \\n, \\ => \\b, : => \\c).\n//\n// The commands are in the forms:\n//\n//    set sheet attributename value (plus lastcol and lastrow)\n//    set 22 attributename value\n//    set B attributename value\n//    set A1 attributename value1 value2... (see each attribute in code for details)\n//    set A1:B5 attributename value1 value2...\n//    erase/copy/cut/paste/fillright/filldown A1:B5 all/formulas/format\n//    loadclipboard save-encoded-clipboard-data\n//    clearclipboard\n//    merge C3:F3\n//    unmerge C3\n//    insertcol/insertrow C5\n//    deletecol/deleterow C5:E7\n//    movepaste/moveinsert A1:B5 A8 all/formulas/format (if insert, destination must be in same rows or columns or else paste done)\n//    sort cr1:cr2 col1 up/down col2 up/down col3 up/down\n//    name define NAME definition\n//    name desc NAME description\n//    name delete NAME\n//    recalc\n//    redisplay\n//    changedrendervalues\n//    startcmdextension extension rest-of-command\n//    sendemail ??? eddy ???\n//\n// If saveundo is true, then undo information is saved in sheet.changes.\n//\n\nSocialCalc.ExecuteSheetCommand = function(sheet, cmd, saveundo) {\n\n   var cmdstr, cmd1, rest, what, attrib, num, pos, pos2, errortext, undostart, val;\n   var cr1, cr2, col, row, cr, cell, newcell;\n   var fillright, rowstart, colstart, crbase, rowoffset, coloffset, basecell;\n   var clipsheet, cliprange, numcols, numrows, attribtable;\n   var colend, rowend, newcolstart, newrowstart, newcolend, newrowend, rownext, colnext, colthis, cellnext;\n   var lastrow, lastcol, rowbefore, colbefore, oldformula, oldcr;\n   var cols, dirs, lastsortcol, i, sortlist, sortcells, sortvalues, sorttypes;\n   var sortfunction, slen, valtype, originalrow, sortedcr;\n   var name, v1, v2;\n   var cmdextension;\n   var col, row, editor, undoNum, trackLine;\n\n   var attribs = sheet.attribs;\n   var changes = sheet.changes;\n   var cellProperties = SocialCalc.CellProperties;\n   var scc = SocialCalc.Constants;\n\n   var ParseRange =\n      function() {\n         var prange = SocialCalc.ParseRange(what);\n         cr1 = prange.cr1;\n         cr2 = prange.cr2;\n         if (cr2.col > attribs.lastcol) attribs.lastcol = cr2.col;\n         if (cr2.row > attribs.lastrow) attribs.lastrow = cr2.row;\n         };\n\n   errortext = \"\";\n\n   cmdstr = cmd.RestOfStringNoMove();\n   if (saveundo) {\n      sheet.changes.AddDo(cmdstr);\n      }\n\n   cmd1 = cmd.NextToken();\n   switch (cmd1) {\n\n      case \"set\":\n         what = cmd.NextToken();\n         attrib = cmd.NextToken();\n         rest = cmd.RestOfString();\n         undostart = \"set \"+what+\" \"+attrib;\n\n         if (what==\"sheet\") {\n            sheet.renderneeded = true;\n            switch (attrib) {\n               case \"defaultcolwidth\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\n                  attribs[attrib] = rest;\n                  break;\n               case \"defaultcolor\":\n               case \"defaultbgcolor\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"color\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"color\", rest);\n                  break;\n               case \"defaultlayout\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"layout\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"layout\", rest);\n                  break;\n               case \"defaultfont\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"font\", attribs[attrib]));\n                  if (rest==\"* * *\") rest = \"\"; // all default\n                  attribs[attrib] = sheet.GetStyleNum(\"font\", rest);\n                  break;\n               case \"defaulttextformat\":\n               case \"defaultnontextformat\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"cellformat\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"cellformat\", rest);\n                  break;\n               case \"defaulttextvalueformat\":\n               case \"defaultnontextvalueformat\":\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"valueformat\", attribs[attrib]));\n                  attribs[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\n                  for (cr in sheet.cells) { // forget all cached display strings\n                     delete sheet.cells[cr].displaystring;\n                     }\n                  break;\n               case \"lastcol\":\n               case \"lastrow\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\n                  num = rest-0;\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 1;\n                  break;\n               case \"recalc\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\n                  if (rest == \"off\") {\n                     attribs.recalc = rest; // manual recalc, not auto\n                     }\n                  else { // all values other than \"off\" mean \"on\"\n                     delete attribs.recalc;\n                     }\n                  break;\n               case \"usermaxcol\":\n               case \"usermaxrow\":\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\n                  num = rest-0;\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 0;\n                  break;\n               default:\n                  errortext = scc.s_escUnknownSheetCmd+cmdstr;\n                  break;\n               }\n            }\n\n         else if (/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(what)) { // col attributes\n            sheet.renderneeded = true;\n            what = what.toUpperCase();\n            pos = what.indexOf(\":\");\n            if (pos>=0) {\n               cr1 = SocialCalc.coordToCr(what.substring(0,pos)+\"1\");\n               cr2 = SocialCalc.coordToCr(what.substring(pos+1)+\"1\");\n               }\n            else {\n               cr1 = SocialCalc.coordToCr(what+\"1\");\n               cr2 = cr1;\n               }\n            for (col=cr1.col; col <= cr2.col; col++) {\n               if (attrib==\"width\") {\n                  cr = SocialCalc.rcColname(col);\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" width\", sheet.colattribs.width[cr]);\n                  if (rest.length > 0 ) {\n                     sheet.colattribs.width[cr] = rest;\n                     }\n                  else {\n                     delete sheet.colattribs.width[cr];\n                     }\n                  }\n               else if (attrib==\"hide\") {\n                  sheet.hiddencolrow = \"col\";\n                  cr = SocialCalc.rcColname(col);\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" hide\", sheet.colattribs.hide[cr]);\n                  if (rest.length > 0) {\n                     sheet.colattribs.hide[cr] = rest; \n                     }\n                  else {\n                     delete sheet.colattribs.hide[cr];\n                     }\n                  }\n               }\n            }\n\n         else if (/^\\d+(:\\d+)?$/i.test(what)) { // row attributes\n            sheet.renderneeded = true;\n            what = what.toUpperCase();\n            pos = what.indexOf(\":\");\n            if (pos>=0) {\n               cr1 = SocialCalc.coordToCr(\"A\"+what.substring(0,pos));\n               cr2 = SocialCalc.coordToCr(\"A\"+what.substring(pos+1));\n               }\n            else {\n               cr1 = SocialCalc.coordToCr(\"A\"+what);\n               cr2 = cr1;\n               }\n            for (row=cr1.row; row <= cr2.row; row++) {\n               if (attrib==\"height\") {\n                  if (saveundo) changes.AddUndo(\"set \"+row+\" height\", sheet.rowattribs.height[row]);\n                  if (rest.length > 0 ) {\n                     sheet.rowattribs.height[row] = rest;\n                     }\n                  else {\n                     delete sheet.rowattribs.height[row];\n                     }\n                  }\n               else if (attrib==\"hide\") {\n                  sheet.hiddencolrow = \"row\";\n                  if (saveundo) changes.AddUndo(\"set \"+row+\" hide\", sheet.rowattribs.hide[row]);\n                  if (rest.length > 0) {\n                     sheet.rowattribs.hide[row] = rest; \n                     }\n                  else {\n                     delete sheet.rowattribs.hide[row];\n                     }\n                  }\n               }\n            }\n\n         else if (/^[a-z]{1,2}\\d+(:[a-z]{1,2}\\d+)?$/i.test(what)) { // cell attributes\n            ParseRange();\n            if (cr1.row!=cr2.row || cr1.col!=cr2.col || sheet.celldisplayneeded || sheet.renderneeded) { // not one cell\n               sheet.renderneeded = true;\n               sheet.celldisplayneeded = \"\";\n               }\n            else {\n               sheet.celldisplayneeded = SocialCalc.crToCoord(cr1.col, cr1.row);\n               }\n            for (row=cr1.row; row <= cr2.row; row++) {\n               for (col=cr1.col; col <= cr2.col; col++) {\n                  cr = SocialCalc.crToCoord(col, row);\n                  cell=sheet.GetAssuredCell(cr);\n                  if (cell.readonly && attrib!=\"readonly\") continue;\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n                  if (attrib==\"value\") { // set coord value type numeric-value\n                     pos = rest.indexOf(\" \");\n                     cell.datavalue = rest.substring(pos+1)-0;\n                     delete cell.errors;\n                     cell.datatype = \"v\";\n                     cell.valuetype = rest.substring(0,pos);\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"text\") { // set coord text type text-value\n                     pos = rest.indexOf(\" \");\n                     cell.datavalue = SocialCalc.decodeFromSave(rest.substring(pos+1));\n                     delete cell.errors;\n                     cell.datatype = \"t\";\n                     cell.valuetype = rest.substring(0,pos);\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"formula\") { // set coord formula formula-body-less-initial-=\n                     cell.datavalue = 0; // until recalc\n                     delete cell.errors;\n                     cell.datatype = \"f\";\n                     cell.valuetype = \"e#N/A\"; // until recalc\n                     cell.formula = rest;\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"constant\") { // set coord constant type numeric-value source-text\n                     pos = rest.indexOf(\" \");\n                     pos2 = rest.substring(pos+1).indexOf(\" \");\n                     cell.datavalue = rest.substring(pos+1,pos+1+pos2)-0;\n                     cell.valuetype = rest.substring(0,pos);\n                     if (cell.valuetype.charAt(0)==\"e\") { // error\n                        cell.errors = cell.valuetype.substring(1);\n                        }\n                     else {\n                        delete cell.errors;\n                        }\n                     cell.datatype = \"c\";\n                     cell.formula = rest.substring(pos+pos2+2);\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"empty\") { // erase value\n                     cell.datavalue = \"\";\n                     delete cell.errors;\n                     cell.datatype = null;\n                     cell.formula = \"\";\n                     cell.valuetype = \"b\";\n                     delete cell.displaystring;\n                     delete cell.parseinfo;\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (attrib==\"all\") { // set coord all :this:val1:that:val2...\n                     if (rest.length>0) {\n                        cell = new SocialCalc.Cell(cr);\n                        sheet.CellFromStringParts(cell, rest.split(\":\"), 1);\n                        sheet.cells[cr] = cell;\n                        }\n                     else {\n                        delete sheet.cells[cr];\n                        }\n                     attribs.needsrecalc = \"yes\";\n                     }\n                  else if (/^b[trbl]$/.test(attrib)) { // set coord bt 1px solid black\n                     cell[attrib] = sheet.GetStyleNum(\"borderstyle\", rest);\n                     sheet.renderneeded = true; // affects more than just one cell\n                     }\n                  else if (attrib==\"color\" || attrib==\"bgcolor\") {\n                     cell[attrib] = sheet.GetStyleNum(\"color\", rest);\n                     }\n                  else if (attrib==\"layout\" || attrib==\"cellformat\") {\n                     cell[attrib] = sheet.GetStyleNum(attrib, rest);\n                     }\n                  else if (attrib==\"font\") { // set coord font style weight size family\n                     if (rest==\"* * *\") rest = \"\";\n                     cell[attrib] = sheet.GetStyleNum(\"font\", rest);\n                     }\n                  else if (attrib==\"textvalueformat\" || attrib==\"nontextvalueformat\") {\n                     cell[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\n                     delete cell.displaystring;\n                     }\n                  else if (attrib==\"cssc\") {\n                     rest = rest.replace(/[^a-zA-Z0-9\\-]/g, \"\");\n                     cell.cssc = rest;\n                     }\n                  else if (attrib==\"csss\") {\n                     rest = rest.replace(/\\n/g, \"\");\n                     cell.csss = rest;\n                     }\n                  else if (attrib==\"mod\") {\n                     rest = rest.replace(/[^yY]/g, \"\").toLowerCase();\n                     cell.mod = rest;\n                     }\n                  else if (attrib==\"comment\") {\n                     cell.comment = SocialCalc.decodeFromSave(rest);\n                     }\n                  else if (attrib==\"readonly\") {\n                     cell.readonly = rest.toLowerCase()==\"yes\";\n                     }\n                  else {\n                     errortext = scc.s_escUnknownSetCoordCmd+cmdstr;\n                     }\n                  }\n               }\n\n            }\n         break;\n\n      case \"merge\":\n         sheet.renderneeded = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         cell=sheet.GetAssuredCell(cr1.coord);\n         if (cell.readonly) break;\n         if (saveundo) changes.AddUndo(\"unmerge \"+cr1.coord);\n\n         if (cr2.col > cr1.col) cell.colspan = cr2.col - cr1.col + 1;\n         else delete cell.colspan;\n         if (cr2.row > cr1.row) cell.rowspan = cr2.row - cr1.row + 1;\n         else delete cell.rowspan;\n\n         sheet.changedrendervalues = true;\n\n         break;\n\n      case \"unmerge\":\n         sheet.renderneeded = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         cell=sheet.GetAssuredCell(cr1.coord);\n         if (cell.readonly) break;\n         if (saveundo) changes.AddUndo(\"merge \"+cr1.coord+\":\"+SocialCalc.crToCoord(cr1.col+(cell.colspan||1)-1, cr1.row+(cell.rowspan||1)-1));\n\n         delete cell.colspan;\n         delete cell.rowspan;\n\n         sheet.changedrendervalues = true;\n\n         break;\n\n      case \"erase\":\n      case \"cut\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         if (cmd1==\"cut\") { // save copy of whole thing before erasing\n            if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n            SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\n            }\n\n         for (row = cr1.row; row <= cr2.row; row++) {\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (cell.readonly) continue;\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n               if (rest==\"all\") {\n                  delete sheet.cells[cr];\n                  }\n               else if (rest == \"formulas\") {\n                  cell.datavalue = \"\";\n                  cell.datatype = null;\n                  cell.formula = \"\";\n                  cell.valuetype = \"b\";\n                  delete cell.errors;\n                  delete cell.displaystring;\n                  delete cell.parseinfo;\n                  if (cell.comment) { // comments are considered content for erasing\n                     delete cell.comment;\n                     }\n                  }\n               else if (rest == \"formats\") {\n                  newcell = new SocialCalc.Cell(cr); // create a new cell without attributes\n                  newcell.datavalue = cell.datavalue; // copy existing values\n                  newcell.datatype = cell.datatype;\n                  newcell.formula = cell.formula;\n                  newcell.valuetype = cell.valuetype;\n                  if (cell.comment) {\n                     newcell.comment = cell.comment;\n                     }\n                  sheet.cells[cr] = newcell; // replace\n                  }\n               }\n            }\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"fillright\":\n      case \"filldown\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         function increment_amount(down) {\n            function valid_datatype(type) {\n\t\treturn type == \"v\" || type == \"c\";\n            }\n            var editor = SocialCalc.GetSpreadsheetControlObject().editor;\n            var range = editor.range2;\n            var returnval = undefined; \n            if (range.hasrange) {\n                var startcell, endcell;\n                if (down && (range.bottom - range.top == 1) && range.left == range.right) {\n                  startcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.top));\n                  endcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.bottom));\n                  if (valid_datatype(startcell.datatype) && valid_datatype(endcell.datatype)) {\n                      returnval =  endcell.datavalue - startcell.datavalue;\n                  }\n                } else if (!down && range.left != range.right) {\n                  startcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.top));\n                  endcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.right, range.top));\n                  if (valid_datatype(startcell.datatype) && valid_datatype(endcell.datatype)) {\n                      returnval =  endcell.datavalue - startcell.datavalue;\n\t\t  }\n                }\n            }\n           editor.Range2Remove();\n           return returnval;\n         }\n\t var inc;\n         if (cmd1 == \"fillright\") {\n            fillright = true;\n            rowstart = cr1.row;\n            colstart = cr1.col + 1;\n\t    inc = increment_amount(false);\n            }\n         else {\n            fillright = false;\n            rowstart = cr1.row + 1;\n            colstart = cr1.col;\n\t    inc = increment_amount(true);\n            }\n         for (row = rowstart; row <= cr2.row; row++) {\n            for (col = colstart; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (cell.readonly) continue;\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n               if (fillright) {\n                  crbase = SocialCalc.crToCoord(cr1.col, row);\n                  coloffset = col - colstart + 1;\n                  rowoffset = 0;\n                  }\n               else {\n                  crbase = SocialCalc.crToCoord(col, cr1.row);\n                  coloffset = 0;\n                  rowoffset = row - rowstart + 1;\n                  }\n               basecell = sheet.GetAssuredCell(crbase);\n               if (rest == \"all\" || rest == \"formats\") {\n                  for (attrib in cellProperties) {\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     else {\n                        cell[attrib] = basecell[attrib];\n                        }\n                     }\n                  }\n               if (rest == \"all\" || rest == \"formulas\") {\n                  if (inc !== undefined) {\n                      cell.datavalue = basecell.datavalue + (fillright ? coloffset : rowoffset)*inc;\n                  } else {\n                      cell.datavalue = basecell.datavalue;\n                  }\n                  cell.datatype = basecell.datatype;            \n                  cell.valuetype = basecell.valuetype;\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\n                     }\n                  else {\n                     cell.formula = basecell.formula;\n                     }\n                  delete cell.parseinfo;\n                  cell.errors = basecell.errors;\n                  }\n               delete cell.displaystring;\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"copy\":\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n         SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\n         break;\n\n      case \"loadclipboard\":\n         rest = cmd.RestOfString();\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n         SocialCalc.Clipboard.clipboard = SocialCalc.decodeFromSave(rest);\n         break;\n\n      case \"clearclipboard\":\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\n         SocialCalc.Clipboard.clipboard = \"\";\n         break;\n\n      case \"paste\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n         if (!SocialCalc.Clipboard.clipboard) {\n            break;\n            }\n         clipsheet = new SocialCalc.Sheet(); // load clipboard contents as another sheet\n         clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\n         cliprange = SocialCalc.ParseRange(clipsheet.copiedfrom);\n         coloffset = cr1.col - cliprange.cr1.col; // get sizes, etc.\n         rowoffset = cr1.row - cliprange.cr1.row;\n         numcols = Math.max(cr2.col - cr1.col + 1, cliprange.cr2.col - cliprange.cr1.col + 1);\n         numrows = Math.max(cr2.row - cr1.row + 1, cliprange.cr2.row - cliprange.cr1.row + 1);\n         if (cr1.col+numcols-1 > attribs.lastcol) attribs.lastcol = cr1.col+numcols-1;\n         if (cr1.row+numrows-1 > attribs.lastrow) attribs.lastrow = cr1.row+numrows-1;\n\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (cell.readonly) continue;\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n               crbase = SocialCalc.crToCoord(\n                  cliprange.cr1.col + ((col-cr1.col) % (cliprange.cr2.col - cliprange.cr1.col + 1)), \n                  cliprange.cr1.row + ((row-cr1.row) % (cliprange.cr2.row - cliprange.cr1.row + 1)));\n               basecell = clipsheet.GetAssuredCell(crbase);\n               if (rest == \"all\" || rest == \"formats\") {\n                  for (attrib in cellProperties) {\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     else {\n                        attribtable = SocialCalc.CellPropertiesTable[attrib];\n                        if (attribtable && basecell[attrib]) { // table indexes to expand to strings since other sheet may have diff indexes\n                           cell[attrib] = sheet.GetStyleNum(attribtable, clipsheet.GetStyleString(attribtable, basecell[attrib]));\n                           }\n                        else { // these are not table indexes\n                           cell[attrib] = basecell[attrib];\n                           }\n                        }\n                     }\n                  }\n               if (rest == \"all\" || rest == \"formulas\") {\n                  cell.datavalue = basecell.datavalue;\n                  cell.datatype = basecell.datatype;            \n                  cell.valuetype = basecell.valuetype;\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\n                     }\n                  else {\n                     cell.formula = basecell.formula;\n                     }\n                  delete cell.parseinfo;\n                  cell.errors = basecell.errors;\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\n                     cell.comment = basecell.comment;\n                     }\n                  else if (cell.comment) {\n                     delete cell.comment;\n                     }\n                  }\n               delete cell.displaystring;\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"sort\": // sort cr1:cr2 col1 up/down col2 up/down col3 up/down\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         ParseRange();\n         cols = []; // get columns and sort directions (or \"\")\n         dirs = [];\n         lastsortcol = 0;\n         for (i=0; i<=3; i++) {\n            cols[i] = cmd.NextToken();\n            dirs[i] = cmd.NextToken();\n            if (cols[i]) lastsortcol = i;\n            }\n\n         sortcells = {}; // a copy of the data which will replace the original, but in the new order\n         sortlist = []; // an array of 0, 1, ..., nrows-1 needed for sorting\n         sortvalues = []; // values to be sorted corresponding to sortlist\n         sorttypes = []; // basic types of the values\n\n         for (row = cr1.row; row <= cr2.row; row++) { // fill in the sort info\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.cells[cr];\n               if (cell) { // only copy non-empty cells\n                  sortcells[cr] = sheet.CellToString(cell);\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sortcells[cr]);\n                  }\n               else {\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\");\n                  }\n               }\n            sortlist.push(sortlist.length);\n            sortvalues.push([]);\n            sorttypes.push([]);\n            slast = sorttypes.length-1;\n            for (i = 0; i <= lastsortcol; i++) {\n               cr = cols[i] + row; // get cr on this row in sort col\n               cell = sheet.GetAssuredCell(cr);\n               val = cell.datavalue;\n               valtype = cell.valuetype.charAt(0) || \"b\";\n               if (valtype == \"t\") val = val.toLowerCase();\n               sortvalues[slast].push(val);\n               sorttypes[slast].push(valtype);\n               }\n            }\n\n         sortfunction = function(a, b) { // a comparison function that can handle all the type variations\n            var i, a1, b1, ta, cresult;\n            for (i=0; i<=lastsortcol; i++) {\n               if (dirs[i] == \"up\") { // handle sort direction\n                  a1 = a; b1 = b;\n                  }\n               else {\n                  a1 = b; b1 = a;\n                  }\n               ta = sorttypes[a1][i];\n               tb = sorttypes[b1][i];\n               if (ta == \"t\") { // numbers < text < errors, blank always last no matter what dir\n                  if (tb == \"t\") {\n                     a1 = sortvalues[a1][i];\n                     b1 = sortvalues[b1][i];\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\n                     }\n                  else if (tb == \"n\") {\n                     cresult = 1;\n                     }\n                  else if (tb == \"b\") {\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\n                     }\n                  else if (tb == \"e\") {\n                     cresult = -1;\n                     }\n                  }\n               else if (ta == \"n\") {\n                  if (tb == \"t\") {\n                     cresult = -1;\n                     }\n                  else if (tb == \"n\") {\n                     a1 = sortvalues[a1][i]-0; // force to numeric, just in case\n                     b1 = sortvalues[b1][i]-0;\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\n                     }\n                  else if (tb == \"b\") {\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\n                     }\n                  else if (tb == \"e\") {\n                     cresult = -1;\n                     }\n                  }\n               else if (ta == \"e\") {\n                  if (tb == \"e\") {\n                     a1 = sortvalues[a1][i];\n                     b1 = sortvalues[b1][i];\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\n                     }\n                  else if (tb == \"b\") {\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\n                     }\n                  else {\n                     cresult = 1;\n                     }\n                  }\n               else if (ta == \"b\") {\n                  if (tb == \"b\") {\n                     cresult = 0;\n                     }\n                  else {\n                     cresult = dirs[i] == \"up\" ? 1 : -1;\n                     }\n                  }\n               if (cresult) { // return if tested not equal, otherwise do next column\n                  return cresult;\n                  }\n               }\n            cresult = a > b ? 1 : (a < b ? -1 : 0); // equal - return position in original to maintain it\n            return cresult;\n            }\n\n         sortlist.sort(sortfunction);\n\n         for (row = cr1.row; row <= cr2.row; row++) { // copy original rows into sorted positions\n            originalrow = sortlist[row-cr1.row]; // relative position where it was in original\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               sortedcr = SocialCalc.crToCoord(col, originalrow+cr1.row); // original cell to be put in new place\n               if (sortcells[sortedcr]) {\n                  cell = new SocialCalc.Cell(cr);\n                  sheet.CellFromStringParts(cell, sortcells[sortedcr].split(\":\"), 1);\n                  if (cell.datatype == \"f\") { // offset coord refs, even to ***relative*** coords in other sheets\n                     cell.formula = SocialCalc.OffsetFormulaCoords(cell.formula, 0, (row-cr1.row)-originalrow);\n                     }\n                  sheet.cells[cr] = cell;\n                  }\n               else {\n                  delete sheet.cells[cr];\n                  }\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"insertcol\":\n      case \"insertrow\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         ParseRange();\n\n         if (cmd1 == \"insertcol\") {\n            coloffset = 1;\n            colend = cr1.col;\n            rowoffset = 0;\n            rowend = 1;\n            newcolstart = cr1.col;\n            newcolend = cr1.col;\n            newrowstart = 1;\n            newrowend = attribs.lastrow;\n            if (saveundo) changes.AddUndo(\"deletecol \"+cr1.coord);\n            }\n         else {\n            coloffset = 0;\n            colend = 1;\n            rowoffset = 1;\n            rowend = cr1.row;\n            newcolstart = 1;\n            newcolend = attribs.lastcol;\n            newrowstart = cr1.row;\n            newrowend = cr1.row;\n            if (saveundo) changes.AddUndo(\"deleterow \"+cr1.coord);\n            }\n\n         for (row=attribs.lastrow; row >= rowend; row--) { // copy the cells forward\n            for (col=attribs.lastcol; col >= colend; col--) {\n               crbase = SocialCalc.crToCoord(col, row);\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               if (!sheet.cells[crbase]) { // copying empty cell\n                  delete sheet.cells[cr]; // delete anything that may have been there\n                  }\n               else { // overwrite existing cell with moved contents\n                  sheet.cells[cr] = sheet.cells[crbase];\n                  }\n               }\n            }\n\n         for (row=newrowstart; row <= newrowend; row++) { // fill the \"new\" empty cells\n            for (col=newcolstart; col <= newcolend; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell = new SocialCalc.Cell(cr);\n               sheet.cells[cr] = cell;\n               crbase = SocialCalc.crToCoord(col-coloffset, row-rowoffset); // copy attribs of the one before (0 gives you A or 1)\n               basecell = sheet.GetAssuredCell(crbase);\n               for (attrib in cellProperties) {\n                  if (cellProperties[attrib] == 2) { // copy only format attributes\n                     cell[attrib] = basecell[attrib];\n                     }\n                  }\n               }\n            }\n\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\n             cell = sheet.cells[cr];\n             if (cell && cell.datatype == \"f\") {\n                cell.formula = SocialCalc.AdjustFormulaCoords(cell.formula, cr1.col, coloffset, cr1.row, rowoffset);\n                }\n             if (cell) {\n                delete cell.parseinfo;\n                }\n             }\n\n         for (name in sheet.names) { // update cell references to moved cells in names\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\n               v1 = sheet.names[name].definition;\n               v2 = \"\";\n               if (v1.charAt(0) == \"=\") {\n                  v2 = \"=\";\n                  v1 = v1.substring(1);\n                  }\n               sheet.names[name].definition = v2 +\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\n               }\n            }\n\n         for (row = attribs.lastrow; row >= rowend && cmd1 == \"insertrow\"; row--) { // copy the row attributes forward\n            rownext = row + rowoffset;\n            for (attrib in sheet.rowattribs) {\n               val = sheet.rowattribs[attrib][row];\n               if (sheet.rowattribs[attrib][rownext] != val) { // make assignment only if different\n                  if (val) {\n                     sheet.rowattribs[attrib][rownext] = val;\n                     }\n                  else {\n                     delete sheet.rowattribs[attrib][rownext];\n                     }\n                  }\n               }\n            }\n\n         for (col = attribs.lastcol; col >= colend && cmd1 == \"insertcol\"; col--) { // copy the column attributes forward\n            colthis = SocialCalc.rcColname(col);\n            colnext = SocialCalc.rcColname(col + coloffset);\n            for (attrib in sheet.colattribs) {\n               val = sheet.colattribs[attrib][colthis];\n               if (sheet.colattribs[attrib][colnext] != val) { // make assignment only if different\n                  if (val) {\n                     sheet.colattribs[attrib][colnext] = val;\n                     }\n                  else {\n                     delete sheet.colattribs[attrib][colnext];\n                     }\n                  }\n               }\n            }\n\n         // Expand merged cells if the new row/col is in between\n\n         var tempRenderContext = new SocialCalc.RenderContext(sheet)\n         tempRenderContext.CalculateCellSkipData()\n\n         var cellsToExpand = {} // Keep track of all merge spans we've expanded\n                                // so we don't expand one twice\n         for (var skipCell in tempRenderContext.cellskip) {\n             var skipCellCR = SocialCalc.coordToCr(skipCell)\n               , mergerCellCoords = tempRenderContext.cellskip[skipCell]\n             // for insertcol we check if the newly inserted col has\n             // has any spans. This can only mean, that those cells\n             // are part of a row span\n             if (cmd1 === \"insertcol\" && skipCellCR.col === newcolstart) {\n                if (!cellsToExpand[mergerCellCoords]) {\n                    sheet.GetAssuredCell(mergerCellCoords).colspan += coloffset\n                    }\n                cellsToExpand[mergerCellCoords] = true\n                }\n             // for insertrow it's the same method\n             if (cmd1 === \"insertrow\" && skipCellCR.row === newrowstart) {\n                if (!cellsToExpand[mergerCellCoords]) {\n                    sheet.GetAssuredCell(mergerCellCoords).rowspan += rowoffset\n                    }\n                cellsToExpand[mergerCellCoords] = true\n                }\n            }\n\n         attribs.lastcol += coloffset;\n         attribs.lastrow += rowoffset;\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"deletecol\":\n      case \"deleterow\":\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         what = cmd.NextToken();\n         rest = cmd.RestOfString();\n         lastcol = attribs.lastcol; // save old values since ParseRange sets...\n         lastrow = attribs.lastrow;\n         ParseRange();\n\n         if (cmd1 == \"deletecol\") {\n            coloffset = cr1.col - cr2.col - 1;\n            rowoffset = 0;\n            colstart = cr2.col + 1;\n            rowstart = 1;\n            }\n         else {\n            coloffset = 0;\n            rowoffset = cr1.row - cr2.row - 1;\n            colstart = 1;\n            rowstart = cr2.row + 1;\n            }\n\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // check for readonly cells\n            for (col=colstart; col <= lastcol - coloffset; col++) {\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               cell = sheet.cells[cr];\n               if (cell && cell.readonly) {\n                    errortext = \"Unable to remove \" + (cmd1 == \"deletecol\" ? \"column\" : \"row\") + \", because cell \" + cell.coord + \" is locked\";\n                    return errortext; \n               }\n            }\n         }\n\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // copy the cells backwards - extra so no dup of last set\n            for (col=colstart; col <= lastcol - coloffset; col++) {\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               if (saveundo && (row<rowstart-rowoffset || col<colstart\t-coloffset)) { // save cells that are overwritten as undo info\n                  cell = sheet.cells[cr];\n                  if (!cell) { // empty cell\n                     changes.AddUndo(\"erase \"+cr+\" all\");\n                     }\n                  else {\n                     changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n                     }\n                  }\n               crbase = SocialCalc.crToCoord(col, row);\n               cell = sheet.cells[crbase];\n               if (!cell) { // copying empty cell\n                  delete sheet.cells[cr]; // delete anything that may have been there\n                  }\n               else { // overwrite existing cell with moved contents\n                  sheet.cells[cr] = cell;\n                  }\n               }\n            }\n\n//!!! multiple deletes isn't setting #REF!; need to fix up #REF!'s on undo but only those!\n\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\n             cell = sheet.cells[cr];\n             if (cell) {\n                if (cell.datatype == \"f\") {\n                   oldformula = cell.formula;\n                   cell.formula = SocialCalc.AdjustFormulaCoords(oldformula, cr1.col, coloffset, cr1.row, rowoffset);\n                   if (cell.formula != oldformula) {\n                      delete cell.parseinfo;\n                      if (saveundo && cell.formula.indexOf(\"#REF!\")!=-1) { // save old version only if removed coord\n                         oldcr = SocialCalc.coordToCr(cr);\n                         changes.AddUndo(\"set \"+SocialCalc.rcColname(oldcr.col-coloffset)+(oldcr.row-rowoffset)+\n                                         \" formula \"+oldformula);\n                         }\n                      }\n                   }\n                else {\n                   delete cell.parseinfo;\n                   }\n                }\n             }\n\n         for (name in sheet.names) { // update cell references to moved cells in names\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\n               v1 = sheet.names[name].definition;\n               v2 = \"\";\n               if (v1.charAt(0) == \"=\") {\n                  v2 = \"=\";\n                  v1 = v1.substring(1);\n                  }\n               sheet.names[name].definition = v2 +\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\n               }\n            }\n\n         for (row = rowstart; row <= lastrow - rowoffset && cmd1 == \"deleterow\"; row++) { // copy the row attributes backwards\n            rowbefore = row + rowoffset;\n            for (attrib in sheet.rowattribs) {\n               val = sheet.rowattribs[attrib][row];\n               if (sheet.rowattribs[attrib][rowbefore] != val) { // make assignment only if different\n                  if (saveundo) changes.AddUndo(\"set \"+rowbefore+\" \"+attrib, sheet.rowattribs[attrib][rowbefore]);\n                  if (val) {\n                     sheet.rowattribs[attrib][rowbefore] = val;\n                     }\n                  else {\n                     delete sheet.rowattribs[attrib][rowbefore];\n                     }\n                  }\n               }\n            }\n\n         for (col = colstart; col <= lastcol - coloffset && cmd1 == \"deletecol\"; col++) { // copy the column attributes backwards\n            colthis = SocialCalc.rcColname(col);\n            colbefore = SocialCalc.rcColname(col + coloffset);\n            for (attrib in sheet.colattribs) {\n               val = sheet.colattribs[attrib][colthis];\n               if (sheet.colattribs[attrib][colbefore] != val) { // make assignment only if different\n                  if (saveundo) changes.AddUndo(\"set \"+colbefore+\" \"+attrib, sheet.colattribs[attrib][colbefore]);\n                  if (val) {\n                     sheet.colattribs[attrib][colbefore] = val;\n                     }\n                  else {\n                     delete sheet.colattribs[attrib][colbefore];\n                     }\n                  }\n               }\n            }\n\n         // Shrink merged cells if the new row/col was in between\n\n         var tempRenderContext = new SocialCalc.RenderContext(sheet)\n         tempRenderContext.CalculateCellSkipData()\n\n         var cellsToShrink = {} // Keep track of shrinked cells, so we don't do it twice\n         for (var skipCell in tempRenderContext.cellskip) {\n             var skipCellCR = SocialCalc.coordToCr(skipCell)\n               , mergerCellCoords = tempRenderContext.cellskip[skipCell]\n               , mergerCellCR = tempRenderContext.coordToCR[mergerCellCoords]\n             // for deletecol we check if the removed col any spans that\n             // are from younger cols and shrink those\n             if (cmd1 === \"deletecol\" && skipCellCR.col === colstart+coloffset && mergerCellCR.col < skipCellCR.col) {\n                if (!cellsToShrink[mergerCellCoords]) {\n                    sheet.GetAssuredCell(mergerCellCoords).colspan += coloffset\n                    }\n                cellsToShrink[mergerCellCoords] = true\n                }\n             // for insertrow it's the same method\n             if (cmd1 === \"deleterow\" && skipCellCR.row === rowstart+rowoffset && mergerCellCR.row < skipCellCR.row) {\n                if (!cellsToShrink[mergerCellCoords]) {\n                    sheet.GetAssuredCell(mergerCellCoords).rowspan += rowoffset\n                    }\n                cellsToShrink[mergerCellCoords] = true\n                }\n            }\n\n         if (saveundo) {\n            if (cmd1 == \"deletecol\") {\n               for (col=cr1.col; col<=cr2.col; col++) {\n                  changes.AddUndo(\"insertcol \"+SocialCalc.rcColname(cr1.col));\n                  }\n               }\n            else {\n               for (row=cr1.row; row<=cr2.row; row++) {\n                  changes.AddUndo(\"insertrow \"+cr1.row);\n                  }\n               }\n            }\n\n         if (cmd1 == \"deletecol\") {\n            if (cr1.col <= lastcol) { // shrink sheet unless deleted phantom cols off the end\n               if (cr2.col <= lastcol) {\n                  attribs.lastcol += coloffset;\n                  }\n               else {\n                  attribs.lastcol = cr1.col - 1;\n                  }\n               }\n            }\n         else {\n            if (cr1.row <= lastrow) { // shrink sheet unless deleted phantom rows off the end\n               if (cr2.row <= lastrow) {\n                  attribs.lastrow += rowoffset;\n                  }\n               else {\n                  attribs.lastrow = cr1.row - 1;\n                  }\n               }\n            }\n         attribs.needsrecalc = \"yes\";\n         break;\n\n\n      case \"movepaste\":\n      case \"moveinsert\":\n\n         var movingcells, dest, destcr, inserthoriz, insertvert, pushamount, movedto;\n\n         sheet.renderneeded = true;\n         sheet.changedrendervalues = true;\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\n         what = cmd.NextToken();\n         dest = cmd.NextToken();\n         rest = cmd.RestOfString(); // rest is all/formulas/formats\n         if (rest==\"\") rest = \"all\";\n\n         ParseRange();\n\n         destcr = SocialCalc.coordToCr(dest);\n\n         coloffset = destcr.col - cr1.col;\n         rowoffset = destcr.row - cr1.row;\n         numcols = cr2.col - cr1.col + 1;\n         numrows = cr2.row - cr1.row + 1;\n\n         // get a copy of moving cells and erase from where they were\n\n         movingcells = {};\n\n         for (row = cr1.row; row <= cr2.row; row++) {\n            for (col = cr1.col; col <= cr2.col; col++) {\n               cr = SocialCalc.crToCoord(col, row);\n               cell=sheet.GetAssuredCell(cr);\n               if (cell.readonly) continue;\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n\n               if (!sheet.cells[cr]) { // if had nothing\n                  continue; // don't save anything\n                  }\n               movingcells[cr] = new SocialCalc.Cell(cr); // create new cell to copy\n\n               for (attrib in cellProperties) { // go through each property\n                  if (typeof cell[attrib] === undefined) { // don't copy undefined things and no need to delete\n                     continue;\n                     }\n                  else {\n                     movingcells[cr][attrib] = cell[attrib]; // copy for potential moving\n                     }\n                  if (rest == \"all\") {\n                     delete cell[attrib];\n                     }\n                  if (rest == \"formulas\") {\n                     if (cellProperties[attrib] == 1 || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     }\n                  if (rest == \"formats\") {\n                     if (cellProperties[attrib] == 2) {\n                        delete cell[attrib];\n                        }\n                     }\n                  }\n               if (rest == \"formulas\") { // leave pristene deleted cell\n                  cell.datavalue = \"\";\n                  cell.datatype = null;\n                  cell.formula = \"\";\n                  cell.valuetype = \"b\";\n                  }\n               if (rest == \"all\") { // leave nothing for move all\n                  delete sheet.cells[cr];\n                  }\n               }\n            }\n\n         // if moveinsert, check destination OK, and calculate pushing parameters\n\n         if (cmd1 == \"moveinsert\") {\n            inserthoriz = false;\n            insertvert = false;\n            if (rowoffset==0 && (destcr.col < cr1.col || destcr.col > cr2.col)) {\n               if (destcr.col < cr1.col) { // moving left\n                  pushamount = cr1.col - destcr.col;\n                  inserthoriz = -1;\n                  }\n               else {\n                  destcr.col -= 1;\n                  coloffset = destcr.col - cr2.col;\n                  pushamount = destcr.col - cr2.col;\n                  inserthoriz = 1;\n                  }\n               }\n            else if (coloffset==0 && (destcr.row < cr1.row || destcr.row > cr2.row)) {\n               if (destcr.row < cr1.row) { // moving up\n                  pushamount = cr1.row - destcr.row;\n                  insertvert = -1;\n                  }\n               else {\n                  destcr.row -= 1;\n                  rowoffset = destcr.row - cr2.row;\n                  pushamount = destcr.row - cr2.row;\n                  insertvert = 1;\n                  }\n               }\n            else {\n               cmd1 = \"movepaste\"; // not allowed right now - ignore\n               }                \n            }\n\n         // push any cells that need pushing\n\n         movedto = {}; // remember what was moved where\n\n         if (insertvert) {\n            for (row = 0; row < pushamount; row++) {\n               for (col = cr1.col; col <= cr2.col; col++) {\n                  if (insertvert < 0) {\n                     crbase = SocialCalc.crToCoord(col, destcr.row+pushamount-row-1); // from cell\n                     cr = SocialCalc.crToCoord(col, cr2.row-row); // to cell\n                     }\n                  else {\n                     crbase = SocialCalc.crToCoord(col, destcr.row-pushamount+row+1); // from cell\n                     cr = SocialCalc.crToCoord(col, cr1.row+row); // to cell\n                     }\n\n                  basecell = sheet.GetAssuredCell(crbase);\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\n\n                  cell = sheet.GetAssuredCell(cr);\n                  if (rest == \"all\" || rest == \"formats\") {\n                     for (attrib in cellProperties) {\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                           delete cell[attrib];\n                           }\n                        else {\n                           cell[attrib] = basecell[attrib];\n                           }\n                        }\n                     }\n                  if (rest == \"all\" || rest == \"formulas\") {\n                     cell.datavalue = basecell.datavalue;\n                     cell.datatype = basecell.datatype;            \n                     cell.valuetype = basecell.valuetype;\n                     cell.formula = basecell.formula;\n                     delete cell.parseinfo;\n                     cell.errors = basecell.errors;\n                     }\n                  delete cell.displaystring;\n\n                  movedto[crbase] = cr; // old crbase is now at cr\n                  }\n               }\n            }\n         if (inserthoriz) {\n            for (col = 0; col < pushamount; col++) {\n               for (row = cr1.row; row <= cr2.row; row++) {\n                  if (inserthoriz < 0) {\n                     crbase = SocialCalc.crToCoord(destcr.col+pushamount-col-1, row);\n                     cr = SocialCalc.crToCoord(cr2.col-col, row);\n                     }\n                  else {\n                     crbase = SocialCalc.crToCoord(destcr.col-pushamount+col+1, row);\n                     cr = SocialCalc.crToCoord(cr1.col+col, row);\n                     }\n\n                  basecell = sheet.GetAssuredCell(crbase);\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\n\n                  cell = sheet.GetAssuredCell(cr);\n                  if (rest == \"all\" || rest == \"formats\") {\n                     for (attrib in cellProperties) {\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                           delete cell[attrib];\n                           }\n                        else {\n                           cell[attrib] = basecell[attrib];\n                           }\n                        }\n                     }\n                  if (rest == \"all\" || rest == \"formulas\") {\n                     cell.datavalue = basecell.datavalue;\n                     cell.datatype = basecell.datatype;            \n                     cell.valuetype = basecell.valuetype;\n                     cell.formula = basecell.formula;\n                     delete cell.parseinfo;\n                     cell.errors = basecell.errors;\n                     }\n                  delete cell.displaystring;\n\n                  movedto[crbase] = cr; // old crbase is now at cr\n                  }\n               }\n            }\n\n         // paste moved cells into new place\n\n         if (destcr.col+numcols-1 > attribs.lastcol) attribs.lastcol = destcr.col+numcols-1;\n         if (destcr.row+numrows-1 > attribs.lastrow) attribs.lastrow = destcr.row+numrows-1;\n\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\n               cell=sheet.GetAssuredCell(cr);\n               if (cell.readonly) continue;\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\n\n               crbase = SocialCalc.crToCoord(col, row); // get old cell to move\n\n               movedto[crbase] = cr; // old crbase (moved cell) will now be at cr (destination)\n\n               if (rest == \"all\" && !movingcells[crbase]) { // moving an empty cell\n                  delete sheet.cells[cr]; // make the cell empty\n                  continue;\n                  }\n\n               basecell = movingcells[crbase];\n               if (!basecell) basecell = sheet.GetAssuredCell(crbase);\n\n               if (rest == \"all\" || rest == \"formats\") {\n                  for (attrib in cellProperties) {\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\n                        delete cell[attrib];\n                        }\n                     else {\n                        cell[attrib] = basecell[attrib];\n                        }\n                     }\n                  }\n               if (rest == \"all\" || rest == \"formulas\") {\n                  cell.datavalue = basecell.datavalue;\n                  cell.datatype = basecell.datatype;            \n                  cell.valuetype = basecell.valuetype;\n                  cell.formula = basecell.formula;\n                  delete cell.parseinfo;\n                  cell.errors = basecell.errors;\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\n                     cell.comment = basecell.comment;\n                     }\n                  else if (cell.comment) {\n                     delete cell.comment;\n                     }\n                  }\n               delete cell.displaystring;\n               }\n            }\n\n         // do fixups\n\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\n             cell = sheet.cells[cr];\n             if (cell) {\n                if (cell.datatype == \"f\") {\n                   oldformula = cell.formula;\n                   cell.formula = SocialCalc.ReplaceFormulaCoords(oldformula, movedto);\n                   if (cell.formula != oldformula) {\n                      delete cell.parseinfo;\n                      if (saveundo && !movedto[cr]) { // moved cells are already saved for undo\n                         changes.AddUndo(\"set \"+cr+\" formula \"+oldformula);\n                         }\n                      }\n                   }\n                else {\n                   delete cell.parseinfo;\n                   }\n                }\n             }\n\n         for (name in sheet.names) { // update cell references to moved cells in names\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\n               v1 = sheet.names[name].definition;\n               oldformula = v1;\n               v2 = \"\";\n               if (v1.charAt(0) == \"=\") {\n                  v2 = \"=\";\n                  v1 = v1.substring(1);\n                  }\n               sheet.names[name].definition = v2 +\n                  SocialCalc.ReplaceFormulaCoords(v1, movedto);\n               if (saveundo && sheet.names[name].definition != oldformula) { // save changes\n                  changes.AddUndo(\"name define \"+name+\" \"+oldformula);\n                  }\n               }\n            }\n\n         attribs.needsrecalc = \"yes\";\n         break;\n\n      case \"name\":\n         what = cmd.NextToken();\n         name = cmd.NextToken();\n         rest = cmd.RestOfString();\n\n         name = name.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\n         if (name == \"\") break; // must have something\n\n         if (what == \"define\") {\n            if (rest == \"\") break; // must have something\n            if (sheet.names[name]) { // already exists\n               if (saveundo) changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\n               sheet.names[name].definition = rest;\n               }\n            else { // new\n               if (saveundo) changes.AddUndo(\"name delete \"+name);\n               sheet.names[name] = {definition: rest, desc: \"\"};\n               }\n            }\n         else if (what == \"desc\") {\n            if (sheet.names[name]) { // must already exist\n               if (saveundo) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\n               sheet.names[name].desc = rest;\n               }\n            }\n         else if (what == \"delete\") {\n            if (saveundo) {\n               if (sheet.names[name].desc) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\n               changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\n               }\n            delete sheet.names[name];\n            }\n         attribs.needsrecalc = \"yes\";\n\n         break;\n\n      case \"recalc\":\n         attribs.needsrecalc = \"yes\"; // request recalc\n         sheet.recalconce = true; // even if turned off\n         break;\n\n      case \"redisplay\":\n         sheet.renderneeded = true;\n         break;\n\n      case \"changedrendervalues\": // needed for undo sometimes\n         sheet.changedrendervalues = true;\n         break;\n\n      case \"pane\":\n\n         name = cmd.NextToken().toUpperCase();\n         undoNum = 1;\n         editor = SocialCalc.GetSpreadsheetControlObject().editor;\n\n         if (name.toUpperCase() === 'ROW') {\n           row = parseInt(cmd.NextToken(), 10);\n\n           if (typeof(editor.context.rowpanes[1]) !== 'undefined' && typeof(editor.context.rowpanes[1].first) === 'number') {\n             undoNum = editor.context.rowpanes[1].first;\n           }\n           if (saveundo) changes.AddUndo('pane row ' + undoNum);\n\n           // Handle hidden row.\n           while (editor.context.sheetobj.rowattribs.hide[row] == 'yes') {\n             row++;\n           }\n\n           if ((!row || row<=editor.context.rowpanes[0].first) && editor.context.rowpanes.length>1) { // set to no panes, leaving first pane settings\n             editor.context.rowpanes.length = 1;\n           } else if (editor.context.rowpanes.length-1 && !editor.timeout) { // has 2 already\n             // not waiting for position calc (so positions could be wrong)\n             editor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\n             editor.context.SetRowPaneFirstLast(1, row, row);\n           } else {\n             editor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\n             editor.context.SetRowPaneFirstLast(1, row, row);\n           }\n           \n           // remove tracklingine\n           if (editor.griddiv) {\n             //trackingline-horizon\n             trackLine = document.getElementById('trackingline-vertical');\n             if (trackLine) {\n               editor.griddiv.removeChild(trackLine);\n               editor.FitToEditTable();\n             }\n           }\n\n         } else {\n\n           col = parseInt(cmd.NextToken(), 10);\n\n           if (typeof(editor.context.colpanes[1]) !== 'undefined' && typeof(editor.context.colpanes[1].first) === 'number') {\n             undoNum = editor.context.colpanes[1].first;\n           }\n           if (saveundo) changes.AddUndo('pane col ' + undoNum);\n\n           // Handle hidden column.\n           while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == 'yes') {\n             col++;\n           }\n\n           if ((!col || col<=editor.context.colpanes[0].first) && editor.context.colpanes.length > 1) { // set to no panes, leaving first pane settings\n             editor.context.colpanes.length = 1;\n           } else if (editor.context.colpanes.length-1 && !editor.timeout) { // has 2 already\n             // not waiting for position calc (so positions could be wrong)\n             editor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\n             editor.context.SetColPaneFirstLast(1, col, col);\n           } else {\n             editor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\n             editor.context.SetColPaneFirstLast(1, col, col);\n           }\n\n           // remove tracklingine\n           if (editor.griddiv) {\n             trackLine = document.getElementById('trackingline-horizon');\n             if (trackLine) {\n               editor.griddiv.removeChild(trackLine);\n               editor.FitToEditTable();\n             }\n           }\n         }\n\n         sheet.renderneeded = true;\n\n         break;\n\n      case \"startcmdextension\": // startcmdextension extension rest-of-command\n         name = cmd.NextToken();\n         cmdextension = sheet.sci.CmdExtensionCallbacks[name];\n         if (cmdextension) {\n            cmdextension.func(name, cmdextension.data, sheet, cmd, saveundo);\n            }\n         break;\n\n         // eddy ExecuteSheetCommand {\n//      case \"setemailparameters\":    \t  \n//    \t  break;\n    \t  \n      case \"settimetrigger\":    \n      case \"sendemail\":    \n      case \"submitform\":    \n    \t  // email/form/timetrigger handled by server, so ignore here\n    \t  break;\n         // } eddy ExecuteSheetCommand \n    \t  \n      default:\n         errortext = scc.s_escUnknownCmd+cmdstr;\n         break;\n      }\n\n/* For Debugging:\nvar ustack=\"\";\nfor (var i=0;i<sheet.changes.stack.length;i++) {\n   ustack+=(i-0)+\":\"+sheet.changes.stack[i].command[0]+\" of \"+sheet.changes.stack[i].command.length+\"/\"+sheet.changes.stack[i].undo[0]+\" of \"+sheet.changes.stack[i].undo.length+\",\";\n   }\nalert(cmdstr+\"|\"+sheet.changes.stack.length+\"--\"+ustack);\n*/\n\n   return errortext;\n\n   }\n\nSocialCalc.SheetUndo = function(sheet) {\n\n   var i;\n   var tos = sheet.changes.TOS();\n   var lastone = tos ? tos.undo.length-1 : -1;\n   var cmdstr = \"\";\n\n   for (i=lastone; i>=0; i--) { // do them backwards\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\n      cmdstr += tos.undo[i];\n      }\n   sheet.changes.Undo();\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\n\n   }\n\nSocialCalc.SheetRedo = function(sheet) {\n\n   var tos, i;\n   var didredo = sheet.changes.Redo();\n   if (!didredo) {\n      sheet.ScheduleSheetCommands(\"\", false); // schedule doing nothing\n      return;\n      }\n   tos = sheet.changes.TOS();\n   var cmdstr = \"\";\n\n   for (i=0; tos && i<tos.command.length; i++) {\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\n      cmdstr += tos.command[i];\n      }\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\n\n   }\n\nSocialCalc.CreateAuditString = function(sheet) {\n\n   var i, j;\n   var result = \"\";\n   var stack = sheet.changes.stack;\n   var tos = sheet.changes.tos;\n   for (i=0; i<=tos; i++) {\n      for (j=0; j<stack[i].command.length; j++) {\n         result += stack[i].command[j] + \"\\n\";\n         }\n      }\n\n   return result;\n\n   }\n\nSocialCalc.GetStyleNum = function(sheet, atype, style) {\n\n   var num;\n\n   if (style.length==0) return 0; // null means use zero, which means default or global default\n\n   num = sheet[atype+\"hash\"][style];\n   if (!num) {\n      if (sheet[atype+\"s\"].length<1) sheet[atype+\"s\"].push(\"\");\n      num = sheet[atype+\"s\"].push(style) - 1;\n      sheet[atype+\"hash\"][style] = num;\n      sheet.changedrendervalues = true;\n      }\n   return num;\n\n   }\n\nSocialCalc.GetStyleString = function(sheet, atype, num) {\n\n   if (!num) return null; // zero, null, and undefined return null\n\n   return sheet[atype+\"s\"][num];\n\n   }\n\n//\n// updatedformula = SocialCalc.OffsetFormulaCoords(formula, coloffset, rowoffset)\n//\n// Change relative cell references by offsets (even those to other worksheets so fill, paste, sort work as expected).\n// If not what you want, use absolute references.\n//\n\nSocialCalc.OffsetFormulaCoords = function(formula, coloffset, rowoffset) {\n\n   var parseinfo, ttext, ttype, i, cr, newcr;\n   var updatedformula = \"\";\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_string = tokentype.string;\n   var token_coord = tokentype.coord;\n   var tokenOpExpansion = scf.TokenOpExpansion;\n\n   parseinfo = scf.ParseFormulaIntoTokens(formula);\n\n   for (i=0; i<parseinfo.length; i++) {\n      ttype = parseinfo[i].type;\n      ttext = parseinfo[i].text;\n      if (ttype == token_coord) {\n         newcr = \"\";\n         cr = SocialCalc.coordToCr(ttext);\n         if (ttext.charAt(0)!=\"$\") { // add col offset unless absolute column\n            cr.col += coloffset;\n            }\n         else {\n            newcr += \"$\";\n            }\n         newcr += SocialCalc.rcColname(cr.col);\n         if (ttext.indexOf(\"$\", 1)==-1) { // add row offset unless absolute row\n            cr.row += rowoffset;\n            }\n         else {\n            newcr += \"$\";\n            }\n         newcr += cr.row;\n         if (cr.row < 1 || cr.col < 1) {\n            newcr = \"#REF!\";\n            }\n         updatedformula += newcr;\n         }\n      else if (ttype == token_string) {\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\n            updatedformula += '\"' + ttext.replace(/\"/, '\"\"') + '\"';\n            }\n         else updatedformula += '\"' + ttext + '\"';\n         }\n      else if (ttype == token_op) {\n         updatedformula += tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\n         }\n      else { // leave everything else alone\n         updatedformula += ttext;\n         }\n      }\n\n   return updatedformula;\n\n   }\n\n//\n// updatedformula = SocialCalc.AdjustFormulaCoords(formula, col, coloffset, row, rowoffset)\n//\n// Change all cell references to cells starting with col/row by offsets\n//\n\nSocialCalc.AdjustFormulaCoords = function(formula, col, coloffset, row, rowoffset) {\n\n   var ttype, ttext, i, newcr;\n   var updatedformula = \"\";\n   var sheetref = false;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_string = tokentype.string;\n   var token_coord = tokentype.coord;\n   var tokenOpExpansion = scf.TokenOpExpansion;\n\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\n\n   for (i=0; i<parseinfo.length; i++) {\n      ttype = parseinfo[i].type;\n      ttext = parseinfo[i].text;\n      if (ttype == token_op) { // references with sheet specifier are not offset\n         if (ttext == \"!\") {\n            sheetref = true; // found a sheet reference\n            }\n         else if (ttext != \":\") { // for everything but a range, reset\n            sheetref = false;\n            }\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\n         }\n      if (ttype == token_coord) {\n         cr = SocialCalc.coordToCr(ttext);\n         if ((coloffset < 0 && cr.col >= col && cr.col < col-coloffset) ||\n             (rowoffset < 0 && cr.row >= row && cr.row < row-rowoffset)) { // refs to deleted cells become invalid\n            if (!sheetref) {\n               cr.col = 0;\n               cr.row = 0;\n               }\n            }\n         if (!sheetref) {\n            if (cr.col >= col) {\n               cr.col += coloffset;\n               }\n            if (cr.row >= row) {\n               cr.row += rowoffset;\n               }\n            }\n         if (ttext.charAt(0)==\"$\") {\n            newcr = \"$\"+SocialCalc.rcColname(cr.col);\n            }\n         else {\n            newcr = SocialCalc.rcColname(cr.col);\n            }\n         if (ttext.indexOf(\"$\", 1)!=-1) {\n            newcr += \"$\" + cr.row;\n            }\n         else {\n            newcr += cr.row;\n            }\n         if (cr.row < 1 || cr.col < 1) {\n            newcr = \"#REF!\";\n            }\n         ttext = newcr;\n         }\n      else if (ttype == token_string) {\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\n            }\n         else ttext = '\"' + ttext + '\"';\n         }\n      updatedformula += ttext;\n      }\n\n   return updatedformula;\n\n   }\n\n//\n// updatedformula = SocialCalc.ReplaceFormulaCoords(formula, movedto)\n//\n// Change all cell references to cells that are keys in moveto to be to moveto[coord].\n// Don't change references to other sheets.\n// Handle range extents specially.\n//\n\nSocialCalc.ReplaceFormulaCoords = function(formula, movedto) {\n\n   var ttype, ttext, i, newcr, coord;\n   var updatedformula = \"\";\n   var sheetref = false;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_string = tokentype.string;\n   var token_coord = tokentype.coord;\n   var tokenOpExpansion = scf.TokenOpExpansion;\n\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\n\n   for (i=0; i<parseinfo.length; i++) {\n      ttype = parseinfo[i].type;\n      ttext = parseinfo[i].text;\n      if (ttype == token_op) { // references with sheet specifier are not change\n         if (ttext == \"!\") {\n            sheetref = true; // found a sheet reference\n            }\n         else if (ttext != \":\") { // for everything but a range, reset\n            sheetref = false;\n            }\n\n//!!!! HANDLE RANGE EXTENT MOVES\n\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\n         }\n      if (ttype == token_coord) {\n         cr = SocialCalc.coordToCr(ttext); // get parts\n         coord = SocialCalc.crToCoord(cr.col, cr.row); // get \"clean\" reference\n         if (movedto[coord] && !sheetref) { // this is a reference to a moved cell\n            cr = SocialCalc.coordToCr(movedto[coord]); // get new row and col\n            if (ttext.charAt(0)==\"$\") { // copy absolute ref marks if present\n               newcr = \"$\"+SocialCalc.rcColname(cr.col);\n               }\n            else {\n               newcr = SocialCalc.rcColname(cr.col);\n               }\n            if (ttext.indexOf(\"$\", 1)!=-1) {\n               newcr += \"$\" + cr.row;\n               }\n            else {\n               newcr += cr.row;\n               }\n            ttext = newcr;\n            }\n         }\n      else if (ttype == token_string) {\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\n            }\n         else ttext = '\"' + ttext + '\"';\n         }\n      updatedformula += ttext;\n      }\n\n   return updatedformula;\n\n   }\n\n\n// ************************\n//\n// Recalc Loop Code\n//\n// ************************\n\n//\n// How recalc works:\n//\n// !!!!!!!!!!!!!!\n//\n\n// SocialCalc.RecalcInfo - object with global recalc info\n\nSocialCalc.RecalcInfo = {\n\n   sheet: null, // which sheet is being recalced\n\n   currentState: 0, // current state\n   state: {idle: 0, start_calc: 1, order: 2, calc: 3, start_wait: 4, done_wait: 5}, // allowed state values\n\n   recalctimer: null, // value to cancel timer\n   maxtimeslice: 100, // maximum milliseconds per slice of recalc time before a wait\n   timeslicedelay: 1, // milliseconds to wait between recalc time slices\n   starttime: 0, // when recalc started\n\n   queue: [], // queue of sheet waiting to be recalced\n\n   // LoadSheet: a function that returns true if started a load or false if not.\n   //\n\n   LoadSheet: function(sheetname) {return false;} // default returns not found\n\n   }\n\n// SocialCalc.RecalcData - object with recalc info while determining recalc order and afterward\n\nSocialCalc.RecalcData = function() { // initialize a RecalcData object\n\n   this.inrecalc = true; // if true, doing a recalc\n   this.celllist = []; // list with all potential cells to calculate\n   this.celllistitem = 0; // cell to check next when ordering\n   this.calclist = null; // object which is the chained list of cells to calculate\n                         // each in the form of \"coord: nextcoord\"\n                         // e.g., if B8 is calculated right after A8, then calclist.A8==\"B8\"\n                         // if null, need to create the list\n   this.calclistlength = 0; // number of items in calclist\n\n   this.firstcalc = null; // start of the calc list - a string or null\n   this.lastcalc = null; // last one on chain (used to add more to the end)\n\n   this.nextcalc = null; // used to keep track during background recalc to make it restartable\n   this.count = 0; // number calculated\n\n   // checkinfo is used when determining calc order:\n\n   this.checkinfo = {}; // attributes are coords; if no attrib for a coord, it wasn't checked or doesn't need it\n                        // values are RecalcCheckInfo objects while checking or TRUE when complete\n\n   }\n\n// SocialCalc.RecalcCheckInfo - object that stores checking info while determining recalc order\n\nSocialCalc.RecalcCheckInfo = function() { // initialize a RecalcCheckInfo object\n\n   this.oldcoord = null; // chain back up of cells referring to cells\n   this.parsepos = 0; // which token we are up to\n\n   // range info\n\n   this.inrange = false; // if true, in the process of checking a range of coords\n   this.inrangestart = false; // if true, have not yet filled in range loop values\n   this.cr1 = null; // range first coord as a cr object\n   this.cr2 = null; // range second coord as a cr object\n   this.c1 = null; // range extents\n   this.c2 = null;\n   this.r1 = null;\n   this.r2 = null;\n   this.c = null; // looping values\n   this.r = null;\n   \n   }\n\n// Recalc the entire sheet\n\nSocialCalc.RecalcSheet = function(sheet) {\n\n   var coord, err, recalcdata;\n   var scri = SocialCalc.RecalcInfo;\n\n   if (scri.currentState != scri.state.idle) {\n      scri.queue.push(sheet);\n      return;\n      }\n\n   delete sheet.attribs.circularreferencecell; // reset recalc-wide things\n   SocialCalc.Formula.FreshnessInfoReset();\n\n   SocialCalc.RecalcClearTimeout();\n\n   scri.sheet = sheet; // set values needed by background recalc\n   scri.currentState = scri.state.start_calc;\n\n   scri.starttime = new Date();\n\n   if (sheet.statuscallback) {\n      sheet.statuscallback(scri, \"calcstart\", null, sheet.statuscallbackparams);\n      }\n\n   SocialCalc.RecalcSetTimeout();\n\n   }\n\n//\n// SocialCalc.RecalcSetTimeout - set a timer for next recalc step\n//\n\nSocialCalc.RecalcSetTimeout = function() {\n\n   var scri = SocialCalc.RecalcInfo;\n\n   scri.recalctimer = window.setTimeout(SocialCalc.RecalcTimerRoutine, scri.timeslicedelay);\n\n   }\n\n//\n// SocialCalc.RecalcClearTimeout - cancel any timeouts\n//\n\nSocialCalc.RecalcClearTimeout = function() {\n\n   var scri = SocialCalc.RecalcInfo;\n\n   if (scri.recalctimer) {\n      window.clearTimeout(scri.recalctimer);\n      scri.recalctimer = null;\n      }\n\n   }\n\n  \n//\n// SocialCalc.RecalcLoadedSheet(sheetname, str, recalcneeded, live)\n//\n// Called when a sheet finishes loading with name, string, and t/f whether it should be recalced.\n// If loaded sheet has sheet.attribs.recalc==\"off\", then no recalc done.\n// If sheetname is null, then the sheetname waiting for will be used.\n//\n\nSocialCalc.RecalcLoadedSheet = function(sheetname, str, recalcneeded, live) {\n\n   var sheet;\n   var scri = SocialCalc.RecalcInfo;\n   var scf = SocialCalc.Formula;\n\n   sheet = SocialCalc.Formula.AddSheetToCache(sheetname || scf.SheetCache.waitingForLoading, str, live);\n\n   if (recalcneeded && sheet && sheet.attribs.recalc!=\"off\") { // if recalcneeded, and not manual sheet, chain in this new sheet to recalc loop\n      sheet.previousrecalcsheet = scri.sheet;\n      scri.sheet = sheet;\n      scri.currentState = scri.state.start_calc;\n      }\n   scf.SheetCache.waitingForLoading = null;\n\n   SocialCalc.RecalcSetTimeout();\n\n   }\n\n\n//\n// SocialCalc.RecalcTimerRoutine - handles the actual order determination and cell-by-cell recalculation in the background\n//\n\nSocialCalc.RecalcTimerRoutine = function() {\n\n   var eresult, cell, coord, err, status;\n   var starttime = new Date();\n   var count = 0;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var scri = SocialCalc.RecalcInfo;\n   var sheet = scri.sheet;\n   if (!sheet) {\n      return;\n      }\n   var recalcdata = sheet.recalcdata || (sheet.recalcdata = {});\n\n   var do_statuscallback = function(status, arg) { // routine to do callback if required\n      if (sheet.statuscallback) {\n         sheet.statuscallback(recalcdata, status, arg, sheet.statuscallbackparams);\n         }\n      }\n\n   SocialCalc.RecalcClearTimeout();\n\n   if (scri.currentState == scri.state.start_calc) {\n\n      recalcdata = new SocialCalc.RecalcData();\n      sheet.recalcdata = recalcdata;\n\n      for (coord in sheet.cells) { // get list of cells to check for order\n         if (!coord) continue;\n         recalcdata.celllist.push(coord);\n         }\n\n      recalcdata.calclist = {}; // start with empty list\n      scri.currentState = scri.state.order; // drop through to determining recalc order\n      }\n\n   if (scri.currentState == scri.state.order) {\n      while (recalcdata.celllistitem < recalcdata.celllist.length) { // check all the cells to see if they should be on the list\n         coord = recalcdata.celllist[recalcdata.celllistitem++];\n         err = SocialCalc.RecalcCheckCell(sheet, coord);\n         if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\n            do_statuscallback(\"calcorder\", {coord: coord, total: recalcdata.celllist.length, count: recalcdata.celllistitem});\n            SocialCalc.RecalcSetTimeout();\n            return;\n            }\n         }\n\n      do_statuscallback(\"calccheckdone\", recalcdata.calclistlength);\n\n      recalcdata.nextcalc = recalcdata.firstcalc; // start at the beginning of the recalc chain\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\n      SocialCalc.RecalcSetTimeout();\n      return;\n      }\n\n   if (scri.currentState == scri.state.start_wait) { // starting to wait for something\n      scri.currentState = scri.state.done_wait; // finished on next timer call\n      if (scri.LoadSheet) {\n         status = scri.LoadSheet(scf.SheetCache.waitingForLoading);\n         if (status) { // started a load operation\n            return;\n            }\n         }\n      SocialCalc.RecalcLoadedSheet(null, \"\", false);\n      return;\n      }\n\n   if (scri.currentState == scri.state.done_wait) {\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\n      SocialCalc.RecalcSetTimeout();\n      return;\n      }\n\n   // otherwise should be scri.state.calc\n\n   if (scri.currentState != scri.state.calc) {\n      alert(\"Recalc state error: \"+scri.currentState+\". Error in SocialCalc code.\");\n      }\n\n   coord = sheet.recalcdata.nextcalc;\n   while (coord) {\n      cell = sheet.cells[coord];\n\t  // eddy RecalcTimerRoutine {\n\t   cell.parseinfo.coord = coord;\n\t  // }\n      eresult = scf.evaluate_parsed_formula(cell.parseinfo, sheet, false);\n      if (scf.SheetCache.waitingForLoading) { // wait until restarted\n         recalcdata.nextcalc = coord; // start with this cell again\n         recalcdata.count += count;\n         do_statuscallback(\"calcloading\", {sheetname: scf.SheetCache.waitingForLoading});\n         scri.currentState = scri.state.start_wait; // start load on next timer call\n         SocialCalc.RecalcSetTimeout();\n         return;\n         }\n\n      if (scf.RemoteFunctionInfo.waitingForServer) { // wait until restarted\n         recalcdata.nextcalc = coord; // start with this cell again\n         recalcdata.count += count;\n         do_statuscallback(\"calcserverfunc\",\n            {funcname: scf.RemoteFunctionInfo.waitingForServer, coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\n         scri.currentState = scri.state.done_wait; // start load on next timer call\n         return; // return and wait for next recalc timer event\n         }\n\n      if (cell.datavalue != eresult.value ||\n       cell.valuetype != eresult.type) { // only update if changed from last time\n         cell.datavalue = eresult.value;\n         cell.valuetype = eresult.type;\n         delete cell.displaystring;\n         sheet.recalcchangedavalue = true; // remember something changed in case other code wants to know\n         }\n      if (eresult.error) {\n         cell.errors = eresult.error;\n         }\n      count++;\n      coord = sheet.recalcdata.calclist[coord];\n\n      if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\n         recalcdata.nextcalc = coord; // start with next cell on chain\n         recalcdata.count += count;\n         do_statuscallback(\"calcstep\", {coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\n         SocialCalc.RecalcSetTimeout();\n         return;\n         }\n      }\n\n   recalcdata.inrecalc = false;\n\n   delete sheet.recalcdata; // save memory and clear out for name lookup formula evaluation\n\n   delete sheet.attribs.needsrecalc; // remember recalc done\n\n   scri.sheet = sheet.previousrecalcsheet || null; // chain back if doing recalc of loaded sheets\n   if (scri.sheet) {\n      scri.currentState = scri.state.calc; // start where we left off\n      SocialCalc.RecalcSetTimeout();\n      return;\n      }\n\n   scf.FreshnessInfo.recalc_completed = true; // say freshness info is complete\n   scri.currentState = scri.state.idle; // we are idle\n\n   do_statuscallback(\"calcfinished\", (new Date()) - scri.starttime);\n\n   // Check queue for more sheets.\n   if (scri.queue.length > 0) {\n      sheet = scri.queue.shift();\n      sheet.RecalcSheet();\n      }\n   }\n\n\n//\n// circref = SocialCalc.RecalcCheckCell(sheet, coord)\n//\n// Checks cell to put on calclist, looking at parsed tokens.\n// Also checks cells this cell is dependent upon\n// if it contains a formula with cell references.\n// If circular reference, returns non-null.\n//\n\nSocialCalc.RecalcCheckCell = function(sheet, startcoord) {\n\n   var parseinfo, ttext, ttype, i, rangecoord, circref, value, pos, pos2, cell, coordvals;\n   var scf = SocialCalc.Formula;\n   if (!scf) {\n      return \"Need SocialCalc.Formula\";\n      }\n   var tokentype = scf.TokenType;\n   var token_op = tokentype.op;\n   var token_name = tokentype.name;\n   var token_coord = tokentype.coord;\n\n   var recalcdata = sheet.recalcdata;\n   var checkinfo = recalcdata.checkinfo;\n\n   var sheetref = false; // if true, a sheet reference is in effect, so don't check that\n   var oldcoord = null; // coord of formula that referred to this one when checking down the tree\n   var coord = startcoord; // the coord of the cell we are checking\n\n   // Start with requested cell, and then continue down or up the dependency tree\n   // oldcoord (and checkinfo[coord].oldcoord) maintains the reference stack during the tree walk\n   // checkinfo[coord] maintains the stack of checking looping values, e.g., token number being checked\n\nmainloop:\n   while (coord) {\n      cell = sheet.cells[coord];\n      coordvals = checkinfo[coord];\n\n      if (!cell || cell.datatype != \"f\" || // Don't calculate if not a formula\n          (coordvals && typeof coordvals != \"object\")) { // Don't calc if already calculated\n         coord = oldcoord; // go back up dependency tree to coord that referred to us\n         if (checkinfo[coord]) oldcoord = checkinfo[coord].oldcoord;\n         continue;\n         }\n\n      if (!coordvals) { // do we have checking information about this cell?\n         coordvals = new SocialCalc.RecalcCheckInfo(); // no - make a place to hold it\n         checkinfo[coord] = coordvals;\n         }\n\n      if (cell.errors) { // delete errors from previous recalcs\n         delete cell.errors;\n         }\n\n      if (!cell.parseinfo) { // cache parsed formula\n         cell.parseinfo = scf.ParseFormulaIntoTokens(cell.formula);\n         }\n      parseinfo = cell.parseinfo;\n\n      for (i=coordvals.parsepos; i<parseinfo.length; i++) { // go through each token in formula\n\n         if (coordvals.inrange) { // processing a range of coords\n            if (coordvals.inrangestart) { // first time - fill in other values\n               if (coordvals.cr1.col > coordvals.cr2.col) { coordvals.c1 = coordvals.cr2.col; coordvals.c2 = coordvals.cr1.col; }\n               else { coordvals.c1 = coordvals.cr1.col; coordvals.c2 = coordvals.cr2.col; }\n               coordvals.c = coordvals.c1 - 1; // start one before\n\n               if (coordvals.cr1.row > coordvals.cr2.row) { coordvals.r1 = coordvals.cr2.row; coordvals.r2 = coordvals.cr1.row; }\n               else { coordvals.r1 = coordvals.cr1.row; coordvals.r2 = coordvals.cr2.row; }\n               coordvals.r = coordvals.r1; // start on this row\n               coordvals.inrangestart = false;\n               }\n            else { // not first time\n               }\n            coordvals.c += 1; // increment column\n            if (coordvals.c > coordvals.c2) { // finished the columns of this row\n               coordvals.r += 1; // increment row\n               if (coordvals.r > coordvals.r2) { // finished checking the entire range\n                  coordvals.inrange = false;\n                  continue;\n                  }\n               coordvals.c = coordvals.c1; // start at the beginning of next row\n               }\n            rangecoord = SocialCalc.crToCoord(coordvals.c, coordvals.r);\n\n            // now check that one\n\n            coordvals.parsepos = i; // remember our position\n            coordvals.oldcoord = oldcoord; // remember back up chain\n            oldcoord = coord; // come back to us\n            coord = rangecoord;\n            if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\n               cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\n               checkinfo[startcoord] = true; // this one should be calculated once at this point\n               if (!recalcdata.firstcalc) {\n                  recalcdata.firstcalc = startcoord;\n                  }\n               else {\n                  recalcdata.calclist[recalcdata.lastcalc] = startcoord;\n                  }\n               recalcdata.lastcalc = startcoord;\n               recalcdata.calclistlength++; // count number on list\n               sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\n               return cell.errors;\n               }\n            continue mainloop;\n            }\n\n         ttype = parseinfo[i].type; // get token details\n         ttext = parseinfo[i].text;\n         if (ttype == token_op) { // references with sheet specifier are not checked\n            if (ttext == \"!\") {\n               sheetref = true; // found a sheet reference\n               }\n            else if (ttext != \":\") { // for everything but a range, reset\n               sheetref = false;\n               }\n            }\n\n         if (ttype == token_name) { // look for named range\n            value = scf.LookupName(sheet, ttext);\n            if (value.type == \"range\") { // only need to recurse here for range, which may be just one cell\n               pos = value.value.indexOf(\"|\");\n               if (pos != -1) { // range - check each cell\n                  coordvals.cr1 = SocialCalc.coordToCr(value.value.substring(0,pos));\n                  pos2 = value.value.indexOf(\"|\", pos+1);\n                  coordvals.cr2 = SocialCalc.coordToCr(value.value.substring(pos+1,pos2));\n                  coordvals.inrange = true;\n                  coordvals.inrangestart = true;\n                  i = i-1; // back up so will start up again here\n                  continue;\n                  }\n               }\n            else if (value.type == \"coord\") { // just a coord\n               ttype = token_coord; // treat as a coord inline\n               ttext = value.value; // and then drop through to next test which should succeed\n               }\n            else { // not a defined name - probably a function\n               }\n            }\n\n         if (ttype == token_coord) { // token is a coord\n\n            if (i >= 2 // look for a range\n             && parseinfo[i-1].type == token_op && parseinfo[i-1].text == ':'\n             && parseinfo[i-2].type == token_coord\n             && !sheetref) { // Range -- check each cell\n               coordvals.cr1 = SocialCalc.coordToCr(parseinfo[i-2].text); // remember range extents\n               coordvals.cr2 = SocialCalc.coordToCr(ttext);\n               coordvals.inrange = true; // next time use the range looping code\n               coordvals.inrangestart = true;\n               i = i-1; // back up so will start up again here\n               continue;\n               }\n\n            else if (!sheetref) { // Single cell reference\n               if (ttext.indexOf(\"$\") != -1) ttext = ttext.replace(/\\$/g, \"\"); // remove any $'s\n               coordvals.parsepos = i+1; // remember our position - come back on next token\n               coordvals.oldcoord = oldcoord; // remember back up chain\n               oldcoord = coord; // come back to us\n               coord = ttext;\n               if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\n                  cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\n                  checkinfo[startcoord] = true; // this one should be calculated once at this point\n                  if (!recalcdata.firstcalc) { // add to calclist\n                     recalcdata.firstcalc = startcoord;\n                     }\n                  else {\n                     recalcdata.calclist[recalcdata.lastcalc] = startcoord;\n                     }\n                  recalcdata.lastcalc = startcoord;\n                  recalcdata.calclistlength++; // count number on list\n                  sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\n                  return cell.errors;\n                  }\n               continue mainloop;\n               }\n            }\n         }\n\n      sheetref = false; // make sure off when bump back up\n\n      checkinfo[coord] = true; // this one is finished\n      if (!recalcdata.firstcalc) { // add to calclist\n         recalcdata.firstcalc = coord;\n         }\n      else {\n         recalcdata.calclist[recalcdata.lastcalc] = coord;\n         }\n      recalcdata.lastcalc = coord;\n      recalcdata.calclistlength++; // count number on list\n\n      coord = oldcoord; // go back to the formula that referred to us and continue\n      oldcoord = checkinfo[coord] ? checkinfo[coord].oldcoord : null;\n\n      }\n\n   return \"\";\n\n   }\n\n\n// *************************************\n//\n// Parse class:\n//\n// Used by ExecuteSheetCommand to get elements of commands to execute.\n// The string it works with consists of one or more lines each\n// made up of one or more tokens separated by a delimiter.\n//\n// *************************************\n\n// Initialize: set string to work with\n\nSocialCalc.Parse = function(str) {\n\n   // properties:\n\n   this.str = str;\n   this.pos = 0;\n   this.delimiter = \" \";\n   this.lineEnd = str.indexOf(\"\\n\");\n   if (this.lineEnd < 0) {\n      this.lineEnd = str.length;\n      }\n\n   }\n\n// Return next token as a string\n\nSocialCalc.Parse.prototype.NextToken = function() {\n   if (this.pos < 0) return \"\";\n   var pos2 = this.str.indexOf(this.delimiter, this.pos);\n   var pos1 = this.pos;\n   if (pos2 > this.lineEnd) { // don't go past end of line\n      pos2 = this.lineEnd;\n      }\n   if (pos2 >= 0) {\n      this.pos = pos2 + 1;\n      return this.str.substring(pos1, pos2);\n      }\n   else {\n      this.pos = this.lineEnd;\n      return this.str.substring(pos1, this.lineEnd);\n      }\n   }\n\n// Return everything from current point until end of line\n\nSocialCalc.Parse.prototype.RestOfString = function() {\n   var oldpos = this.pos;\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\n   this.pos = this.lineEnd;\n   return this.str.substring(oldpos, this.lineEnd);\n   }\n\nSocialCalc.Parse.prototype.RestOfStringNoMove = function() {\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\n   return this.str.substring(this.pos, this.lineEnd);\n   }\n\n// Move current point to next line\n\nSocialCalc.Parse.prototype.NextLine = function() {\n   this.pos = this.lineEnd + 1;\n   this.lineEnd = this.str.indexOf(\"\\n\", this.pos);\n   if (this.lineEnd < 0) {\n      this.lineEnd = this.str.length;\n      }\n   }\n\n// Check to see if at end of string with no more to process\n\nSocialCalc.Parse.prototype.EOF = function() {\n   if (this.pos < 0 || this.pos >= this.str.length) return true;\n   return false;\n   }\n\n\n// *************************************\n//\n// UndoStack class:\n//\n// Implements the behavior needed for a normal application's undo/redo stack.\n// You add a new change sequence with PushChange.\n// The type argument is a string that can be used to lookup some general string \n// like \"typing\" or \"setting attribute\" for the menu prompts for undo/redo.\n//\n// You add the \"do\" steps with AddDo. The non-null, non-undefined arguments are\n// joined together with \" \" to make a command string to be saved.\n//\n// You add the undo steps as commands for the most recent change with AddUndo.\n// The non-null, non-undefined arguments are joined together with \" \" to make\n// a command string to be saved.\n//\n// The Undo and Redo functions move the Top Of Stack pointer through the changes stack\n// so you can undo and redo. Doing a new PushChange removes all undone items\n// after TOS.\n//\n// You can push more things than you can undo if you want.\n// There is a maximum to remember as the \"did\" stack for an audit trail (and as redo). This may be unlimited.\n// There is a separate maximum to remember that can be undone. This may be smaller than maxRedo.\n//\n// *************************************\n\nSocialCalc.UndoStack = function() {\n\n   // properties:\n\n   this.stack = []; // {command: [], type: type, undo: []} -- multiple dos and undos allowed\n   this.tos = -1; // top of stack position, used for undo/redo\n   this.maxRedo = 0; // Maximum size of redo stack (and audit trail which is this.stack[n].command) or zero if no limit\n   this.maxUndo = 50; // Maximum number of steps kept for undo (usually the memory intensive part) or zero if no limit\n\n   }\n\nSocialCalc.UndoStack.prototype.PushChange = function(type) { // adding a new thing to the stack\n   while (this.stack.length > 0 && this.stack.length-1 > this.tos) { // pop off things not redone\n      this.stack.pop();\n      }\n   this.stack.push({command: [], type: type, undo: []});\n   if (this.maxRedo && this.stack.length > this.maxRedo) { // limit number kept as audit trail\n      this.stack.shift(); // remove the extra one\n      }\n   if (this.maxUndo && this.stack.length > this.maxUndo) { // need to trim excess undo info\n      this.stack[this.stack.length - this.maxUndo - 1].undo = []; // only need to remove one\n      }\n   this.tos = this.stack.length - 1;\n   }\n\nSocialCalc.UndoStack.prototype.AddDo = function() {\n   if (!this.stack[this.stack.length-1]) { return; }\n   var args = [];\n   for (var i=0; i<arguments.length; i++) {\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\n      }\n   var cmd = args.join(\" \");\n   this.stack[this.stack.length-1].command.push(cmd);\n   }\n\nSocialCalc.UndoStack.prototype.AddUndo = function() {\n   if (!this.stack[this.stack.length-1]) { return; }\n   var args = [];\n   for (var i=0; i<arguments.length; i++) {\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\n      }\n   var cmd = args.join(\" \");\n   this.stack[this.stack.length-1].undo.push(cmd);\n   }\n\nSocialCalc.UndoStack.prototype.TOS = function() {\n   if (this.tos >= 0) return this.stack[this.tos];\n   else return null;\n   }\n\nSocialCalc.UndoStack.prototype.Undo = function() {\n   if (this.tos >= 0 && (!this.maxUndo || this.tos > this.stack.length - this.maxUndo - 1)) {\n      this.tos -= 1;\n      return true;\n      }\n   else {\n      return false;\n      }\n   }\n\nSocialCalc.UndoStack.prototype.Redo = function() {\n   if (this.tos < this.stack.length-1) {\n      this.tos += 1;\n      return true;\n      }\n   else {\n      return false;\n      }\n   }\n\n// *************************************\n//\n// Clipboard Object:\n//\n// This is a single object.\n// Stores the clipboard, which is shared by all active sheets.\n// Like the undo stack, it does not persist from one editing session to another.\n//\n// *************************************\n\nSocialCalc.Clipboard = {\n\n   // properties:\n\n   clipboard:  \"\" // empty or string in save format with \"copiedfrom:\" set to a range\n\n   }\n\n\n// *************************************\n//\n// RenderContext class:\n//\n// *************************************\n\nSocialCalc.RenderContext = function(sheetobj) {\n\n   var parts, num, s;\n   var attribs = sheetobj.attribs;\n   var scc = SocialCalc.Constants;\n\n   // properties:\n\n   this.sheetobj = sheetobj;\n   this.hideRowsCols = false; // Rendering with panes only works with \"false\"\n                              // !!!! Note: not implemented yet in rendering, just saved as an attribute\n   this.showGrid = false;\n   this.showRCHeaders = false;\n   this.rownamewidth = scc.defaultRowNameWidth;\n   this.pixelsPerRow = scc.defaultAssumedRowHeight;\n\n   this.cellskip = {}; // if present, coord of cell covering this cell\n   this.coordToCR = {}; // for cells starting spans, coordToCR[coord]={row:row, col:col}\n   this.colwidth = []; // precomputed column widths, taking into account defaults\n   this.rowheight = []; // precomputed row height, taking into account defaults\n   this.totalwidth = 0; // precomputed total table width\n   this.totalheight = 0; // precomputed total table height\n\n   this.rowpanes = []; // for each pane, {first: firstrow, last: lastrow}\n   this.colpanes = []; // for each pane, {first: firstrow, last: lastrow}\n   this.colunhideleft = [];\n   this.colunhideright = [];\n   this.rowunhidetop = [];\n   this.rowunhidebottom = [];\n   this.maxcol=0; // max col and row to display, adding long spans, etc.\n   this.maxrow=0;\n\n   this.highlights = {}; // for each cell with special display: coord:highlightType (see this.highlightTypes)\n   this.cursorsuffix = \"\"; // added to highlights[cr]==\"cursor\" to get type to lookup\n\n   this.highlightTypes = // attributes to change when highlit\n      {\n         cursor: {style: scc.defaultHighlightTypeCursorStyle, className: scc.defaultHighlightTypeCursorClass},\n         range: {style: scc.defaultHighlightTypeRangeStyle, className: scc.defaultHighlightTypeRangeClass},\n         cursorinsertup: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertup.gif);\", className: scc.defaultHighlightTypeCursorClass},\n         cursorinsertleft: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertleft.gif);\", className: scc.defaultHighlightTypeCursorClass},\n         range2: {style: \"color:#000;backgroundColor:#FFF;backgroundImage:url(\"+scc.defaultImagePrefix+\"range2.gif);\", className: \"\"}\n      }\n\n   this.cellIDprefix = scc.defaultCellIDPrefix; // if non-null, each cell will render with an ID\n\n   this.defaultlinkstyle = null; // default linkstyle object (allows you to pass values to link renderer)\n   this.defaultHTMLlinkstyle = {type: \"html\"}; // default linkstyle for standalone HTML\n\n   // constants:\n\n   this.defaultfontstyle = scc.defaultCellFontStyle;\n   this.defaultfontsize = scc.defaultCellFontSize;\n   this.defaultfontfamily = scc.defaultCellFontFamily;\n\n   this.defaultlayout = scc.defaultCellLayout;\n\n   this.defaultpanedividerwidth = scc.defaultPaneDividerWidth;\n   this.defaultpanedividerheight = scc.defaultPaneDividerHeight;\n\n   this.gridCSS = scc.defaultGridCSS;\n\n   this.commentClassName = scc.defaultCommentClass; // for cells with non-blank comments when this.showGrid is true\n   this.commentCSS = scc.defaultCommentStyle; // any combination of classnames and styles may be used\n   this.commentNoGridClassName = scc.defaultCommentNoGridClass; // for cells when this.showGrid is false\n   this.commentNoGridCSS = scc.defaultCommentNoGridStyle; // any combination of classnames and styles may be used\n\n   this.readonlyClassName = scc.defaultReadonlyClass; // for readonly cells with non-blank comments when this.showGrid is true\n   this.readonlyCSS = scc.defaultReadonlyStyle; // any combination of classnames and styles may be used\n   this.readonlyNoGridClassName = scc.defaultReadonlyNoGridClass; // for readonly cells when this.showGrid is false\n   this.readonlyNoGridCSS = scc.defaultReadonlyNoGridStyle; // any combination of classnames and styles may be used\n   this.readonlyComment = scc.defaultReadonlyComment;\n\n   this.classnames = // any combination of classnames and explicitStyles can be used\n      {\n         colname: scc.defaultColnameClass,\n         rowname: scc.defaultRownameClass,\n         selectedcolname: scc.defaultSelectedColnameClass,\n         selectedrowname: scc.defaultSelectedRownameClass,\n         upperleft: scc.defaultUpperLeftClass,\n         skippedcell: scc.defaultSkippedCellClass,\n         panedivider: scc.defaultPaneDividerClass,\n         unhideleft: scc.defaultUnhideLeftClass,\n         unhideright: scc.defaultUnhideRightClass,\n         unhidetop: scc.defaultUnhideTopClass,\n         unhidebottom: scc.defaultUnhideBottomClass,\n         colresizebar: scc.defaultColResizeBarClass,\n         rowresizebar: scc.defaultRowResizeBarClass\n      };\n\n   this.explicitStyles = // these may be used so you won't need a stylesheet with the classnames\n      {\n         colname: scc.defaultColnameStyle,\n         rowname: scc.defaultRownameStyle,\n         selectedcolname: scc.defaultSelectedColnameStyle,\n         selectedrowname: scc.defaultSelectedRownameStyle,\n         upperleft: scc.defaultUpperLeftStyle,\n         skippedcell: scc.defaultSkippedCellStyle,\n         panedivider: scc.defaultPaneDividerStyle,\n         unhideleft: scc.defaultUnhideLeftStyle,\n         unhideright: scc.defaultUnhideRightStyle,\n         unhidetop: scc.defaultUnhideTopStyle,\n         unhidebottom: scc.defaultUnhideBottomStyle\n      };\n\n   // processed info about cell skipping\n\n   this.cellskip = null;\n   this.needcellskip = true;\n\n   // precomputed values, filling in defaults indicated by \"*\"\n\n   this.fonts=[]; // for each fontnum, {style: fs, weight: fw, size: fs, family: ff}\n   this.layouts=[]; // for each layout, \"padding:Tpx Rpx Bpx Lpx;vertical-align:va;\"\n\n   this.needprecompute = true; // need to call PrecomputeSheetFontsAndLayouts\n\n   // if have a sheet object, initialize constants and precomputed values\n\n   if (attribs) {\n      this.rowpanes[0] = {first: 1, last: attribs.lastrow};\n      this.colpanes[0] = {first: 1, last: attribs.lastcol};\n      this.usermaxcol = attribs.usermaxcol;\n      this.usermaxrow = attribs.usermaxrow;\n\n      }\n   else throw scc.s_rcMissingSheet;\n\n   }\n\n// Methods:\n\nSocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts = function() {SocialCalc.PrecomputeSheetFontsAndLayouts(this);};\nSocialCalc.RenderContext.prototype.CalculateCellSkipData = function() {SocialCalc.CalculateCellSkipData(this);};\nSocialCalc.RenderContext.prototype.CalculateColWidthData = function() {SocialCalc.CalculateColWidthData(this);};\nSocialCalc.RenderContext.prototype.CalculateRowHeightData = function() {SocialCalc.CalculateRowHeightData(this);};\nSocialCalc.RenderContext.prototype.SetRowPaneFirstLast = function(panenum, first, last) {this.rowpanes[panenum]={first:first, last:last};};\nSocialCalc.RenderContext.prototype.SetColPaneFirstLast = function(panenum, first, last) {this.colpanes[panenum]={first:first, last:last};};\nSocialCalc.RenderContext.prototype.CoordInPane = function(coord, rowpane, colpane) {return SocialCalc.CoordInPane(this, coord, rowpane, colpane);};\nSocialCalc.RenderContext.prototype.CellInPane = function(row, col, rowpane, colpane) {return SocialCalc.CellInPane(this, row, col, rowpane, colpane);};\nSocialCalc.RenderContext.prototype.InitializeTable = function(tableobj) {SocialCalc.InitializeTable(this, tableobj);};\nSocialCalc.RenderContext.prototype.RenderSheet = function(oldtable, linkstyle) {return SocialCalc.RenderSheet(this, oldtable, linkstyle);};\nSocialCalc.RenderContext.prototype.RenderColGroup = function() {return SocialCalc.RenderColGroup(this);};\nSocialCalc.RenderContext.prototype.RenderColHeaders = function() {return SocialCalc.RenderColHeaders(this);};\nSocialCalc.RenderContext.prototype.RenderSizingRow = function() {return SocialCalc.RenderSizingRow(this);};\nSocialCalc.RenderContext.prototype.RenderRow = function(rownum, rowpane, linkstyle) {return SocialCalc.RenderRow(this, rownum, rowpane, linkstyle);};\nSocialCalc.RenderContext.prototype.RenderSpacingRow = function() {return SocialCalc.RenderSpacingRow(this);};\nSocialCalc.RenderContext.prototype.RenderCell = function(rownum, colnum, rowpane, colpane, noElement, linkstyle)\n      {return SocialCalc.RenderCell(this, rownum, colnum, rowpane, colpane, noElement, linkstyle);};\n\n// Functions:\n\nSocialCalc.PrecomputeSheetFontsAndLayouts = function(context) {\n\n   var defaultfont, parts, layoutre, dparts, sparts, num, s, i;\n   var sheetobj = context.sheetobj;\n   var attribs =  sheetobj.attribs;\n\n   if (attribs.defaultfont) {\n      defaultfont = sheetobj.fonts[attribs.defaultfont];\n      defaultfont = defaultfont.replace(/^\\*/,SocialCalc.Constants.defaultCellFontStyle);\n      defaultfont = defaultfont.replace(/(.+)\\*(.+)/,\"$1\"+SocialCalc.Constants.defaultCellFontSize+\"$2\");\n      defaultfont = defaultfont.replace(/\\*$/,SocialCalc.Constants.defaultCellFontFamily);\n      parts=defaultfont.match(/^(\\S+? \\S+?) (\\S+?) (\\S.*)$/);\n      context.defaultfontstyle = parts[1];\n      context.defaultfontsize = parts[2];\n      context.defaultfontfamily = parts[3];\n      }\n\n   for (num=1; num<sheetobj.fonts.length; num++) { // precompute fonts by filling in the *'s\n      s=sheetobj.fonts[num];\n      s=s.replace(/^\\*/,context.defaultfontstyle);\n      s=s.replace(/(.+)\\*(.+)/,\"$1\"+context.defaultfontsize+\"$2\");\n      s=s.replace(/\\*$/,context.defaultfontfamily);\n      parts=s.match(/^(\\S+?) (\\S+?) (\\S+?) (\\S.*)$/);\n      context.fonts[num] = {style: parts[1], weight: parts[2], size: parts[3], family: parts[4]};\n\n      }\n\n   layoutre = /^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/;\n   dparts = SocialCalc.Constants.defaultCellLayout.match(layoutre); // get built-in defaults\n\n   if (attribs.defaultlayout) {\n      sparts = sheetobj.layouts[attribs.defaultlayout].match(layoutre); // get sheet defaults, if set\n      }\n   else {\n      sparts = [\"\", \"*\", \"*\", \"*\", \"*\", \"*\"];\n      }\n\n   for (num=1; num<sheetobj.layouts.length; num++) { // precompute layouts by filling in the *'s\n      s=sheetobj.layouts[num];\n      parts = s.match(layoutre);\n      for (i=1; i<=5; i++) {\n         if (parts[i]==\"*\") {\n            parts[i] = (sparts[i] != \"*\" ? sparts[i] : dparts[i]); // if *, sheet default or built-in\n            }\n         }\n      context.layouts[num] = \"padding:\"+parts[1]+\" \"+parts[2]+\" \"+parts[3]+\" \"+parts[4]+\n         \";vertical-align:\"+parts[5]+\";\";\n      }\n\n   context.needprecompute = false;\n\n   }\n\nSocialCalc.CalculateCellSkipData = function(context) {\n\n   var row, col, coord, cell, contextcell, colspan, rowspan, skiprow, skipcol, skipcoord;\n\n   var sheetobj=context.sheetobj;\n   var sheetrowattribs=sheetobj.rowattribs;\n   var sheetcolattribs=sheetobj.colattribs;\n   context.maxrow=0;\n   context.maxcol=0;\n   context.cellskip = {}; // reset\n\n   // Calculate cellskip data\n\n   for (row=1; row<=sheetobj.attribs.lastrow; row++) {\n      for (col=1; col<=sheetobj.attribs.lastcol; col++) { // look for spans and set cellskip for skipped cells\n         coord=SocialCalc.crToCoord(col, row);\n         cell=sheetobj.cells[coord];\n         // don't look at undefined cells (they have no spans) or skipped cells\n         if (cell===undefined || context.cellskip[coord]) continue;\n         colspan=cell.colspan || 1;\n         rowspan=cell.rowspan || 1;\n         if (colspan>1 || rowspan>1) {\n            for (skiprow=row; skiprow<row+rowspan; skiprow++) {\n               for (skipcol=col; skipcol<col+colspan; skipcol++) { // do the setting on individual cells\n                  skipcoord=SocialCalc.crToCoord(skipcol,skiprow);\n                  if (skipcoord==coord) { // for coord, remember row and col\n                     context.coordToCR[coord]={row: row, col: col};\n                     }\n                  else { // for other cells, flag with coord of here\n                     context.cellskip[skipcoord]=coord;\n                     }\n                  if (skiprow>context.maxrow) maxrow=skiprow;\n                  if (skipcol>context.maxcol) maxcol=skipcol;\n                  }\n               }\n            }\n         }\n      }\n\n   context.needcellskip = false;\n\n   }\n\nSocialCalc.CalculateColWidthData = function(context) {\n\n   var colnum, colname, colwidth, totalwidth;\n\n   var sheetobj=context.sheetobj;\n   var sheetcolattribs=sheetobj.colattribs;\n\n   // Calculate column width data\n\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         colname=SocialCalc.rcColname(colnum);\n         if (sheetobj.colattribs.hide[colname] == \"yes\") {\n            context.colwidth[colnum] = 0;\n            }\n         else {\n            colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\n            if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\n            context.colwidth[colnum]=colwidth+\"\";\n            totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\n            }\n         }\n      }\n   context.totalwidth = totalwidth;\n\n   }\n\nSocialCalc.CalculateRowHeightData = function(context) {\n  var rownum, rowheight, totalheight;\n  var sheetobj = context.sheetobj;\n\n  // Calculate row height data\n  totalheight = context.showRCHeaders ? context.pixelsPerRow : 0;\n  for (rowpane = 0; rowpane < context.rowpanes.length; rowpane++) {\n    for (rownum = context.rowpanes[rowpane].first; rownum <= context.rowpanes[rowpane].last; rownum++) {\n      if (sheetobj.rowattribs.hide[rownum] === \"yes\") {\n        context.rowheight[rownum] = 0;\n      } else {\n        rowheight = sheetobj.rowattribs.height[rownum] || sheetobj.attribs.defaultrowheight || SocialCalc.Constants.defaultAssumedRowHeight;\n        if (rowheight === \"blank\" || rowheight === \"auto\") rowheight = \"\";\n        context.rowheight[rownum] = rowheight+\"\";\n        totalheight += (rowheight && ((rowheight - 0) > 0)) ? (rowheight-0) : 10;\n      }\n    }\n  }\n  context.totalheight = totalheight;\n\n}\n\nSocialCalc.InitializeTable = function(context, tableobj) {\n\n/*\n\nUses border-collapse so corners don't have holes\nNote: IE and Firefox handle <col> differently (IE adds borders and padding)\nunder border-collapse and Safari has problems with <col> and wide text\nTablelayout \"fixed\" also leads to problems\n\n*/\n\n/*\n\n*** Discussion ***\n\nThe rendering assumes fixed column widths, even though SocialCalc allows \"auto\".\nThere may be issues with \"auto\" and it is hard to make it work cross-browser\nwith border-collapse, etc.\n\nThis and the RenderSheet routine are where in the code the specifics of\ntable attributes and column size definitions are set. As the browsers settle down\nand when we decide if we don't need auto width, we may want to revisit the way the\ncode does this (e.g., use table-layout:fixed).\n\n*/\n   tableobj.style.borderCollapse=\"collapse\";\n   tableobj.cellSpacing=\"0\";\n   tableobj.cellPadding=\"0\";\n\n   tableobj.style.width=context.totalwidth+\"px\";\n\n   }\n\n//\n// tableobj = SocialCalc.RenderSheet(context, oldtable, linkstyle)\n//\n// Renders a render context returning a DOM table object.\n// If there is an oldtable object, it replaces it in the parent node.\n// If oldtable is null, it just returns the new one.\n// The linkstyle is \"\" or null for editing rendering\n// and optionally an object passed on to formatting code.\n//\n\nSocialCalc.RenderSheet = function(context, oldtable, linkstyle) {\n\n   var newrow, rowpane;\n   var tableobj, colgroupobj, tbodyobj, parentnode;\n\n   // do precompute stuff if necessary\n\n   if (context.sheetobj.changedrendervalues) {\n      context.needcellskip = true;\n      context.needprecompute = true;\n      context.sheetobj.changedrendervalues = false;\n      }\n   if (context.needcellskip) {\n      context.CalculateCellSkipData();\n      }\n   if (context.needprecompute) {\n      context.PrecomputeSheetFontsAndLayouts();\n      }\n\n   context.CalculateColWidthData(); // always make sure col width values are up to date\n   context.CalculateRowHeightData();\n\n   // make the table element and fill it in\n\n   tableobj=document.createElement(\"table\");\n   context.InitializeTable(tableobj);\n\n   colgroupobj=context.RenderColGroup();\n   tableobj.appendChild(colgroupobj);\n\n   tbodyobj=document.createElement(\"tbody\");\n\n   tbodyobj.appendChild(context.RenderSizingRow());\n\n   if (context.showRCHeaders) {\n      newrow=context.RenderColHeaders();\n      if (newrow) tbodyobj.appendChild(newrow);\n      }\n\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\n      for (rownum=context.rowpanes[rowpane].first;rownum<=context.rowpanes[rowpane].last;rownum++) {\n         newrow=context.RenderRow(rownum, rowpane, linkstyle);\n         tbodyobj.appendChild(newrow);\n         }\n      if (rowpane<context.rowpanes.length-1) {\n         newrow=context.RenderSpacingRow();\n         tbodyobj.appendChild(newrow);\n         }\n      }\n\n   tableobj.appendChild(tbodyobj);\n\n   if (oldtable) {\n      parentnode = oldtable.parentNode;\n      if (parentnode) parentnode.replaceChild(tableobj, oldtable);\n      }\n\n   return tableobj;\n\n   }\n\nSocialCalc.RenderRow = function(context, rownum, rowpane, linkstyle) {\n\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n   var colnum, newcol, colpane, newdiv;\n\n   if (context.showRCHeaders) {\n      newcol=document.createElement(\"td\");\n      if (context.classnames) newcol.className=context.classnames.rowname;\n      if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.rowname;\n      newcol.width=context.rownamewidth;\n      newcol.height = context.rowheight[rownum];\n      newcol.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\n                                        // considered top of row (and can't get <row> position in Safari)\n      newcol.innerHTML=rownum+\"\";\n\n      // If neighbour is hidden, show an icon in this column.\n      if (rownum < context.rowpanes[context.rowpanes.length-1].last && sheetobj.rowattribs.hide[rownum+1] == \"yes\") {\n         // HACK: Because we likely want the icon floating at the bottom of the cell, we create an enclosing div \n         // with position relative and the icon's div will be placed inside it with position: absolute and bottom: 0.\n         var container = document.createElement(\"div\");\n         container.style.position = \"relative\";\n         var unhide = document.createElement(\"div\");\n         if (context.classnames) unhide.className=context.classnames.unhidetop;\n         if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhidetop;\n         var fixPosition = ((context.rowheight[rownum] - 0) - SocialCalc.Constants.defaultAssumedRowHeight);\n         fixPosition = (fixPosition === 0) ? 4 : fixPosition;\n         unhide.style.bottom = '-' + fixPosition + 'px';\n         context.rowunhidetop[rownum] = unhide;\n         container.appendChild(unhide);\n         newcol.appendChild(container);\n         }\n      if (rownum > 1 && sheetobj.rowattribs.hide[rownum-1] == \"yes\") {\n         var unhide = document.createElement(\"div\");\n         if (context.classnames) unhide.className=context.classnames.unhidebottom;\n         if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhidebottom;\n         context.rowunhidebottom[rownum] = unhide;\n         newcol.appendChild(unhide);\n         }\n\n      // add resize bar\n      var resizeBar = document.createElement('div');\n      resizeBar.className = context.classnames.rowresizebar;\n      newcol.appendChild(resizeBar);\n\n      result.appendChild(newcol);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=context.RenderCell(rownum, colnum, rowpane, colpane, null, linkstyle);\n         if (newcol) result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"td\");\n         newcol.width=context.defaultpanedividerwidth;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         newdiv=document.createElement(\"div\"); // for Firefox to avoid squishing\n         newdiv.style.width=context.defaultpanedividerwidth+\"px\";\n         newdiv.style.overflow=\"hidden\";\n         newcol.appendChild(newdiv);\n         result.appendChild(newcol);\n         }\n      }\n\n   // If hidden row, display: none.\n   if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\n      result.style.cssText += \";display:none\";\n      }\n\n   return result;\n   }\n\nSocialCalc.RenderSpacingRow = function(context) {\n\n   var colnum, newcol, colpane, w;\n\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n\n   if (context.showRCHeaders) {\n      newcol=document.createElement(\"td\");\n      newcol.width=context.rownamewidth;\n      newcol.height=context.defaultpanedividerheight;\n      if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n      if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n      result.appendChild(newcol);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=document.createElement(\"td\");\n         w = context.colwidth[colnum];\n         if (w) newcol.width=w;\n         newcol.height=context.defaultpanedividerheight;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         if (newcol) result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"td\");\n         newcol.width=context.defaultpanedividerwidth;\n         newcol.height=context.defaultpanedividerheight;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         result.appendChild(newcol);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderColHeaders = function(context) {\n\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n   var colnum, newcol;\n\n   if (!context.showRCHeaders) return null;\n\n   newcol=document.createElement(\"td\");\n   if (context.classnames) newcol.className=context.classnames.upperleft;\n   if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.upperleft;\n   newcol.width=context.rownamewidth;\n   result.appendChild(newcol);\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=document.createElement(\"td\");\n         if (context.classnames) newcol.className=context.classnames.colname;\n         if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.colname;\n\n         // If hidden column, display: none.\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\n            newcol.style.cssText += \";display:none\";\n            }\n\n         newcol.innerHTML=SocialCalc.rcColname(colnum);\n\n         // If neighbour is hidden, show an icon in this column.\n         if (colnum < context.colpanes[context.colpanes.length-1].last && sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+1)] == \"yes\") {\n            var unhide = document.createElement(\"div\");\n            if (context.classnames) unhide.className=context.classnames.unhideleft;\n            if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhideleft;\n            context.colunhideleft[colnum] = unhide;\n            newcol.appendChild(unhide);\n         }\n         if (colnum > 1 && sheetobj.colattribs.hide[SocialCalc.rcColname(colnum-1)] == \"yes\") {\n            unhide = document.createElement(\"div\");\n            if (context.classnames) unhide.className=context.classnames.unhideright;\n            if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhideright;\n            context.colunhideright[colnum] = unhide;\n            newcol.appendChild(unhide);\n         }\n\n         // add resize bar\n         var resizeBar = document.createElement('span');\n         resizeBar.style.height = SocialCalc.Constants.defaultAssumedRowHeight + 'px';\n         resizeBar.className = context.classnames.colresizebar;\n         newcol.appendChild(resizeBar);\n\n         result.appendChild(newcol);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"td\");\n         newcol.width=context.defaultpanedividerwidth;\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\n         result.appendChild(newcol);\n         }\n      }\n   // eddy {\n//   if(context.formColNames != null) {\n//     for(var nodeIndex = 0;  nodeIndex < result.childNodes.length;  nodeIndex++ ) {\n//       var currentCol = result.childNodes[nodeIndex];\n//       if(context.formColNames[currentCol.innerText] != null) currentCol.innerText = context.formColNames[currentCol.innerText];\n//     }\n//   }\n   // }\n   return result;\n   }\n\nSocialCalc.RenderColGroup = function(context) {\n\n   var colpane, colnum, newcol, t;\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"colgroup\");\n\n   if (context.showRCHeaders) {\n      newcol=document.createElement(\"col\");\n      newcol.width=context.rownamewidth;\n      result.appendChild(newcol);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcol=document.createElement(\"col\");\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\n            newcol.width=\"1\";\n            }\n         else {\n            t = context.colwidth[colnum];\n            if (t) newcol.width=t;\n            result.appendChild(newcol);\n            }\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcol=document.createElement(\"col\");\n         newcol.width=context.defaultpanedividerwidth;\n         result.appendChild(newcol);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderSizingRow = function(context) {\n\n   var colpane, colnum, newcell, t;\n   var sheetobj=context.sheetobj;\n\n   var result=document.createElement(\"tr\");\n\n   if (context.showRCHeaders) {\n      newcell=document.createElement(\"td\");\n      newcell.style.width=context.rownamewidth+\"px\";\n      newcell.height=\"1\";\n      result.appendChild(newcell);\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         newcell=document.createElement(\"td\");\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\n            newcell.width=\"1\";\n            }\n         else {\n            t = context.colwidth[colnum];\n            if (t) newcell.width=t;\n            }\n         newcell.height=\"1\";\n         result.appendChild(newcell);\n         }\n      if (colpane<context.colpanes.length-1) {\n         newcell=document.createElement(\"td\");\n         newcell.width=context.defaultpanedividerwidth;\n         newcell.height=\"1\";\n         result.appendChild(newcell);\n         }\n      }\n   return result;\n   }\n\nSocialCalc.RenderCell = function(context, rownum, colnum, rowpane, colpane, noElement, linkstyle) {\n\n   var sheetobj=context.sheetobj;\n\n   var num, t, result, span, stylename, cell, endcell, sheetattribs, scdefaults;\n   var stylestr=\"\";\n\n   rownum = rownum-0; // make sure a number\n   colnum = colnum-0;\n\n   var coord=SocialCalc.crToCoord(colnum, rownum);\n\n   if (context.cellskip[coord]) { // skip if within a span\n      if (context.CoordInPane(context.cellskip[coord], rowpane, colpane)) {\n         return null; // span starts in this pane -- so just skip\n         }\n      result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\"); // span start is scrolled away, so make a special cell\n      if (context.classnames.skippedcell) result.className=context.classnames.skippedcell;\n      if (context.explicitStyles.skippedcell) result.style.cssText=context.explicitStyles.skippedcell;\n      result.innerHTML=\"&nbsp;\"; // put something there so height is OK\n      // !!! Really need to add borders in case there isn't anything else shown in the pane to get height\n      return result;\n      }\n\n   result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\");\n\n   if (context.cellIDprefix) {\n      result.id = context.cellIDprefix+coord;\n      }\n\n   cell=sheetobj.cells[coord];\n\n   if (!cell) {\n      cell=new SocialCalc.Cell(coord);\n      }\n\n   sheetattribs=sheetobj.attribs;\n   scc=SocialCalc.Constants;\n\n   if (cell.colspan>1) {\n      span=1;\n      for (num=1; num<cell.colspan; num++) {\n          if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+num)]!=\"yes\" &&\n                context.CellInPane(rownum, colnum+num, rowpane, colpane)) {\n             span++;\n             }\n          }\n      result.colSpan=span;\n      }\n\n   if (cell.rowspan>1) {\n      span=1;\n      for (num=1; num<cell.rowspan; num++) {\n          if (sheetobj.rowattribs.hide[(rownum+num)+\"\"]!=\"yes\" &&\n                context.CellInPane(rownum+num, colnum, rowpane, colpane))\n             span++;\n         }\n      result.rowSpan=span;\n      }\n\n   if (cell.displaystring==undefined) { // cache the display value\n      cell.displaystring = SocialCalc.FormatValueForDisplay(sheetobj, cell.datavalue, coord, (linkstyle || context.defaultlinkstyle));\n      }\n\t\n   result.innerHTML = cell.displaystring;\n\t  \n   num=cell.layout || sheetattribs.defaultlayout;\n   if (num && typeof(context.layouts[num]) !== \"undefined\") {\n      stylestr+=context.layouts[num]; // use precomputed layout with \"*\"'s filled in\n      }\n   else {\n      stylestr+=scc.defaultCellLayout;\n      }\n\n   num=cell.font || sheetattribs.defaultfont;\n   if (num && typeof(context.fonts[num]) !== \"undefined\") { // get expanded font strings in context\n      t = context.fonts[num]; // do each - plain \"font:\" style sets all sorts of other values, too (Safari font-stretch problem on cssText)\n      stylestr+=\"font-style:\"+t.style+\";font-weight:\"+t.weight+\";font-size:\"+t.size+\";font-family:\"+t.family+\";\";\n      }\n   else {\n      if (scc.defaultCellFontSize) {\n         stylestr+=\"font-size:\"+scc.defaultCellFontSize+\";\";\n         }\n      if (scc.defaultCellFontFamily) {\n         stylestr+=\"font-family:\"+scc.defaultCellFontFamily+\";\";\n         }\n      }\n\n   num=cell.color || sheetattribs.defaultcolor;\n   if (num && typeof(sheetobj.colors[num]) !== \"undefined\") stylestr+=\"color:\"+sheetobj.colors[num]+\";\";\n\n   num=cell.bgcolor || sheetattribs.defaultbgcolor;\n   if (num && typeof(sheetobj.colors[num]) !== \"undefined\") stylestr+=\"background-color:\"+sheetobj.colors[num]+\";\";\n\n   num=cell.cellformat;\n   if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") {\n      stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\n      }\n   else {\n      t=cell.valuetype.charAt(0);\n      if (t==\"t\") {\n         num=sheetattribs.defaulttextformat;\n         if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\n         }\n      else if (t==\"n\") {\n         num=sheetattribs.defaultnontextformat;\n         if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") {\n            stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\n            }\n         else {\n            stylestr+=\"text-align:right;\";\n            }\n         }\n      else stylestr+=\"text-align:left;\";\n      }\n\n   // get the end cell for border styling\n   if (cell.colspan > 1 || cell.rowspan > 1) {\n      endcell = sheetobj.cells[SocialCalc.crToCoord(colnum+(cell.colspan || 1)-1, rownum+(cell.rowspan || 1)-1)];\n      }\n\n   num=cell.bt;\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-top:\"+sheetobj.borderstyles[num]+\";\";\n\n   num=typeof(endcell) != \"undefined\" ? endcell.br : cell.br;\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-right:\"+sheetobj.borderstyles[num]+\";\";\n   else if (context.showGrid) {\n      if (context.CellInPane(rownum, colnum+(cell.colspan || 1), rowpane, colpane))\n         t=SocialCalc.crToCoord(colnum+(cell.colspan || 1), rownum);\n      else t=\"nomatch\";\n      if (context.cellskip[t]) t=context.cellskip[t];\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bl)\n         stylestr+=\"border-right:\"+context.gridCSS;\n      }\n\n   num=typeof(endcell) != \"undefined\" ? endcell.bb : cell.bb;\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-bottom:\"+sheetobj.borderstyles[num]+\";\";\n   else if (context.showGrid) {\n      if (context.CellInPane(rownum+(cell.rowspan || 1), colnum, rowpane, colpane))\n         t=SocialCalc.crToCoord(colnum, rownum+(cell.rowspan || 1));\n      else t=\"nomatch\";\n      if (context.cellskip[t]) t=context.cellskip[t];\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bt)\n         stylestr+=\"border-bottom:\"+context.gridCSS;\n      }\n\n   num=cell.bl;\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-left:\"+sheetobj.borderstyles[num]+\";\";\n\n   if (cell.comment) {\n      result.title = cell.comment;\n      if (context.showGrid) {\n         if (context.commentClassName) {\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentClassName;\n            }\n         stylestr+=context.commentCSS;\n         }\n      else {\n         if (context.commentNoGridClassName) {\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentNoGridClassName;\n            }\n         stylestr+=context.commentNoGridCSS;\n         }\n      }\n\n   if (cell.readonly) {\n      if (!cell.comment) {\n         result.title = context.readonlyComment;\n         }\n      if (context.showGrid) {\n         if (context.readonlyClassName) {\n            result.className = (result.className ? result.className+\" \" : \"\") + context.readonlyClassName;\n            }\n         stylestr+=context.readonlyCSS;\n         }\n      else {\n         if (context.readonlyNoGridClassName) {\n            result.className = (result.className ? result.className+\" \" : \"\") + context.readonlyNoGridClassName;\n            }\n         stylestr+=context.readonlyNoGridCSS;\n         }\n      }\n\n   result.style.cssText=stylestr;\n\n   //!!!!!!!!!\n   // NOTE: csss is not supported yet.\n   // csss needs to be parsed into pieces to override just the attributes specified, not all with assignment to cssText.\n   if (cell.cssc !== undefined) {\n      noElement ? (result.className = (result.className ? result.className + ' ' : '') + cell.cssc) : result.classList.add(cell.cssc);\n   }\n\n   t = context.highlights[coord];\n   if (t) { // this is a highlit cell: Override style appropriately\n      if (t==\"cursor\") t += context.cursorsuffix; // cursor can take alternative forms\n      if (context.highlightTypes[t].className) {\n         result.className = (result.className ? result.className+\" \" : \"\") + context.highlightTypes[t].className;\n         }\n      SocialCalc.setStyles(result, context.highlightTypes[t].style);\n      }\n\n   // If hidden column, display: none.\n   if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\n      result.style.cssText+=\";display:none\";\n      }\n\n   // If hidden row, display: none.\n   if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\n      result.style.cssText+=\";display:none\";\n      }\n\n   return result;\n   }\n\nSocialCalc.CoordInPane = function(context, coord, rowpane, colpane) {\n   var coordToCR = context.coordToCR[coord];\n   if (!coordToCR || !coordToCR.row || !coordToCR.col) throw \"Bad coordToCR for \"+coord;\n   return context.CellInPane(coordToCR.row, coordToCR.col, rowpane, colpane);\n   }\n\n\nSocialCalc.CellInPane = function(context, row, col, rowpane, colpane) {\n   var panerowlimits = context.rowpanes[rowpane];\n   var panecollimits = context.colpanes[colpane];\n   if (!panerowlimits || !panecollimits) throw \"CellInPane called with unknown panes \"+rowpane+\"/\"+colpane;\n   if (row < panerowlimits.first || row > panerowlimits.last) return false;\n   if (col < panecollimits.first || col > panecollimits.last) return false;\n   return true;\n   }\n\nSocialCalc.CreatePseudoElement = function() {\n   return {style:{cssText:\"\"}, innerHTML: \"\", className: \"\"};\n   }\n\n\n// *************************************\n//\n// Misc. functions:\n//\n// *************************************\n\nSocialCalc.rcColname = function(c) {\n   if (c > 702) c = 702; // maximum number of columns - ZZ\n   if (c < 1) c = 1;\n   var collow = (c - 1) % 26 + 65;\n   var colhigh = Math.floor((c - 1) / 26);\n   if (colhigh)\n      return String.fromCharCode(colhigh + 64) + String.fromCharCode(collow);\n   else\n      return String.fromCharCode(collow);\n   }\n\nSocialCalc.letters = [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\n                      \"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];\n\nSocialCalc.crToCoord = function(c, r) {\n   var result;\n   if (c < 1) c = 1;\n   if (c > 702) c = 702; // maximum number of columns - ZZ\n   if (r < 1) r = 1;\n   var collow = (c - 1) % 26;\n   var colhigh = Math.floor((c - 1) / 26);\n   if (colhigh)\n      result = SocialCalc.letters[colhigh-1] + SocialCalc.letters[collow] + r;\n   else\n      result = SocialCalc.letters[collow] + r;\n   return result;\n   }\n\nSocialCalc.coordToCol = {}; // too expensive to set in crToCoord since that is called so many times\nSocialCalc.coordToRow = {};\n\nSocialCalc.coordToCr = function(cr) {\n   var c, i, ch;\n   var r = SocialCalc.coordToRow[cr];\n   if (r) return {row: r, col: SocialCalc.coordToCol[cr]};\n   c=0;r=0;\n   for (i=0; i<cr.length; i++) { // this was faster than using regexes; assumes well-formed\n      ch = cr.charCodeAt(i);\n      if (ch==36) ; // skip $'s\n      else if (ch<=57) r = 10*r + ch-48;\n      else if (ch>=97) c = 26*c + ch-96;\n      else if (ch>=65) c = 26*c + ch-64;\n      }\n   SocialCalc.coordToCol[cr] = c;\n   SocialCalc.coordToRow[cr] = r;\n   return {row: r, col: c};\n\n   }\n\nSocialCalc.ParseRange = function(range) {\n   var pos, cr, cr1, cr2;\n   if (!range) range = \"A1:A1\"; // error return, hopefully benign\n   range = range.toUpperCase();\n   pos = range.indexOf(\":\");\n   if (pos>=0) {\n      cr = range.substring(0,pos);\n      cr1 = SocialCalc.coordToCr(cr);\n      cr1.coord = cr;\n      cr = range.substring(pos+1);\n      cr2 = SocialCalc.coordToCr(cr);\n      cr2.coord = cr;\n      }\n   else {\n      cr1 = SocialCalc.coordToCr(range);\n      cr1.coord = range;\n      cr2 = SocialCalc.coordToCr(range);\n      cr2.coord = range;\n      }\n   return {cr1: cr1, cr2: cr2};\n   }\n\nSocialCalc.decodeFromSave = function(s) {\n   if (typeof s != \"string\") return s;\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\n   var r=s.replace(/\\\\c/g,\":\");\n   r=r.replace(/\\\\n/g,\"\\n\");\n   return r.replace(/\\\\b/g,\"\\\\\");\n   }\n\nSocialCalc.decodeFromAjax = function(s) {\n   if (typeof s != \"string\") return s;\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\n   var r=s.replace(/\\\\c/g,\":\");\n   r=r.replace(/\\\\n/g,\"\\n\");\n   r=r.replace(/\\\\e/g,\"]]\");\n   return r.replace(/\\\\b/g,\"\\\\\");\n   }\n\nSocialCalc.encodeForSave = function(s) {\n   if (typeof s != \"string\") return s;\n   if (s.indexOf(\"\\\\\")!=-1) // for performace reasons: replace nothing takes up time\n      s=s.replace(/\\\\/g,\"\\\\b\");\n   if (s.indexOf(\":\")!=-1)\n      s=s.replace(/:/g,\"\\\\c\");\n   if (s.indexOf(\"\\n\")!=-1)\n      s=s.replace(/\\n/g,\"\\\\n\");\n   return s;\n   }\n\n//\n// Returns estring where &, <, >, \" are HTML escaped\n// \nSocialCalc.special_chars = function(string) {\n\n   if (/[&<>\"]/.test(string)) { // only do \"slow\" replaces if something to replace\n      string = string.replace(/&/g, \"&amp;\");\n      string = string.replace(/</g, \"&lt;\");\n      string = string.replace(/>/g, \"&gt;\");\n      string = string.replace(/\"/g, \"&quot;\");\n      }\n   return string;\n\n   }\n\nSocialCalc.Lookup = function(value, list) {\n\n   for (i=0; i<list.length; i++) {\n      if (list[i] > value) {\n         if (i>0) return i-1;\n         else return null;\n         }\n      }\n   return list.length-1; // if all smaller, matches last\n\n   }\n\n//\n// setStyles(element, cssText)\n//\n// Takes a pseudo style string (e.g., text-align must be textAlign) and sets\n// the element's style value for each style name listed (leaving others unchanged).\n// OK to call with null cssText.\n//\n\nSocialCalc.setStyles = function (element, cssText) {\n\n   var parts, part, pos, name, value;\n\n   if (!cssText) return;\n\n   parts = cssText.split(\";\");\n   for (part=0; part<parts.length; part++) {\n      pos = parts[part].indexOf(\":\"); // find first colon (could be one in url)\n      if (pos != -1) {\n         name = parts[part].substring(0, pos);\n         value = parts[part].substring(pos+1);\n         if (name && value) { // if non-null name and value, set style\n            element.style[name] = value;\n            }\n         }\n//      namevalue = parts[part].split(\":\");\n//      if (namevalue[0]) element.style[namevalue[0]] = namevalue[1];\n      }\n\n   }\n\n//\n// GetViewportInfo() - returns object with viewport width and height, and scroll offsets\n//\n// Flanagan, JavaScript, 5th Edition, page 276\n//\n\nSocialCalc.GetViewportInfo = function () {\n\n   var result = {};\n\n   if (window.innerWidth) { // all but IE\n      result.width = window.innerWidth;\n      result.height = window.innerHeight;\n      result.horizontalScroll = window.pageXOffset;\n      result.verticalScroll = window.pageYOffset;\n      }\n   else {\n      if (document.documentElement && document.documentElement.clientWidth) {\n         result.width = document.documentElement.clientWidth;\n         result.height = document.documentElement.clientHeight;\n         result.horizontalScroll = document.documentElement.scrollLeft;\n         result.verticalScroll = document.documentElement.scrollTop;\n         }\n      else if (document.body.clientWidth) {\n         result.width = document.body.clientWidth;\n         result.height = document.body.clientHeight;\n         result.horizontalScroll = document.body.scrollLeft;\n         result.verticalScroll = document.body.scrollTop;\n         }\n      }\n\n   return result;\n   }\n\n//\n// GetElementPosition(element) - returns object with left and top position of the element in the document\n//\n// Goodman's JavaScript & DHTML Cookbook, 2nd Edition, page 415\n//\n\nSocialCalc.GetElementPosition = function (element) {\n\n   var offsetLeft = 0;\n   var offsetTop = 0;\n   while (element) {\n      if (SocialCalc.GetComputedStyle(element,'position')=='relative') break;\n      offsetLeft+=element.offsetLeft;\n      offsetTop+=element.offsetTop;\n      element=element.offsetParent;\n      }\n   return {left:offsetLeft, top:offsetTop};\n\n   }\n\n//\n// GetElementPositionWithScroll(element) - returns object with left and top position of the element in the document\n//\n\nSocialCalc.GetElementPositionWithScroll = function (element) {\n  \n   var rect = element.getBoundingClientRect();\n   return {\n      left:rect.left,\n      right:rect.right,\n      top:rect.top,\n      bottom:rect.bottom,\n      width:rect.width?rect.width:rect.right-rect.left,\n      height:rect.height?rect.height:rect.bottom-rect.top\n      };\n\n   }\n\n//\n// GetElementFixedParent(element) - checks whether element has a parent with position:fixed\n//\n\nSocialCalc.GetElementFixedParent = function(element) {\n\n   while (element) {\n      if (element.tagName==\"HTML\") break;\n      if (SocialCalc.GetComputedStyle(element,'position')=='fixed') return element;\n      element=element.parentNode;\n      }\n      return false;\n\n   }\n\n//\n// GetComputedStyle(element, style) - returns computed style value\n//\n// http://blog.stchur.com/2006/06/21/css-computed-style/\n//\n\nSocialCalc.GetComputedStyle = function (element, style) {\n\n   var computedStyle;\n   if (typeof element.currentStyle != 'undefined') { // IE\n      computedStyle = element.currentStyle;\n      }\n   else {\n      computedStyle = document.defaultView.getComputedStyle(element, null);\n      }\n   return computedStyle[style];\n\n   }\n\n//\n// LookupElement(element, array) - returns array element which is an object with \"element\" of element\n//\n\nSocialCalc.LookupElement = function (element, array) {\n\n   var i;\n   for (i=0; i<array.length; i++) {\n      if (array[i].element == element) return array[i];\n      }\n   return null;\n\n   }\n\n//\n// AssignID(obj, element, id) - Optionally assigns an ID with a prefix to the element\n//\n\nSocialCalc.AssignID = function (obj, element, id) {\n\n   if (obj.idPrefix) { // Object must have a non-empty idPrefix attribute\n      element.id = obj.idPrefix + id;\n      }\n\n   }\n\n//\n// SocialCalc.GetCellContents(sheetobj, coord)\n//\n// Returns the contents (value, formula, constant, etc.) of a cell\n// with appropriate prefix (\"'\", \"=\", etc.)\n//\n\nSocialCalc.GetCellContents = function(sheetobj, coord) {\n\n   var result = \"\";\n   var cellobj = sheetobj.cells[coord];\n   if (cellobj) {\n      switch (cellobj.datatype) {\n         case \"v\":\n            result = cellobj.datavalue+\"\";\n            break;\n         case \"t\":\n            result = \"'\"+cellobj.datavalue;\n            break;\n         case \"f\":\n            result = \"=\"+cellobj.formula;\n            break;\n         case \"c\":\n            result = cellobj.formula;\n            break;\n         default:\n            break;\n         }\n      }\n\n   return result;\n\n   }\n\n//\n// Routines translated from the SocialCalc 1.1.0 Perl code:\n//\n// (Makes use of the FormatNumber JavaScript code translated from the Perl.)\n//\n\n//\n// displayvalue = FormatValueForDisplay(sheetobj, value, cr, linkstyle)\n//\n// Returns a string, in HTML, for the contents of a cell.\n//\n// The value is a either numeric or text, the cr is the coord of the cell\n// (its cell properties are used to determine formatting), and linkstyle\n// is a value passed to wiki-text expansion routines specifying the\n// purpose of the rendering so, for example, links can be rendered differently\n// during edit than with plain HTML.\n//\n\nSocialCalc.FormatValueForDisplay = function(sheetobj, value, cr, linkstyle) {\n\n   var valueformat, has_parens, has_commas, valuetype, valuesubtype;\n   var displayvalue;\n\n   var sheetattribs=sheetobj.attribs;\n   var scc=SocialCalc.Constants;\n\n   var cell=sheetobj.cells[cr];\n\n   if (!cell) { // get an empty cell if not there\n      cell=new SocialCalc.Cell(cr);\n      }\n\n   displayvalue = value;\n\n   valuetype = cell.valuetype || \"\"; // get type of value to determine formatting\n   valuesubtype = valuetype.substring(1);\n   \n   // eddy setup display cell {\n   valueinputwidget = valuetype.charAt(1); \n   var formula_name= valuetype.substring(2);\n   var html_display_value = null; \n   var html_formated_value = null;\n   // }\n\n   valuetype = valuetype.charAt(0);\n   \n   \n   if (cell.errors || valuetype==\"e\") {\n      displayvalue = cell.errors || valuesubtype || \"Error in cell\";\n      return displayvalue;\n      }\n\n   if (valuetype==\"t\") {\n      valueformat = sheetobj.valueformats[cell.textvalueformat-0] || sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0] || \"\";\n      if (valueformat==\"formula\") {\n         if (cell.datatype==\"f\") {\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\n            }\n         else if (cell.datatype==\"c\") {\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\n            }\n         else {\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\n            }\n         return displayvalue;\n         }\n\t  var html_display_value = displayvalue; // eddy\n      displayvalue = SocialCalc.format_text_for_display(displayvalue, cell.valuetype, valueformat, sheetobj, linkstyle, cell.nontextvalueformat);\n\t  var html_formated_value = displayvalue; // eddy\n\t  \n      }\n\n   else if (valuetype==\"n\") {\n      valueformat = cell.nontextvalueformat;\n      if (valueformat==null || valueformat==\"\") { //\n         valueformat = sheetattribs.defaultnontextvalueformat;\n         }\n      valueformat = sheetobj.valueformats[valueformat-0];\n      if (valueformat==null || valueformat==\"none\") {\n         valueformat = \"\";\n         }\n\t\t \n\t\t \n      if (valueformat==\"formula\") {\n         if (cell.datatype==\"f\") {\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\n            }\n         else if (cell.datatype==\"c\") {\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\n            }\n         else {\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\n            }\n         return displayvalue;\n         }\n      else if (valueformat==\"forcetext\") {\n         if (cell.datatype==\"f\") {\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\n            }\n         else if (cell.datatype==\"c\") {\n            displayvalue = SocialCalc.special_chars(cell.formula) || \"&nbsp;\";\n            }\n         else {\n            displayvalue = SocialCalc.special_chars(displayvalue) || \"&nbsp;\";\n            }\n         return displayvalue;\n         }\n\t\t \n\t  var html_display_value = displayvalue; // eddy\n      displayvalue = SocialCalc.format_number_for_display(displayvalue, cell.valuetype, valueformat);\n\t  var html_formated_value = displayvalue; // eddy\n\n      }\n   else { // unknown type - probably blank\n      displayvalue = \"&nbsp;\";\n      }\n\n\n   // eddy display cell HTML {      \n   if(valueinputwidget==\"i\" && html_display_value!=null && html_formated_value!=null) {\n\t var formula_details = SocialCalc.Formula.FunctionList[formula_name]; \n//\t var ecell = SocialCalc.GetSpreadsheetControlObject().editor.ecell; // check if widget has focus\n//\t SocialCalc.GetSpreadsheetControlObject().debug.push({formula_name:formula_name});\n\t\t if( formula_details) {\n\t\t\t var cell_html = formula_details[5];\n\t\t\t // var cell_html = \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction('<%=cell_reference%>');\\\"><%=display_value%></button>\";\n\t\t\t \n\t\t\t var checkedValue = (html_display_value == 0) ? \"\" : \"checked\"; // for checkbox\n\t\t\t cell_html = cell_html.replace(/<%=checked%>/g, checkedValue);\n\t\t\t cell_html = cell_html.replace(/<%=formated_value%>/g, html_formated_value);\n\t\t\t cell_html = cell_html.replace(/<%=display_value%>/g, html_display_value);\n\t\t\t return cell_html.replace(/<%=cell_reference%>/g, cr);\n\t\t\t }\n\t\t return \"error:Widget HTML missing\";\n\t }\n   // }\n\t  \n\t  \n\t  \n   return displayvalue;\n\n   }\n\n \n   \n//\n// displayvalue = format_text_for_display(rawvalue, valuetype, valueformat, sheetobj, linkstyle, nontextvalueformat)\n//\n\nSocialCalc.format_text_for_display = function(rawvalue, valuetype, valueformat, sheetobj, linkstyle, nontextvalueformat) {\n\n   var valueformat, valuesubtype, dvsc, dvue, textval;\n   var displayvalue;\n\n   valuesubtype = valuetype.substring(1);\n\n   displayvalue = rawvalue;\n\n   if (valueformat==\"none\" || valueformat==null) valueformat=\"\";\n   if (!/^(text-|custom|hidden)/.test(valueformat)) valueformat=\"\";\n   if (valueformat==\"\" || valueformat==\"General\") { // determine format from type\n      if (valuesubtype==\"h\") valueformat=\"text-html\";\n      if (valuesubtype==\"w\" || valuesubtype==\"r\") valueformat=\"text-wiki\";\n      if (valuesubtype==\"l\") valueformat=\"text-link\";\n      if (!valuesubtype) valueformat=\"text-plain\";\n      }\n   if (valueformat==\"text-html\") { // HTML - output as it as is\n      ;\n      }\n   else if (SocialCalc.Callbacks.expand_wiki && /^text-wiki/.test(valueformat)) { // do general wiki markup\n      displayvalue = SocialCalc.Callbacks.expand_wiki(displayvalue, sheetobj, linkstyle, valueformat);\n      }\n   else if (valueformat==\"text-wiki\") { // wiki text\n      displayvalue = (SocialCalc.Callbacks.expand_markup\n                      && SocialCalc.Callbacks.expand_markup(displayvalue, sheetobj, linkstyle)) || // do old wiki markup\n                     SocialCalc.special_chars(\"wiki-text:\"+displayvalue);\n      }\n   else if (valueformat==\"text-url\") { // text is a URL for a link\n      dvsc = SocialCalc.special_chars(displayvalue);\n      dvue = encodeURI(displayvalue);\n      displayvalue = '<a href=\"'+dvue+'\">'+dvsc+'</a>';\n      }\n   else if (valueformat==\"text-link\") { // more extensive link capabilities for regular web links\n      displayvalue = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat);\n      }\n   else if (valueformat==\"text-image\") { // text is a URL for an image\n      dvue = encodeURI(displayvalue);\n      displayvalue = '<img src=\"'+dvue+'\">';\n      }\n   else if (valueformat.substring(0,12)==\"text-custom:\") { // construct a custom text format: @r = text raw, @s = special chars, @u = url encoded\n      dvsc = SocialCalc.special_chars(displayvalue); // do special chars\n      dvsc = dvsc.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n      dvsc = dvsc.replace(/\\n/g, \"<br>\");  // keep line breaks\n      dvue = encodeURI(displayvalue);\n      textval={};\n      textval.r = displayvalue;\n      textval.s = dvsc;\n      textval.u = dvue;\n      displayvalue = valueformat.substring(12); // remove \"text-custom:\"\n      displayvalue = displayvalue.replace(/@(r|s|u)/g, function(a,c){return textval[c];}); // replace placeholders\n      }\n   else if (valueformat.substring(0,6)==\"custom\") { // custom\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\n      displayvalue += \" (custom format)\";\n      }\n   else if (valueformat==\"hidden\") {\n      displayvalue = \"&nbsp;\";\n      }\n   else if (nontextvalueformat != null && nontextvalueformat != \"\" && sheetobj.valueformats[nontextvalueformat-0] != \"none\" && sheetobj.valueformats[nontextvalueformat-0] != \"\" ) {\n      valueformat = sheetobj.valueformats[nontextvalueformat];\n      displayvalue = SocialCalc.format_number_for_display(rawvalue, valuetype, valueformat);\n      }\n   else { // plain text\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\n      }\n\n   return displayvalue;\n\n   }\n\n\n//\n// displayvalue = format_number_for_display(rawvalue, valuetype, valueformat)\n//\n\nSocialCalc.format_number_for_display = function(rawvalue, valuetype, valueformat) {\n\n   var value, valuesubtype;\n   var scc = SocialCalc.Constants;\n\n   value = rawvalue-0;\n\n   valuesubtype = valuetype.substring(1);\n\n   if (valueformat==\"Auto\" || valueformat==\"\") { // cases with default format\n      if (valuesubtype==\"%\") { // will display a % character\n         valueformat = scc.defaultFormatp;\n         }\n      else if (valuesubtype=='$') {\n         valueformat = scc.defaultFormatc;\n         }\n      else if (valuesubtype=='dt') {\n         valueformat = scc.defaultFormatdt;\n         }\n      else if (valuesubtype=='d') {\n         valueformat = scc.defaultFormatd;\n         }\n      else if (valuesubtype=='t') {\n         valueformat = scc.defaultFormatt;\n         }\n      else if (valuesubtype=='l') {\n         valueformat = 'logical';\n         }\n      else {\n         valueformat = \"General\";\n         }\n      }\n\n   if (valueformat==\"logical\") { // do logical format\n      return value ? scc.defaultDisplayTRUE : scc.defaultDisplayFALSE;\n      }\n\n   if (valueformat==\"hidden\") { // do hidden format\n      return \"&nbsp;\";\n      }\n\n   // Use format\n\n   return SocialCalc.FormatNumber.formatNumberWithFormat(rawvalue, valueformat, \"\");\n\n   }\n\n//\n// valueinfo = DetermineValueType(rawvalue)\n//\n// Takes a value and looks for special formatting like $, %, numbers, etc.\n// Returns the value as a number or string and the type as {value: value, type: type}.\n// Tries to follow the spec for spreadsheet function VALUE(v).\n//\n\nSocialCalc.DetermineValueType = function(rawvalue) {\n\n   var value = rawvalue + \"\";\n   var type = \"t\";\n   var tvalue, matches, year, hour, minute, second, denom, num, intgr, constr;\n\n   tvalue = value.replace(/^\\s+/, \"\"); // remove leading and trailing blanks\n   tvalue = tvalue.replace(/\\s+$/, \"\");\n\n   if (value.length==0) {\n      type = \"\";\n      }\n   else if (value.match(/^\\s+$/)) { // just blanks\n      ; // leave type \"t\"\n      }\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*(?:[eE][-+]?\\d+)?$/)) { // general number, including E\n      value = tvalue - 0; // try converting to number\n      if (isNaN(value)) { // leave alone - catches things like plain \"-\"\n         value = rawvalue + \"\";\n         }\n      else {\n         type = \"n\";\n         }\n      }\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*\\s*%$/)) { // percent form: 15.1%\n      value = (tvalue.slice(0, -1) - 0) / 100; // convert and scale\n      type = \"n%\";\n      }\n   else if (tvalue.match(/^[-+]?\\$\\s*\\d*(?:\\.)?\\d*\\s*$/) && tvalue.match(/\\d/)) { // $ format: $1.49\n      value = tvalue.replace(/\\$/, \"\") - 0;\n      type = \"n$\";\n      }\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*$/)) { // number format ignoring commas: 1,234.49\n      value = tvalue.replace(/,/g, \"\") - 0;\n      type = \"n\";\n      }\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*\\s*%$/)) { // % with commas: 1,234.49%\n      value = (tvalue.replace(/[%,]/g, \"\") - 0) / 100;\n      type = \"n%\";\n      }\n   else if (tvalue.match(/^[-+]?\\$\\s*(\\d*,\\d*)+(?:\\.)?\\d*$/) && tvalue.match(/\\d/)) { // $ and commas: $1,234.49\n      value = tvalue.replace(/[\\$,]/g, \"\") - 0;\n      type = \"n$\";\n      }\n   else if (matches=value.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,4})\\s*$/)) { // MM-DD-YYYY, MM/DD/YYYY\n      year = matches[3] - 0;\n      year = year < 1000 ? year + 2000 : year;\n      value = ((navigator.language).indexOf(\"fr\") === 0)  ? (SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[1]-0)-2415019) : (SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[1]-0, matches[2]-0)-2415019);\n      type = \"nd\";\n      }\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD\n      year = matches[1]-0;\n      year = year < 1000 ? year + 2000 : year;\n      value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\n      type = \"nd\";\n      }\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2}) (\\d{1,2}):(\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD HH:MM\n     // eddy added YYYY-MM-DD, YYYY/MM/DD HH:MM\n     year = matches[1]-0;\n     year = year < 1000 ? year + 2000 : year;\n     hour = matches[4]-0;\n     minute = matches[5]-0;\n     value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\n     type = \"nd\";\n     if (hour < 24 && minute < 60) {\n       value += hour/24 + minute/(24*60);\n       type = \"ndt\";\n       }\n     }\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD HH:MM:SS\n     // eddy added YYYY-MM-DD, YYYY/MM/DD HH:MM:SS\n     year = matches[1]-0;\n     year = year < 1000 ? year + 2000 : year;\n     hour = matches[4]-0;\n     minute = matches[5]-0;\n     second = matches[6]-0;\n     value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\n     type = \"nd\";\n     if (hour < 24 && minute < 60 && second < 60) {\n       value += hour/24 + minute/(24*60) + second/(24*60*60);\n       type = \"ndt\";\n       }\n     }\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM\n      hour = matches[1]-0;\n      minute = matches[2]-0;\n      if (hour < 24 && minute < 60) {\n         value = hour/24 + minute/(24*60);\n         type = \"nt\";\n         }\n      }\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM:SS\n      hour = matches[1]-0;\n      minute = matches[2]-0;\n      second = matches[3]-0;\n      if (hour < 24 && minute < 60 && second < 60) {\n         value = hour/24 + minute/(24*60) + second/(24*60*60);\n         type = \"nt\";\n         }\n      }\n   else if (matches=value.match(/^\\s*([-+]?\\d+) (\\d+)\\/(\\d+)\\s*$/)) { // 1 1/2\n      intgr = matches[1]-0;\n      num = matches[2]-0;\n      denom = matches[3]-0;\n      if (denom && denom > 0) {\n         value = intgr + (intgr < 0 ? -num/denom : num/denom);\n         type = \"n\";\n         }\n      }\n   else if (constr=SocialCalc.InputConstants[value.toUpperCase()]) { // special constants, like \"false\" and #N/A\n      num = constr.indexOf(\",\");\n      value = constr.substring(0,num)-0;\n      type = constr.substring(num+1);\n      }\n   else if (tvalue.length > 7 && tvalue.substring(0,7).toLowerCase()==\"http://\") { // URL\n      value = tvalue;\n      type = \"tl\";\n      }\n   else if (tvalue.match(/<([A-Z][A-Z0-9]*)\\b[^>]*>[\\s\\S]*?<\\/\\1>/i)) { // HTML\n      value = tvalue;\n      type = \"th\";\n      }\n\n   return {value: value, type: type};\n\n   }\n\nSocialCalc.InputConstants = { // strings that turn into constants for SocialCalc.DetermineValueType\n      \"TRUE\": \"1,nl\", \"FALSE\": \"0,nl\", \"#N/A\": \"0,e#N/A\", \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\",\n      \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\", \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\n\n//\n// result = default_expand_markup(displayvalue, sheetobj, linkstyle)\n//\n// Processes wiki-text -- this is a placeholder.\n// Reference to here in SocialCalc.expand_markup should be replaced by application-specific routine.\n//\n\nSocialCalc.default_expand_markup = function(displayvalue, sheetobj, linkstyle) {\n\n   var result = displayvalue;\n\n   result = SocialCalc.special_chars(result); // do special chars\n   result = result.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\n   result = result.replace(/\\n/g, \"<br>\"); // keep line breaks\n\n   return result; // do very little by default\n\n   result = result.replace(/('*)'''(.*?)'''/g, \"$1<b>$2<\\/b>\"); // Wiki-style bold/italics\n   result = result.replace(/''(.*?)''/g, \"<i>$1<\\/i>\");\n\n   return result;\n\n   }\n\n\n//\n// result = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat)\n//\n// Parses link text (URL, descriptions, pagenames, workspace names) and returns HTML\n//\n\nSocialCalc.expand_text_link = function(displayvalue, sheetobj, linkstyle, valueformat) {\n\n   var desc, tb, str;\n\n   var scc = SocialCalc.Constants;\n\n   var url = \"\";\n   var parts = SocialCalc.ParseCellLinkText(displayvalue+\"\");\n\n   if (parts.desc) {\n      desc = SocialCalc.special_chars(parts.desc);\n      }\n   else {\n      desc = parts.pagename ? scc.defaultPageLinkFormatString : scc.defaultLinkFormatString;\n      }\n\n   if (displayvalue.length > 7 && displayvalue.substring(0,7).toLowerCase()==\"http://\" \n      && displayvalue.charAt(displayvalue.length-1)!=\">\") {\n      desc = desc.substring(7); // remove http:// unless explicit\n      }\n\n   tb = (parts.newwin || !linkstyle) ? ' target=\"_blank\"' : \"\";\n\n   if (parts.pagename) {\n      if (SocialCalc.Callbacks.MakePageLink) {\n         url = SocialCalc.Callbacks.MakePageLink(parts.pagename, parts.workspacename, linkstyle, valueformat);\n         }\n//      else if (parts.workspace) {\n//         url = \"/\" + encodeURI(parts.workspace) + \"/\" + encodeURI(parts.pagename);\n//         }\n//      else {\n//         url = parts.pagename;\n//         }\n      }\n   else {\n      url = encodeURI(parts.url);\n      }\n   str = '<a href=\"' + url + '\"' + tb + '>' + desc + '</a>';\n\n   return str;\n\n   }\n\n\n//\n// result = SocialCalc.ParseCellLinkText(str)\n//\n// Given: url = http://www.someurl.com/more, desc = Some descriptive text\n//\n// Takes the following:\n//\n//    url\n//    <url>\n//    desc<url>\n//    \"desc\"<url>\n//    <<>> instead of <> => target=\"_blank\" (new window)\n//\n//    [page name]\n//    \"desc\"[page name]\n//    desc[page name]\n//    {workspace name [page name]}\n//    \"desc\"{workspace name [page name]}\n//    [[]] instead of [] => target=\"_blank\" (new window)\n//\n//\n// Returns: {url: url, desc: desc, newwin: t/f, pagename: pagename, workspace: workspace}\n//\n\nSocialCalc.ParseCellLinkText = function(str) {\n\n   var result = {url: \"\", desc: \"\", newwin: false, pagename: \"\", workspace: \"\"};\n\n   var pageform = false;\n   var urlend = str.length - 1;\n   var descstart = 0;\n   var lastlt = str.lastIndexOf(\"<\");\n   var lastbrkt = str.lastIndexOf(\"[\");\n   var lastbrace = str.lastIndexOf(\"{\");\n   var descend = -1;\n\n   if ((str.charAt(urlend) != \">\" || lastlt == -1)\n         && (str.charAt(urlend) != \"]\" || lastbrkt == -1)\n         && (str.charAt(urlend) != \"}\" || str.charAt(urlend-1) != \"]\" || \n             lastbrace == -1 || lastbrkt == -1 || lastbrkt < lastbrace)) { // plain url\n      urlend++;\n      descend = urlend;\n      }\n   else { // some markup\n      if (str.charAt(urlend)==\">\") { // url form\n         descend = lastlt - 1;\n         if (lastlt > 0 && str.charAt(descend) == \"<\" && str.charAt(urlend-1) == \">\") {\n            descend--;\n            urlend--;\n            result.newwin = true;\n            }\n         }\n\n      else if (str.charAt(urlend)==\"]\") { // plain page form\n         descend = lastbrkt - 1;\n         pageform = true;\n         if (lastbrkt > 0 && str.charAt(descend) == \"[\" && str.charAt(urlend-1) == \"]\") {\n            descend--;\n            urlend--;\n            result.newwin = true;\n            }\n         }\n\n      else if (str.charAt(urlend)==\"}\") { // page and workspace form\n         descend = lastbrace - 1;\n         pageform = true;\n         wsend = lastbrkt;\n         urlend--;\n         if (lastbrkt > 0 && str.charAt(lastbrkt-1) == \"[\" && str.charAt(urlend-1) == \"]\") {\n            wsend = lastbrkt-1;\n            urlend--;\n            result.newwin = true;\n            }\n         if (str.charAt(wsend-1)==\" \") { // trim trailing space in workspace name\n            wsend--;\n            }\n         result.workspace = str.substring(lastbrace+1, wsend) || \"\";\n         }\n\n      if (str.charAt(descend)==\" \") { // trim trailing space on desc\n         descend--;\n         }\n\n      if (str.charAt(descstart) == '\"' && str.charAt(descend) == '\"') {\n         descstart++;\n         descend--;\n         }\n      }\n\n   if (pageform) {\n      result.pagename = str.substring(lastbrkt+1, urlend) || \"\";\n      }\n   else {\n      result.url = str.substring(lastlt+1, urlend) || \"\";\n      }\n\n   if (descend >= descstart) {\n      result.desc = str.substring(descstart, descend+1);\n      }\n\n   return result;\n\n   }\n\n\n//\n// result = SocialCalc.ConvertSaveToOtherFormat(savestr, outputformat, dorecalc)\n//\n// Returns a string in the specificed format: \"scsave\", \"html\", \"csv\", \"tab\" (tab delimited)\n// If dorecalc is true, performs a recalc after loading (NO: obsolete!).\n//\n\nSocialCalc.ConvertSaveToOtherFormat = function(savestr, outputformat, dorecalc) {\n\n   var sheet, context, clipextents, div, ele, row, col, cr, cell, str;\n\n   var result = \"\";\n\n   if (outputformat == \"scsave\") {\n      return savestr;\n      }\n\n   if (savestr == \"\") {\n      return \"\";\n      }\n\n   sheet = new SocialCalc.Sheet();\n   sheet.ParseSheetSave(savestr);\n\n   if (dorecalc) {\n      // no longer supported as of 9/10/08\n      // Recalc is now async, so can't do it this way\n      throw(\"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.\");\n      }\n\n   if (sheet.copiedfrom) {\n      clipextents = SocialCalc.ParseRange(sheet.copiedfrom);\n      }\n   else {\n      clipextents = {cr1: {row: 1, col: 1}, cr2: {row: sheet.attribs.lastrow, col: sheet.attribs.lastcol}};\n      }\n\n   if (outputformat == \"html\") {\n      context=new SocialCalc.RenderContext(sheet);\n      if (sheet.copiedfrom) {\n         context.rowpanes[0] = {first: clipextents.cr1.row, last: clipextents.cr2.row};\n         context.colpanes[0] = {first: clipextents.cr1.col, last: clipextents.cr2.col};\n         }\n      div = document.createElement(\"div\");\n      ele = context.RenderSheet(null, context.defaultHTMLlinkstyle);\n      div.appendChild(ele);\n      delete context;\n      delete sheet;\n      result = div.innerHTML;\n      delete ele;\n      delete div;\n      return result;\n      }\n\n   for (row = clipextents.cr1.row; row <= clipextents.cr2.row; row++) {\n      for (col = clipextents.cr1.col; col <= clipextents.cr2.col; col++) {\n         cr = SocialCalc.crToCoord(col, row);\n         cell = sheet.GetAssuredCell(cr);\n\n         if (cell.errors) {\n            str = cell.errors;\n            }\n         else {\n            str = cell.datavalue+\"\"; // get value as text\n            }\n\n         if (outputformat == \"csv\") {\n            if (str.indexOf('\"')!=-1) {\n               str = str.replace(/\"/g, '\"\"'); // double quotes\n               }\n            if (/[, \\n\"]/.test(str)) {\n               str = '\"' + str + '\"'; // add quotes\n               }\n            if (col>clipextents.cr1.col) {\n               str = \",\" + str; // add commas\n               }\n            }\n         else if (outputformat == \"tab\") {\n            if (str.indexOf('\\n')!=-1) { // if multiple lines\n               if (str.indexOf('\"')!=-1) {\n                  str = str.replace(/\"/g, '\"\"'); // double quotes\n                  }\n               str = '\"' + str + '\"'; // add quotes\n               }\n            if (col>clipextents.cr1.col) {\n               str = \"\\t\" + str; // add tabs\n               }\n            }\n         result += str;\n         }\n      result += \"\\n\";\n      }\n\n   return result;\n\n   }\n\n\n//\n// result = SocialCalc.ConvertOtherFormatToSave(inputstr, inputformat)\n//\n// Returns a string converted from the specified format: \"scsave\", \"csv\", \"tab\" (tab delimited)\n//\n\nSocialCalc.ConvertOtherFormatToSave = function(inputstr, inputformat) {\n\n   var sheet, context, lines, i, line, value, inquote, j, ch, values, row, col, cr, maxc;\n\n   var result = \"\";\n\n   var AddCell = function() {\n      col++;\n      if (col>maxc) maxc = col;\n      cr = SocialCalc.crToCoord(col, row);\n      SocialCalc.SetConvertedCell(sheet, cr, value);\n      value = \"\";\n      }\n\n   if (inputformat == \"scsave\") {\n      return inputstr;\n      }\n\n   sheet = new SocialCalc.Sheet();\n\n   lines = inputstr.split(/\\r\\n|\\n/);\n\n   maxc = 0;\n   if (inputformat == \"csv\") {\n      row = 0;\n      inquote = false;\n      for (i=0; i<lines.length; i++) {\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\n            break;\n            }\n         if (inquote) { // if inquote, just continue from where left off\n            value += \"\\n\";\n            }\n         else { // otherwise next row\n            value = \"\";\n            row++;\n            col = 0;\n            }\n         line = lines[i];\n         for (j=0; j<line.length; j++) {\n            ch = line.charAt(j);\n            if (ch == '\"') {\n               if (inquote) {\n                  if (j<line.length-1 && line.charAt(j+1) == '\"') { // double quotes\n                     j++; // skip the second one\n                     value += '\"'; // add one quote\n                     }\n                  else {\n                     inquote = false;\n                     if (j==line.length-1) { // at end of line\n                        AddCell();\n                        }\n                     }\n                  }\n               else {\n                  inquote = true;\n                  }\n               continue;\n               }\n            if (ch == \",\" && !inquote) {\n               AddCell();\n               }\n            else {\n               value += ch;\n               }\n            if (j==line.length-1 && !inquote) {\n               AddCell();\n               }\n            }\n         }\n      if (maxc>0) {\n         sheet.attribs.lastrow = row;\n         sheet.attribs.lastcol = maxc;\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\n         }\n      }\n\n   if (inputformat == \"tab\") {\n      row = 0;\n      inquote = false;\n      for (i=0; i<lines.length; i++) {\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\n            break;\n            }\n         if (inquote) { // if inquote, just continue from where left off\n            value += \"\\n\";\n            }\n         else { // otherwise next row\n            value = \"\";\n            row++;\n            col = 0;\n            }\n         line = lines[i];\n         for (j=0; j<line.length; j++) {\n            ch = line.charAt(j);\n            if (ch == '\"') {\n               if (inquote) {\n                  if (j<line.length-1) {\n                     if (line.charAt(j+1) == '\"') { // double quotes\n                        j++; // skip the second one\n                        value += '\"'; // add one quote\n                        }\n                     else if (line.charAt(j+1) == '\\t') { // end of quoted item\n                        j++;\n                        inquote = false;\n                        AddCell();\n                        }\n                     }\n                  else { // at end of line\n                     inquote = false;\n                     AddCell();\n                     }\n                  continue;\n                  }\n               if (value==\"\") { // quote at start of item\n                  inquote = true;\n                  continue;\n                  }\n               }\n            if (ch == \"\\t\" && !inquote) {\n               AddCell();\n               }\n            else {\n               value += ch;\n               }\n            if (j==line.length-1 && !inquote) {\n               AddCell();\n               }\n            }\n         }\n      if (maxc>0) {\n         sheet.attribs.lastrow = row;\n         sheet.attribs.lastcol = maxc;\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\n         }\n      }\n\n   return result;\n\n   }\n\n//\n// SocialCalc.SetConvertedCell(sheet, cr, rawvalue)\n//\n// Sets the cell cr with a value and type determined from rawvalue\n//\n\nSocialCalc.SetConvertedCell = function(sheet, cr, rawvalue) {\n\n   var cell, value;\n\n   cell = sheet.GetAssuredCell(cr);\n\n   value = SocialCalc.DetermineValueType(rawvalue);\n\n   if (value.type == 'n' && value.value == rawvalue) { // check that we don't need \"constant\" to remember original value\n      cell.datatype = \"v\";\n      cell.valuetype = \"n\";\n      cell.datavalue = value.value;\n      }\n   else if (value.type.charAt(0) == 't') { // text of some sort but left unchanged\n      cell.datatype = \"t\";\n      cell.valuetype = value.type;\n      cell.datavalue = value.value;\n      }\n   else { // special number types\n      cell.datatype = \"c\";\n      cell.valuetype = value.type;\n      cell.datavalue = value.value;\n      cell.formula = rawvalue;\n      }\n\n   }\n\n//\n// SocialCalcTableEditor\n//\n/*\n// The code module of the SocialCalc package that displays a scrolling grid with panes\n// and handles keyboard and mouse I/O.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n*/\n\n/*\n\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n\nEXHIBIT A. Common Public Attribution License Version 1.0.\n\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \nSections 14 and 15 have been added to cover use of software over a computer network and provide for \nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \nconsistent with Exhibit B.\n\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \nKIND, either express or implied. See the License for the specific language governing rights and \nlimitations under the License.\n\nThe Original Code is SocialCalc JavaScript TableEditor.\n\nThe Original Developer is the Initial Developer.\n\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n\nContributor: Dan Bricklin.\n\n\nEXHIBIT B. Attribution Information\n\nWhen the TableEditor is producing and/or controlling the display the Graphic Image must be\ndisplayed on the screen visible to the user in a manner comparable to that in the \nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\nthat image. The image must be linked to the Attribution URL so as to access that page\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\nfactual prominent attribution in a form similar to that in the \"about\" display included\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\n\nAttribution Copyright Notice:\n\n Copyright (C) 2010 Socialtext, Inc.\n All Rights Reserved.\n\nAttribution Phrase (not exceeding 10 words): SocialCalc\n\nAttribution URL: http://www.socialcalc.org/xoattrib\n\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\na suitable replacement from http://www.socialcalc.org/licenses specified as\nbeing for SocialCalc.\n\nDisplay of Attribution Information is required in Larger Works which are defined \nin the CPAL as a work which combines Covered Code or portions thereof with code \nnot governed by the terms of the CPAL.\n\n*/\n\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n\n/*\n\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\n\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) { // created here, too, in case load order is wrong, but main routines are required\n      SocialCalc = {};\n      }\n\n// *************************************\n//\n// Table Editor class:\n//\n// *************************************\n\n// Constructor:\n\nSocialCalc.TableEditor = function(context) {\n\n   var scc = SocialCalc.Constants;\n\n   // Properties:\n\n   this.context = context; // editing context\n   this.toplevel = null; // top level HTML element for this table editor\n   this.fullgrid = null; // rendered editing context\n\n   this.noEdit = false; // if true, disable all edit UI and make read-only\n\n   this.width = null;\n   this.tablewidth = null;\n   this.height = null;\n   this.tableheight = null;\n\n   this.inputBox = null;\n   this.inputEcho = null;\n   this.verticaltablecontrol = null;\n   this.horizontaltablecontrol = null;\n\n   this.logo = null;\n\n   this.cellhandles = null;\n\n   // Dynamic properties:\n\n   this.timeout = null; // if non-null, timer id for position calculations\n   this.busy = false; // true when executing command, calculating, etc.\n   this.ensureecell = false; // if true, ensure ecell is visible after timeout\n   this.deferredCommands = []; // commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\n   this.deferredEmailCommands = []; // Email commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\n\n   this.gridposition = null; // screen coords of full grid\n   this.headposition = null; // screen coords of upper left of grid within header rows\n   this.firstscrollingrow = null; // row number of top row in last (the scrolling) pane\n   this.firstscrollingrowtop = null;  // position of top row in last (the scrolling) pane\n   this.lastnonscrollingrow = null; // row number of last displayed row in last non-scrolling\n                                    // pane, or zero (for thumb position calculations)\n   this.lastvisiblerow = null; // used for paging down\n   this.firstscrollingcol = null; // column number of top col in last (the scrolling) pane\n   this.firstscrollingcolleft = null;  // position of top col in last (the scrolling) pane\n   this.lastnonscrollingcol = null; // col number of last displayed column in last non-scrolling\n                                    // pane, or zero (for thumb position calculations)\n   this.lastvisiblecol = null; // used for paging right\n\n   this.rowpositions = []; // screen positions of the top of some rows\n   this.colpositions = []; // screen positions of the left side of some rows\n   this.rowheight = []; // size in pixels of each row when last checked, or null/undefined, for page up\n   this.colwidth = []; // size in pixels of each column when last checked, or null/undefined, for page left\n\n   this.ecell = null; // either null or {coord: c, row: r, col: c}\n   this.state = \"start\"; // the keyboard states: see EditorProcessKey\n\n   this.workingvalues = {}; // values used during keyboard editing, etc.\n\n   // Constants:\n\n   this.imageprefix = scc.defaultImagePrefix; // URL prefix for images (e.g., \"/images/sc\")\n   this.idPrefix = scc.defaultTableEditorIDPrefix;\n   this.pageUpDnAmount = scc.defaultPageUpDnAmount; // number of rows to move cursor on PgUp/PgDn keys (numeric)\n\n   // Callbacks\n\n   // recalcFunction: if present, function(editor) {...}, called to do a recalc\n   // Default (sheet.RecalcSheet) does all the right stuff.\n\n   this.recalcFunction = function(editor) {\n      if (editor.context.sheetobj.RecalcSheet) {\n         editor.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback, editor);\n         }\n      else return null;\n      };\n\n   // ctrlkeyFunction: if present, function(editor, charname) {...}, called to handle ctrl-V, etc., at top level\n   // Returns true (pass through for continued processing) or false (stop processing this key).\n\n   this.ctrlkeyFunction = function(editor, charname) {\n\n      var ta, cell, position, cmd, sel, cliptext;\n\n      switch (charname) {\n         case \"[ctrl-c]\":\n         case \"[ctrl-x]\":\n            ta = editor.pasteTextarea;\n            ta.value = \"\";\n            cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n            if (cell) {\n               position = SocialCalc.GetElementPosition(cell.element);\n               ta.style.left = (position.left-1)+\"px\";\n               ta.style.top = (position.top-1)+\"px\";\n               }\n            if (editor.range.hasrange) {\n               sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n                  \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n               }\n            else {\n               sel = editor.ecell.coord;\n               }\n\n            // get what to copy to clipboard\n            cliptext = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj, sel), \"tab\");\n\n            if (charname == \"[ctrl-c]\" || editor.noEdit || editor.ECellReadonly()) { // if copy or cut but in no edit\n               cmd = \"copy \"+sel+\" formulas\";\n               }\n            else { // [ctrl-x]\n               cmd = \"cut \"+sel+\" formulas\";\n               }\n            editor.EditorScheduleSheetCommands(cmd, true, false); // queue up command to put on SocialCalc clipboard\n\n            ta.style.display = \"block\";\n            ta.value = cliptext; // must follow \"block\" setting for Webkit\n            ta.focus();\n            ta.select();\n            window.setTimeout(function() {\n               var ta = editor.pasteTextarea;\n               ta.blur();\n               ta.style.display = \"none\";\n               SocialCalc.KeyboardFocus();\n               }, 200);\n\n            return true;\n\n         case \"[ctrl-v]\":\n            if (editor.noEdit || editor.ECellReadonly()) return true; // not if no edit\n            ta = editor.pasteTextarea;\n            ta.value = \"\";\n            cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n            if (cell) {\n               position = SocialCalc.GetElementPosition(cell.element);\n               ta.style.left = (position.left-1)+\"px\";\n               ta.style.top = (position.top-1)+\"px\";\n               }\n            ta.style.display = \"block\";\n            ta.value = \"\";  // must follow \"block\" setting for Webkit\n            ta.focus();\n            window.setTimeout(function() {\n               var ta = editor.pasteTextarea;\n               var value = ta.value;\n               ta.blur();\n               ta.style.display = \"none\";\n               var cmd = \"\";\n               if(editor.pastescclipboard) {\n                 // Clipboard loaded from \"clipboard tab\" - see  SpreadsheetControlClipboardLoad \n                 // ignore windows clipboard contents\n                 editor.pastescclipboard = false;\n                 } \n               else {\n                 // Use windows clipboard contents if value does not match last copy\n                 var clipstr = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\n                 value = value.replace(/\\r\\n/g, \"\\n\");\n                 // pastes SocialCalc clipboard if did a Ctrl-C and contents still the same\n                 // Webkit adds an extra blank line, so need to allow for that\n                 if (value != clipstr && (value.length-clipstr.length!=1 || value.substring(0,value.length-1)!=clipstr)) {\n                    cmd = \"loadclipboard \"+\n                    SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(value, \"tab\")) + \"\\n\";\n                    }\n                 }\n               var cr;\n               if (editor.range.hasrange) {\n                  var clipsheet = new SocialCalc.Sheet();\n                  clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\n                  var matches = clipsheet.copiedfrom.match(/(.+):(.+)/);\n                  if (matches !== null && matches[1] === matches[2]) {\n                    // copy one cell to selected range\n                    cr = SocialCalc.crToCoord(editor.range.left, editor.range.top) +\n                      ':' + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n                  } else {\n                    cr = SocialCalc.crToCoord(editor.range.left, editor.range.top);\n                  }\n                  }\n               else {\n                  cr = editor.ecell.coord;\n                  }\n               cmd += \"paste \"+cr+\" formulas\";\n               editor.EditorScheduleSheetCommands(cmd, true, false);\n               SocialCalc.KeyboardFocus();\n               }, 200);\n            return true;\n\n         case \"[ctrl-z]\":\n            editor.EditorScheduleSheetCommands(\"undo\", true, false);\n            return false;\n\n         case \"[ctrl-s]\": // !!!! temporary hack\n            if (!SocialCalc.Constants.AllowCtrlS) break;\n            window.setTimeout(\n               function() {\n                  var sheet = editor.context.sheetobj;\n                  var cell = sheet.GetAssuredCell(editor.ecell.coord);\n                  var ntvf = cell.nontextvalueformat ? sheet.valueformats[cell.nontextvalueformat-0] || \"\" : \"\";\n                  var newntvf = window.prompt(\"Advanced Feature:\\n\\nCustom Numeric Format or Command\", ntvf);\n                  if (newntvf != null) { // not cancelled\n                     if (newntvf.match(/^cmd:/)) {\n                        cmd = newntvf.substring(4); // execute as command\n                        }\n                     else if (newntvf.match(/^edit:/)) {\n                        cmd = newntvf.substring(5); // execute as command\n                        if (SocialCalc.CtrlSEditor) {\n                           SocialCalc.CtrlSEditor(cmd);\n                           }\n                        return;\n                        }\n                     else {\n                        if (editor.range.hasrange) {\n                           sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n                              \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n                           }\n                        else {\n                          sel = editor.ecell.coord;\n                           }\n                        cmd = \"set \"+sel+\" nontextvalueformat \"+newntvf;\n                        }\n                     editor.EditorScheduleSheetCommands(cmd, true, false);\n                     }\n                  },\n               200);\n            return false;\n\n         default:\n            break;\n            }\n      return true;\n      };\n\n   // Set sheet's status callback:\n\n   context.sheetobj.statuscallback = SocialCalc.EditorSheetStatusCallback;\n   context.sheetobj.statuscallbackparams = this; // this object: the table editor object\n\n\n   // StatusCallback: all values are called at appropriate times, add with unique name, delete when done\n   //\n   // Each value must be an object in the form of:\n   //\n   //    func: function(editor, status, arg, params) {...},\n   //    params: params value to call func with\n   //\n   // The values for status and arg are:\n   //\n   //    all the SocialCalc RecalcSheet statuscallbacks, including:\n   //\n   //       calccheckdone, calclist length\n   //       calcorder, {coord: coord, total: celllist length, count: count}\n   //       calcstep, {coord: coord, total: calclist length, count: count}\n   //       calcfinished, time in milliseconds\n   //\n   //    the command callbacks, like cmdstart and cmdend\n   //    cmdendnorender\n   //\n   //    calcstart, null\n   //    moveecell, new ecell coord\n   //    rangechange, \"coord:coord\" or \"coord\" or \"\"\n   //    specialkey, keyname (\"[esc]\")\n   //\n\n   this.StatusCallback = {};\n\n\n   this.MoveECellCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\n   this.RangeChangeCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\n   this.SettingsCallbacks = {}; // See SocialCalc.SaveEditorSettings\n\n   // Set initial cursor\n\n   this.ecell = {coord: \"A1\", row: 1, col: 1};\n   context.highlights[this.ecell.coord] = \"cursor\";\n\n   // Initialize range data\n   // Range has at least hasrange (true/false).\n   // It may also have: anchorcoord, anchorrow, anchorcol, top, bottom, left, and right.\n\n   this.range = {hasrange: false};\n\n   // Initialize range2 data (used to show selections, such as for move)\n   // Range2 has at least hasrange (true/false).\n   // It may also have: top, bottom, left, and right.\n\n   this.range2 = {hasrange: false};\n\n   }\n\n// Methods:\n\nSocialCalc.TableEditor.prototype.CreateTableEditor = function(width, height) {return SocialCalc.CreateTableEditor(this, width, height);};\nSocialCalc.TableEditor.prototype.ResizeTableEditor = function(width, height) {return SocialCalc.ResizeTableEditor(this, width, height);};\n\nSocialCalc.TableEditor.prototype.SaveEditorSettings = function() {return SocialCalc.SaveEditorSettings(this);};\nSocialCalc.TableEditor.prototype.LoadEditorSettings = function(str, flags) {return SocialCalc.LoadEditorSettings(this, str, flags);};\n\nSocialCalc.TableEditor.prototype.EditorRenderSheet = function() {SocialCalc.EditorRenderSheet(this);};\nSocialCalc.TableEditor.prototype.EditorScheduleSheetCommands = function(cmdstr, saveundo, ignorebusy) {SocialCalc.EditorScheduleSheetCommands(this, cmdstr, saveundo, ignorebusy);};\nSocialCalc.TableEditor.prototype.ScheduleSheetCommands = function(cmdstr, saveundo) {\n   this.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\n   };\nSocialCalc.TableEditor.prototype.SheetUndo = function() {\n   this.context.sheetobj.SheetUndo();\n   };\nSocialCalc.TableEditor.prototype.SheetRedo = function() {\n   this.context.sheetobj.SheetRedo();\n   };\nSocialCalc.TableEditor.prototype.EditorStepSet = function(status, arg) {SocialCalc.EditorStepSet(this, status, arg);};\nSocialCalc.TableEditor.prototype.GetStatuslineString = function(status, arg, params) {return SocialCalc.EditorGetStatuslineString(this, status, arg, params);};\n\nSocialCalc.TableEditor.prototype.EditorMouseRegister = function() {return SocialCalc.EditorMouseRegister(this);};\nSocialCalc.TableEditor.prototype.EditorMouseUnregister = function() {return SocialCalc.EditorMouseUnregister(this);};\nSocialCalc.TableEditor.prototype.EditorMouseRange = function(coord) {return SocialCalc.EditorMouseRange(this, coord);};\n\nSocialCalc.TableEditor.prototype.EditorProcessKey = function(ch, e) {return SocialCalc.EditorProcessKey(this, ch, e);};\nSocialCalc.TableEditor.prototype.EditorAddToInput = function(str, prefix) {return SocialCalc.EditorAddToInput(this, str, prefix);};\nSocialCalc.TableEditor.prototype.DisplayCellContents = function() {return SocialCalc.EditorDisplayCellContents(this);};\nSocialCalc.TableEditor.prototype.EditorSaveEdit = function(text) {return SocialCalc.EditorSaveEdit(this, text);};\nSocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange = function(cmdline, type) {return SocialCalc.EditorApplySetCommandsToRange(this, cmdline, type);};\n\nSocialCalc.TableEditor.prototype.MoveECellWithKey = function(ch) {return SocialCalc.MoveECellWithKey(this, ch);};\nSocialCalc.TableEditor.prototype.MoveECell = function(newcell) { if (SocialCalc._app) return \"A1\"; return SocialCalc.MoveECell(this, newcell);};\nSocialCalc.TableEditor.prototype.ReplaceCell = function(cell, row, col) {SocialCalc.ReplaceCell(this, cell, row, col);};\nSocialCalc.TableEditor.prototype.UpdateCellCSS = function(cell, row, col) {SocialCalc.UpdateCellCSS(this, cell, row, col);};\nSocialCalc.TableEditor.prototype.SetECellHeaders = function(selected) {SocialCalc.SetECellHeaders(this, selected);};\nSocialCalc.TableEditor.prototype.EnsureECellVisible = function() {SocialCalc.EnsureECellVisible(this);};\nSocialCalc.TableEditor.prototype.ECellReadonly = function(coord) {return SocialCalc.ECellReadonly(this, coord);};\nSocialCalc.TableEditor.prototype.RangeAnchor = function(coord) {SocialCalc.RangeAnchor(this, coord);};\nSocialCalc.TableEditor.prototype.RangeExtend = function(coord) {SocialCalc.RangeExtend(this, coord);};\nSocialCalc.TableEditor.prototype.RangeRemove = function() {SocialCalc.RangeRemove(this);};\nSocialCalc.TableEditor.prototype.Range2Remove = function() {SocialCalc.Range2Remove(this);};\n\nSocialCalc.TableEditor.prototype.FitToEditTable = function() {SocialCalc.FitToEditTable(this);};\nSocialCalc.TableEditor.prototype.CalculateEditorPositions = function() {SocialCalc.CalculateEditorPositions(this);};\nSocialCalc.TableEditor.prototype.ScheduleRender = function() {this.ScheduleRender(true);};\nSocialCalc.TableEditor.prototype.ScheduleRender = function(renderwidgets) {    \n  // App widgets need focus - so only render widgets when needed, rather than the default of rendering everything. \n  if(SocialCalc._app && renderwidgets == true) this.context.sheetobj.widgetsClean = false;  \n  SocialCalc.ScheduleRender(this);\n  };\nSocialCalc.TableEditor.prototype.DoRenderStep = function() {SocialCalc.DoRenderStep(this);};\nSocialCalc.TableEditor.prototype.SchedulePositionCalculations = function() {SocialCalc.SchedulePositionCalculations(this);};\nSocialCalc.TableEditor.prototype.DoPositionCalculations = function() {SocialCalc.DoPositionCalculations(this);};\nSocialCalc.TableEditor.prototype.CalculateRowPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateRowPositions(this,  panenum, positions, sizes);};\nSocialCalc.TableEditor.prototype.CalculateColPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateColPositions(this,  panenum, positions, sizes);};\n\nSocialCalc.TableEditor.prototype.ScrollRelative = function(vertical, amount) {SocialCalc.ScrollRelative(this, vertical, amount);};\nSocialCalc.TableEditor.prototype.ScrollRelativeBoth = function(vamount, hamount) {SocialCalc.ScrollRelativeBoth(this, vamount, hamount);};\nSocialCalc.TableEditor.prototype.PageRelative = function(vertical, direction) {SocialCalc.PageRelative(this, vertical, direction);};\nSocialCalc.TableEditor.prototype.LimitLastPanes = function() {SocialCalc.LimitLastPanes(this);};\n\nSocialCalc.TableEditor.prototype.ScrollTableUpOneRow = function() {return SocialCalc.ScrollTableUpOneRow(this);};\nSocialCalc.TableEditor.prototype.ScrollTableDownOneRow = function() {return SocialCalc.ScrollTableDownOneRow(this);};\nSocialCalc.TableEditor.prototype.ScrollTableLeftOneCol = function() {return SocialCalc.ScrollTableLeftOneCol(this);};\nSocialCalc.TableEditor.prototype.ScrollTableRightOneCol = function() {return SocialCalc.ScrollTableRightOneCol(this);};\n\nSocialCalc.TableEditor.prototype.StopPropagation = function() {\n    return SocialCalc.StopPropagation(this);\n};\n\nSocialCalc.TableEditor.prototype.SetMouseMoveUp = function() {\n    return SocialCalc.SetMouseMoveUp(this);\n};\n\nSocialCalc.TableEditor.prototype.RemoveMouseMoveUp = function() {\n    return SocialCalc.RemoveMouseMoveUp(this);\n};\n\n// Functions:\n\nSocialCalc.CreateTableEditor = function(editor, width, height) {\n\n   var scc = SocialCalc.Constants;\n   var AssignID = SocialCalc.AssignID;\n\n   editor.toplevel = document.createElement(\"div\");\n   editor.toplevel.style.position = \"relative\";\n   AssignID(editor, editor.toplevel, \"toplevel\");\n   editor.width = width;\n   editor.height = height;\n\n   editor.griddiv = document.createElement(\"div\");\n   editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);\n   editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\n   editor.griddiv.style.width = editor.tablewidth+\"px\";\n   editor.griddiv.style.height = editor.tableheight+\"px\";\n   editor.griddiv.style.overflow = \"hidden\";\n   editor.griddiv.style.cursor = \"default\";\n   if (scc.cteGriddivClass) editor.griddiv.className = scc.cteGriddivClass;\n   AssignID(editor, editor.griddiv, \"griddiv\");\n\n   editor.FitToEditTable();\n\n   editor.EditorRenderSheet();\n\n   editor.griddiv.appendChild(editor.fullgrid);\n\n   editor.verticaltablecontrol = new SocialCalc.TableControl(editor, true, editor.tableheight);\n   editor.verticaltablecontrol.CreateTableControl();\n   AssignID(editor, editor.verticaltablecontrol.main, \"tablecontrolv\");\n\n   editor.horizontaltablecontrol = new SocialCalc.TableControl(editor, false, editor.tablewidth);\n   editor.horizontaltablecontrol.CreateTableControl();\n   AssignID(editor, editor.horizontaltablecontrol.main, \"tablecontrolh\");\n\n   var table, tbody, tr, td, img, anchor, ta;\n\n   table = document.createElement(\"table\");\n   editor.layouttable = table;\n   table.cellSpacing = 0;\n   table.cellPadding = 0;\n   AssignID(editor, table, \"layouttable\");\n\n   tbody = document.createElement(\"tbody\");\n   table.appendChild(tbody);\n\n   tr = document.createElement(\"tr\");\n   tbody.appendChild(tr);\n   td = document.createElement(\"td\");\n   td.appendChild(editor.griddiv);\n   tr.appendChild(td);\n   td = document.createElement(\"td\");\n   td.appendChild(editor.verticaltablecontrol.main);\n   tr.appendChild(td);\n\n   tr = document.createElement(\"tr\");\n   tbody.appendChild(tr);\n   td = document.createElement(\"td\");\n   td.appendChild(editor.horizontaltablecontrol.main);\n   tr.appendChild(td);\n\n   td = document.createElement(\"td\"); // logo display: Required by CPAL License for this code!\n   td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat center center\";\n   td.innerHTML = \"<div style='cursor:pointer;font-size:1px;'><img src='\"+editor.imageprefix+\"1x1.gif' border='0' width='18' height='18'></div>\";\n   tr.appendChild(td);\n   editor.logo = td;\n   AssignID(editor, editor.logo, \"logo\");\n   SocialCalc.TooltipRegister(td.firstChild.firstChild, \"SocialCalc\", null, editor.toplevel);\n\n   editor.toplevel.appendChild(editor.layouttable);\n\n   if (!editor.noEdit) {\n      editor.inputEcho = new SocialCalc.InputEcho(editor);\n      AssignID(editor, editor.inputEcho.main, \"inputecho\");\n      }\n\n   editor.cellhandles = new SocialCalc.CellHandles(editor);\n\n   ta = document.createElement(\"textarea\"); // used for ctrl-c/ctrl-v where an invisible text area is needed\n   SocialCalc.setStyles(ta, \"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);\");\n   ta.value = \"\";\n   editor.pasteTextarea = ta;\n   AssignID(editor, editor.pasteTextarea, \"pastetextarea\");\n\n   if (navigator.userAgent.match(/Safari\\//) &&!navigator.userAgent.match(/Chrome\\//)) { // special code for Safari 5 change\n      window.removeEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\n      window.addEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\n      window.removeEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\n      window.addEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\n      window.removeEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\n      window.addEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\n      }\n\n   editor.toplevel.appendChild(editor.pasteTextarea);\n\n   SocialCalc.MouseWheelRegister(editor.toplevel, {WheelMove: SocialCalc.EditorProcessMouseWheel, editor: editor});\n\n   SocialCalc.KeyboardSetFocus(editor);\n\n   // do status reporting things\n\n   SocialCalc.EditorSheetStatusCallback(null, \"startup\", null, editor);\n\n   // done\n\n   return editor.toplevel;\n\n   }\n\n// Special code needed for change that occurred with Safari 5 that made paste not work for some reason\n\nSocialCalc.SafariPasteFunction = function(e) {\n   e.preventDefault();\n   }\n\n//\n// SocialCalc.ResizeTableEditor(editor, width, height)\n//\n// Move things around as appropriate and resize\n//\n\nSocialCalc.ResizeTableEditor = function(editor, width, height) {\n\n   var scc = SocialCalc.Constants;\n\n   editor.width = width;\n   editor.height = height;\n\n   editor.toplevel.style.width = width+\"px\";\n   editor.toplevel.style.height = height+\"px\";\n\n   editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);\n   editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\n   editor.griddiv.style.width=editor.tablewidth+\"px\";\n   editor.griddiv.style.height=editor.tableheight+\"px\";\n\n   editor.verticaltablecontrol.main.style.height = editor.tableheight + \"px\";\n   editor.horizontaltablecontrol.main.style.width = editor.tablewidth + \"px\";\n\n   editor.FitToEditTable();\n\n   editor.ScheduleRender();\n\n   return;\n\n   }\n\n//\n// str = SaveEditorSettings(editor)\n//\n// Returns a string representation of the pane settings, etc.\n//\n// The format is:\n//\n//    version:1.0\n//    rowpane:panenumber:firstnum:lastnum\n//    colpane:panenumber:firstnum:lastnum\n//    ecell:coord -- if set\n//    range:anchorcoord:top:bottom:left:right -- if set\n//\n// You can add additional values to be saved by using editor.SettingsCallbacks:\n//\n//   editor.SettingsCallbacks[\"item-name\"] = {save: savefunction, load: loadfunction}\n//\n// where savefunction(editor, \"item-name\") returns a string with the new lines to be added to the saved settings\n// which include the trailing newlines, and loadfunction(editor, \"item-name\", line, flags) is given the line to process\n// without the trailing newlines.\n//\n\nSocialCalc.SaveEditorSettings = function(editor) {\n\n   var i, setting;\n   var context = editor.context;\n   var range = editor.range;\n   var result = \"\";\n\n   result += \"version:1.0\\n\";\n\n   for (i=0; i<context.rowpanes.length; i++) {\n      result += \"rowpane:\"+i+\":\"+context.rowpanes[i].first+\":\"+context.rowpanes[i].last+\"\\n\";\n      }\n   for (i=0; i<context.colpanes.length; i++) {\n      result += \"colpane:\"+i+\":\"+context.colpanes[i].first+\":\"+context.colpanes[i].last+\"\\n\";\n      }\n\n   if (editor.ecell) {\n      result += \"ecell:\"+editor.ecell.coord+\"\\n\";\n      }\n\n   if (range.hasrange) {\n      result += \"range:\"+range.anchorcoord+\":\"+range.top+\":\"+range.bottom+\":\"+range.left+\":\"+range.right+\"\\n\";\n      }\n\n   for (setting in editor.SettingsCallbacks) {\n      result += editor.SettingsCallbacks[setting].save(editor, setting);\n      }\n\n   return result;\n\n   }\n\n//\n// LoadEditorSettings(editor, str, flags)\n//\n// Sets the editor settings based on str. See SocialCalc.SaveEditorSettings for more details.\n// Unrecognized lines are ignored.\n//\n\nSocialCalc.LoadEditorSettings = function(editor, str, flags) {\n\n   var lines=str.split(/\\r\\n|\\n/);\n   var parts=[];\n   var line, i, cr, row, col, coord, setting;\n   var context = editor.context;\n   var highlights, range;\n\n   context.rowpanes = [{first: 1, last: 1}]; // reset to start\n   context.colpanes = [{first: 1, last: 1}];\n   editor.ecell = null;\n   editor.range = {hasrange: false};\n   editor.range2 = {hasrange: false};\n   range = editor.range;\n   context.highlights = {};\n   highlights = context.highlights;\n\n   for (i=0; i<lines.length; i++) {\n      line=lines[i];\n      parts = line.split(\":\");\n      setting = parts[0];\n      switch (setting) {\n         case \"version\":\n            break;\n\n         case \"rowpane\":\n            context.rowpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\n            break;\n\n         case \"colpane\":\n            context.colpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\n            break;\n\n         case \"ecell\":\n            editor.ecell = SocialCalc.coordToCr(parts[1]);\n            editor.ecell.coord = parts[1];\n            highlights[parts[1]] = \"cursor\";\n            break;\n\n         case \"range\":\n            range.hasrange = true;\n            range.anchorcoord = parts[1];\n            cr = SocialCalc.coordToCr(range.anchorcoord);\n            range.anchorrow = cr.row;\n            range.anchorcol = cr.col;\n            range.top = parts[2]-0;\n            range.bottom = parts[3]-0;\n            range.left = parts[4]-0;\n            range.right = parts[5]-0;\n            for (row=range.top; row<=range.bottom; row++) {\n               for (col=range.left; col<=range.right; col++) {\n                  coord = SocialCalc.crToCoord(col, row);\n                  if (highlights[coord]!=\"cursor\") {\n                     highlights[coord] = \"range\";\n                     }\n                  }\n               }\n            break;\n\n         default:\n            if (editor.SettingsCallbacks[setting]) {\n               editor.SettingsCallbacks[setting].load(editor, setting, line, flags);\n               }\n            break;\n         }\n      }\n\n   return;\n\n   }\n\n//\n// EditorRenderSheet(editor)\n//\n// Renders the sheet and updates editor.fullgrid.\n// Sets event handlers.\n//\n\nSocialCalc.EditorRenderSheet = function(editor) {\n\n   editor.EditorMouseUnregister();\n\n   var sheetobj = editor.context.sheetobj;\n   // App widgets need to keep focus -  only render widgets if needed \n   if(sheetobj.reRenderCellList != null && SocialCalc._app && sheetobj.widgetsClean === true) {\n     // re-render each individual cells - but not widget with focus \n     for(var index in sheetobj.reRenderCellList) {\n       var coord = sheetobj.reRenderCellList[index];\n       var valuetype = sheetobj.cells[coord].valuetype;\n       if(valuetype.charAt(1) != \"i\" || valuetype !=  sheetobj.cells[coord].prevvaluetype) { // skip widgets - but paint when added/replaced\n         cr = SocialCalc.coordToCr(coord);\n         cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\n         if(cell!=null) editor.ReplaceCell(cell, cr.row, cr.col);\n       }\n     }\n     sheetobj.reRenderCellList = [];\n   } else {\n      editor.fullgrid = editor.context.RenderSheet(editor.fullgrid);\n      if (sheetobj.reRenderCellList != null && SocialCalc._app) {\n        sheetobj.widgetsClean = true; // widgets have been rendered\n        sheetobj.reRenderCellList = [];        \n      }\n   }\n   \n   if (editor.ecell) editor.SetECellHeaders(\"selected\");\n\n   SocialCalc.AssignID(editor, editor.fullgrid, \"fullgrid\"); // give it an id\n   // eddy EditorRenderSheet {\n   if(!SocialCalc._app) editor.fullgrid.className = \"te_download\";\n   editor.EditorMouseRegister();\n   // } EditorRenderSheet\n   \n   }\n\n//\n// EditorScheduleSheetCommands(editor, cmdstr, saveundo, ignorebusy)\n//\n\nSocialCalc.EditorScheduleSheetCommands = function(editor, cmdstr, saveundo, ignorebusy) {\n\n   if (editor.state!=\"start\" && !ignorebusy) { // ignore commands if editing a cell\n      return;\n      }\n\n   if (editor.busy && !ignorebusy) { // hold off on commands if doing one\n      editor.deferredCommands.push({cmdstr: cmdstr, saveundo: saveundo});\n      return;\n      }\n\n   // eddy ExecuteSheetCommand {\n   var cmdTokens = cmdstr.split(\" \");\n\n   switch (cmdTokens[0]) {\n\t   // } eddy ExecuteSheetCommand \n      case \"recalc\":\n      case \"redisplay\":\n         editor.context.sheetobj.ScheduleSheetCommands(cmdstr, false);\n         break;\n\n      case \"undo\":\n         if(SocialCalc._app ) editor.context.sheetobj.widgetsClean = false;     // force app widgets to render     \n         editor.SheetUndo();\n         break;\n\n      case \"redo\":\n         if(SocialCalc._app ) editor.context.sheetobj.widgetsClean = false;     // force app widgets to render\n         editor.SheetRedo();\n         break;\n         \n      case \"setemailparameters\":    \t  \n\t\t  SocialCalc.TriggerIoAction.Email(cmdTokens[1], cmdTokens[2]);\n    \t  break;\n         \n         \n      default:\n         editor.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\n         break;\n      }\n   }\n\n\n//\n// EditorSheetStatusCallback(recalcdata, status, arg, editor)\n//\n// Called during recalc, executing commands, etc.\n//\n\nSocialCalc.EditorSheetStatusCallback = function(recalcdata, status, arg, editor) {\n\n   var f, cell, dcmd;\n   var sheetobj = editor.context.sheetobj;\n\n   var signalstatus = function(s) {\n      for (f in editor.StatusCallback) {\n         if (editor.StatusCallback[f].func) {\n            editor.StatusCallback[f].func(editor, s, arg, editor.StatusCallback[f].params);\n            }\n         }\n      }\n\n   switch (status) {\n\n      case \"startup\":\n         break;\n\n      case \"cmdstart\":\n         editor.busy = true;\n         sheetobj.celldisplayneeded = \"\";\n         break;\n\n      case \"cmdextension\":\n         break;\n\n      case \"cmdend\":\n         signalstatus(status);\n\n         if (sheetobj.changedrendervalues) {\n            editor.context.PrecomputeSheetFontsAndLayouts();\n            editor.context.CalculateCellSkipData();\n            sheetobj.changedrendervalues = false;\n            }\n\n         if (sheetobj.celldisplayneeded && !sheetobj.renderneeded) {\n             if (sheetobj.cells[sheetobj.celldisplayneeded] && sheetobj.cells[sheetobj.celldisplayneeded].valuetype != \"e#N/A\") {\n                cr = SocialCalc.coordToCr(sheetobj.celldisplayneeded);\n                cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\n                editor.ReplaceCell(cell, cr.row, cr.col); // if no value set, wait for recalc and render . \n                }\n             }\n         if (editor.deferredCommands.length) {\n            dcmd = editor.deferredCommands.shift();\n            editor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\n            return;\n            }\n         if (sheetobj.attribs.needsrecalc &&\n               (sheetobj.attribs.recalc!=\"off\" || sheetobj.recalconce)\n               && editor.recalcFunction) {\n            editor.FitToEditTable();\n            sheetobj.renderneeded = false; // recalc will force a render\n            if (sheetobj.recalconce) delete sheetobj.recalconce; // only do once\n            editor.recalcFunction(editor);\n            }\n         else {\n            if (sheetobj.renderneeded) {\n               editor.FitToEditTable();\n               sheetobj.renderneeded = false;\n               editor.ScheduleRender(false);\n               }\n            else {\n               editor.SchedulePositionCalculations(); // just in case command changed positions\n//               editor.busy = false;\n//               signalstatus(\"cmdendnorender\");\n               }\n            }\n\n         // Handle hidden column.\n         if (sheetobj.hiddencolrow == \"col\") {\n            if (editor.ecell !== null) {\n               var col = editor.ecell.col;\n               while (sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\n                  col++;\n                  }\n               var coord = SocialCalc.crToCoord(col, editor.ecell.row);\n               editor.MoveECell(coord);\n               sheetobj.hiddencolrow = \"\";\n               }\n            }\n\n         // Handle hidden row.\n         if (sheetobj.hiddencolrow == \"row\") {\n            if (editor.ecell !== null) {\n               var row = editor.ecell.row;\n               while (sheetobj.rowattribs.hide[row] == \"yes\") {\n                  row++;\n                  }\n               var coord = SocialCalc.crToCoord(editor.ecell.col, row);\n               editor.MoveECell(coord);\n               sheetobj.hiddencolrow = \"\";\n               }\n            }\n\n         return;\n\n      case \"calcstart\":\n         editor.busy = true;\n         break;\n\n      case \"calccheckdone\":\n      case \"calcorder\":\n      case \"calcstep\":\n      case \"calcloading\":\n      case \"calcserverfunc\":\n         break;\n\n      case \"calcfinished\":\n         signalstatus(status);\n         editor.ScheduleRender(false);                        \n         return;\n\n      case \"schedrender\":\n         editor.busy = true; // in case got here without cmd or recalc\n         break;\n\n      case \"renderdone\":\n         break;\n\n      case \"schedposcalc\":\n         editor.busy = true; // in case got here without cmd or recalc\n         break;\n\n      case \"doneposcalc\":\n          if (editor.deferredEmailCommands.length) {\n              signalstatus(status);\n              var emailcmd = editor.deferredEmailCommands.shift();\n              editor.EditorScheduleSheetCommands(emailcmd.cmdstr, emailcmd.saveundo, true);\n              return;\n              }\n    \t  \n    \t  \n         if (editor.deferredCommands.length) {\n            signalstatus(status);\n            dcmd = editor.deferredCommands.shift();\n            editor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\n            }\n         else {\n            editor.busy = false;\n            signalstatus(status);\n            if (editor.state==\"start\") editor.DisplayCellContents(); // make sure up to date\n            }\n         return;\n      // eddy EditorSheetStatusCallback {\n      case \"emailing\":\n      case \"confirmemailsent\":\n        break;\n      // } EditorSheetStatusCallback eddy \n         \n      default:\n    \t alert(\"Unknown status: \"+status);\n         break;\n\n      }\n\n   signalstatus(status);\n\n   return;\n\n   }\n\n//\n// str = SocialCalc.EditorGetStatuslineString(editor, status, arg, params)\n//\n// Assumes params is an object where it can use \"calculating\" and \"command\"\n// to keep track of state.\n// Returns string for status line.\n//\n\nSocialCalc.EditorGetStatuslineString = function(editor, status, arg, params) {\n\n   var scc = SocialCalc.Constants;\n\n   var sstr, progress, coord, circ, r, c, cell, sum, ele;\n\n   progress = \"\";\n\n   switch (status) {\n      case \"moveecell\":\n      case \"rangechange\":\n      case \"startup\":\n         break;\n      case \"cmdstart\":\n         params.command = true;\n         document.body.style.cursor = \"progress\";\n         editor.griddiv.style.cursor = \"progress\";\n         progress = scc.s_statusline_executing;\n         break;\n      case \"cmdextension\":\n         progress = \"Command Extension: \"+arg;\n         break;\n      case \"cmdend\":\n         params.command = false;\n         break;\n      case \"schedrender\":\n         progress = scc.s_statusline_displaying;\n         break;\n      case \"renderdone\":\n         progress = \" \";\n         break;\n      case \"schedposcalc\":\n         progress = scc.s_statusline_displaying;\n         break;\n      case \"cmdendnorender\":\n      case \"doneposcalc\":\n         document.body.style.cursor = \"default\";\n         editor.griddiv.style.cursor = \"default\";\n         // eddy EditorGetStatuslineString {\n         // all updates done, So let future event clear the \"sent\" message in the status bar\n         if(params.emailing == \"sent\") {\n        \t progress = params.emailreponse;\n        \t params.emailreponse = \"\";\n        \t params.emailing = \"done\";\n         }\n         // } eddy EditorGetStatuslineString \n         break;\n         \n      case \"calcorder\":\n         progress = scc.s_statusline_ordering+Math.floor(100*arg.count/(arg.total||1))+\"%\";\n         break;\n      case \"calcstep\":\n         progress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%\";\n         break;\n      case \"calcloading\":\n         progress = scc.s_statusline_calculatingls+\": \"+arg.sheetname;\n         break;\n      case \"calcserverfunc\":\n         progress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%, \"+scc.s_statusline_doingserverfunc+arg.funcname+scc.s_statusline_incell+arg.coord;\n         break;\n      case \"calcstart\":\n         params.calculating = true;\n         document.body.style.cursor = \"progress\";\n         editor.griddiv.style.cursor = \"progress\"; // griddiv has an explicit cursor style\n         progress = scc.s_statusline_calcstart;\n         break;\n      case \"calccheckdone\":\n         break;\n      case \"calcfinished\":\n         params.calculating = false;\n         break;\n      // eddy EditorGetStatuslineString {\n      case \"emailing\":\n    \t params.emailing = \"sending\";\n    \t params.emailreponse =\"\";\n         break;\n      case \"confirmemailsent\":\n     \t params.emailing = \"sent\";\n     \t if(typeof params.emailreponse === 'undefined') params.emailreponse =\"\";\n     \t params.emailreponse += arg;\n         break;    \t  \n      // } eddy EditorGetStatuslineString \n         \n      default:\n         progress = status;\n         break;\n      }\n\n   // eddy EditorGetStatuslineString {\n   // if send email then update status bar with \"sending\" and then \"sent\"\n   if(params.emailing == \"sending\") {\n  \t progress += scc.s_statusline_sendemail;\n   }\n   if(params.emailing == \"sent\") {\n  \t progress += params.emailreponse;\n   }   \n   // } eddy EditorGetStatuslineString \n   \n   if (!progress && params.calculating) {\n      progress = scc.s_statusline_calculating;\n      }\n\n   // if there is a range, calculate sum (not during busy times)\n   if (!params.calculating && !params.command && !progress && editor.range.hasrange \n       && (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom)) {\n      sum = 0;\n      for (r=editor.range.top; r <= editor.range.bottom; r++) {\n         for (c=editor.range.left; c <= editor.range.right; c++) {\n            cell = editor.context.sheetobj.cells[SocialCalc.crToCoord(c, r)];\n            if (!cell) continue;\n            if (cell.valuetype && cell.valuetype.charAt(0)==\"n\") {\n               sum += cell.datavalue-0;\n               }\n            }\n         }\n\n      sum = SocialCalc.FormatNumber.formatNumberWithFormat(sum, \"[,]General\", \"\");\n\n      coord = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n         SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      progress = coord + \" (\" + (editor.range.right-editor.range.left+1) + \"x\" + (editor.range.bottom-editor.range.top+1) +\n                 \") \"+scc.s_statusline_sum+\"=\" + sum + \" \" + progress;\n      }\n   sstr = (editor.ecell || {}).coord+\" &nbsp; \"+progress;\n\n   if (!params.calculating && editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\n      sstr += ' &nbsp; '+scc.s_statusline_recalcneeded;\n      }\n\n   circ = editor.context.sheetobj.attribs.circularreferencecell;\n   if (circ) {\n      circ = circ.replace(/\\|/, \" referenced by \");\n      sstr += ' &nbsp; '+scc.s_statusline_circref + circ + '</span>';\n      }\n   // eddy EditorGetStatuslineString {\n   sstr += \"\";\n   // } eddy EditorGetStatuslineString \n   return sstr;\n\n   }\n\n\n//\n// Mouse stuff\n//\n\nSocialCalc.EditorMouseInfo = {\n\n   // The registeredElements array is used to identify editor grid in which the mouse is doing things.\n\n   // One item for each active editor, each an object with:\n   //    .element, .editor\n\n   registeredElements: [],\n\n   editor: null, // editor being processed (between mousedown and mouseup)\n   element: null, // element being processed\n\n   ignore: false, // if true, mousedowns are ignored\n\n   mousedowncoord: \"\", // coord where mouse went down for drag range\n   mouselastcoord: \"\", // coord where mouse last was during drag\n   mouseresizecol: \"\", // col being resized\n   mouseresizeclientx: null, // where resize started\n   mouseresizedisplay: null // element tracking new size\n   }\n\n//\n// EditorMouseRegister(editor)\n//\n\nSocialCalc.EditorMouseRegister = function(editor) {\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var element = editor.fullgrid;\n   var i;\n\n   for (i=0; i<mouseinfo.registeredElements.length; i++) {\n      if (mouseinfo.registeredElements[i].editor == editor) {\n         if (mouseinfo.registeredElements[i].element == element) {\n            return; // already set - don't do it again\n            }\n         break;\n         }\n      }\n\n   if (i<mouseinfo.registeredElements.length) {\n      mouseinfo.registeredElements[i].element = element;\n      }\n   else {\n      mouseinfo.registeredElements.push({element: element, editor: editor});\n      }\n\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\n      element.addEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\n      element.addEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\n      }\n   else if (element.attachEvent) { // IE 5+\n      element.attachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\n      element.attachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\n      }\n   else { // don't handle this\n      throw \"Browser not supported\";\n      }\n\n   mouseinfo.ignore = false; // just in case\n\n   return;\n\n   }\n\n//\n// EditorMouseUnregister(editor)\n//\n\nSocialCalc.EditorMouseUnregister = function(editor) {\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var element = editor.fullgrid;\n   var i, oldelement;\n\n   for (i=0; i<mouseinfo.registeredElements.length; i++) {\n      if (mouseinfo.registeredElements[i].editor == editor) {\n         break;\n         }\n      }\n\n   if (i<mouseinfo.registeredElements.length) {\n      oldelement = mouseinfo.registeredElements[i].element; // remove old handlers\n      if (oldelement.removeEventListener) { // DOM Level 2\n         oldelement.removeEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\n         oldelement.removeEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\n         }\n      else if (oldelement.detachEvent) { // IE\n         oldelement.detachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\n         oldelement.detachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\n         }\n      mouseinfo.registeredElements.splice(i, 1);\n      }\n\n   return;\n\n   }\n\nSocialCalc.StopPropagation = function(event) {\n    if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\n    else event.cancelBubble = true; // IE 5+\n    if (event.preventDefault) event.preventDefault(); // DOM Level 2\n    else event.returnValue = false; // IE 5+\n}\n\nSocialCalc.SetMouseMoveUp = function(move, up, element, event) {\n       // Event code from JavaScript, Flanagan, 5th Edition, pg. 422\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\n      document.addEventListener(\"mousemove\", move, true); // capture everywhere\n      document.addEventListener(\"mouseup\", up, true); // capture everywhere\n      }\n   else if (element.attachEvent) { // IE 5+\n      element.setCapture();\n      element.attachEvent(\"onmousemove\", move);\n      element.attachEvent(\"onmouseup\", up);\n      element.attachEvent(\"onlosecapture\", up);\n   }\n    SocialCalc.StopPropagation(event);\n}\n\nSocialCalc.RemoveMouseMoveUp = function(move, up, element, event) {\n    SocialCalc.StopPropagation(event);\n    if (document.removeEventListener) { // DOM Level 2\n\tdocument.removeEventListener(\"mousemove\", move, true);\n\tdocument.removeEventListener(\"mouseup\", up, true);\n    }\n    else if (element.detachEvent) { // IE\n\telement.detachEvent(\"onlosecapture\", up);\n\telement.detachEvent(\"onmouseup\", up);\n\telement.detachEvent(\"onmousemove\", move);\n\telement.releaseCapture();\n    }\n}\n\nSocialCalc.ProcessEditorMouseDown = function(e) {\n\n   var editor, result, coord, textarea, wval, range;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var ele = event.target || event.srcElement; // source object is often within what we want\n   var mobj;\n\n   if (mouseinfo.ignore) return; // ignore this\n\n   for (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\n      mobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\n      }\n   if (!mobj) {\n      mouseinfo.editor = null;\n      return; // not one of our elements\n      }\n\n   editor = mobj.editor;\n   mouseinfo.element = ele;\n   range = editor.range;\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY);\n\n   if (!result) return; // not on a cell or col header\n   mouseinfo.editor = editor; // remember for later\n\n    if (result.rowheader) {\n\tif (result.rowselect)  {\n\t    SocialCalc.ProcessEditorRowselectMouseDown(e, ele, result);\n\t} else {\n\t    SocialCalc.ProcessEditorRowsizeMouseDown(e, ele, result);\n\t}\n\treturn;\n    }\n\n    if (result.colheader) {\n\tif (result.colselect)  {\n\t    SocialCalc.ProcessEditorColselectMouseDown(e, ele, result);\n\t} else {\n\t    SocialCalc.ProcessEditorColsizeMouseDown(e, ele, result);\n\t}\n\treturn;\n    }\n\n   if (!result.coord) return; // not us\n\n   if (!range.hasrange) {\n      if (e.shiftKey)\n         editor.RangeAnchor();\n      }\n   coord = editor.MoveECell(result.coord);\n   // eddy ProcessEditorMouseDown {\n   if(SocialCalc._app == true) { // \"app\" wigets need to keep focus - needed because \"coord\" always equals A1 \n     SocialCalc.CmdGotFocus(true); // cell widgets need to keep focus\n     return;\n   }\n   \n   var clickedCell = editor.context.sheetobj.cells[coord];\n   if(clickedCell) {\n     if(clickedCell.valuetype.charAt(1) == 'i') { // IF cell contains ioWidget\n        var formula_name= clickedCell.valuetype.substring(2);\t \n\t    var cell_widget=document.getElementById(formula_name+'_'+coord);\n\t\tSocialCalc.CmdGotFocus(cell_widget); // cell widgets need to keep focus \n\t\t// SocialCalc.Keyboard.FocusWidget = coord;\n\t\treturn; // let ioWidget keep the focus \n\t\t}\n\t }\n   // }\n\n   if (range.hasrange) {\n      if (e.shiftKey)\n         editor.RangeExtend();\n      else\n         editor.RangeRemove();\n      }\n\n   mouseinfo.mousedowncoord = coord; // remember if starting drag range select\n   mouseinfo.mouselastcoord = coord;\n\n   editor.EditorMouseRange(coord);\n\n   SocialCalc.KeyboardSetFocus(editor);\n   if (editor.state!=\"start\" && editor.inputBox) editor.inputBox.element.focus();\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorMouseMove,\n\t\t\t      SocialCalc.ProcessEditorMouseUp,\n\t\t\t      ele,\n\t\t\t      event);\n   return;\n\n   }\n\nSocialCalc.EditorMouseRange = function(editor, coord) {\n\n   var inputtext, wval;\n   var range = editor.range;\n\n   switch (editor.state) { // editing a cell - shouldn't get here if no inputBox\n      case \"input\":\n         inputtext = editor.inputBox.GetText();\n         wval = editor.workingvalues;\n         if ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\n             (inputtext == \"=\")) {\n            wval.partialexpr = inputtext;\n            }\n\n         if (wval.partialexpr) { // if in pointing operation\n            if (coord) {\n               if (range.hasrange) {\n                  editor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\n                     SocialCalc.crToCoord(range.right, range.bottom));\n                  }\n               else {\n                  editor.inputBox.SetText(wval.partialexpr + coord);\n                  }\n               }\n            }\n         else { // not in point -- done editing\n            editor.inputBox.Blur();\n            editor.inputBox.ShowInputBox(false);\n            editor.state = \"start\";\n            editor.cellhandles.ShowCellHandles(true);\n            editor.EditorSaveEdit();\n            editor.inputBox.DisplayCellContents(null);\n            }\n         break;\n\n      case \"inputboxdirect\":\n         editor.inputBox.Blur();\n         editor.inputBox.ShowInputBox(false);\n         editor.state = \"start\";\n         editor.cellhandles.ShowCellHandles(true);\n         editor.EditorSaveEdit();\n         editor.inputBox.DisplayCellContents(null);\n         break;\n      }\n   }\n\nSocialCalc.ProcessEditorMouseMove = function(e) {\n\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   if (mouseinfo.ignore) return; // ignore this\n   element = mouseinfo.element;\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\n\n   if (!result) return;\n\n   if (result && !result.coord) {\n      SocialCalc.SetDragAutoRepeat(editor, result);\n      return;\n      }\n\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\n   if (!result.coord) return;\n\n   if (result.coord!=mouseinfo.mouselastcoord) {\n      if (!e.shiftKey && !editor.range.hasrange) {\n         editor.RangeAnchor(mouseinfo.mousedowncoord);\n         }\n      editor.MoveECell(result.coord);\n      editor.RangeExtend();\n      }\n   mouseinfo.mouselastcoord = result.coord;\n\n   editor.EditorMouseRange(result.coord);\n   SocialCalc.StopPropagation(event); \n   return;\n   }\n\n\nSocialCalc.ProcessEditorMouseUp = function(e) {\n\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   if (mouseinfo.ignore) return; // ignore this\n   element = mouseinfo.element;\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\n\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\n   if (!result) return;\n\n   if (!result.coord) result.coord = editor.ecell.coord;\n\n   if (editor.range.hasrange) {\n      editor.MoveECell(result.coord);\n      editor.RangeExtend();\n      }\n   else if (result.coord && result.coord!=mouseinfo.mousedowncoord) {\n      editor.RangeAnchor(mouseinfo.mousedowncoord);\n      editor.MoveECell(result.coord);\n      editor.RangeExtend();\n      }\n\n   editor.EditorMouseRange(result.coord);\n   mouseinfo.editor = null;\n   SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorMouseMove,\n\t\t\t\t  SocialCalc.ProcessEditorMouseUp,\n\t\t\t\t  element,\n\t\t\t\t  event);\n   return false;\n\n   }\n\n\nSocialCalc.ProcessEditorColsizeMouseDown = function(e, ele, result) {\n\n   var event = e || window.event;\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n\n   mouseinfo.mouseresizecolnum = result.coltoresize; // remember col being resized\n   mouseinfo.mouseresizecol = SocialCalc.rcColname(result.coltoresize);\n   mouseinfo.mousedownclientx = clientX;\n   mouseinfo.mousecoltounhide = result.coltounhide;\n\n   if (result.coltoresize) {\n      var sizedisplay = document.createElement(\"div\");\n      mouseinfo.mouseresizedisplay = sizedisplay;\n      sizedisplay.style.width = \"auto\";\n      sizedisplay.style.position = \"absolute\";\n      sizedisplay.style.zIndex = 100;\n      sizedisplay.style.top = editor.headposition.top+\"px\";\n      sizedisplay.style.left = editor.colpositions[result.coltoresize]+\"px\";\n      sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\n        'border:1px dashed black;background-color:white;width:' +\n        (editor.context.colwidth[mouseinfo.mouseresizecolnum]-2) + 'px;\">&nbsp;</td>'+\n        '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\n        editor.context.colwidth[mouseinfo.mouseresizecolnum] + '</div></td></tr></table>';\n      SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\n\n      editor.toplevel.appendChild(sizedisplay);\n      }\n    SocialCalc.SetMouseMoveUp( SocialCalc.ProcessEditorColsizeMouseMove,\n\t\t\t       SocialCalc.ProcessEditorColsizeMouseUp,\n\t\t\t       editor.toplevel,\n\t\t\t       event);\n   return;\n   }\n\n\nSocialCalc.ProcessEditorColsizeMouseMove = function(e) {\n\n   var event = e || window.event;\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n\n   if (mouseinfo.mouseresizecolnum) {\n      var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n      var clientX = event.clientX - pos.left;\n\n      var newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\n      if (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\n\n      var sizedisplay = mouseinfo.mouseresizedisplay;\n//      sizedisplay.firstChild.lastChild.firstChild.childNodes[1].firstChild.innerHTML = newsize+\"\";\n//      sizedisplay.firstChild.lastChild.firstChild.childNodes[0].firstChild.style.width = (newsize-2)+\"px\";\n      sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\n          'border:1px dashed black;background-color:white;width:' + (newsize-2) + 'px;\">&nbsp;</td>'+\n          '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\n          newsize + '</div></td></tr></table>';\n      SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\n      }\n   SocialCalc.StopPropagation(event);\n   return;\n   }\n\n\nSocialCalc.ProcessEditorColsizeMouseUp = function(e) {\n\n   var event = e || window.event;\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   element = mouseinfo.element;\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   SocialCalc.RemoveMouseMoveUp(\n       SocialCalc.ProcessEditorColsizeMouseMove,\n       SocialCalc.ProcessEditorColsizeMouseUp, \n       editor.toplevel,\n       event);\n\n   if (mouseinfo.mousecoltounhide) {\n      editor.EditorScheduleSheetCommands(\"set \"+SocialCalc.rcColname(mouseinfo.mousecoltounhide)+\" hide\", true, false);\n      /*\n      if (editor.ecell && editor.ecell.col == mouseinfo.mousecoltounhide+1) {\n         editor.MoveECell(SocialCalc.crToCoord(mouseinfo.mousecoltounhide, editor.ecell.row));\n         }*/\n      }\n   else if (mouseinfo.mouseresizecolnum) {\n      var newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\n      if (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\n\n      editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizecol+\" width \"+newsize, true, false);\n\n      if (editor.timeout) window.clearTimeout(editor.timeout);\n      editor.timeout = window.setTimeout(SocialCalc.FinishColRowSize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\n      }\n\n   return false;\n\n   }\n\n\nSocialCalc.FinishColRowSize = function() {\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   if (!editor) return;\n\n   editor.toplevel.removeChild(mouseinfo.mouseresizedisplay);\n   mouseinfo.mouseresizedisplay = null;\n\n//   editor.FitToEditTable();\n//   editor.EditorRenderSheet();\n//   editor.SchedulePositionCalculations();\n\n   mouseinfo.editor = null;\n\n   return;\n\n   }\n\n\nSocialCalc.ProcessEditorRowselectMouseDown = function(e, ele, result) {\n    var event = e || window.event;\n    var mouseinfo = SocialCalc.EditorMouseInfo;\n    var editor = mouseinfo.editor;\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\n    coord1 = SocialCalc.crToCoord(1, result.row)\n    coord2 = SocialCalc.crToCoord(sheet.LastCol(),\n\t\t\t\t  result.row)\n    coord3 = SocialCalc.crToCoord(editor.firstscrollingcol,\n\t\t\t\t  result.row)\n    editor.RangeAnchor(coord1);\n    editor.RangeExtend(coord2);\n    editor.MoveECell(coord3);\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorRowselectMouseMove,\n\t\t\t      SocialCalc.ProcessEditorRowselectMouseUp,\n\t\t\t      editor.toplevel,\n\t\t\t      event);\n}\n\nSocialCalc.ProcessEditorRowselectMouseMove = function(e) {\n    var event = e || window.event;\n    var mouseinfo = SocialCalc.EditorMouseInfo;\n    var editor = mouseinfo.editor;\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\n\n    if (!editor) return; // not us, ignore\n\n    var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n    var clientX = event.clientX - pos.left;\n    var clientY = event.clientY - pos.top;\n    result = SocialCalc.GridMousePosition(editor, clientX, clientY);\n    coord2 = SocialCalc.crToCoord(sheet.LastCol(),\n\t\t\t\t  result.row)\n    coord3 = SocialCalc.crToCoord(editor.firstscrollingcol,\n\t\t\t\t  result.row)\n    editor.RangeExtend(coord2);\n    editor.MoveECell(coord3);\n    return;\n}\n\nSocialCalc.ProcessEditorRowselectMouseUp = function(e) {\n    var event = e || window.event;\n    var mouseinfo = SocialCalc.EditorMouseInfo;\n    var editor = mouseinfo.editor;\n    if (!editor) return; // not us, ignore\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorRowselectMouseMove,\n\t\t\t\t SocialCalc.ProcessEditorRowselectMouseUp,\n\t\t\t\t editor.toplevel,\n\t\t\t\t e);\n    return;\n}\n\nSocialCalc.ProcessEditorColselectMouseDown = function(e, ele, result) {\n    var event = e || window.event;\n    var mouseinfo = SocialCalc.EditorMouseInfo;\n    var editor = mouseinfo.editor;\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\n\n    coord1 = SocialCalc.crToCoord(result.col, 1)\n    coord2 = SocialCalc.crToCoord(result.col,\n\t\t\t\t  sheet.LastRow())\n    coord3 = SocialCalc.crToCoord(result.col,\n\t\t\t\t  editor.firstscrollingrow)\n    \n    editor.RangeAnchor(coord1);\n    editor.RangeExtend(coord2);\n    editor.MoveECell(coord3);\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorColselectMouseMove,\n\t\t\t      SocialCalc.ProcessEditorColselectMouseUp,\n\t\t\t      editor.toplevel,\n\t\t\t      event);\n\n}\n\nSocialCalc.ProcessEditorColselectMouseMove = function(e) {\n    var event = e || window.event;\n    var mouseinfo = SocialCalc.EditorMouseInfo;\n    var editor = mouseinfo.editor;\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\n\n    if (!editor) return; // not us, ignore\n\n    var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n    var clientX = event.clientX - pos.left;\n    var clientY = event.clientY - pos.top;\n    result = SocialCalc.GridMousePosition(editor, clientX, clientY);\n    coord2 = SocialCalc.crToCoord(result.col,\n\t\t\t\t  sheet.LastRow())\n    coord3 = SocialCalc.crToCoord(result.col,\n\t\t\t\t  editor.firstscrollingrow)\n    editor.RangeExtend(coord2);\n    editor.MoveECell(coord3);\n    return;\n}\n\nSocialCalc.ProcessEditorColselectMouseUp = function(e) {\n    var event = e || window.event;\n    var mouseinfo = SocialCalc.EditorMouseInfo;\n    var editor = mouseinfo.editor;\n    if (!editor) return; // not us, ignore\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorColselectMouseMove,\n\t\t\t\t SocialCalc.ProcessEditorColselectMouseUp,\n\t\t\t\t editor.toplevel,\n\t\t\t\t e);\n    return;\n}\n\nSocialCalc.ProcessEditorRowsizeMouseDown = function(e, ele, result) {\n\n   var event = e || window.event;\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\n   var clientY = event.clientY - pos;\n\n   mouseinfo.mouseresizerownum = result.rowtoresize; // remember col being resized\n   mouseinfo.mouseresizerow = result.rowtoresize;\n   mouseinfo.mousedownclienty = clientY;\n   mouseinfo.mouserowtounhide = result.rowtounhide;\n\n  if (result.rowtoresize) {\n    var sizedisplay = document.createElement(\"div\");\n    mouseinfo.mouseresizedisplay = sizedisplay;\n    sizedisplay.style.width = editor.context.totalwidth+\"px\";\n    sizedisplay.style.height = editor.rowpositions[result.rowtoresize]+\"px\";\n    sizedisplay.style.position = \"absolute\";\n    sizedisplay.style.zIndex = 100;\n    sizedisplay.style.top = editor.rowpositions[result.rowtoresize]+\"px\";\n    sizedisplay.style.left = editor.headposition.left+\"px\";\n    sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:100px' +\n      'border:1px dashed black;background-color:white;height:' +\n      (editor.context.rowheight[mouseinfo.mouseresizerownum]-2) + 'px;\">&nbsp;</td>'+\n      '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\n      editor.context.rowheight[mouseinfo.mouseresizerownum] + '</div></td></tr></table>';\n    SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.5;\"); // so no warning msg with Firefox about filter\n\n    editor.toplevel.appendChild(sizedisplay);\n  }\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorRowsizeMouseMove,\n\t\t\t      SocialCalc.ProcessEditorRowsizeMouseUp,\n\t\t\t      editor.toplevel,\n\t\t\t      event);\n    return;\n   }\n\n\nSocialCalc.ProcessEditorRowsizeMouseMove = function(e) {\n\n   var event = e || window.event;\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n\n  if (mouseinfo.mouseresizerownum) {\n    var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\n    var clientY = event.clientY - pos;\n\n    var newsize = (editor.context.rowheight[mouseinfo.mouseresizerownum]-0) + (clientY - mouseinfo.mousedownclienty);\n    if (newsize < SocialCalc.Constants.defaultAssumedRowHeight) newsize = SocialCalc.Constants.defaultAssumedRowHeight;\n\n    var sizedisplay = mouseinfo.mouseresizedisplay;\n    sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:100px;'+\n      'border:1px dashed black;background-color:white;height:' + (newsize-2) + 'px;\">&nbsp;</td>'+\n      '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\n      newsize + '</div></td></tr></table>';\n    SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.5;\"); // so no warning msg with Firefox about filter\n  }\n\n   SocialCalc.StopPropagation(event);\n   return;\n\n   }\n\n\nSocialCalc.ProcessEditorRowsizeMouseUp = function(e) {\n\n   var event = e || window.event;\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   element = mouseinfo.element;\n   var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\n   var clientY = event.clientY - pos;\n   SocialCalc.RemoveMouseMoveUp(\n       SocialCalc.ProcessEditorRowsizeMouseMove,\n       SocialCalc.ProcessEditorRowsizeMouseUp,\n       editor.toplevel,\n       event);\n   if (mouseinfo.mouserowtounhide) {\n      editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouserowtounhide+\" hide\", true, false);\n      }\n   else if (mouseinfo.mouseresizerownum) {\n     var newsize = (editor.context.rowheight[mouseinfo.mouseresizerownum]-0) + (clientY - mouseinfo.mousedownclienty);\n     if (newsize < SocialCalc.Constants.defaultAssumedRowHeight) newsize = SocialCalc.Constants.defaultAssumedRowHeight;\n     editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizerownum+\" height \"+newsize, true, false);\n\n     if (editor.timeout) window.clearTimeout(editor.timeout);\n     editor.timeout = window.setTimeout(SocialCalc.FinishColRowSize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\n   }\n\n   return false;\n\n   }\n\n\n//\n// Handle auto-repeat of dragging the cursor into the borders of the sheet\n//\n\nSocialCalc.AutoRepeatInfo = {\n\n   timer: null, // timer object for repeating\n   mouseinfo: null, // result from SocialCalc.GridMousePosition\n   repeatinterval: 1000, // milliseconds to wait between repeats\n   editor: null, // editor object to use when it repeats\n   repeatcallback: null // used instead of default when repeating (e.g., for cellhandles)\n                        // called as: repeatcallback(newcoord, direction)\n\n};\n\n// Control auto-repeat. If mouseinfo==null, cancel.\n\nSocialCalc.SetDragAutoRepeat = function(editor, mouseinfo, callback) {\n\n   var repeatinfo = SocialCalc.AutoRepeatInfo;\n   var coord, direction;\n\n   repeatinfo.repeatcallback = callback; // null in regular case\n\n   if (!mouseinfo) { // cancel\n      if (repeatinfo.timer) { // If was repeating, stop\n         window.clearTimeout(repeatinfo.timer); // cancel timer\n         repeatinfo.timer = null;\n         }\n      repeatinfo.mouseinfo = null;\n      return; // done\n      }\n\n   repeatinfo.editor = editor;\n\n   if (repeatinfo.mouseinfo) { // check for change while repeating\n      if (mouseinfo.rowheader || mouseinfo.rowfooter) {\n         if (mouseinfo.row != repeatinfo.mouseinfo.row) { // changed row while dragging sidewards\n            coord = SocialCalc.crToCoord(editor.ecell.col, mouseinfo.row); // change to it\n            if (repeatinfo.repeatcallback) {\n               if (mouseinfo.row < repeatinfo.mouseinfo.row) {\n                  direction = \"left\";\n                  }\n               else if (mouseinfo.row > repeatinfo.mouseinfo.row) {\n                  direction = \"right\";\n                  }\n               else {\n                  direction = \"\";\n                  }\n               repeatinfo.repeatcallback(coord, direction);\n               }\n            else {\n               editor.MoveECell(coord);\n               editor.MoveECell(coord);\n               editor.RangeExtend();\n               editor.EditorMouseRange(coord);\n               }\n            }            \n         }\n      else if (mouseinfo.colheader || mouseinfo.colfooter) {\n         if (mouseinfo.col != repeatinfo.mouseinfo.col) { // changed col while dragging vertically\n            coord = SocialCalc.crToCoord(mouseinfo.col, editor.ecell.row); // change to it\n            if (repeatinfo.repeatcallback) {\n               if (mouseinfo.row < repeatinfo.mouseinfo.row) {\n                  direction = \"left\";\n                  }\n               else if (mouseinfo.row > repeatinfo.mouseinfo.row) {\n                  direction = \"right\";\n                  }\n               else {\n                  direction = \"\";\n                  }\n               repeatinfo.repeatcallback(coord, direction);\n               }\n            else {\n               editor.MoveECell(coord);\n               editor.RangeExtend();\n               editor.EditorMouseRange(coord);\n               }\n            }            \n         }\n      }\n\n   repeatinfo.mouseinfo = mouseinfo;\n\n   if (mouseinfo.distance < 5) repeatinfo.repeatinterval = 333;\n   else if (mouseinfo.distance < 10) repeatinfo.repeatinterval = 250;\n   else if (mouseinfo.distance < 25) repeatinfo.repeatinterval = 100;\n   else if (mouseinfo.distance < 35) repeatinfo.repeatinterval = 75;\n   else { // too far - stop repeating\n      if (repeatinfo.timer) { // if repeating, cancel it\n         window.clearTimeout(repeatinfo.timer); // cancel timer\n         repeatinfo.timer = null;\n         }\n      return;\n      }\n\n   if (!repeatinfo.timer) { // start if not already running\n      repeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\n      }\n\n   return;\n\n   }\n\n//\n// DragAutoRepeat()\n//\n\nSocialCalc.DragAutoRepeat = function() {\n\n   var repeatinfo = SocialCalc.AutoRepeatInfo;\n   var mouseinfo = repeatinfo.mouseinfo;\n\n   var direction, coord, cr;\n\n   if (mouseinfo.rowheader) direction = \"left\";\n   else if (mouseinfo.rowfooter) direction = \"right\";\n   else if (mouseinfo.colheader) direction = \"up\";\n   else if (mouseinfo.colfooter) direction = \"down\";\n\n   if (repeatinfo.repeatcallback) {\n      cr = SocialCalc.coordToCr(repeatinfo.editor.ecell.coord);\n      if (direction == \"left\" && cr.col > 1) cr.col--;\n      else if (direction == \"right\") cr.col++;\n      else if (direction == \"up\" && cr.row > 1) cr.row--;\n      else if (direction == \"down\") cr.row++;\n      coord = SocialCalc.crToCoord(cr.col, cr.row);\n      repeatinfo.repeatcallback(coord, direction);\n      }\n   else {\n      coord = repeatinfo.editor.MoveECellWithKey(\"[a\"+direction+\"]shifted\");\n      if (coord) repeatinfo.editor.EditorMouseRange(coord);\n      }\n\n   repeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\n\n   }\n\n//\n// Handling Clicking\n//\n\nSocialCalc.ProcessEditorDblClick = function(e) {\n\n   var editor, result, coord, textarea, wval, range;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var ele = event.target || event.srcElement; // source object is often within what we want\n   var mobj;\n\n   if (mouseinfo.ignore) return; // ignore this\n\n   for (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\n      mobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\n      }\n   if (!mobj) {\n      mouseinfo.editor = null;\n      return; // not one of our elements\n      }\n\n   editor = mobj.editor;\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY);\n   if (!result || !result.coord) return; // not within cell area - ignore\n\n   mouseinfo.editor = editor; // remember for later\n   mouseinfo.element = ele;\n   range = editor.range;\n\n   sheetobj = editor.context.sheetobj;\n\n   switch (editor.state) {\n      case \"start\":\n         SocialCalc.EditorOpenCellEdit(editor);\n         break;\n\n      case \"input\":\n         break;\n\n      default:\n         break;\n      }\n   SocialCalc.StopPropagation(event);\n   return;\n\n   }\n\n\nSocialCalc.EditorOpenCellEdit = function(editor) {\n\n   var wval;\n\n   if (!editor.ecell) return true; // no ecell\n   if (!editor.inputBox) return true; // no input box, so no editing (happens on noEdit)\n   if (editor.inputBox.element.disabled) return true; // multi-line: ignore\n   editor.inputBox.ShowInputBox(true);\n   editor.inputBox.Focus();\n   editor.inputBox.SetText(\"\");\n   editor.inputBox.DisplayCellContents();\n   editor.inputBox.Select(\"end\");\n   wval = editor.workingvalues;\n   wval.partialexpr = \"\";\n   wval.ecoord = editor.ecell.coord;\n   wval.erow = editor.ecell.row;\n   wval.ecol = editor.ecell.col;\n\n   return;\n\n   }\n\n\nSocialCalc.EditorProcessKey = function(editor, ch, e) {\n\n   var result, cell, cellobj, valueinfo, fch, coord, inputtext, f;\n\n   var sheetobj = editor.context.sheetobj;\n   var wval = editor.workingvalues;\n   var range = editor.range;\n\n   if (typeof ch != \"string\") ch = \"\";\n\n   switch (editor.state) {\n      case \"start\":\n         if (e.shiftKey && ch.substr(0,2)==\"[a\") {\n            ch = ch + \"shifted\";\n            }\n         if (ch==\"[enter]\") ch = \"[adown]\";\n         if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\n         if (ch.substr(0,2)==\"[a\" || ch.substr(0,3)==\"[pg\" || ch==\"[home]\") {\n            result = editor.MoveECellWithKey(ch);\n            return !result;\n            }\n         if (ch==\"[del]\" || ch==\"[backspace]\") {\n            if (!editor.noEdit && !editor.ECellReadonly()) {\n               editor.EditorApplySetCommandsToRange(\"empty\", \"\");\n               }\n            break;\n            }\n         if (ch==\"[esc]\") {\n            if (range.hasrange) {\n               editor.RangeRemove();\n               editor.MoveECell(range.anchorcoord);\n               for (f in editor.StatusCallback) {\n                  editor.StatusCallback[f].func(editor, \"specialkey\", ch, editor.StatusCallback[f].params);\n                  }\n               }\n            return false;\n            }\n\n         if (ch==\"[f2]\") {\n            if (editor.noEdit || editor.ECellReadonly()) return true;\n            SocialCalc.EditorOpenCellEdit(editor);\n            editor.state=\"inputboxdirect\"; // arrow keys move left and right, rather than select cells\n            return false;\n            }\n\n         if ((ch.length>1 && ch.substr(0,1)==\"[\") || ch.length==0) { // some control key\n            if (editor.ctrlkeyFunction && ch.length>0) {\n               return editor.ctrlkeyFunction(editor, ch);\n               }\n            else {\n               return true;\n               }\n            }\n         if (!editor.ecell) return true; // no ecell\n         if (!editor.inputBox) return true; // no inputBox so no editing\n         if (editor.ECellReadonly()) return true;\n         editor.inputBox.element.disabled = false; // make sure editable\n         editor.state = \"input\";\n         editor.inputBox.ShowInputBox(true);\n         editor.inputBox.Focus();\n         editor.inputBox.SetText(ch);\n         editor.inputBox.Select(\"end\");\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.RangeRemove();\n         break;\n\n      case \"input\":\n         inputtext = editor.inputBox.GetText(); // should not get here if no inputBox\n         if (editor.inputBox.skipOne) return false; // ignore a key already handled\n         if (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\" || (ch && ch.substr(0,2)==\"[a\")) {\n            if ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\n                (inputtext == \"=\")) {\n               wval.partialexpr = inputtext;\n               }\n            if (wval.partialexpr) { // if in pointing operation\n               if (e.shiftKey && ch.substr(0,2)==\"[a\") {\n                  ch = ch + \"shifted\";\n                  }\n               coord = editor.MoveECellWithKey(ch);\n               if (coord) {\n                  if (range.hasrange) {\n                     editor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\n                        SocialCalc.crToCoord(range.right, range.bottom));\n                     }\n                  else {\n                     editor.inputBox.SetText(wval.partialexpr + coord);\n                     }\n                  return false;\n                  }\n               }\n            editor.inputBox.Blur();\n            editor.inputBox.ShowInputBox(false);\n            editor.state = \"start\";\n            editor.cellhandles.ShowCellHandles(true);\n            if (ch != \"[esc]\") {\n               editor.EditorSaveEdit();\n               if (editor.ecell.coord != wval.ecoord) {\n                  editor.MoveECell(wval.ecoord);\n                  }\n               if (ch==\"[enter]\") ch = \"[adown]\";\n               if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\n               if (ch.substr(0,2)==\"[a\") {\n                  editor.MoveECellWithKey(ch);\n                  }\n               }\n            else {\n               editor.inputBox.DisplayCellContents();\n               editor.RangeRemove();\n               editor.MoveECell(wval.ecoord);\n               }\n            break;\n            }\n         if (wval.partialexpr && ch==\"[backspace]\") {\n            editor.inputBox.SetText(wval.partialexpr);\n            wval.partialexpr = \"\";\n            editor.RangeRemove();\n            editor.MoveECell(wval.ecoord);\n            editor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\n            return false;\n            }\n         if (ch==\"[f2]\") {\n           editor.state = \"inputboxdirect\"; \n           return false;\n           }\n         if (range.hasrange) {\n            editor.RangeRemove();\n            }\n         editor.MoveECell(wval.ecoord);\n         if (wval.partialexpr) {\n            editor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\n            wval.partialexpr = \"\"; // not pointing\n            }\n         return true;\n\n      case \"inputboxdirect\":\n         inputtext = editor.inputBox.GetText(); // should not get here if no inputBox\n         if (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\") {\n            editor.inputBox.Blur();\n            editor.inputBox.ShowInputBox(false);\n            editor.state = \"start\";\n            editor.cellhandles.ShowCellHandles(true);\n            if (ch == \"[esc]\") {\n               editor.inputBox.DisplayCellContents();\n               }\n            else {\n               editor.EditorSaveEdit();\n               if (editor.ecell.coord != wval.ecoord) {\n                  editor.MoveECell(wval.ecoord);\n                  }\n               if (ch==\"[enter]\") ch = \"[adown]\";\n               if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\n               if (ch.substr(0,2)==\"[a\") {\n                  editor.MoveECellWithKey(ch);\n                  }\n               }\n            break;\n            }\n         if (ch==\"[f2]\") { \n           editor.state = \"input\"; // arrow keys add range/coord to inputbox formula\n           return false;\n           }\n         return true;\n\n      case \"skip-and-start\":\n         editor.state = \"start\";\n         editor.cellhandles.ShowCellHandles(true);\n         return false;\n\n      default:\n         return true;\n      }\n\n   return false;\n\n   }\n\nSocialCalc.EditorAddToInput = function(editor, str, prefix) {\n\n   var wval = editor.workingvalues;\n\n   if (editor.noEdit || editor.ECellReadonly()) return;\n\n   switch (editor.state) {\n      case \"start\":\n         editor.state = \"input\";\n         editor.inputBox.ShowInputBox(true);\n         editor.inputBox.element.disabled = false; // make sure editable and overwrite old\n         editor.inputBox.Focus();\n         editor.inputBox.SetText((prefix||\"\")+str);\n         editor.inputBox.Select(\"end\");\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.RangeRemove();\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.element.focus();\n         if (wval.partialexpr) {\n            editor.inputBox.SetText(wval.partialexpr);\n            wval.partialexpr = \"\";\n            editor.RangeRemove();\n            editor.MoveECell(wval.ecoord);\n            }\n         editor.inputBox.SetText(editor.inputBox.GetText()+str);\n         break;\n\n      default:\n         break;\n      }\n\n   }\n\n\nSocialCalc.EditorDisplayCellContents = function(editor) {\n\n   if (editor.inputBox) editor.inputBox.DisplayCellContents();\n\n   }\n\nSocialCalc.EditorSaveEdit = function(editor, text) {\n\n   var result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\n\n   var sheetobj = editor.context.sheetobj;\n   var wval = editor.workingvalues;\n\n   type = \"text t\";\n   value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\n\n   oldvalue = SocialCalc.GetCellContents(sheetobj, wval.ecoord)+\"\";\n   if (value == oldvalue) { // no change\n      return;\n      }\n   fch = value.charAt(0);\n   if (fch==\"=\" && value.indexOf(\"\\n\")==-1) {\n      type = \"formula\";\n      value = value.substring(1);\n      }\n   else if (fch==\"'\") {\n      type = \"text t\";\n      value = value.substring(1);\n      valueinfo = SocialCalc.DetermineValueType(value); // determine type again\n      if (valueinfo.type.charAt(0)==\"t\") {\n         type = \"text \"+valueinfo.type;\n         }\n      }\n   else if (value.length==0) {\n      type = \"empty\";\n      }\n   else {\n      valueinfo = SocialCalc.DetermineValueType(value);\n      if (valueinfo.type==\"n\" && value==(valueinfo.value+\"\")) { // see if don't need \"constant\"\n         type = \"value n\";\n         }\n      else if (valueinfo.type.charAt(0)==\"t\") {\n         type = \"text \"+valueinfo.type;\n         }\n      else if (valueinfo.type==\"\") {\n         type = \"text t\";\n         }\n      else {\n         type = \"constant \"+valueinfo.type+\" \"+valueinfo.value;\n         }\n      }\n\n   if (type.charAt(0)==\"t\") { // text\n      value = SocialCalc.encodeForSave(value); // newlines, :, and \\ are escaped\n      }\n\n   cmdline = \"set \"+wval.ecoord+\" \"+type+\" \"+value;\n   editor.EditorScheduleSheetCommands(cmdline, true, false);\n   // eddy EditorSaveEdit {\n   if(typeof sheetobj.ioEventTree === 'undefined') return;\t\n   if(typeof sheetobj.ioParameterList === 'undefined') return;\n   if(typeof sheetobj.ioEventTree[wval.ecoord] !== 'undefined') {\n\t   SocialCalc.EditedTriggerCell(sheetobj.ioEventTree[wval.ecoord], wval.ecoord, editor, sheetobj);   \t\t\n   }\n   \t\t\n   // }\n\n   return;\n\n   }\n\n\n// Eddy EditedTriggerCell {\n\n\nSocialCalc.EditedTriggerCell  = function(actionFormulaCells, editedCellRef, editor, sheet) {\n \n\t for(var actionCellId in actionFormulaCells) {\n\t\t \n\t\t\tvar parameters = sheet.ioParameterList[actionCellId];\n            if(typeof parameters === 'undefined') continue;\t\n\t\t\t\n\t\t\tswitch(parameters.function_name) {\n\t\t\t\t  case \"EMAILONEDIT\" :\n\t\t\t\t  case \"EMAILONEDITIF\" :\n\t\t\t\t\t  cmdline = \"setemailparameters \"+actionCellId+ \" \" + editedCellRef;\n\t\t\t\t\t// hold off on commands until recalc done\n\t\t\t\t      editor.deferredEmailCommands.push({cmdstr: cmdline, saveundo: false});\n//\t\t\t\t\t  editor.EditorScheduleSheetCommands(cmdline, false, false);\n\t\t\t\t\t  break;\n\t\t\t}\n\t }\n\t\n}\t\n// } Eddy EditedTriggerCell\n\n\n\n\n\n\n//\n// SocialCalc.EditorApplySetCommandsToRange(editor, cmd)\n//\n// Takes ecell or range and does a \"set\" command with cmd.\n//\n\nSocialCalc.EditorApplySetCommandsToRange = function(editor, cmd) {\n\n   var cell, row, col, line, errortext;\n\n   var sheetobj = editor.context.sheetobj;\n   var ecell = editor.ecell;\n   var range = editor.range;\n\n   if (range.hasrange) {\n      coord = SocialCalc.crToCoord(range.left, range.top)+\":\"+SocialCalc.crToCoord(range.right, range.bottom);\n      line = \"set \"+coord+\" \"+cmd;\n      errortext = editor.EditorScheduleSheetCommands(line, true, false);\n      }\n   else {\n      line = \"set \"+ecell.coord+\" \"+cmd;\n      errortext = editor.EditorScheduleSheetCommands(line, true, false);\n      }\n\n   editor.DisplayCellContents();\n\n   }\n\nSocialCalc.EditorProcessMouseWheel = function(event, delta, mousewheelinfo, wobj) {\n\n   if (wobj.functionobj.editor.busy) return; // ignore if busy\n\n   if (delta > 0) {\n      wobj.functionobj.editor.ScrollRelative(true, Math.floor(-delta * 1.5));\n      }\n   if (delta < 0) {\n      wobj.functionobj.editor.ScrollRelative(true, Math.ceil(-delta * 1.5));\n      }\n\n   }\n\n//\n// GridMousePosition(editor, clientX, clientY)\n//\n// Returns an object with row and col numbers and coord (spans handled for coords),\n// and rowheader/colheader true if in header (where coord will be undefined).\n// If in colheader, will return coltoresize if on appropriate place in col header.\n// Also, there is rowfooter (on right) and colfooter (on bottom).\n// In row/col header/footer, returns \"distance\" as pixels over the edge.\n//\n\nSocialCalc.GridMousePosition = function(editor, clientX, clientY) { \n\n   var row, rowpane, col, colpane, rowtoresize, coltoresize;\n   var result = {};\n\n   for (row=1; row<editor.rowpositions.length; row++) {\n      if (!editor.rowheight[row]) continue; // not rendered yet -- may be above or below us\n      if (editor.rowpositions[row]+editor.rowheight[row]>clientY) {\n         break;\n         }\n      }\n   for (col=1; col<editor.colpositions.length; col++) {\n      if (!editor.colwidth[col]) continue;\n      if (editor.colpositions[col]+editor.colwidth[col]>clientX) {\n         break;\n         }\n      }\n\n   result.row = row;\n   result.col = col;\n\n   if (editor.headposition) {\n      if (clientX < editor.headposition.left && clientX >= editor.gridposition.left) {\n         result.rowheader = true;\n         result.distance = editor.headposition.left - clientX;\n         result.rowtoresize = false;\n         result.rowselect = false;\n\n         // resize bar\n         for (rowtoresize=1; rowtoresize<editor.rowpositions.length; rowtoresize++) {\n            if (!editor.rowheight[rowtoresize]) continue;\n            if (((editor.rowpositions[rowtoresize] + editor.rowheight[rowtoresize]) - 3) <= clientY\n               && ((editor.rowpositions[rowtoresize] + editor.rowheight[rowtoresize]) + 3) >= clientY) {\n               result.rowtoresize = rowtoresize;\n               break;\n            }\n         }\n\n         // Handle unhide row.\n         if (unhide = editor.context.rowunhidetop[row]) {\n           pos = SocialCalc.GetElementPosition(unhide);\n           if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth\n               && clientY >= (editor.rowpositions[row] + editor.rowheight[row] - unhide.offsetHeight)\n               && clientY < (editor.rowpositions[row] + editor.rowheight[row])) {\n             result.rowtounhide = row+1;\n           }\n         }\n         if (unhide = editor.context.rowunhidebottom[row]) {\n           pos = SocialCalc.GetElementPosition(unhide);\n           if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth\n               && clientY >= (editor.rowpositions[row])\n               && clientY < (editor.rowpositions[row] + unhide.offsetHeight)) {\n             result.rowtounhide = row-1;\n           }\n         }\n         for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\n           if (result.rowtoresize >= editor.context.rowpanes[rowpane].first &&\n             result.rowtoresize <= editor.context.rowpanes[rowpane].last) { // visible column\n             return result;\n           }\n         }\n         delete result.rowtoresize;\n         result.rowselect = true;\n         return result;\n         }\n      else if (clientY < editor.headposition.top && clientY > editor.gridposition.top) { // > because of sizing row\n         result.colheader = true;\n         result.distance = editor.headposition.top - clientY;\n         result.coltoresize = false;\n\t result.colselect = false;\n\n         // resize bar\n         for (coltoresize=1; coltoresize<editor.colpositions.length; coltoresize++) {\n            if (!editor.colwidth[coltoresize]) continue;\n            if (((editor.colpositions[coltoresize] + editor.colwidth[coltoresize]) - 3) <= clientX\n               && ((editor.colpositions[coltoresize] + editor.colwidth[coltoresize]) + 3) >= clientX) {\n               result.coltoresize = coltoresize;\n               break;\n            }\n         }\n\n         // Handle unhide column.\n         if (unhide = editor.context.colunhideleft[col]) {\n            pos = SocialCalc.GetElementPosition(unhide);\n            if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth && clientY >= pos.top  && clientY < pos.top+unhide.offsetHeight) {\n               result.coltounhide = col+1;\n               }\n            }\n         if (unhide = editor.context.colunhideright[col]) {\n            pos = SocialCalc.GetElementPosition(unhide);\n            if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth && clientY >= pos.top  && clientY < pos.top+unhide.offsetHeight) {\n               result.coltounhide = col-1;\n               }\n            }\n\n         for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\n            if (result.coltoresize >= editor.context.colpanes[colpane].first &&\n                result.coltoresize <= editor.context.colpanes[colpane].last) { // visible column\n               return result;\n               }\n            }\n         delete result.coltoresize;\n         result.colselect = true;\n         return result;\n         }\n      else if (clientX >= editor.verticaltablecontrol.controlborder) {\n         result.rowfooter = true;\n         result.distance = clientX - editor.verticaltablecontrol.controlborder;\n         return result;\n         }\n      else if (clientY >= editor.horizontaltablecontrol.controlborder) {\n         result.colfooter = true;\n         result.distance = clientY - editor.horizontaltablecontrol.controlborder;\n         return result;\n         }\n      else if (clientX < editor.gridposition.left) {\n         result.rowheader = true;\n         result.distance = editor.headposition.left - clientX;\n         return result;\n         }\n      else if (clientY <= editor.gridposition.top) {\n         result.colheader = true;\n         result.distance = editor.headposition.top - clientY;\n         return result;\n         }\n      else {\n         result.coord = SocialCalc.crToCoord(result.col, result.row);\n         if (editor.context.cellskip[result.coord]) { // handle skipped cells\n            result.coord = editor.context.cellskip[result.coord];\n            }\n         return result;\n         }\n      }\n\n   return null;\n\n   }\n\n//\n// GetEditorCellElement(editor, row, col)\n//\n// Returns an object with element, the table cell element in the DOM that corresponds to row and column,\n// as well as rowpane and colpane, the panes with the cell.\n// If no such element, then returns null;\n//\n\nSocialCalc.GetEditorCellElement = function(editor, row, col) {\n\n  var headerColOffset = 0;\n  var headerRowOffset = 0;\n   //Adjust for row/col headers\n   if (editor.context.showRCHeaders == false) {     \n     var headerColOffset = -1;\n     var headerRowOffset = -1;\n   }\n   var rowpane, colpane, c, coord;\n   var rowindex = 0;\n   var colindex = 0;\n\n   for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\n      if (row >= editor.context.rowpanes[rowpane].first && row <= editor.context.rowpanes[rowpane].last) {\n         for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\n            if (col >= editor.context.colpanes[colpane].first && col <= editor.context.colpanes[colpane].last) {\n               rowindex += row - editor.context.rowpanes[rowpane].first + 2;\n               for (c=editor.context.colpanes[colpane].first; c<=col; c++) {\n                  coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\n                  if (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\n                     colindex++;\n                  }\n               return {\n                  element: editor.griddiv.firstChild.lastChild.childNodes[rowindex +headerRowOffset].childNodes[colindex + headerColOffset],\n                  rowpane: rowpane, colpane: colpane};\n               }\n            for (c=editor.context.colpanes[colpane].first; c<=editor.context.colpanes[colpane].last; c++) {\n               coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\n               if (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\n                  colindex++;\n               }\n            colindex += 1;\n            }\n         }\n      rowindex += editor.context.rowpanes[rowpane].last - editor.context.rowpanes[rowpane].first + 1 + 1;\n      }\n\n   return null;\n}\n\n//\n// cellcoord = MoveECellWithKey(editor, ch)\n//\n// Processes an arrow key, etc., moving the edit cell.\n// If not a movement key, returns null.\n//\n\nSocialCalc.MoveECellWithKey = function(editor, ch) {\n\n   var coord, row, col, cell;\n   var shifted = false;\n   var delta = 1;\n\n   if (!editor.ecell) {\n      return null;\n      }\n\n   if (ch.slice(-7)==\"shifted\") {\n      ch = ch.slice(0,-7);\n      shifted = true;\n      }\n\n   row = editor.ecell.row;\n   col = editor.ecell.col;\n   cell = editor.context.sheetobj.cells[editor.ecell.coord];\n\n   switch (ch) {\n      case \"[adown]\":\n         row += (cell && cell.rowspan) || 1;\n         break;\n      case \"[aup]\":\n         row--;\n         delta = -1;\n         break;\n      case \"[pgdn]\":\n         row += editor.pageUpDnAmount - 1 + ((cell && cell.rowspan) || 1);\n         break;\n      case \"[pgup]\":\n         row -= editor.pageUpDnAmount;\n         delta = -1;\n         break;\n      case \"[aright]\":\n         col += (cell && cell.colspan) || 1;\n         break;\n      case \"[aleft]\":\n         col--;\n         delta = -1;\n         break;\n      case \"[home]\":\n         row = 1;\n         col = 1;\n         break;\n      default:\n         return null;\n      }\n\n   // Adjust against usermax col and row.\n   if (editor.context.sheetobj.attribs.usermaxcol) col = Math.min(editor.context.sheetobj.attribs.usermaxcol, col);\n   if (editor.context.sheetobj.attribs.usermaxrow) row = Math.min(editor.context.sheetobj.attribs.usermaxrow, row);\n\n   // Handle hidden column.\n   while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\n      col += delta;\n      if (col < 1) {\n         delta = -delta;\n         col = 1;\n         }\n      }\n   \n   // Handle hidden row.\n   while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\n      row += delta;\n      if (row < 1) {\n         delta = -delta;\n         row = 1;\n         }\n      }\n   \n   if (!editor.range.hasrange) {\n      if (shifted)\n         editor.RangeAnchor();\n      }\n\n   coord = editor.MoveECell(SocialCalc.crToCoord(col, row));\n\n   if (editor.range.hasrange) {\n      if (shifted)\n         editor.RangeExtend();\n      else\n         editor.RangeRemove();\n      }\n\n   return coord;\n\n   }\n\n//\n// cellcoord = MoveECell(editor, newecell)\n//\n// Takes a coordinate and returns the new edit cell coordinate (which may be\n// different if newecell is covered by a span).\n//\n\nSocialCalc.MoveECell = function(editor, newcell) {\n\n   var cell, f;\n\n   var highlights = editor.context.highlights;\n   \n   // adjust against user max col/row\n   var ecell = SocialCalc.coordToCr(newcell);\n   if (editor.context.sheetobj.attribs.usermaxcol && ecell.col > editor.context.sheetobj.attribs.usermaxcol)\n      ecell.col = editor.context.sheetobj.attribs.usermaxcol;\n   if (editor.context.sheetobj.attribs.usermaxrow && ecell.row > editor.context.sheetobj.attribs.usermaxrow)\n      ecell.row = editor.context.sheetobj.attribs.usermaxrow;\n   newcell = SocialCalc.crToCoord(ecell.col, ecell.row);\n\n   if (editor.ecell) {\n      if (editor.ecell.coord==newcell) return newcell; // already there - don't do anything and don't tell anybody\n      cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n      delete highlights[editor.ecell.coord];\n      if (editor.range2.hasrange &&\n        editor.ecell.row>=editor.range2.top && editor.ecell.row<=editor.range2.bottom &&\n        editor.ecell.col>=editor.range2.left && editor.ecell.col<=editor.range2.right) {\n         highlights[editor.ecell.coord] = \"range2\";\n         }\n      editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\n      editor.SetECellHeaders(\"\"); // set to regular col/rowname styles\n      if(editor.cellhandles) editor.cellhandles.ShowCellHandles(false); // only if row/col visible \n      }\n   newcell = editor.context.cellskip[newcell] || newcell;\n   editor.ecell = SocialCalc.coordToCr(newcell);\n   editor.ecell.coord = newcell;\n   cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n   // eddy MoveECell {\n   // }\n   highlights[newcell] = \"cursor\";\n\n   for (f in editor.MoveECellCallback) { // let others know\n      editor.MoveECellCallback[f](editor);\n      }\n\n   editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\n   editor.SetECellHeaders(\"selected\");\n\n   for (f in editor.StatusCallback) { // let status line, etc., know\n      editor.StatusCallback[f].func(editor, \"moveecell\", newcell, editor.StatusCallback[f].params);\n      }\n\n   if (editor.busy) {\n      editor.ensureecell = true; // wait for when not busy\n      }\n   else {\n      editor.ensureecell = false;\n      editor.EnsureECellVisible();\n      }\n\n   return newcell;\n\n   }\n\nSocialCalc.EnsureECellVisible = function(editor) {\n\n   var vamount = 0;\n   var hamount = 0;\n\n   if (editor.ecell.row > editor.lastnonscrollingrow) {\n      if (editor.ecell.row < editor.firstscrollingrow) {\n         vamount = editor.ecell.row - editor.firstscrollingrow - Math.floor((editor.lastvisiblerow - editor.firstscrollingrow)/2);\n         }\n      else if (editor.ecell.row + 1 > editor.lastvisiblerow) {\n         vamount = editor.ecell.row - editor.lastvisiblerow + Math.floor((editor.lastvisiblerow - editor.firstscrollingrow)/2);\n         }\n      }   \n   if (editor.ecell.col > editor.lastnonscrollingcol) {\n      if (editor.ecell.col < editor.firstscrollingcol) {\n         hamount = editor.ecell.col - editor.firstscrollingcol - Math.floor((editor.lastvisiblecol - editor.firstscrollingcol)/2);\n         }\n      else if (editor.ecell.col + 1 > editor.lastvisiblecol) {\n        hamount = editor.ecell.col- editor.lastvisiblecol + Math.floor((editor.lastvisiblecol - editor.firstscrollingcol)/2);\n         }\n      }\n\n   if (vamount!=0 || hamount!=0) {\n      editor.ScrollRelativeBoth(vamount, hamount);\n      }\n   else {\n      editor.cellhandles.ShowCellHandles(true);\n      }\n\n   }\n\nSocialCalc.ReplaceCell = function(editor, cell, row, col) {\n\n   var newelement, a;\n   if (!cell) return;\n   newelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\n   if (newelement && cell.element) { // skip hidden cells\n      // Don't use a real element and replaceChild, which seems to have focus issues with IE, Firefox, and speed issues\n      cell.element.innerHTML = newelement.innerHTML;\n      cell.element.style.cssText = \"\";\n      cell.element.className = newelement.className;\n      for (a in newelement.style) {\n         if (newelement.style[a]!=\"cssText\")\n            cell.element.style[a] = newelement.style[a];\n         }\n      }\n   }\n\n\nSocialCalc.UpdateCellCSS = function(editor, cell, row, col) {\n\n   var newelement, a;\n   if (!cell) return;\n   newelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\n   if (newelement) {\n      cell.element.style.cssText = \"\";\n      cell.element.className = newelement.className;\n      for (a in newelement.style) {\n         if (newelement.style[a]!=\"cssText\")\n            cell.element.style[a] = newelement.style[a];\n         }\n      }\n   }\n\n\nSocialCalc.SetECellHeaders = function(editor, selected) {\n\n   // eddy SetECellHeaders {\n   if(editor.context.showRCHeaders === false) return;\n   // } SetECellHeaders\n   var ecell = editor.ecell;\n   var context = editor.context;\n\n   var rowpane, colpane, first, last;\n   var rowindex = 0;\n   var colindex = 0;\n   var headercell;\n\n   if (!ecell) return;\n\n   // Handle ecell on a hidden column/row.\n   while (context.sheetobj.colattribs.hide[SocialCalc.rcColname(ecell.col)] == \"yes\") {\n      ecell.col++;\n      }\n   while (context.sheetobj.rowattribs.hide[ecell.row] == \"yes\") {\n      ecell.row++;\n      }\n\n   ecell.coord = SocialCalc.crToCoord(ecell.col, ecell.row);\n\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\n      first = context.rowpanes[rowpane].first;\n      last = context.rowpanes[rowpane].last;\n      if (ecell.row >= first && ecell.row <= last) {\n         if (editor.fullgrid !== null) {\n            headercell = editor.fullgrid.childNodes[1].childNodes[2+rowindex+ecell.row-first].childNodes[0];\n            if (headercell) {\n               if (context.classnames) headercell.className=context.classnames[selected+\"rowname\"];\n               if (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"rowname\"];\n               headercell.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\n                                                     // considered top of row (and can't get <row> position in Safari)\n               }\n            }\n         }\n      rowindex += last - first + 1 + 1;\n      }\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      first = context.colpanes[colpane].first;\n      last = context.colpanes[colpane].last;\n      if (ecell.col >= first && ecell.col <= last) {\n         if (editor.fullgrid !== null) {\n            headercell = editor.fullgrid.childNodes[1].childNodes[1].childNodes[1+colindex+ecell.col-first];\n            if (headercell) {\n               if (context.classnames) headercell.className=context.classnames[selected+\"colname\"];\n               if (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"colname\"];\n               }\n            }\n         }\n      colindex += last - first + 1 + 1;\n      }\n   }\n\n//\n// ECellReadonly(editor, ecoord)\n//\n// Returns true if ecoord is readonly (or ecell if missing).\n//\n\nSocialCalc.ECellReadonly = function(editor, ecoord) {\n   \n   if (!ecoord && editor.ecell) {\n      ecoord = editor.ecell.coord; \n      }\n\n   if (!ecoord) return false;\n\n   var cell = editor.context.sheetobj.cells[ecoord];\n   return cell && cell.readonly;\n\n   }\n\n//\n// RangeAnchor(editor, ecoord)\n//\n// Sets the anchor of a range to ecoord (or ecell if missing).\n//\n\nSocialCalc.RangeAnchor = function(editor, ecoord) {\n\n   if (editor.range.hasrange) {\n      editor.RangeRemove();\n      }\n\n   editor.RangeExtend(ecoord);\n\n   }\n\n//\n// RangeExtend(editor, ecoord)\n//\n// Sets the other corner of the range to ecoord or, if missing, ecell.\n//\n\nSocialCalc.RangeExtend = function(editor, ecoord) {\n\n   var a, cell, cr, coord, row, col, f;\n\n   var highlights = editor.context.highlights;\n   var range = editor.range;\n   var range2 = editor.range2;\n\n   var ecell;\n   if (ecoord) {\n      ecell = SocialCalc.coordToCr(ecoord);\n      ecell.coord = ecoord;\n      }\n   else ecell = editor.ecell;\n\n   if (!ecell) return; // just in case\n\n   if (!range.hasrange) { // called without RangeAnchor...\n      range.anchorcoord = ecell.coord;\n      range.anchorrow = ecell.row;\n      range.top = ecell.row;\n      range.bottom = ecell.row;\n      range.anchorcol = ecell.col;\n      range.left = ecell.col;\n      range.right = ecell.col;\n      range.hasrange = true;\n      }\n\n   if (range.anchorrow < ecell.row) {\n      range.top = range.anchorrow;\n      range.bottom = ecell.row;\n      }\n   else {\n      range.top = ecell.row;\n      range.bottom = range.anchorrow;\n      }\n   if (range.anchorcol < ecell.col) {\n      range.left = range.anchorcol;\n      range.right = ecell.col;\n      }\n   else {\n      range.left = ecell.col;\n      range.right = range.anchorcol;\n      }\n\n   for (coord in highlights) {\n      switch (highlights[coord]) {\n         case \"range\":\n            highlights[coord] = \"unrange\";\n            break;\n         case \"range2\":\n            highlights[coord] = \"unrange2\";\n            break;\n         }\n      }\n\n   for (row=range.top; row<=range.bottom; row++) {\n      for (col=range.left; col<=range.right; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         switch (highlights[coord]) {\n            case \"unrange\":\n               highlights[coord] = \"range\";\n               break;\n            case \"cursor\":\n               break;\n            case \"unrange2\":\n            default:\n               highlights[coord] = \"newrange\";\n               break;\n            }\n         }\n      }\n\n   for (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\n      for (col=range2.left; col<=range2.right; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         switch (highlights[coord]) {\n            case \"unrange2\":\n               highlights[coord] = \"range2\";\n               break;\n            case \"range\":\n            case \"newrange\":\n            case \"cursor\":\n               break;\n            default:\n               highlights[coord] = \"newrange2\";\n               break;\n            }\n         }\n      }\n\n   for (coord in highlights) {\n\n      switch (highlights[coord]) {\n         case \"unrange\":\n            delete highlights[coord];\n            break;\n         case \"newrange\":\n            highlights[coord] = \"range\";\n            break;\n         case \"newrange2\":\n            highlights[coord] = \"range2\";\n            break;\n         case \"range\":\n         case \"range2\":\n         case \"cursor\":\n            continue;\n         }\n\n      cr = SocialCalc.coordToCr(coord);\n      cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\n\n      }\n\n   for (f in editor.RangeChangeCallback) { // let others know\n      editor.RangeChangeCallback[f](editor);\n      }\n\n   // create range/coord string and do status callback\n\n   coord = SocialCalc.crToCoord(editor.range.left, editor.range.top);\n   if (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom) { // more than one cell\n      coord += \":\" + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      }\n   for (f in editor.StatusCallback) {\n      editor.StatusCallback[f].func(editor, \"rangechange\", coord, editor.StatusCallback[f].params);\n      }\n\n   return;\n\n   }\n\n//\n// RangeRemove(editor)\n//\n// Turns off the range.\n//\n\nSocialCalc.RangeRemove = function(editor) {\n\n   var cell, cr, coord, row, col, f;\n\n   var highlights = editor.context.highlights;\n   var range = editor.range;\n   var range2 = editor.range2;\n\n   if (!range.hasrange && !range2.hasrange) return;\n\n   for (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\n      for (col=range2.left; col<=range2.right; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         switch (highlights[coord]) {\n            case \"range\":\n               highlights[coord] = \"newrange2\";\n               break;\n            case \"range2\":\n            case \"cursor\":\n               break;\n            default:\n               highlights[coord] = \"newrange2\";\n               break;\n            }\n         }\n      }\n\n   for (coord in highlights) {\n      switch (highlights[coord]) {\n         case \"range\":\n            delete highlights[coord];\n            break;\n         case \"newrange2\":\n            highlights[coord] = \"range2\";\n            break;\n         case \"cursor\":\n            continue;\n         }\n      cr = SocialCalc.coordToCr(coord);\n      cell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\n      }\n\n   range.hasrange = false;\n\n   for (f in editor.RangeChangeCallback) { // let others know\n      editor.RangeChangeCallback[f](editor);\n      }\n\n   for (f in editor.StatusCallback) {\n      editor.StatusCallback[f].func(editor, \"rangechange\", \"\", editor.StatusCallback[f].params);\n      }\n\n   return;\n\n   }\n\n//\n// Range2Remove(editor)\n//\n// Turns off the range2.\n//\n\nSocialCalc.Range2Remove = function(editor) {\n\n   var cell, cr, coord, row, col, f;\n\n   var highlights = editor.context.highlights;\n   var range2 = editor.range2;\n\n   if (!range2.hasrange) return;\n\n   for (coord in highlights) {\n      switch (highlights[coord]) {\n         case \"range2\":\n            delete highlights[coord];\n            break;\n         case \"range\":\n         case \"cursor\":\n            continue;\n         }\n      cr = SocialCalc.coordToCr(coord);\n      cell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\n      }\n\n   range2.hasrange = false;\n\n   return;\n\n   }\n\n//\n// FitToEditTable(editor)\n//\n// Figure out (through column width declarations and approximation of pixels per row)\n// how many rendered rows and columns you need to be at least a little larger than\n// the editor's editing area.\n//\n\nSocialCalc.FitToEditTable = function(editor) {\n\n   var colnum, colname, colwidth, totalwidth, totalrows, rownum, rowpane, needed;\n\n   var context=editor.context;\n   var sheetobj=context.sheetobj;\n   var sheetcolattribs=sheetobj.colattribs;\n\n   // Calculate column width data\n\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\n   for (colpane=0; colpane<context.colpanes.length-1; colpane++) { // Get width of all but last pane\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         colname=SocialCalc.rcColname(colnum);\n         if (sheetobj.colattribs.hide[colname] != \"yes\") {\n            colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\n            if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\n            totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\n            }\n         }\n      }\n\n   for (colnum=context.colpanes[colpane].first; colnum<=10000; colnum++) { //!!! max for safety, but makes that col max!!!\n      colname=SocialCalc.rcColname(colnum);\n      if (sheetobj.colattribs.hide[colname] != \"yes\") {\n         colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\n         if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\n         totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\n         }\n      if (totalwidth > editor.tablewidth) break;\n      }\n\n   context.colpanes[colpane].last = context.sheetobj.attribs.usermaxcol || colnum;\n\n   // Calculate row height data\n\n   totalrows=context.showRCHeaders ? 1 : 0;\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) { // count all panes but last one\n      totalrows += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 1;\n      for (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\n         if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\n            totalrows--;\n            }\n         }\n      }\n\n   needed = editor.tableheight - totalrows * context.pixelsPerRow; // estimate amount needed\n\n   context.rowpanes[rowpane].last = context.sheetobj.attribs.usermaxrow || context.rowpanes[rowpane].first + Math.floor(needed / context.pixelsPerRow) + 1;\n\n   }\n\n//\n// CalculateEditorPositions(editor)\n//\n// Calculate the screen positions and other values of various editing elements\n// These values change and need to be recomputed when the pane first/last or cell contents change,\n// as well as new column widths, etc.\n//\n// Note: Only call this after the grid has been rendered! You may have to wait for a timeout...\n//\n\nSocialCalc.CalculateEditorPositions = function(editor) {\n\n   var rowpane, colpane, i;\n\n   editor.gridposition = SocialCalc.GetElementPosition(editor.griddiv);\n   \n   var element = editor.griddiv.firstChild.lastChild.childNodes[1].childNodes[0]; // 2nd tr 1st td\n   editor.headposition = SocialCalc.GetElementPosition(element);\n   editor.headposition.left += element.offsetWidth;\n   editor.headposition.top += element.offsetHeight;\n\n   editor.rowpositions = [];\n   for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\n      editor.CalculateRowPositions(rowpane, editor.rowpositions, editor.rowheight);\n      }\n   for (i=0; i<editor.rowpositions.length; i++) {\n      if (editor.rowpositions[i]>editor.gridposition.top+editor.tableheight) break;\n      }\n   editor.lastvisiblerow = i-1;\n\n   editor.colpositions = [];\n   for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\n      editor.CalculateColPositions(colpane, editor.colpositions, editor.colwidth);\n      }\n   for (i=0; i<editor.colpositions.length; i++) {\n      if (editor.colpositions[i]>editor.gridposition.left+editor.tablewidth) break;\n      }\n   editor.lastvisiblecol = i-1;\n\n   editor.firstscrollingrow = editor.context.rowpanes[editor.context.rowpanes.length-1].first;\n   while (editor.context.sheetobj.rowattribs.hide[editor.firstscrollingrow] == \"yes\") {\n      editor.firstscrollingrow++;\n      }\n   editor.firstscrollingrowtop = editor.rowpositions[editor.firstscrollingrow] || editor.headposition.top;\n   editor.lastnonscrollingrow = editor.context.rowpanes.length-1 > 0 ?\n         editor.context.rowpanes[editor.context.rowpanes.length-2].last : 0;\n   editor.firstscrollingcol = editor.context.colpanes[editor.context.colpanes.length-1].first;\n   while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(editor.firstscrollingcol)] == \"yes\") {\n      editor.firstscrollingcol++;\n      }\n   editor.firstscrollingcolleft = editor.colpositions[editor.firstscrollingcol] || editor.headposition.left;\n   editor.lastnonscrollingcol = editor.context.colpanes.length-1 > 0 ?\n         editor.context.colpanes[editor.context.colpanes.length-2].last : 0;\n\n   // Now do the table controls\n\n   editor.verticaltablecontrol.ComputeTableControlPositions();\n   editor.horizontaltablecontrol.ComputeTableControlPositions();\n   }\n\n//\n// ScheduleRender(editor)\n//\n// Do a series of timeouts to render the sheet, wait for background layout and\n// rendering by the browser, and then update editor visuals, sliders, etc.\n//\n\nSocialCalc.ScheduleRender = function(editor) {\n\n   if (editor.timeout) window.clearTimeout(editor.timeout); // in case called more than once, just use latest\n\n   SocialCalc.EditorSheetStatusCallback(null, \"schedrender\", null, editor);\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoRenderStep(editor); }, 1);\n\n   }\n\n// DoRenderStep(editor)\n//\n\nSocialCalc.DoRenderStep = function(editor) {\n\n   editor.timeout = null;\n\n   editor.EditorRenderSheet();\n\n   SocialCalc.EditorSheetStatusCallback(null, \"renderdone\", null, editor);\n\n   SocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\n\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoPositionCalculations(editor); }, 1);\n\n   }\n\n//\n// SocialCalc.SchedulePositionCalculations(editor)\n//\n\nSocialCalc.SchedulePositionCalculations = function(editor) {\n\n   SocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\n\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoPositionCalculations(editor); }, 1);\n\n   }\n\n// DoPositionCalculations(editor)\n//\n// Update editor visuals, sliders, etc.\n//\n// Note: Only call this after the DOM objects have been modified and rendered!\n//\n\nSocialCalc.DoPositionCalculations = function(editor) {\n\n   editor.timeout = null;\n\n   editor.CalculateEditorPositions();\n   editor.verticaltablecontrol.PositionTableControlElements();\n   editor.horizontaltablecontrol.PositionTableControlElements();\n\n   SocialCalc.EditorSheetStatusCallback(null, \"doneposcalc\", null, editor);\n\n   if (editor.ensureecell && editor.ecell && !editor.deferredCommands.length) { // don't do if deferred cmd to execute\n      editor.ensureecell = false;\n      editor.EnsureECellVisible(); // this could cause another redisplay\n      }\n\n   editor.cellhandles.ShowCellHandles(true);\n\n\n//!!! Need to now check to see if this positioned controls out of the editing area\n//!!! (such as when there is a large wrapped cell and it pushes the pane boundary too far down).\n\n   }\n\nSocialCalc.CalculateRowPositions = function(editor, panenum, positions, sizes) {\n\n   var toprow, rowpane, rownum, offset, trowobj, cellposition;\n\n   var context=editor.context;\n   var sheetobj=context.sheetobj;\n\n   var tbodyobj;\n\n   // eddy CalculateRowPositions {\n//   if (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\n   if (!context.showRCHeaders) return;\n   // } CalculateRowPositions\n   \n   tbodyobj=editor.fullgrid.lastChild;\n\n   // Calculate start of this pane as row in this table:\n\n   toprow = 2;\n   for (rowpane=0; rowpane<panenum; rowpane++) {\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\n      }\n\n   offset = 0;\n   for (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\n      trowobj = tbodyobj.childNodes[toprow+offset];\n      offset++;\n      if (!trowobj) { continue; }\n\n      if (!positions[rownum]) {\n         positions[rownum] = trowobj.firstChild.offsetTop;\n         sizes[rownum] = trowobj.firstChild.offsetHeight;\n         }\n      }\n\n   return;\n\n   }\n\nSocialCalc.CalculateColPositions = function(editor, panenum, positions, sizes) {\n\n   var leftcol, colpane, colnum, offset, trowobj, cellposition;\n\n   var context=editor.context;\n   var sheetobj=context.sheetobj;\n\n   var tbodyobj;\n\n   // eddy CalculateColPositions {\n   // if (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\n   if (!context.showRCHeaders) return;\n   // } CalculateColPositions\n\n   tbodyobj=editor.fullgrid.lastChild;\n\n   // Calculate start of this pane as column in this table:\n\n   leftcol = 1;\n   for (colpane=0; colpane<panenum; colpane++) {\n      leftcol += context.colpanes[colpane].last - context.colpanes[colpane].first + 2; // skip pane and spacing col\n      }\n\n   trowobj = tbodyobj.childNodes[1]; // get heading row, which has all columns\n   offset = 0;\n   for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n      cellposition = SocialCalc.GetElementPosition(trowobj.childNodes[leftcol+offset]);\n      if (!positions[colnum]) {\n         positions[colnum] = cellposition.left; // first one takes precedence\n         if (trowobj.childNodes[leftcol+offset]) {\n            sizes[colnum] = trowobj.childNodes[leftcol+offset].offsetWidth;\n            }\n         }\n      offset++;\n      }\n\n   return;\n\n   }\n\n\n// ScrollRelative(editor, vertical, amount)\n//\n// If vertical true, scrolls up(-)/down(+), else left(-)/right(+)\n\nSocialCalc.ScrollRelative = function(editor, vertical, amount) {\n\n   if (vertical) {\n      editor.ScrollRelativeBoth(amount, 0);\n      }\n   else {\n      editor.ScrollRelativeBoth(0, amount);\n      }\n   return;\n\n   }\n\n// ScrollRelativeBoth(editor, vamount, hamount)\n//\n// Does both with one render\n\nSocialCalc.ScrollRelativeBoth = function(editor, vamount, hamount) {\n\n   var context=editor.context;\n   var dv = vamount > 0 ? 1 : -1, dh = hamount > 0 ? 1 : -1;\n\n   var vplen=context.rowpanes.length;\n   var vlimit = vplen>1 ? context.rowpanes[vplen-2].last+1 : 1; // don't scroll past here\n   if (context.rowpanes[vplen-1].first+vamount < vlimit) { // limit amount\n      vamount = (-context.rowpanes[vplen-1].first) + vlimit;\n      }\n\n   var hplen=context.colpanes.length;\n   var hlimit = hplen>1 ? context.colpanes[hplen-2].last+1 : 1; // don't scroll past here\n   if (context.colpanes[hplen-1].first+hamount < hlimit) { // limit amount\n      hamount = (-context.colpanes[hplen-1].first) + hlimit;\n      }\n\n   // Handle hidden column by finding a next one that's not hidden.\n   while (context.sheetobj.colattribs.hide[SocialCalc.rcColname(context.colpanes[hplen-1].first+hamount)] == \"yes\") {\n      hamount += dh;\n      if (hamount < 1) {\n         hamount = 0;\n         break;\n         }\n      }\n\n   // Handle hidden row by finding a next one that's not hidden.\n   while (context.sheetobj.rowattribs.hide[context.rowpanes[vplen-1].first+vamount] == \"yes\") {\n      vamount += dv;\n      if (vamount < 1) {\n         vamount = 0;\n         break;\n         }\n      }\n\n   if ((vamount==1 || vamount==-1) && hamount==0) { // special case quick scrolls\n      if (vamount==1) {\n         editor.ScrollTableUpOneRow();\n         }\n      else {\n         editor.ScrollTableDownOneRow();\n         }\n      if (editor.ecell) editor.SetECellHeaders(\"selected\");\n      editor.SchedulePositionCalculations();\n      return;\n      }\n\n   // Do a gross move and render\n\n   if (vamount!=0 || hamount!=0) {\n      context.rowpanes[vplen-1].first += vamount;\n      context.rowpanes[vplen-1].last += vamount;\n      context.colpanes[hplen-1].first += hamount;\n      context.colpanes[hplen-1].last += hamount;\n      editor.LimitLastPanes();\n      editor.FitToEditTable();\n      editor.ScheduleRender();\n      }\n\n   }\n\n\n// PageRelative(editor, vertical, direction)\n//\n// If vertical true, pages up(direction is -)/down(+), else left(-)/right(+)\n\nSocialCalc.PageRelative = function(editor, vertical, direction) {\n\n   var context=editor.context;\n   var panes=vertical ? \"rowpanes\" : \"colpanes\";\n   var lastpane=context[panes][context[panes].length-1];\n   var lastvisible=vertical ? \"lastvisiblerow\" : \"lastvisiblecol\";\n   var sizearray=vertical ? editor.rowheight : editor.colwidth;\n   var defaultsize=vertical ? SocialCalc.Constants.defaultAssumedRowHeight : SocialCalc.Constants.defaultColWidth;\n   var size, newfirst, totalsize, current;\n\n   if (direction > 0) { // down/right\n      newfirst = editor[lastvisible];\n      if (newfirst == lastpane.first) newfirst += 1; // move at least one\n      }\n   else {\n      if (vertical) { // calculate amount to scroll\n         totalsize = editor.tableheight - (editor.firstscrollingrowtop - editor.gridposition.top);\n         }\n      else {\n         totalsize = editor.tablewidth - (editor.firstscrollingcolleft - editor.gridposition.left);\n         }\n      totalsize -= sizearray[editor[lastvisible]] > 0 ? sizearray[editor[lastvisible]] : defaultsize;\n\n      for (newfirst=lastpane.first-1; newfirst>0; newfirst--) {\n         size = sizearray[newfirst] > 0 ? sizearray[newfirst] : defaultsize;\n         if (totalsize < size) break;\n         totalsize -= size;\n         }\n\n      current = lastpane.first;\n      if (newfirst >= current) newfirst = current-1; // move at least 1\n      if (newfirst < 1) newfirst = 1;\n      }\n\n   lastpane.first = newfirst;\n   lastpane.last = newfirst+1;\n   editor.LimitLastPanes();\n   editor.FitToEditTable();\n   editor.ScheduleRender();\n\n   }\n\n// LimitLastPanes(editor)\n//\n// Makes sure that the \"first\" of the last panes isn't before the last of the previous pane\n//\n\nSocialCalc.LimitLastPanes = function(editor) {\n\n   var context=editor.context;\n   var plen;\n\n   plen = context.rowpanes.length;\n   if (plen>1 && context.rowpanes[plen-1].first <= context.rowpanes[plen-2].last)\n       context.rowpanes[plen-1].first = context.rowpanes[plen-2].last+1;\n   if (context.sheetobj.attribs.usermaxrow && context.rowpanes[plen-1].first > context.sheetobj.attribs.usermaxrow)\n       context.rowpanes[plen-1].first = context.sheetobj.attribs.usermaxrow;\n\n   plen = context.colpanes.length;\n   if (plen>1 && context.colpanes[plen-1].first <= context.colpanes[plen-2].last)\n       context.colpanes[plen-1].first = context.colpanes[plen-2].last+1;\n   if (context.sheetobj.attribs.usermaxcol && context.colpanes[plen-1].first > context.sheetobj.attribs.usermaxcol)\n       context.colpanes[plen-1].first = context.sheetobj.attribs.usermaxcol;\n\n   }\n\nSocialCalc.ScrollTableUpOneRow = function(editor) {\n\n   var toprow, rowpane, rownum, colnum, colpane, cell, oldrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\n   var rowneedsrefresh={};\n\n   var context=editor.context;\n   var sheetobj=context.sheetobj;\n   var tableobj=editor.fullgrid;\n\n   var tbodyobj;\n\n   tbodyobj=tableobj.lastChild;\n\n   toprow = context.showRCHeaders ? 2 : 1;\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\n      }\n\n   // abort if scrolling beyond user max row\n   if (context.sheetobj.attribs.usermaxrow && (context.sheetobj.attribs.usermaxrow - context.rowpanes[rowpane].first < 1)) {\n      return tableobj;\n      }\n  \n   tbodyobj.removeChild(tbodyobj.childNodes[toprow]);\n\n   context.rowpanes[rowpane].first++;\n   context.rowpanes[rowpane].last++;\n   editor.FitToEditTable();\n   context.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\n\n   if (!context.sheetobj.attribs.usermaxrow || context.rowpanes[rowpane].last != context.sheetobj.attribs.usermaxrow) {\n      newbottomrow = context.RenderRow(context.rowpanes[rowpane].last, rowpane);\n      tbodyobj.appendChild(newbottomrow);\n      }\n\n   // if scrolled off a row with starting rowspans, replace rows for the largest rowspan\n\n   maxrowspan = 1;\n   oldrownum=context.rowpanes[rowpane].first - 1;\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         coord=SocialCalc.crToCoord(colnum, oldrownum);\n         if (context.cellskip[coord]) continue;\n         cell=sheetobj.cells[coord];\n         if (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\n         }\n      }\n\n   if (maxrowspan>1) {\n      for (rownum=1; rownum<maxrowspan; rownum++) {\n         if (rownum+oldrownum >= context.rowpanes[rowpane].last) break;\n         newrow=context.RenderRow(rownum+oldrownum, rowpane);\n         oldchild=tbodyobj.childNodes[toprow+rownum-1];\n         tbodyobj.replaceChild(newrow,oldchild);\n         }\n      }\n\n   // if added a row that includes rowspans from above, update the size of those to include new row\n\n   bottomrownum=context.rowpanes[rowpane].last;\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         coord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\n         if (!coord) continue; // only look at spanned cells\n         rownum=context.coordToCR[coord].row-0;\n         if (rownum==context.rowpanes[rowpane].last ||\n             rownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\n         cell=sheetobj.cells[coord];\n         if (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\n         }\n      }\n\n   for (rownum in rowneedsrefresh) {\n      newrow=context.RenderRow(rownum, rowpane);\n      oldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\n      tbodyobj.replaceChild(newrow,oldchild);\n      }\n\n   return tableobj;\n   }\n\nSocialCalc.ScrollTableDownOneRow = function(editor) {\n\n   var toprow, rowpane, rownum, colnum, colpane, cell, newrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\n   var rowneedsrefresh={};\n\n   var context=editor.context;\n   var sheetobj=context.sheetobj;\n   var tableobj=editor.fullgrid;\n\n   var tbodyobj;\n\n   tbodyobj=tableobj.lastChild;\n\n   toprow = context.showRCHeaders ? 2 : 1;\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\n      }\n\n   if (!context.sheetobj.attribs.usermaxrow) {\n      tbodyobj.removeChild(tbodyobj.childNodes[toprow+(context.rowpanes[rowpane].last-context.rowpanes[rowpane].first)]);\n      }\n\n   context.rowpanes[rowpane].first--;\n   context.rowpanes[rowpane].last--;\n   editor.FitToEditTable();\n   context.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\n\n   newrow = context.RenderRow(context.rowpanes[rowpane].first, rowpane);\n   tbodyobj.insertBefore(newrow, tbodyobj.childNodes[toprow]);\n\n   // if inserted a row with starting rowspans, replace rows for the largest rowspan\n\n   maxrowspan = 1;\n   newrownum=context.rowpanes[rowpane].first;\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         coord=SocialCalc.crToCoord(colnum, newrownum);\n         if (context.cellskip[coord]) continue;\n         cell=sheetobj.cells[coord];\n         if (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\n         }\n      }\n\n   if (maxrowspan>1) {\n      for (rownum=1; rownum<maxrowspan; rownum++) {\n         if (rownum+newrownum > context.rowpanes[rowpane].last) break;\n         newrow=context.RenderRow(rownum+newrownum, rowpane);\n         oldchild=tbodyobj.childNodes[toprow+rownum];\n         tbodyobj.replaceChild(newrow,oldchild);\n         }\n      }\n\n   // if last row now includes rowspans or rowspans from above, update the size of those to remove deleted row\n\n   bottomrownum=context.rowpanes[rowpane].last;\n\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\n         coord=SocialCalc.crToCoord(colnum, bottomrownum);\n         cell=sheetobj.cells[coord];\n         if (cell && cell.rowspan>1) {\n            rowneedsrefresh[bottomrownum]=true; // need to update this row\n            continue;\n            }\n         coord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\n         if (!coord) continue; // only look at spanned cells\n         rownum=context.coordToCR[coord].row-0;\n         if (rownum==bottomrownum ||\n             rownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\n         cell=sheetobj.cells[coord];\n         if (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\n         }\n      }\n\n   for (rownum in rowneedsrefresh) {\n      newrow=context.RenderRow(rownum, rowpane);\n      oldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\n      tbodyobj.replaceChild(newrow,oldchild);\n      }\n\n   return tableobj;\n   }\n\n\n// *************************************\n//\n// InputBox class:\n//\n// This class deals with the text box for editing cell contents.\n// It mainly controls a user input box for typed content and is used to interact with\n// the keyboard code, etc.\n//\n// You can use this inside a formula bar control of some sort.\n// You create this after you have created a table editor object (but not necessarily \n// done the CreateTableEditor method).\n//\n// When the user starts typing text, or double-clicks on a cell, this object\n// comes into play.\n//\n// The element given when this is first constructed should be an input HTMLElement or\n// something that acts like one. Check the code here to see what is done to it.\n//\n// *************************************\n\nSocialCalc.InputBox = function(element, editor) {\n\n   if (!element) return; // invoked without enough data to work\n\n   this.element = element; // the input element associated with this InputBox\n   this.editor = editor; // the TableEditor this belongs to\n   this.inputEcho = null;\n\n   editor.inputBox = this;\n\n   element.onmousedown = SocialCalc.InputBoxOnMouseDown;\n\n   editor.MoveECellCallback.formulabar = function(e){\n      if (e.state!=\"start\") return; // if not in normal keyboard mode don't replace formula bar\n      editor.inputBox.DisplayCellContents(e.ecell.coord);\n      };\n   }\n\n\n// Methods:\n\nSocialCalc.InputBox.prototype.DisplayCellContents = function(coord) {SocialCalc.InputBoxDisplayCellContents(this, coord);};\nSocialCalc.InputBox.prototype.ShowInputBox = function(show) {this.editor.inputEcho.ShowInputEcho(show);};\nSocialCalc.InputBox.prototype.GetText = function() {return this.element.value;};\nSocialCalc.InputBox.prototype.SetText = function(newtext) {\n   if (!this.element) return;\n   this.element.value=newtext;\n   this.editor.inputEcho.SetText(newtext+\"_\");\n   };\nSocialCalc.InputBox.prototype.Focus = function() {SocialCalc.InputBoxFocus(this);};\nSocialCalc.InputBox.prototype.Blur = function() {return this.element.blur();};\nSocialCalc.InputBox.prototype.Select = function(t) {\n   if (!this.element) return;\n   switch (t) {\n      case \"end\":\n         if (document.selection && document.selection.createRange) {\n            /* IE 4+ - Safer than setting .selectionEnd as it also works for Textareas. */\n            try {\n               var range = document.selection.createRange().duplicate();\n               range.moveToElementText(this.element);\n               range.collapse(false);\n               range.select();\n            }\n            catch (e) {\n               if (this.element.selectionStart!=undefined) {\n                  this.element.selectionStart=this.element.value.length;\n                  this.element.selectionEnd=this.element.value.length;\n               }\n            }\n         } else if (this.element.selectionStart!=undefined) {\n            this.element.selectionStart=this.element.value.length;\n            this.element.selectionEnd=this.element.value.length;\n         }\n         break;\n      }\n   };\n\n// Functions:\n\n//\n// SocialCalc.InputBoxDisplayCellContents(inputbox, coord)\n//\n// Sets input box to the contents of the specified cell (or ecell if null).\n//\n\nSocialCalc.InputBoxDisplayCellContents = function(inputbox, coord) {\n\n   var scc = SocialCalc.Constants;\n\n   if (!inputbox) return;\n   if (!coord) {\n     if (!inputbox.editor) return; // not initialized yet\n     if (!inputbox.editor.ecell) return; // not initialized yet\n     coord = inputbox.editor.ecell.coord;\n   }\n   var text = SocialCalc.GetCellContents(inputbox.editor.context.sheetobj, coord);\n   if (text.indexOf(\"\\n\")!=-1) {\n      text = scc.s_inputboxdisplaymultilinetext;\n      inputbox.element.disabled = true;\n      }\n   else if (inputbox.editor.ECellReadonly()) {\n      inputbox.element.disabled = true;\n      }\n   else {\n      inputbox.element.disabled = false;\n      }\n   inputbox.SetText(text);\n\n   }\n\n//\n// SocialCalc.InputBoxFocus(inputbox)\n//\n// Call this to have the input box get the focus and respond to keystrokes\n// but still pass them off to SocialCalc.ProcessKey.\n//\n\nSocialCalc.InputBoxFocus = function(inputbox) {\n\n   if (!inputbox) return;\n   inputbox.element.focus();\n   var editor = inputbox.editor;\n   editor.state = \"input\";\n   var wval = editor.workingvalues;\n   wval.partialexpr = \"\";\n   wval.ecoord = editor.ecell.coord;\n   wval.erow = editor.ecell.row;\n   wval.ecol = editor.ecell.col;\n\n   };\n\n//\n// SocialCalc.InputBoxOnMouseDown(e)\n//\n// This is called when the input box gets the focus. It then responds to keystrokes\n// and pass them off to SocialCalc.ProcessKey, but in a different editing state.\n//\n\nSocialCalc.InputBoxOnMouseDown = function(e) {\n\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n   if (!editor) return true; // we're not handling it -- let browser do default\n   var wval = editor.workingvalues;\n\n   switch (editor.state) {\n      case \"start\":\n         editor.state=\"inputboxdirect\";\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.inputEcho.ShowInputEcho(true);\n         break;\n\n      case \"input\":\n         wval.partialexpr = \"\"; // make sure not pointing\n         editor.MoveECell(wval.ecoord);\n         editor.state=\"inputboxdirect\";\n         SocialCalc.KeyboardFocus(); // may have come here from outside of grid\n         break;\n\n      case \"inputboxdirect\":\n         break;\n      }\n   }\n\n\n// *************************************\n//\n// InputEcho class:\n//\n// This object creates and controls an element that echos what's in the InputBox during editing\n// It is draggable.\n//\n// *************************************\n\nSocialCalc.InputEcho = function(editor) {\n\n   var scc = SocialCalc.Constants;\n\n   this.editor = editor; // the TableEditor this belongs to\n   this.text = \"\"; // current value of what is displayed\n   this.interval = null; // timer handle\n\n   this.container = null; // element containing main echo as well as prompt line\n   this.main = null; // main echo area\n   this.prompt = null;\n   this.hint = null; // focus cell hint area\n\n   this.functionbox = null; // function chooser dialog\n\n   this.container = document.createElement(\"div\");\n   SocialCalc.setStyles(this.container, \"display:none;position:absolute;zIndex:10;\");\n\n   this.main = document.createElement(\"div\");\n   if (scc.defaultInputEchoClass) this.main.className = scc.defaultInputEchoClass;\n   if (scc.defaultInputEchoStyle) SocialCalc.setStyles(this.main, scc.defaultInputEchoStyle);\n   this.main.innerHTML = \"&nbsp;\";\n\n   this.hint = document.createElement(\"div\");\n   if (scc.defaultInputEchoHintClass) this.hint.className = scc.defaultInputEchoHintClass;\n   if (scc.defaultInputEchoHintStyle) SocialCalc.setStyles(this.hint, scc.defaultInputEchoHintStyle);\n   this.hint.innerHTML = \"\";\n\n   this.container.appendChild(this.hint);\n   this.container.appendChild(this.main);\n\n   this.prompt = document.createElement(\"div\");\n   if (scc.defaultInputEchoPromptClass) this.prompt.className = scc.defaultInputEchoPromptClass;\n   if (scc.defaultInputEchoPromptStyle) SocialCalc.setStyles(this.prompt, scc.defaultInputEchoPromptStyle);\n   this.prompt.innerHTML = \"\";\n\n   this.container.appendChild(this.prompt);\n\n   SocialCalc.DragRegister(this.main, true, true, \n                 {MouseDown: SocialCalc.DragFunctionStart, \n                  MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: this.container},\n                  this.editor.toplevel);\n\n   editor.toplevel.appendChild(this.container);\n\n   }\n\n// Methods:\n\nSocialCalc.InputEcho.prototype.ShowInputEcho = function(show) {return SocialCalc.ShowInputEcho(this, show);};\nSocialCalc.InputEcho.prototype.SetText = function(str) {return SocialCalc.SetInputEchoText(this, str);};\n\n// Functions:\n\nSocialCalc.ShowInputEcho = function(inputecho, show) {\n\n   var cell, position;\n   var editor = inputecho.editor;\n\n   if (!editor) return;\n\n   if (show) {\n      editor.cellhandles.ShowCellHandles(false);\n      cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\n      if (cell) {\n         position = SocialCalc.GetElementPosition(cell.element);\n         inputecho.container.style.left = (position.left-1)+\"px\";\n         inputecho.container.style.top = (position.top-1)+\"px\";\n         }\n      inputecho.hint.innerHTML = editor.ecell.coord;\n      inputecho.container.style.display = \"block\";\n      if (inputecho.interval) window.clearInterval(inputecho.interval); // just in case\n      inputecho.interval = window.setInterval(SocialCalc.InputEchoHeartbeat, 50);\n      }\n   else {\n      if (inputecho.interval) window.clearInterval(inputecho.interval);\n      inputecho.container.style.display = \"none\";\n      }\n\n   }\n\nSocialCalc.SetInputEchoText = function(inputecho, str) {\n\n   var scc = SocialCalc.Constants;\n   var fname, fstr;\n   var newstr = SocialCalc.special_chars(str);\n   newstr = newstr.replace(/\\n/g,\"<br>\");\n\n   if (inputecho.text != newstr) {\n      inputecho.main.innerHTML = newstr;\n      inputecho.text = newstr;\n      }\n\n   var parts = str.match(/.*[\\+\\-\\*\\/\\&\\^\\<\\>\\=\\,\\(]([A-Za-z][A-Za-z][\\w\\.]*?)\\([^\\)]*$/);\n   if (str.charAt(0)==\"=\" && parts) {\n      fname = parts[1].toUpperCase();\n      if (SocialCalc.Formula.FunctionList[fname]) {\n         SocialCalc.Formula.FillFunctionInfo(); //  make sure filled\n         fstr = SocialCalc.special_chars(fname+\"(\"+SocialCalc.Formula.FunctionArgString(fname)+\")\");\n         }\n      else {\n         fstr = scc.ietUnknownFunction+fname;\n         }\n      if (inputecho.prompt.innerHTML != fstr) {\n         inputecho.prompt.innerHTML = fstr;\n         inputecho.prompt.style.display = \"block\";\n         }\n      }\n   else if (inputecho.prompt.style.display != \"none\") {\n      inputecho.prompt.innerHTML = \"\";\n      inputecho.prompt.style.display = \"none\";\n      }\n\n   }\n\nSocialCalc.InputEchoHeartbeat = function() {\n\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n   if (!editor) return true; // we're not handling it -- let browser do default\n\n   editor.inputEcho.SetText(editor.inputBox.GetText()+\"_\");\n\n   }\n\nSocialCalc.InputEchoMouseDown = function(e) {\n      var event = e || window.event;\n\n      var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n      if (!editor) return true; // we're not handling it -- let browser do default\n\n//      if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\n//      else event.cancelBubble = true; // IE 5+\n//      if (event.preventDefault) event.preventDefault(); // DOM Level 2\n//      else event.returnValue = false; // IE 5+\n\n      editor.inputBox.element.focus();\n\n//      return false;\n      };\n\n\n// *************************************\n//\n// CellHandles class:\n//\n// This object creates and controls the elements around the cursor cell for dragging, etc.\n//\n// *************************************\n\nSocialCalc.CellHandles = function(editor) {\n\n   var scc = SocialCalc.Constants;\n   var functions;\n\n   if (editor.noEdit) return; // leave us with nothing\n\n   this.editor = editor; // the TableEditor this belongs to\n\n   this.noCursorSuffix = false;\n\n   this.movedmouse = false; // used to detect no-op\n\n   this.draghandle = document.createElement(\"div\");\n   SocialCalc.setStyles(this.draghandle, \"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;\");\n   this.draghandle.innerHTML = '&nbsp;';\n   editor.toplevel.appendChild(this.draghandle);\n   SocialCalc.AssignID(editor, this.draghandle, \"draghandle\");\n\n   var imagetype = \"png\";\n   if (navigator.userAgent.match(/MSIE 6\\.0/)) {\n      imagetype = \"gif\";\n      }\n\n   this.dragpalette = document.createElement(\"div\");\n   SocialCalc.setStyles(this.dragpalette, \"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;\"+\n      \"backgroundImage:url(\"+SocialCalc.Constants.defaultImagePrefix+\"drag-handles.\"+imagetype+\");\");\n   this.dragpalette.innerHTML = '&nbsp;';\n   editor.toplevel.appendChild(this.dragpalette);\n   SocialCalc.AssignID(editor, this.dragpalette, \"dragpalette\");\n\n   this.dragtooltip = document.createElement(\"div\");\n   SocialCalc.setStyles(this.dragtooltip, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;\");\n   this.dragtooltip.innerHTML = '&nbsp;';\n   editor.toplevel.appendChild(this.dragtooltip);\n   SocialCalc.AssignID(editor, this.dragtooltip, \"dragtooltip\");\n\n   this.fillinghandle = document.createElement(\"div\");\n   SocialCalc.setStyles(this.fillinghandle, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;\");\n   this.fillinghandle.innerHTML = '&nbsp;';\n   editor.toplevel.appendChild(this.fillinghandle);\n   SocialCalc.AssignID(editor, this.fillinghandle, \"fillinghandle\");\n\n   if (this.draghandle.addEventListener) { // DOM Level 2 -- Firefox, et al\n      this.draghandle.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\n      this.dragpalette.addEventListener(\"mousedown\", SocialCalc.CellHandlesMouseDown, false);\n      this.dragpalette.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\n      }\n   else if (this.draghandle.attachEvent) { // IE 5+\n      this.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\n      this.dragpalette.attachEvent(\"onmousedown\", SocialCalc.CellHandlesMouseDown);\n      this.dragpalette.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\n      }\n   else { // don't handle this\n      throw \"Browser not supported\";\n      }\n\n   }\n\n// Methods:\n\nSocialCalc.CellHandles.prototype.ShowCellHandles = function(show, moveshow) {return SocialCalc.ShowCellHandles(this, show, moveshow);};\n\n// Functions:\n\nSocialCalc.ShowCellHandles = function(cellhandles, show, moveshow) {\n\n   var cell, cell2, position, position2;\n   var editor = cellhandles.editor;\n   var doshow = false;\n   var row, col;\n   var colinc = 1, rowinc = 1;\n\n   if (!editor) return;\n   if (!editor.ecell) return;\n\n   do { // a block that can you can \"break\" out of easily\n\n      if (!show) break;\n\n      row = editor.ecell.row;\n      col = editor.ecell.col;\n\n      if (editor.state != \"start\") break;\n      if (row >= editor.lastvisiblerow) break;\n      if (col >= editor.lastvisiblecol) break;\n      if (row < editor.firstscrollingrow) break;\n      if (col < editor.firstscrollingcol) break;\n\n      // Go beyond one column if hidden.\n      while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col+colinc)] == \"yes\") {\n         colinc++; \n         }     \n\n      // Go beyond one row if hidden.\n      while (editor.context.sheetobj.rowattribs.hide[row+rowinc] == \"yes\") {\n         rowinc++; \n         }     \n\n      // Check colspan and rowspan.\n      cell = editor.context.sheetobj.cells[SocialCalc.crToCoord(col+colinc-1, row+rowinc-1)];\n      if (typeof cell != \"undefined\") {\n         colinc += (cell.colspan || 1) - 1;\n         rowinc += (cell.rowspan || 1) - 1;\n         }\n\n      if (editor.rowpositions[row+rowinc]+20>editor.horizontaltablecontrol.controlborder) {\n         break;\n         }\n      if (editor.rowpositions[row+rowinc]-10<editor.headposition.top) {\n         break;\n         }\n      if (editor.colpositions[col+colinc]+20>editor.verticaltablecontrol.controlborder) {\n         break;\n         }\n      if (editor.colpositions[col+colinc]-30<editor.headposition.left) {\n         break;\n         }\n\n      cellhandles.draghandle.style.left = (editor.colpositions[col+colinc]-1)+\"px\";\n      cellhandles.draghandle.style.top = (editor.rowpositions[row+rowinc]-1)+\"px\";\n      cellhandles.draghandle.style.display = \"block\";\n\n      if (moveshow) {\n         cellhandles.draghandle.style.display = \"none\";\n         cellhandles.dragpalette.style.left = (editor.colpositions[col+colinc]-45)+\"px\";\n         cellhandles.dragpalette.style.top = (editor.rowpositions[row+rowinc]-45)+\"px\";\n         cellhandles.dragpalette.style.display = \"block\";\n         cellhandles.dragtooltip.style.left = (editor.colpositions[col+colinc]-45)+\"px\";\n         cellhandles.dragtooltip.style.top = (editor.rowpositions[row+rowinc]+45)+\"px\";\n         cellhandles.dragtooltip.style.display = \"none\";\n         }\n\n      doshow = true;\n\n      }\n   while (false); // only do once\n\n   if (!doshow) {\n      cellhandles.draghandle.style.display = \"none\";\n      }\n   if (!moveshow) {\n      cellhandles.dragpalette.style.display = \"none\";\n      cellhandles.dragtooltip.style.display = \"none\";\n      }\n\n   }\n\nSocialCalc.CellHandlesMouseMoveOnHandle = function(e) {\n\n   var scc = SocialCalc.Constants;\n\n   var event = e || window.event;\n   var target = event.target || event.srcElement\n\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n   if (!editor) return true; // we're not handling it -- let browser do default\n   var cellhandles = editor.cellhandles;\n   if (!cellhandles.editor) return true; // no handles\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n\n   if (!editor.cellhandles.mouseDown) {\n      editor.cellhandles.ShowCellHandles(true, true); // show move handles, too\n\n      if (target == cellhandles.dragpalette) {\n         var whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\n         if (whichhandle==0) { // off of active part of palette\n            SocialCalc.CellHandlesHoverTimeout();\n            return;\n            }\n         if (cellhandles.tooltipstimer) {\n            window.clearTimeout(cellhandles.tooltipstimer);\n            cellhandles.tooltipstimer = null;\n            }\n         cellhandles.tooltipswhichhandle = whichhandle;\n         cellhandles.tooltipstimer = window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout, 700);\n         }\n\n      if (cellhandles.timer) {\n         window.clearTimeout(cellhandles.timer);\n         cellhandles.timer = null;\n         }\n      cellhandles.timer = window.setTimeout(SocialCalc.CellHandlesHoverTimeout, 3000);\n   }\n\n   return;\n\n   }\n\n//\n// whichsegment = SocialCalc.SegmentDivHit(segtable, divWithMouseHit, x, y)\n//\n// Takes segtable = [upperleft quadrant, upperright, bottomright, bottomleft]\n//  where each quadrant is either:\n//      0 = ignore hits here\n//      number = return this value\n//      array = a new segtable for this subquadrant\n//\n// Alternatively, segtable can be:\n//  [radius 1, radius 2] and it returns 0 if no hit,\n//  -1, -2, -3, -4 for inner quadrants, and +1...+4 for outer quadrants\n//\n\nSocialCalc.SegmentDivHit = function(segtable, divWithMouseHit, x, y) {\n\n   var width = divWithMouseHit.offsetWidth;\n   var height = divWithMouseHit.offsetHeight;\n   var left = divWithMouseHit.offsetLeft;\n   var top = divWithMouseHit.offsetTop;\n   var v = 0;\n   var table = segtable;\n   var len = Math.sqrt(Math.pow(x-left-(width/2.0-.5), 2)+Math.pow(y-top-(height/2.0-.5), 2));\n\n   if (table.length==2) { // type 2 segtable\n      if (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\n         if (len <= segtable[0]) v = -1;\n         else if (len <= segtable[1]) v = 1;\n         }\n      if (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\n         if (len <= segtable[0]) v = -2;\n         else if (len <= segtable[1]) v = 2;\n         }\n      if (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\n         if (len <= segtable[0]) v = -3;\n         else if (len <= segtable[1]) v = 3;\n         }\n      if (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\n         if (len <= segtable[0]) v = -4;\n         else if (len <= segtable[1]) v = 4;\n         }\n      return v;\n      }\n\n   while (true) {\n      if (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\n         quadrant += \"1\";\n         v = table[0];\n         if (typeof v == \"number\") {\n            break;\n            }\n         table = v;\n         width = width/2;\n         height = height/2;\n         continue;\n         }\n      if (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\n         quadrant += \"2\";\n         v = table[1];\n         if (typeof v == \"number\") {\n            break;\n            }\n         table = v;\n         width = width/2;\n         left = left+width;\n         height = height/2;\n         continue;\n         }\n      if (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\n         quadrant += \"3\";\n         v = table[2];\n         if (typeof v == \"number\") {\n            break;\n            }\n         table = v;\n         width = width/2;\n         left = left + width;\n         height = height/2;\n         top = top + height;\n         continue;\n         }\n      if (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\n         quadrant += \"4\";\n         v = table[3];\n         if (typeof v == \"number\") {\n            break;\n            }\n         table = v;\n         width = width/2;\n         height = height/2;\n         top = top + height;\n         continue;\n         }\n      return 0; // didn't match\n      }\n\n//addmsg((x-divWithMouseHit.offsetLeft)+\",\"+(y-divWithMouseHit.offsetTop)+\"=\"+quadrant+\" \"+v);\n   return v;\n\n}\n\nSocialCalc.CellHandlesHoverTimeout = function() {\n\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n   if (!editor) return true; // we're not handling it -- let browser do default\n   var cellhandles = editor.cellhandles;\n   if (cellhandles.timer) {\n      window.clearTimeout(cellhandles.timer);\n      cellhandles.timer = null;\n      }\n   if (cellhandles.tooltipstimer) {\n      window.clearTimeout(cellhandles.tooltipstimer);\n      cellhandles.tooltipstimer = null;\n      }\n   editor.cellhandles.ShowCellHandles(true, false); // hide move handles\n\n}\n\nSocialCalc.CellHandlesTooltipsTimeout = function() {\n\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n   if (!editor) return true; // we're not handling it -- let browser do default\n   var cellhandles = editor.cellhandles;\n   if (cellhandles.tooltipstimer) {\n      window.clearTimeout(cellhandles.tooltipstimer);\n      cellhandles.tooltipstimer = null;\n      }\n\n   var whichhandle = cellhandles.tooltipswhichhandle;\n   if (whichhandle==0) { // off of active part of palette\n      SocialCalc.CellHandlesHoverTimeout();\n      return;\n      }\n   if (whichhandle==-3) {\n      cellhandles.dragtooltip.innerHTML = scc.s_CHfillAllTooltip;\n      }\n   else if (whichhandle==3) {\n      cellhandles.dragtooltip.innerHTML = scc.s_CHfillContentsTooltip;\n      }\n   else if (whichhandle==-2) {\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteAllTooltip;\n      }\n   else if (whichhandle==-4) {\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertAllTooltip;\n      }\n   else if (whichhandle==2) {\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteContentsTooltip;\n      }\n   else if (whichhandle==4) {\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertContentsTooltip;\n      }\n   else {\n      cellhandles.dragtooltip.innerHTML = \"&nbsp;\";\n      cellhandles.dragtooltip.style.display = \"none\";\n      return;\n      }\n\n   cellhandles.dragtooltip.style.display = \"block\";\n\n}\n\nSocialCalc.CellHandlesMouseDown = function(e) {\n\n   var scc = SocialCalc.Constants;\n   var editor, result, coord, textarea, wval, range;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\n   if (!editor) return true; // we're not handling it -- let browser do default\n\n   if (editor.busy) return; // don't do anything when busy (is this correct?)\n\n   var cellhandles = editor.cellhandles;\n\n   cellhandles.movedmouse = false; // detect no-op\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n\n   if (cellhandles.timer) { // cancel timer\n      window.clearTimeout(cellhandles.timer);\n      cellhandles.timer = null;\n      }\n   if (cellhandles.tooltipstimer) {\n      window.clearTimeout(cellhandles.tooltipstimer);\n      cellhandles.tooltipstimer = null;\n      }\n   cellhandles.dragtooltip.innerHTML = \"&nbsp;\";\n   cellhandles.dragtooltip.style.display = \"none\";\n\n   range = editor.range;\n \n   var whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\n   if (whichhandle==1 || whichhandle==-1 || whichhandle==0) {\n      cellhandles.ShowCellHandles(true, false); // hide move handles\n      return;\n      }\n\n   mouseinfo.ignore = true; // stop other code from looking at the mouse\n\n   if (whichhandle==-3) {\n      cellhandles.dragtype = \"Fill\";\n//      mouseinfo.element = editor.cellhandles.fillhandle;\n      cellhandles.noCursorSuffix = false;\n      }\n   else if (whichhandle==3) {\n      cellhandles.dragtype = \"FillC\";\n//      mouseinfo.element = editor.cellhandles.fillhandle;\n      cellhandles.noCursorSuffix = false;\n      }\n   else if (whichhandle==-2) {\n      cellhandles.dragtype = \"Move\";\n//      mouseinfo.element = editor.cellhandles.movehandle1;\n      cellhandles.noCursorSuffix = true;\n      }\n   else if (whichhandle==-4) {\n      cellhandles.dragtype = \"MoveI\";\n//      mouseinfo.element = editor.cellhandles.movehandle2;\n      cellhandles.noCursorSuffix = false;\n      }\n   else if (whichhandle==2) {\n      cellhandles.dragtype = \"MoveC\";\n//      mouseinfo.element = editor.cellhandles.movehandle1;\n      cellhandles.noCursorSuffix = true;\n      }\n   else if (whichhandle==4) {\n      cellhandles.dragtype = \"MoveIC\";\n//      mouseinfo.element = editor.cellhandles.movehandle2;\n      cellhandles.noCursorSuffix = false;\n      }\n\n   cellhandles.filltype = null;\n\n   switch (cellhandles.dragtype) {\n      case \"Fill\":\n      case \"FillC\":\n         if (!range.hasrange) {\n            editor.RangeAnchor();\n            }\n         editor.range2.top = editor.range.top;\n         editor.range2.right = editor.range.right;\n         editor.range2.bottom = editor.range.bottom;\n         editor.range2.left = editor.range.left;\n         editor.range2.hasrange = true;\n         break;\n\n      case \"Move\":\n      case \"MoveI\":\n      case \"MoveC\":\n      case \"MoveIC\":\n         if (!range.hasrange) {\n            editor.RangeAnchor();\n            }\n         editor.range2.top = editor.range.top;\n         editor.range2.right = editor.range.right;\n         editor.range2.bottom = editor.range.bottom;\n         editor.range2.left = editor.range.left;\n         editor.range2.hasrange = true;\n         editor.RangeRemove();\n         break;\n\n      default:\n         return; // not for us\n      }\n\n   cellhandles.fillinghandle.style.left = (clientX)+\"px\";\n   cellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\n   cellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\n                                         (scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\n   cellhandles.fillinghandle.style.display = \"block\";\n\n   cellhandles.ShowCellHandles(true, false); // hide move handles\n   cellhandles.mouseDown = true;\n\n   mouseinfo.editor = editor; // remember for later\n\n   coord = editor.ecell.coord; // start with cell with handles\n\n   cellhandles.startingcoord = coord;\n   cellhandles.startingX = clientX;\n   cellhandles.startingY = clientY;\n\n   mouseinfo.mouselastcoord = coord;\n\n   SocialCalc.KeyboardSetFocus(editor);\n\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\n      document.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMove, true); // capture everywhere\n      document.addEventListener(\"mouseup\", SocialCalc.CellHandlesMouseUp, true); // capture everywhere\n      }\n   else if (cellhandles.draghandle.attachEvent) { // IE 5+\n      cellhandles.draghandle.setCapture();\n      cellhandles.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMove);\n      cellhandles.draghandle.attachEvent(\"onmouseup\", SocialCalc.CellHandlesMouseUp);\n      cellhandles.draghandle.attachEvent(\"onlosecapture\", SocialCalc.CellHandlesMouseUp);\n     }\n   SocialCalc.StopPropagation(event);\n   return;\n\n   }\n\nSocialCalc.CellHandlesMouseMove = function(e) {\n\n   var scc = SocialCalc.Constants;\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\n   var crstart, crend, cr, c, r;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   var cellhandles = editor.cellhandles;\n\n   element = mouseinfo.element;\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\n\n   if (!result) return;\n\n   if (result && !result.coord) {\n      SocialCalc.SetDragAutoRepeat(editor, result, SocialCalc.CellHandlesDragAutoRepeat);\n      return;\n      }\n\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\n   if (!result.coord) return;\n\n   crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\n   crend = SocialCalc.coordToCr(result.coord);\n\n\n   cellhandles.movedmouse = true; // did move, so not no-op\n\n   switch (cellhandles.dragtype) {\n      case \"Fill\":\n      case \"FillC\":\n\n         if (result.coord == cellhandles.startingcoord) { // reset when come back\n            cellhandles.filltype = null;\n            cellhandles.startingX = clientX;\n            cellhandles.startingY = clientY;\n            }\n         else {\n            if (cellhandles.filltype) { // moving and have already determined filltype\n               if (cellhandles.filltype==\"Down\") { // coerse to that\n                  crend.col = crstart.col;\n                  if (crend.row < crstart.row) crend.row = crstart.row;\n                  }\n               else {\n                  crend.row = crstart.row;\n                  if (crend.col < crstart.col) crend.col = crstart.col;\n                  }\n               }\n            else {\n               if (Math.abs(clientY - cellhandles.startingY) > 10) {\n                  cellhandles.filltype = \"Down\";\n                  }\n               else if (Math.abs(clientX - cellhandles.startingX) > 10) {\n                  cellhandles.filltype = \"Right\";\n                  }\n               crend.col = crstart.col; // until decide, leave it at start\n               crend.row = crstart.row;\n               }\n            }\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\n         if (result.coord!=mouseinfo.mouselastcoord) {\n            editor.MoveECell(result.coord);\n            editor.RangeExtend();\n            }\n         break;\n\n      case \"Move\":\n      case \"MoveC\":\n         if (result.coord!=mouseinfo.mouselastcoord) {\n            editor.MoveECell(result.coord);\n            c = editor.range2.right - editor.range2.left + result.col;\n            r = editor.range2.bottom - editor.range2.top + result.row;\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\n            editor.RangeExtend();\n            }\n         break;\n\n      case \"MoveI\":\n      case \"MoveIC\":\n         if (result.coord == cellhandles.startingcoord) { // reset when come back\n            cellhandles.filltype = null;\n            cellhandles.startingX = clientX;\n            cellhandles.startingY = clientY;\n            }\n         else {\n            if (cellhandles.filltype) { // moving and have already determined filltype\n               if (cellhandles.filltype==\"Vertical\") { // coerse to that\n                  crend.col = editor.range2.left;\n                  if (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\n                  }\n               else {\n                  crend.row = editor.range2.top;\n                  if (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\n                  }\n               }\n            else {\n               if (Math.abs(clientY - cellhandles.startingY) > 10) {\n                  cellhandles.filltype = \"Vertical\";\n                  }\n               else if (Math.abs(clientX - cellhandles.startingX) > 10) {\n                  cellhandles.filltype = \"Horizontal\";\n                  }\n               crend.col = crstart.col; // until decide, leave it at start\n               crend.row = crstart.row;\n               }\n            }\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\n         if (result.coord!=mouseinfo.mouselastcoord) {\n            editor.MoveECell(result.coord);\n            if (!cellhandles.filltype) { // no fill type\n               editor.RangeRemove();\n               }\n            else {\n               c = editor.range2.right - editor.range2.left + crend.col;\n               r = editor.range2.bottom - editor.range2.top + crend.row;\n               editor.RangeAnchor(SocialCalc.crToCoord(c, r));\n               editor.RangeExtend();\n               }\n            }\n         break;\n\n      }\n\n\n   cellhandles.fillinghandle.style.left = clientX+\"px\";\n   cellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\n   cellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\n                                         (scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\n   cellhandles.fillinghandle.style.display = \"block\";\n\n   mouseinfo.mouselastcoord = result.coord;\n   SocialCalc.StopPropagation(event);\n   return;\n   }\n\nSocialCalc.CellHandlesDragAutoRepeat = function(coord, direction) {\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   var editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   var cellhandles = editor.cellhandles;\n\n   var crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\n   var crend = SocialCalc.coordToCr(coord);\n\n   var newcoord, c, r;\n\n   var vscroll = 0;\n   var hscroll = 0;\n\n   if (direction == \"left\") hscroll = -1;\n   else if (direction == \"right\") hscroll = 1;\n   else if (direction == \"up\") vscroll = -1;\n   else if (direction == \"down\") vscroll = 1;\n   editor.ScrollRelativeBoth(vscroll, hscroll);\n\n\n   switch (cellhandles.dragtype) {\n      case \"Fill\":\n      case \"FillC\":\n         if (cellhandles.filltype) { // moving and have already determined filltype\n            if (cellhandles.filltype==\"Down\") { // coerse to that\n               crend.col = crstart.col;\n               if (crend.row < crstart.row) crend.row = crstart.row;\n               }\n            else {\n               crend.row = crstart.row;\n               if (crend.col < crstart.col) crend.col = crstart.col;\n               }\n            }\n         else {\n            crend.col = crstart.col; // until decide, leave it at start\n            crend.row = crstart.row;\n            }\n\n         newcoord = SocialCalc.crToCoord(crend.col, crend.row);\n         if (newcoord!=mouseinfo.mouselastcoord) {\n            editor.MoveECell(coord);\n            editor.RangeExtend();\n            }\n         break;\n\n      case \"Move\":\n      case \"MoveC\":\n         if (coord!=mouseinfo.mouselastcoord) {\n            editor.MoveECell(coord);\n            c = editor.range2.right - editor.range2.left + editor.ecell.col;\n            r = editor.range2.bottom - editor.range2.top + editor.ecell.row;\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\n            editor.RangeExtend();\n            }\n         break;\n\n      case \"MoveI\":\n      case \"MoveIC\":\n         if (cellhandles.filltype) { // moving and have already determined filltype\n            if (cellhandles.filltype==\"Vertical\") { // coerse to that\n               crend.col = editor.range2.left;\n               if (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\n               }\n            else {\n               crend.row = editor.range2.top;\n               if (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\n               }\n            }\n         else {\n            crend.col = crstart.col; // until decide, leave it at start\n            crend.row = crstart.row;\n            }\n\n         newcoord = SocialCalc.crToCoord(crend.col, crend.row);\n         if (newcoord!=mouseinfo.mouselastcoord) {\n            editor.MoveECell(newcoord);\n            c = editor.range2.right - editor.range2.left + crend.col;\n            r = editor.range2.bottom - editor.range2.top + crend.row;\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\n            editor.RangeExtend();\n            }\n         break;\n\n      }\n\n   mouseinfo.mouselastcoord = newcoord;\n\n   }\n\nSocialCalc.CellHandlesMouseUp = function(e) {\n\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval, cstr, cmdtype, cmdtype2;\n   var crstart, crend;\n   var sizec, sizer, deltac, deltar;\n\n   var event = e || window.event;\n\n   var mouseinfo = SocialCalc.EditorMouseInfo;\n   editor = mouseinfo.editor;\n   if (!editor) return; // not us, ignore\n   var cellhandles = editor.cellhandles;\n\n   element = mouseinfo.element;\n\n   mouseinfo.ignore = false;\n\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\n\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\n\n   cellhandles.mouseDown = false;\n   cellhandles.noCursorSuffix = false;\n\n   cellhandles.fillinghandle.style.display = \"none\";\n\n   if (!result) result = {};\n   if (!result.coord) result.coord = editor.ecell.coord;\n\n   switch (cellhandles.dragtype) {\n      case \"Fill\":\n      case \"Move\":\n      case \"MoveI\":\n         cmdtype2 = \" all\";\n            break;\n      case \"FillC\":\n      case \"MoveC\":\n      case \"MoveIC\":\n         cmdtype2 = \" formulas\";\n         break;\n      }\n\n   if (!cellhandles.movedmouse) { // didn't move: just leave one cell selected\n      cellhandles.dragtype = \"Nothing\";\n      }\n\n   switch (cellhandles.dragtype) {\n      case \"Nothing\":\n         editor.Range2Remove();\n         editor.RangeRemove();\n         break;\n\n      case \"Fill\":\n      case \"FillC\":\n\n         crstart = SocialCalc.coordToCr(cellhandles.startingcoord);\n         crend = SocialCalc.coordToCr(result.coord);\n         if (cellhandles.filltype) {\n            if (cellhandles.filltype==\"Down\") {\n               crend.col = crstart.col;\n               }\n            else {\n               crend.row = crstart.row;\n               }\n            }\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\n\n         editor.MoveECell(result.coord);\n         editor.RangeExtend();\n\n         if (editor.cellhandles.filltype==\"Right\") {\n            cmdtype = \"right\";\n            }\n         else {\n            cmdtype = \"down\";\n            }\n         cstr = \"fill\"+cmdtype+\" \"+SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n                   \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom)+cmdtype2;\n         editor.EditorScheduleSheetCommands(cstr, true, false);\n         break;\n\n      case \"Move\":\n      case \"MoveC\":\n         editor.context.cursorsuffix = \"\";\n         cstr = \"movepaste \"+\n                     SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\n                     SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\n                     +\" \"+editor.ecell.coord+cmdtype2;\n         editor.EditorScheduleSheetCommands(cstr, true, false);\n         editor.Range2Remove();\n\n         break;\n\n      case \"MoveI\":\n      case \"MoveIC\":\n         editor.context.cursorsuffix = \"\";\n         sizec = editor.range2.right - editor.range2.left;\n         sizer = editor.range2.bottom - editor.range2.top;\n         deltac = editor.ecell.col - editor.range2.left;\n         deltar = editor.ecell.row - editor.range2.top;\n         cstr = \"moveinsert \"+\n                     SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\n                     SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\n                     +\" \"+editor.ecell.coord+cmdtype2;\n         editor.EditorScheduleSheetCommands(cstr, true, false);\n         editor.Range2Remove();\n         editor.RangeRemove();\n         if (editor.cellhandles.filltype==\" Horizontal\" && deltac > 0) {\n            editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col-sizec-1, editor.ecell.row));\n            }\n         else if (editor.cellhandles.filltype==\" Vertical\" && deltar > 0) {\n            editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col, editor.ecell.row-sizer-1));\n            }\n         editor.RangeAnchor(SocialCalc.crToCoord(editor.ecell.col+sizec, editor.ecell.row+sizer));\n         editor.RangeExtend();\n\n         break;\n\n      }\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.CellHandlesMouseMove,\n\t\t\t\t    SocialCalc.CellHandlesMouseUp,\n\t\t\t\t    cellhandles.draghandle,\n\t\t\t\t    event);\n   mouseinfo.editor = null;\n   return false;\n   }\n\n// *************************************\n//\n// TableControl class:\n//\n// This class deals with the horizontal and verical scrollbars and pane sliders.\n//\n// +--------------+\n// | Endcap       |\n// +- - - - - - - +\n// |              |\n// +--------------+\n// | Pane Slider  |\n// +--------------+\n// |              |\n// | Less Button  |\n// |              |\n// +--------------+\n// | Scroll Area  |\n// |              |\n// |              |\n// +--------------+\n// | Thumb        |\n// +--------------+\n// |              |\n// +--------------+\n// |              |\n// | More Button  |\n// |              |\n// +--------------+\n//\n// *************************************\n\nSocialCalc.TableControl = function(editor, vertical, size) {\n\n   var scc = SocialCalc.Constants;\n\n   this.editor = editor; // the TableEditor this belongs to\n\n   this.vertical = vertical; // true if vertical control, false if horizontal\n   this.size = size; // length in pixels\n\n   this.main = null; // main element containing all the others\n   this.endcap = null; // the area at the top/left between the end and the pane slider\n   this.paneslider = null; // the slider to adjust the pane split\n   this.lessbutton = null; // the top/left scroll button\n   this.morebutton = null; // the bottom/right scroll button\n   this.scrollarea = null; // the area between the scroll buttons\n   this.thumb = null; // the sliding thing in the scrollarea\n\n   // computed position values:\n\n   this.controlborder = null; // left or top screen position for vertical or horizontal control\n   this.endcapstart = null; // top or left screen position for vertical or horizontal control\n   this.panesliderstart = null;\n   this.lessbuttonstart = null;\n   this.morebuttonstart = null;\n   this.scrollareastart = null;\n   this.scrollareaend = null;\n   this.scrollareasize = null;\n   this.thumbpos = null;\n\n   // constants:\n\n   this.controlthickness = scc.defaultTableControlThickness; // other dimension of complete control in pixels\n   this.sliderthickness = scc.defaultTCSliderThickness;\n   this.buttonthickness = scc.defaultTCButtonThickness;\n   this.thumbthickness = scc.defaultTCThumbThickness;\n   this.minscrollingpanesize = this.buttonthickness+this.buttonthickness+this.thumbthickness+20; // the 20 is to leave a little space\n\n   }\n\n// Methods:\n\nSocialCalc.TableControl.prototype.CreateTableControl = function() {return SocialCalc.CreateTableControl(this);};\nSocialCalc.TableControl.prototype.PositionTableControlElements = function() {SocialCalc.PositionTableControlElements(this);};\nSocialCalc.TableControl.prototype.ComputeTableControlPositions = function() {SocialCalc.ComputeTableControlPositions(this);};\n\n// Functions:\n\nSocialCalc.CreateTableControl = function(control) {\n\n   var s, functions, params;\n   var AssignID = SocialCalc.AssignID;\n   var setStyles = SocialCalc.setStyles;\n   var scc = SocialCalc.Constants;\n   var TooltipRegister = function(element, etype, vh) {\n      if (scc[\"s_\"+etype+\"Tooltip\"+vh]) {\n         SocialCalc.TooltipRegister(element, scc[\"s_\"+etype+\"Tooltip\"+vh], null, control.editor.toplevel);\n         }\n      }\n\n   var imageprefix = control.editor.imageprefix;\n   var vh = control.vertical ? \"v\" : \"h\";\n\n   control.main = document.createElement(\"div\");\n   s = control.main.style;\n   s.height = (control.vertical ? control.size : control.controlthickness)+\"px\";\n   s.width = (control.vertical ? control.controlthickness : control.size)+\"px\";\n   s.zIndex = 0;\n   setStyles(control.main, scc.TCmainStyle);\n   s.backgroundImage=\"url(\"+imageprefix+\"main-\"+vh+\".gif)\";\n   if (scc.TCmainClass) control.main.className = scc.TCmainClass;\n\n   control.main.style.display=\"none\"; // wait for layout\n\n   control.endcap = document.createElement(\"div\");\n   s = control.endcap.style;\n   s.height = control.controlthickness+\"px\";\n   s.width = control.controlthickness+\"px\";\n   s.zIndex = 1;\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\n   s.position = \"absolute\";\n   setStyles(control.endcap, scc.TCendcapStyle);\n   s.backgroundImage=\"url(\"+imageprefix+\"endcap-\"+vh+\".gif)\";\n   if (scc.TCendcapClass) control.endcap.className = scc.TCendcapClass;\n   AssignID(control.editor, control.endcap, \"endcap\"+vh);\n\n   control.main.appendChild(control.endcap);\n\n   control.paneslider = document.createElement(\"div\");\n   s = control.paneslider.style;\n   s.height = (control.vertical ? control.sliderthickness : control.controlthickness)+\"px\";\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\n   s.width = (control.vertical ? control.controlthickness : control.sliderthickness)+\"px\";\n   s.position = \"absolute\";\n   s[control.vertical?\"top\":\"left\"] = \"4px\";\n   s.zIndex = 3;\n   s.backgroundImage=\"url(\"+imageprefix+\"paneslider-\"+vh+\".gif)\";\n   if (scc.TCpanesliderClass) control.paneslider.className = scc.TCpanesliderClass;\n   AssignID(control.editor, control.paneslider, \"paneslider\"+vh);\n   TooltipRegister(control.paneslider, \"paneslider\", vh);\n\n   functions = {MouseDown:SocialCalc.TCPSDragFunctionStart,\n                    MouseMove: SocialCalc.TCPSDragFunctionMove,\n                    MouseUp: SocialCalc.TCPSDragFunctionStop,\n                    Disabled: function() {return control.editor.busy;}};\n\n   functions.control = control; // make sure this is there\n\n   // Drag pane slider - every thing but app view\n   if (SocialCalc._app != true) SocialCalc.DragRegister(control.paneslider, control.vertical, !control.vertical, functions, control.editor.toplevel);\n\n   control.main.appendChild(control.paneslider);\n\n   control.lessbutton = document.createElement(\"div\");\n   s = control.lessbutton.style;\n   s.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\n   s.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\n   s.zIndex = 2;\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\n   s.position = \"absolute\";\n   setStyles(control.lessbutton, scc.TClessbuttonStyle);\n   s.backgroundImage=\"url(\"+imageprefix+\"less-\"+vh+\"n.gif)\"\n   if (scc.TClessbuttonClass) control.lessbutton.className = scc.TClessbuttonClass;\n   AssignID(control.editor, control.lessbutton, \"lessbutton\"+vh);\n\n   params = {repeatwait:scc.TClessbuttonRepeatWait, repeatinterval:scc.TClessbuttonRepeatInterval,\n             normalstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"n.gif);\",\n             downstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"d.gif);\",\n             hoverstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"h.gif);\"};\n   functions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\n                Repeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\n                Disabled: function() {return control.editor.busy;}};\n\n   SocialCalc.ButtonRegister(control.editor, control.lessbutton, params, functions);\n\n   control.main.appendChild(control.lessbutton);\n\n   control.morebutton = document.createElement(\"div\");\n   s = control.morebutton.style;\n   s.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\n   s.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\n   s.zIndex = 2;\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\n   s.position = \"absolute\";\n   setStyles(control.morebutton, scc.TCmorebuttonStyle);\n   s.backgroundImage=\"url(\"+imageprefix+\"more-\"+vh+\"n.gif)\"\n   if (scc.TCmorebuttonClass) control.morebutton.className = scc.TCmorebuttonClass;\n   AssignID(control.editor, control.morebutton, \"morebutton\"+vh);\n\n   params = {repeatwait:scc.TCmorebuttonRepeatWait, repeatinterval:scc.TCmorebuttonRepeatInterval,\n             normalstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"n.gif);\",\n             downstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"d.gif);\",\n             hoverstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"h.gif);\"};\n   functions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\n                Repeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\n                Disabled: function() {return control.editor.busy;}};\n\n   SocialCalc.ButtonRegister(control.editor, control.morebutton, params, functions);\n\n   control.main.appendChild(control.morebutton);\n\n   control.scrollarea = document.createElement(\"div\");\n   s = control.scrollarea.style;\n   s.height = control.controlthickness+\"px\";\n   s.width = control.controlthickness+\"px\";\n   s.zIndex = 1;\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\n   s.position = \"absolute\";\n   setStyles(control.scrollarea, scc.TCscrollareaStyle);\n   s.backgroundImage=\"url(\"+imageprefix+\"scrollarea-\"+vh+\".gif)\";\n   if (scc.TCscrollareaClass) control.scrollarea.className = scc.TCscrollareaClass;\n   AssignID(control.editor, control.scrollarea, \"scrollarea\"+vh);\n\n   params = {repeatwait:scc.TCscrollareaRepeatWait, repeatinterval:scc.TCscrollareaRepeatWait};\n   functions = {MouseDown:SocialCalc.ScrollAreaClick, Repeat:SocialCalc.ScrollAreaClick,\n                Disabled: function() {return control.editor.busy;}};\n   functions.control = control;\n\n   SocialCalc.ButtonRegister(control.editor, control.scrollarea, params, functions);\n\n   control.main.appendChild(control.scrollarea);\n\n   control.thumb = document.createElement(\"div\");\n   s = control.thumb.style;\n   s.height =  (control.vertical ? control.thumbthickness : control.controlthickness)+\"px\";\n   s.width = (control.vertical ? control.controlthickness : control.thumbthickness)+\"px\";\n   s.zIndex = 2;\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\n   s.position = \"absolute\";\n   setStyles(control.thumb, scc.TCthumbStyle);\n   control.thumb.style.backgroundImage=\"url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\";\n   if (scc.TCthumbClass) control.thumb.className = scc.TCthumbClass;\n   AssignID(control.editor, control.thumb, \"thumb\"+vh);\n\n   functions = {MouseDown:SocialCalc.TCTDragFunctionStart,\n                MouseMove: SocialCalc.TCTDragFunctionMove,\n                MouseUp: SocialCalc.TCTDragFunctionStop,\n                Disabled: function() {return control.editor.busy;}};\n   functions.control = control; // make sure this is there\n   \n   // Drag pane slider - every thing but app view\n   if (SocialCalc._app != true) SocialCalc.DragRegister(control.thumb, control.vertical, !control.vertical, functions, control.editor.toplevel);\n\n   params = {normalstyle: \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\", name:\"Thumb\",\n             downstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"d.gif)\",\n             hoverstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"h.gif)\"};\n   SocialCalc.ButtonRegister(control.editor, control.thumb, params, null); // give it button-like visual behavior\n\n   control.main.appendChild(control.thumb);\n\n   return control.main;\n\n}\n\n//\n// ScrollAreaClick - Button function to process pageup/down clicks\n//\n\nSocialCalc.ScrollAreaClick = function(e, buttoninfo, bobj) {\n\n   var control = bobj.functionobj.control;\n   var pos = SocialCalc.GetElementPositionWithScroll(control.editor.toplevel);\n   var clickpos = control.vertical ? buttoninfo.clientY-pos.top : buttoninfo.clientX-pos.left;\n   if (control.editor.busy) { // ignore if busy - wait for next repeat\n      return;\n      }\n   control.editor.PageRelative(control.vertical, clickpos > control.thumbpos ? 1 : -1);\n\n   return;\n\n}\n\n//\n// PositionTableControlElements\n//\n\nSocialCalc.PositionTableControlElements = function(control) {\n\n   var border, realend, thumbpos;\n\n   var editor = control.editor;\n\n   if (control.vertical) {\n      border = control.controlborder+\"px\";\n      control.endcap.style.top = control.endcapstart+\"px\";\n      control.endcap.style.left = border;\n      control.paneslider.style.top = control.panesliderstart+\"px\";\n      control.paneslider.style.left = border\n      control.lessbutton.style.top = control.lessbuttonstart+\"px\";\n      control.lessbutton.style.left = border;\n      control.morebutton.style.top = control.morebuttonstart+\"px\";\n      control.morebutton.style.left = border;\n      control.scrollarea.style.top = control.scrollareastart+\"px\";\n      control.scrollarea.style.left = border;\n      control.scrollarea.style.height = control.scrollareasize+\"px\";\n      realend = Math.max(editor.context.sheetobj.attribs.lastrow, editor.firstscrollingrow+1);\n      thumbpos = ((editor.firstscrollingrow-(editor.lastnonscrollingrow+1))*(control.scrollareasize-3*control.thumbthickness))/\n         (realend-(editor.lastnonscrollingrow+1))+control.scrollareastart-1;\n      thumbpos = Math.floor(thumbpos);\n      control.thumb.style.top = thumbpos+\"px\";\n      control.thumb.style.left = border;\n      }\n   else {\n      border = control.controlborder+\"px\";\n      control.endcap.style.left = control.endcapstart+\"px\";\n      control.endcap.style.top = border;\n      control.paneslider.style.left = control.panesliderstart+\"px\";\n      control.paneslider.style.top = border\n      control.lessbutton.style.left = control.lessbuttonstart+\"px\";\n      control.lessbutton.style.top = border;\n      control.morebutton.style.left = control.morebuttonstart+\"px\";\n      control.morebutton.style.top = border;\n      control.scrollarea.style.left = control.scrollareastart+\"px\";\n      control.scrollarea.style.top = border;\n      control.scrollarea.style.width = control.scrollareasize+\"px\";\n      realend = Math.max(editor.context.sheetobj.attribs.lastcol, editor.firstscrollingcol+1);\n      thumbpos = ((editor.firstscrollingcol-(editor.lastnonscrollingcol+1))*(control.scrollareasize-control.thumbthickness))/\n         (realend-editor.lastnonscrollingcol)+control.scrollareastart-1;\n      thumbpos = Math.floor(thumbpos);\n      control.thumb.style.left = thumbpos+\"px\";\n      control.thumb.style.top = border;\n      }\n   control.thumbpos = thumbpos;\n   control.main.style.display=\"block\";\n\n   }\n\n//\n// ComputeTableControlPositions\n//\n// This routine computes the screen positions and other values needed for laying out\n// the table control elements.\n//\n\nSocialCalc.ComputeTableControlPositions = function(control) {\n\n   var editor = control.editor;\n\n   if (!editor.gridposition || !editor.headposition) throw(\"Can't compute table control positions before editor positions\");\n\n   if (control.vertical) {\n      control.controlborder = editor.gridposition.left+editor.tablewidth; // border=left position\n      control.endcapstart = editor.gridposition.top; // start=top position\n      control.panesliderstart = editor.firstscrollingrowtop-control.sliderthickness;\n      control.lessbuttonstart = editor.firstscrollingrowtop-1;\n      control.morebuttonstart = editor.gridposition.top+editor.tableheight-control.buttonthickness;\n      control.scrollareastart = editor.firstscrollingrowtop-1+control.buttonthickness;\n      control.scrollareaend = control.morebuttonstart-1;\n      control.scrollareasize = control.scrollareaend-control.scrollareastart+1;\n      }\n   else {\n      control.controlborder = editor.gridposition.top+editor.tableheight; // border=top position\n      control.endcapstart = editor.gridposition.left; // start=left position\n      control.panesliderstart = editor.firstscrollingcolleft-control.sliderthickness;\n      control.lessbuttonstart = editor.firstscrollingcolleft-1;\n      control.morebuttonstart = editor.gridposition.left+editor.tablewidth-control.buttonthickness;\n      control.scrollareastart = editor.firstscrollingcolleft-1+control.buttonthickness;\n      control.scrollareaend = control.morebuttonstart-1;\n      control.scrollareasize = control.scrollareaend-control.scrollareastart+1;\n      }\n   }\n\n////// TCPS - TableControl Pan Slider methods\n\n//\n// TCPSDragFunctionStart(event, draginfo, dobj)\n//\n// TableControlPaneSlider function for starting drag\n//\n\nSocialCalc.TCPSDragFunctionStart = function(event, draginfo, dobj) {\n\n   var editor = dobj.functionobj.control.editor;\n   var scc = SocialCalc.Constants;\n\n   SocialCalc.DragFunctionStart(event, draginfo, dobj);\n\n   draginfo.trackingline = document.createElement(\"div\");\n   draginfo.trackingline.style.height = dobj.vertical ? scc.TCPStrackinglineThickness :\n      (editor.tableheight-(editor.headposition.top-editor.gridposition.top))+\"px\";\n   draginfo.trackingline.style.width = dobj.vertical ? \n      (editor.tablewidth-(editor.headposition.left-editor.gridposition.left))+\"px\" : scc.TCPStrackinglineThickness;\n   draginfo.trackingline.style.backgroundImage=\"url(\"+editor.imageprefix+\"trackingline-\"+(dobj.vertical?\"v\":\"h\")+\".gif)\";;\n   if (scc.TCPStrackinglineClass) draginfo.trackingline.className = scc.TCPStrackinglineClass;\n   SocialCalc.setStyles(draginfo.trackingline, scc.TCPStrackinglineStyle);\n\n   if (dobj.vertical) {\n      row = SocialCalc.Lookup(draginfo.clientY+dobj.functionobj.control.sliderthickness, editor.rowpositions);\n      draginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\n      draginfo.trackingline.style.left = editor.headposition.left+\"px\";\n      draginfo.trackingline.id = 'trackingline-vertical';\n      if (editor.context.rowpanes.length-1) { // has 2 already\n         editor.context.SetRowPaneFirstLast(1, editor.context.rowpanes[0].last+1, editor.context.rowpanes[0].last+1);\n         editor.FitToEditTable();\n         editor.ScheduleRender();\n         }\n      }\n   else {\n      col = SocialCalc.Lookup(draginfo.clientX+dobj.functionobj.control.sliderthickness, editor.colpositions);\n      draginfo.trackingline.style.top = editor.headposition.top+\"px\";\n      draginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\n      draginfo.trackingline.id = 'trackingline-horizon';\n      if (editor.context.colpanes.length-1) { // has 2 already\n         editor.context.SetColPaneFirstLast(1, editor.context.colpanes[0].last+1, editor.context.colpanes[0].last+1);\n         editor.FitToEditTable();\n         editor.ScheduleRender();\n         }\n      }\n\n   editor.griddiv.appendChild(draginfo.trackingline);\n\n   }\n\n//\n// TCPSDragFunctionMove(event, draginfo, dobj)\n//\n\nSocialCalc.TCPSDragFunctionMove = function(event, draginfo, dobj) {\n\n   var row, col, max, min;\n   var control = dobj.functionobj.control;\n   var sliderthickness = control.sliderthickness;\n   var editor = control.editor;\n\n   if (dobj.vertical) {\n      max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\n      if (draginfo.clientY > max) draginfo.clientY = max;\n      min = editor.headposition.top - sliderthickness - draginfo.offsetY;\n      if (draginfo.clientY < min) draginfo.clientY = min;\n\n      row = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\n\n      // Handle hidden row.\n      while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\n         row++;\n         }\n\n      draginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\n      }\n   else {\n      max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\n      if (draginfo.clientX > max) draginfo.clientX = max;\n      min = editor.headposition.left - sliderthickness - draginfo.offsetX;\n      if (draginfo.clientX < min) draginfo.clientX = min;\n\n      col = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\n\n      // Handle hidden column.\n      while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\n         col++;\n         }\n\n      draginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\n      }\n\n   SocialCalc.DragFunctionPosition(event, draginfo, dobj);\n\n   }\n\n//\n// TCPSDragFunctionStop(event, draginfo, dobj)\n//\n\nSocialCalc.TCPSDragFunctionStop = function(event, draginfo, dobj) {\n\n   var row, col, max, min, dc;\n   var control = dobj.functionobj.control;\n   var sliderthickness = control.sliderthickness;\n   var editor = control.editor;\n\n   if (dobj.vertical) {\n     max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\n     if (draginfo.clientY > max) draginfo.clientY = max;\n     min = editor.headposition.top - sliderthickness - draginfo.offsetY;\n     if (draginfo.clientY < min) draginfo.clientY = min;\n\n     row = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\n     if (row>editor.context.sheetobj.attribs.lastrow) row=editor.context.sheetobj.attribs.lastrow; // can't extend sheet here\n\n     // Handle hidden row.\n     while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\n       row++;\n     }\n\n\n     editor.EditorScheduleSheetCommands('pane row ' + row, true, false);\n   }\n   else {\n     max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\n     if (draginfo.clientX > max) draginfo.clientX = max;\n     min = editor.headposition.left - sliderthickness - draginfo.offsetX;\n     if (draginfo.clientX < min) draginfo.clientX = min;\n\n     col = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\n     if (col>editor.context.sheetobj.attribs.lastcol) col=editor.context.sheetobj.attribs.lastcol; // can't extend sheet here\n\n     // Handle hidden column.\n     while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\n       col++;\n     }\n\n     editor.EditorScheduleSheetCommands('pane col ' + col, true, false);\n   }\n\n   }\n\n////// TCT - TableControl Thumb methods\n\n//!!!! Note: Need to make start use same code as move/stop for determining row/col, since stop will set that\n//!!!! Note: Need to make start/move/stop use positioning code that corresponds closer to\n//!!!!       ComputeTableControlPositions calculations.\n\n//\n// TCTDragFunctionStart(event, draginfo, dobj)\n//\n// TableControlThumb function for starting drag\n//\n\nSocialCalc.TCTDragFunctionStart = function(event, draginfo, dobj) {\n\n   var rowpane, colpane, row, col;\n\n   var control = dobj.functionobj.control;\n   var editor = control.editor;\n   var scc = SocialCalc.Constants;\n\n   SocialCalc.DragFunctionStart(event, draginfo, dobj);\n\n   if (draginfo.thumbstatus) { // get rid of old one if mouseup was out of window\n      if (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\n      if (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\n      editor.toplevel.removeChild(draginfo.thumbstatus);\n      draginfo.thumbstatus = null;\n      }\n\n   draginfo.thumbstatus = document.createElement(\"div\");\n\n   if (dobj.vertical) {\n      if (scc.TCTDFSthumbstatusvClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatusvClass;\n      SocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatusvStyle);\n      draginfo.thumbstatus.style.top = (draginfo.clientY+scc.TCTDFStopOffsetv)+\"px\";\n      draginfo.thumbstatus.style.left = (control.controlborder-10-(editor.tablewidth/2))+\"px\";\n      draginfo.thumbstatus.style.width = (editor.tablewidth/2)+\"px\";\n\n      draginfo.thumbcontext = new SocialCalc.RenderContext(editor.context.sheetobj);\n      draginfo.thumbcontext.showGrid = true;\n      draginfo.thumbcontext.rowpanes = [{first: 1, last: 1}];\n      var pane = editor.context.colpanes[editor.context.colpanes.length-1];\n      draginfo.thumbcontext.colpanes = [{first: pane.first, last: pane.last}];\n      draginfo.thumbstatus.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td valign=\"top\" style=\"'+\n        scc.TCTDFSthumbstatusrownumStyle+'\" class=\"'+scc.TCTDFSthumbstatusrownumClass+\n        '\"><div>msg</div></td><td valign=\"top\"><div style=\"overflow:hidden;\">preview</div></td></tr></table>';\n      draginfo.thumbstatus.rowmsgele = draginfo.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild;\n      draginfo.thumbstatus.rowpreviewele = draginfo.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild;\n      editor.toplevel.appendChild(draginfo.thumbstatus);\n      SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, editor.firstscrollingrow || 1);\n      }\n   else {\n      if (scc.TCTDFSthumbstatushClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatushClass;\n      SocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatushStyle);\n      draginfo.thumbstatus.style.top = (control.controlborder+scc.TCTDFStopOffseth)+\"px\";\n      draginfo.thumbstatus.style.left = (draginfo.clientX+scc.TCTDFSleftOffseth)+\"px\";\n      editor.toplevel.appendChild(draginfo.thumbstatus);\n      draginfo.thumbstatus.innerHTML = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(editor.firstscrollingcol);\n      }\n\n   }\n\n\n//\n// SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, row)\n//\n// Render partial row\n//\n\nSocialCalc.TCTDragFunctionRowSetStatus = function(draginfo, editor, row) {\n\n   var scc = SocialCalc.Constants;\n   var msg = scc.s_TCTDFthumbstatusPrefixv+row+\" \";\n\n   draginfo.thumbstatus.rowmsgele.innerHTML = msg;\n\n   draginfo.thumbcontext.rowpanes = [{first: row, last: row}];\n   draginfo.thumbrowshown = row;\n\n   var ele = draginfo.thumbcontext.RenderSheet(draginfo.thumbstatus.rowpreviewele.firstChild, {type: \"html\"});\n\n   }\n\n\n//\n// TCTDragFunctionMove(event, draginfo, dobj)\n//\n\nSocialCalc.TCTDragFunctionMove = function(event, draginfo, dobj) {\n\n   var first, msg;\n   var control = dobj.functionobj.control;\n   var thumbthickness = control.thumbthickness;\n   var editor = control.editor;\n   var scc = SocialCalc.Constants;\n\n   if (dobj.vertical) {\n      if (draginfo.clientY > control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2)\n         draginfo.clientY = control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2;\n      if (draginfo.clientY < control.scrollareastart - draginfo.offsetY - 1)\n         draginfo.clientY = control.scrollareastart - draginfo.offsetY - 1;\n      draginfo.thumbstatus.style.top = draginfo.clientY+\"px\";\n\n      first =\n         ((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n         * (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\n         + editor.lastnonscrollingrow + 1;\n      first = Math.floor(first);\n      if (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\n      if (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\n//      msg = scc.s_TCTDFthumbstatusPrefixv+first;\n      if (first != draginfo.thumbrowshown) {\n         SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, first);\n         }\n      }\n   else {\n      if (draginfo.clientX > control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2)\n         draginfo.clientX = control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2;\n      if (draginfo.clientX < control.scrollareastart - draginfo.offsetX - 1)\n         draginfo.clientX = control.scrollareastart - draginfo.offsetX - 1;\n      draginfo.thumbstatus.style.left = draginfo.clientX+\"px\";\n\n      first =\n         ((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n         * (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\n         + editor.lastnonscrollingcol + 1;\n      first = Math.floor(first);\n      if (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\n      if (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\n      msg = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(first);\n      draginfo.thumbstatus.innerHTML = msg;\n      }\n\n   SocialCalc.DragFunctionPosition(event, draginfo, dobj);\n\n   }\n\n//\n// TCTDragFunctionStop(event, draginfo, dobj)\n//\n\nSocialCalc.TCTDragFunctionStop = function(event, draginfo, dobj) {\n\n   var first;\n   var control = dobj.functionobj.control;\n   var editor = control.editor;\n\n   if (dobj.vertical) {\n      first =\n         ((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n         * (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\n         + editor.lastnonscrollingrow + 1;\n      first = Math.floor(first);\n      if (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\n      if (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\n\n      editor.context.SetRowPaneFirstLast(editor.context.rowpanes.length-1, first, first+1);\n      }\n   else {\n      first =\n         ((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\n         * (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\n         + editor.lastnonscrollingcol + 1;\n      first = Math.floor(first);\n      if (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\n      if (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\n\n      editor.context.SetColPaneFirstLast(editor.context.colpanes.length-1, first, first+1);\n      }\n\n   editor.FitToEditTable();\n\n   if (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\n   if (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\n   editor.toplevel.removeChild(draginfo.thumbstatus);\n   draginfo.thumbstatus = null;\n\n   editor.ScheduleRender();\n\n   }\n\n// *************************************\n//\n// Dragging functions:\n//\n// *************************************\n\nSocialCalc.DragInfo = {\n\n   // There is only one of these -- no \"new\" is done.\n   // Only one dragging operation can be active at a time.\n   // The registeredElements array is used to decide which item to drag.\n \n   // One item for each draggable thing, each an object with:\n   //    .element, .vertical, .horizontal, .functionobj, .parent\n\n   registeredElements: [],\n\n   // Items used during a drag\n\n   draggingElement: null, // item being processed (.element is the actual element)\n   startX: 0,\n   startY: 0,\n   startZ: 0,\n   clientX: 0, // modifyable version to restrict movement\n   clientY: 0,\n   offsetX: 0,\n   offsetY: 0,\n   relativeOffset: {left:0,top:0} // retrieved at drag start\n\n   }\n\n//\n// DragRegister(element, vertical, horizontal, functionobj, parent) - make element draggable\n//\n// The functionobj defaults to moving the element contrained only by vertical and horizontal settings.\n//\n\nSocialCalc.DragRegister = function(element, vertical, horizontal, functionobj, parent) {\n\n   var draginfo = SocialCalc.DragInfo;\n\n   if (!functionobj) {\n      functionobj = {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\n                     MouseUp: SocialCalc.DragFunctionPosition,\n                     Disabled: null};\n      }\n\n   draginfo.registeredElements.push(\n      {element: element, vertical: vertical, horizontal: horizontal, functionobj: functionobj, parent: parent}\n      );\n\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\n      element.addEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\n      }\n   else if (element.attachEvent) { // IE 5+\n      element.attachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\n      }\n   else { // don't handle this\n      throw SocialCalc.Constants.s_BrowserNotSupported;\n      }\n\n   }\n\n//\n// DragUnregister(element) - remove object from list\n//\n\nSocialCalc.DragUnregister = function(element) {\n\n   var draginfo = SocialCalc.DragInfo;\n\n   var i;\n\n   if (!element) return;\n\n   for (i=0; i<draginfo.registeredElements.length; i++) {\n      if (draginfo.registeredElements[i].element == element) {\n         draginfo.registeredElements.splice(i,1);\n         if (element.removeEventListener) { // DOM Level 2 -- Firefox, et al\n            element.removeEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\n            }\n         else { // IE 5+\n            element.detachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\n            }\n         return;\n         }\n      }\n\n   return; // ignore if not in list\n\n   }\n\n//\n// DragMouseDown(event)\n//\n\nSocialCalc.DragMouseDown = function(event) {\n\n   var e = event || window.event;\n\n   var draginfo = SocialCalc.DragInfo;\n\n   var dobj = SocialCalc.LookupElement(e.target || e.srcElement, draginfo.registeredElements);\n   if (!dobj) return;\n\n   if (dobj && dobj.functionobj && dobj.functionobj.Disabled) {\n      if (dobj.functionobj.Disabled(e, draginfo, dobj)) {\n         return;\n         }\n      }\n\n   draginfo.draggingElement = dobj;\n   if (dobj.parent) {\n      draginfo.relativeOffset = SocialCalc.GetElementPositionWithScroll(dobj.parent);\n      }\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\n   draginfo.startX = draginfo.clientX;\n   draginfo.startY = draginfo.clientY;\n   draginfo.startZ = dobj.element.style.zIndex;\n   draginfo.offsetX = 0;\n   draginfo.offsetY = 0;\n\n   dobj.element.style.zIndex = \"100\";\n   SocialCalc.SetMouseMoveUp(SocialCalc.DragMouseMove,\n\t\t\t     SocialCalc.DragMouseUp,\n\t\t\t     dobj.element,\n\t\t\t     e);\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseDown) dobj.functionobj.MouseDown(e, draginfo, dobj);\n\n   return false;\n\n   }\n\n//\n// DragMouseMove(event)\n//\n\nSocialCalc.DragMouseMove = function(event) {\n\n   var e = event || window.event;\n\n   var draginfo = SocialCalc.DragInfo;\n   var dobj = draginfo.draggingElement;\n\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\n   SocialCalc.StopPropagation(e);\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseMove) dobj.functionobj.MouseMove(e, draginfo, dobj);\n   return false;\n   }\n\n//\n// DragMouseUp(event)\n//\n\nSocialCalc.DragMouseUp = function(event) {\n\n   var e = event || window.event;\n\n   var draginfo = SocialCalc.DragInfo;\n   var dobj = draginfo.draggingElement;\n\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\n\n   dobj.element.style.zIndex = draginfo.startZ;\n\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseUp) dobj.functionobj.MouseUp(e, draginfo, dobj);\n   SocialCalc.RemoveMouseMoveUp(SocialCalc.DragMouseMove,\n\t\t\t\tSocialCalc.DragMouseUp,\n\t\t\t\tdobj.element, e);\n   draginfo.draggingElement = null;\n   return false;\n   }\n\n//\n// DragFunctionStart(event, draginfo, dobj)\n//\n\nSocialCalc.DragFunctionStart = function(event, draginfo, dobj) {\n\n   var element = dobj.functionobj.positionobj || dobj.element;\n\n   draginfo.offsetY = parseInt(element.style.top) - draginfo.clientY;\n   draginfo.offsetX = parseInt(element.style.left) - draginfo.clientX;\n\n   }\n\n//\n// DragFunctionPosition(event, draginfo, dobj)\n//\n\nSocialCalc.DragFunctionPosition = function(event, draginfo, dobj) {\n\n   var element = dobj.functionobj.positionobj || dobj.element;\n\n   if (dobj.vertical) element.style.top = (draginfo.clientY + draginfo.offsetY)+\"px\";\n   if (dobj.horizontal) element.style.left = (draginfo.clientX + draginfo.offsetX)+\"px\";\n\n   }\n\n// *************************************\n//\n// Tooltip functions:\n//\n// *************************************\n\nSocialCalc.TooltipInfo = {\n\n   // There is only one of these -- no \"new\" is done.\n   // Only one tooltip operation can be active at a time.\n   // The registeredElements array is used to identify items.\n\n   // One item for each element with a tooltip, each an object with:\n   //    .element, .tiptext, .functionobj, .parent\n   // Currently .functionobj can only contain .offsetx and .offsety.\n   // If present they are used instead of the default ones.\n\n   registeredElements: [],\n\n   registered: false, // if true, an event handler has been registered for this functionality\n\n   // Items used during hover over an element\n\n   tooltipElement: null, // item being processed (.element is the actual element)\n   timer: null, // timer object waiting to see if holding over element\n   popupElement: null, // tooltip element being displayed\n   clientX: 0, // modifyable version to restrict movement\n   clientY: 0,\n   offsetX: SocialCalc.Constants.TooltipOffsetX, // modifyable version to allow positioning\n   offsetY: SocialCalc.Constants.TooltipOffsetY\n\n   }\n\n//\n// TooltipRegister(element, tiptext, functionobj, parent) - make element have a tooltip\n//\n\nSocialCalc.TooltipRegister = function(element, tiptext, functionobj, parent) {\n\n   var tooltipinfo = SocialCalc.TooltipInfo;\n   tooltipinfo.registeredElements.push(\n      {element: element, tiptext: tiptext, functionobj: functionobj, parent: parent}\n      );\n\n   if (tooltipinfo.registered) return; // only need to add event listener once\n\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\n      document.addEventListener(\"mousemove\", SocialCalc.TooltipMouseMove, false);\n      }\n   else if (document.attachEvent) { // IE 5+\n      document.attachEvent(\"onmousemove\", SocialCalc.TooltipMouseMove);\n      }\n   else { // don't handle this\n      throw SocialCalc.Constants.s_BrowserNotSupported;\n      }\n\n   tooltipinfo.registered = true; // remember\n\n   return;\n\n   }\n\n//\n// TooltipMouseMove(event)\n//\n\nSocialCalc.TooltipMouseMove = function(event) {\n\n   var e = event || window.event;\n\n   var tooltipinfo = SocialCalc.TooltipInfo;\n\n   tooltipinfo.clientX = e.clientX;\n   tooltipinfo.clientY = e.clientY;\n\n   var tobj = SocialCalc.LookupElement(e.target || e.srcElement, tooltipinfo.registeredElements);\n\n   if (tooltipinfo.timer) { // waiting to see if holding still: didn't hold still\n      window.clearTimeout(tooltipinfo.timer); // cancel timer\n      tooltipinfo.timer = null;\n      }\n\n   if (tooltipinfo.popupElement) { // currently displaying a tip: hide it\n      SocialCalc.TooltipHide();\n      }\n\n   tooltipinfo.tooltipElement = tobj || null;\n\n   if (!tobj || SocialCalc.ButtonInfo.buttonDown) return; // if not an object with a tip or a \"button\" is down, ignore\n\n   tooltipinfo.timer = window.setTimeout(SocialCalc.TooltipWaitDone, 700);\n\n   if (tooltipinfo.tooltipElement.element.addEventListener) { // Register event for mouse down which cancels tooltip stuff\n      tooltipinfo.tooltipElement.element.addEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\n      }\n   else if (tooltipinfo.tooltipElement.element.attachEvent) { // IE\n      tooltipinfo.tooltipElement.element.attachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\n      }\n\n   return;\n\n   }\n\n//\n// TooltipMouseDown(event)\n//\n\nSocialCalc.TooltipMouseDown = function(event) {\n\n   var e = event || window.event;\n\n   var tooltipinfo = SocialCalc.TooltipInfo;\n\n   if (tooltipinfo.timer) {\n      window.clearTimeout(tooltipinfo.timer); // cancel timer\n      tooltipinfo.timer = null;\n      }\n\n   if (tooltipinfo.popupElement) { // currently displaying a tip: hide it\n      SocialCalc.TooltipHide();\n      }\n\n   if (tooltipinfo.tooltipElement) {\n      if (tooltipinfo.tooltipElement.element.removeEventListener) { // DOM Level 2 -- Firefox, et al\n         tooltipinfo.tooltipElement.element.removeEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\n         }\n      else if (tooltipinfo.tooltipElement.element.attachEvent) { // IE 5+\n         tooltipinfo.tooltipElement.element.detachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\n         }\n      tooltipinfo.tooltipElement = null;\n      }\n\n   return;\n\n   }\n\n//\n// TooltipDisplay(tobj)\n//\n\nSocialCalc.TooltipDisplay = function(tobj) {\n\n   var tooltipinfo = SocialCalc.TooltipInfo;\n   var scc = SocialCalc.Constants;\n   var offsetX = (tobj.functionobj && ((typeof tobj.functionobj.offsetx) == \"number\")) ? \n      tobj.functionobj.offsetx : tooltipinfo.offsetX;\n   var offsetY = (tobj.functionobj && ((typeof tobj.functionobj.offsety) == \"number\")) ? \n      tobj.functionobj.offsety : tooltipinfo.offsetY;\n   var viewport = SocialCalc.GetViewportInfo();\n   var pos = SocialCalc.GetElementPositionWithScroll(tobj.parent);\n\n   tooltipinfo.popupElement = document.createElement(\"div\");\n   if (scc.TDpopupElementClass) tooltipinfo.popupElement.className = scc.TDpopupElementClass;\n   SocialCalc.setStyles(tooltipinfo.popupElement, scc.TDpopupElementStyle);\n\n   tooltipinfo.popupElement.innerHTML = tobj.tiptext;\n\n   if (tooltipinfo.clientX > viewport.width/2) { // on right side of screen\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY + pos.top)+\"px\";\n      tooltipinfo.popupElement.style.right = (pos.width - tooltipinfo.clientX + offsetX + pos.left)+\"px\";\n      }\n   else { // on left side of screen\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY + pos.top)+\"px\";\n      tooltipinfo.popupElement.style.left = (tooltipinfo.clientX + offsetX - pos.left)+\"px\";\n      }\n\n   if (tooltipinfo.clientY < 50) { // make sure fits on screen if nothing above grid\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY - 50 + pos.top)+\"px\";\n      }\n\n   tobj.parent.appendChild(tooltipinfo.popupElement);\n\n   }\n\n//\n// TooltipHide()\n//\n\nSocialCalc.TooltipHide = function() {\n\n   var tooltipinfo = SocialCalc.TooltipInfo;\n\n   if (tooltipinfo.popupElement) {\n      tooltipinfo.popupElement.parentNode.removeChild(tooltipinfo.popupElement);\n      tooltipinfo.popupElement = null;\n      }\n\n   }\n\n//\n// TooltipWaitDone()\n//\n\nSocialCalc.TooltipWaitDone = function() {\n\n   var tooltipinfo = SocialCalc.TooltipInfo;\n\n   tooltipinfo.timer = null;\n\n   SocialCalc.TooltipDisplay(tooltipinfo.tooltipElement);\n\n   }\n\n\n// *************************************\n//\n// Button functions:\n//\n// *************************************\n\nSocialCalc.ButtonInfo = {\n\n   // There is only one of these -- no \"new\" is done.\n   // Only one button operation can be active at a time.\n   // The registeredElements array is used to identify items.\n\n   // One item for each clickable element, each an object with:\n   //    .element, .normalstyle, .hoverstyle, .downstyle, .repeatinterval, .functionobj, .editor\n   //\n   // .functionobj is an object with optional function objects for:\n   //    mouseover, mouseout, mousedown, repeatinterval, mouseup, disabled\n\n   registeredElements: [],\n\n   // Items used during hover over an element, clicking, repeating, etc.\n\n   buttonElement: null, // item being processed, hover or down (.element is the actual element)\n   doingHover: false, // true if mouse is over one of our elements\n   buttonDown: false, // true if button down and buttonElement not null\n   timer: null, // timer object for repeating\n\n   // Used while processing an event\n\n   relativeOffset: null,\n   clientX: 0,\n   clientY: 0\n\n   }\n\n//\n// ButtonRegister(editor, element, paramobj, functionobj) - make element clickable\n//\n// The arguments (other than editor and element) may be null (meaning no change for style and no repeat)\n// The paramobj has the optional normalstyle, hoverstyle, downstyle, repeatwait, repeatinterval settings\n\nSocialCalc.ButtonRegister = function(editor, element, paramobj, functionobj) {\n\n   var buttoninfo = SocialCalc.ButtonInfo;\n\n   if (!paramobj) paramobj = {};\n\n   buttoninfo.registeredElements.push(\n      {name: paramobj.name, element: element, editor: editor,\n       normalstyle: paramobj.normalstyle, hoverstyle: paramobj.hoverstyle, downstyle: paramobj.downstyle,\n       repeatwait: paramobj.repeatwait, repeatinterval: paramobj.repeatinterval, functionobj: functionobj}\n      );\n\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\n      element.addEventListener(\"mousedown\", SocialCalc.ButtonMouseDown, false);\n      element.addEventListener(\"mouseover\", SocialCalc.ButtonMouseOver, false);\n      element.addEventListener(\"mouseout\", SocialCalc.ButtonMouseOut, false);\n      }\n   else if (element.attachEvent) { // IE 5+\n      element.attachEvent(\"onmousedown\", SocialCalc.ButtonMouseDown);\n      element.attachEvent(\"onmouseover\", SocialCalc.ButtonMouseOver);\n      element.attachEvent(\"onmouseout\", SocialCalc.ButtonMouseOut);\n      }\n   else { // don't handle this\n      throw SocialCalc.Constants.s_BrowserNotSupported;\n      }\n\n   return;\n   }\n\n//\n// ButtonMouseOver(event)\n//\n\nSocialCalc.ButtonMouseOver = function(event) {\n\n   var e = event || window.event;\n\n   var buttoninfo = SocialCalc.ButtonInfo;\n\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\n\n   if (!bobj) return;\n\n   if (buttoninfo.buttonDown) {\n      if (buttoninfo.buttonElement==bobj) {\n         buttoninfo.doingHover = true; // keep track whether we are on the pressed button or not\n         }\n      return;\n      }\n\n   if (buttoninfo.buttonElement &&\n          buttoninfo.buttonElement!=bobj && buttoninfo.doingHover) { // moved to a new one, undo hover there\n      SocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\n      }\n\n   buttoninfo.buttonElement = bobj; // remember this one is hovering\n   buttoninfo.doingHover = true;\n\n   SocialCalc.setStyles(bobj.element, bobj.hoverstyle); // set style (if provided)\n\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseOver) bobj.functionobj.MouseOver(e, buttoninfo, bobj);\n\n   return;\n\n   }\n\n//\n// ButtonMouseOut(event)\n//\n\nSocialCalc.ButtonMouseOut = function(event) {\n\n   var e = event || window.event;\n\n   var buttoninfo = SocialCalc.ButtonInfo;\n\n   if (buttoninfo.buttonDown) {\n      buttoninfo.doingHover = false; // keep track of overs and outs\n      return;\n      }\n\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\n\n   if (buttoninfo.doingHover) { // if there was a hover, undo it\n      if (buttoninfo.buttonElement)\n         SocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\n      buttoninfo.buttonElement = null;\n      buttoninfo.doingHover = false;\n      }\n\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseOut) bobj.functionobj.MouseOut(e, buttoninfo, bobj);\n\n   return;\n\n   }\n\n//\n// ButtonMouseDown(event)\n//\n\nSocialCalc.ButtonMouseDown = function(event) {\n\n   var e = event || window.event;\n\n   var buttoninfo = SocialCalc.ButtonInfo;\n\n   var viewportinfo = SocialCalc.GetViewportInfo();\n\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\n\n   if (!bobj) return; // not one of our elements\n\n   if (bobj && bobj.functionobj && bobj.functionobj.Disabled) {\n      if (bobj.functionobj.Disabled(e, buttoninfo, bobj)) {\n         return;\n         }\n      }\n\n   buttoninfo.buttonElement = bobj;\n   buttoninfo.buttonDown = true;\n\n   SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.downstyle);\n\n   // Register event handler for mouse up\n\n   // Event code from JavaScript, Flanagan, 5th Edition, pg. 422\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\n      document.addEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true); // capture everywhere\n      }\n   else if (bobj.element.attachEvent) { // IE 5+\n      bobj.element.setCapture();\n      bobj.element.attachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\n      bobj.element.attachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\n      }\n   SocialCalc.StopPropagation(e);\n   buttoninfo.relativeOffset = SocialCalc.GetElementPositionWithScroll(bobj.editor.toplevel);\n   buttoninfo.clientX = e.clientX - buttoninfo.relativeOffset.left;\n   buttoninfo.clientY = e.clientY - buttoninfo.relativeOffset.top;\n\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseDown) bobj.functionobj.MouseDown(e, buttoninfo, bobj);\n\n   if (bobj.repeatwait) { // if a repeat wait is set, then starting waiting for first repetition\n      buttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatwait);\n      }\n\n   return;\n\n   }\n\n//\n// ButtonMouseUp(event)\n//\n\nSocialCalc.ButtonMouseUp = function(event) {\n\n   var e = event || window.event;\n\n   var buttoninfo = SocialCalc.ButtonInfo;\n   var bobj = buttoninfo.buttonElement;\n\n   if (buttoninfo.timer) { // if repeating, cancel it\n      window.clearTimeout(buttoninfo.timer); // cancel timer\n      buttoninfo.timer = null;\n      }\n\n   if (!buttoninfo.buttonDown) return; // already did this (e.g., in IE, releaseCapture fires losecapture)\n   SocialCalc.StopPropagation(e);\n   if (document.removeEventListener) { // DOM Level 2\n      document.removeEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true);\n      }\n   else if (document.detachEvent) { // IE\n      bobj.element.detachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\n      bobj.element.detachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\n      bobj.element.releaseCapture();\n      }\n\n   if (buttoninfo.buttonElement.downstyle) {\n      if (buttoninfo.doingHover)\n         SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.hoverstyle);\n      else\n         SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.normalstyle);\n      }\n\n   buttoninfo.buttonDown = false;\n\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseUp) bobj.functionobj.MouseUp(e, buttoninfo, bobj);\n\n   }\n\n//\n// ButtonRepeat()\n//\n\nSocialCalc.ButtonRepeat = function() {\n\n   var buttoninfo = SocialCalc.ButtonInfo;\n   var bobj = buttoninfo.buttonElement;\n\n   if (!bobj) return;\n\n   if (bobj && bobj.functionobj && bobj.functionobj.Repeat) bobj.functionobj.Repeat(null, buttoninfo, bobj);\n\n   buttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatinterval || 100);\n\n   }\n\n// *************************************\n//\n// MouseWheel functions:\n//\n// *************************************\n\nSocialCalc.MouseWheelInfo = {\n\n   // There is only one of these -- no \"new\" is done.\n   // The mousewheel only affects the one area the mouse pointer is over\n   // The registeredElements array is used to identify items.\n\n   // One item for each element to respond to the mousewheel, each an object with:\n   //    .element, .functionobj\n\n   registeredElements: []\n\n   }\n\n//\n// MouseWheelRegister(element, functionobj) - make element respond to mousewheel\n//\n\nSocialCalc.MouseWheelRegister = function(element, functionobj) {\n\n   var mousewheelinfo = SocialCalc.MouseWheelInfo;\n\n   mousewheelinfo.registeredElements.push(\n      {element: element, functionobj: functionobj}\n      );\n\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\n      element.addEventListener(\"DOMMouseScroll\", SocialCalc.ProcessMouseWheel, false);\n      element.addEventListener(\"mousewheel\", SocialCalc.ProcessMouseWheel, false); // Opera needs this\n      }\n   else if (element.attachEvent) { // IE 5+\n      element.attachEvent(\"onmousewheel\", SocialCalc.ProcessMouseWheel);\n      }\n   else { // don't handle this\n      throw SocialCalc.Constants.s_BrowserNotSupported;\n      }\n\n   return;\n\n   }\n\nSocialCalc.ProcessMouseWheel = function(e) {\n\n   var event = e || window.event;\n   var delta;\n\n   if (SocialCalc.Keyboard.passThru) return; // ignore\n\n   var mousewheelinfo = SocialCalc.MouseWheelInfo;\n   var ele = event.target || event.srcElement; // source object is often within what we want\n   var wobj;\n\n   for (wobj=null; !wobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\n      wobj = SocialCalc.LookupElement(ele, mousewheelinfo.registeredElements);\n      }\n   if (!wobj) return; // not one of our elements\n\n   if (event.wheelDelta) {\n      delta = event.wheelDelta/120;\n      }\n   else delta = -event.detail/3;\n   if (!delta) delta = 0;\n\n   if (wobj.functionobj && wobj.functionobj.WheelMove) wobj.functionobj.WheelMove(event, delta, mousewheelinfo, wobj);\n\n   if (event.preventDefault) event.preventDefault();\n   event.returnValue = false;\n\n   }\n\n// *************************************\n//\n// Keyboard functions:\n//\n// For more information about keyboard handling, see: http://unixpapa.com/js/key.html\n//\n// *************************************\n\nSocialCalc.keyboardTables = {\n\n   specialKeysCommon: {\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\n      46: \"[del]\", 113: \"[f2]\"\n      },\n\n   specialKeysIE: {\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\n      46: \"[del]\", 113: \"[f2]\"\n      },\n\n   controlKeysIE: {\n      67: \"[ctrl-c]\",\n      83: \"[ctrl-s]\",\n      86: \"[ctrl-v]\",\n      88: \"[ctrl-x]\",\n      90: \"[ctrl-z]\"\n      },\n\n   specialKeysOpera: {\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\n      45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\n      46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\n      113: \"[f2]\"\n      },\n\n   controlKeysOpera: {\n      67: \"[ctrl-c]\",\n      83: \"[ctrl-s]\",\n      86: \"[ctrl-v]\",\n      88: \"[ctrl-x]\",\n      90: \"[ctrl-z]\"\n      },\n\n   specialKeysSafari: {\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\n      63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\n      63277: \"[pgdn]\", 63237: \"[f2]\"\n      },\n\n   controlKeysSafari: {\n      99: \"[ctrl-c]\",\n      115: \"[ctrl-s]\",\n      118: \"[ctrl-v]\",\n      120: \"[ctrl-x]\",\n      122: \"[ctrl-z]\"\n      },\n\n   ignoreKeysSafari: {\n      63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\n      63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\n      },\n\n   specialKeysFirefox: {\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\n      46: \"[del]\", 113: \"[f2]\"\n      },\n\n   controlKeysFirefox: {\n      99: \"[ctrl-c]\",\n      115: \"[ctrl-s]\",\n      118: \"[ctrl-v]\",\n      120: \"[ctrl-x]\",\n      122: \"[ctrl-z]\"\n      },\n\n   ignoreKeysFirefox: {\n      16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\n      91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\n      117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\n      144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\n      }\n   }\n\nSocialCalc.Keyboard = {\n   areListener: false, // if true, we have been installed as a listener for keyboard events\n   focusTable: null, // the table editor object that gets keystrokes or null\n   passThru: null, // if not null, control element with focus to pass keyboard events to (has blur method), or \"true\"\n   didProcessKey: false, // did SocialCalc.ProcessKey in keydown\n   statusFromProcessKey: false, // the status from the keydown SocialCalc.ProcessKey\n   repeatingKeyPress: false, // some browsers (Opera, Gecko Mac) repeat special keys as KeyPress not KeyDown\n   chForProcessKey: \"\" // remember so can do repeat in those cases\n   };\n\nSocialCalc.KeyboardSetFocus = function(editor) {\n\n   SocialCalc.Keyboard.focusTable = editor;\n\n   if (!SocialCalc.Keyboard.areListener) {\n      document.onkeydown = SocialCalc.ProcessKeyDown;\n      document.onkeypress = SocialCalc.ProcessKeyPress;\n      SocialCalc.Keyboard.areListener = true;\n      }\n   if (SocialCalc.Keyboard.passThru) {\n      if (SocialCalc.Keyboard.passThru.blur) {\n         SocialCalc.Keyboard.passThru.blur();\n         }\n      SocialCalc.Keyboard.passThru = null;\n      }\n   window.focus();\n   }\n\nSocialCalc.KeyboardFocus = function() {\n\n   SocialCalc.Keyboard.passThru = null;\n   window.focus();\n\n   }\n\nSocialCalc.ProcessKeyDown = function(e) {\n\n   var kt = SocialCalc.keyboardTables;\n   kt.didProcessKey = false; // always start false\n   kt.statusFromProcessKey = false;\n   kt.repeatingKeyPress = false;\n\n   var ch=\"\";\n   var status=true;\n\n   if (SocialCalc._app) return; // // ignore in app - widgets need control\n   if (SocialCalc.Keyboard.passThru) return; // ignore\n\n   e = e || window.event;\n\n   if (e.which==undefined) { // IE\n      ch = kt.specialKeysCommon[e.keyCode];\n      if (!ch) {\n         if (e.ctrlKey) {\n            ch=kt.controlKeysIE[e.keyCode];\n            }\n         if (!ch)\n            return true;\n         }\n      status = SocialCalc.ProcessKey(ch, e);\n\n      if (!status) {\n         if (e.preventDefault) e.preventDefault();\n            e.returnValue = false;\n         }\n      }\n\n   else { \n      ch = kt.specialKeysCommon[e.keyCode];\n      if (!ch) {\n//         return true;\n         if (e.ctrlKey || e.metaKey) {\n            ch=kt.controlKeysIE[e.keyCode]; // this works here\n            }\n         if (!ch)\n            return true;\n         }\n\n      status = SocialCalc.ProcessKey(ch, e); // process the key\n      kt.didProcessKey = true; // remember what happened\n      kt.statusFromProcessKey = status;\n      kt.chForProcessKey = ch;\n      }\n\n   return status;\n\n   }\n\nSocialCalc.ProcessKeyPress = function(e) {\n\n   var kt = SocialCalc.keyboardTables;\n\n   var ch=\"\";\n\n   e = e || window.event;\n   if (SocialCalc._app) return; // // ignore in app - widgets need control\n   \n   if (SocialCalc.Keyboard.passThru) return; // ignore\n   if (kt.didProcessKey) { // already processed this key\n      if (kt.repeatingKeyPress) {\n         return SocialCalc.ProcessKey(kt.chForProcessKey, e); // process the same key as on KeyDown\n         }\n      else {\n         kt.repeatingKeyPress = true; // see if get another KeyPress before KeyDown\n         return kt.statusFromProcessKey; // do what it said to do\n         }\n      }\n\n   if (e.which==undefined) { // IE\n      // Note: Esc and Enter will come through here, too, if not stopped at KeyDown\n      ch=String.fromCharCode(e.keyCode); // convert to a character (special chars handled at ev1)\n      }\n\n   else { // not IE\n      if (!e.which)\n         return false; // ignore - special key\n      if (e.charCode==undefined) { // Opera\n         if (e.which!=0) { // character\n            if (e.which<32 || e.which==144) { // special char (144 is numlock)\n               ch = kt.specialKeysOpera[e.which];\n               if (ch) {\n                  return true;\n                  }\n               }\n            else {\n               if (e.ctrlKey) {\n                  ch=kt.controlKeysOpera[e.keyCode];\n                  }\n               else {\n                  ch = String.fromCharCode(e.which);\n                  }\n               }\n            }\n         else { // special char\n            return true;\n            }\n         }\n\n      else if (e.keyCode==0 && e.charCode==0) { // OLPC Fn key or something\n         return; // ignore\n         }\n\n      else if (e.keyCode==e.charCode) { // Safari\n         ch = kt.specialKeysSafari[e.keyCode];\n         if (!ch) {\n            if (kt.ignoreKeysSafari[e.keyCode]) // pass this through\n               return true;\n            if (e.metaKey) {\n               ch=kt.controlKeysSafari[e.keyCode];\n               }\n            else {\n               ch = String.fromCharCode(e.which);\n               }\n            }\n         }\n\n      else { // Firefox\n         if (kt.specialKeysFirefox[e.keyCode]) {\n            return true;\n            }\n         ch = String.fromCharCode(e.which);\n         if (e.ctrlKey || e.metaKey) {\n            ch = kt.controlKeysFirefox[e.which];\n            }\n         }\n      }\n\n   var status = SocialCalc.ProcessKey(ch, e);\n\n   if (!status) {\n      if (e.preventDefault) e.preventDefault();\n      e.returnValue = false;\n      }\n\n   return status;\n\n   }\n\n//\n// status = SocialCalc.ProcessKey(ch, e)\n//\n// Take a key representation as a character string and dispatch to appropriate routine\n//\n\nSocialCalc.ProcessKey = function (ch, e) {\n   var ft = SocialCalc.Keyboard.focusTable;\n   if (!ft) return true; // we're not handling it -- let browser do default\n   return ft.EditorProcessKey(ch, e);\n   }\n\n\n//\n/*\n// SocialCalc Number Formatting Library\n//\n// Part of the SocialCalc package.\n//\n// (c) Copyright 2008 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\n\nSocialCalc.FormatNumber = {};\n\nSocialCalc.FormatNumber.format_definitions = {}; // Parsed formats are stored here globally\n\n// Most constants that are often customized for localization are in the SocialCalc.Constants module.\n// If you use this module standalone, provide at least the \"FormatNumber\" values.\n//\n\n// The following values may be customized externally for further localization of the format definitions themselves,\n// but that would make them incompatible with other uses and is discouraged.\n//\n\nSocialCalc.FormatNumber.separatorchar = \",\";\nSocialCalc.FormatNumber.decimalchar = \".\";\nSocialCalc.FormatNumber.daynames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\nSocialCalc.FormatNumber.daynames3 = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\nSocialCalc.FormatNumber.monthnames3 = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\nSocialCalc.FormatNumber.monthnames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\n                                      \"October\", \"November\", \"December\"];\n\nSocialCalc.FormatNumber.allowedcolors =\n   {BLACK: \"#000000\", BLUE: \"#0000FF\", CYAN: \"#00FFFF\", GREEN: \"#00FF00\", MAGENTA: \"#FF00FF\",\n    RED: \"#FF0000\", WHITE: \"#FFFFFF\", YELLOW: \"#FFFF00\"};\n\nSocialCalc.FormatNumber.alloweddates =\n   {H: \"h]\", M: \"m]\", MM: \"mm]\", S: \"s]\", SS: \"ss]\"};\n\n// Other constants\n\nSocialCalc.FormatNumber.commands =\n   {copy: 1, color: 2, integer_placeholder: 3, fraction_placeholder: 4, decimal: 5,\n    currency: 6, general:7, separator: 8, date: 9, comparison: 10, section: 11, style: 12};\n\nSocialCalc.FormatNumber.datevalues = {julian_offset: 2415019, seconds_in_a_day: 24 * 60 * 60, seconds_in_an_hour: 60 * 60};\n\n/* *******************\n\n result = SocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)\n\n************************* */\n\nSocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char) {\n\n   var scc = SocialCalc.Constants;\n   var scfn = SocialCalc.FormatNumber;\n\n   var op, operandstr, fromend, cval, operandstrlc;\n   var startval, estartval;\n   var hrs, mins, secs, ehrs, emins, esecs, ampmstr, ymd;\n   var minOK, mpos;\n   var result=\"\";\n   var thisformat;\n   var section, gotcomparison, compop, compval, cpos, oppos;\n   var sectioninfo;\n   var i, decimalscale, scaledvalue, strvalue, strparts, integervalue, fractionvalue;\n   var integerdigits2, integerpos, fractionpos, textcolor, textstyle, separatorchar, decimalchar;\n   var value; // working copy to change sign, etc.\n\n   rawvalue = rawvalue-0; // make sure a number\n   value = rawvalue;\n   if (!isFinite(value)) return \"NaN\";\n\n   var negativevalue = value < 0 ? 1 : 0; // determine sign, etc.\n   if (negativevalue) value = -value;\n   var zerovalue = value == 0 ? 1 : 0;\n\n   currency_char = currency_char || scc.FormatNumber_DefaultCurrency;\n\n   scfn.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed\n   thisformat = scfn.format_definitions[format_string]; // Get format structure\n\n   if (!thisformat) throw \"Format not parsed error!\";\n\n   section = thisformat.sectioninfo.length - 1; // get number of sections - 1\n\n   if (thisformat.hascomparison) { // has comparisons - determine which section\n      section = 0; // set to which section we will use\n      gotcomparison = 0; // this section has no comparison\n      for (cpos=0; ;cpos++) { // scan for comparisons\n         op = thisformat.operators[cpos];\n         operandstr = thisformat.operands[cpos]; // get next operator and operand\n         if (!op) { // at end with no match\n            if (gotcomparison) { // if comparison but no match\n               format_string = \"General\"; // use default of General\n               scfn.parse_format_string(scfn.format_definitions, format_string);\n               thisformat = scfn.format_definitions[format_string];\n               section = 0;\n               }\n            break; // if no comparision, matches on this section\n            }\n         if (op == scfn.commands.section) { // end of section\n            if (!gotcomparison) { // no comparison, so it's a match\n               break;\n               }\n            gotcomparison = 0;\n            section++; // check out next one\n            continue;\n            }\n         if (op == scfn.commands.comparison) { // found a comparison - do we meet it?\n            i=operandstr.indexOf(\":\");\n            compop=operandstr.substring(0,i);\n            compval=operandstr.substring(i+1)-0;\n            if ((compop == \"<\" && rawvalue < compval) ||\n                (compop == \"<=\" && rawvalue <= compval) ||\n                (compop == \"=\" && rawvalue == compval) ||\n                (compop == \"<>\" && rawvalue != compval) ||\n                (compop == \">=\" && rawvalue >= compval) ||\n                (compop == \">\" && rawvalue > compval)) { // a match\n               break;\n               }\n            gotcomparison = 1;\n            }\n         }\n      }\n   else if (section > 0) { // more than one section (separated by \";\")\n      if (section == 1) { // two sections\n         if (negativevalue) {\n            negativevalue = 0; // sign will provided by section, not automatically\n            section = 1; // use second section for negative values\n            }\n         else {\n            section = 0; // use first for all others\n            }\n         }\n      else if (section == 2) { // three sections\n         if (negativevalue) {\n            negativevalue = 0; // sign will provided by section, not automatically\n            section = 1; // use second section for negative values\n            }\n         else if (zerovalue) {\n            section = 2; // use third section for zero values\n            }\n         else {\n            section = 0; // use first for positive\n            }\n         }\n      }\n\n   sectioninfo = thisformat.sectioninfo[section]; // look at values for our section\n\n   if (sectioninfo.commas > 0) { // scale by thousands\n      for (i=0; i<sectioninfo.commas; i++) {\n         value /= 1000;\n         }\n      }\n   if (sectioninfo.percent > 0) { // do percent scaling\n      for (i=0; i<sectioninfo.percent; i++) {\n         value *= 100;\n         }\n      }\n\n   decimalscale = 1; // cut down to required number of decimal digits\n   for (i=0; i<sectioninfo.fractiondigits; i++) {\n      decimalscale *= 10;\n      }\n   scaledvalue = Math.floor(value * decimalscale + 0.5);\n   scaledvalue = scaledvalue / decimalscale;\n\n   if (typeof scaledvalue != \"number\") return \"NaN\";\n   if (!isFinite(scaledvalue)) return \"NaN\";\n\n   strvalue = scaledvalue+\"\"; // convert to string (Number.toFixed doesn't do all we need)\n\n//   strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits\n                                                         // and convert to string\n\n   if (scaledvalue == 0 && (sectioninfo.fractiondigits || sectioninfo.integerdigits)) {\n      negativevalue = 0; // no \"-0\" unless using multiple sections or General\n      }\n\n   if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\n      return rawvalue+\"\"; // Just return plain converted raw value\n      }\n\n   strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\n   if (!strparts) return \"NaN\"; // if not a number\n   integervalue = strparts[1];\n   if (!integervalue || integervalue==\"0\") integervalue=\"\";\n   fractionvalue = strparts[2];\n   if (!fractionvalue) fractionvalue = \"\";\n\n   if (sectioninfo.hasdate) { // there are date placeholders\n      if (rawvalue < 0) { // bad date\n         return \"??-???-??&nbsp;??:??:??\";\n         }\n      startval = (rawvalue-Math.floor(rawvalue)) * scfn.datevalues.seconds_in_a_day; // get date/time parts\n      estartval = rawvalue * scfn.datevalues.seconds_in_a_day; // do elapsed time version, too\n      hrs = Math.floor(startval / scfn.datevalues.seconds_in_an_hour);\n      ehrs = Math.floor(estartval / scfn.datevalues.seconds_in_an_hour);\n      startval = startval - hrs * scfn.datevalues.seconds_in_an_hour;\n      mins = Math.floor(startval / 60);\n      emins = Math.floor(estartval / 60);\n      secs = startval - mins * 60;\n      decimalscale = 1; // round appropriately depending if there is ss.0\n      for (i=0; i<sectioninfo.fractiondigits; i++) {\n         decimalscale *= 10;\n         }\n      secs = Math.floor(secs * decimalscale + 0.5);\n      secs = secs / decimalscale;\n      esecs = Math.floor(estartval * decimalscale + 0.5);\n      esecs = esecs / decimalscale;\n      if (secs >= 60) { // handle round up into next second, minute, etc.\n         secs = 0;\n         mins++; emins++;\n         if (mins >= 60) {\n            mins = 0;\n            hrs++; ehrs++;\n            if (hrs >= 24) {\n               hrs = 0;\n               rawvalue++;\n               }\n            }\n         }\n      fractionvalue = (secs-Math.floor(secs))+\"\"; // for \"hh:mm:ss.000\"\n      fractionvalue = fractionvalue.substring(2); // skip \"0.\"\n\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(rawvalue+scfn.datevalues.julian_offset));\n\n      minOK = 0; // says \"m\" can be minutes if true\n      mspos = sectioninfo.sectionstart; // m scan position in ops\n      for ( ; ; mspos++) { // scan for \"m\" and \"mm\" to see if any minutes fields, and am/pm\n         op = thisformat.operators[mspos];\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\n         if (!op) break; // don't go past end\n         if (op==scfn.commands.section) break;\n         if (op==scfn.commands.date) {\n            if ((operandstr.toLowerCase()==\"am/pm\" || operandstr.toLowerCase()==\"a/p\") && !ampmstr) {\n               if (hrs >= 12) {\n                  hrs -= 12;\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_pm1 : scc.s_FormatNumber_pm; // \"P\" : \"PM\";\n                  }\n               else {\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_am1 : scc.s_FormatNumber_am; // \"A\" : \"AM\";\n                  }\n               if (operandstr.indexOf(ampmstr)<0)\n                  ampmstr = ampmstr.toLowerCase(); // have case match case in format\n               }\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\n               }\n            if (operandstr.charAt(0)==\"h\") {\n               minOK = 1; // m following h or hh or [h] is minutes not months\n               }\n            else {\n               minOK = 0;\n               }\n            }\n         else if (op!=scfn.commands.copy) { // copying chars can be between h and m\n            minOK = 0;\n            }\n         }\n      minOK = 0;\n      for (--mspos; ; mspos--) { // scan other way for s after m\n         op = thisformat.operators[mspos];\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\n         if (!op) break; // don't go past end\n         if (op==scfn.commands.section) break;\n         if (op==scfn.commands.date) {\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\n               }\n            if (operandstr==\"ss\") {\n               minOK = 1; // m before ss is minutes not months\n               }\n            else {\n               minOK = 0;\n               }\n            }\n         else if (op!=scfn.commands.copy) { // copying chars can be between ss and m\n            minOK = 0;\n            }\n         }\n      }\n\n   integerdigits2 = 0; // init counters, etc.\n   integerpos = 0;\n   fractionpos = 0;\n   textcolor = \"\";\n   textstyle = \"\";\n   separatorchar = scc.FormatNumber_separatorchar;\n   if (separatorchar.indexOf(\" \")>=0) separatorchar = separatorchar.replace(/ /g, \"&nbsp;\");\n   decimalchar = scc.FormatNumber_decimalchar;\n   if (decimalchar.indexOf(\" \")>=0) decimalchar = decimalchar.replace(/ /g, \"&nbsp;\");\n\n   oppos = sectioninfo.sectionstart;\n\n   while (op = thisformat.operators[oppos]) { // execute format\n      operandstr = thisformat.operands[oppos++]; // get next operator and operand\n\n      if (op == scfn.commands.copy) { // put char in result\n         result += operandstr;\n         }\n\n      else if (op == scfn.commands.color) { // set color\n         textcolor = operandstr;\n         }\n\n      else if (op == scfn.commands.style) { // set style\n         textstyle = operandstr;\n         }\n\n      else if (op == scfn.commands.integer_placeholder) { // insert number part\n         if (negativevalue) {\n            result += \"-\";\n            negativevalue = 0;\n            }\n         integerdigits2++;\n         if (integerdigits2 == 1) { // first one\n            if (integervalue.length > sectioninfo.integerdigits) { // see if integer wider than field\n               for (;integerpos < (integervalue.length - sectioninfo.integerdigits); integerpos++) {\n                  result += integervalue.charAt(integerpos);\n                  if (sectioninfo.thousandssep) { // see if this is a separator position\n                     fromend = integervalue.length - integerpos - 1;\n                     if (fromend > 2 && fromend % 3 == 0) {\n                        result += separatorchar;\n                        }\n                     }\n                  }\n               }\n            }\n         if (integervalue.length < sectioninfo.integerdigits\n             && integerdigits2 <= sectioninfo.integerdigits - integervalue.length) { // field is wider than value\n            if (operandstr == \"0\" || operandstr == \"?\") { // fill with appropriate characters\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\n               if (sectioninfo.thousandssep) { // see if this is a separator position\n                  fromend = sectioninfo.integerdigits - integerdigits2;\n                  if (fromend > 2 && fromend % 3 == 0) {\n                     result += separatorchar;\n                     }\n                  }\n               }\n            }\n         else { // normal integer digit - add it\n            result += integervalue.charAt(integerpos);\n            if (sectioninfo.thousandssep) { // see if this is a separator position\n               fromend = integervalue.length - integerpos - 1;\n               if (fromend > 2 && fromend % 3 == 0) {\n                  result += separatorchar;\n                  }\n               }\n            integerpos++;\n            }\n         }\n      else if (op == scfn.commands.fraction_placeholder) { // add fraction part of number\n         if (fractionpos >= fractionvalue.length) {\n            if (operandstr == \"0\" || operandstr == \"?\") {\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\n               }\n            }\n         else {\n            result += fractionvalue.charAt(fractionpos);\n            }\n         fractionpos++;\n         }\n\n      else if (op == scfn.commands.decimal) { // decimal point\n         if (negativevalue) {\n            result += \"-\";\n            negativevalue = 0;\n            }\n         result += decimalchar;\n         }\n\n      else if (op == scfn.commands.currency) { // currency symbol\n         if (negativevalue) {\n            result += \"-\";\n            negativevalue = 0;\n            }\n         result += operandstr;\n         }\n\n      else if (op == scfn.commands.general) { // insert \"General\" conversion\n\n         // *** Cut down number of significant digits to avoid floating point artifacts:\n\n         if (value!=0) { // only if non-zero\n            var factor = Math.floor(Math.LOG10E * Math.log(value)); // get integer magnitude as a power of 10\n            factor = Math.pow(10, 13-factor); // turn into scaling factor\n            value = Math.floor(factor * value + 0.5)/factor; // scale positive value, round, undo scaling\n            if (!isFinite(value)) return \"NaN\";\n            }\n         if (negativevalue) {\n            result += \"-\";\n            }\n         strvalue = value+\"\"; // convert original value to string\n         if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\n            result += strvalue;\n            continue;\n            }\n         strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\n         integervalue = strparts[1];\n         if (!integervalue || integervalue==\"0\") integervalue=\"\";\n         fractionvalue = strparts[2];\n         if (!fractionvalue) fractionvalue = \"\";\n         integerpos = 0;\n         fractionpos = 0;\n         if (integervalue.length) {\n            for (;integerpos < integervalue.length; integerpos++) {\n               result += integervalue.charAt(integerpos);\n               if (sectioninfo.thousandssep) { // see if this is a separator position\n                  fromend = integervalue.length - integerpos - 1;\n                  if (fromend > 2 && fromend % 3 == 0) {\n                     result += separatorchar;\n                     }\n                  }\n               }\n             }\n         else {\n            result += \"0\";\n            }\n         if (fractionvalue.length) {\n            result += decimalchar;\n            for (;fractionpos < fractionvalue.length; fractionpos++) {\n               result += fractionvalue.charAt(fractionpos);\n               }\n            }\n         }\n      else if (op==scfn.commands.date) { // date placeholder\n         operandstrlc = operandstr.toLowerCase();\n         if (operandstrlc==\"y\" || operandstrlc==\"yy\") {\n            result += (ymd.year+\"\").substring(2);\n            }\n         else if (operandstrlc==\"yyyy\") {\n            result += ymd.year+\"\";\n            }\n         else if (operandstrlc==\"d\") {\n            result += ymd.day+\"\";\n            }\n         else if (operandstrlc==\"dd\") {\n            cval = 1000 + ymd.day;\n            result += (cval+\"\").substr(2);\n            }\n         else if (operandstrlc==\"ddd\") {\n            cval = Math.floor(rawvalue+6) % 7;\n            result += scc.s_FormatNumber_daynames3[cval];\n            }\n         else if (operandstrlc==\"dddd\") {\n            cval = Math.floor(rawvalue+6) % 7;\n            result += scc.s_FormatNumber_daynames[cval];\n            }\n         else if (operandstrlc==\"m\") {\n            result += ymd.month+\"\";\n            }\n         else if (operandstrlc==\"mm\") {\n            cval = 1000 + ymd.month;\n            result += (cval+\"\").substr(2);\n            }\n         else if (operandstrlc==\"mmm\") {\n            result += scc.s_FormatNumber_monthnames3[ymd.month-1];\n            }\n         else if (operandstrlc==\"mmmm\") {\n            result += scc.s_FormatNumber_monthnames[ymd.month-1];\n            }\n         else if (operandstrlc==\"mmmmm\") {\n            result += scc.s_FormatNumber_monthnames[ymd.month-1].charAt(0);\n            }\n         else if (operandstrlc==\"h\") {\n            result += hrs+\"\";\n            }\n         else if (operandstrlc==\"h]\") {\n            result += ehrs+\"\";\n            }\n         else if (operandstrlc==\"mmin\") {\n            cval = (1000 + mins)+\"\";\n            result += cval.substr(2);\n            }\n         else if (operandstrlc==\"mm]\") {\n            if (emins < 100) {\n               cval = (1000 + emins)+\"\";\n               result += cval.substr(2);\n               }\n            else {\n               result += emins+\"\";\n               }\n            }\n         else if (operandstrlc==\"min\") {\n            result += mins+\"\";\n            }\n         else if (operandstrlc==\"m]\") {\n            result += emins+\"\";\n            }\n         else if (operandstrlc==\"hh\") {\n            cval = (1000 + hrs)+\"\";\n            result += cval.substr(2);\n            }\n         else if (operandstrlc==\"s\") {\n            cval = Math.floor(secs);\n            result += cval+\"\";\n            }\n         else if (operandstrlc==\"ss\") {\n            cval = (1000 + Math.floor(secs))+\"\";\n            result += cval.substr(2);\n            }\n         else if (operandstrlc==\"am/pm\" || operandstrlc==\"a/p\") {\n            result += ampmstr;\n            }\n         else if (operandstrlc==\"ss]\") {\n            if (esecs < 100) {\n               cval = (1000 + Math.floor(esecs))+\"\";\n               result += cval.substr(2);\n               }\n            else {\n               cval = Math.floor(esecs);\n               result += cval+\"\";\n               }\n            }\n         }\n      else if (op == scfn.commands.section) { // end of section\n         break;\n         }\n\n      else if (op == scfn.commands.comparison) { // ignore\n         continue;\n         }\n\n      else {\n         result += \"!! Parse error !!\";\n         }\n      }\n\n   if (textcolor) {\n      result = '<span style=\"color:'+textcolor+';\">'+result+'</span>';\n      }\n   if (textstyle) {\n      result = '<span style=\"'+textstyle+';\">'+result+'</span>';\n      }\n\n   return result;\n\n   };\n\n/* *******************\n\n SocialCalc.FormatNumber.parse_format_string(format_defs, format_string)\n\n Takes a format string (e.g., \"#,##0.00_);(#,##0.00)\") and fills in format_defs with the parsed info\n\n format_defs\n    [\"#,##0.0\"]->{} - elements in the hash are one hash for each format\n       .operators->[] - array of operators from parsing the format string (each a number)\n       .operands->[] - array of corresponding operators (each usually a string)\n       .sectioninfo->[] - one hash for each section of the format\n          .start\n          .integerdigits\n          .fractiondigits\n          .commas\n          .percent\n          .thousandssep\n          .hasdates\n       .hascomparison - true if any section has [<100], etc.\n\n************************* */\n\nSocialCalc.FormatNumber.parse_format_string = function(format_defs, format_string) {\n\n   var scfn = SocialCalc.FormatNumber;\n\n   var thisformat, section, sectionfinfo;\n   var integerpart = 1; // start out in integer part\n   var lastwasinteger; // last char was an integer placeholder\n   var lastwasslash; // last char was a backslash - escaping following character\n   var lastwasasterisk; // repeat next char\n   var lastwasunderscore; // last char was _ which picks up following char for width\n   var inquote, quotestr; // processing a quoted string\n   var inbracket, bracketstr, bracketdata; // processing a bracketed string\n   var ingeneral, gpos; // checks for characters \"General\"\n   var ampmstr, part; // checks for characters \"A/P\" and \"AM/PM\"\n   var indate; // keeps track of date/time placeholders\n   var chpos; // character position being looked at\n   var ch; // character being looked at\n\n   if (format_defs[format_string]) return; // already defined - nothing to do\n\n   thisformat = {operators: [], operands: [], sectioninfo: [{}]}; // create info structure for this format\n   format_defs[format_string] = thisformat; // add to other format definitions\n\n   section = 0; // start with section 0\n   sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\n   sectioninfo.sectionstart = 0; // position in operands that starts this section\n   sectioninfo.integerdigits = 0; // number of integer-part placeholders\n   sectioninfo.fractiondigits = 0; // fraction placeholders\n   sectioninfo.commas = 0; // commas encountered, to handle scaling\n   sectioninfo.percent = 0; // times to scale by 100\n\n   for (chpos=0; chpos<format_string.length; chpos++) { // parse\n      ch = format_string.charAt(chpos); // get next char to examine\n      if (inquote) {\n         if (ch == '\"') {\n            inquote = 0;\n            thisformat.operators.push(scfn.commands.copy);\n            thisformat.operands.push(quotestr);\n            continue;\n            }\n         quotestr += ch;\n         continue;\n         }\n      if (inbracket) {\n         if (ch==']') {\n            inbracket = 0;\n            bracketdata=SocialCalc.FormatNumber.parse_format_bracket(bracketstr);\n            if (bracketdata.operator==scfn.commands.separator) {\n               sectioninfo.thousandssep = 1; // explicit [,]\n               continue;\n               }\n            if (bracketdata.operator==scfn.commands.date) {\n               sectioninfo.hasdate = 1;\n               }\n            if (bracketdata.operator==scfn.commands.comparison) {\n               thisformat.hascomparison = 1;\n               }\n            thisformat.operators.push(bracketdata.operator);\n            thisformat.operands.push(bracketdata.operand);\n            continue;\n            }\n         bracketstr += ch;\n         continue;\n         }\n      if (lastwasslash) {\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch);\n         lastwasslash=false;\n         continue;\n         }\n      if (lastwasasterisk) {\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch+ch+ch+ch+ch); // do 5 of them since no real tabs\n         lastwasasterisk=false;\n         continue;\n         }\n      if (lastwasunderscore) {\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(\"&nbsp;\");\n         lastwasunderscore=false;\n         continue;\n         }\n      if (ingeneral) {\n         if (\"general\".charAt(ingeneral)==ch.toLowerCase()) {\n            ingeneral++;\n            if (ingeneral == 7) {\n               thisformat.operators.push(scfn.commands.general);\n               thisformat.operands.push(ch);\n               ingeneral=0;\n               }\n            continue;\n            }\n         ingeneral = 0;\n         }\n      if (indate) { // last char was part of a date placeholder\n         if (indate.charAt(0)==ch) { // another of the same char\n            indate += ch; // accumulate it\n            continue;\n            }\n         thisformat.operators.push(scfn.commands.date); // something else, save date info\n         thisformat.operands.push(indate);\n         sectioninfo.hasdate=1;\n         indate = \"\";\n         }\n      if (ampmstr) {\n         ampmstr += ch;\n         part=ampmstr.toLowerCase();\n         if (part!=\"am/pm\".substring(0,part.length) && part!=\"a/p\".substring(0,part.length)) {\n            ampstr=\"\";\n            }\n         else if (part==\"am/pm\" || part==\"a/p\") {\n            thisformat.operators.push(scfn.commands.date);\n            thisformat.operands.push(ampmstr);\n            ampmstr = \"\";\n            }\n         continue;\n         }\n      if (ch==\"#\" || ch==\"0\" || ch==\"?\") { // placeholder\n         if (integerpart) {\n            sectioninfo.integerdigits++;\n            if (sectioninfo.commas) { // comma inside of integer placeholders\n               sectioninfo.thousandssep = 1; // any number is thousands separator\n               sectioninfo.commas = 0; // reset count of \"thousand\" factors\n               }\n            lastwasinteger = 1;\n            thisformat.operators.push(scfn.commands.integer_placeholder);\n            thisformat.operands.push(ch);\n            }\n         else {\n            sectioninfo.fractiondigits++;\n            thisformat.operators.push(scfn.commands.fraction_placeholder);\n            thisformat.operands.push(ch);\n            }\n         }\n      else if (ch==\".\") { // decimal point\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.decimal);\n         thisformat.operands.push(ch);\n         integerpart = 0;\n         }\n      else if (ch=='$') { // currency char\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.currency);\n         thisformat.operands.push(ch);\n         }\n      else if (ch==\",\") {\n         if (lastwasinteger) {\n            sectioninfo.commas++;\n            }\n         else {\n            thisformat.operators.push(scfn.commands.copy);\n            thisformat.operands.push(ch);\n            }\n         }\n      else if (ch==\"%\") {\n         lastwasinteger = 0;\n         sectioninfo.percent++;\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch);\n         }\n      else if (ch=='\"') {\n         lastwasinteger = 0;\n         inquote = 1;\n         quotestr = \"\";\n         }\n      else if (ch=='[') {\n         lastwasinteger = 0;\n         inbracket = 1;\n         bracketstr = \"\";\n         }\n      else if (ch=='\\\\') {\n         lastwasslash = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch=='*') {\n         lastwasasterisk = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch=='_') {\n         lastwasunderscore = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch==\";\") {\n         section++; // start next section\n         thisformat.sectioninfo[section] = {}; // create a new section\n         sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\n         sectioninfo.sectionstart = 1 + thisformat.operators.length; // remember where it starts\n         sectioninfo.integerdigits = 0; // number of integer-part placeholders\n         sectioninfo.fractiondigits = 0; // fraction placeholders\n         sectioninfo.commas = 0; // commas encountered, to handle scaling\n         sectioninfo.percent = 0; // times to scale by 100\n         integerpart = 1; // reset for new section\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.section);\n         thisformat.operands.push(ch);\n         }\n      else if (ch.toLowerCase()==\"g\") {\n         ingeneral = 1;\n         lastwasinteger = 0;\n         }\n      else if (ch.toLowerCase()==\"a\") {\n         ampmstr = ch;\n         lastwasinteger = 0;\n         }\n      else if (\"dmyhHs\".indexOf(ch)>=0) {\n         indate = ch;\n         }\n      else {\n         lastwasinteger = 0;\n         thisformat.operators.push(scfn.commands.copy);\n         thisformat.operands.push(ch);\n         }\n      }\n\n   if (indate) { // last char was part of unsaved date placeholder\n      thisformat.operators.push(scfn.commands.date);\n      thisformat.operands.push(indate);\n      sectioninfo.hasdate = 1;\n      }\n\n   return;\n\n   }\n\n\n/* *******************\n\n bracketdata = SocialCalc.FormatNumber.parse_format_bracket(bracketstr)\n\n Takes a bracket contents (e.g., \"RED\", \">10\") and returns an operator and operand\n\n bracketdata->{}\n    .operator\n    .operand\n\n************************* */\n\nSocialCalc.FormatNumber.parse_format_bracket = function(bracketstr) {\n\n   var scfn = SocialCalc.FormatNumber;\n   var scc = SocialCalc.Constants;\n\n   var bracketdata={};\n   var parts;\n\n   if (bracketstr.charAt(0)=='$') { // currency\n      bracketdata.operator = scfn.commands.currency;\n      parts=bracketstr.match(/^\\$(.+?)(\\-.+?){0,1}$/);\n      if (parts) {\n         bracketdata.operand = parts[1] || scc.FormatNumber_defaultCurrency || '$';\n         }\n      else {\n         bracketdata.operand = bracketstr.substring(1) || scc.FormatNumber_defaultCurrency || '$';\n         }\n      }\n   else if (bracketstr=='?$') {\n      bracketdata.operator = scfn.commands.currency;\n      bracketdata.operand = '[?$]';\n      }\n   else if (scfn.allowedcolors[bracketstr.toUpperCase()]) {\n      bracketdata.operator = scfn.commands.color;\n      bracketdata.operand = scfn.allowedcolors[bracketstr.toUpperCase()];\n      }\n   else if (parts=bracketstr.match(/^style=([^\"]*)$/)) { // [style=...]\n      bracketdata.operator = scfn.commands.style;\n      bracketdata.operand = parts[1];\n      }\n   else if (bracketstr==\",\") {\n      bracketdata.operator = scfn.commands.separator;\n      bracketdata.operand = bracketstr;\n      }\n   else if (scfn.alloweddates[bracketstr.toUpperCase()]) {\n      bracketdata.operator = scfn.commands.date;\n      bracketdata.operand = scfn.alloweddates[bracketstr.toUpperCase()];\n      }\n   else if (parts=bracketstr.match(/^[<>=]/)) { // comparison operator\n      parts=bracketstr.match(/^([<>=]+)(.+)$/); // split operator and value\n      bracketdata.operator = scfn.commands.comparison;\n      bracketdata.operand = parts[1]+\":\"+parts[2];\n      }\n   else { // unknown bracket\n      bracketdata.operator = scfn.commands.copy;\n      bracketdata.operand = \"[\"+bracketstr+\"]\";\n      }\n\n   return bracketdata;\n\n   }\n\n/* *******************\n\n juliandate = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, month, day)\n\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\n Translated from the FORTRAN\n\n      I= YEAR\n      J= MONTH\n      K= DAY\nC\n      JD= K-32075+1461*(I+4800+(J-14)/12)/4+367*(J-2-(J-14)/12*12)\n     2    /12-3*((I+4900+(J-14)/12)/100)/4\n\n************************* */\n\nSocialCalc.FormatNumber.convert_date_gregorian_to_julian = function(year, month, day) {\n\n   var juliandate;\n\n   juliandate = day-32075+SocialCalc.intFunc(1461*(year+4800+SocialCalc.intFunc((month-14)/12))/4);\n   juliandate += SocialCalc.intFunc(367*(month-2-SocialCalc.intFunc((month-14)/12)*12)/12);\n   juliandate = juliandate - SocialCalc.intFunc(3*SocialCalc.intFunc((year+4900+SocialCalc.intFunc((month-14)/12))/100)/4);\n\n   return juliandate;\n\n   }\n\n\n/* *******************\n\n ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(juliandate)\n\n ymd->{}\n    .year\n    .month\n    .day\n\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\n Translated from the FORTRAN\n\n************************* */\n\nSocialCalc.FormatNumber.convert_date_julian_to_gregorian = function(juliandate) {\n\n   var L, N, I, J, K;\n\n   L = juliandate+68569;\n   N = Math.floor(4*L/146097);\n   L = L-Math.floor((146097*N+3)/4);\n   I = Math.floor(4000*(L+1)/1461001);\n   L = L-Math.floor(1461*I/4)+31;\n   J = Math.floor(80*L/2447);\n   K = L-Math.floor(2447*J/80);\n   L = Math.floor(J/11);\n   J = J+2-12*L;\n   I = 100*(N-49)+I+L;\n\n   return {year:I, month:J, day:K};\n\n   }\n\nSocialCalc.intFunc = function(n) {\n   if (n < 0) {\n      return -Math.floor(-n);\n      }\n   else {\n      return Math.floor(n);\n      }\n   }\n\n//\n//\n/*\n// SocialCalc Spreadsheet Formula Library\n//\n// Part of the SocialCalc package\n//\n// (c) Copyright 2008 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\n// The SocialCalc 1.1.0 code was:\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\n//    All Rights Reserved.\n//    Portions (c) Copyright 2007 Socialtext, Inc.\n//    All Rights Reserved.\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\n// wikiCalc 1.0 was written by Software Garden, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\n                                     // In any case, requires SocialCalc.Constants.\n\nSocialCalc.Formula = {};\nSocialCalc.TriggerIoAction = {}; // eddy\n\n//\n// Formula constants for parsing:\n//\n\n   SocialCalc.Formula.ParseState = {num: 1, alpha: 2, coord: 3, string: 4, stringquote: 5, numexp1: 6, numexp2: 7, alphanumeric: 8, specialvalue:9};\n\n   SocialCalc.Formula.TokenType = {num: 1, coord: 2, op: 3, name: 4, error: 5, string: 6, space: 7};\n\n   SocialCalc.Formula.CharClass = {num: 1, numstart: 2, op: 3, eof: 4, alpha: 5, incoord: 6, error: 7, quote: 8, space: 9, specialstart: 10};\n \n   SocialCalc.Formula.CharClassTable = {\n      \" \": 9, \"!\": 3, '\"': 8, \"'\": 8, \"#\": 10, \"$\":6, \"%\":3, \"&\":3, \"(\": 3, \")\": 3, \"*\": 3, \"+\": 3, \",\": 3, \"-\": 3, \".\": 2, \"/\": 3,\n       \"0\": 1, \"1\": 1, \"2\": 1, \"3\": 1, \"4\": 1, \"5\": 1, \"6\": 1, \"7\": 1, \"8\": 1, \"9\": 1,\n       \":\": 3, \"<\": 3, \"=\": 3, \">\": 3,\n       \"A\": 5, \"B\": 5, \"C\": 5, \"D\": 5, \"E\": 5, \"F\": 5, \"G\": 5, \"H\": 5, \"I\": 5, \"J\": 5, \"K\": 5, \"L\": 5, \"M\": 5, \"N\": 5,\n       \"O\": 5, \"P\": 5, \"Q\": 5, \"R\": 5, \"S\": 5, \"T\": 5, \"U\": 5, \"V\": 5, \"W\": 5, \"X\": 5, \"Y\": 5, \"Z\": 5,\n       \"^\": 3, \"_\": 5,\n       \"a\": 5, \"b\": 5, \"c\": 5, \"d\": 5, \"e\": 5, \"f\": 5, \"g\": 5, \"h\": 5, \"i\": 5, \"j\": 5, \"k\": 5, \"l\": 5, \"m\": 5, \"n\": 5,\n       \"o\": 5, \"p\": 5, \"q\": 5, \"r\": 5, \"s\": 5, \"t\": 5, \"u\": 5, \"v\": 5, \"w\": 5, \"x\": 5, \"y\": 5, \"z\": 5\n       };\n\n   SocialCalc.Formula.UpperCaseTable = {\n       \"a\": \"A\", \"b\": \"B\", \"c\": \"C\", \"d\": \"D\", \"e\": \"E\", \"f\": \"F\", \"g\": \"G\", \"h\": \"H\", \"i\": \"I\", \"j\": \"J\", \"k\": \"K\", \"l\": \"L\", \"m\": \"M\",\n       \"n\": \"N\", \"o\": \"O\", \"p\": \"P\", \"q\": \"Q\", \"r\": \"R\", \"s\": \"S\", \"t\": \"T\", \"u\": \"U\", \"v\": \"V\", \"w\": \"W\", \"x\": \"X\", \"y\": \"Y\", \"z\": \"Z\",\n       \"A\": \"A\", \"B\": \"B\", \"C\": \"C\", \"D\": \"D\", \"E\": \"E\", \"F\": \"F\", \"G\": \"G\", \"H\": \"H\", \"I\": \"I\", \"J\": \"J\", \"K\": \"K\", \"L\": \"L\", \"M\": \"M\",\n       \"N\": \"N\", \"O\": \"O\", \"P\": \"P\", \"Q\": \"Q\", \"R\": \"R\", \"S\": \"S\", \"T\": \"T\", \"U\": \"U\", \"V\": \"V\", \"W\": \"W\", \"X\": \"X\", \"Y\": \"Y\", \"Z\": \"Z\"\n       }\n\n   SocialCalc.Formula.SpecialConstants = { // names that turn into constants for name lookup\n      \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\", \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\",\n      \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\n\n\n   // Operator Precedence table\n   //\n   // 1- !, 2- : ,, 3- M P, 4- %, 5- ^, 6- * /, 7- + -, 8- &, 9- < > = G(>=) L(<=) N(<>),\n   // Negative value means Right Associative\n\n   SocialCalc.Formula.TokenPrecedence = {\n      \"!\": 1,\n      \":\": 2, \",\": 2,\n      \"M\": -3, \"P\": -3,\n      \"%\": 4,\n      \"^\": 5,\n      \"*\": 6, \"/\": 6,\n      \"+\": 7, \"-\": 7,\n      \"&\": 8,\n      \"<\": 9, \">\": 9, \"G\": 9, \"L\": 9, \"N\": 9\n      };\n\n   // Convert one-char token text to input text:\n\n   SocialCalc.Formula.TokenOpExpansion = {'G': '>=', 'L': '<=', 'M': '-', 'N': '<>', 'P': '+'};\n\n   //\n   // Information about the resulting value types when doing operations on values (used by LookupResultType)\n   //\n   // Each object entry is an object with specific types with result type info as follows:\n   //\n   //    'type1a': '|type2a:resulta|type2b:resultb|...\n   //    Type of t* or n* matches any of those types not listed\n   //    Results may be a type or the numbers 1 or 2 specifying to return type1 or type2\n   \n\n   SocialCalc.Formula.TypeLookupTable = {\n       unaryminus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       unaryplus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       unarypercent: { 'n*': '|n:n%|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       plus: {\n                'n%': '|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'nd': '|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'nt': '|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'ndt': '|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'n$': '|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'nl': '|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'n': '|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                'b': '|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\n                't*': '|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|',\n                'e*': '|e*:1|n*:1|t*:1|b:1|'\n               },\n       concat: {\n                't': '|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|',\n                'th': '|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|',\n                'tw': '|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|',\n                'tl': '|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|',\n                't*': '|t*:t|e*:2|',\n                'e*': '|e*:1|n*:1|t*:1|'\n               },\n       oneargnumeric: { 'n*': '|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\n       twoargnumeric: { 'n*': '|n*:n|t*:e#VALUE!|e*:2|', 'e*': '|e*:1|n*:1|t*:1|', 't*': '|t*:e#VALUE!|n*:e#VALUE!|e*:2|'},\n       propagateerror: { 'n*': '|n*:2|e*:2|', 'e*': '|e*:2|', 't*': '|t*:2|e*:2|', 'b': '|b:2|e*:2|'}\n      };\n\n/* *******************\n\n parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(line)\n\n Parses a text string as if it was a spreadsheet formula\n\n This uses a simple state machine run on each character in turn.\n States remember whether a number is being gathered, etc.\n The result is parseinfo which is an array with one entry for each token:\n   parseinfo[i] = {\n     text: \"the characters making up the parsed token\",\n     type: the type of the token (a number),\n     opcode: a single character version of an operator suitable for use in the\n                  precedence table and distinguishing between unary and binary + and -.\n\n************************* */\n\nSocialCalc.Formula.ParseFormulaIntoTokens = function(line) {\n\n   var i, ch, cclass, haddecimal, last_token, last_token_type, last_token_text, t;\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var parsestate = scf.ParseState;\n   var tokentype = scf.TokenType;\n   var charclass = scf.CharClass;\n   var charclasstable = scf.CharClassTable;\n   var uppercasetable = scf.UpperCaseTable; // much faster than toUpperCase function\n   var pushtoken = scf.ParsePushToken;\n   var coordregex = /^\\$?[A-Z]{1,2}\\$?[1-9]\\d*$/i;\n\n   var parseinfo = [];\n   var str = \"\";\n   var state = 0;\n   var haddecimal = false;\n\n  for (i=0; i<=line.length; i++) {\n      if (i<line.length) {\n         ch = line.charAt(i);\n         cclass = charclasstable[ch];\n         }\n      else {\n         ch = \"\";\n         cclass = charclass.eof;\n         }\n\n      if (state == parsestate.num) {\n         if (cclass == charclass.num) {\n            str += ch;\n            }\n         else if (cclass == charclass.numstart && !haddecimal) {\n            haddecimal = true;\n            str += ch;\n            }\n         else if (ch == \"E\" || ch == \"e\") {\n            str += ch;\n            haddecimal = false;\n            state = parsestate.numexp1;\n            }\n         else { // end of number - save it\n            pushtoken(parseinfo, str, tokentype.num, 0);\n            haddecimal = false;\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.numexp1) {\n         if (cclass == parsestate.num) {\n            state = parsestate.numexp2;\n            }\n         else if ((ch == '+' || ch == '-') && (uppercasetable[str.charAt(str.length-1)] == 'E')) {\n            str += ch;\n            }\n         else if (ch == 'E' || ch == 'e') {\n            ;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrexponent, tokentype.error, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.numexp2) {\n         if (cclass == charclass.num) {\n            str += ch;\n            }\n         else { // end of number - save it\n            pushtoken(parseinfo, str, tokentype.num, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.alpha) {\n         if (cclass == charclass.num) {\n            state = parsestate.coord;\n            }\n         else if (cclass == charclass.alpha || ch == \".\") { // alpha may be letters, numbers, \"_\", or \".\"\n            str += ch;\n            }\n         else if (cclass == charclass.incoord) {\n            state = parsestate.coord;\n            }\n         else if (cclass == charclass.op || cclass == charclass.numstart\n                || cclass == charclass.space || cclass == charclass.eof) {\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\n            state = 0;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.coord) {\n         if (cclass == charclass.num) {\n            str += ch;\n            }\n         else if (cclass == charclass.incoord) {\n            str += ch;\n            }\n         else if (cclass == charclass.alpha) {\n            state = parsestate.alphanumeric;\n            }\n         else if (cclass == charclass.op || cclass == charclass.numstart ||\n                  cclass == charclass.eof || cclass == charclass.space) {\n            if (coordregex.test(str)) {\n               t = tokentype.coord;\n               }\n            else {\n               t = tokentype.name;\n               }\n            pushtoken(parseinfo, str.toUpperCase(), t, 0);\n            state = 0;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            state = 0;\n           }\n         }\n\n\n      if (state == parsestate.alphanumeric) {\n         if (cclass == charclass.num || cclass == charclass.alpha) {\n            str += ch;\n            }\n         else if (cclass == charclass.op || cclass == charclass.numstart\n                || cclass == charclass.space || cclass == charclass.eof) {\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\n            state = 0;\n            }\n         else {\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            state = 0;\n            }\n         }\n\n      if (state == parsestate.string) {\n         if (cclass == charclass.quote) {\n            state = parsestate.stringquote; // got quote in string: is it doubled (quote in string) or by itself (end of string)?\n            }\n         else if (cclass == charclass.eof) {\n            pushtoken(parseinfo, scc.s_parseerrstring, tokentype.error, 0);\n            state = 0;\n            }\n         else {\n            str += ch;\n            }\n         }\n      else if (state == parsestate.stringquote) { // note else if here\n         if (cclass == charclass.quote) {\n            str += ch;\n            state = parsestate.string; // double quote: add one then continue getting string\n            }\n         else { // something else -- end of string\n            pushtoken(parseinfo, str, tokentype.string, 0);\n            state = 0; // drop through to process\n            }\n         }\n\n      else if (state == parsestate.specialvalue) { // special values like #REF!\n         if (str.charAt(str.length-1) == \"!\") { // done - save value as a name\n            pushtoken(parseinfo, str, tokentype.name, 0);\n            state = 0; // drop through to process\n            }\n         else if (cclass == charclass.eof) {\n            pushtoken(parseinfo, scc.s_parseerrspecialvalue, tokentype.error, 0);\n            state = 0;\n            }\n         else {\n            str += ch;\n            }\n         }\n\n      if (state == 0) {\n         if (cclass == charclass.num) {\n            str = ch;\n            state = parsestate.num;\n            }\n         else if (cclass == charclass.numstart) {\n            str = ch;\n            haddecimal = true;\n            state = parsestate.num;\n            }\n         else if (cclass == charclass.alpha || cclass == charclass.incoord) {\n            str = ch;\n            state = parsestate.alpha;\n            }\n         else if (cclass == charclass.specialstart) {\n            str = ch;\n            state = parsestate.specialvalue;\n            }\n         else if (cclass == charclass.op) {\n            str = ch;\n            if (parseinfo.length>0) {\n               last_token = parseinfo[parseinfo.length-1];\n               last_token_type = last_token.type;\n               last_token_text = last_token.text;\n               if (last_token_type == charclass.op) {\n                  if (last_token_text == '<' || last_token_text == \">\") {\n                     str = last_token_text + str;\n                     parseinfo.pop();\n                     if (parseinfo.length>0) {\n                        last_token = parseinfo[parseinfo.length-1];\n                        last_token_type = last_token.type;\n                        last_token_text = last_token.text;\n                        }\n                     else {\n                        last_token_type = charclass.eof;\n                        last_token_text = \"EOF\";\n                        }\n                     }\n                  }\n               }\n            else {\n               last_token_type = charclass.eof;\n               last_token_text = \"EOF\";\n               }\n            t = tokentype.op;\n            if ((parseinfo.length == 0)\n                || (last_token_type == charclass.op && last_token_text != ')' && last_token_text != '%')) { // Unary operator\n               if (str == '-') { // M is unary minus\n                  str = \"M\";\n                  ch = \"M\";\n                  }\n               else if (str == '+') { // P is unary plus\n                  str = \"P\";\n                  ch = \"P\";\n                  }\n               else if (str == ')' && last_token_text == '(') { // null arg list OK\n                  ;\n                  }\n               else if (str != '(') { // binary-op open-paren OK, others no\n                  t = tokentype.error;\n                  str = scc.s_parseerrtwoops;\n                  }\n               }\n            else if (str.length > 1) {\n               if (str == '>=') { // G is >=\n                  str = \"G\";\n                  ch = \"G\";\n                  }\n               else if (str == '<=') { // L is <=\n                  str = \"L\";\n                  ch = \"L\";\n                  }\n               else if (str == '<>') { // N is <>\n                  str = \"N\";\n                  ch = \"N\";\n                  }\n               else {\n                  t = tokentype.error;\n                  str = scc.s_parseerrtwoops;\n                  }\n               }\n            pushtoken(parseinfo, str, t, ch);\n            state = 0;\n            }\n         else if (cclass == charclass.quote) { // starting a string\n            str = \"\";\n            state = parsestate.string;\n            }\n         else if (cclass == charclass.space) { // store so can reconstruct spacing\n            //pushtoken(parseinfo, \" \", tokentype.space, 0);\n            }\n         else if (cclass == charclass.eof) { // ignore -- needed to have extra loop to close out other things\n            }\n         else { // unknown class - such as unknown char\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\n            }\n         }\n      }\n\n   return parseinfo;\n\n   }\n\nSocialCalc.Formula.ParsePushToken = function(parseinfo, ttext, ttype, topcode) {\n\n   parseinfo.push({text: ttext, type: ttype, opcode: topcode});\n\n   }\n\n/* *******************\n\n result = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, allowrangereturn)\n\n Does the calculation expressed in a parsed formula, returning a value, its type, and error info\n returns: {value: value, type: valuetype, error: errortext}.\n\n If allowrangereturn is present and true, can return a range (e.g., \"A1:A10\" - translated from \"A1|A10|\")\n\n************************* */\n\nSocialCalc.Formula.evaluate_parsed_formula = function(parseinfo, sheet, allowrangereturn) {\n\n   var result;\n\n   var scf = SocialCalc.Formula;\n   var tokentype = scf.TokenType;\n\n   var revpolish;\n   var parsestack = [];\n\n   var errortext = \"\";\n\n   revpolish = scf.ConvertInfixToPolish(parseinfo); // result is either an array or a string with error text\n\n   result = scf.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn);\n\n   return result;\n\n}\n\n//\n// revpolish = SocialCalc.Formula.ConvertInfixToPolish(parseinfo)\n//\n// Convert infix to reverse polish notation\n//\n// Returns revpolish array with a sequence of references to tokens by number if successful.\n// Errors return a string with the error.\n//\n// Based upon the algorithm shown in Wikipedia \"Reverse Polish notation\" article\n// and then enhanced for additional spreadsheet things\n//\n\nSocialCalc.Formula.ConvertInfixToPolish = function(parseinfo) {\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var tokentype = scf.TokenType;\n   var token_precedence = scf.TokenPrecedence;\n\n   var revpolish = [];\n   var parsestack = [];\n\n   var errortext = \"\";\n\n   var function_start = -1;\n\n   var i, pii, ttype, ttext, tprecedence, tstackprecedence;\n\n   for (i=0; i<parseinfo.length; i++) {\n      pii = parseinfo[i];\n      ttype = pii.type;\n      ttext = pii.text;\n      if (ttype == tokentype.num || ttype == tokentype.coord || ttype == tokentype.string) {\n         revpolish.push(i);\n         }\n      else if (ttype == tokentype.name) {\n         parsestack.push(i);\n         revpolish.push(function_start);\n         }\n      else if (ttype == tokentype.space) { // ignore\n         continue;\n         }\n      else if (ttext == ',') {\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\n            revpolish.push(parsestack.pop());\n            }\n         if (parsestack.length == 0) { // no ( -- error\n            errortext = scc.s_parseerrmissingopenparen;\n            break;\n            }\n         }\n      else if (ttext == '(') {\n         parsestack.push(i);\n         }\n      else if (ttext == ')') {\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\n            revpolish.push(parsestack.pop());\n            }\n         if (parsestack.length == 0) { // no ( -- error\n            errortext = scc.s_parseerrcloseparennoopen;\n            break;\n            }\n         parsestack.pop();\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\n            revpolish.push(parsestack.pop());\n            }\n         }\n      else if (ttype == tokentype.op) {\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\n            revpolish.push(parsestack.pop());\n            }\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.op\n                && parseinfo[parsestack[parsestack.length-1]].text != '(') {\n            tprecedence = token_precedence[pii.opcode];\n            tstackprecedence = token_precedence[parseinfo[parsestack[parsestack.length-1]].opcode];\n            if (tprecedence >= 0 && tprecedence < tstackprecedence) {\n               break;\n               }\n            else if (tprecedence < 0) {\n               tprecedence = -tprecedence;\n               if (tstackprecedence < 0) tstackprecedence = -tstackprecedence;\n               if (tprecedence <= tstackprecedence) {\n                  break;\n                  }\n               }\n            revpolish.push(parsestack.pop());\n            }\n         parsestack.push(i);\n         }\n      else if (ttype == tokentype.error) {\n         errortext = ttext;\n         break;\n         }\n      else {\n         errortext = \"Internal error while processing parsed formula. \";\n         break;\n         }\n      }\n   while (parsestack.length>0) {\n      if (parseinfo[parsestack[parsestack.length-1]].text == '(') {\n         errortext = scc.s_parseerrmissingcloseparen;\n         break;\n         }\n      revpolish.push(parsestack.pop());\n      }\n\n   if (errortext) {\n      return errortext;\n      }\n\n   return revpolish;\n\n   }\n\n\n// DebugLog\n// display logged objects in the audit tab of the spreadsheet control\nif(typeof SocialCalc.debug_log === 'undefined') SocialCalc.debug_log = [];\n\nSocialCalc.DebugLog = function(logObject) {\t\n\tSocialCalc.debug_log.push(logObject);\n}\n\n\n//\n// result = SocialCalc.Formula.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn)\n//\n// Execute reverse polish representation of formula\n//\n// Operand values are objects in the operand array with a \"type\" and an optional \"value\".\n// Type can have these values (many are type and sub-type as two or more letters):\n//    \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"start\", \"eErrorType\", \"b\" (blank)\n// The value of a coord is in the form A57 or A57!sheetname\n// The value of a range is coord|coord|number where number starts at 0 and is\n// the offset of the next item to fetch if you are going through the range one by one\n// The number starts as a null string (\"A1|B3|\")\n//\n\nSocialCalc.Formula.EvaluatePolish = function(parseinfo, revpolish, sheet, allowrangereturn) {\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var tokentype = scf.TokenType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookup = scf.TypeLookupTable;\n   var operand_as_number = scf.OperandAsNumber;\n   var operand_as_text = scf.OperandAsText;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var operands_as_coord_on_sheet = scf.OperandsAsCoordOnSheet;\n   var format_number_for_display = SocialCalc.format_number_for_display || function(v, t, f) {return v+\"\";};\n\n   var errortext = \"\";\n   var function_start = -1;\n   var missingOperandError = {value: \"\", type: \"e#VALUE!\", error: scc.s_parseerrmissingoperand};\n\n   var operand = [];\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   var i, rii, prii, ttype, ttext, value1, value2, tostype, tostype2, resulttype, valuetype, cond, vmatch, smatch;\n\n   if (!parseinfo.length || (! (revpolish instanceof Array))) {\n      return ({value: \"\", type: \"e#VALUE!\", error: (typeof revpolish == \"string\" ? revpolish : \"\")});\n      }\n\n\t  \n\t  // eddy EvaluatePolish { \n        SocialCalc.DebugLog({ revpolish: revpolish});\n        SocialCalc.DebugLog({ revpolish: revpolish});\n\t  // }\n\n\t// eddy EvaluatePolish {\n\t\n\t// e.g parameterInfo: [ {'text':'E1','type':2,'opcode':0}, ... ] \n    var parameterInfo = [];\n    // }\t\n\t  \n\t  \n   for (i=0; i<revpolish.length; i++) {\n      rii = revpolish[i];\n      if (rii == function_start) { // Remember the start of a function argument list\n         PushOperand(\"start\", 0);\n         continue;\n         }\n\n      prii = parseinfo[rii];\n      ttype = prii.type;\n      ttext = prii.text;\n\t  // eddy EvaluatePolish {\n\t  parameterInfo.push(prii);\n\t  // }\n\t  \n      if (ttype == tokentype.num) {\n         PushOperand(\"n\", ttext-0);\n         }\n\n      else if (ttype == tokentype.coord) {\n         PushOperand(\"coord\", ttext);\n\t\t \n         }\n\n      else if (ttype == tokentype.string) {\n         PushOperand(\"t\", ttext);\n         }\n\n      else if (ttype == tokentype.op) {\n         if (operand.length <= 0) { // Nothing on the stack...\n            return missingOperandError;\n            break; // done\n            }\n\n         // Unary minus\n\n         if (ttext == 'M') {\n            value1 = operand_as_number(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryminus);\n            PushOperand(resulttype, -value1.value);\n            }\n\n         // Unary plus\n\n         else if (ttext == 'P') {\n            value1 = operand_as_number(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryplus);\n            PushOperand(resulttype, value1.value);\n            }\n\n         // Unary % - percent, left associative\n\n         else if (ttext == '%') {\n            value1 = operand_as_number(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unarypercent);\n            PushOperand(resulttype, 0.01*value1.value);\n            }\n\n         // & - string concatenate\n\n         else if (ttext == '&') {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               return missingOperandError;\n               }\n            value2 = operand_as_text(sheet, operand);\n            value1 = operand_as_text(sheet, operand);\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.concat);\n            PushOperand(resulttype, value1.value + value2.value);\n            }\n\n         // : - Range constructor\n\n         else if (ttext == ':') {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               return missingOperandError;\n               }\n            value1 = scf.OperandsAsRangeOnSheet(sheet, operand); // get coords even if use name on other sheet\n            if (value1.error) { // not available\n               errortext = errortext || value1.error;\n               }\n            PushOperand(value1.type, value1.value); // push sheetname with range on that sheet\n            }\n\n         // ! - sheetname!coord\n\n         else if (ttext == '!') {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               return missingOperandError;\n               }\n            value1 = operands_as_coord_on_sheet(sheet, operand); // get coord even if name on other sheet\n            if (value1.error) { // not available\n               errortext = errortext || value1.error;\n               }\n            PushOperand(value1.type, value1.value); // push sheetname with coord or range on that sheet\n            }\n\n         // Comparison operators: < L = G > N (< <= = >= > <>)\n\n         else if (ttext == \"<\" || ttext == \"L\" || ttext == \"=\" || ttext == \"G\" || ttext == \">\" || ttext == \"N\") {\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               errortext = scc.s_parseerrmissingoperand; // remember error\n               break;\n               }\n            value2 = operand_value_and_type(sheet, operand);\n            value1 = operand_value_and_type(sheet, operand);\n            if (value1.type.charAt(0) == \"n\" && value2.type.charAt(0) == \"n\") { // compare two numbers\n               cond = 0;\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\n               PushOperand(\"nl\", cond);\n               }\n            else if (value1.type.charAt(0) == \"e\") { // error on left\n               PushOperand(value1.type, 0);\n               }               \n            else if (value2.type.charAt(0) == \"e\") { // error on right\n               PushOperand(value2.type, 0);\n               }               \n            else { // text maybe mixed with numbers or blank\n               tostype = value1.type.charAt(0);\n               tostype2 = value2.type.charAt(0);\n               if (tostype == \"n\") {\n                  value1.value = format_number_for_display(value1.value, \"n\", \"\");\n                  }\n               else if (tostype == \"b\") {\n                  value1.value = \"\";\n                  }\n               if (tostype2 == \"n\") {\n                  value2.value = format_number_for_display(value2.value, \"n\", \"\");\n                  }\n               else if (tostype2 == \"b\") {\n                  value2.value = \"\";\n                  }\n               cond = 0;\n               value1.value = value1.value.toLowerCase(); // ignore case\n               value2.value = value2.value.toLowerCase();\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\n               PushOperand(\"nl\", cond);\n               }\n            }\n\n         // Normal infix arithmethic operators: +, -. *, /, ^\n\n         else { // what's left are the normal infix arithmetic operators\n            if (operand.length <= 1) { // Need at least two things on the stack...\n               errortext = scc.s_parseerrmissingoperand; // remember error\n               break;\n               }\n            value2 = operand_as_number(sheet, operand);\n            value1 = operand_as_number(sheet, operand);\n            if (ttext == '+') {\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\n               PushOperand(resulttype, value1.value + value2.value);\n               }\n            else if (ttext == '-') {\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\n               PushOperand(resulttype, value1.value - value2.value);\n               }\n            else if (ttext == '*') {\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\n               PushOperand(resulttype, value1.value * value2.value);\n               }\n            else if (ttext == '/') {\n               if (value2.value != 0) {\n                  PushOperand(\"n\", value1.value / value2.value); // gives plain numeric result type\n                  }\n               else {\n                  PushOperand(\"e#DIV/0!\", 0);\n                  }\n               }\n            else if (ttext == '^') {\n               value1.value = Math.pow(value1.value, value2.value);\n               value1.type = \"n\"; // gives plain numeric result type\n               if (isNaN(value1.value)) {\n                  value1.value = 0;\n                  value1.type = \"e#NUM!\";\n                  }\n               PushOperand(value1.type, value1.value);\n               }\n            }\n         }\n\n      // function or name\n\n      else if (ttype == tokentype.name) {\n\t  \n//         errortext = scf.CalculateFunction(ttext, operand, sheet);\n         errortext = scf.CalculateFunction(ttext, operand, sheet, parseinfo.coord); // eddy also pass the cell id\n\t\t \n         if (errortext) break;\n\t\t \n\t\t \n         }\n\n\t\t \n      else {\n         errortext = scc.s_InternalError+\"Unknown token \"+ttype+\" (\"+ttext+\"). \";\n         break;\n         }\n      }\n\n   // look at final value and handle special cases\n\n   value = operand[0] ? operand[0].value : \"\";\n   tostype = operand[0] ? operand[0].type : \"\";\n\n   if (tostype == \"name\") { // name - expand it\n      value1 = SocialCalc.Formula.LookupName(sheet, value);\n      value = value1.value;\n      tostype = value1.type;\n      errortext = errortext || value1.error;\n      }\n\n   if (tostype == \"coord\") { // the value is a coord reference, get its value and type\n      value1 = operand_value_and_type(sheet, operand);\n      value = value1.value;\n      tostype = value1.type;\n      if (tostype == \"b\") {\n         tostype = \"n\";\n         value = 0;\n         }\n      }\n\n   if (operand.length > 1 && !errortext) { // something left - error\n      errortext += scc.s_parseerrerrorinformula;\n      }\n\n   // set return type\n\n   valuetype = tostype;\n\n   if (tostype.charAt(0) == \"e\") { // error value\n      errortext = errortext || tostype.substring(1) || scc.s_calcerrerrorvalueinformula;\n      }\n   else if (tostype == \"range\") {\n      vmatch = value.match(/^(.*)\\|(.*)\\|/);\n      smatch = vmatch[1].indexOf(\"!\");\n      if (smatch>=0) { // swap sheetname\n         vmatch[1] = vmatch[1].substring(smatch+1) + \"!\" + vmatch[1].substring(0, smatch).toUpperCase();\n         }\n      else {\n         vmatch[1] = vmatch[1].toUpperCase();\n         }\n      value = vmatch[1] + \":\" + vmatch[2].toUpperCase();\n      if (!allowrangereturn) {\n         errortext = scc.s_formularangeresult+\" \"+value;\n         }\n      }\n\n   if (errortext && valuetype.charAt(0) != \"e\") {\n      value = errortext;\n      valuetype = \"e\";\n     }\n\n   // look for overflow\n\n   if (valuetype.charAt(0) == \"n\" && (isNaN(value) || !isFinite(value))) {\n      value = 0;\n      valuetype = \"e#NUM!\";\n      errortext = isNaN(value) ? scc.s_calcerrnumericnan: scc.s_calcerrnumericoverflow;\n      }\n\n   return ({value: value, type: valuetype, error: errortext});\n\n   }\n\n\n/*\n#\n# resulttype = SocialCalc.Formula.LookupResultType(type1, type2, typelookup);\n#\n# typelookup has values of the following form:\n#\n#    typelookup{\"typespec1\"} = \"|typespec2A:resultA|typespec2B:resultB|...\"\n#\n# First type1 is looked up. If no match, then the first letter (major type) of type1 plus \"*\" is looked up\n# resulttype is type1 if result is \"1\", type2 if result is \"2\", otherwise the value of result.\n#\n*/\n\nSocialCalc.Formula.LookupResultType = function(type1, type2, typelookup) {\n\n   var pos1, pos2, result;\n\n   var table1 = typelookup[type1];\n\n   if (!table1) {\n      table1 = typelookup[type1.charAt(0)+'*'];\n      if (!table1) {\n         return \"e#VALUE! (internal error, missing LookupResultType \"+type1.charAt(0)+\"*)\"; // missing from table -- please add it\n         }\n      }\n   pos1 = table1.indexOf(\"|\"+type2+\":\");\n   if (pos1 >= 0) {\n      pos2 = table1.indexOf(\"|\", pos1+1);\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\n      result = table1.substring(pos1+type2.length+2, pos2);\n      if (result == \"1\") return type1;\n      if (result == \"2\") return type2;\n      return result;\n      }\n   pos1 = table1.indexOf(\"|\"+type2.charAt(0)+\"*:\");\n   if (pos1 >= 0) {\n      pos2 = table1.indexOf(\"|\", pos1+1);\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\n      result = table1.substring(pos1+4, pos2);\n      if (result == \"1\") return type1;\n      if (result == \"2\") return type2;\n      return result;\n      }\n   return \"e#VALUE!\";\n\n   }\n\n/*\n#\n# operandinfo = SocialCalc.Formula.TopOfStackValueAndType(sheet, operand)\n#\n# Returns top of stack value and type and then pops the stack.\n# The result is {value: value, type: type, error: \"only if bad error\"}\n#\n*/\n\nSocialCalc.Formula.TopOfStackValueAndType = function(sheet, operand) {\n\n   var cellvtype, cell, pos, coordsheet;\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   if (!stacklen) { // make sure something is there\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\n      return result;\n      }\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   if (result.type == \"name\") {\n      result = scf.LookupName(sheet, result.value);\n      }\n\n   return result;\n\n   }\n\n\n/*\n#\n# operandinfo = OperandAsNumber(sheet, operand)\n#\n# Uses operand_value_and_type to get top of stack and pops it.\n# Returns numeric value and type.\n# Text values are treated as 0 if they can't be converted somehow.\n#\n*/\n\nSocialCalc.Formula.OperandAsNumber = function(sheet, operand) {\n\n   var t, valueinfo;\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\n\n   t = operandinfo.type.charAt(0);\n\n   if (t == \"n\") {\n      operandinfo.value = operandinfo.value-0;\n      }\n   else if (t == \"b\") { // blank cell\n      operandinfo.type = \"n\";\n      operandinfo.value = 0;\n      }\n   else if (t == \"e\") { // error\n      operandinfo.value = 0;\n      }\n   else {\n      valueinfo = SocialCalc.DetermineValueType ? SocialCalc.DetermineValueType(operandinfo.value) :\n                                                    {value: operandinfo.value-0, type: \"n\"}; // if without rest of SocialCalc\n      if (valueinfo.type.charAt(0) == \"n\") {\n         operandinfo.value = valueinfo.value-0;\n         operandinfo.type = valueinfo.type;\n         }\n      else {\n         operandinfo.value = 0;\n         operandinfo.type = valueinfo.type;\n         }\n      }\n\n   return operandinfo;\n\n   }\n\n/*\n#\n# operandinfo = OperandAsText(sheet, operand)\n#\n# Uses operand_value_and_type to get top of stack and pops it.\n# Returns text value, preserving sub-type.\n#\n*/\n\nSocialCalc.Formula.OperandAsText = function(sheet, operand) {\n\n   var t, valueinfo;\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\n\n   t = operandinfo.type.charAt(0);\n\n   if (t ==  \"t\") { // any flavor of text returns as is\n      ;\n      }\n   else if (t == \"n\") {\n      operandinfo.value = SocialCalc.format_number_for_display ?\n                             SocialCalc.format_number_for_display(operandinfo.value, operandinfo.type, \"\") :\n                             operandinfo.value = operandinfo.value+\"\";\n      operandinfo.type = \"t\";\n      }\n   else if (t == \"b\") { // blank\n      operandinfo.value = \"\";\n      operandinfo.type = \"t\";\n      }\n   else if (t == \"e\") { // error\n      operandinfo.value = \"\";\n      }\n   else {\n      operand.value = operandinfo.value + \"\";\n      operand.type = \"t\";\n      }\n\n   return operandinfo;\n\n   }\n\n/*\n#\n# result = SocialCalc.Formula.OperandValueAndType(sheet, operand)\n#\n# Pops the top of stack and returns it, following a coord reference if necessary.\n# The result is {value: value, type: type, error: \"only if bad error\"}\n# Ranges are returned as if they were pushed onto the stack first coord first\n# Also sets type with \"t\", \"n\", \"th\", etc., as appropriate\n#\n*/\n\nSocialCalc.Formula.OperandValueAndType = function(sheet, operand) {\n\n   var cellvtype, cell, pos, coordsheet;\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   if (!stacklen) { // make sure something is there\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\n      return result;\n      }\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   if (result.type == \"name\") {\n      result = scf.LookupName(sheet, result.value);\n      }\n\n   if (result.type == \"range\") {\n      result = scf.StepThroughRangeDown(operand, result.value);\n      }\n\n   if (result.type == \"coord\") { // value is a coord reference\n      coordsheet = sheet;\n      pos = result.value.indexOf(\"!\");\n      if (pos != -1) { // sheet reference\n         coordsheet = scf.FindInSheetCache(result.value.substring(pos+1)); // get other sheet\n         if (coordsheet == null) { // unavailable\n            result.type = \"e#REF!\";\n            result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+result.value.substring(pos+1);\n            result.value = 0;\n            return result;\n            }\n         result.value = result.value.substring(0, pos); // get coord part\n         }\n\n      if (coordsheet) {\n         cell = coordsheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\n         if (cell) {\n            cellvtype = cell.valuetype; // get type of value in the cell it points to\n            result.value = cell.datavalue;\n            }\n         else {\n            cellvtype = \"b\";\n            }\n         }\n      else {\n         cellvtype = \"e#N/A\";\n         result.value = 0;\n         }\n      result.type = cellvtype || \"b\";\n      if (result.type == \"b\") { // blank\n         result.value = 0;\n         }\n      }\n\n   return result;\n\n   }\n\n/*\n#\n# operandinfo = SocialCalc.Formula.OperandAsCoord(sheet, operand)\n#\n# Gets top of stack and pops it.\n# Returns coord value. All others are treated as an error.\n#\n*/\n\n\nSocialCalc.Formula.OperandAsCoord = function(sheet, operand) {\n\treturn SocialCalc.Formula.OperandAsType(sheet, operand, \"coord\");\n}\n\n\n/*\n#\n# operandinfo = SocialCalc.Formula.OperandAsRange(sheet, operand)\n#\n# Gets top of stack and pops it.\n# Returns coord value. All others are treated as an error.\n#\n*/\n\nSocialCalc.Formula.OperandAsRange = function(sheet, operand) {\n\treturn SocialCalc.Formula.OperandAsType(sheet, operand, \"range\");\n}\n\n/*\n#\n# operandinfo = SocialCalc.Formula.OperandAsType(sheet, operand, operandtype)\n#\n# Gets top of stack and pops it.\n# Returns operandtype value. All others are treated as an error.\n#\n*/\nSocialCalc.Formula.OperandAsType = function(sheet, operand, operandtype) {\n\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n   if (result.type == \"name\") {\n      result = SocialCalc.Formula.LookupName(sheet, result.value);\n      }\n   if (result.type == operandtype) { // value is a coord reference\n      return result;\n      }\n   else {\n      result.value = SocialCalc.Constants.s_calcerrcellrefmissing;\n      result.type = \"e#REF!\";\n      return result;\n      }\n}\n\n\n/*\n#\n# result = SocialCalc.Formula.OperandsAsCoordOnSheet(sheet, operand)\n#\n# Gets 2 at top of stack and pops them, treating them as sheetname!coord-or-name.\n# Returns stack-style coord value (coord!sheetname, or coord!sheetname|coord|) with\n# a type of coord or range. All others are treated as an error.\n# If sheetname not available, sets result.error.\n#\n*/\n\nSocialCalc.Formula.OperandsAsCoordOnSheet = function(sheet, operand) {\n\n   var sheetname, othersheet, pos1, pos2;\n   var value1 = {};\n   var result = {};\n   var scf = SocialCalc.Formula;\n\n   var stacklen = operand.length;\n   value1.value = operand[stacklen-1].value; // get top of stack - coord or name\n   value1.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   sheetname = scf.OperandAsSheetName(sheet, operand); // get sheetname as text\n   othersheet = scf.FindInSheetCache(sheetname.value);\n   if (othersheet == null) { // unavailable\n      result.type = \"e#REF!\";\n      result.value = 0;\n      result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+sheetname.value;\n      return result;\n      }\n\n   if (value1.type == \"name\") {\n      value1 = scf.LookupName(othersheet, value1.value);\n      }\n   result.type = value1.type;\n   if (value1.type == \"coord\") { // value is a coord reference\n      result.value = value1.value + \"!\" + sheetname.value; // return in the format as used on stack\n      }\n   else if (value1.type == \"range\") { // value is a range reference\n      pos1 = value1.value.indexOf(\"|\");\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\n      result.value = value1.value.substring(0, pos1) + \"!\" + sheetname.value +\n                    \"|\" + value1.value.substring(pos1+1, pos2) + \"|\";\n      }\n   else if (value1.type.charAt(0)==\"e\") {\n      result.value = value1.value;\n      }\n   else {\n      result.error = SocialCalc.Constants.s_calcerrcellrefmissing;\n      result.type = \"e#REF!\";\n      result.value = 0;\n      }\n   return result;\n   \n   }\n\n/*\n#\n# result = SocialCalc.Formula.OperandsAsRangeOnSheet(sheet, operand)\n#\n# Gets 2 at top of stack and pops them, treating them as coord2-or-name:coord1.\n# Name is evaluated on sheet of coord1.\n# Returns result with \"value\" of stack-style range value (coord!sheetname|coord|) and\n# \"type\" of \"range\". All others are treated as an error.\n#\n*/\n\nSocialCalc.Formula.OperandsAsRangeOnSheet = function(sheet, operand) {\n\n   var value1, othersheet, pos1, pos2;\n   var value2 = {};\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n\n   var stacklen = operand.length;\n   value2.value = operand[stacklen-1].value; // get top of stack - coord or name for \"right\" side\n   value2.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n\n   value1 = scf.OperandAsCoord(sheet, operand); // get \"left\" coord\n   if (value1.type != \"coord\") { // not a coord, which it must be\n      return {value: 0, type: \"e#REF!\"};\n      }\n\n   othersheet = sheet;\n   pos1 = value1.value.indexOf(\"!\");\n   if (pos1 != -1) { // sheet reference\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\n      if (pos2 < 0) pos2 = value1.value.length;\n      othersheet = scf.FindInSheetCache(value1.value.substring(pos1+1,pos2)); // get other sheet\n      if (othersheet == null) { // unavailable\n         return {value: 0, type: \"e#REF!\", errortext: scc.s_sheetunavailable+\" \"+value1.value.substring(pos1+1,pos2)};\n         }\n      }\n\n   if (value2.type == \"name\") { // coord:name is allowed, if name is just one cell\n      value2 = scf.LookupName(othersheet, value2.value, \"end\");\n      }\n\n   if (value2.type == \"coord\") { // value is a coord reference, so return the combined range\n      return {value: value1.value+\"|\"+value2.value+\"|\", type: \"range\"}; // return range in the format as used on stack\n      }\n   else { // bad form\n      return {value: scc.s_calcerrcellrefmissing, type: \"e#REF!\"};\n      }\n   }\n\n\n/*\n#\n# result = SocialCalc.Formula.OperandAsSheetName(sheet, operand)\n#\n# Gets top of stack and pops it.\n# Returns sheetname value. All others are treated as an error.\n# Accepts text, cell reference, and named value which is one of those two.\n#\n*/\n\nSocialCalc.Formula.OperandAsSheetName = function(sheet, operand) {\n\n   var nvalue, cell;\n\n   var scf = SocialCalc.Formula;\n\n   var result = {type: \"\", value: \"\"};\n\n   var stacklen = operand.length;\n\n   result.value = operand[stacklen-1].value; // get top of stack\n   result.type = operand[stacklen-1].type;\n   operand.pop(); // we have data - pop stack\n   if (result.type == \"name\") {\n      nvalue = SocialCalc.Formula.LookupName(sheet, result.value);\n      if (!nvalue.value) { // not a known name - return bare name as the name value\n         return result;\n         }\n      result.value = nvalue.value;\n      result.type = nvalue.type;\n      }\n   if (result.type == \"coord\") { // value is a coord reference, follow it to find sheet name\n      cell = sheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\n      if (cell) {\n         result.value = cell.datavalue;\n         result.type = cell.valuetype;\n         }\n      else {\n         result.value = \"\";\n         result.type = \"b\";\n         }\n      }\n   if (result.type.charAt(0) == \"t\") { // value is a string which could be a sheet name\n      return result;\n      }\n   else {\n      result.value = \"\";\n      result.error = SocialCalc.Constants.s_calcerrsheetnamemissing;\n      return result;\n      }\n\n   }\n\n//\n// value = SocialCalc.Formula.LookupName(sheet, name)\n//\n// Returns value and type of a named value\n// Names are case insensitive\n// Names may have a definition which is a coord (A1), a range (A1:B7), or a formula (=OFFSET(A1,0,0,5,1))\n// Note: The range must not have sheet names (\"!\") in them.\n//\n\nSocialCalc.Formula.LookupName = function(sheet, name, isEnd) {\n\n   var pos, specialc, parseinfo;\n   var names = sheet.names;\n   var value = {};\n   var startedwalk = false;\n\n   if (names[name.toUpperCase()]) { // is name defined?\n\n      value.value = names[name.toUpperCase()].definition; // yes\n\n      if (value.value.charAt(0) == \"=\") { // formula\n         if (!sheet.checknamecirc) { // are we possibly walking the name tree?\n            sheet.checknamecirc = {}; // not yet\n            startedwalk = true; // remember we are the reference that started it\n            }\n         else {\n            if (sheet.checknamecirc[name]) { // circular reference\n               value.type = \"e#NAME?\";\n               value.error = SocialCalc.Constants.s_circularnameref+' \"' + name + '\".';\n               return value;\n               }\n            }\n         sheet.checknamecirc[name] = true;\n\n         parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(value.value.substring(1));\n         value = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, 1); // parse formula, allowing range return\n\n         delete sheet.checknamecirc[name]; // done with us\n         if (startedwalk) {\n            delete sheet.checknamecirc; // done with walk\n            }\n\n         if (value.type != \"range\") {\n            return value;\n            }\n         }\n\n      pos = value.value.indexOf(\":\");\n      if (pos != -1) { // range\n         value.type = \"range\";\n         value.value = value.value.substring(0, pos) + \"|\" + value.value.substring(pos+1)+\"|\";\n         value.value = value.value.toUpperCase();\n         }\n      else {\n         value.type = \"coord\";\n         value.value = value.value.toUpperCase();\n         }\n      return value;\n      }\n   else if (specialc=SocialCalc.Formula.SpecialConstants[name.toUpperCase()]) { // special constant, like #REF!\n      pos = specialc.indexOf(\",\");\n      value.value = specialc.substring(0,pos)-0;\n      value.type = specialc.substring(pos+1);\n      return value;\n      }\n   else if (/^[a-zA-Z][a-zA-Z]?$/.test(name)) {\n      value.type = \"coord\";\n      value.value = name.toUpperCase() + (isEnd ? sheet.attribs.lastrow : 1);\n      return value;\n   }\n   else {\n      value.value = \"\";\n      value.type = \"e#NAME?\";\n      value.error = SocialCalc.Constants.s_calcerrunknownname+' \"'+name+'\"';\n      return value;\n      }\n   }\n\n/*\n#\n# coord = SocialCalc.Formula.StepThroughRangeDown(operand, rangevalue)\n#\n# Returns next coord in a range, keeping track on the operand stack\n# Goes from upper left across and down to bottom right.\n#\n*/\n\nSocialCalc.Formula.StepThroughRangeDown = function(operand, rangevalue) {\n\n   var value1, value2, sequence, pos1, pos2, sheet1, rp, c, r, count;\n   var scf = SocialCalc.Formula;\n\n   pos1 = rangevalue.indexOf(\"|\");\n   pos2 = rangevalue.indexOf(\"|\", pos1+1);\n   value1 = rangevalue.substring(0, pos1);\n   value2 = rangevalue.substring(pos1+1, pos2);\n   sequence = rangevalue.substring(pos2+1) - 0;\n\n   pos1 = value1.indexOf(\"!\");\n   if (pos1 != -1) {\n      sheet1 = value1.substring(pos1);\n      value1 = value1.substring(0, pos1);\n      }\n   else {\n      sheet1 = \"\";\n      }\n   pos1 = value2.indexOf(\"!\");\n   if (pos1 != -1) {\n      value2 = value2.substring(0, pos1);\n      }\n\n   rp = scf.OrderRangeParts(value1, value2);\n   \n   count = 0;\n   for (r=rp.r1; r<=rp.r2; r++) {\n      for (c=rp.c1; c<=rp.c2; c++) {\n         count++;\n         if (count > sequence) {\n            if (r!=rp.r2 || c!=rp.c2) { // keep on stack until done\n               scf.PushOperand(operand, \"range\", value1+sheet1+\"|\"+value2+\"|\"+count);\n               }\n            return {value: SocialCalc.crToCoord(c, r)+sheet1, type: \"coord\"};\n            }\n         }\n      }\n   }\n\n/*\n#\n# result = SocialCalc.Formula.DecodeRangeParts(sheetdata, range)\n#\n# Returns sheetdata for the sheet where the range is, as well as\n# the number of the first column in the range, the number of columns,\n# and equivalent row information:\n#\n# {sheetdata: sheet, sheetname: name-or-\"\", col1num: n, ncols: n, row1num: n, nrows: n}\n#\n# If any errors, a null result is returned.\n#\n*/\n\nSocialCalc.Formula.DecodeRangeParts = function(sheetdata, range) {\n\n   var value1, value2, pos1, pos2, sheet1, coordsheetdata, rp;\n\n   var scf = SocialCalc.Formula;\n\n   pos1 = range.indexOf(\"|\");\n   pos2 = range.indexOf(\"|\", pos1+1);\n   value1 = range.substring(0, pos1);\n   value2 = range.substring(pos1+1, pos2);\n\n   pos1 = value1.indexOf(\"!\");\n   if (pos1 != -1) {\n      sheet1 = value1.substring(pos1+1);\n      value1 = value1.substring(0, pos1);\n      }\n   else {\n      sheet1 = \"\";\n      }\n   pos1 = value2.indexOf(\"!\");\n   if (pos1 != -1) {\n      value2 = value2.substring(0, pos1);\n      }\n\n   coordsheetdata = sheetdata;\n   if (sheet1) { // sheet reference\n      coordsheetdata = scf.FindInSheetCache(sheet1);\n      if (coordsheetdata == null) { // unavailable\n         return null;\n         }\n      }\n\n   rp = scf.OrderRangeParts(value1, value2);\n\n   return {sheetdata: coordsheetdata, sheetname: sheet1, col1num: rp.c1, ncols: rp.c2-rp.c1+1, row1num: rp.r1, nrows: rp.r2-rp.r1+1}\n\n   }\n\n\n\n//*********************\n//\n// Function Handling\n//\n//*********************\n\n// List of functions -- Define after functions are defined\n//\n// SocialCalc.Formula.FunctionList[\"function_name\"] = [function_subroutine, number_of_arguments, arg_def, func_def, func_class, cell_html, io_parameters]\n//   function_subroutine takes arguments (fname, operand, foperand, sheet), returns\n//      errortext or null, pushing result on operand stack.\n//   number_of_arguments is:\n//      0 = no arguments\n//      >0 = exactly that many arguments\n//      <0 = that many arguments (abs value) or more\n//      100 = don't check\n//\n//   arg_def, if present, is the name of the element in SocialCalc.Formula.FunctionArgDefs.\n//   func_def, if present, is a string explaining the function. If not, looked up in SocialCalc.Constants.\n//   func_class, if present, is the comma-separated names of the elements in SocialCalc.Formula.FunctionClasses.\n//   cell_html, if present, is the HTML to display in the cell. will find and replace these <%=cell_reference%>, <%=displayvalue%> see SocialCalc.FormatValueForDisplay\n//   io_parameters, if present, \n//        \"ParameterList\" is used with =CopyValue() etc, used to collect parameters of the formula, for use trigger/action formulas, \n//        \"EventTree\" is used with =Button() etc, used to store trigger cell lookup table\n//        \"Input\" for input style GUI widgets - textbox/radio buttons etc - \n//\n// To add a function, just add it to this object.\n\n   if (!SocialCalc.Formula.FunctionList) { // make sure it is defined (could have been in another module)\n      SocialCalc.Formula.FunctionList = {};\n      }\n\n   // FunctionClasses[classname] = {name: full-name-string, items: [sorted list of function names]};\n   // filled in by SocialCalc.Formula.FillFunctionInfo\n\n   SocialCalc.Formula.FunctionClasses = null; // start null to say needs filling in\n\n   // FunctionArgDef[argname] = explicit-string-for-arg-list;\n   // filled in by SocialCalc.Formula.FillFunctionInfo\n\n   SocialCalc.Formula.FunctionArgDefs = {};\n\n\n   \n\n/*\n#\n# SocialCalc.Formula.StoreIoEventFormula(coord, operand_reverse, sheet, io_parameters)\n# \n# store forumla parameters of io event formulas\n#\n# enable lookup of ioForumalas when a trigger formula is activated \n# store formula details in sheet.ioEventTree  and sheet.ioParameterList \n#\n*/\n// eddy StoreIoEventFormula\nSocialCalc.Formula.StoreIoEventFormula = function(function_name, coord, operand_reverse, sheet, io_parameters) {\n\tvar operand = [];\n\tSocialCalc.Formula.Clone(operand,operand_reverse);\n    operand.reverse(); // normal parameter order\n    if(operand.length == 0) return;\n\t\n\t// add radio buttons to list - so radio group can be updated\n\tif(function_name == \"RADIOBUTTON\") {\n\t\tif(typeof sheet.ioEventTree === 'undefined') sheet.ioEventTree = {};\t\n\t\t\n\t}\n\t\n\n  if(typeof sheet.ioEventTree === 'undefined') sheet.ioEventTree = {};\t\n  if(typeof sheet.ioParameterList === 'undefined') sheet.ioParameterList = {};\n  if(typeof sheet.ioTimeTriggerList === 'undefined') sheet.ioTimeTriggerList = {}; \n\n  // store parameters of each action formulas \n  if(typeof sheet.ioParameterList[coord] === 'undefined') sheet.ioParameterList[coord] = {};\n  sheet.ioParameterList[coord] = operand;\n  sheet.ioParameterList[coord].function_name = function_name;\n  \n  // send trigger times to server if changed\n  if(io_parameters == \"TimeTrigger\") { // timer trigger formula exists   \n    // function to push cell time into array\n    var PushTriggerTime = function(list, coordA1, sheetData) {\n      var cell = sheetData.cells[coordA1];   \n      if (typeof cell !== 'undefined' && cell.valuetype.charAt(0) == \"n\") { // if not blank and is number\n        list.push(cell.datavalue);\n      }\n    };\n\n    var triggerTimeCellId = SocialCalc.Formula.PlainCoord(operand[0].value); // strip dollar signs\n    \n    var currentTriggerTimeList = [];\n    \n    if(operand[0].type == \"range\" )  {      \n      var rangeinfo = SocialCalc.Formula.DecodeRangeParts(sheet, triggerTimeCellId);\n      for (var i=0; i<rangeinfo.ncols; i++) {\n        for (var j=0; j<rangeinfo.nrows; j++) {\n          var cellCoord = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\n          PushTriggerTime(currentTriggerTimeList, cellCoord, sheet);\n        }\n      }\n    }\n    \n    if(operand[0].type == \"coord\" ) {      \n      PushTriggerTime(currentTriggerTimeList, triggerTimeCellId, sheet);\n    }\n    \n    if (operand[0].type.charAt(0) == \"n\") {\n      currentTriggerTimeList.push(operand[0].value);      \n    }\n\n    // if time triggers changed then set changed times in ioTimeTrigger and schedule      \n    if(typeof sheet.ioTimeTriggerList[coord] === 'undefined' || SocialCalc.Formula.ArrayValuesEqual(sheet.ioTimeTriggerList[coord], currentTriggerTimeList) == false) {\n      // set the time+cell in ioTimeTrigger\n      sheet.ioTimeTriggerList[coord] = currentTriggerTimeList;\n      // schedule the set Time Trigger // sheet.ScheduleSheetCommands('...    \n      var timeZoneOffsetMins = (new Date()).getTimezoneOffset();\n      var start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1      \n      var triggerUTCTimeList = []; /// EPOCH in Mins - Mins since 1/1/1970 GMT\n      for(var index = 0; index < currentTriggerTimeList.length; ++index) triggerUTCTimeList[index] = Math.floor(((currentTriggerTimeList[index] - start_1_1_1970 ) *24 * 60) + timeZoneOffsetMins);\n      sheet.ScheduleSheetCommands('settimetrigger '+coord+' '+triggerUTCTimeList.toString());       \n    }\n  }\n  \n\t// store trigger lookup table\n  if(io_parameters == \"EventTree\"\t&& (operand[0].type == \"coord\" || operand[0].type == \"range\")) { // trigger cell exists   \n  \t// create a list of action formulas for each trigger cell  \n    var triggerCellId = operand[0].value.replace(/\\$/g,''); // strip dollar signs\n    var PushTriggerCord = function(list, index, v) {\n        if(typeof list[index] === 'undefined') list[index] = {};\n        list[index][v] = v;\n    };\n\n\n    if(operand[0].type == \"range\" )  {      \n\t      var rangeinfo = SocialCalc.Formula.DecodeRangeParts(sheet, triggerCellId);\n      for (var i=0; i<rangeinfo.ncols; i++) {\n         for (var j=0; j<rangeinfo.nrows; j++) {\n            var cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\n                          PushTriggerCord(sheet.ioEventTree, cellcr, coord); \n                          \n         }\n      }\n    }\n    if(operand[0].type == \"coord\" ) {\n        PushTriggerCord(sheet.ioEventTree, triggerCellId, coord); \n    }                \n  }\n\n  \n  //IF GUI widget is \"Input\"\n  if(io_parameters == \"Input\" ) {\n    var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \n          ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \n          : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\n    \n    if(formDataViewer != null && formDataViewer.loaded == true) {\n      \n      // IF formFields  not loaded - load formFields  \n      if( formDataViewer.formFields == null) SocialCalc.Formula.LoadFormFields();\n      //  get formFieldName\n      var formFieldName = (function_name+coord).toLowerCase();\n      //  if formFieldName not in formFields  \n      var sheetCmd = null;\n      if(formDataViewer.formFields[formFieldName] == null) {\n        //    store formFieldName of gui input widget \n        //    add formFieldName  to formFields  \n        var col = formDataViewer.formFields[formFieldName] = formDataViewer.formFieldsLength++ + 2;\n        //    add formFieldName to next empty cell (starting with B1)\n        var headerCoord = SocialCalc.crToCoord(col, 1);\n        sheetCmd = \"set \"+headerCoord+\" text t \"+SocialCalc.encodeForSave(function_name.toLowerCase()+coord);\n      }\n      if(operand[0].type.charAt(0) == \"t\" || operand[0].type.charAt(0) == \"n\") {       \n        var valueCoord = SocialCalc.crToCoord(formDataViewer.formFields[formFieldName], 2);\n        if(formDataViewer.sheet.cells[valueCoord] == null ||  formDataViewer.sheet.cells[valueCoord].datavalue != operand[0].value) {\n          var sheetCmdTwo = \"set \"+valueCoord+\" text t \"+SocialCalc.encodeForSave(operand[0].value);\n          if (sheetCmd != null) sheetCmd = sheetCmd + \"\\n\" + sheetCmdTwo; else sheetCmd = sheetCmdTwo;        \n        }\n  \n      }\n      if (sheetCmd != null) formDataViewer.sheet.ScheduleSheetCommands(sheetCmd, false);    \n    }    \n  }    \n        \n\n\tSocialCalc.DebugLog({ ioEventTree: sheet.ioEventTree});\n\tSocialCalc.DebugLog({ ioParameterList: sheet.ioParameterList});\n}   \n   \n\n/**\n * ArrayValuesEqual\n * \n * Warning - nested vales are NOT tested.\n * returns true if both arrays contain the same values\n */    \nSocialCalc.Formula.ArrayValuesEqual = function(a, b) {\n  var i = a.length;\n  if (i != b.length) return false;\n  while (i--) {\n      if (a[i] !== b[i]) return false;\n  }\n  return true;\n};\n\nSocialCalc.Formula.Clone =   function(destination, source) {\n        for (var property in source) {\n            if (typeof source[property] === \"object\" && source[property] !== null && destination[property]) { \n                SocialCalc.Formula.Clone(destination[property], source[property]);\n            } else {\n                destination[property] = source[property];\n            }\n        }\n    };   \n\n/**\n * LoadFormFields\n * \n * Load the fieldNames of the form \n *  Cell A1 contains \"FieldName:\" and cells B1 to n contain field names\n *  Cell A2 contains \"Pending\" - pending data row. The pending row is moved to row 3 by inseting a new row 2 onSubmit \n *  Put the fieldNames into an array for fast lookup and position information\n */    \n    \nSocialCalc.Formula.LoadFormFields =   function() {\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \n    ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \n    : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\n\n  formDataViewer.formFields = {};\n\n  \n  //IF cell A1 is blank - Adds \"FieldName:\" to A1\n  if(formDataViewer.sheet.cells.A1 == null ) {\n    formDataViewer.sheet.ScheduleSheetCommands(\"set A1 text t \"+SocialCalc.encodeForSave(\"FieldName:\"), false);       \n  }\n  \n  if(formDataViewer.sheet.cells.A2 == null ) {\n    formDataViewer.sheet.ScheduleSheetCommands(\"set A2 text t \"+SocialCalc.encodeForSave(\"Pending:\"), false);       \n  }\n\n  \n  //  For each cell in row 1, from B1 to 1st blank cell\n  var col = 2;\n  while(true) {\n    var coord = SocialCalc.crToCoord(col, 1);\n    var cell=formDataViewer.sheet.cells[coord];\n    if (!cell) break;\n    //    Put cell value into formFields  \n    formDataViewer.formFields[cell.datavalue.toLowerCase()] = col;\n    col ++;\n  }\n  formDataViewer.formFieldsLength = col -2;\n\n}    \n   \n/*\n#\n# errortext = SocialCalc.Formula.CalculateFunction(fname, operand, sheet)\n#\n# Dispatches for function fname.\n#\n*/\n\nSocialCalc.Formula.CalculateFunction = function(fname, operand, sheet, coord) {\n\n   var fobj, foperand, ffunc, argnum, ttext;\n   var scf = SocialCalc.Formula;\n   var ok = 1;\n   var errortext = \"\";\n\n   fobj = scf.FunctionList[fname];\n\n   if (fobj) {\n   \n\n      foperand = [];\n      ffunc = fobj[0];\n      argnum = fobj[1];\n      scf.CopyFunctionArgs(operand, foperand);\n\n\t  // eddy CalculateFunction {\n   if(fobj[6] && fobj[6] != \"\") {\t  \n\t   SocialCalc.DebugLog(\"action:\"+fname);\t\t\n\t\t scf.StoreIoEventFormula(fname, coord, foperand, sheet, fobj[6]);\n\t\t\n\t  }\n\t  // }\n\t  \n      if (argnum != 100) {\n         if (argnum < 0) {\n            if (foperand.length < -argnum) {\n               errortext = scf.FunctionArgsError(fname, operand);\n               return errortext;\n               }\n            }\n         else {\n            if (foperand.length != argnum) {\n               errortext = scf.FunctionArgsError(fname, operand);\n               return errortext;\n               }\n            }\n         }\n\n\t\t \n\t  \n      errortext = ffunc(fname, operand, foperand, sheet);\n      }\n\n   else {\n         ttext = fname;\n\n         if (operand.length && operand[operand.length-1].type == \"start\") { // no arguments - name or zero arg function\n            operand.pop();\n            scf.PushOperand(operand, \"name\", ttext);\n            }\n\n         else {\n            errortext = SocialCalc.Constants.s_sheetfuncunknownfunction+\" \" + ttext +\". \";\n            }\n      }\n\n   return errortext;\n\n}\n\n//\n// SocialCalc.Formula.PushOperand(operand, t, v)\n//\n// Pushes the type and value onto the operand stack\n//\n\nSocialCalc.Formula.PushOperand = function(operand, t, v) {\n\n   operand.push({type: t, value: v});\n\n   }\n\n//\n// SocialCalc.Formula.CopyFunctionArgs(operand, foperand)\n//\n// Pops operands from operand and pushes on foperand up to function start\n// reversing order in the process.\n//\n\nSocialCalc.Formula.CopyFunctionArgs = function(operand, foperand) {\n\n   var fobj, foperand, ffunc, argnum;\n   var scf = SocialCalc.Formula;\n   var ok = 1;\n   var errortext = null;\n\n   while (operand.length>0 && operand[operand.length-1].type != \"start\") { // get each arg\n      foperand.push(operand.pop()); // copy it\n      }\n   operand.pop(); // get rid of \"start\"\n\n   return;\n\n   }\n\n//\n// errortext = SocialCalc.Formula.FunctionArgsError(fname, operand)\n//\n// Pushes appropriate error on operand stack and returns errortext, including fname\n//\n\nSocialCalc.Formula.FunctionArgsError = function(fname, operand) {\n\n   var errortext = SocialCalc.Constants.s_calcerrincorrectargstofunction+\" \" + fname + \". \";\n   SocialCalc.Formula.PushOperand(operand, \"e#VALUE!\", errortext);\n\n   return errortext;\n\n   }\n\n\n//\n// errortext = SocialCalc.Formula.FunctionSpecificError(fname, operand, errortype, errortext)\n//\n// Pushes specified error and text on operand stack.\n//\n\nSocialCalc.Formula.FunctionSpecificError = function(fname, operand, errortype, errortext) {\n\n   SocialCalc.Formula.PushOperand(operand, errortype, errortext);\n\n   return errortext;\n\n   }\n\n//\n// haserror = SocialCalc.Formula.CheckForErrorValue(operand, v)\n//\n// If v.type is an error, push it on operand stack and return true, otherwise return false.\n//\n\nSocialCalc.Formula.CheckForErrorValue = function(operand, v) {\n\n   if (v.type.charAt(0) == \"e\") {\n      operand.push(v);\n      return true;\n      }\n   else {\n      return false;\n      }\n\n   }\n\n/////////////////////////\n//\n// FUNCTION INFORMATION ROUTINES\n//\n\n//\n// SocialCalc.Formula.FillFunctionInfo()\n//\n// Goes through function definitions and fills out FunctionArgDefs and FunctionClasses.\n// Execute this after any changes to SocialCalc.Constants but before UI is used.\n//\n\nSocialCalc.Formula.FillFunctionInfo = function() {\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n\n   var fname, f, classes, cname, i;\n\n   if (scf.FunctionClasses) { // only do once\n      return;\n      }\n\n   for (fname in scf.FunctionList) {\n      f = scf.FunctionList[fname];\n      if (f[2]) { // has an arg def\n         scf.FunctionArgDefs[f[2]] = scc[\"s_farg_\"+f[2]] || \"\"; // get it from constants\n         }\n      if (!f[3]) { // no text def, see if in constants\n         if (scc[\"s_fdef_\"+fname]) {\n            scf.FunctionList[fname][3] = scc[\"s_fdef_\"+fname];\n            }\n         }\n      }\n\n   scf.FunctionClasses = {};\n \n   for (i=0; i<scc.function_classlist.length; i++) {\n      cname = scc.function_classlist[i];\n      scf.FunctionClasses[cname] = {name: scc[\"s_fclass_\"+cname], items: []};\n      }\n\n   for (fname in scf.FunctionList) {\n      f = scf.FunctionList[fname];\n      classes = f[4] ? f[4].split(\",\") : []; // get classes\n      classes.push(\"all\");\n      for (i=0; i<classes.length; i++) {\n         cname = classes[i];\n         scf.FunctionClasses[cname].items.push(fname);\n         }\n      }\n   for (cname in scf.FunctionClasses) {\n      scf.FunctionClasses[cname].items.sort();\n      }\n\n   }\n\n//\n// str = SocialCalc.Formula.FunctionArgString(fname)\n//\n// Returns a string representing the arguments to function fname.\n//\n\nSocialCalc.Formula.FunctionArgString = function(fname) {\n\n   var scf = SocialCalc.Formula;\n   var fdata = scf.FunctionList[fname];\n   var nargs, i, str;\n\n   var adef = fdata[2];\n\n   if (!adef) {\n      nargs = fdata[1];\n      if (nargs == 0) {\n         adef = \" \";\n         }\n      else if (nargs > 0) {\n         str = \"v1\";\n         for (i=2; i<=nargs; i++) {\n            str += \", v\"+i;\n            }\n         return str;\n         }\n      else if (nargs < 0) {\n         str = \"v1\";\n         for (i=2; i<-nargs; i++) {\n            str += \", v\"+i;\n            }\n         return str+\", ...\";\n         }\n      else {\n         return \"nargs: \"+nargs;\n         }\n      }\n\n   str = scf.FunctionArgDefs[adef] || adef;\n\n   return str;\n\n   }\n\n\n/////////////////////////\n//\n// FUNCTION DEFINITIONS\n//\n// The standard function definitions follow.\n//\n// Note that some need SocialCalc.DetermineValueType to be defined.\n//\n\n/*\n#\n# AVERAGE(v1,c1:c2,...)\n# COUNT(v1,c1:c2,...)\n# COUNTA(v1,c1:c2,...)\n# COUNTBLANK(v1,c1:c2,...)\n# MAX(v1,c1:c2,...)\n# MIN(v1,c1:c2,...)\n# PRODUCT(v1,c1:c2,...)\n# STDEV(v1,c1:c2,...)\n# STDEVP(v1,c1:c2,...)\n# SUM(v1,c1:c2,...)\n# VAR(v1,c1:c2,...)\n# VARP(v1,c1:c2,...)\n#\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\n# If this routine is changed, check the dseries_functions, too.\n#\n*/\n\nSocialCalc.Formula.SeriesFunctions = function(fname, operand, foperand, sheet) {\n\n   var value1, t, v1;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   var sum = 0;\n   var resulttypesum = \"\";\n   var count = 0;\n   var counta = 0;\n   var countblank = 0;\n   var product = 1;\n   var maxval;\n   var minval;\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\n\n   while (foperand.length > 0) {\n      value1 = operand_value_and_type(sheet, foperand);\n      t = value1.type.charAt(0);\n      if (t == \"n\") count += 1;\n      if (t != \"b\") counta += 1;\n      if (t == \"b\") countblank += 1;\n\n      if (t == \"n\") {\n         v1 = value1.value-0; // get it as a number\n         sum += v1;\n         product *= v1;\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\n            mk1 = v1;\n            sk1 = 0;\n            }\n         else { // Accumulate S sub 1 through n as per Knuth noted above\n            mk = mk1 + (v1 - mk1) / count;\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\n            sk1 = sk;\n            mk1 = mk;\n            }\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\n         }\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\n         resulttypesum = value1.type;\n         }\n      }\n\n   resulttypesum = resulttypesum || \"n\";\n\n   switch (fname) {\n      case \"SUM\":\n         PushOperand(resulttypesum, sum);\n         break;\n\n      case \"PRODUCT\": // may handle cases with text differently than some other spreadsheets\n         PushOperand(resulttypesum, product);\n         break;\n\n      case \"MIN\":\n         PushOperand(resulttypesum, minval || 0);\n         break;\n\n      case \"MAX\":\n         PushOperand(resulttypesum, maxval || 0);\n         break;\n\n      case \"COUNT\":\n         PushOperand(\"n\", count);\n         break;\n\n      case \"COUNTA\":\n         PushOperand(\"n\", counta);\n         break;\n\n      case \"COUNTBLANK\":\n         PushOperand(\"n\", countblank);\n         break;\n\n      case \"AVERAGE\":\n         if (count > 0) {\n            PushOperand(resulttypesum, sum/count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"STDEV\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"STDEVP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"VAR\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / (count - 1));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"VARP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n      }\n\n   return null;\n\n   }\n\n//*********************\n//\n// Docs see - Function Handling - ~line 1560\n// \n//*********************\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"AVERAGE\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"COUNT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"COUNTA\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"COUNTBLANK\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"MAX\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"MIN\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"PRODUCT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"STDEV\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"STDEVP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"SUM\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"VAR\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\nSocialCalc.Formula.FunctionList[\"VARP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\n\n/*\n#\n# SUMPRODUCT(range1, range2, ...)\n#\n*/\n\nSocialCalc.Formula.SumProductFunction = function(fname, operand, foperand, sheet) {\n  \n   var range, products = [], sum = 0;\n   var scf = SocialCalc.Formula;\n   var ncols = 0, nrows = 0;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   while (foperand.length > 0) {\n      range = scf.TopOfStackValueAndType(sheet, foperand);\n      if (range.type != \"range\") {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      rangeinfo = scf.DecodeRangeParts(sheet, range.value);\n      if (!ncols) ncols = rangeinfo.ncols;\n      else if (ncols != rangeinfo.ncols) {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      if (!nrows) nrows = rangeinfo.nrows;\n      else if (nrows != rangeinfo.nrows) {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      for (i=0; i<rangeinfo.ncols; i++) {\n         for (j=0; j<rangeinfo.nrows; j++) {\n            k = i * rangeinfo.nrows + j;\n            cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\n            cell = rangeinfo.sheetdata.GetAssuredCell(cellcr);\n            value = cell.valuetype == \"n\" ? cell.datavalue : 0;\n            products[k] = ((typeof products[k] !== 'undefined')? products[k] : 1) * value;\n            }\n         }\n      }\n   for (i=0; i<products.length; i++) {\n      sum += products[i];\n      }\n   PushOperand(\"n\", sum);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"SUMPRODUCT\"] = [SocialCalc.Formula.SumProductFunction, -1, \"rangen\", \"\", \"stat\"];\n\n/*\n#\n# DAVERAGE(databaserange, fieldname, criteriarange)\n# DCOUNT(databaserange, fieldname, criteriarange)\n# DCOUNTA(databaserange, fieldname, criteriarange)\n# DGET(databaserange, fieldname, criteriarange)\n# DMAX(databaserange, fieldname, criteriarange)\n# DMIN(databaserange, fieldname, criteriarange)\n# DPRODUCT(databaserange, fieldname, criteriarange)\n# DSTDEV(databaserange, fieldname, criteriarange)\n# DSTDEVP(databaserange, fieldname, criteriarange)\n# DSUM(databaserange, fieldname, criteriarange)\n# DVAR(databaserange, fieldname, criteriarange)\n# DVARP(databaserange, fieldname, criteriarange)\n#\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\n# If this routine is changed, check the series_functions, too.\n#\n*/\n\nSocialCalc.Formula.DSeriesFunctions = function(fname, operand, foperand, sheet) {\n\n   var value1, tostype, cr, dbrange, fieldname, criteriarange, dbinfo, criteriainfo;\n   var fieldasnum, targetcol, i, j, k, cell, criteriafieldnums;\n   var testok, criteriacr, criteria, testcol, testcr;\n   var t;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   var value1 = {};\n\n   var sum = 0;\n   var resulttypesum = \"\";\n   var count = 0;\n   var counta = 0;\n   var countblank = 0;\n   var countmatches = 0;   \n   var product = 1;\n   var maxval;\n   var minval;\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\n\n   dbrange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\n   fieldname = scf.OperandValueAndType(sheet, foperand); // get a value\n   criteriarange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\n\n   if (dbrange.type != \"range\" || criteriarange.type != \"range\") {\n      return scf.FunctionArgsError(fname, operand);\n      }\n\n   dbinfo = scf.DecodeRangeParts(sheet, dbrange.value);\n   criteriainfo = scf.DecodeRangeParts(sheet, criteriarange.value);\n\n   fieldasnum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, fieldname.value, fieldname.type);\n   if (fieldasnum <= 0) {\n      PushOperand(\"e#VALUE!\", 0);\n      return;\n      }\n\n   targetcol = dbinfo.col1num + fieldasnum - 1;\n   criteriafieldnums = [];\n\n   for (i=0; i<criteriainfo.ncols; i++) { // get criteria field colnums\n      cell = criteriainfo.sheetdata.GetAssuredCell(SocialCalc.crToCoord(criteriainfo.col1num + i, criteriainfo.row1num));\n      criterianum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, cell.datavalue, cell.valuetype);\n      if (criterianum <= 0) {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      criteriafieldnums.push(dbinfo.col1num + criterianum - 1);\n      }\n\n   for (i=1; i<dbinfo.nrows; i++) { // go through each row of the database\n      testok = false;\nCRITERIAROW:\n      for (j=1; j<criteriainfo.nrows; j++) { // go through each criteria row\n         for (k=0; k<criteriainfo.ncols; k++) { // look at each column\n            criteriacr = SocialCalc.crToCoord(criteriainfo.col1num + k, criteriainfo.row1num + j); // where criteria is\n            cell = criteriainfo.sheetdata.GetAssuredCell(criteriacr);\n            criteria = cell.datavalue;\n            if (typeof criteria == \"string\" && criteria.length == 0) continue; // blank items are OK\n            testcol = criteriafieldnums[k];\n            testcr = SocialCalc.crToCoord(testcol, dbinfo.row1num + i); // cell to check\n            cell = dbinfo.sheetdata.GetAssuredCell(testcr); // get cell to check from dbinfo sheet\n            if (!scf.TestCriteria(cell.datavalue, cell.valuetype || \"b\", criteria)) {\n               continue CRITERIAROW; // does not meet criteria - check next row\n               }\n            }\n         testok = true; // met all the criteria\n         break CRITERIAROW;\n         }\n      if (!testok) {\n         continue;\n         }\n\n      cr = SocialCalc.crToCoord(targetcol, dbinfo.row1num + i); // get cell of this row to do the function on\n      cell = dbinfo.sheetdata.GetAssuredCell(cr);\n\n      value1.value = cell.datavalue;\n      value1.type = cell.valuetype;\n      t = value1.type.charAt(0);\n      countmatches += 1;\n      if (t == \"n\") count += 1;\n      if (t != \"b\") counta += 1;\n      if (t == \"b\") countblank += 1;\n\n      if (t == \"n\") {\n         v1 = value1.value-0; // get it as a number\n         sum += v1;\n         product *= v1;\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\n            mk1 = v1;\n            sk1 = 0;\n            }\n         else { // Accumulate S sub 1 through n as per Knuth noted above\n            mk = mk1 + (v1 - mk1) / count;\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\n            sk1 = sk;\n            mk1 = mk;\n            }\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\n         }\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\n         resulttypesum = value1.type;\n         }\n      }\n\n   resulttypesum = resulttypesum || \"n\";\n\n   switch (fname) {\n      case \"DSUM\":\n         PushOperand(resulttypesum, sum);\n         break;\n\n      case \"DPRODUCT\": // may handle cases with text differently than some other spreadsheets\n         PushOperand(resulttypesum, product);\n         break;\n\n      case \"DMIN\":\n         PushOperand(resulttypesum, minval || 0);\n         break;\n\n      case \"DMAX\":\n         PushOperand(resulttypesum, maxval || 0);\n         break;\n\n      case \"DCOUNT\":\n         PushOperand(\"n\", count);\n         break;\n\n      case \"DCOUNTA\":\n         PushOperand(\"n\", counta);\n         break;\n\n      case \"DAVERAGE\":\n         if (count > 0) {\n            PushOperand(resulttypesum, sum/count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DSTDEV\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DSTDEVP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DVAR\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / (count - 1));\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DVARP\":\n         if (count > 1) {\n            PushOperand(resulttypesum, sk / count);\n            }\n         else {\n            PushOperand(\"e#DIV/0!\", 0);\n            }\n         break;\n\n      case \"DGET\":\n         if (countmatches == 1) {\n            PushOperand(value1.type, value1.value);\n            }\n         else if (countmatches == 0) {\n            PushOperand(\"e#VALUE!\", 0);\n            }\n         else {\n            PushOperand(\"e#NUM!\", 0);\n            }\n         break;\n\n      }\n\n   return;\n\n   }\n\n//*********************\n//\n// Docs see - Function Handling - ~line 1560\n// \n//*********************\n\nSocialCalc.Formula.FunctionList[\"DAVERAGE\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DCOUNT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DCOUNTA\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DGET\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DMAX\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DMIN\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DPRODUCT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DSTDEV\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DSTDEVP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DSUM\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DVAR\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"DVARP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\n\n/*\n#\n# colnum = SocialCalc.Formula.FieldToColnum(sheet, col1num, ncols, row1num, fieldname, fieldtype)\n#\n# If fieldname is a number, uses it, otherwise looks up string in cells in row to find field number\n#\n# If not found, returns 0.\n#\n*/\n\nSocialCalc.Formula.FieldToColnum = function(sheet, col1num, ncols, row1num, fieldname, fieldtype) {\n\n   var colnum, cell, value;\n\n   if (fieldtype.charAt(0) == \"n\") { // number - return it if legal\n      colnum = fieldname - 0; // make sure a number\n      if (colnum <= 0 || colnum > ncols) {\n         return 0;\n         }\n      return Math.floor(colnum);\n      }\n\n   if (fieldtype.charAt(0) != \"t\") { // must be text otherwise\n      return 0;\n      }\n\n   fieldname = fieldname ? fieldname.toLowerCase() : \"\";\n\n   for (colnum=0; colnum < ncols; colnum++) { // look through column headers for a match\n      cell = sheet.GetAssuredCell(SocialCalc.crToCoord(col1num+colnum, row1num));\n      value = cell.datavalue;\n      value = (value+\"\").toLowerCase(); // ignore case\n      if (value == fieldname) { // match\n         return colnum+1;\n         }         \n      }\n   return 0; // looked at all and no match\n\n   }\n\n\n/*\n#\n# HLOOKUP(value, range, row, [rangelookup])\n# VLOOKUP(value, range, col, [rangelookup])\n# MATCH(value, range, [rangelookup])\n#\n*/\n\nSocialCalc.Formula.LookupFunctions = function(fname, operand, foperand, sheet) {\n\n   var lookupvalue, range, offset, rangelookup, offsetvalue, rangeinfo;\n   var c, r, cincr, rincr, previousOK, csave, rsave, cell, value, valuetype, cr, lookupvalue;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   lookupvalue = operand_value_and_type(sheet, foperand);\n   if (typeof lookupvalue.value == \"string\") {\n      lookupvalue.value = lookupvalue.value.toLowerCase();\n      }\n\n   range = scf.TopOfStackValueAndType(sheet, foperand);\n\n   rangelookup = 1; // default to true or 1\n   if (fname == \"MATCH\") {\n      if (foperand.length) {\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\n         if (rangelookup.type.charAt(0) != \"n\") {\n            PushOperand(\"e#VALUE!\", 0);\n            return;\n            }\n         if (foperand.length) {\n            scf.FunctionArgsError(fname, operand);\n            return 0;\n            }\n         rangelookup = rangelookup.value - 0;\n         }\n      }\n   else {\n      offsetvalue = scf.OperandAsNumber(sheet, foperand);\n      if (offsetvalue.type.charAt(0) != \"n\") {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      offsetvalue = Math.floor(offsetvalue.value);\n      if (foperand.length) {\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\n         if (rangelookup.type.charAt(0) != \"n\") {\n            PushOperand(\"e#VALUE!\", 0);\n            return;\n            }\n         if (foperand.length) {\n            scf.FunctionArgsError(fname, operand);\n            return 0;\n            }\n         rangelookup = rangelookup.value ? 1 : 0; // convert to 1 or 0\n         }\n      }\n   lookupvalue.type = lookupvalue.type.charAt(0); // only deal with general type\n   if (lookupvalue.type == \"n\") { // if number, make sure a number\n      lookupvalue.value = lookupvalue.value - 0;\n      }\n\n   if (range.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n\n   rangeinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\n   if (!rangeinfo) {\n      PushOperand(\"e#REF!\", 0);\n      return;\n      }\n\n   c = 0;\n   r = 0;\n   cincr = 0;\n   rincr = 0;\n   if (fname == \"HLOOKUP\") {\n      cincr = 1;\n      if (offsetvalue > rangeinfo.nrows) {\n         PushOperand(\"e#REF!\", 0);\n         return;\n         }\n      }\n   else if (fname == \"VLOOKUP\") {\n      rincr = 1;\n      if (offsetvalue > rangeinfo.ncols) {\n         PushOperand(\"e#REF!\", 0);\n         return;\n         }\n      }\n   else if (fname == \"MATCH\") {\n      if (rangeinfo.ncols > 1) {\n         if (rangeinfo.nrows > 1) {\n            PushOperand(\"e#N/A\", 0);\n            return;\n            }\n         cincr = 1;\n         }\n      else {\n         rincr = 1;\n         }\n      }\n   else {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   if (offsetvalue < 1 && fname != \"MATCH\") {\n      PushOperand(\"e#VALUE!\", 0);\n      return 0;\n      }\n\n   previousOK; // if 1, previous test was <. If 2, also this one wasn't\n\n   while (1) {\n      cr = SocialCalc.crToCoord(rangeinfo.col1num + c, rangeinfo.row1num + r);\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\n      value = cell.datavalue;\n      valuetype = cell.valuetype ? cell.valuetype.charAt(0) : \"b\"; // only deal with general types\n      if (valuetype == \"n\") {\n         value = value - 0; // make sure number\n         }\n      if (rangelookup) { // rangelookup type 1 or -1: look for within brackets for matches\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            if ((rangelookup > 0 && lookupvalue.value > value)\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\n               previousOK = 1;\n               csave = c; // remember col and row of last OK\n               rsave = r;\n               }\n            else if (previousOK) { // last one was OK, this one isn't\n               previousOK = 2;\n               break;\n               }\n            }\n\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            if ((rangelookup > 0 && lookupvalue.value > value)\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\n               previousOK = 1;\n               csave = c;\n               rsave = r;\n               }\n            else if (previousOK) { // last one was OK, this one isn't\n               previousOK = 2;\n               break;\n               }\n            }\n         }\n      else { // exact value matches\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            }\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\n            if (lookupvalue.value == value) { // match\n               break;\n               }\n            }\n         }\n\n      r += rincr;\n      c += cincr;\n      if (r >= rangeinfo.nrows || c >= rangeinfo.ncols) { // end of range to check, no exact match\n         if (previousOK) { // at least one could have been OK\n            previousOK = 2;\n            break;\n            }\n         PushOperand(\"e#N/A\", 0);\n         return;\n         }\n      }\n\n   if (previousOK == 2) { // back to last OK\n      r = rsave;\n      c = csave;\n      }\n\n   if (fname == \"MATCH\") {\n      value = c + r + 1; // only one may be <> 0\n      valuetype = \"n\";\n      }\n   else {\n      cr = SocialCalc.crToCoord(rangeinfo.col1num+c+(fname == \"VLOOKUP\" ? offsetvalue-1 : 0), rangeinfo.row1num+r+(fname == \"HLOOKUP\" ? offsetvalue-1 : 0));\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\n      value = cell.datavalue;\n      valuetype = cell.valuetype;\n      }\n   PushOperand(valuetype, value);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"HLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"hlookup\", \"\", \"lookup\"];\nSocialCalc.Formula.FunctionList[\"MATCH\"] = [SocialCalc.Formula.LookupFunctions, -2, \"match\", \"\", \"lookup\"];\nSocialCalc.Formula.FunctionList[\"VLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"vlookup\", \"\", \"lookup\"];\n\n/*\n#\n# INDEX(range, rownum, colnum)\n#\n*/\n\nSocialCalc.Formula.IndexFunction = function(fname, operand, foperand, sheet) {\n\n   var range, sheetname, indexinfo, rowindex, colindex, result, resulttype;\n\n   var scf = SocialCalc.Formula;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range\n   if (range.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   indexinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\n   if (indexinfo.sheetname) {\n      sheetname = \"!\" + indexinfo.sheetname;\n      }\n   else {\n      sheetname = \"\";\n      }\n\n   rowindex = {value:0};\n   colindex = {value:0};\n\n   if (foperand.length) { // look for row number\n      rowindex = scf.OperandAsNumber(sheet, foperand);\n      if (rowindex.type.charAt(0) != \"n\" || rowindex.value < 0) {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      if (foperand.length) { // look for col number\n         colindex = scf.OperandAsNumber(sheet, foperand);\n         if (colindex.type.charAt(0) != \"n\" || colindex.value < 0) {\n            PushOperand(\"e#VALUE!\", 0);\n            return;\n            }\n         if (foperand.length) {\n            scf.FunctionArgsError(fname, operand);\n            return 0;\n            }\n         }\n      else { // col number missing\n         if (indexinfo.nrows == 1) { // if only one row, then rowindex is really colindex\n            colindex.value = rowindex.value;\n            rowindex.value = 0;\n            }\n         }\n      }\n\n   if (rowindex.value > indexinfo.nrows || colindex.value > indexinfo.ncols) {\n      PushOperand(\"e#REF!\", 0);\n      return;\n      }\n\n   if (rowindex.value == 0) {\n      if (colindex.value == 0) {\n         if (indexinfo.nrows == 1 && indexinfo.ncols == 1) {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname;\n            resulttype = \"coord\";\n            }\n         else {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname + \"|\" +\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+indexinfo.nrows-1) + \n                     \"|\";\n            resulttype = \"range\";\n            }\n         }\n      else {\n         if (indexinfo.nrows == 1) {\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname;\n            resulttype = \"coord\";\n            }\n         else {\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname + \"|\" +\n                     SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+indexinfo.nrows-1) +\n                     \"|\";\n            resulttype = \"range\";\n            }\n         }\n      }\n   else {\n      if (colindex.value == 0) {\n         if (indexinfo.ncols == 1) {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname;\n            resulttype = \"coord\";\n            }\n         else {\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname + \"|\" +\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+rowindex.value-1) +\n                     \"|\";\n            resulttype = \"range\";\n            }\n         }\n      else {\n         result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+rowindex.value-1) + sheetname;\n         resulttype = \"coord\";\n         }\n      }\n\n   PushOperand(resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"INDEX\"] = [SocialCalc.Formula.IndexFunction, -1, \"index\", \"\", \"lookup\"];\n\n/*\n#\n# COUNTIF(c1:c2,\"criteria\")\n# SUMIF(c1:c2,\"criteria\",[range2])\n#\n*/\n\nSocialCalc.Formula.CountifSumifFunctions = function(fname, operand, foperand, sheet) {\n\n   var range, criteria, sumrange, f2operand, result, resulttype, value1, value2;\n   var sum = 0;\n   var resulttypesum = \"\";\n   var count = 0;\n\n   var scf = SocialCalc.Formula;\n   var operand_value_and_type = scf.OperandValueAndType;\n   var lookup_result_type = scf.LookupResultType;\n   var typelookupplus = scf.TypeLookupTable.plus;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range or coord\n   criteria = scf.OperandAsText(sheet, foperand); // get criteria\n   if (fname == \"SUMIF\") {\n      if (foperand.length == 1) { // three arg form of SUMIF\n         sumrange = scf.TopOfStackValueAndType(sheet, foperand);\n         }\n      else if (foperand.length == 0) { // two arg form\n         sumrange = {value: range.value, type: range.type};\n         }\n      else {\n         scf.FunctionArgsError(fname, operand);\n         return 0;\n         }\n      }\n   else {\n      sumrange = {value: range.value, type: range.type};\n      }\n\n   if (criteria.type.charAt(0) == \"n\") {\n      criteria.value = criteria.value + \"\"; // make text\n      }\n   else if (criteria.type.charAt(0) == \"e\") { // error\n      criteria.value = null;\n      }\n   else if (criteria.type.charAt(0) == \"b\") { // blank here is undefined\n      criteria.value = null;\n      }\n\n   if (range.type != \"coord\" && range.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n\n   if (fname == \"SUMIF\" && sumrange.type != \"coord\" && sumrange.type != \"range\") {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n\n   foperand.push(range);\n   f2operand = []; // to allow for 3 arg form\n   f2operand.push(sumrange);\n\n   while (foperand.length) {\n      value1 = operand_value_and_type(sheet, foperand);\n      value2 = operand_value_and_type(sheet, f2operand);\n      if (!scf.TestCriteria(value1.value, value1.type, criteria.value)) {\n         continue;\n         }\n\n      count += 1;\n\n      if (value2.type.charAt(0) == \"n\") {\n         sum += value2.value-0;\n         resulttypesum = lookup_result_type(value2.type, resulttypesum || value2.type, typelookupplus);\n         }\n      else if (value2.type.charAt(0) == \"e\" && resulttypesum.charAt(0) != \"e\") {\n         resulttypesum = value2.type;\n         }\n      }\n\n   resulttypesum = resulttypesum || \"n\";\n\n   if (fname == \"SUMIF\") {\n      PushOperand(resulttypesum, sum);\n      }\n   else if (fname == \"COUNTIF\") {\n      PushOperand(\"n\", count);\n      }\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"COUNTIF\"] = [SocialCalc.Formula.CountifSumifFunctions, 2, \"rangec\", \"\", \"stat\"];\nSocialCalc.Formula.FunctionList[\"SUMIF\"] = [SocialCalc.Formula.CountifSumifFunctions, -2, \"sumif\", \"\", \"stat\"];\n\n/*\n#\n# IF(cond,truevalue,falsevalue)\n#\n*/\n\nSocialCalc.Formula.IfFunction = function(fname, operand, foperand, sheet) {\n\n   var cond, t;\n\n   cond = SocialCalc.Formula.OperandValueAndType(sheet, foperand);\n   t = cond.type.charAt(0);\n   if (t != \"n\" && t != \"b\") {\n      operand.push({type: \"e#VALUE!\", value: 0});\n      return;\n      }\n\n   var op1, op2;\n\n   op1 = foperand.pop();\n   if (foperand.length == 1) {\n      op2 = foperand.pop();\n      }\n   else if (foperand.length == 0) {\n      op2 = {type: \"n\", value: 0};\n      }\n   else {\n      scf.FunctionArgsError(fname, operand);\n      return;\n   }\n\n   operand.push(cond.value ? op1 : op2);\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"IF\"] = [SocialCalc.Formula.IfFunction, -2, \"iffunc\", \"\", \"test\"];\n\n/*\n#\n# DATE(year,month,day)\n#\n*/\n\nSocialCalc.Formula.DateFunction = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var year = scf.OperandAsNumber(sheet, foperand);\n   var month = scf.OperandAsNumber(sheet, foperand);\n   var day = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(year.type, month.type, scf.TypeLookupTable.twoargnumeric);\n   resulttype = scf.LookupResultType(resulttype, day.type, scf.TypeLookupTable.twoargnumeric);\n   if (resulttype.charAt(0) == \"n\") {\n      result = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(\n                  Math.floor(year.value), Math.floor(month.value), Math.floor(day.value)\n                  ) - SocialCalc.FormatNumber.datevalues.julian_offset;\n      resulttype = \"nd\";\n      }\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DATE\"] = [SocialCalc.Formula.DateFunction, 3, \"date\", \"\", \"datetime\"];\n\n/*\n#\n# TIME(hour,minute,second)\n#\n*/\n\nSocialCalc.Formula.TimeFunction = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var hours = scf.OperandAsNumber(sheet, foperand);\n   var minutes = scf.OperandAsNumber(sheet, foperand);\n   var seconds = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(hours.type, minutes.type, scf.TypeLookupTable.twoargnumeric);\n   resulttype = scf.LookupResultType(resulttype, seconds.type, scf.TypeLookupTable.twoargnumeric);\n   if (resulttype.charAt(0) == \"n\") {\n      result = ((hours.value * 60 * 60) + (minutes.value * 60) + seconds.value) / (24*60*60);\n      resulttype = \"nt\";\n      }\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"TIME\"] = [SocialCalc.Formula.TimeFunction, 3, \"hms\", \"\", \"datetime\"];\n\n/*\n#\n# DAY(date)\n# MONTH(date)\n# YEAR(date)\n# WEEKDAY(date, [type])\n#\n*/\n\nSocialCalc.Formula.DMYFunctions = function(fname, operand, foperand, sheet) {\n\n   var ymd, dtype, doffset;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n\n   var datevalue = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(datevalue.type, datevalue.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (resulttype.charAt(0) == \"n\") {\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(\n               Math.floor(datevalue.value + SocialCalc.FormatNumber.datevalues.julian_offset));\n      switch (fname) {\n         case \"DAY\":\n            result = ymd.day;\n            break;\n\n         case \"MONTH\":\n            result = ymd.month;\n            break;\n\n         case \"YEAR\":\n            result = ymd.year;\n            break;\n\n         case \"WEEKDAY\":\n            dtype = {value: 1};\n            if (foperand.length) { // get type if present\n               dtype = scf.OperandAsNumber(sheet, foperand);\n               if (dtype.type.charAt(0) != \"n\" || dtype.value < 1 || dtype.value > 3) {\n                  scf.PushOperand(operand, \"e#VALUE!\", 0);\n                  return;\n                  }\n               if (foperand.length) { // extra args\n                  scf.FunctionArgsError(fname, operand);\n                  return;\n                  }\n               }\n            doffset = 6;\n            if (dtype.value > 1) {\n               doffset -= 1;\n               }\n            result = Math.floor(datevalue.value+doffset) % 7 + (dtype.value < 3 ? 1 : 0);\n            break;\n         }\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DAY\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"MONTH\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"YEAR\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"WEEKDAY\"] = [SocialCalc.Formula.DMYFunctions, -1, \"weekday\", \"\", \"datetime\"];\n\n/*\n#\n# HOUR(datetime)\n# MINUTE(datetime)\n# SECOND(datetime)\n#\n*/\n\nSocialCalc.Formula.HMSFunctions = function(fname, operand, foperand, sheet) {\n\n   var hours, minutes, seconds, fraction;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n\n   var datetime = scf.OperandAsNumber(sheet, foperand);\n   var resulttype = scf.LookupResultType(datetime.type, datetime.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (resulttype.charAt(0) == \"n\") {\n      if (datetime.value < 0) {\n         scf.PushOperand(operand, \"e#NUM!\", 0); // must be non-negative\n         return;\n         }\n      fraction = datetime.value - Math.floor(datetime.value); // fraction of a day\n      fraction *= 24;\n      hours = Math.floor(fraction);\n      fraction -= Math.floor(fraction);\n      fraction *= 60;\n      minutes = Math.floor(fraction);\n      fraction -= Math.floor(fraction);\n      fraction *= 60;\n      seconds = Math.floor(fraction + (datetime.value >= 0 ? 0.5: -0.5));\n      if (fname == \"HOUR\") {\n         result = hours;\n         }\n      else if (fname == \"MINUTE\") {\n         result = minutes;\n         }\n      else if (fname == \"SECOND\") {\n         result = seconds;\n         }\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"HOUR\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"MINUTE\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"SECOND\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\n\n/*\n#\n# EXACT(v1,v2)\n#\n*/\n\nSocialCalc.Formula.ExactFunction = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"nl\";\n\n   var value1 = scf.OperandValueAndType(sheet, foperand);\n   var v1type = value1.type.charAt(0);\n   var value2 = scf.OperandValueAndType(sheet, foperand);\n   var v2type = value2.type.charAt(0);\n\n   if (v1type == \"t\") {\n      if (v2type == \"t\") {\n         result = value1.value == value2.value ? 1 : 0;\n         }\n      else if (v2type == \"b\") {\n         result = value1.value.length ? 0 : 1;\n         }\n      else if (v2type == \"n\") {\n         result = value1.value == value2.value+\"\" ? 1 : 0;\n         }\n      else if (v2type == \"e\") {\n         result = value2.value;\n         resulttype = value2.type;\n         }\n      else {\n         result = 0;\n         }\n      }\n   else if (v1type == \"n\") {\n      if (v2type == \"n\") {\n         result = value1.value-0 == value2.value-0 ? 1 : 0;\n         }\n      else if (v2type == \"b\") {\n         result = 0;\n         }\n      else if (v2type == \"t\") {\n         result = value1.value+\"\" == value2.value ? 1 : 0;\n         }\n      else if (v2type == \"e\") {\n         result = value2.value;\n         resulttype = value2.type;\n         }\n      else {\n         result = 0;\n         }\n      }\n   else if (v1type == \"b\") {\n      if (v2type == \"t\") {\n         result = value2.value.length ? 0 : 1;\n         }\n      else if (v2type == \"b\") {\n         result = 1;\n         }\n      else if (v2type == \"n\") {\n         result = 0;\n         }\n      else if (v2type == \"e\") {\n         result = value2.value;\n         resulttype = value2.type;\n         }\n      else {\n         result = 0;\n         }\n      }\n   else if (v1type == \"e\") {\n      result = value1.value;\n      resulttype = value1.type;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"EXACT\"] = [SocialCalc.Formula.ExactFunction, 2, \"\", \"\", \"text\"];\n\n/*\n#\n# FIND(key,string,[start])\n# LEFT(string,[length])\n# LEN(string)\n# LOWER(string)\n# MID(string,start,length)\n# PROPER(string)\n# REPLACE(string,start,length,new)\n# REPT(string,count)\n# RIGHT(string,[length])\n# SUBSTITUTE(string,old,new,[which])\n# TRIM(string)\n# HEXCODE(string)\n# UPPER(string)\n#\n*/\n\n// SocialCalc.Formula.ArgList has an array for each function, one entry for each possible arg (up to max).\n// Min args are specified in SocialCalc.Formula.FunctionList.\n// If array element is 1 then it's a text argument, if it's 0 then it's numeric, if -1 then just get whatever's there\n// Text values are manipulated as UTF-8, converting from and back to byte strings\n\nSocialCalc.Formula.ArgList = {\n                FIND: [1, 1, 0],\n                LEFT: [1, 0],\n                LEN: [1],\n                LOWER: [1],\n                MID: [1, 0, 0],\n                PROPER: [1],\n                REPLACE: [1, 0, 0, 1],\n                REPT: [1, 0],\n                RIGHT: [1, 0],\n                SUBSTITUTE: [1, 1, 1, 0],\n                TRIM: [1],\n                HEXCODE: [1],\n                UPPER: [1]\n               };\n\nSocialCalc.Formula.StringFunctions = function(fname, operand, foperand, sheet) {\n\n   var i, value, offset, len, start, count;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var numargs = foperand.length;\n   var argdef = scf.ArgList[fname];\n   var operand_value = [];\n   var operand_type = [];\n\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\n      if (i > argdef.length) { // too many args\n         scf.FunctionArgsError(fname, operand);\n         return;\n         }\n      if (argdef[i-1] == 0) {\n         value = scf.OperandAsNumber(sheet, foperand);\n         }\n      else if (argdef[i-1] == 1) {\n         value = scf.OperandAsText(sheet, foperand);\n         }\n      else if (argdef[i-1] == -1) {\n         value = scf.OperandValueAndType(sheet, foperand);\n         }\n      operand_value[i] = value.value;\n      operand_type[i] = value.type;\n      if (value.type.charAt(0) == \"e\") {\n         scf.PushOperand(operand, value.type, result);\n         return;\n         }\n      }\n\n   switch (fname) {\n      case \"FIND\":\n         offset = operand_type[3] ? operand_value[3]-1 : 0;\n         if (offset < 0) {\n            result = \"Start is before string\"; // !! not displayed, no need to translate\n            }\n         else {\n            result = operand_value[2].indexOf(operand_value[1], offset); // (null string matches first char)\n            if (result >= 0) {\n               result += 1;\n               resulttype = \"n\";\n               }\n            else {\n               result = \"Not found\"; // !! not displayed, error is e#VALUE!\n               }\n            }\n         break;\n\n      case \"LEFT\":\n         len = operand_type[2] ? operand_value[2]-0 : 1;\n         if (len < 0) {\n            result = \"Negative length\";\n            }\n         else {\n            result = operand_value[1].substring(0, len);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"LEN\":\n         result = operand_value[1].length;\n         resulttype = \"n\";\n         break;\n\n      case \"LOWER\":\n         result = operand_value[1].toLowerCase();\n         resulttype = \"t\";\n         break;\n\n      case \"MID\":\n         start = operand_value[2]-0;\n         len = operand_value[3]-0;\n         if (len < 1 || start < 1) {\n            result = \"Bad arguments\";\n            }\n         else {\n            result = operand_value[1].substring(start-1, start+len-1);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"PROPER\":\n         result = operand_value[1].replace(/\\b\\w+\\b/g, function(word) {\n                     return word.substring(0,1).toUpperCase() + \n                        word.substring(1);\n                     }); // uppercase first character of words (see JavaScript, Flanagan, 5th edition, page 704)\n         resulttype = \"t\";\n         break;\n\n      case \"REPLACE\":\n         start = operand_value[2]-0;\n         len = operand_value[3]-0;\n         if (len < 0 || start < 1) {\n            result = \"Bad arguments\";\n            }\n         else {\n            result = operand_value[1].substring(0, start-1) + operand_value[4] + \n               operand_value[1].substring(start-1+len);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"REPT\":\n         count = operand_value[2]-0;\n         if (count < 0) {\n            result = \"Negative count\";\n            }\n         else {\n            result = \"\";\n            for (; count > 0; count--) {\n               result += operand_value[1];\n               }\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"RIGHT\":\n         len = operand_type[2] ? operand_value[2]-0 : 1;\n         if (len < 0) {\n            result = \"Negative length\";\n            }\n         else {\n            result = operand_value[1].slice(-len);\n            resulttype = \"t\";\n            }\n         break;\n\n      case \"SUBSTITUTE\":\n         fulltext = operand_value[1];\n         oldtext = operand_value[2];\n         newtext = operand_value[3];\n         if (operand_value[4] != null) {\n            which = operand_value[4]-0;\n            if (which <= 0) {\n               result = \"Non-positive instance number\";\n               break;\n               }\n            }\n         else {\n            which = 0;\n            }\n         count = 0;\n         oldpos = 0;\n         result = \"\";\n         while (true) {\n            pos = fulltext.indexOf(oldtext, oldpos);\n            if (pos >= 0) {\n               count++; //!!!!!! old test just in case: if (count>1000) {alert(pos); break;}\n               result += fulltext.substring(oldpos, pos);\n               if (which==0) {\n                  result += newtext; // substitute\n                  }\n               else if (which==count) {\n                  result += newtext + fulltext.substring(pos+oldtext.length);\n                  break;\n                  }\n               else {\n                  result += oldtext; // leave as was\n                  }\n               oldpos = pos + oldtext.length;\n               }\n            else { // no more\n               result += fulltext.substring(oldpos);\n               break;\n               }\n            }\n         resulttype = \"t\";\n         break;\n\n      case \"TRIM\":\n         result = operand_value[1];\n         result = result.replace(/^ */, \"\");\n         result = result.replace(/ *$/, \"\");\n         result = result.replace(/ +/g, \" \");\n         resulttype = \"t\";\n         break;\n\n      case \"HEXCODE\":\n         result = String(operand_value[1]);\n         var code = result.charCodeAt(0);\n         if (0xD800 <= code && code <= 0xDBFF) {\n             var next = result.charCodeAt(1);\n             if (0xDC00 <= next && next <= 0xDFFF) {\n                 code = ((code - 0xD800) * 0x400) + (next - 0xDC00) + 0x10000;\n             }\n         }\n         result = code.toString(16).toUpperCase();\n         resulttype = \"t\";\n         break;\n\n      case \"UPPER\":\n         result = operand_value[1].toUpperCase();\n         resulttype = \"t\";\n         break;\n\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"FIND\"] = [SocialCalc.Formula.StringFunctions, -2, \"find\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"LEFT\"] = [SocialCalc.Formula.StringFunctions, -2, \"tc\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"LEN\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"LOWER\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"MID\"] = [SocialCalc.Formula.StringFunctions, 3, \"mid\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"PROPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"REPLACE\"] = [SocialCalc.Formula.StringFunctions, 4, \"replace\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"REPT\"] = [SocialCalc.Formula.StringFunctions, 2, \"tc\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"RIGHT\"] = [SocialCalc.Formula.StringFunctions, -1, \"tc\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"SUBSTITUTE\"] = [SocialCalc.Formula.StringFunctions, -3, \"subs\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"TRIM\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"HEXCODE\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"UPPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\n\n/*\n#\n# is_functions:\n#\n# ISBLANK(value)\n# ISERR(value)\n# ISERROR(value)\n# ISLOGICAL(value)\n# ISNA(value)\n# ISNONTEXT(value)\n# ISNUMBER(value)\n# ISTEXT(value)\n#\n*/\n\nSocialCalc.Formula.IsFunctions = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"nl\";\n\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var t = value.type.charAt(0);\n\n   switch (fname) {\n\n      case \"ISBLANK\":\n         result = value.type == \"b\" ? 1 : 0;\n         break;\n\n      case \"ISERR\":\n         result = t == \"e\" ? (value.type == \"e#N/A\" ? 0 : 1) : 0;\n         break;\n\n      case \"ISERROR\":\n         result = t == \"e\" ? 1 : 0;\n         break;\n\n      case \"ISLOGICAL\":\n         result = value.type == \"nl\" ? 1 : 0;\n         break;\n\n      case \"ISNA\":\n         result = value.type == \"e#N/A\" ? 1 : 0;\n         break;\n\n      case \"ISNONTEXT\":\n         result = t == \"t\" ? 0 : 1;\n         break;\n\n      case \"ISNUMBER\":\n         result = t == \"n\" ? 1 : 0;\n         break;\n\n      case \"ISTEXT\":\n         result = t == \"t\" ? 1 : 0;\n         break;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"ISBLANK\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISERR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISERROR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISLOGICAL\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISNA\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISNONTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISNUMBER\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"ISTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\n\n/*\n#\n# ntv_functions:\n#\n# N(value)\n# T(value)\n# VALUE(value)\n#\n*/\n\nSocialCalc.Formula.NTVFunctions = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var t = value.type.charAt(0);\n\n   switch (fname) {\n\n      case \"N\":\n         result = t == \"n\" ? value.value-0 : 0;\n         resulttype = \"n\";\n         break;\n\n      case \"T\":\n         result = t == \"t\" ? value.value+\"\" : \"\";\n         resulttype = \"t\";\n         break;\n\n      case \"VALUE\":\n         if (t == \"n\" || t == \"b\") {\n            result = value.value || 0;\n            resulttype = \"n\";\n            }\n         else if (t == \"t\") {\n            value = SocialCalc.DetermineValueType(value.value);\n            if (value.type.charAt(0) != \"n\") {\n               result = 0;\n               resulttype = \"e#VALUE!\";\n               }\n            else {\n               result = value.value-0;\n               resulttype = \"n\";\n               }\n            }\n         break;\n      }\n\n   if (t == \"e\") { // error trumps\n      resulttype = value.type;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"N\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"T\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\nSocialCalc.Formula.FunctionList[\"VALUE\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\n\n/*\n#\n# ABS(value)\n# ACOS(value)\n# ASIN(value)\n# ATAN(value)\n# COS(value)\n# DEGREES(value)\n# EVEN(value)\n# EXP(value)\n# FACT(value)\n# INT(value)\n# LN(value)\n# LOG10(value)\n# ODD(value)\n# RADIANS(value)\n# SIN(value)\n# SQRT(value)\n# TAN(value)\n#\n*/\n\nSocialCalc.Formula.Math1Functions = function(fname, operand, foperand, sheet) {\n\n   var v1, value, f;\n   var result = {};\n\n   var scf = SocialCalc.Formula;\n\n   v1 = scf.OperandAsNumber(sheet, foperand);\n   value = v1.value;\n   result.type = scf.LookupResultType(v1.type, v1.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (result.type == \"n\") {\n      switch (fname) {\n         case \"ABS\":\n            value = Math.abs(value);\n            break;\n\n         case \"ACOS\":\n            if (value >= -1 && value <= 1) {\n               value = Math.acos(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"ASIN\":\n            if (value >= -1 && value <= 1) {\n               value = Math.asin(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"ATAN\":\n            value = Math.atan(value);\n            break;\n\n         case \"COS\":\n            value = Math.cos(value);\n            break;\n\n         case \"DEGREES\":\n            value = value * 180/Math.PI;\n            break;\n\n         case \"EVEN\":\n            value = value < 0 ? -value : value;\n            if (value != Math.floor(value)) {\n               value = Math.floor(value + 1) + (Math.floor(value + 1) % 2);\n               }\n            else { // integer\n               value = value + (value % 2);\n               }\n            if (v1.value < 0) value = -value;\n            break;\n\n         case \"EXP\":\n            value = Math.exp(value);\n            break;\n\n         case \"FACT\":\n            f = 1;\n            value = Math.floor(value);\n            for (;value>0;value--) {\n               f *= value;\n               }\n            value = f;\n            break;\n\n         case \"INT\":\n            value = Math.floor(value); // spreadsheet INT is floor(), not int()\n            break;\n\n         case \"LN\":\n            if (value <= 0) {\n               result.type = \"e#NUM!\";\n               result.error = SocialCalc.Constants.s_sheetfunclnarg;\n               }\n            value = Math.log(value);\n            break;\n\n         case \"LOG10\":\n            if (value <= 0) {\n               result.type = \"e#NUM!\";\n               result.error = SocialCalc.Constants.s_sheetfunclog10arg;\n               }\n            value = Math.log(value)/Math.log(10);\n            break;\n\n         case \"ODD\":\n            value = value < 0 ? -value : value;\n            if (value != Math.floor(value)) {\n               value = Math.floor(value + 1) + (1 - (Math.floor(value + 1) % 2));\n               }\n            else { // integer\n               value = value + (1 - (value % 2));\n               }\n            if (v1.value < 0) value = -value;\n            break;\n\n         case \"RADIANS\":\n            value = value * Math.PI/180;\n            break;\n\n         case \"SIN\":\n            value = Math.sin(value);\n            break;\n\n         case \"SQRT\":\n            if (value >= 0) {\n               value = Math.sqrt(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"TAN\":\n            if (Math.cos(value) != 0) {\n               value = Math.tan(value);\n               }\n            else {\n               result.type = \"e#NUM!\";\n               }\n            break;\n         }\n      }\n\n   result.value = value;\n   operand.push(result);\n\n   return null;\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"ABS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ACOS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ASIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ATAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"COS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"DEGREES\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"EVEN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"EXP\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"FACT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"INT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"LN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"LOG10\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"ODD\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"RADIANS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"SIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"SQRT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"TAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\n\n\n/*\n#\n# ATAN2(x, y)\n# MOD(a, b)\n# POWER(a, b)\n# TRUNC(value, precision)\n#\n*/\n\nSocialCalc.Formula.Math2Functions = function(fname, operand, foperand, sheet) {\n\n   var xval, yval, value, quotient, decimalscale, i;\n   var result = {};\n\n   var scf = SocialCalc.Formula;\n\n   xval = scf.OperandAsNumber(sheet, foperand);\n   yval = scf.OperandAsNumber(sheet, foperand);\n   value = 0;\n   result.type = scf.LookupResultType(xval.type, yval.type, scf.TypeLookupTable.twoargnumeric);\n\n   if (result.type == \"n\") {\n      switch (fname) {\n         case \"ATAN2\":\n            if (xval.value == 0 && yval.value == 0) {\n               result.type = \"e#DIV/0!\";\n               }\n            else {\n               result.value = Math.atan2(yval.value, xval.value);\n               }\n            break;\n\n         case \"POWER\":\n            result.value = Math.pow(xval.value, yval.value);\n            if (isNaN(result.value)) {\n               result.value = 0;\n               result.type = \"e#NUM!\";\n               }\n            break;\n\n         case \"MOD\": // en.wikipedia.org/wiki/Modulo_operation, etc.\n            if (yval.value == 0) {\n               result.type = \"e#DIV/0!\";\n               }\n            else {\n               quotient = xval.value/yval.value;\n               quotient = Math.floor(quotient);\n               result.value = xval.value - (quotient * yval.value);\n               }\n            break;\n\n         case \"TRUNC\":\n            decimalscale = 1; // cut down to required number of decimal digits\n            if (yval.value >= 0) {\n               yval.value = Math.floor(yval.value);\n               for (i=0; i<yval.value; i++) {\n                  decimalscale *= 10;\n                  }\n               result.value = Math.floor(Math.abs(xval.value) * decimalscale) / decimalscale;\n               }\n            else if (yval.value < 0) {\n               yval.value = Math.floor(-yval.value);\n               for (i=0; i<yval.value; i++) {\n                  decimalscale *= 10;\n                  }\n               result.value = Math.floor(Math.abs(xval.value) / decimalscale) * decimalscale;\n               }\n            if (xval.value < 0) {\n               result.value = -result.value;\n               }\n            }\n         }\n \n   operand.push(result);\n\n   return null;\n\n   }\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"ATAN2\"] = [SocialCalc.Formula.Math2Functions, 2, \"xy\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"MOD\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"POWER\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"TRUNC\"] = [SocialCalc.Formula.Math2Functions, 2, \"valpre\", \"\", \"math\"];\n\n/*\n#\n# LOG(value,[base])\n#\n*/\n\nSocialCalc.Formula.LogFunction = function(fname, operand, foperand, sheet) {\n\n   var value, value2;\n   var result = {};\n\n   var scf = SocialCalc.Formula;\n\n   result.value = 0;\n\n   value = scf.OperandAsNumber(sheet, foperand);\n   result.type = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\n   if (foperand.length == 1) {\n      value2 = scf.OperandAsNumber(sheet, foperand);\n      if (value2.type.charAt(0) != \"n\" || value2.value <= 0) {\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogsecondarg);\n         return 0;\n         }\n      }\n   else if (foperand.length != 0) {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   else {\n      value2 = {value: Math.E, type: \"n\"};\n      }\n\n   if (result.type == \"n\") {\n      if (value.value <= 0) {\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogfirstarg);\n         return 0;\n         }\n      result.value = Math.log(value.value)/Math.log(value2.value);\n      }\n\n   operand.push(result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"LOG\"] = [SocialCalc.Formula.LogFunction, -1, \"log\", \"\", \"math\"];\n\n\n/*\n#\n# ROUND(value,[precision])\n#\n*/\n\nSocialCalc.Formula.RoundFunction = function(fname, operand, foperand, sheet) {\n\n   var value2, decimalscale, scaledvalue, i;\n\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\n\n   if (foperand.length == 1) {\n      value2 = scf.OperandValueAndType(sheet, foperand);\n      if (value2.type.charAt(0) != \"n\") {\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncroundsecondarg);\n         return 0;\n         }\n      }\n   else if (foperand.length != 0) {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   else {\n      value2 = {value: 0, type: \"n\"}; // if no second arg, assume 0 for simple round\n      }\n\n   if (resulttype == \"n\") {\n      value2.value = value2.value-0;\n      if (value2.value == 0) {\n         result = Math.round(value.value);\n         }\n      else if (value2.value > 0) {\n         decimalscale = 1; // cut down to required number of decimal digits\n         value2.value = Math.floor(value2.value);\n         for (i=0; i<value2.value; i++) {\n            decimalscale *= 10;\n            }\n         scaledvalue = Math.round(value.value * decimalscale);\n         result = scaledvalue / decimalscale;\n         }\n      else if (value2.value < 0) {\n         decimalscale = 1; // cut down to required number of decimal digits\n         value2.value = Math.floor(-value2.value);\n         for (i=0; i<value2.value; i++) {\n            decimalscale *= 10;\n            }\n         scaledvalue = Math.round(value.value / decimalscale);\n         result = scaledvalue * decimalscale;\n         }\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"ROUND\"] = [SocialCalc.Formula.RoundFunction, -1, \"vp\", \"\", \"math\"];\n\n/*\n#\n# CEILING(value, [significance])\n# FLOOR(value, [significance])\n#\n*/\n\nSocialCalc.Formula.CeilingFloorFunctions = function(fname, operand, foperand, sheet) {\n\n   var scf = SocialCalc.Formula;\n   var val, sig, t;\n\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\n\n   val = scf.OperandValueAndType(sheet, foperand);\n   t = val.type.charAt(0);\n   if (t != \"n\") {\n      PushOperand(\"e#VALUE!\", 0);\n      return;\n      }\n   if (val.value == 0) {\n      PushOperand(\"n\", 0);\n      return;\n      }\n\n   if (foperand.length == 1) {\n      sig = scf.OperandValueAndType(sheet, foperand);\n      t = val.type.charAt(0);\n      if (t != \"n\") {\n         PushOperand(\"e#VALUE!\", 0);\n         return;\n         }\n      }\n   else if (foperand.length == 0) {\n      sig = {type: \"n\", value: val.value > 0 ? 1 : -1};\n      }\n   else {\n      PushOperand(\"e#VALUE!\", 0);\n      return;\n      }\n   if (sig.value == 0) {\n      PushOperand(\"n\", 0);\n      return;\n      }\n   if (sig.value * val.value < 0) {\n      PushOperand(\"e#NUM!\", 0);\n      return;\n      }\n\n   switch (fname) {\n      case \"CEILING\":\n         PushOperand(\"n\", Math.ceil(val.value / sig.value) * sig.value);\n         break;\n      case \"FLOOR\":\n         PushOperand(\"n\", Math.floor(val.value / sig.value) * sig.value);\n         break;\n      }\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"CEILING\"] = [SocialCalc.Formula.CeilingFloorFunctions, -1, \"vsig\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"FLOOR\"] = [SocialCalc.Formula.CeilingFloorFunctions, -1, \"vsig\", \"\", \"math\"];\n\n/*\n#\n# AND(v1,c1:c2,...)\n# OR(v1,c1:c2,...)\n#\n*/\n\nSocialCalc.Formula.AndOrFunctions = function(fname, operand, foperand, sheet) {\n\n   var value1, result;\n\n   var scf = SocialCalc.Formula;\n   var resulttype = \"\";\n\n   if (fname == \"AND\") {\n      result = 1;\n      }\n   else if (fname == \"OR\") {\n      result = 0;\n      }\n\n   while (foperand.length) {\n      value1 = scf.OperandValueAndType(sheet, foperand);\n      if (value1.type.charAt(0) == \"n\") {\n         value1.value = value1.value-0;\n         if (fname == \"AND\") {\n            result = value1.value != 0 ? result : 0;\n            }\n         else if (fname == \"OR\") {\n            result = value1.value != 0 ? 1 : result;\n            }\n         resulttype = scf.LookupResultType(value1.type, resulttype || \"nl\", scf.TypeLookupTable.propagateerror);\n         }\n      else if (value1.type.charAt(0) == \"e\" && resulttype.charAt(0) != \"e\") {\n         resulttype = value1.type;\n         }\n      }\n   if (resulttype.length < 1) {\n      resulttype = \"e#VALUE!\";\n      result = 0;\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"AND\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"OR\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\n\n/*\n#\n# NOT(value)\n#\n*/\n\nSocialCalc.Formula.NotFunction = function(fname, operand, foperand, sheet) {\n\n   var result = 0;\n   var scf = SocialCalc.Formula;\n   var value = scf.OperandValueAndType(sheet, foperand);\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.propagateerror);\n\n   if (value.type.charAt(0) == \"n\" || value.type == \"b\") {\n      result = value.value-0 != 0 ? 0 : 1; // do the \"not\" operation\n      resulttype = \"nl\";\n      }\n   else if (value.type.charAt(0) == \"t\") {\n      resulttype = \"e#VALUE!\";\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"NOT\"] = [SocialCalc.Formula.NotFunction, 1, \"v\", \"\", \"test\"];\n\n/*\n#\n# CHOOSE(index,value1,value2,...)\n#\n*/\n\nSocialCalc.Formula.ChooseFunction = function(fname, operand, foperand, sheet) {\n\n   var resulttype, count, value1;\n   var result = 0;\n   var scf = SocialCalc.Formula;\n\n   var cindex = scf.OperandAsNumber(sheet, foperand);\n\n   if (cindex.type.charAt(0) != \"n\") {\n      cindex.value = 0;\n      }\n   cindex.value = Math.floor(cindex.value);\n\n   count = 0;\n   while (foperand.length) {\n      value1 = scf.TopOfStackValueAndType(sheet, foperand);\n      count += 1;\n      if (cindex.value == count) {\n         result = value1.value;\n         resulttype = value1.type;\n         break;\n         }\n      }\n   if (resulttype) { // found something\n      scf.PushOperand(operand, resulttype, result);\n      }\n   else {\n      scf.PushOperand(operand, \"e#VALUE!\", 0);\n      }\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"CHOOSE\"] = [SocialCalc.Formula.ChooseFunction, -2, \"choose\", \"\", \"lookup\"];\n\n/*\n#\n# COLUMNS(c1:c2)\n# ROWS(c1:c2)\n#\n*/\n\nSocialCalc.Formula.ColumnsRowsFunctions = function(fname, operand, foperand, sheet) {\n\n   var resulttype, rangeinfo;\n   var result = 0;\n   var scf = SocialCalc.Formula;\n\n   var value1 = scf.TopOfStackValueAndType(sheet, foperand);\n\n   if (value1.type == \"coord\") {\n      result = 1;\n      resulttype = \"n\";\n      }\n\n   else if (value1.type == \"range\") {\n      rangeinfo = scf.DecodeRangeParts(sheet, value1.value);\n      if (fname == \"COLUMNS\") {\n         result = rangeinfo.ncols;\n         }\n      else if (fname == \"ROWS\") {\n         result = rangeinfo.nrows;\n         }\n      resulttype = \"n\";\n      }\n   else {\n      result = 0;\n      resulttype = \"e#VALUE!\";\n      }\n\n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"COLUMNS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\nSocialCalc.Formula.FunctionList[\"ROWS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\n\n\n/*\n#\n# FALSE()\n# NA()\n# NOW()\n# PI()\n# TODAY()\n# TRUE()\n#\n*/\n\nSocialCalc.Formula.ZeroArgFunctions = function(fname, operand, foperand, sheet) {\n\n   var startval, tzoffset, start_1_1_1970, seconds_in_a_day, nowdays;\n   var result = {value: 0};\n   \n   switch (fname) {\n      case \"FALSE\":\n         result.type = \"nl\";\n         result.value = 0;\n         break;\n\n      case \"NA\":\n         result.type = \"e#N/A\";\n         break;\n\n      case \"NOW\":\n         startval = new Date();\n         tzoffset = startval.getTimezoneOffset();\n         startval = startval.getTime() / 1000; // convert to seconds\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\n         seconds_in_a_day = 24 * 60 * 60;\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\n         result.value = nowdays;\n         result.type = \"ndt\";\n         SocialCalc.Formula.FreshnessInfo.volatile.NOW = true; // remember\n         break;\n\n      case \"PI\":\n         result.type = \"n\";\n         result.value = Math.PI;\n         break;\n\n      case \"TODAY\":\n         startval = new Date();\n         tzoffset = startval.getTimezoneOffset();\n         startval = startval.getTime() / 1000; // convert to seconds\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\n         seconds_in_a_day = 24 * 60 * 60;\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\n         result.value = Math.floor(nowdays);\n         result.type = \"nd\";\n         SocialCalc.Formula.FreshnessInfo.volatile.TODAY = true; // remember\n         break;\n\n      case \"TRUE\":\n         result.type = \"nl\";\n         result.value = 1;\n         break;\n\n      }\n\n   operand.push(result);\n\n   return null;\n\n}\n\n// Add to function list\nSocialCalc.Formula.FunctionList[\"FALSE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"NA\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\nSocialCalc.Formula.FunctionList[\"NOW\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"PI\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"math\"];\nSocialCalc.Formula.FunctionList[\"TODAY\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\nSocialCalc.Formula.FunctionList[\"TRUE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\n\n//\n// * * * * * FINANCIAL FUNCTIONS * * * * *\n//\n\n/*\n#\n# DDB(cost,salvage,lifetime,period,[method])\n#\n# Depreciation, method defaults to 2 for double-declining balance\n# See: http://en.wikipedia.org/wiki/Depreciation\n#\n*/\n\nSocialCalc.Formula.DDBFunction = function(fname, operand, foperand, sheet) {\n\n   var method, depreciation, accumulateddepreciation, i;\n   var scf = SocialCalc.Formula;\n\n   var cost = scf.OperandAsNumber(sheet, foperand);\n   var salvage = scf.OperandAsNumber(sheet, foperand);\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\n   var period = scf.OperandAsNumber(sheet, foperand);\n\n   if (scf.CheckForErrorValue(operand, cost)) return;\n   if (scf.CheckForErrorValue(operand, salvage)) return;\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\n   if (scf.CheckForErrorValue(operand, period)) return;\n\n   if (lifetime.value < 1) {\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncddblife);\n      return 0;\n      }\n\n   method = {value: 2, type: \"n\"};\n   if (foperand.length > 0 ) {\n      method = scf.OperandAsNumber(sheet, foperand);\n      }\n   if (foperand.length != 0) {\n      scf.FunctionArgsError(fname, operand);\n      return 0;\n      }\n   if (scf.CheckForErrorValue(operand, method)) return;\n\n   depreciation = 0; // calculated for each period\n   accumulateddepreciation = 0; // accumulated by adding each period's\n\n   for (i=1; i<=period.value-0 && i<=lifetime.value; i++) { // calculate for each period based on net from previous\n      depreciation = (cost.value - accumulateddepreciation) * (method.value / lifetime.value);\n      if (cost.value - accumulateddepreciation - depreciation < salvage.value) { // don't go lower than salvage value\n         depreciation = cost.value - accumulateddepreciation - salvage.value;\n         }\n      accumulateddepreciation += depreciation;\n      }\n\n   scf.PushOperand(operand, 'n$', depreciation);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"DDB\"] = [SocialCalc.Formula.DDBFunction, -4, \"ddb\", \"\", \"financial\"];\n\n/*\n#\n# SLN(cost,salvage,lifetime)\n#\n# Depreciation for each period by straight-line method\n# See: http://en.wikipedia.org/wiki/Depreciation\n#\n*/\n\nSocialCalc.Formula.SLNFunction = function(fname, operand, foperand, sheet) {\n\n   var depreciation;\n   var scf = SocialCalc.Formula;\n\n   var cost = scf.OperandAsNumber(sheet, foperand);\n   var salvage = scf.OperandAsNumber(sheet, foperand);\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\n\n   if (scf.CheckForErrorValue(operand, cost)) return;\n   if (scf.CheckForErrorValue(operand, salvage)) return;\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\n\n   if (lifetime.value < 1) {\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncslnlife);\n      return 0;\n      }\n\n   depreciation = (cost.value - salvage.value) / lifetime.value;\n\n   scf.PushOperand(operand, 'n$', depreciation);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"SLN\"] = [SocialCalc.Formula.SLNFunction, 3, \"csl\", \"\", \"financial\"];\n\n/*\n#\n# SYD(cost,salvage,lifetime,period)\n#\n# Depreciation by Sum of Year's Digits method\n#\n*/\n\nSocialCalc.Formula.SYDFunction = function(fname, operand, foperand, sheet) {\n\n   var depreciation, sumperiods;\n   var scf = SocialCalc.Formula;\n\n   var cost = scf.OperandAsNumber(sheet, foperand);\n   var salvage = scf.OperandAsNumber(sheet, foperand);\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\n   var period = scf.OperandAsNumber(sheet, foperand);\n\n   if (scf.CheckForErrorValue(operand, cost)) return;\n   if (scf.CheckForErrorValue(operand, salvage)) return;\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\n   if (scf.CheckForErrorValue(operand, period)) return;\n\n   if (lifetime.value < 1 || period.value <= 0) {\n      scf.PushOperand(operand, \"e#NUM!\", 0);\n      return 0;\n      }\n\n   sumperiods = ((lifetime.value + 1) * lifetime.value)/2; // add up 1 through lifetime\n   depreciation = (cost.value - salvage.value) * (lifetime.value - period.value + 1) / sumperiods; // calc depreciation\n\n   scf.PushOperand(operand, 'n$', depreciation);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"SYD\"] = [SocialCalc.Formula.SYDFunction, 4, \"cslp\", \"\", \"financial\"];\n\n/*\n#\n# FV(rate, n, payment, [pv, [paytype]])\n# NPER(rate, payment, pv, [fv, [paytype]])\n# PMT(rate, n, pv, [fv, [paytype]])\n# PV(rate, n, payment, [fv, [paytype]])\n# RATE(n, payment, pv, [fv, [paytype, [guess]]])\n#\n# Following the Open Document Format formula specification:\n#\n#    PV = - Fv - (Payment * Nper) [if rate equals 0]\n#    Pv*(1+Rate)^Nper + Payment * (1 + Rate*PaymentType) * ( (1+Rate)^nper -1)/Rate + Fv = 0\n#\n# For each function, the formulas are solved for the appropriate value (transformed using\n# basic algebra).\n#\n*/\n\nSocialCalc.Formula.InterestFunctions = function(fname, operand, foperand, sheet) {\n\n   var resulttype, result, dval, eval, fval;\n   var pv, fv, rate, n, payment, paytype, guess, part1, part2, part3, part4, part5;\n   var olddelta, maxloop, tries, deltaepsilon, rate, oldrate, m;\n\n   var scf = SocialCalc.Formula;\n\n   var aval = scf.OperandAsNumber(sheet, foperand);\n   var bval = scf.OperandAsNumber(sheet, foperand);\n   var cval = scf.OperandAsNumber(sheet, foperand);\n\n   resulttype = scf.LookupResultType(aval.type, bval.type, scf.TypeLookupTable.twoargnumeric);\n   resulttype = scf.LookupResultType(resulttype, cval.type, scf.TypeLookupTable.twoargnumeric);\n   if (foperand.length) { // optional arguments\n      dval = scf.OperandAsNumber(sheet, foperand);\n      resulttype = scf.LookupResultType(resulttype, dval.type, scf.TypeLookupTable.twoargnumeric);\n      if (foperand.length) { // optional arguments\n         eval = scf.OperandAsNumber(sheet, foperand);\n         resulttype = scf.LookupResultType(resulttype, eval.type, scf.TypeLookupTable.twoargnumeric);\n         if (foperand.length) { // optional arguments\n            if (fname != \"RATE\") { // only rate has 6 possible args\n               scf.FunctionArgsError(fname, operand);\n               return 0;\n               }\n            fval = scf.OperandAsNumber(sheet, foperand);\n            resulttype = scf.LookupResultType(resulttype, fval.type, scf.TypeLookupTable.twoargnumeric);\n            }\n         }\n      }\n\n   if (resulttype == \"n\") {\n      switch (fname) {\n         case \"FV\": // FV(rate, n, payment, [pv, [paytype]])\n            rate = aval.value;\n            n = bval.value;\n            payment = cval.value;\n            pv = dval!=null ? dval.value : 0; // get value if present, or use default\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\n            if (rate == 0) { // simple calculation if no interest\n               fv = -pv - (payment * n);\n               }\n            else {\n               fv = -(pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\n               }\n            result = fv;\n            resulttype = 'n$';\n            break;\n\n         case \"NPER\": // NPER(rate, payment, pv, [fv, [paytype]])\n            rate = aval.value;\n            payment = bval.value;\n            pv = cval.value;\n            fv = dval!=null ? dval.value : 0;\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\n            if (rate == 0) { // simple calculation if no interest\n               if (payment == 0) {\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\n                  return;\n                  }\n               n = (pv + fv)/(-payment);\n               }\n            else {\n               part1 = payment * (1 + rate * paytype) / rate;\n               part2 = pv + part1;\n               if (part2 == 0 || rate <= -1) {\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\n                  return;\n                  }\n               part3 = (part1 - fv) / part2;\n               if (part3 <= 0) {\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\n                  return;\n                  }\n               part4 = Math.log(part3);\n               part5 = Math.log(1 + rate); // rate > -1\n               n = part4/part5;\n               }\n            result = n;\n            resulttype = 'n';\n            break;\n\n         case \"PMT\": // PMT(rate, n, pv, [fv, [paytype]])\n            rate = aval.value;\n            n = bval.value;\n            pv = cval.value;\n            fv = dval!=null ? dval.value : 0;\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\n            if (n == 0) {\n               scf.PushOperand(operand, \"e#NUM!\", 0);\n               return;\n               }\n            else if (rate == 0) { // simple calculation if no interest\n               payment = (fv - pv)/n;\n               }\n            else {\n               payment = (0 - fv - pv*Math.pow(1+rate,n))/((1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\n               }\n            result = payment;\n            resulttype = 'n$';\n            break;\n\n         case \"PV\": // PV(rate, n, payment, [fv, [paytype]])\n            rate = aval.value;\n            n = bval.value;\n            payment = cval.value;\n            fv = dval!=null ? dval.value : 0;\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\n            if (rate == -1) {\n               scf.PushOperand(operand, \"e#DIV/0!\", 0);\n               return;\n               }\n            else if (rate == 0) { // simple calculation if no interest\n               pv = -fv - (payment * n);\n               }\n            else {\n               pv = (-fv - payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate)/(Math.pow(1+rate,n));\n               }\n            result = pv;\n            resulttype = 'n$';\n            break;\n\n            case \"RATE\": // RATE(n, payment, pv, [fv, [paytype, [guess]]])\n               n = aval.value;\n               payment = bval.value;\n               pv = cval.value;\n               fv = dval!=null ? dval.value : 0;\n               paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\n               guess = fval!=null ? fval.value : 0.1;\n\n               // rate is calculated by repeated approximations\n               // The deltas are used to calculate new guesses\n\n               maxloop = 100;\n               tries = 0;\n               delta = 1;\n               epsilon = 0.0000001; // this is close enough\n               rate = guess || 0.00000001; // zero is not allowed\n               while ((delta >= 0 ? delta : -delta) > epsilon && (rate != oldrate)) {\n                  delta = fv + pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate;\n                  if (olddelta!=null) {\n                     m = (delta - olddelta)/(rate - oldrate) || .001; // get slope (not zero)\n                     oldrate = rate;\n                     rate = rate - delta / m; // look for zero crossing\n                     olddelta = delta;\n                     }\n                  else { // first time - no old values\n                     oldrate = rate;\n                     rate = 1.1 * rate;\n                     olddelta = delta;\n                     }\n                  tries++;\n                  if (tries >= maxloop) { // didn't converge yet\n                     scf.PushOperand(operand, \"e#NUM!\", 0);\n                     return;\n                     }\n                  }\n               result = rate;\n               resulttype = 'n%';\n               break;\n         }\n      }\n \n   scf.PushOperand(operand, resulttype, result);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"FV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"fv\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"NPER\"] = [SocialCalc.Formula.InterestFunctions, -3, \"nper\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"PMT\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pmt\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"PV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pv\", \"\", \"financial\"];\nSocialCalc.Formula.FunctionList[\"RATE\"] = [SocialCalc.Formula.InterestFunctions, -3, \"rate\", \"\", \"financial\"];\n\n/*\n#\n# NPV(rate,v1,v2,c1:c2,...)\n#\n*/\n\nSocialCalc.Formula.NPVFunction = function(fname, operand, foperand, sheet) {\n\n   var resulttypenpv, rate, sum, factor, value1;\n\n   var scf = SocialCalc.Formula;\n\n   var rate = scf.OperandAsNumber(sheet, foperand);\n   if (scf.CheckForErrorValue(operand, rate)) return;\n\n   sum = 0;\n   resulttypenpv = \"n\";\n   factor = 1;\n\n   while (foperand.length) {\n      value1 = scf.OperandValueAndType(sheet, foperand);\n      if (value1.type.charAt(0) == \"n\") {\n         factor *= (1 + rate.value);\n         if (factor == 0) {\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\n            return;\n            }\n         sum += value1.value / factor;\n         resulttypenpv = scf.LookupResultType(value1.type, resulttypenpv || value1.type, scf.TypeLookupTable.plus);\n         }\n      else if (value1.type.charAt(0) == \"e\" && resulttypenpv.charAt(0) != \"e\") {\n         resulttypenpv = value1.type;\n         break;\n         }\n      }\n\n   if (resulttypenpv.charAt(0) == \"n\") {\n      resulttypenpv = 'n$';\n      }\n\n   scf.PushOperand(operand, resulttypenpv, sum);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"NPV\"] = [SocialCalc.Formula.NPVFunction, -2, \"npv\", \"\", \"financial\"];\n\n/*\n#\n# IRR(c1:c2,[guess])\n#\n*/\n\nSocialCalc.Formula.IRRFunction = function(fname, operand, foperand, sheet) {\n\n   var value1, guess, oldsum, maxloop, tries, epsilon, rate, oldrate, m, sum, factor, i;\n   var rangeoperand = [];\n   var cashflows = [];\n\n   var scf = SocialCalc.Formula;\n\n   rangeoperand.push(foperand.pop()); // first operand is a range\n\n   while (rangeoperand.length) { // get values from range so we can do iterative approximations\n      value1 = scf.OperandValueAndType(sheet, rangeoperand);\n      if (value1.type.charAt(0) == \"n\") {\n         cashflows.push(value1.value);\n         }\n      else if (value1.type.charAt(0) == \"e\") {\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\n         return;\n         }\n      }\n\n   if (!cashflows.length) {\n      scf.PushOperand(operand, \"e#NUM!\", 0);\n      return;\n      }\n\n   guess = {value: 0};\n\n   if (foperand.length) { // guess is provided\n      guess = scf.OperandAsNumber(sheet, foperand);\n      if (guess.type.charAt(0) != \"n\" && guess.type.charAt(0) != \"b\") {\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\n         return;\n         }\n      if (foperand.length) { // should be no more args\n         scf.FunctionArgsError(fname, operand);\n         return;\n         }\n      }\n\n   guess.value = guess.value || 0.1;\n\n   // rate is calculated by repeated approximations\n   // The deltas are used to calculate new guesses\n\n   maxloop = 20;\n   tries = 0;\n   epsilon = 0.0000001; // this is close enough\n   rate = guess.value;\n   sum = 1;\n\n   while ((sum >= 0 ? sum : -sum) > epsilon && (rate != oldrate)) {\n      sum = 0;\n      factor = 1;\n      for (i=0; i<cashflows.length; i++) {\n         factor *= (1 + rate);\n         if (factor == 0) {\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\n            return;\n            }\n         sum += cashflows[i] / factor;\n         }\n\n      if (oldsum!=null) {\n         m = (sum - oldsum)/(rate - oldrate); // get slope\n         oldrate = rate;\n         rate = rate - sum / m; // look for zero crossing\n         oldsum = sum;\n         }\n      else { // first time - no old values\n         oldrate = rate;\n         rate = 1.1 * rate;\n         oldsum = sum;\n         }\n      tries++;\n      if (tries >= maxloop) { // didn't converge yet\n         scf.PushOperand(operand, \"e#NUM!\", 0);\n         return;\n         }\n      }\n\n   scf.PushOperand(operand, 'n%', rate);\n\n   return;\n\n   }\n\nSocialCalc.Formula.FunctionList[\"IRR\"] = [SocialCalc.Formula.IRRFunction, -1, \"irr\", \"\", \"financial\"];\n\n\n\n// -----------------------------------------\n// eddy  BUTTON COPYVALUE COPYFORMULA {\n// -----------------------------------------\n\n/*\n#\n# BUTTON(string) // \n# TEXTBOX(string) // \n# CHECKBOX(string) // \n# COPYVALUE(range, value, destinationCell(s)) // \n# COPYFORMULA(range, formula(s), destinationCell(s)) // \n#\n*/\n\n\nSocialCalc.Formula.IoFunctions = function(fname, operand, foperand, sheet) {\n\n// ArgList has an array for each function, one entry for each possible arg (up to max).\n// Min args are specified in SocialCalc.Formula.FunctionList.\n//   -2 = one or more number argument\n//   -1 = any type\n//   0 = number\n//   1 = text argument\n//   2 = coord argument\n//   3 = value/single coord cell \n//   4 = text or cord \n\t\n// If array element is 1 then it's a text argument, if it's 0 then it's numeric, if -1 then just get whatever's there\n// Text values are manipulated as UTF-8, converting from and back to byte strings\n\n   var argList = {\n\t\t\t\t BUTTON: [1]\n   \t\t\t\t,EMAIL: [4, 4, 4, 4]\n\t\t\t\t,EMAILIF: [4, 4, 4, 4, 4]\n\t\t\t\t,EMAILONEDIT: [4, 4, 4, 4, 4]\n\t\t\t\t,EMAILAT: [4, 4, 4, 4, 4]\n\t\t\t\t,EMAILONEDITIF: [4, 4, 4, 4, 4, 4]\n\t\t\t\t,EMAILATIF: [4, 4, 4, 4, 4, 4]\n        ,SUBMIT: [1]\n\t\t\t\t,TEXTBOX: [1]\n\t\t\t\t,CHECKBOX: [-1]\n\t\t\t\t,COPYVALUE: [2, -1, 3]\n\t\t\t\t,COPYFORMULA: [2, -1,3]\n   };\n\n   var i, value, offset, len, start, count;\n   var scf = SocialCalc.Formula;\n   var result = 0;\n   var resulttype = \"e#VALUE!\";\n\n   var numargs = foperand.length;\n   var argdef = argList[fname];\n   var operand_value = [];\n   var operand_type = [];\n\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\n      if (i > argdef.length) { // too many args\n         scf.FunctionArgsError(fname, operand);\n         return;\n         }\n      if (argdef[i-1] == 0) {\n         value = scf.OperandAsNumber(sheet, foperand);\n         }\n      else if (argdef[i-1] == 1) {\n         value = scf.OperandAsText(sheet, foperand);\n         }\n      else if (argdef[i-1] == 2) {\n         value = scf.OperandAsCoord(sheet, foperand);\n\t\t value.value = value.value.replace(/\\$/g,'');\n         }\n      else if (argdef[i-1] == 3) {\n          value = scf.OperandValueAndType(sheet, foperand);\n          }\n      else if (argdef[i-1] == 4) {\n\t    \t  if(foperand[foperand.length -1].type == 'range') {\n\t    \t         value = scf.OperandAsRange(sheet, foperand);\n\t    \t\t\t value.value = value.value.replace(/\\$/g,'');    \t\t  \n\t    \t         // value.value = sheet.cells[value.value.split('|')[0]].datavalue\n\t    \t  } else {\n\t    \t         value = scf.OperandAsText(sheet, foperand);\n\t    \t  }\n          }\n      else if (argdef[i-1] == -1) {\n         value = scf.OperandValueAndType(sheet, foperand);\n         }\n      // value or range, e.g. \"C9|C11\"\n      operand_value[i] = value.value;\n      // type e.g. \"t\", \"range\"\n      operand_type[i] = value.type;\n      if (value.type.charAt(0) == \"e\") {\n         scf.PushOperand(operand, value.type, result);\n         return;\n         }\n      }\n\n\n   switch (fname) {\n     case \"SUBMIT\":\n         result = \"Submit\";\n     case \"BUTTON\":\n     case \"TEXTBOX\":\n         if (numargs>0) result = operand_value[1];\n         resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (BUTTON,TEXTBOX,) \n         break;\n\n      case \"EMAIL\":\n      case \"EMAILIF\":\n          resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (BUTTON,TEXTBOX,) \n          result = \"Send\";\n          break;\n      case \"EMAILONEDIT\":\n      case \"EMAILONEDITIF\":\n//    \t  sheet.editEventCells === 'undefined') return;\t\n//    \t  if(typeof sheet.ioParameterList === 'undefined') return;\n\n    \t  \n      case \"EMAILAT\":\n      case \"EMAILATIF\":\n          resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (BUTTON,TEXTBOX,) \n          result = \"Send Now\";\n          break;\n\t\t \n      case \"CHECKBOX\":\n\t     if(operand_type[1].charAt(0) == 't') {\n\t\t\tresult = (operand_value[1].toUpperCase() == 'TRUE') ? 1 : 0;\n\t\t\t} else {\n\t\t\tresult = (operand_value[1] == 0) ? 0 : 1;\n\t\t\t}\n\t\t//result = \"true\"; \n         resulttype = \"ni\"+fname; // (n)umber value with (i)nterface (CHECKBOX) \n\n         break;\n\t\t \n\t\t \n      case \"COPYVALUE\":\n         result = sheet.cells[operand_value[1]].datavalue;\n         resulttype = \"t\";\n         break;\n\n      case \"COPYFORMULA\":\n         result = sheet.cells[operand_value[1]].datavalue;\n         resulttype = \"t\";\n         break;\n\n\t\t \n      }\n\n   scf.PushOperand(operand, resulttype, result);\n   return;\n\n   }\n\n//*********************\n//\n// Docs see - Function Handling - ~line 1560\n// \n//*********************\n\n\n\nSocialCalc.Formula.FunctionList[\"BUTTON\"] = [SocialCalc.Formula.IoFunctions, 1, \"label\", \"\", \"gui\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\\\"><%=formated_value%></button>\" ];\nSocialCalc.Formula.FunctionList[\"EMAIL\"] = [SocialCalc.Formula.IoFunctions, -3, \"to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\nSocialCalc.Formula.FunctionList[\"EMAILIF\"] = [SocialCalc.Formula.IoFunctions, -4, \"condition_range, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\nSocialCalc.Formula.FunctionList[\"EMAILONEDIT\"] = [SocialCalc.Formula.IoFunctions, -4, \"editRange, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"EventTree\"];\nSocialCalc.Formula.FunctionList[\"EMAILAT\"] = [SocialCalc.Formula.IoFunctions, -4, \"datetime_value, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"TimeTrigger\" ];\nSocialCalc.Formula.FunctionList[\"EMAILONEDITIF\"] = [SocialCalc.Formula.IoFunctions, -5, \"editRange, condition, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"EventTree\" ];\nSocialCalc.Formula.FunctionList[\"EMAILATIF\"] = [SocialCalc.Formula.IoFunctions, -5, \"datetime_value, condition, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"TimeTrigger\" ];\nSocialCalc.Formula.FunctionList[\"SUBMIT\"] = [SocialCalc.Formula.IoFunctions, 100, \"[label]\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\nSocialCalc.Formula.FunctionList[\"TEXTBOX\"] = [SocialCalc.Formula.IoFunctions, 1, \"value\", \"\", \"gui\", \"<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\\\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\\\" value='<%=display_value%>' >\", \"Input\" ];\nSocialCalc.Formula.FunctionList[\"CHECKBOX\"] = [SocialCalc.Formula.IoFunctions, 1, \"value\", \"\", \"gui\", \"<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\\\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\\\" >\", \"Input\" ];\n\nSocialCalc.Formula.FunctionList[\"COPYVALUE\"] = [SocialCalc.Formula.IoFunctions, 3, \"trigger_cell, value_range, destinationCell(s)\", \"\", \"action\", \"\", \"EventTree\"];\nSocialCalc.Formula.FunctionList[\"COPYFORMULA\"] = [SocialCalc.Formula.IoFunctions, 3, \"trigger_cell, formula_range, destinationCell(s)\", \"\", \"action\", \"\", \"EventTree\"];\n  \n// Event triggered, e.g. button clicked. - call linked action formulas \n// eddy TriggerIoAction {\nSocialCalc.TriggerIoAction.Button = function(triggerCellId) {\n var spreadsheet =  window.spreadsheet;\n var sheet = spreadsheet.sheet;\n //spreadsheet.editor.EditorScheduleSheetCommands('set A2 value n 10',  true, false);\n \n //spreadsheet.editor.EditorScheduleSheetCommands('sendemail to eddy.nihon',  false, false); \n \n if(typeof sheet.ioEventTree === 'undefined') return;\t\n if(typeof sheet.ioParameterList === 'undefined') return;\n if( sheet.ioEventTree[triggerCellId] === 'undefined' ) return;\n \n for(var actionCellId in sheet.ioEventTree[triggerCellId]) {\n \n\tvar parameters = sheet.ioParameterList[actionCellId];\n\t\n\tswitch(parameters.function_name) {\n\n    /*\n     * set B8 text t william              ... coord: \"B8\",  datavalue: \"william\",     datatype: \"t\", formula: \"\",          valuetype: \"t\"\n     * set B10 constant nd 41307 2013/2/2 ... coord: \"B10\", datavalue: 41307,         datatype: \"c\", formula: \"2013/2/2\",  valuetype: \"nd\"\n     * set B11 value n 1                  ... coord: \"B11\", datavalue: 1,             datatype: \"v\", formula: \"\",          valuetype: \"n\"\n     *\n     * set B7 formula \"test\"&B3   ... coord: \"B7\",  datavalue: \"testwilliam\", datatype: \"f\", formula: \"\"test\"&B3\", valuetype: \"t\"\n     * set C8 formula B8       ... coord: \"C8\",  datavalue: \"william\",     datatype: \"f\", formula: \"B8\",        valuetype: \"t\"\n     * set C10 formula B10     ... coord: \"C10\", datavalue: 41307,         datatype: \"f\", formula: \"B10\",       valuetype: \"nd\"\n     * set C11 formula B11     ... coord: \"C11\", datavalue: 1,             datatype: \"f\", formula: \"B11\",       valuetype: \"n\"\n     *  set B3  formula TEXTBOX(\"\")             ... coord: \"B3\", datavalue: \"william\", datatype: \"f\", formula: \"TEXTBOX(\"william\")\", valuetype: \"tiTEXTBOX\"\n     */\n\t  \n\t  case \"COPYVALUE\" :\n\t    //\n\t    // e.g. set D3 text t push me \n\t    // e.g. set D3 value v 10\t\t\n\t\t//      set D5 constant n% 0.1 10%\n\t\t//      set D6 constant nd 41922 10/10/2014\n    \tvar cell = sheet.cells[SocialCalc.Formula.PlainCoord(parameters[1].value)];\t\t\n\t\t  var sheetCommand; \n    \tif (typeof cell !== 'undefined' && cell.valuetype != 'b') { // if not blank get cell data\n    \t\tvar cellDataType = cell.datatype;\n    \t\tvar cellValueType = cell.valuetype; \t\t\n    \t\tvar cellDataValue = cell.datavalue;\t\t\n    \t\tvar cellFormula = cell.formula;\n    \t\t\n    \t\tif(cellDataType == 'f') {\n          cellFormula = \"\";\n    \t\t  cellDataType = cellValueType;\n    \t\t  if(cellValueType == \"nd\") {\n    \t\t    cellDataType = \"c\"; // for Date type etc \n    \t\t    cellFormula = cell.displaystring;\n    \t\t  }\n    \t\t  if(cellValueType.charAt(0) == \"t\") cellDataType = \"t\";    \t\t  \n    \t\t}\n    \t\tsheetCommand = 'set '+parameters[2].value+ ' ' + SocialCalc.Constants.cellDataType[cellDataType] + ' ' +cellValueType + ' '+ SocialCalc.encodeForSave(cellDataValue) + ' ' + SocialCalc.encodeForSave(cellFormula);\n    \t\t\n    \t} else { \n\t\t\tsheetCommand = 'set '+parameters[2].value+ ' empty';    \t\t\n    \t}\n\t    spreadsheet.editor.EditorScheduleSheetCommands(sheetCommand.trim(),  true, false);\n\t    break;\n\t  case \"COPYFORMULA\" : \n      var cell = sheet.cells[SocialCalc.Formula.PlainCoord(parameters[1].value)];   \n      var sheetCommand; \n      if (typeof cell !== 'undefined' && cell.valuetype != 'b') { // if not blank get cell data\n        var cellDataType = cell.datatype;\n        var cellValueType = cell.valuetype;     \n        var cellDataValue = cell.datavalue;   \n        var cellFormula = cell.formula;\n        \n        if(cellDataType == 'f') {\n          sourceCell = SocialCalc.coordToCr(parameters[1].value);\n          destinationCell = SocialCalc.coordToCr(parameters[2].value);\n          cellFormula = SocialCalc.OffsetFormulaCoords(cellFormula, destinationCell.col -  sourceCell.col, destinationCell.row -  sourceCell.row);\n          cellDataValue = \"\";\n          cellValueType = \"\";  \n        }\n        sheetCommand = 'set '+parameters[2].value+ ' ' + SocialCalc.Constants.cellDataType[cellDataType] + ' ' +cellValueType + ' '+ SocialCalc.encodeForSave(cellDataValue) + ' ' + SocialCalc.encodeForSave(cellFormula);\n        \n      } else { \n      sheetCommand = 'set '+parameters[2].value+ ' empty';        \n      }\n      spreadsheet.editor.EditorScheduleSheetCommands(sheetCommand.trim(),  true, false);\n      break;\n\t\tbreak;\n      }\n\n } \n\n}\n\n// optionalTriggerCellId - edited cell - used by EMAILONEDIT and EMAILONEDITIF\n//onClick=EMAIL \nSocialCalc.TriggerIoAction.Email = function(emailFormulaCellId, optionalTriggerCellId) {\n     optionalTriggerCellId = typeof optionalTriggerCellId !== 'undefined' ? optionalTriggerCellId : null;\n\t var scf = SocialCalc.Formula;\t\n\t var spreadsheet =  window.spreadsheet;\n\t if (spreadsheet == null) spreadsheet = window.ss\n\n\t var sheet = spreadsheet.sheet;\n\t var cell = sheet.cells[emailFormulaCellId];\n\t \n\t if(typeof sheet.ioParameterList === 'undefined') return;\n\t \n\t var parameters = sheet.ioParameterList[emailFormulaCellId];\n   if(typeof parameters === 'undefined') return;\n   //var debugLog = \"debug TriggerIoAction.Email\\n\"; //eddy\n\n\t //spreadsheet.editor.EditorScheduleSheetCommands('sendemail to eddy.nihon',  false, false); \n\t // grab array for TO, SUBJECT and BODY \n\t var parameterValues = [];\n\t var parameterCellRefs = []; // OnEdit uses to workout what row/col was edited\n\t var maxRangeSize = 1;\n\t for(var index=0; index < parameters.length; index ++) {\n\t\t if(parameters[index].type.charAt(0) == 't') {\n\t\t\t parameterValues[index] = [String(parameters[index].value).replace(/ /g, \"%20\")];\n\t\t }\n\t\t if(parameters[index].type == 'coord') {\n\t\t\t parameterValues[index] = [String(sheet.GetAssuredCell(parameters[index].value).datavalue).replace(/ /g, \"%20\")];\n\n\t\t }\n\t\t if(parameters[index].type == 'range') {\n\t\t      var rangeinfo = scf.DecodeRangeParts(sheet, parameters[index].value);\n\t\t      parameterValues[index] = [];\n\t\t      parameterCellRefs[index] = [];\n\t\t      var rangeSizeCounter = 0;\n\t\t      for (var i=0; i<rangeinfo.ncols; i++) {\n\t\t         for (var j=0; j<rangeinfo.nrows; j++) {\n\n\t\t            var cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\n\t\t            var cell = rangeinfo.sheetdata.GetAssuredCell(cellcr);\n\t\t            parameterValues[index].push(cell.datavalue.toString().replace(/ /g, \"%20\"));\n\t\t            parameterCellRefs[index].push(cellcr);\n\t\t            rangeSizeCounter++;\n\t\t         }\n\t\t      }\n\t\t      if(rangeSizeCounter > maxRangeSize) maxRangeSize = rangeSizeCounter;\t\t\t \n\t\t }\n\t }\n\n\t \n    var conditionIndex = -1; // check if email formula is conditional, -1 = not conditional \n    var toAddressParamOffset = 0;\n    switch (parameters.function_name) {\n\n      case \"EMAILIF\":\n    \t  conditionIndex = 0;\n      case \"EMAILAT\":\n      case \"EMAILONEDIT\":\n    \t  toAddressParamOffset = 1;\n    \t  break;\n      case \"EMAILONEDITIF\":\n      case \"EMAILATIF\":\n       \t  conditionIndex = 1;\n    \t  toAddressParamOffset = 2;\n    \t  break;\n    \t  \n      case \"EMAIL\":\n    \t  break;\n    }\t \n\n    \n    switch (parameters.function_name) {\n        case \"EMAILONEDIT\":\n        case \"EMAILONEDITIF\":\n\t       if(optionalTriggerCellId && parameters[0].type == 'coord' && parameters[0].value == optionalTriggerCellId ) optionalTriggerCellId = null;\n\t       break;\n\t   default :\n\t\t   optionalTriggerCellId = null;\n    }\n\n     var setStatusBarMessage = false;\n\n   var emailContentsList = [];\n\n\t for(var rangeIndex = maxRangeSize -1; rangeIndex > -1; rangeIndex-- ) {\n\t\t \n\t\t // if email formula is conditional && condition is false then skip \n\t\t if(conditionIndex != -1) {\n\t\t\t var conditionRangeIndex = (rangeIndex >= parameterValues[conditionIndex].length) ? 0 : rangeIndex;\n\t\t\t if(parameterValues[conditionIndex][conditionRangeIndex] == false) continue;\t\t\t \n\t\t }\n\n\t\t if(optionalTriggerCellId && optionalTriggerCellId != parameterCellRefs[0][rangeIndex]) continue;\n\t\t // send: to, subject, body to server \t\t \n\t\t var toaddressRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset].length) ? 0 : rangeIndex;\n\t\t var subjectsRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset+1].length) ? 0 : rangeIndex;\n\t\t var bodyRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset+2].length) ? 0 : rangeIndex;\n\t\t \n\t\t var emailContents = parameterValues[toAddressParamOffset][toaddressRangeIndex]+' '+parameterValues[toAddressParamOffset+1][subjectsRangeIndex]+' '+parameterValues[toAddressParamOffset+2][bodyRangeIndex];\n\t\t setStatusBarMessage = true;\n\t\t sheet.ScheduleSheetCommands('sendemail '+emailContents,  false); \n\t\t // cron job email - ignores ScheduleSheetCommands so send via return value\n\t\t emailContentsList.push([parameterValues[toAddressParamOffset][toaddressRangeIndex], parameterValues[toAddressParamOffset+1][subjectsRangeIndex], parameterValues[toAddressParamOffset+2][bodyRangeIndex]]);\n\t\t //debugLog = debugLog + \"emailContents \"+emailContents+\"\\n\"; //eddy\n\t\t \n\t }\n\t //console.log( \"log formula1.js Email\");\n\t // update status bar to indicate email is being sent\n\t if(setStatusBarMessage) SocialCalc.EditorSheetStatusCallback(null, \"emailing\", null, spreadsheet.editor);\t \n   return emailContentsList; // cron job email\n\n}\n\n/*\n * creates command on form: submitform \\rtimestamp\\rB2value\\rC2value ...\n */\n\nSocialCalc.TriggerIoAction.Submit = function(triggerCellId) {\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \n  ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \n  : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\n\n  if(formDataViewer != null && formDataViewer.loaded == true) {\n\n    var spreadsheet =  window.spreadsheet;\n    var sheet = spreadsheet.sheet;\n    \n    \n    var date = new Date();\n    var formDataValues = \"\"+date.getFullYear()  + \"-\" + (date.getMonth() +1 )    + \"-\" +  date.getDate() \n       + \" \" +  date.getHours()     + \":\" +  date.getMinutes()     + \":\" +  date.getSeconds();\n    \n    for(var colIndex = 2; colIndex <= formDataViewer.formFieldsLength +1 ; colIndex++) {\n      var valueCoord = SocialCalc.crToCoord(colIndex, 2);\n      formDataValues += \"\\r\" + formDataViewer.sheet.cells[valueCoord].datavalue;\n    }  \n    \n    sheet.ScheduleSheetCommands('submitform \\r'+formDataValues,  false);\n  }\n}\n\n// onKeyUp=TextBox \nSocialCalc.TriggerIoAction.TextBox = function(textBoxCellId) {\n  var getHTMLTextBoxCellValue = function( textBoxWidget ) { return textBoxWidget.value; };\n  var function_name = \"TEXTBOX\";\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, textBoxCellId, getHTMLTextBoxCellValue );\n}\n\n//onKeyUp=CheckBox \nSocialCalc.TriggerIoAction.CheckBox = function(checkBoxCellId) {\n  var getHTMLCheckBoxCellValue = function( checkBoxWidget ) { return (checkBoxWidget.checked ? \"TRUE\" : \"FALSE\") };\n  var function_name = \"CHECKBOX\"\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, checkBoxCellId, getHTMLCheckBoxCellValue );\n}\n\nSocialCalc.TriggerIoAction.updateInputWidgetFormula = function(function_name, widgetCellId, getHTMLWidgetCellValue ) {\n\n var spreadsheet =  window.spreadsheet;\n var sheet = spreadsheet.sheet;\n var cell = sheet.cells[widgetCellId];\n \n var cell_textbox=document.getElementById(function_name+'_'+widgetCellId);\n var inputValue = getHTMLWidgetCellValue(cell_textbox);\n inputValue = SocialCalc.encodeForSave(inputValue);\n\n var sheetCommand = 'set '+cell.coord+ ' formula ' + function_name+'(\"' +inputValue+'\")'\n //SocialCalc.CmdGotFocus(cell_textbox);\n\n spreadsheet.editor.EditorScheduleSheetCommands(sheetCommand,  true, false);\n \n SocialCalc.TriggerIoAction.UpdateFormDataSheet(function_name, cell.coord, inputValue);\n}\n\n// On edit of Form Input widget - Update form data sheet \nSocialCalc.TriggerIoAction.UpdateFormDataSheet = function(function_name, formCellId, inputValue) {\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \n       ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \n       : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer; \n  if (formDataViewer == null) return;\n\n  var formFieldName = (function_name+formCellId).toLowerCase();\n  if(formDataViewer.formFields[formFieldName] != null) {       \n    var valueCoord = SocialCalc.crToCoord(formDataViewer.formFields[formFieldName], 2);\n    formDataViewer.sheet.ScheduleSheetCommands(\"set \"+valueCoord+\" text t \"+inputValue, false);    \n  }\n}\n\n\n// -----------------------------------------\n// }\n// -----------------------------------------\n\n\n\n\n//\n// SHEET CACHE\n//\n\nSocialCalc.Formula.SheetCache = {\n\n   // Sheet data: Attributes are each sheet in the cache with values of an object with:\n   //\n   //    sheet: sheet-obj (or null, meaning not found)\n   //    recalcstate: constants.asloaded = as loaded\n   //                 constants.recalcing = being recalced now\n   //                 constants.recalcdone = recalc done\n   //    name: name of sheet (in case just have object and don't know name)\n   //\n\n   sheets: {},\n\n   // Waiting for loading:\n   // If sheet is not in cache, this is set to the sheetname being loaded\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\n   // Reset to null before restarting.\n\n   waitingForLoading: null,\n\n   // Constants to use for setting sheets[*].recalcstate:\n\n   constants: {asloaded: 0, recalcing: 1, recalcdone: 2},\n\n   loadsheet: null // (deprecated - use SocialCalc.RecalcInfo.LoadSheet)\n\n   };\n\n//\n// othersheet = SocialCalc.Formula.FindInSheetCache(sheetname)\n//\n// Returns a SocialCalc.Sheet object corresponding to string sheetname\n// or null if the sheet is not available or in error.\n//\n// Each sheet is loaded only once and then stored in a cache.\n// Loading is handled elsewhere, e.g., in the recalc loop.\n//\n\nSocialCalc.Formula.FindInSheetCache = function(sheetname) {\n\n   var str;\n   var sfsc = SocialCalc.Formula.SheetCache;\n\n   var nsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname); // normalize different versions\n\n   if (sfsc.sheets[nsheetname]) { // a sheet by that name is in the cache already\n      return sfsc.sheets[nsheetname].sheet; // return it\n      }\n\n   if (sfsc.waitingForLoading) { // waiting already - only queue up one\n      return null; // return not found\n      }\n\n   if (sfsc.loadsheet) { // Deprecated old format synchronous callback\nalert(\"Using SocialCalc.Formula.SheetCache.loadsheet - deprecated\");\n      return SocialCalc.Formula.AddSheetToCache(nsheetname, sfsc.loadsheet(nsheetname));\n      }\n\n   sfsc.waitingForLoading = nsheetname; // let recalc loop know that we have a sheet to load\n\n   return null; // return not found\n\n   }\n\n//\n// newsheet = SocialCalc.Formula.AddSheetToCache(sheetname, str, live)\n//\n// Adds a new sheet to the sheet cache.\n// Returns the sheet object filled out with the str (a saved sheet).\n//\n\nSocialCalc.Formula.AddSheetToCache = function(sheetname, str, live) {\n\n   var newsheet = null;\n   var sfsc = SocialCalc.Formula.SheetCache;\n   var sfscc = sfsc.constants;\n   var newsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname);\n\n   if (str) {\n      newsheet = new SocialCalc.Sheet();\n      newsheet.ParseSheetSave(str);\n      }\n\n   sfsc.sheets[newsheetname] = {sheet: newsheet, recalcstate: sfscc.asloaded, name: newsheetname};\n\n   SocialCalc.Formula.FreshnessInfo.sheets[newsheetname] = (typeof(live) == \"undefined\" || live === false);\n\n   return newsheet;\n\n   }\n\n//\n// nsheet = SocialCalc.Formula.NormalizeSheetName(sheetname)\n//\n\nSocialCalc.Formula.NormalizeSheetName = function(sheetname) {\n\n   if (SocialCalc.Callbacks.NormalizeSheetName) {\n      return SocialCalc.Callbacks.NormalizeSheetName(sheetname);\n      }\n   else {\n      return sheetname.toLowerCase();\n      }\n   }\n\n//\n// REMOTE FUNCTION INFO\n//\n\nSocialCalc.Formula.RemoteFunctionInfo = {\n\n   // Waiting for server:\n   // If waiting for an XHR response from the server, this is set to some non-blank status text\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\n   // Reset to null before restarting.\n\n   waitingForServer: null\n\n   };\n\n//\n// FRESHNESS INFO\n//\n// This information is generated during recalc.\n// It may be used to help determine when the recalc data in a spreadsheet\n// may be out of date.\n// For example, it may be used to display a message like:\n// \"Dependent on sheet 'FOO' which was updated more recently than this printout\"\n\nSocialCalc.Formula.FreshnessInfo = {\n\n   // For each external sheet referenced successfully an attribute of that name with value true to keep the sheet cached.\n   // Value false means the sheet is reloaded at each recalc.\n\n   sheets: {},\n\n   // For each volatile function that is called an attribute of that name with value true.\n\n   volatile: {},\n\n   // Set to false when started and true when recalc completes\n\n   recalc_completed: false\n\n   };\n\nSocialCalc.Formula.FreshnessInfoReset = function() {\n\n   var scffi = SocialCalc.Formula.FreshnessInfo;\n   var scfsc = SocialCalc.Formula.SheetCache;\n\n   // Loop through sheets freshness, deleting cached sheets that should be reloaded.\n\n   for (var sheet in scffi.sheets) {\n      if (scffi.sheets[sheet] === false) {\n         delete scfsc.sheets[sheet];\n         }\n      }\n   \n   // Reset freshness info.\n\n   scffi.sheets = {};\n   scffi.volatile = {};\n   scffi.recalc_completed = false;\n\n   }\n\n//\n// MISC ROUTINES\n//\n\n//\n// result = SocialCalc.Formula.PlainCoord(coord)\n//\n// Returns: coord without any $'s\n//\n\nSocialCalc.Formula.PlainCoord = function(coord) {\n\n   if (coord.indexOf(\"$\") == -1) return coord;\n\n   return coord.replace(/\\$/g, \"\"); // remove any $'s\n\n   }\n\n//\n// result = SocialCalc.Formula.OrderRangeParts(coord1, coord2)\n//\n// Returns: {c1: col, r1: row, c2: col, r2 = row} with c1/r1 upper left\n//\n\nSocialCalc.Formula.OrderRangeParts = function(coord1, coord2) {\n\n   var cr1, cr2;\n   var result = {};\n\n   cr1 = SocialCalc.coordToCr(coord1);\n   cr2 = SocialCalc.coordToCr(coord2);\n   if (cr1.col > cr2.col) { result.c1 = cr2.col; result.c2 = cr1.col; }\n   else { result.c1 = cr1.col; result.c2 = cr2.col; }\n   if (cr1.row > cr2.row) { result.r1 = cr2.row; result.r2 = cr1.row; }\n   else { result.r1 = cr1.row; result.r2 = cr2.row; }\n\n   return result;\n\n   }\n\n//\n// cond = SocialCalc.Formula.TestCriteria(value, type, criteria)\n//\n// Determines whether a value/type meets the criteria.\n// A criteria can be a numeric value, text beginning with <, <=, =, >=, >, <>, text by itself is start of text to match.\n// Used by a variety of functions, including the \"D\" functions (DSUM, etc.).\n//\n// Returns true or false\n//\n\nSocialCalc.Formula.TestCriteria = function(value, type, criteria) {\n\n   var comparitor, basestring, basevalue, cond, testvalue;\n\n   if (criteria == null) { // undefined (e.g., error value) is always false\n      return false;\n      }\n\n   criteria = criteria + \"\";\n   comparitor = criteria.charAt(0); // look for comparitor\n   if (comparitor == \"=\" || comparitor == \"<\" || comparitor == \">\") {\n      basestring = criteria.substring(1);\n      }\n   else {\n      // check for '*' or '?' in search string - wildcard\n      if (criteria.search(/([^~]\\*|^\\*)/) != -1 || criteria.search(/([^~]\\?|^\\?)/) != -1) {\n         comparitor = \"regex\";\n         if (criteria == \"*\") {\n            // \"*\" means cell contains 'anything'\n            basestring = \".+\";\n         } else {\n             // convert Excel syntax to regex syntax. * -> .*    ? -> .?    ~* -> \\*    ~? -> \\?\n             // there are no negative lookbehinds in Javascript. Reverse the string and do negative lookaheads on ~? and ~*\n             basestring = criteria.split(\"\").reverse().join(\"\");\n             basestring = basestring.replace(/\\?(?=[^~])|\\?$/g, \"?.\").replace(/\\?~/g, \"?\\\\\").replace(/\\*(?=[^~])|\\*$/g, \"*.\").replace(/\\*~/, \"*\\\\\");\n             basestring = basestring.split(\"\").reverse().join(\"\");\n         }\n         basestring = \"^\" + basestring + \"$\";\n      } else {\n          comparitor = criteria.substring(0,2);\n          if (comparitor == \"<=\" || comparitor == \"<>\" || comparitor == \">=\") {\n             basestring = criteria.substring(2);\n          } else {\n             comparitor = \"none\";\n             basestring = criteria;\n          }\n      }\n   }\n\n   basevalue = SocialCalc.DetermineValueType(basestring); // get type of value being compared\n   if (!basevalue.type) { // no criteria base value given\n      if (comparitor == \"none\") { // blank criteria matches nothing\n         return false;\n         }\n      if (type.charAt(0) == \"b\") { // comparing to empty cell\n         if (comparitor == \"=\") { // empty equals empty\n            return true;\n            }\n         }\n      else {\n         if (comparitor == \"<>\") { // \"something\" does not equal empty\n            return true;\n            }\n         }\n      return false; // otherwise false\n      }\n\n   cond = false;\n\n   if (basevalue.type.charAt(0) == \"n\" && type.charAt(0) == \"t\") { // criteria is number, but value is text\n      testvalue = SocialCalc.DetermineValueType(value);\n      if (testvalue.type.charAt(0) == \"n\") { // could be number - make it one\n         value = testvalue.value;\n         type = testvalue.type;\n         }\n      }\n\n   if (type.charAt(0) == \"n\" && basevalue.type.charAt(0) == \"n\") { // compare two numbers\n      value = value - 0; // make sure numbers\n      basevalue.value = basevalue.value - 0;\n      switch (comparitor) {\n         case \"<\":\n            cond = value < basevalue.value;\n            break;\n\n         case \"<=\":\n            cond = value <= basevalue.value;\n            break;\n\n         case \"=\":\n         case \"none\":\n            cond = value == basevalue.value;\n            break;\n\n         case \">=\":\n            cond = value >= basevalue.value;\n            break;\n\n         case \">\":\n            cond = value > basevalue.value;\n            break;\n\n         case \"<>\":\n            cond = value != basevalue.value;\n            break;\n         }\n      }\n\n   else if (type.charAt(0) == \"e\") { // error on left\n      cond = false;\n      }\n\n   else if (basevalue.type.charAt(0) == \"e\") { // error on right\n      cond = false;\n      }\n\n   else { // text, maybe mixed with number or blank\n      if (type.charAt(0) == \"n\") {\n         value = SocialCalc.format_number_for_display(value, \"n\", \"\");\n         }\n      if (basevalue.type.charAt(0) == \"n\") {\n         return false; // if number and didn't match already, isn't a match\n         }\n\n      value = value ? value.toLowerCase() : \"\";\n      basevalue.value = basevalue.value ? basevalue.value.toLowerCase() : \"\";\n\n      switch (comparitor) {\n         case \"<\":\n            cond = value < basevalue.value;\n            break;\n\n         case \"<=\":\n            cond = value <= basevalue.value;\n            break;\n\n         case \"=\":\n            cond = value == basevalue.value;\n            break;\n\n         case \"none\":\n            cond = value.substring(0, basevalue.value.length) == basevalue.value;\n            break;\n\n         case \">=\":\n            cond = value >= basevalue.value;\n            break;\n\n         case \">\":\n            cond = value > basevalue.value;\n            break;\n\n         case \"<>\":\n            cond = value != basevalue.value;\n            break;\n\n         case \"regex\":\n            try {\n              cond = value.search(new RegExp(basevalue.value)) != -1;\n            } catch(e) {\n              cond = false; // regex invalid (e.g., error value) is always false\n            }\n            break;\n         }\n      }\n\n   return cond;\n\n   }\n//\n/*\n// The module of the SocialCalc package for the optional popup menus in socialcalcspreadsheetcontrol.js\n//\n// (c) Copyright 2009 Socialtext, Inc.\n// All Rights Reserved.\n//\n// The contents of this file are subject to the Artistic License 2.0; you may not\n// use this file except in compliance with the License. You may obtain a copy of \n// the License at http://socialcalc.org/licenses/al-20/.\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n//\n*/\n\n   var SocialCalc; // All values are stored in the master SocialCalc object\n   if (!SocialCalc) {\n      SocialCalc = {};\n      }\n\n   // The main Popup data -- there is only one set\n\n   SocialCalc.Popup = {};\n\n   // Routines and values for each type of control, indexed by type name\n   // The value for each is an object constructed as follows:\n   //\n   //    Create = function(type, id, attribs)\n   //    Initialize = function(type, id, data)\n   //    SetValue = function(type, id, value)\n   //    GetValue = function(type, id) returns value\n   //    SetDisabled = function(type, id, t/f)\n   //    Show = function(type, id)\n   //    Hide = function(type, id)\n   //    Cancel = function(type, id)\n   //    Reset = function(type)\n   //\n   //    data = object to hold type-specific data\n   //\n\n   SocialCalc.Popup.Types = {};\n\n   // Definitions for each individual control, indexed by id\n   // The value for each is an object constructed as follows:\n   //\n   //    type: type name of the control\n   //    value: current value of the control (usually a string, but can depend on type)\n   //    data: object with type-specific items\n   //\n\n   SocialCalc.Popup.Controls = {};\n\n   // System-wide values of currently active control\n   //\n   //    id: id of current control or null\n   //\n\n   SocialCalc.Popup.Current = {};\n\n   // Override this for localization\n\n   SocialCalc.Popup.LocalizeString = function(str) {return str;};\n\n\n// * * * * * * * * * * * * * * * *\n//\n// GENERAL ROUTINES\n//\n// * * * * * * * * * * * * * * * *\n\n//\n// SocialCalc.Popup.Create(type, id, attribs)\n//\n// Creates a control of type \"type\" as the children of document element \"id\" using \"attribs\"\n//\n\nSocialCalc.Popup.Create = function(type, id, attribs) {\n\n   var pt = SocialCalc.Popup.Types[type];\n   if (pt && pt.Create) {\n      pt.Create(type, id, attribs);\n      }\n\n   SocialCalc.Popup.imagePrefix = SocialCalc.Constants.defaultImagePrefix; // image prefix\n\n   }\n\n\n//\n// SocialCalc.Popup.SetValue(id, value)\n//\n// Sets the value of control.\n//\n\nSocialCalc.Popup.SetValue = function(id, value) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n   var pt = spt[type];\n   var spcdata = spc[id].data;\n\n   if (pt && pt.Create) {\n      pt.SetValue(type, id, value);\n      if (spcdata.attribs && spcdata.attribs.changedcallback) {\n         spcdata.attribs.changedcallback(spcdata.attribs, id, value);\n         }\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.SetDisabled(id, disabled)\n//\n// Sets whether the control is disabled (true) or not (false).\n//\n\nSocialCalc.Popup.SetDisabled = function(id, disabled) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n   if (pt && pt.Create) {\n      if (sp.Current.id && id == sp.Current.id) {\n         pt.Hide(type, sp.Current.id);\n         sp.Current.id = null;\n         }\n      pt.SetDisabled(type, id, disabled);\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.GetValue(id)\n//\n// Returns the value of control.\n//\n\nSocialCalc.Popup.GetValue = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n   if (pt && pt.Create) {\n      return pt.GetValue(type, id);\n      }\n\n   return null;\n\n   }\n\n\n//\n// SocialCalc.Popup.Initialize(id, data)\n//\n// Gives \"data\" to the appropriate initialization code.\n//\n\nSocialCalc.Popup.Initialize = function(id, data) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n   if (pt && pt.Initialize) {\n      pt.Initialize(type, id, data);\n      }\n\n   }\n\n\n//\n// SocialCalc.Popup.Reset(type)\n//\n// Resets Popup, such as when turning to page.\n//\n\nSocialCalc.Popup.Reset = function(type) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (spt[type].Reset) spt[type].Reset(type);\n\n   }\n\n\n//\n// SocialCalc.Popup.CClick(id)\n//\n// Should be called when the user clicks on a control to do the popup\n//\n\nSocialCalc.Popup.CClick = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\n\n   if (spc[id].data && spc[id].data.disabled) return;\n\n   var type = spc[id].type;\n\n   var pt = spt[type];\n\n   if (sp.Current.id) {\n      spt[spc[sp.Current.id].type].Hide(type, sp.Current.id);\n      if (id == sp.Current.id) { // same one - done\n         sp.Current.id = null;\n         return;\n         }\n      }\n\n   if (pt && pt.Show) {\n      pt.Show(type, id);\n      }\n\n   sp.Current.id = id;\n\n   }\n\n\n//\n// SocialCalc.Popup.Close()\n//\n// Used to close any open popup.\n//\n\nSocialCalc.Popup.Close = function() {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!sp.Current.id) return;\n\n   sp.CClick(sp.Current.id);\n\n   }\n\n//\n// SocialCalc.Popup.Cancel()\n//\n// Closes Popup and restores old value\n//\n\nSocialCalc.Popup.Cancel = function() {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (!sp.Current.id) return;\n\n   var type = spc[sp.Current.id].type;\n\n   var pt = spt[type];\n\n   pt.Cancel(type, sp.Current.id);\n\n   sp.Current.id = null;\n\n   }\n\n//\n// ele = SocialCalc.Popup.CreatePopupDiv(id, attribs)\n//\n// Utility function to create the main popup div of width attribs.width.\n// If attribs.title, create one with that text, and optionally attribs.moveable.\n//\n\nSocialCalc.Popup.CreatePopupDiv = function(id, attribs) {\n\n   var pos, ele;\n\n   var sp = SocialCalc.Popup;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var main = document.createElement(\"div\");\n   main.style.position = \"absolute\";\n\n   pos = SocialCalc.GetElementPosition(spcdata.mainele);\n\n   main.style.top = (pos.top+spcdata.mainele.offsetHeight)+\"px\";\n   main.style.left = pos.left+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   if (attribs.width) {\n      main.style.width = attribs.width;\n      }\n\n   spcdata.mainele.appendChild(main);\n\n   if (attribs.title) {\n      main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n         '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+attribs.title+'</td>'+\n         '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.Popup.Cancel();\">&nbsp;X&nbsp;</td></tr></table>';\n\n      if (attribs.moveable) {\n         spcdata.dragregistered = main.firstChild.firstChild.firstChild.firstChild;\n         SocialCalc.DragRegister(spcdata.dragregistered, true, true, \n                    {MouseDown: SocialCalc.DragFunctionStart, \n                     MouseMove: SocialCalc.DragFunctionPosition,\n                     MouseUp: SocialCalc.DragFunctionPosition,\n                     Disabled: null, positionobj: main},\n                     spcdata.mainele);\n         }\n      }\n\n   return main;\n\n   }\n\n//\n// SocialCalc.Popup.EnsurePosition(id, container)\n//\n// Utility function to make sure popup is positioned completely within container (both element objects)\n// and appropriate with respect to the main element controlling the popup.\n//\n\nSocialCalc.Popup.EnsurePosition = function(id, container) {\n\n   var sp = SocialCalc.Popup;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var main = spcdata.mainele.firstChild;\n   if (!main) {alert(\"No main popup element firstChild.\");return};\n   var popup = spcdata.popupele;\n\n   function GetLayoutValues(ele) {\n      var r = SocialCalc.GetElementPosition(ele);\n      r.height = ele.offsetHeight;\n      r.width = ele.offsetWidth;\n      r.bottom = r.top+r.height;\n      r.right = r.left+r.width;\n      return r;\n      }\n\n   var p = GetLayoutValues(popup);\n   var c = GetLayoutValues(container);\n   var m = GetLayoutValues(main);\n   var t = 0; // type of placement\n//addmsg(\"popup t/r/b/l/h/w= \"+p.top+\"/\"+p.right+\"/\"+p.bottom+\"/\"+p.left+\"/\"+p.height+\"/\"+p.width);\n//addmsg(\"container t/r/b/l/h/w= \"+c.top+\"/\"+c.right+\"/\"+c.bottom+\"/\"+c.left+\"/\"+c.height+\"/\"+c.width);\n//addmsg(\"main t/r/b/l/h/w= \"+m.top+\"/\"+m.right+\"/\"+m.bottom+\"/\"+m.left+\"/\"+m.height+\"/\"+m.width);\n\n   // Check various layout cases in priority order\n\n   if (m.bottom+p.height < c.bottom && m.left+p.width < c.right) { // normal case: room on bottom and right\n      popup.style.top = m.bottom + \"px\";\n      popup.style.left = m.left + \"px\";\n      t = 1;\n      }\n\n   else if (m.top-p.height > c.top && m.left+p.width < c.right) { // room on top and right\n      popup.style.top = (m.top-p.height) + \"px\";\n      popup.style.left = m.left + \"px\";\n      t = 2;\n      }\n\n   else if (m.bottom+p.height < c.bottom && m.right-p.width > c.left) { // room on bottom and left\n      popup.style.top = m.bottom + \"px\";\n      popup.style.left = (m.right-p.width) + \"px\";\n      t = 3;\n      }\n\n   else if (m.top-p.height > c.top && m.right-p.width > c.left) { // room on top and left\n      popup.style.top = (m.top-p.height) + \"px\";\n      popup.style.left = (m.right-p.width) + \"px\";\n      t = 4;\n      }\n\n   else if (m.bottom+p.height < c.bottom && p.width < c.width) { // room on bottom and middle\n      popup.style.top = m.bottom + \"px\";\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\n      t = 5;\n      }\n\n   else if (m.top-p.height > c.top && p.width < c.width) { // room on top and middle\n      popup.style.top = (m.top-p.height) + \"px\";\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\n      t = 6;\n      }\n\n   else if (p.height < c.height && m.right+p.width < c.right) { // room on middle and right\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\n      popup.style.left = m.right + \"px\";\n      t = 7;\n      }\n\n   else if (p.height < c.height && m.left-p.width > c.left) { // room on middle and left\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\n      popup.style.left = (m.left-p.width) + \"px\";\n      t = 8;\n      }\n\n   else { // nothing works, so leave as it is\n      }\n//addmsg(\"Popup layout \"+t);\n\n}\n\n//\n// ele = SocialCalc.Popup.DestroyPopupDiv(ele, dragregistered)\n//\n// Utility function to get rid of the main popup div.\n//\n\nSocialCalc.Popup.DestroyPopupDiv = function(ele, dragregistered) {\n\n   if (!ele) return;\n\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(dragregistered); // OK to do this even if not registered\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   }\n\n//\n// Color Utility Functions\n//\n\nSocialCalc.Popup.RGBToHex = function(val) {\n\n   var sp = SocialCalc.Popup;\n\n   if (val==\"\") {\n      return \"000000\";\n      }\n   var rgbvals = val.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)/);\n   if (rgbvals) {\n      return sp.ToHex(rgbvals[1])+sp.ToHex(rgbvals[2])+sp.ToHex(rgbvals[3]);\n      }\n   else {\n      return \"000000\";\n      }\n   }\n\nSocialCalc.Popup.HexDigits=\"0123456789ABCDEF\";\n\nSocialCalc.Popup.ToHex = function(num) {\n   var sp = SocialCalc.Popup;\n   var first=Math.floor(num / 16);\n   var second=num % 16;\n   return sp.HexDigits.charAt(first)+sp.HexDigits.charAt(second);\n   }\n\nSocialCalc.Popup.FromHex = function(str) {\n\n   var sp = SocialCalc.Popup;\n   var first = sp.HexDigits.indexOf(str.charAt(0).toUpperCase());\n   var second = sp.HexDigits.indexOf(str.charAt(1).toUpperCase());\n   return ((first>=0)?first:0)*16+((second>=0)?second:0);\n   }\n\nSocialCalc.Popup.HexToRGB = function(val) {\n\n   var sp = SocialCalc.Popup;\n\n   return \"rgb(\"+sp.FromHex(val.substring(1,3))+\",\"+sp.FromHex(val.substring(3,5))+\",\"+sp.FromHex(val.substring(5,7))+\")\";\n\n   }\n\nSocialCalc.Popup.makeRGB = function(r, g, b) {\n   return \"rgb(\"+(r>0?r:0)+\",\"+(g>0?g:0)+\",\"+(b>0?b:0)+\")\";\n   }\n\nSocialCalc.Popup.splitRGB = function(rgb) {\n   var parts = rgb.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)\\D/);\n   if (!parts) {\n      return {r:0, g:0, b:0};\n      }\n   else {\n      return {r: parts[1]-0, g: parts[2]-0, b: parts[3]-0};\n      }\n   }\n\n// * * * * * * * * * * * * * * * *\n//\n// ROUTINES FOR EACH TYPE\n//\n// * * * * * * * * * * * * * * * *\n\n//\n// List\n//\n// type: List\n// value: value of control,\n// display: \"value to display\",\n// custom: true if custom value,\n// disabled: t/f,\n// attribs: {\n//    title: \"popup title string\",\n//    moveable: t/f,\n//    width: optional width, e.g., \"100px\",\n//    ensureWithin: optional element object to ensure popup fits within if possible\n//    changedcallback: optional function(attribs, id, newvalue),\n//    ...\n//    }\n// data: {\n//    ncols: calculated number of columns\n//    options: [\n//       {o: option-name, v: value-to-return,\n//        a: {option attribs} // optional: {skip: true, custom: true, cancel: true, newcol: true}\n//       },\n//       ...]\n//    }\n//\n// popupele: gets popup element object when created\n// contentele: gets element created with all the content\n// listdiv: gets div with list of items\n// customele: gets input element with custom value\n// dragregistered: gets element, if any, registered as draggable\n//\n\nSocialCalc.Popup.Types.List = {};\n\nSocialCalc.Popup.Types.List.Create = function(type, id, attribs) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\n   //if (spc[id]) {alert(\"Already created \"+id); return;}\n   spc[id] = spcid;\n   var spcdata = spcid.data;\n\n   spcdata.attribs = attribs || {};\n\n   var ele = document.getElementById(id);\n   if (!ele) {alert(\"Missing element \"+id); return;}\n\n   spcdata.mainele = ele;\n\n   ele.innerHTML = '<input style=\"cursor:pointer;width:100px;font-size:smaller;\" onfocus=\"this.blur();\" onclick=\"SocialCalc.Popup.CClick(\\''+id+'\\');\" value=\"\">';\n\n   spcdata.options = []; // set to nothing - use Initialize to fill\n\n   }\n\nSocialCalc.Popup.Types.List.SetValue = function(type, id, value) {\n\n   var i;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   spcdata.value = value;\n   spcdata.custom = false;\n\n   for (i=0; i<spcdata.options.length; i++) {\n      o = spcdata.options[i];\n      if (o.a) {\n         if (o.a.skip || o.a.custom || o.a.cancel) {\n            continue;\n            }\n         }\n      if (o.v == spcdata.value) { // matches value\n         spcdata.display = o.o;\n         break;\n         }\n      }\n   if (i==spcdata.options.length) { // none found\n      spcdata.display = \"Custom\";\n      spcdata.custom = true;\n      }\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.value = spcdata.display;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.SetDisabled = function(type, id, disabled) {\n\n   var i;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   spcdata.disabled = disabled;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.disabled = disabled;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.GetValue = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   return spcdata.value;\n\n   }\n\n\n// data is: {value: initial value, attribs: {attribs stuff}, options: [{o: option-name, v: value-to-return, a: optional-attribs}, ...]}\n\nSocialCalc.Popup.Types.List.Initialize = function(type, id, data) {\n\n   var a;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   for (a in data.attribs) {\n      spcdata.attribs[a] = data.attribs[a];\n      }\n\n   spcdata.options = data ? data.options : [];\n\n   if (data.value) { // if has a value, set to it\n      sp.SetValue(id, data.value);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.Reset = function(type) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\n      spt[type].Hide(type, sp.Current.id);\n      sp.Current.id = null;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.Show = function(type, id) {\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data\n\n   var str = \"\";\n\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\n\n   if (spcdata.custom) {\n      str = SocialCalc.Popup.Types.List.MakeCustom(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n\n      spcdata.customele = ele.firstChild.firstChild.childNodes[1];\n      spcdata.listdiv = null;\n      spcdata.contentele = ele;\n      }\n   else {\n      str = SocialCalc.Popup.Types.List.MakeList(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\n\n      spcdata.customele = null;\n      spcdata.listdiv = ele.firstChild;\n      spcdata.contentele = ele;\n      }\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.disabled = true;\n      }\n\n   spcdata.popupele.appendChild(ele);\n\n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.List.MakeList = function(type, id) {\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data\n\n   var str = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>';\n   var td = '<td style=\"vertical-align:top;\">';\n\n   str += td;\n\n   spcdata.ncols = 1;\n\n   for (i=0; i<spcdata.options.length; i++) {\n      o = spcdata.options[i];\n      if (o.a) {\n         if ( o.a.newcol) {\n            str += '</td>'+td+\"&nbsp;&nbsp;&nbsp;&nbsp;\"+'</td>'+td;\n            spcdata.ncols += 1;\n            continue;\n            }\n         if (o.a.skip) {\n            str += '<div style=\"font-size:x-small;white-space:nowrap;\">'+o.o+'</div>';\n            continue;\n            }\n         }\n      if (o.v == spcdata.value && !(o.a && (o.a.custom || o.a.cancel))) { // matches value\n         bg = \"background-color:#DDF;\";\n         }\n      else {\n         bg = \"\";\n         }\n      str += '<div style=\"font-size:x-small;white-space:nowrap;'+bg+'\" onclick=\"SocialCalc.Popup.Types.List.ItemClicked(\\''+id+'\\',\\''+i+'\\');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove(\\''+id+'\\',this);\">'+o.o+'</div>';\n      }\n\n   str += \"</td></tr></table>\";\n\n   return str;\n\n   }\n\n\nSocialCalc.Popup.Types.List.MakeCustom = function(type, id) {\n\n   var SPLoc = SocialCalc.Popup.LocalizeString;\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var style = 'style=\"font-size:smaller;\"';\n\n   var str = \"\";\n\n   var val = spcdata.value;\n   val = SocialCalc.special_chars(val);\n\n   str = '<div style=\"white-space:nowrap;\"><br>'+\n         '<input id=\"customvalue\" value=\"'+val+'\"><br><br>'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomOK(\\''+id+'\\');return false;\">'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"List\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomToList(\\''+id+'\\');\">'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Cancel\")+'\" onclick=\"SocialCalc.Popup.Close();\">'+\n         '<br></div>';\n\n   return str;\n\n   }\n\n\nSocialCalc.Popup.Types.List.ItemClicked = function(id, num) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var a = spcdata.options[num].a;\n\n   if (a && a.custom) {\n      oele = spcdata.contentele;\n      str = SocialCalc.Popup.Types.List.MakeCustom(\"List\", id);\n      nele = document.createElement(\"div\");\n      nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n      spcdata.customele = nele.firstChild.firstChild.childNodes[1];\n      spcdata.listdiv = null;\n      spcdata.contentele = nele;\n      spcdata.popupele.replaceChild(nele, oele);\n      if (spcdata.attribs.ensureWithin) {\n         SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n         }\n      return;\n      }\n\n   if (a && a.cancel) {\n      SocialCalc.Popup.Close();\n      return;\n      }\n\n   SocialCalc.Popup.SetValue(id, spcdata.options[num].v);\n\n   SocialCalc.Popup.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.List.CustomToList = function(id) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   oele = spcdata.contentele;\n   str = SocialCalc.Popup.Types.List.MakeList(\"List\", id);\n   nele = document.createElement(\"div\");\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\n   spcdata.customele = null;\n   spcdata.listdiv = nele.firstChild;\n   spcdata.contentele = nele;\n   spcdata.popupele.replaceChild(nele, oele);\n   \n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n   }\n\n\nSocialCalc.Popup.Types.List.CustomOK = function(id) {\n\n   var i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, spcdata.customele.value);\n\n   SocialCalc.Popup.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.List.MouseMove = function(id, ele) {\n\n   var col, i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var list = spcdata.listdiv;\n\n   if (!list) return;\n\n   var rowele = list.firstChild.firstChild.firstChild; // div.table.tbody.tr\n\n   for (col=0; col<spcdata.ncols; col++) {\n      for (i=0; i<rowele.childNodes[col*2].childNodes.length; i++) {\n         rowele.childNodes[col*2].childNodes[i].style.backgroundColor = \"#FFF\";\n         }\n      }\n\n   ele.style.backgroundColor = \"#DDF\";\n   \n   }\n\nSocialCalc.Popup.Types.List.Hide = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\n   spcdata.popupele = null;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      spcdata.mainele.firstChild.disabled = false;\n      }\n\n   }\n\nSocialCalc.Popup.Types.List.Cancel = function(type, id) {\n\n   SocialCalc.Popup.Types.List.Hide(type, id);\n\n   }\n\n\n//\n// ColorChooser\n//\n// type: ColorChooser\n// value: value of control as \"rgb(r,g,b)\" or \"\" if default,\n// oldvalue: starting value to reset to on close,\n// display: \"value to display\" as hex color value,\n// custom: true if custom value,\n// disabled: t/f,\n// attribs: {\n//    title: \"popup title string\",\n//    moveable: t/f,\n//    width: optional width, e.g., \"100px\", of popup chooser\n//    ensureWithin: optional element object to ensure popup fits within if possible\n//    sampleWidth: optional width, e.g., \"20px\",\n//    sampleHeight: optional height, e.g., \"20px\",\n//    backgroundImage: optional background image for sample (transparent where want to show current color), e.g., \"colorbg.gif\"\n//    backgroundImageDefault: optional background image for sample when default (transparent shows white)\n//    backgroundImageDisabled: optional background image for sample when disabled (transparent shows gray)\n//    changedcallback: optional function(attribs, id, newvalue),\n//    ...\n//    }\n// data: {\n//    }\n//\n// popupele: gets popup element object when created\n// contentele: gets element created with all the content\n// customele: gets input element with custom value\n//\n\nSocialCalc.Popup.Types.ColorChooser = {};\n\nSocialCalc.Popup.Types.ColorChooser.Create = function(type, id, attribs) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\n   //if (spc[id]) {alert(\"Already created \"+id); return;}\n   spc[id] = spcid;\n   var spcdata = spcid.data;\n\n   spcdata.attribs = attribs || {};\n   var spca = spcdata.attribs;\n\n   spcdata.value = \"\";\n\n   var ele = document.getElementById(id);\n   if (!ele) {alert(\"Missing element \"+id); return;}\n\n   spcdata.mainele = ele;\n\n   ele.innerHTML = '<div style=\"cursor:pointer;border:1px solid black;vertical-align:top;width:'+\n                   (spca.sampleWidth || '15px')+';height:'+(spca.sampleHeight || '15px')+\n                   ';\" onclick=\"SocialCalc.Popup.Types.ColorChooser.ControlClicked(\\''+id+'\\');\">&nbsp;</div>';\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.SetValue = function(type, id, value) {\n\n   var i, img, pos;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var spca = spcdata.attribs;\n\n   spcdata.value = value;\n   spcdata.custom = false;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      if (spcdata.value) {\n         spcdata.mainele.firstChild.style.backgroundColor = spcdata.value;\n         if (spca.backgroundImage) {\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImage+\")\";\n            }\n         else {\n            img = \"\";\n            }\n         pos = \"center center\";\n         }\n      else {\n         spcdata.mainele.firstChild.style.backgroundColor = \"#FFF\";\n         if (spca.backgroundImageDefault) {\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDefault+\")\";\n            pos = \"center center\";\n            }\n         else {\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\n            pos = \"left top\";\n            }\n         }\n      spcdata.mainele.firstChild.style.backgroundPosition = pos;\n      spcdata.mainele.firstChild.style.backgroundImage = img;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.SetDisabled = function(type, id, disabled) {\n\n   var i;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var spca = spcdata.attribs;\n\n   spcdata.disabled = disabled;\n\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\n      if (disabled) {\n         spcdata.mainele.firstChild.style.backgroundColor = \"#DDD\";\n         if (spca.backgroundImageDisabled) {\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDisabled+\")\";\n            pos = \"center center\";\n            }\n         else {\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\n            pos = \"left top\";\n            }\n         spcdata.mainele.firstChild.style.backgroundPosition = pos;\n         spcdata.mainele.firstChild.style.backgroundImage = img;\n         }\n      else {\n         sp.SetValue(id, spcdata.value);\n         }\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.GetValue = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   return spcdata.value;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Initialize = function(type, id, data) {\n\n   var a;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   for (a in data.attribs) {\n      spcdata.attribs[a] = data.attribs[a];\n      }\n\n   if (data.value) { // if has a value, set to it\n      sp.SetValue(id, data.value);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Reset = function(type) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\n      spt[type].Hide(type, sp.Current.id);\n      sp.Current.id = null;\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Show = function(type, id) {\n\n   var i, ele, mainele;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data\n\n   var str = \"\";\n\n   spcdata.oldvalue = spcdata.value; // remember starting value\n\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\n\n   if (spcdata.custom) {\n      str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n\n      spcdata.customele = ele.firstChild.firstChild.childNodes[2];\n      spcdata.contentele = ele;\n      }\n   else {\n      mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(type, id);\n\n      ele = document.createElement(\"div\");\n      ele.style.padding = \"3px\";\n      ele.style.backgroundColor = \"#CCC\";\n      ele.appendChild(mainele);\n\n      spcdata.customele = null;\n      spcdata.contentele = ele;\n      }\n\n   spcdata.popupele.appendChild(ele);\n\n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.MakeCustom = function(type, id) {\n\n   var i, ele, o, bg;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   var SPLoc = sp.LocalizeString;\n\n   var style = 'style=\"font-size:smaller;\"';\n\n   var str = \"\";\n\n   str = '<div style=\"white-space:nowrap;\"><br>'+\n         '#<input id=\"customvalue\" style=\"width:75px;\" value=\"'+spcdata.value+'\"><br><br>'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomOK(\\''+id+'\\');return false;\">'+\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Grid\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\\''+id+'\\');\">'+\n         '<br></div>';\n\n   return str;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.ItemClicked = function(id, num) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomToList = function(id) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\n\n   var i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.SetValue(id, spcdata.customele.value);\n\n   sp.Close();\n   \n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Hide = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\n   spcdata.popupele = null;\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.Cancel = function(type, id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   sp.SetValue(id, spcdata.oldvalue); // reset to old value\n\n   SocialCalc.Popup.Types.ColorChooser.Hide(type, id);\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CreateGrid = function (type, id) {\n\n   var ele, pos, row, rowele, col, g;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var SPLoc = sp.LocalizeString;\n   var spcdata = spc[id].data;\n   spcdata.grid = {};\n   var grid = spcdata.grid;\n\n   var mainele = document.createElement(\"div\");\n\n   ele = document.createElement(\"table\");\n   ele.cellSpacing = 0;\n   ele.cellPadding = 0;\n   ele.style.width = \"100px\";\n   grid.table = ele;\n\n   ele = document.createElement(\"tbody\");\n   grid.table.appendChild(ele);\n   grid.tbody = ele;\n\n   for (row=0; row<16; row++) {\n      rowele = document.createElement(\"tr\");\n      for (col=0; col<5; col++) {\n         g = {};\n         grid[row+\",\"+col] = g;\n         ele = document.createElement(\"td\");\n         ele.style.fontSize = \"1px\";\n         ele.innerHTML = \"&nbsp;\";\n         ele.style.height = \"10px\";\n         if (col<=1) {\n            ele.style.width = \"17px\";\n            ele.style.borderRight = \"3px solid white\";\n            }\n         else {\n            ele.style.width = \"20px\";\n            ele.style.backgroundRepeat = \"no-repeat\";\n            }\n         rowele.appendChild(ele);\n         g.ele = ele;\n         }\n      grid.tbody.appendChild(rowele);\n      }\n   mainele.appendChild(grid.table);\n\n   ele = document.createElement(\"div\");\n   ele.style.marginTop = \"3px\";\n   ele.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '<td style=\"width:17px;background-color:#FFF;background-image:url('+sp.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;\" title=\"'+SPLoc(\"Default\")+'\">&nbsp;</td>'+\n      '<td style=\"width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;\" title=\"'+SPLoc(\"Custom\")+'\">#</td>'+\n      '<td style=\"width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;\">'+SPLoc(\"OK\")+'</td>'+\n      '</tr></table>';\n   grid.defaultbox = ele.firstChild.firstChild.firstChild.childNodes[0];\n   grid.defaultbox.onclick = spt.ColorChooser.DefaultClicked;\n   grid.custom = ele.firstChild.firstChild.firstChild.childNodes[1];\n   grid.custom.onclick = spt.ColorChooser.CustomClicked;\n   grid.msg = ele.firstChild.firstChild.firstChild.childNodes[2];\n   grid.msg.onclick = spt.ColorChooser.CloseOK;\n   mainele.appendChild(ele);\n\n   grid.table.onmousedown = spt.ColorChooser.GridMouseDown;\n\n   spt.ColorChooser.DetermineColors(id);\n   spt.ColorChooser.SetColors(id);\n\n   return mainele;\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.gridToG = function(grid, row, col) {\n\n   return grid[row+\",\"+col];\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.DetermineColors = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var grid = spcdata.grid;\n\n   var col, row;\n   var rgb = sp.splitRGB(spcdata.value);\n   var color;\n\n   col = 2;\n   row = 16-Math.floor((rgb.r+16)/16);\n   grid[\"selectedrow\"+col] = row;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),0,0);\n      }\n\n   col = 3;\n   row = 16-Math.floor((rgb.g+16)/16);\n   grid[\"selectedrow\"+col] = row;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,17*(15-row),0);\n      }\n\n   col = 4;\n   row = 16-Math.floor((rgb.b+16)/16);\n   grid[\"selectedrow\"+col] = row;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,0,17*(15-row));\n      }\n\n   col = 1;\n   for (row=0; row<16; row++) {\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),17*(15-row),17*(15-row));\n      }\n\n   col = 0;\n   var steps = [0, 68, 153, 204, 255];\n   var commonrgb = [\"400\", \"310\", \"420\", \"440\", \"442\", \"340\", \"040\", \"042\", \"032\", \"044\", \"024\", \"004\", \"204\", \"314\", \"402\", \"414\"];\n   var x;\n   for (row=0; row<16; row++) {\n      x = commonrgb[row];\n      sptc.gridToG(grid,row,col).rgb = \"rgb(\"+steps[x.charAt(0)-0]+\",\"+steps[x.charAt(1)-0]+\",\"+steps[x.charAt(2)-0]+\")\";\n      }\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.SetColors = function(id) {\n\n   var row, col, g, ele, rgb;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n   var grid = spcdata.grid;\n\n   for (row=0; row<16; row++) {\n      for (col=0; col<5; col++) {\n         g = sptc.gridToG(grid,row, col);\n         g.ele.style.backgroundColor = g.rgb;\n         g.ele.title = sp.RGBToHex(g.rgb);\n         if (grid[\"selectedrow\"+col]==row) {\n            g.ele.style.backgroundImage = \"url(\"+sp.imagePrefix+\"chooserarrow.gif)\";\n            }\n         else {\n            g.ele.style.backgroundImage = \"\";\n            }\n         }\n      }\n\n   sp.SetValue(id, spcdata.value);\n\n   grid.msg.style.backgroundColor = spcdata.value;\n   rgb = sp.splitRGB(spcdata.value || \"rgb(255,255,255)\");\n   if (rgb.r+rgb.g+rgb.b < 220) {\n      grid.msg.style.color = \"#FFF\";\n      }\n   else {\n      grid.msg.style.color = \"#000\";\n      }\n   if (!spcdata.value) { // default\n      grid.msg.style.backgroundColor = \"#FFF\";\n      grid.msg.style.backgroundImage = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\n      grid.msg.title = \"Default\";\n      }\n   else {\n      grid.msg.style.backgroundImage = \"\";\n      grid.msg.title = sp.RGBToHex(spcdata.value);\n      }\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.GridMouseDown = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n   var grid = spcdata.grid;\n\n   switch (event.type) {\n      case \"mousedown\":\n         grid.mousedown = true;\n         break;\n      case \"mouseup\":\n         grid.mousedown = false;\n         break;\n      case \"mousemove\":\n         if (!grid.mousedown) {\n            return;\n            }\n         break;\n      }\n\n   var pos = SocialCalc.GetElementPositionWithScroll(spcdata.mainele);\n   var clientX = event.clientX - pos.left;\n   var clientY = event.clientY - pos.top;\n   var gpos = SocialCalc.GetElementPositionWithScroll(grid.table);\n   gpos.left -= pos.left;\n   gpos.top -= pos.top\n   var row = Math.floor((clientY-gpos.top-2)/10); // -2 is to split the diff btw IE & FF\n   row = row < 0 ? 0 : row;\n   var col = Math.floor((clientX-gpos.left)/20);\n   row = row < 0 ? 0 : (row > 15 ? 15 : row);\n   col = col < 0 ? 0 : (col > 4 ? 4 : col);\n   var color = sptc.gridToG(grid,row,col).ele.style.backgroundColor;\n   var newrgb = sp.splitRGB(color);\n   var oldrgb = sp.splitRGB(spcdata.value);\n\n   switch (col) {\n      case 2:\n         spcdata.value = sp.makeRGB(newrgb.r, oldrgb.g, oldrgb.b);\n         break;\n      case 3:\n         spcdata.value = sp.makeRGB(oldrgb.r, newrgb.g, oldrgb.b);\n         break;\n      case 4:\n         spcdata.value = sp.makeRGB(oldrgb.r, oldrgb.g, newrgb.b);\n         break;\n      case 0:\n      case 1:\n         spcdata.value = color;\n      }\n\n   sptc.DetermineColors(id);\n   sptc.SetColors(id);\n\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.ControlClicked = function(id) {\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var cid = sp.Current.id;\n   if (!cid || id != cid) {\n      sp.CClick(id);\n      return;\n      }\n\n   sptc.CloseOK();\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.DefaultClicked = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n\n   spcdata.value = \"\";\n   SocialCalc.Popup.SetValue(id, spcdata.value);\n\n   SocialCalc.Popup.Close();\n\n   }\n\nSocialCalc.Popup.Types.ColorChooser.CustomClicked = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n\n   var oele, str, nele;\n\n   oele = spcdata.contentele;\n   str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(\"ColorChooser\", id);\n   nele = document.createElement(\"div\");\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\n   spcdata.customele = nele.firstChild.firstChild.childNodes[2];\n   spcdata.contentele = nele;\n   spcdata.popupele.replaceChild(nele, oele);\n\n   spcdata.customele.value = sp.RGBToHex(spcdata.value);\n\n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n\n   }\n\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomToGrid = function(id) {\n\n   var oele, str, nele;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\n\n   var oele, mainele, nele;\n\n   oele = spcdata.contentele;\n   mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(\"ColorChooser\", id);\n   nele = document.createElement(\"div\");\n   nele.style.padding = \"3px\";\n   nele.style.backgroundColor = \"#CCC\";\n   nele.appendChild(mainele);\n   spcdata.customele = null;\n   spcdata.contentele = nele;\n   spcdata.popupele.replaceChild(nele, oele);\n   \n   if (spcdata.attribs.ensureWithin) {\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\n      }\n   }\n\n\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\n\n   var i, c;\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var spc = sp.Controls;\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\n\n   SocialCalc.Popup.Close();\n   \n   }\n\nSocialCalc.Popup.Types.ColorChooser.CloseOK = function(e) {\n\n   var event = e || window.event;\n\n   var sp = SocialCalc.Popup;\n   var spt = sp.Types;\n   var sptc = spt.ColorChooser;\n   var spc = sp.Controls;\n\n   var id = sp.Current.id;\n   if (!id) return;\n\n   var spcdata = spc[id].data;\n\n   SocialCalc.Popup.SetValue(id, spcdata.value);\n\n   SocialCalc.Popup.Close();\n\n   }\n\n//\n// SocialCalcSpreadsheetControl\n//\n/*\n// The code module of the SocialCalc package that lets you embed a spreadsheet\n// control with toolbar, etc., into a web page.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n\n\n/*\n\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n\nEXHIBIT A. Common Public Attribution License Version 1.0.\n\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \nSections 14 and 15 have been added to cover use of software over a computer network and provide for \nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \nconsistent with Exhibit B.\n\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \nKIND, either express or implied. See the License for the specific language governing rights and \nlimitations under the License.\n\nThe Original Code is SocialCalc JavaScript SpreadsheetControl.\n\nThe Original Developer is the Initial Developer.\n\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n\nContributor: Dan Bricklin.\n\n\nEXHIBIT B. Attribution Information\n\nWhen the SpreadsheetControl is producing and/or controlling the display the Graphic Image must be\ndisplayed on the screen visible to the user in a manner comparable to that in the \nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\nthat image. The image must be linked to the Attribution URL so as to access that page\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\nfactual prominent attribution in a form similar to that in the \"about\" display included\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\n\nAttribution Copyright Notice:\n\n Copyright (C) 2010 Socialtext, Inc.\n All Rights Reserved.\n\nAttribution Phrase (not exceeding 10 words): SocialCalc\n\nAttribution URL: http://www.socialcalc.org/\n\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\na suitable replacement from http://www.socialcalc.org/licenses specified as\nbeing for SocialCalc.\n\nDisplay of Attribution Information is required in Larger Works which are defined \nin the CPAL as a work which combines Covered Code or portions thereof with code \nnot governed by the terms of the CPAL.\n\n*/\n\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n\n/*\n\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\n\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) {\n      alert(\"Main SocialCalc code module needed\");\n      SocialCalc = {};\n      }\n   if (!SocialCalc.TableEditor) {\n      alert(\"SocialCalc TableEditor code module needed\");\n      }\n\n// *************************************\n//\n// SpreadsheetControl class:\n//\n// *************************************\n\n// Global constants:\n\n   SocialCalc.CurrentSpreadsheetControlObject = null; // right now there can only be one active at a time\n\n\n// Constructor:\n\nSocialCalc.SpreadsheetControl = function(idPrefix) {\n\n   var scc = SocialCalc.Constants;\n\n   // Properties:\n\n   this.parentNode = null;\n   this.spreadsheetDiv = null;\n   this.requestedHeight = 0;\n   this.requestedWidth = 0;\n   this.requestedSpaceBelow = 0;\n   this.height = 0;\n   this.width = 0;\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\n\n   // Tab definitions: An array where each tab is an object of the form:\n   //\n   //    name: \"name\",\n   //    text: \"text-on-tab\",\n   //    html: \"html-to-create div\",\n   //       replacements:\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext\n   //         Other replacements from spreadsheet.tabreplacements:\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\n   //    view: \"viewname\", // view to show when selected; \"sheet\" or missing/null is spreadsheet\n   //    oncreate: function(spreadsheet, tab-name), // called when first created to initialize\n   //    onclick: function(spreadsheet, tab-name), missing/null is sheet default\n   //    onclickFocus: text, // spreadsheet.idPrefix+text is given the focus if present instead of normal KeyboardFocus\n   //       or if text isn't a string, that value (e.g., true) is used for SocialCalc.CmdGotFocus\n   //    onunclick: function(spreadsheet, tab-name), missing/null is sheet default\n\n   this.tabs = [];\n   this.tabnums = {}; // when adding tabs, add tab-name: array-index to this object\n   this.tabreplacements = {}; // see use above\n   this.currentTab = -1; // currently selected tab index in this.tabs or -1 (maintained by SocialCalc.SetTab)\n\n   // View definitions: An object where each view is an object of the form:\n   //\n   //    name: \"name\", // localized when first set using SocialCalc.LocalizeString\n   //    element: node-in-the-dom, // filled in when initialized\n   //    replacements: {}, // see below\n   //    html: \"html-to-create div\",\n   //       replacements:\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext, \"%img.\": spreadsheet.imagePrefix,\n   //         SocialCalc.LocalizeSubstring replacements (\"%loc!string!\" and \"%ssc!constant-name!\")\n   //         Other replacements from viewobject.replacements:\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\n   //    divStyle: attributes for sheet div (SocialCalc.setStyles format)\n   //    oncreate: function(spreadsheet, viewobject), // called when first created to initialize\n   //    needsresize: true/false/null, // if true, do resize calc after displaying\n   //    onresize: function(spreadsheet, viewobject), // called if needs resize\n   //    values: {} // optional values to share with onclick handlers, etc.\n   //\n   // There is always a \"sheet\" view.\n\n   this.views = {}; // {viewname: view-object, ...}\n\n   // Dynamic properties:\n\n   this.sheet = null;\n   this.context = null;\n   this.editor = null;\n\n   this.spreadsheetDiv = null;\n   this.editorDiv = null;\n\n   this.sortrange = \"\"; // remembered range for sort tab\n\n   this.moverange = \"\"; // remembered range from movefrom used by movepaste/moveinsert\n\n   // Constants:\n\n   this.idPrefix = idPrefix || \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\n   this.multipartBoundary = \"SocialCalcSpreadsheetControlSave\"; // boundary used by SpreadsheetControlCreateSpreadsheetSave\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\n\n   this.toolbarbackground = scc.SCToolbarbackground;\n   this.tabbackground = scc.SCTabbackground; // \"background-color:#CCC;\";\n   this.tabselectedCSS = scc.SCTabselectedCSS;\n   this.tabplainCSS = scc.SCTabplainCSS;\n   this.toolbartext = scc.SCToolbartext;\n\n   this.formulabarheight = scc.SCFormulabarheight; // in pixels, will contain a text input box\n\n   this.statuslineheight = scc.SCStatuslineheight; // in pixels\n   this.statuslineCSS = scc.SCStatuslineCSS;\n\n   // Callbacks:\n\n   this.ExportCallback = null; // a function called for Clipboard Export button: this.ExportCallback(spreadsheet_control_object)\n\n   // Initialization Code:\n\n   // eddy Initialization {\n   if(typeof SocialCalc.debug_log === 'undefined') SocialCalc.debug_log = [];   \n   // }   \n   \n   this.sheet = new SocialCalc.Sheet();\n   this.context = new SocialCalc.RenderContext(this.sheet);\n   this.context.showGrid=true;\n   this.context.showRCHeaders=true;\n   this.editor = new SocialCalc.TableEditor(this.context);\n   this.editor.StatusCallback.statusline =\n      {func: SocialCalc.SpreadsheetControlStatuslineCallback,\n       params: {statuslineid: this.idPrefix+\"statusline\",\n                recalcid1: this.idPrefix+\"divider_recalc\",\n                recalcid2: this.idPrefix+\"button_recalc\"}};\n\n   SocialCalc.CurrentSpreadsheetControlObject = this; // remember this for rendezvousing on events\n\n   this.editor.MoveECellCallback.movefrom = function(editor) {\n      var cr;\n      var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n      spreadsheet.context.cursorsuffix = \"\";\n      if (editor.range2.hasrange && !editor.cellhandles.noCursorSuffix) {\n         if (editor.ecell.row==editor.range2.top && (editor.ecell.col<editor.range2.left || editor.ecell.col>editor.range2.right+1)) {\n            spreadsheet.context.cursorsuffix = \"insertleft\";\n            }\n         if (editor.ecell.col==editor.range2.left && (editor.ecell.row<editor.range2.top || editor.ecell.row>editor.range2.bottom+1)) {\n            spreadsheet.context.cursorsuffix = \"insertup\";\n            }\n         }\n      };\n\n   // formula bar buttons\n\n   this.formulabuttons = {\n      formulafunctions: {image: \"insertformula.png\", tooltip: \"Functions\", // tooltips are localized when set below\n                         command: SocialCalc.SpreadsheetControl.DoFunctionList},\n      multilineinput: {image: \"listbox.png\", tooltip: \"Multi-line Input Box\",\n                         command: SocialCalc.SpreadsheetControl.DoMultiline},\n      link: {image: \"inserthyperlink.png\", tooltip: \"Link Input Box\",\n                         command: SocialCalc.SpreadsheetControl.DoLink},\n      sum: {image: \"autosum.png\", tooltip: \"Auto Sum\",\n                         command: SocialCalc.SpreadsheetControl.DoSum}\n      }\n   \n   // find buttons\n   this.findbuttons = {\n       last: {image: 'upsearch.png', tooltip: 'Find Previous',\n              command: SocialCalc.SpreadsheetControl.SearchUp},\n       next: {image: 'downsearch.png', tooltip: 'Find Next', \n              command: SocialCalc.SpreadsheetControl.SearchDown}\n   }\n\n   // Default tabs:\n\n   // Edit\n\n   this.tabnums.edit = this.tabs.length;\n   this.tabs.push({name: \"edit\", text: \"Edit\", html:\n      ' <div id=\"%id.edittools\">'+\n'&nbsp;<img id=\"%id.button_undo\" src=\"%img.undo.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_redo\" src=\"%img.redo.png\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_copy\" src=\"%img.copy.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_cut\" src=\"%img.cut.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_paste\" src=\"%img.paste.png\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_delete\" src=\"%img.delete.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_pasteformats\" src=\"%img.formatpaintbrush.png\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n' <span id=\"%id.locktools\"><img id=\"%id.button_lock\" src=\"%img.lock.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_unlock\" src=\"%img.unlock.png\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp;</span> '+\n'<img id=\"%id.button_filldown\" src=\"%img.filldown.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_fillright\" src=\"%img.fillright.png\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_movefrom\" src=\"%img.movefromoff.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_movepaste\" src=\"%img.movepasteoff.gif\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_moveinsert\" src=\"%img.moveinsertoff.gif\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_alignleft\" src=\"%img.alignleft.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_aligncenter\" src=\"%img.aligncenter.png\" style=\"vertical-align:bottom;\">'+\n' <img id=\"%id.button_alignright\" src=\"%img.alignright.png\" style=\"vertical-align:bottom;\">'+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_borderon\" src=\"%img.borderson.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_borderoff\" src=\"%img.bordersoff.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_swapcolors\" src=\"%img.swapcolors.png\" style=\"vertical-align:bottom;\"> '+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_merge\" src=\"%img.mergecells.png\" style=\"vertical-align:bottom;\"> '+\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_insertrow\" src=\"%img.insertrows.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_insertcol\" src=\"%img.insertcolumns.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_deleterow\" src=\"%img.deleterows.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_deletecol\" src=\"%img.deletecolumns.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_hiderow\" src=\"%img.hiderow.png\" style=\"vertical-align:bottom;\"> '+\n' <img id=\"%id.button_hidecol\" src=\"%img.hidecol.png\" style=\"vertical-align:bottom;\"> '+\n' &nbsp;<img id=\"%id.divider_recalc\" src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\n'<img id=\"%id.button_recalc\" src=\"%img.recalc.png\" style=\"vertical-align:bottom;\"> '+\n      ' </div>',\n      oncreate: null, //function(spreadsheet, viewobject) {SocialCalc.DoCmd(null, \"fill-rowcolstuff\");},\n      onclick: null});\n\n   // Settings (Format)\n\n   this.tabnums.settings = this.tabs.length;\n   this.tabs.push({name: \"settings\", text: \"Format\", html:\n      '<div id=\"%id.settingstools\" style=\"display:none;\">'+\n      ' <div id=\"%id.sheetsettingstoolbar\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\n      '   <div style=\"%tbt.\">%loc!SHEET SETTINGS!:</div>'+\n      '   </td></tr><tr><td>'+\n      '   <input id=\"%id.settings-savesheet\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'sheet\\');\">'+\n      '   <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\n      '   <input type=\"button\" value=\"%loc!Show Cell Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'cell\\');return false;\">'+\n      '   </td></tr></table>'+\n      ' </div>'+\n      ' <div id=\"%id.cellsettingstoolbar\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\n      '   <div style=\"%tbt.\">%loc!CELL SETTINGS!: <span id=\"%id.settingsecell\">&nbsp;</span></div>'+\n      '   </td></tr><tr><td>'+\n      '  <input id=\"%id.settings-savecell\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'cell\\');\">'+\n      '  <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\n      '  <input type=\"button\" value=\"%loc!Show Sheet Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'sheet\\');return false;\">'+\n      '  </td></tr></table>'+\n      ' </div>'+\n      '</div>',\n      view: \"settings\",\n      onclick: function(s, t) {\n         SocialCalc.SettingsControls.idPrefix = s.idPrefix; // used to get color chooser div\n         SocialCalc.SettingControlReset();\n         var sheetattribs = s.sheet.EncodeSheetAttributes();\n         var cellattribs = s.sheet.EncodeCellAttributes(s.editor.ecell.coord);\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.sheetspanel, sheetattribs);\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.cellspanel, cellattribs);\n         document.getElementById(s.idPrefix+\"settingsecell\").innerHTML = s.editor.ecell.coord;\n         SocialCalc.SpreadsheetControlSettingsSwitch(\"cell\");\n         s.views.settings.element.style.height = s.viewheight+\"px\";\n         s.views.settings.element.firstChild.style.height = s.viewheight+\"px\";\n\n         var range;  // set save message\n         if (s.editor.range.hasrange) {\n            range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\n               SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\n            }\n         else {\n            range = s.editor.ecell.coord;\n            }\n         document.getElementById(s.idPrefix+\"settings-savecell\").value = SocialCalc.LocalizeString(\"Save to\")+\": \"+range;\n         },\n      onclickFocus: true\n         });\n\n   this.views[\"settings\"] = {name: \"settings\", values: {},\n      oncreate: function(s, viewobj) {\n         var scc = SocialCalc.Constants;\n\n         viewobj.values.sheetspanel = {\n//            name: \"sheet\",\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\n            formatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"formatnumber\",\n               initialdata: scc.SCFormatNumberFormats},\n            formattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"formattext\",\n               initialdata: scc.SCFormatTextFormats},\n            fontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"fontfamily\",\n               initialdata: scc.SCFormatFontfamilies},\n            fontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"fontlook\",\n               initialdata: scc.SCFormatFontlook},\n            fontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"fontsize\",\n               initialdata: scc.SCFormatFontsizes},\n            textalignhoriz: {setting: \"textalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"textalignhoriz\",\n               initialdata: scc.SCFormatTextAlignhoriz},\n            numberalignhoriz: {setting: \"numberalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"numberalignhoriz\",\n               initialdata: scc.SCFormatNumberAlignhoriz},\n            alignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"alignvert\",\n               initialdata: scc.SCFormatAlignVertical},\n            textcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"textcolor\"},\n            bgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"bgcolor\"},\n            padtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"padtop\",\n               initialdata: scc.SCFormatPadsizes},\n            padright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"padright\",\n               initialdata: scc.SCFormatPadsizes},\n            padbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"padbottom\",\n               initialdata: scc.SCFormatPadsizes},\n            padleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"padleft\",\n               initialdata: scc.SCFormatPadsizes},\n            colwidth: {setting: \"colwidth\", type: \"PopupList\", id: s.idPrefix+\"colwidth\",\n               initialdata: scc.SCFormatColwidth},\n            recalc: {setting: \"recalc\", type: \"PopupList\", id: s.idPrefix+\"recalc\",\n               initialdata: scc.SCFormatRecalc},\n            usermaxcol: {setting: \"usermaxcol\", type: \"PopupList\", id: s.idPrefix+\"usermaxcol\",\n               initialdata: scc.SCFormatUserMaxCol},\n            usermaxrow: {setting: \"usermaxrow\", type: \"PopupList\", id: s.idPrefix+\"usermaxrow\",\n               initialdata: scc.SCFormatUserMaxRow}\n\n            };\n         viewobj.values.cellspanel = {\n            name: \"cell\",\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\n            cformatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"cformatnumber\",\n               initialdata: scc.SCFormatNumberFormats},\n            cformattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"cformattext\",\n               initialdata: scc.SCFormatTextFormats},\n            cfontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"cfontfamily\",\n               initialdata: scc.SCFormatFontfamilies},\n            cfontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"cfontlook\",\n               initialdata: scc.SCFormatFontlook},\n            cfontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"cfontsize\",\n               initialdata: scc.SCFormatFontsizes},\n            calignhoriz: {setting: \"alignhoriz\", type: \"PopupList\", id: s.idPrefix+\"calignhoriz\",\n               initialdata: scc.SCFormatTextAlignhoriz},\n            calignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"calignvert\",\n               initialdata: scc.SCFormatAlignVertical},\n            ctextcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"ctextcolor\"},\n            cbgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"cbgcolor\"},\n            cbt: {setting: \"bt\", type: \"BorderSide\", id: s.idPrefix+\"cbt\"},\n            cbr: {setting: \"br\", type: \"BorderSide\", id: s.idPrefix+\"cbr\"},\n            cbb: {setting: \"bb\", type: \"BorderSide\", id: s.idPrefix+\"cbb\"},\n            cbl: {setting: \"bl\", type: \"BorderSide\", id: s.idPrefix+\"cbl\"},\n            cpadtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"cpadtop\",\n               initialdata: scc.SCFormatPadsizes},\n            cpadright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"cpadright\",\n               initialdata: scc.SCFormatPadsizes},\n            cpadbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"cpadbottom\",\n               initialdata: scc.SCFormatPadsizes},\n            cpadleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"cpadleft\",\n               initialdata: scc.SCFormatPadsizes}\n            };\n\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.sheetspanel);\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.cellspanel);\n         },\n      replacements: {\n         itemtitle: {regex: /\\%itemtitle\\./g, replacement: 'style=\"padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;\"'},\n         sectiontitle: {regex: /\\%sectiontitle\\./g, replacement: 'style=\"padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;\"'},\n         parttitle: {regex: /\\%parttitle\\./g, replacement: 'style=\"font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;\"'},\n         itembody: {regex: /\\%itembody\\./g, replacement: 'style=\"padding:12px 0px 0px 0px;vertical-align:top;font-size:small;\"'},\n         bodypart: {regex: /\\%bodypart\\./g, replacement: 'style=\"padding:0px 10px 0px 0px;font-size:small;vertical-align:top;\"'}\n         },\n      divStyle: \"border:1px solid black;overflow:auto;\",\n      html:\n '<div id=\"%id.scolorchooser\" style=\"display:none;position:absolute;z-index:20;\"></div>'+\n'<table cellspacing=\"0\" cellpadding=\"0\">'+\n' <tr><td style=\"vertical-align:top;\">'+\n'<table id=\"%id.sheetsettingstable\" style=\"display:none;\" cellspacing=\"0\" cellpadding=\"0\">'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Format!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Number!</div>'+\n'     <span id=\"%id.formatnumber\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Text!</div>'+\n'     <span id=\"%id.formattext\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Alignment!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Text Horizontal!</div>'+\n'     <span id=\"%id.textalignhoriz\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Number Horizontal!</div>'+\n'     <span id=\"%id.numberalignhoriz\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Vertical!</div>'+\n'     <span id=\"%id.alignvert\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Font!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Family!</div>'+\n'     <span id=\"%id.fontfamily\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\n'     <span id=\"%id.fontlook\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Size!</div>'+\n'     <span id=\"%id.fontsize\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Color!</div>'+\n'     <div id=\"%id.textcolor\"></div>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Background!</div>'+\n'     <div id=\"%id.bgcolor\"></div>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Padding!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Top!</div>'+\n'     <span id=\"%id.padtop\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Right!</div>'+\n'     <span id=\"%id.padright\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bottom!</div>'+\n'     <span id=\"%id.padbottom\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Left!</div>'+\n'     <span id=\"%id.padleft\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Default Column Width!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>&nbsp;</div>'+\n'     <span id=\"%id.colwidth\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Recalculation!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>&nbsp;</div>'+\n'     <span id=\"%id.recalc\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Dimensions!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Columns!</div>'+\n'     <span id=\"%id.usermaxcol\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Rows!</div>'+\n'     <span id=\"%id.usermaxrow\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'</table>'+\n'<table id=\"%id.cellsettingstable\" cellspacing=\"0\" cellpadding=\"0\">'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Format!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Number!</div>'+\n'     <span id=\"%id.cformatnumber\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Text!</div>'+\n'     <span id=\"%id.cformattext\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Alignment!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Horizontal!</div>'+\n'     <span id=\"%id.calignhoriz\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Vertical!</div>'+\n'     <span id=\"%id.calignvert\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Font!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Family!</div>'+\n'     <span id=\"%id.cfontfamily\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\n'     <span id=\"%id.cfontlook\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Size!</div>'+\n'     <span id=\"%id.cfontsize\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Color!</div>'+\n'     <div id=\"%id.ctextcolor\"></div>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Background!</div>'+\n'     <div id=\"%id.cbgcolor\"></div>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Borders!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\">'+\n'    <tr><td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Top Border!</div></td>'+\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Right Border!</div></td>'+\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Bottom Border!</div></td>'+\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Left Border!</div></td>'+\n'    </tr><tr>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbt-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbt-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbr-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbr-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbb-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbb-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'    <td %bodypart.>'+\n'     <input id=\"%id.cbl-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div id=\"%id.cbl-color\"></div>'+\n'    </td>'+\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'<tr>'+\n' <td %itemtitle.><br>%loc!Padding!:</td>'+\n' <td %itembody.>'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Top!</div>'+\n'     <span id=\"%id.cpadtop\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Right!</div>'+\n'     <span id=\"%id.cpadright\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Bottom!</div>'+\n'     <span id=\"%id.cpadbottom\"></span>'+\n'    </td>'+\n'    <td %bodypart.>'+\n'     <div %parttitle.>%loc!Left!</div>'+\n'     <span id=\"%id.cpadleft\"></span>'+\n'    </td>'+\n'   </tr></table>'+\n' </td>'+\n'</tr>'+\n'</table>'+\n' </td><td style=\"vertical-align:top;padding:12px 0px 0px 12px;\">'+\n'  <div style=\"width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;\">'+\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n'    <td id=\"sample-text\" style=\"height:100px;width:100px;\"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>'+\n'   </tr></table>'+\n'  </div>'+\n' </td></tr></table>'+\n'<br>'\n      };\n\n   // Sort\n\n   this.tabnums.sort = this.tabs.length;\n   this.tabs.push({name: \"sort\", text: \"Sort\", html:\n      ' <div id=\"%id.sorttools\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '   <td style=\"vertical-align:top;padding-right:4px;width:160px;\">'+\n      '    <div style=\"%tbt.\">%loc!Set Cells To Sort!</div>'+\n      '    <select id=\"%id.sortlist\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[select range]</option><option value=\"all\">Sort All</option></select>'+\n      '    <input type=\"button\" value=\"%loc!OK!\" onclick=\"%s.DoCmd(this, \\'ok-setsort\\');\" style=\"font-size:x-small;\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:middle;padding-right:16px;width:100px;text-align:right;\">'+\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\n      '    <input type=\"button\" id=\"%id.sortbutton\" value=\"%loc!Sort Cells! A1:A1\" onclick=\"%s.DoCmd(this, \\'dosort\\');\" style=\"visibility:hidden;\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '     <td style=\"vertical-align:top;\">'+\n      '      <div style=\"%tbt.\">%loc!Major Sort!</div>'+\n      '      <select id=\"%id.majorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\n      '     </td><td>'+\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\n      '     </td>'+\n      '    </tr></table>'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '     <td style=\"vertical-align:top;\">'+\n      '      <div style=\"%tbt.\">%loc!Minor Sort!</div>'+\n      '      <select id=\"%id.minorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\n      '     </td><td>'+\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\n      '     </td>'+\n      '    </tr></table>'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '     <td style=\"vertical-align:top;\">'+\n      '      <div style=\"%tbt.\">%loc!Last Sort!</div>'+\n      '      <select id=\"%id.lastsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\n      '     </td><td>'+\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\n      '     </td>'+\n      '    </tr></table>'+\n      '   </td>'+\n      '  </tr></table>'+\n      ' </div>',\n      onclick: SocialCalc.SpreadsheetControlSortOnclick});\n   this.editor.SettingsCallbacks.sort = {save: SocialCalc.SpreadsheetControlSortSave, load: SocialCalc.SpreadsheetControlSortLoad};\n\n   // Audit\n\n   this.tabnums.audit = this.tabs.length;\n   this.tabs.push({name: \"audit\", text: \"Audit\", html:\n      '<div id=\"%id.audittools\" style=\"display:none;\">'+\n      ' <div style=\"%tbt.\">&nbsp;</div>'+\n      '</div>',\n      view: \"audit\",\n      onclick:\n         function(s, t) {\n            var SCLoc = SocialCalc.LocalizeString;\n            var i, j;\n            var str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"margin-bottom:10px;\"><tr><td style=\"font-size:small;padding:6px;\"><b>'+SCLoc(\"Audit Trail This Session\")+':</b><br><br>';\n            var stack = s.sheet.changes.stack;\n            var tos = s.sheet.changes.tos;\n            for (i=0; i<stack.length; i++) {\n               if (i==tos+1) str += '<br></td></tr><tr><td style=\"font-size:small;background-color:#EEE;padding:6px;\">'+SCLoc(\"UNDONE STEPS\")+':<br>';\n               for (j=0; j<stack[i].command.length; j++) {\n                  str += SocialCalc.special_chars(stack[i].command[j]) + \"<br>\";\n                  }\n               }\n\t\t\t// --------------------------------------------   \n \t\t    // eddy log {\n\n\t\t\t// --------------------------------------------   \n\t\t\tvar ObjToSource = function(o){\n\t\t\t\tif (typeof(o) == \"string\") return o;\n\t\t\t\tif (!o) return 'null';\n\t\t\t\tif (typeof(o) == \"object\") {\n\t\t\t\t\tif (!ObjToSource.check) ObjToSource.check = new Array();\n\t\t\t\t\tfor (var i=0, k=ObjToSource.check.length ; i<k ; ++i) {\n\t\t\t\t\t\tif (ObjToSource.check[i] == o) {return '{}';}\n\t\t\t\t\t}\n\t\t\t\t\tObjToSource.check.push(o);\n\t\t\t\t}\n\t\t\t\tvar k=\"\",na=typeof(o.length)==\"undefined\"?1:0,str=\"\";\n\t\t\t\tfor(var p in o){\n\t\t\t\t\tif (na) k = \"'\"+p+ \"':\";\n\t\t\t\t\tif (typeof o[p] == \"string\") str += k + \"'\" + o[p]+\"',\";\n\t\t\t\t\telse if (typeof o[p] == \"object\") str += k + ObjToSource(o[p])+\",\";\n\t\t\t\t\telse str += k + o[p] + \",\";\n\t\t\t\t}\n\t\t\t\tif (typeof(o) == \"object\") ObjToSource.check.pop();\n\t\t\t\tif (na) return \"{\"+str.slice(0,-1)+\"}\";\n\t\t\t\telse return \"[\"+str.slice(0,-1)+\"]\";\n\t\t\t}\n\t\t\t\n\t\t\t// --------------------------------------------   \n\t\t\t\n\t\t    if(typeof SocialCalc.debug_log != 'undefined') {\n\t\t\t\tfor(var index in SocialCalc.debug_log) { \n\t\t\t\t\tstr += ObjToSource(SocialCalc.debug_log[index]) + \"<br>\";\n\t\t\t\t}\n\t\t\t}\n\t\t    // }   \n\t\t\t// --------------------------------------------   \n\t\t\t   \n            s.views.audit.element.innerHTML = str+\"</td></tr></table>\";\n            SocialCalc.CmdGotFocus(true);\n            },\n      onclickFocus: true\n         });\n\n   this.views[\"audit\"] = {name: \"audit\",\n      divStyle: \"border:1px solid black;overflow:auto;\",\n      html: 'Audit Trail'\n      };\n\n   // Comment\n\n   this.tabnums.comment = this.tabs.length;\n   this.tabs.push({name: \"comment\", text: \"Comment\", html:\n      '<div id=\"%id.commenttools\" style=\"display:none;\">'+\n      '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\n      '<textarea id=\"%id.commenttext\" style=\"font-size:small;height:32px;width:600px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'+\n      '</td><td style=\"vertical-align:top;\">'+\n      '&nbsp;<input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlCommentSet();\" style=\"font-size:x-small;\">'+\n      '</td></tr></table>'+\n      '</div>',\n      view: \"sheet\",\n      onclick: SocialCalc.SpreadsheetControlCommentOnclick,\n      onunclick: SocialCalc.SpreadsheetControlCommentOnunclick\n      });\n\n   // Names\n\n   this.tabnums.names = this.tabs.length;\n   this.tabs.push({name: \"names\", text: \"Names\", html:\n      '<div id=\"%id.namestools\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\n      '    <div style=\"%tbt.\">%loc!Existing Names!</div>'+\n      '    <select id=\"%id.nameslist\" size=\"1\" onchange=\"%s.SpreadsheetControlNamesChangedName();\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[New]</option></select>'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">%loc!Name!</div>'+\n      '    <input type=\"text\" id=\"%id.namesname\" style=\"font-size:x-small;width:75px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">%loc!Description!</div>'+\n      '    <input type=\"text\" id=\"%id.namesdesc\" style=\"font-size:x-small;width:150px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">%loc!Value!</div>'+\n      '    <input type=\"text\" id=\"%id.namesvalue\" width=\"16\" style=\"font-size:x-small;width:100px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:12px;width:100px;\">'+\n      '    <div style=\"%tbt.\">%loc!Set Value To!</div>'+\n      '    <input type=\"button\" id=\"%id.namesrangeproposal\" value=\"A1\" onclick=\"%s.SpreadsheetControlNamesSetValue();\" style=\"font-size:x-small;\">'+\n      '   </td>'+\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\n      '    <input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlNamesSave();\" style=\"font-size:x-small;\">'+\n      '    <input type=\"button\" value=\"%loc!Delete!\" onclick=\"%s.SpreadsheetControlNamesDelete()\" style=\"font-size:x-small;\">'+\n      '   </td>'+\n      '  </tr></table>'+\n      '</div>',\n      view: \"sheet\",\n      onclick: SocialCalc.SpreadsheetControlNamesOnclick,\n      onunclick: SocialCalc.SpreadsheetControlNamesOnunclick\n      });\n\n   // Clipboard\n\n   this.tabnums.clipboard = this.tabs.length;\n   this.tabs.push({name: \"clipboard\", text: \"Clipboard\", html:\n      '<div id=\"%id.clipboardtools\" style=\"display:none;\">'+\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\n      '    <div style=\"%tbt.\">'+\n      '     &nbsp;'+\n      '    </div>'+\n      '   </td>'+\n      '  </tr></table>'+\n      '</div>',\n      view: \"clipboard\",\n      onclick: SocialCalc.SpreadsheetControlClipboardOnclick,\n      onclickFocus: \"clipboardtext\"\n      });\n\n   this.views[\"clipboard\"] = {name: \"clipboard\", divStyle: \"overflow:auto;\", html:\n      ' <div style=\"font-size:x-small;padding:5px 0px 10px 0px;\">'+\n      '  <b>%loc!Display Clipboard in!:</b>'+\n      '  <input type=\"radio\" id=\"%id.clipboardformat-tab\" name=\"%id.clipboardformat\" checked onclick=\"%s.SpreadsheetControlClipboardFormat(\\'tab\\');\"> %loc!Tab-delimited format! &nbsp;'+\n      '  <input type=\"radio\" id=\"%id.clipboardformat-csv\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'csv\\');\"> %loc!CSV format! &nbsp;'+\n      '  <input type=\"radio\" id=\"%id.clipboardformat-scsave\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'scsave\\');\"> %loc!SocialCalc-save format!'+\n      ' </div>'+\n      ' <input type=\"button\" value=\"%loc!Load SocialCalc Clipboard With This!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardLoad();\">&nbsp; '+\n      ' <input type=\"button\" value=\"%loc!Clear SocialCalc Clipboard!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardClear();\">&nbsp; '+\n      ' <br>'+\n      ' <textarea id=\"%id.clipboardtext\" style=\"font-size:small;height:350px;width:800px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'\n      };\n\n   return;\n\n   }\n\n   \n// Methods:\n\nSocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl =\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetControl(this, node, height, width, spacebelow);};\nSocialCalc.SpreadsheetControl.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\nSocialCalc.SpreadsheetControl.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\nSocialCalc.SpreadsheetControl.prototype.ExecuteCommand = \n   function(combostr, sstr) {return SocialCalc.SpreadsheetControlExecuteCommand(this, combostr, sstr);};\nSocialCalc.SpreadsheetControl.prototype.CreateSheetHTML = \n   function() {return SocialCalc.SpreadsheetControlCreateSheetHTML(this);};\nSocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave = \n   function(otherparts) {return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this, otherparts);};\nSocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave = \n   function(str) {return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this, str);};\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTML = \n   function(coord) {return SocialCalc.SpreadsheetControlCreateCellHTML(this, coord);};\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave = \n   function(range) {return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this, range);};\n\n\n// Sheet Methods to make things a little easier:\n\nSocialCalc.SpreadsheetControl.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\nSocialCalc.SpreadsheetControl.prototype.CreateSheetSave = function() {return this.sheet.CreateSheetSave();};\n\n\n// Functions:\n\n//\n// InitializeSpreadsheetControl(spreadsheet, node, height, width, spacebelow)\n//\n// Creates the control elements and makes them the child of node (string or element).\n// If present, height and width specify size.\n// If either is 0 or null (missing), the maximum that fits on the screen\n// (taking spacebelow into account) is used.\n//\n// Displays the tabs and creates the views (other than \"sheet\").\n// The first tab is set as selected, but onclick is not invoked.\n//\n// You should do a redisplay or recalc (which redisplays) after running this.\n//\n\nSocialCalc.InitializeSpreadsheetControl = function(spreadsheet, node, height, width, spacebelow) {\n\n   var scc = SocialCalc.Constants;\n   var SCLoc = SocialCalc.LocalizeString;\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\n\n   var html, child, i, vname, v, style, button, bele;\n   var tabs = spreadsheet.tabs;\n   var views = spreadsheet.views;\n\n   spreadsheet.requestedHeight = height;\n   spreadsheet.requestedWidth = width;\n   spreadsheet.requestedSpaceBelow = spacebelow;\n\n   if (typeof node == \"string\") node = document.getElementById(node);\n\n   if (node == null) {\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\n      }\n\n   spreadsheet.parentNode = node;\n\n   // create node to hold spreadsheet control\n\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\n\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\n\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\n      node.removeChild(child);\n      }\n\n   // create the tabbed UI at the top\n\n   html = '<div>'\n   html += '<div style=\"'+spreadsheet.tabbackground+'\">'+\n      '<table cellpadding=\"0\" cellspacing=\"0\"><tr>';\n\n   for (i=0; i<tabs.length; i++) {\n      html += '  <td id=\"%id.' + tabs[i].name + 'tab\" style=\"' +\n         (i==0 ? spreadsheet.tabselectedCSS : spreadsheet.tabplainCSS) +\n         '\" onclick=\"%s.SetTab(this);\">' + SCLoc(tabs[i].text) + '</td>';\n      }\n\n   html += ' </tr></table></div>'\n   html += '<div style=\"'+spreadsheet.toolbarbackground+'padding:12px 10px 10px 4px;\">';\n\n   for (i=0; i<tabs.length; i++) {\n      html += tabs[i].html;\n      }\n\n   html += '</div>'\n   html += '</div>';\n\n   spreadsheet.currentTab = 0; // this is where we started\n\n   for (style in spreadsheet.tabreplacements) {\n      html = html.replace(spreadsheet.tabreplacements[style].regex, spreadsheet.tabreplacements[style].replacement);\n      }\n   html = html.replace(/\\%s\\./g, \"SocialCalc.\");\n   html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\n   html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\n   html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\n\n   html = SCLocSS(html); // localize with %loc!string! and %scc!constant!\n\n   spreadsheet.spreadsheetDiv.innerHTML = html;\n\n   node.appendChild(spreadsheet.spreadsheetDiv);\n\n   // Initialize SocialCalc buttons\n\nspreadsheet.Buttons = {\n   button_undo: {tooltip: \"Undo\", command: \"undo\"},\n   button_redo: {tooltip: \"Redo\", command: \"redo\"},\n   button_copy: {tooltip: \"Copy\", command: \"copy\"},\n   button_cut: {tooltip: \"Cut\", command: \"cut\"},\n   button_paste: {tooltip: \"Paste\", command: \"paste\"},\n   button_pasteformats: {tooltip: \"Paste Formats\", command: \"pasteformats\"},\n   button_lock: {tooltip: \"Lock Cell\", command: \"lock\"},\n   button_unlock: {tooltip: \"Unlock Cell\", command: \"unlock\"},\n   button_delete: {tooltip: \"Delete Cell Contents\", command: \"delete\"},\n   button_filldown: {tooltip: \"Fill Down\", command: \"filldown\"},\n   button_fillright: {tooltip: \"Fill Right\", command: \"fillright\"},\n   button_movefrom: {tooltip: \"Set/Clear Move From\", command: \"movefrom\"},\n   button_movepaste: {tooltip: \"Move Paste\", command: \"movepaste\"},\n   button_moveinsert: {tooltip: \"Move Insert\", command: \"moveinsert\"},\n   button_alignleft: {tooltip: \"Align Left\", command: \"align-left\"},\n   button_aligncenter: {tooltip: \"Align Center\", command: \"align-center\"},\n   button_alignright: {tooltip: \"Align Right\", command: \"align-right\"},\n   button_borderon: {tooltip: \"Borders On\", command: \"borderon\"},\n   button_borderoff: {tooltip: \"Borders Off\", command: \"borderoff\"},\n   button_swapcolors: {tooltip: \"Swap Colors\", command: \"swapcolors\"},\n   button_merge: {tooltip: \"Merge/Unmerge Cells\", command: \"merge\"},\n   button_insertrow: {tooltip: \"Insert Row Before\", command: \"insertrow\"},\n   button_insertcol: {tooltip: \"Insert Column Before\", command: \"insertcol\"},\n   button_deleterow: {tooltip: \"Delete Row\", command: \"deleterow\"},\n   button_deletecol: {tooltip: \"Delete Column\", command: \"deletecol\"},\n   button_hiderow: {tooltip: \"Hide Row\", command: \"hiderow\"},\n   button_hidecol: {tooltip: \"Hide Column\", command: \"hidecol\"},\n   button_recalc: {tooltip: \"Recalculate\", command: \"recalc\"}\n   }\n\n   for (button in spreadsheet.Buttons) {\n      bele = document.getElementById(spreadsheet.idPrefix+button);\n      if (!bele) {alert(\"Button \"+(spreadsheet.idPrefix+button)+\" missing\"); continue;}\n      bele.style.border = \"1px solid \"+scc.ISCButtonBorderNormal;\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.Buttons[button].tooltip), {}, spreadsheet.spreadsheetDiv);\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\n         {normalstyle: \"border:1px solid \"+scc.ISCButtonBorderNormal+\";background-color:\"+scc.ISCButtonNormalBackground+\";\",\n          hoverstyle: \"border:1px solid \"+scc.ISCButtonBorderHover+\";background-color:\"+scc.ISCButtonHoverBackground+\";\",\n          downstyle: \"border:1px solid \"+scc.ISCButtonBorderDown+\";background-color:\"+scc.ISCButtonDownBackground+\";\"}, \n         {MouseDown: SocialCalc.DoButtonCmd, command: spreadsheet.Buttons[button].command});\n      }\n\n   // create formula bar\n\n   spreadsheet.formulabarDiv = document.createElement(\"div\");\n   //spreadsheet.formulabarDiv.style.height = spreadsheet.formulabarheight + \"px\"; // Allow line wrapping\n   spreadsheet.formulabarDiv.innerHTML = '<input type=\"text\" size=\"60\" value=\"\">&nbsp;'; //'<textarea rows=\"4\" cols=\"60\" style=\"z-index:5;background-color:white;position:relative;\"></textarea>&nbsp;';\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);\n   var inputbox = new SocialCalc.InputBox(spreadsheet.formulabarDiv.firstChild, spreadsheet.editor);\n   \n   for (button in spreadsheet.formulabuttons) {\n      bele = document.createElement(\"img\");\n      bele.id = spreadsheet.idPrefix+button;\n      bele.src = (spreadsheet.formulabuttons[button].skipImagePrefix ? \"\" : spreadsheet.imagePrefix)+spreadsheet.formulabuttons[button].image;\n      bele.style.verticalAlign = \"middle\";\n      bele.style.border = \"1px solid #FFF\";\n      bele.style.marginLeft = \"4px\";\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.formulabuttons[button].tooltip), {}, spreadsheet.spreadsheetDiv);\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \n         {MouseDown: spreadsheet.formulabuttons[button].command, Disabled: function() {return spreadsheet.editor.ECellReadonly();}});\n   spreadsheet.formulabarDiv.appendChild(bele);\n   }\n\n   var input = $(\"<input id='searchbarinput' value='' placeholder='Search sheet…'>\");\n   var searchBar = $(\"<span id='searchbar'></span>\");\n   searchBar.append(\"<div id='searchstatus'></div>\");\n   searchBar.append(input);\n\n   // find buttons (right of formula bar)\n   for (button in spreadsheet.findbuttons) {\n      bele = document.createElement(\"img\");\n      bele.id = spreadsheet.idPrefix+button;\n      bele.src = (spreadsheet.imagePrefix)+spreadsheet.findbuttons[button].image;\n      bele.style.verticalAlign = \"middle\";\n      bele.style.border = \"1px solid #FFF\";\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.findbuttons[button].tooltip), {}, spreadsheet.formulabardiv);\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \n         {MouseDown: spreadsheet.findbuttons[button].command, Disabled: function() {return false;}});\n      searchBar[0].appendChild(bele);\n   } \n   input.on('input', SocialCalc.SpreadsheetControl.FindInSheet);\n   input.on('focus', function() {\n        SocialCalc.Keyboard.passThru = true;\n   });\n   input.on('blur', function() {\n        SocialCalc.Keyboard.passThru = false;\n   });\n   input.keyup(function (e) {\n        if (e.keyCode == 13) {\n           // search down when enter is pressed\n           if (e.shiftKey) {\n               SocialCalc.SpreadsheetControl.SearchUp();\n           } else {\n               SocialCalc.SpreadsheetControl.SearchDown();\n           }\n        }\n   });\n   spreadsheet.formulabarDiv.appendChild(searchBar[0]);\n   \n   // initialize tabs that need it\n\n   for (i=0; i<tabs.length; i++) { // execute any tab-specific initialization code\n      if (tabs[i].oncreate) {\n         tabs[i].oncreate(spreadsheet, tabs[i].name);\n         }\n      }\n\n   // create sheet view and others\n\n   // InitializeSpreadsheetControl eddy {\n   SocialCalc.CalculateSheetNonViewHeight(spreadsheet);\n   // } InitializeSpreadsheetControl\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\n\n// eddy test add input \n   var appViewDiv = document.createElement(\"div\");\n   appViewDiv.id = \"te_appView\";\n   \n   appViewDiv.appendChild(spreadsheet.editorDiv)\n   spreadsheet.editorDiv = appViewDiv;\n\n   var formDataDiv = document.createElement(\"div\");\n   formDataDiv.id = \"te_formData\";\n   //formDataDiv.style.visibility = \"hidden\";\n   formDataDiv.style.display = \"none\";\n   //formDataDiv.style.display = \"inline\";\n   \n  // spreadsheet.spreadsheetDiv.appendChild(formDataDiv);   \n   spreadsheet.editorDiv.appendChild(formDataDiv);\n       \n// }\n      \n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\n\n// eddy test add input \n   spreadsheet.formDataViewer = new SocialCalc.SpreadsheetViewer(\"te_FormData-\"); // should end with -\n   spreadsheet.formDataViewer.InitializeSpreadsheetViewer(formDataDiv.id, 180, 0, 200);\n// end\n   \n   for (vname in views) {\n      html = views[vname].html;\n      for (style in views[vname].replacements) {\n         html = html.replace(views[vname].replacements[style].regex, views[vname].replacements[style].replacement);\n         }\n      html = html.replace(/\\%s\\./g, \"SocialCalc.\");\n      html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\n      html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\n      html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\n      v = document.createElement(\"div\");\n      SocialCalc.setStyles(v, views[vname].divStyle);\n      v.style.display = \"none\";\n      v.style.width = spreadsheet.width + \"px\";\n      v.style.height = spreadsheet.viewheight + \"px\";\n      v.id = spreadsheet.idPrefix + views[vname].name + \"view\";\n\n      html = SCLocSS(html); // localize with %loc!string!, etc.\n\n      v.innerHTML = html;\n      spreadsheet.spreadsheetDiv.appendChild(v);\n      views[vname].element = v;\n      if (views[vname].oncreate) {\n         views[vname].oncreate(spreadsheet, views[vname]);\n         }\n      }\n\n   views.sheet = {name: \"sheet\", element: spreadsheet.editorDiv};\n\n   // create statusline\n\n   spreadsheet.statuslineDiv = document.createElement(\"div\");\n   spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\n   spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\n      (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\n      (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\n   spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\n\n   // set current control object based on mouseover\n\n   if (spreadsheet.spreadsheetDiv.addEventListener) { // DOM Level 2 -- Firefox, et al\n      spreadsheet.spreadsheetDiv.addEventListener(\"mousedown\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); }, false);\n      spreadsheet.spreadsheetDiv.addEventListener(\"mouseover\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); }, false);\n      }\n   else if (spreadsheet.spreadsheetDiv.attachEvent) { // IE 5+\n      spreadsheet.spreadsheetDiv.attachEvent(\"onmousedown\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); });\n      spreadsheet.spreadsheetDiv.attachEvent(\"onmouseover\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); });\n      }\n   else { // don't handle this\n      throw SocialCalc.Constants.s_BrowserNotSupported;\n      }\n\n   // done - refresh screen needed\n\n   return;\n\n   }\n\n\n// eddy CalculateSheetNonViewHeight {\nSocialCalc.CalculateSheetNonViewHeight = function(spreadsheet) {\n  spreadsheet.nonviewheight = spreadsheet.statuslineheight;\n  for(var nodeIndex = 0;  nodeIndex < spreadsheet.spreadsheetDiv.childNodes.length;  nodeIndex++ ) {\n    if(spreadsheet.spreadsheetDiv.childNodes[nodeIndex].id == \"SocialCalc-statusline\") continue;\n    spreadsheet.nonviewheight += spreadsheet.spreadsheetDiv.childNodes[nodeIndex].offsetHeight;\n  }\n  \n}\n\n// }\n\n\n//\n// outstr = SocialCalc.LocalizeString(str)\n//\n// SocialCalc function to make localization easier.\n// If str is \"Text to localize\", it returns\n// SocialCalc.Constants.s_loc_text_to_localize if\n// it exists, or else with just \"Text to localize\".\n// Note that spaces are replaced with \"_\" and other special\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\n// would look for SocialCalc.Constants.s_loc_a_X_b.\n//\n\nSocialCalc.LocalizeString = function(str) {\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\n   if (!cstr) { // no - look up\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\n      SocialCalc.LocalizeStringList[str] = cstr;\n      }\n   return cstr;\n   }\n\n\n\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\n\n//\n// outstr = SocialCalc.LocalizeSubstrings(str)\n//\n// SocialCalc function to make localization easier using %loc and %scc.\n//\n// Replaces sections of str with:\n//    %loc!Text to localize!\n// with SocialCalc.Constants.s_loc_text_to_localize if\n// it exists, or else with just \"Text to localize\".\n// Note that spaces are replaced with \"_\" and other special\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\n// would look for SocialCalc.Constants.s_loc_a_X_b.\n// Uses SocialCalc.LocalizeString for this.\n//\n// Replaces sections of str with:\n//    %ssc!constant-name!\n// with SocialCalc.Constants.constant-name.\n// If the constant doesn't exist, throws and alert.\n//\n\nSocialCalc.LocalizeSubstrings = function(str) {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\n      if (t==\"ssc\") {\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\n         }\n      else {\n         return SCLoc(c);\n         }\n      });\n\n   }\n\n//\n// obj = GetSpreadsheetControlObject()\n//\n// Returns the current spreadsheet control object\n//\n\nSocialCalc.GetSpreadsheetControlObject = function() {\n\n   var csco = SocialCalc.CurrentSpreadsheetControlObject;\n   if (csco) return csco;\n\n//   throw (\"No current SpreadsheetControl object.\");\n\n   }\n\n//\n// SetSpreadsheetControlObject(spreadsheet)\n//\n\nSocialCalc.SetSpreadsheetControlObject = function(spreadsheet) {\n\n   SocialCalc.CurrentSpreadsheetControlObject = spreadsheet;\n\n   if (SocialCalc.Keyboard.focusTable && spreadsheet) {\n      SocialCalc.Keyboard.focusTable = spreadsheet.editor;\n      }\n\n   }\n\n\n//\n// SocialCalc.DoOnResize(spreadsheet)\n//\n// Processes an onResize event, setting the different views.\n//\n\nSocialCalc.DoOnResize = function(spreadsheet) {\n\n   var v;\n   var views = spreadsheet.views;\n\n   var needresize = spreadsheet.SizeSSDiv();\n   if (!needresize) return;\n\n   for (vname in views) {\n      v = views[vname].element;\n      v.style.width = spreadsheet.width + \"px\";\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\n      }\n\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\n\n   }\n\n\n//\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\n//\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\n// Sets ssdiv to that.\n// Return true if different than existing values.\n//\n\nSocialCalc.SizeSSDiv = function(spreadsheet) {\n\n   var sizes, pos, resized, nodestyle, newval;\n   var fudgefactorX = 10; // for IE\n   var fudgefactorY = 10;\n\n   resized = false;\n\n   sizes = SocialCalc.GetViewportInfo();\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\n   pos.bottom = 0;\n   pos.right = 0;\n\n   nodestyle = spreadsheet.parentNode.style;\n\n   if (nodestyle.marginTop) {\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\n      }\n   if (nodestyle.marginBottom) {\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\n      }\n   if (nodestyle.marginLeft) {\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\n      }\n   if (nodestyle.marginRight) {\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\n      }\n\n   newval = spreadsheet.requestedHeight ||\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\n               (spreadsheet.requestedSpaceBelow || 0);\n   if (spreadsheet.height != newval) {\n      spreadsheet.height = newval;\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\n      resized = true;\n      }\n   newval = spreadsheet.requestedWidth ||\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\n   if (spreadsheet.width != newval) {\n      spreadsheet.width = newval;\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\n      resized = true;\n      }\n\n   spreadsheet.spreadsheetDiv.style.position = \"relative\";\n\n   return resized;\n\n   }\n\n\n//\n// SocialCalc.SetTab(obj)\n//\n// The obj argument is either a string with the tab name or a DOM element with an ID\n//\n\nSocialCalc.SetTab = function(obj) {\n\n   var newtab, tname, newtabnum, newview, i, vname, ele;\n   var menutabs = {};\n   var tools = {};\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var tabs = spreadsheet.tabs;\n   var views = spreadsheet.views;\n\n   if (typeof obj == \"string\") {\n      newtab = obj;\n      }\n   else {\n      newtab = obj.id.slice(spreadsheet.idPrefix.length,-3);\n      }\n\n   if (spreadsheet.editor.busy && // if busy and switching from \"sheet\", ignore\n         (!tabs[spreadsheet.currentTab].view || tabs[spreadsheet.currentTab].view==\"sheet\")) {\n      for (i=0; i<tabs.length; i++) {\n         if(tabs[i].name==newtab && (tabs[i].view && tabs[i].view!=\"sheet\")) {\n            return;\n            }\n         }\n      }\n\n   if (spreadsheet.tabs[spreadsheet.currentTab].onunclick) {\n      spreadsheet.tabs[spreadsheet.currentTab].onunclick(spreadsheet, spreadsheet.tabs[spreadsheet.currentTab].name);\n      }\n\n   for (i=0; i<tabs.length; i++) {\n      tname = tabs[i].name;\n      menutabs[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tab\");\n      tools[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tools\");\n      if (tname==newtab) {\n         newtabnum = i;\n         tools[tname].style.display = \"block\";\n         menutabs[tname].style.cssText = spreadsheet.tabselectedCSS;\n         }\n      else {\n         tools[tname].style.display = \"none\";\n         menutabs[tname].style.cssText = spreadsheet.tabplainCSS;\n         }\n      }\n\n   spreadsheet.currentTab = newtabnum;\n\n   if (tabs[newtabnum].onclick) {\n      tabs[newtabnum].onclick(spreadsheet, newtab);\n      }\n\n   for (vname in views) {\n      if ((!tabs[newtabnum].view && vname == \"sheet\") || tabs[newtabnum].view == vname) {\n         views[vname].element.style.display = \"block\";\n         newview = vname;\n         }\n      else {\n         views[vname].element.style.display = \"none\";\n         }\n      }\n\n   if (tabs[newtabnum].onclickFocus) {\n      ele = tabs[newtabnum].onclickFocus;\n      if (typeof ele == \"string\") {\n         ele = document.getElementById(spreadsheet.idPrefix+ele);\n         ele.focus();\n         }\n      SocialCalc.CmdGotFocus(ele);\n      }\n   else {\n      SocialCalc.KeyboardFocus();\n      }\n\n   if (views[newview].needsresize && views[newview].onresize) {\n      views[newview].needsresize = false;\n      views[newview].onresize(spreadsheet, views[newview]);\n      }\n\n   if (newview == \"sheet\") {\n      spreadsheet.statuslineDiv.style.display = \"block\";\n      spreadsheet.editor.ScheduleRender();\n      }\n   else {\n      spreadsheet.statuslineDiv.style.display = \"none\";\n      }\n\n   return;\n\n   }\n\n//\n// SocialCalc.SpreadsheetControlStatuslineCallback\n//\n\nSocialCalc.SpreadsheetControlStatuslineCallback = function(editor, status, arg, params) {\n\n   var rele1, rele2;\n\n   var ele = document.getElementById(params.statuslineid);\n\n   if (ele) {\n      ele.innerHTML = editor.GetStatuslineString(status, arg, params);\n      }\n\n   switch (status) {\n      case \"cmdendnorender\":\n      case \"calcfinished\":\n      case \"doneposcalc\":\n         rele1 = document.getElementById(params.recalcid1);\n         rele2 = document.getElementById(params.recalcid2);\n         if (!rele1 || !rele2) break;\n         if (editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\n            rele1.style.display = \"inline\";\n            rele2.style.display = \"inline\";\n            }\n         else {\n            rele1.style.display = \"none\";\n            rele2.style.display = \"none\";\n            }\n         break;\n\n      default:\n         break;\n      }\n\n   }\n\n\n//\n// SocialCalc.UpdateSortRangeProposal(editor)\n//\n// Updates sort range proposed in the UI in element idPrefix+sortlist\n//\n\nSocialCalc.UpdateSortRangeProposal = function(editor) {\n\n   var ele = document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+\"sortlist\");\n   if (editor.range.hasrange) {\n      ele.options[0].text = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      }\n   else {\n      ele.options[0].text = SocialCalc.LocalizeString(\"[select range]\");\n      }\n\n   }\n\n//\n// SocialCalc.LoadColumnChoosers(spreadsheet)\n//\n// Updates list of columns for choosing which to sort for Major, Minor, and Last sort\n//\n\nSocialCalc.LoadColumnChoosers = function(spreadsheet) {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   var sortrange, nrange, rparts, col, colname, sele, oldindex;\n\n   if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\n      nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\n      if (nrange.type == \"range\") {\n         rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\n         sortrange = rparts[1] + \":\" + rparts[2];\n         }\n      else {\n         sortrange = \"A1:A1\";\n         }\n      }\n   else {\n      sortrange = spreadsheet.sortrange;\n      }\n   var range = SocialCalc.ParseRange(sortrange);\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n   oldindex = sele.selectedIndex;\n   sele.options.length = 0;\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\n      colname = SocialCalc.rcColname(col);\n      sele.options[sele.options.length] = new Option(SCLoc(\"Column \")+colname, colname);\n      }\n   sele.selectedIndex = oldindex > 1 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 1; // restore what was there if reasonable\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n   oldindex = sele.selectedIndex;\n   sele.options.length = 0;\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\n      colname = SocialCalc.rcColname(col);\n      sele.options[sele.options.length] = new Option(colname, colname);\n      }\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n   oldindex = sele.selectedIndex;\n   sele.options.length = 0;\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\n      colname = SocialCalc.rcColname(col);\n      sele.options[sele.options.length] = new Option(colname, colname);\n      }\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\n\n   }\n\n//\n// SocialCalc.CmdGotFocus(obj)\n//\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\n//\n\nSocialCalc.CmdGotFocus = function(obj) {\n\n   SocialCalc.Keyboard.passThru = obj;\n\n   }\n\n\n//\n// SocialCalc.DoButtonCmd(e, buttoninfo, bobj)\n//\n\nSocialCalc.DoButtonCmd = function(e, buttoninfo, bobj) {\n\n   SocialCalc.DoCmd(bobj.element, bobj.functionobj.command);\n\n   }\n\n//\n// SocialCalc.DoCmd(obj, which)\n//\n// xxx\n//\n\nSocialCalc.DoCmd = function(obj, which) {\n\n   var combostr, sstr, cl, i, clele, slist, slistele, str, sele, rele, lele, ele, sortrange, nrange, rparts;\n   var sheet, cell, color, bgcolor, defaultcolor, defaultbgcolor;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n\n   switch (which) {\n      case \"undo\":\n         spreadsheet.ExecuteCommand(\"undo\", \"\");\n         break;\n\n      case \"redo\":\n         spreadsheet.ExecuteCommand(\"redo\", \"\");\n         break;\n\n      case \"fill-rowcolstuff\":\n      case \"fill-text\":\n         cl = which.substring(5);\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\n         clele.length = 0;\n         for (i=0; i<SocialCalc.SpreadsheetCmdTable[cl].length; i++) {\n            clele.options[i] = new Option(SocialCalc.SpreadsheetCmdTable[cl][i].t);\n            }\n         which = \"changed-\"+cl; // fall through to changed code\n\n      case \"changed-rowcolstuff\":\n      case \"changed-text\":\n         cl = which.substring(8);\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\n         slist = SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].s]; // get sList for this command\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\n         slistele.length = 0; // reset\n         for (i=0; i<(slist.length||0); i++) {\n            slistele.options[i] = new Option(slist[i].t, slist[i].s);\n            }\n         return; // nothing else to do\n\n      case \"ok-rowcolstuff\":\n      case \"ok-text\":\n         cl = which.substring(3);\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\n         combostr = SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].c;\n         sstr = slistele[slistele.selectedIndex].value;\n         SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr);\n         break;\n\n      case \"ok-setsort\":\n         lele = document.getElementById(spreadsheet.idPrefix+\"sortlist\");\n         if (lele.selectedIndex==0) {\n            if (editor.range.hasrange) {\n               spreadsheet.sortrange = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n                          SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n               }\n            else {\n               spreadsheet.sortrange = editor.ecell.coord+\":\"+editor.ecell.coord;\n               }\n            }\n         else {\n            var val = lele.options[lele.selectedIndex].value;\n            if (val == 'all') {\n                var cells = spreadsheet.sheet.cells; \n                var min_col = -1, max_col = -1, min_row = -1, max_row = -1;\n                for (var cell_id in cells) {\n                    var cr = SocialCalc.coordToCr(cell_id);\n                    if (min_row == -1 || cr.row < min_row) {\n                        min_row = cr.row;\n                    }\n                    if (min_col == -1 || cr.col < min_col) {\n                        min_col = cr.col;\n                    }\n                    if (max_row == -1 || cr.row > max_row) {\n                        max_row = cr.row;\n                    }\n                    if (max_col == -1 || cr.col > max_col) {\n                        max_col = cr.col;\n                    }\n                } \n                spreadsheet.sortrange = SocialCalc.crToCoord(min_col, min_row) + \":\" + SocialCalc.crToCoord(max_col, max_row); \n                lele.options[lele.selectedIndex].text += \" (\" + spreadsheet.sortrange + \")\";\n            } else { \n                spreadsheet.sortrange = lele.options[lele.selectedIndex].value;\n            }\n         }\n         ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\n         ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\n         ele.style.visibility = \"visible\";\n         SocialCalc.LoadColumnChoosers(spreadsheet);\n         if (obj && obj.blur) obj.blur();\n         SocialCalc.KeyboardFocus();   \n         return;\n\n      case \"dosort\":\n         if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\n            nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\n            if (nrange.type != \"range\") return;\n            rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\n            sortrange = rparts[1] + \":\" + rparts[2];\n            }\n         else {\n            sortrange = spreadsheet.sortrange;\n            }\n         if (sortrange == \"A1:A1\") return;\n         str = \"sort \"+sortrange+\" \";\n         sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n         rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\n         str += sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\n         sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n         if (sele.selectedIndex>0) {\n           rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\n           }\n         sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n         if (sele.selectedIndex>0) {\n           rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\n           }\n         spreadsheet.ExecuteCommand(str, \"\");\n         break;\n\n      case \"merge\":\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\n         spreadsheet.ExecuteCommand(combostr, sstr);\n         if (editor.range.hasrange) { // set ecell to upper left\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\n            editor.RangeRemove();\n            }\n         break;\n\n      case \"movefrom\":\n         if (editor.range2.hasrange) { // toggle if already there\n            spreadsheet.context.cursorsuffix = \"\";\n            editor.Range2Remove();\n            spreadsheet.ExecuteCommand(\"redisplay\", \"\");\n            }\n         else if (editor.range.hasrange) { // set range2 to range or one cell\n            editor.range2.top = editor.range.top;\n            editor.range2.right = editor.range.right;\n            editor.range2.bottom = editor.range.bottom;\n            editor.range2.left = editor.range.left;\n            editor.range2.hasrange = true;\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\n            }\n         else {\n            editor.range2.top = editor.ecell.row;\n            editor.range2.right = editor.ecell.col;\n            editor.range2.bottom = editor.ecell.row;\n            editor.range2.left = editor.ecell.col;\n            editor.range2.hasrange = true;\n            }\n         str = editor.range2.hasrange ? \"\" : \"off\";\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\n         ele.src=spreadsheet.imagePrefix+\"movefrom\"+str+\".gif\";\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\n         ele.src=spreadsheet.imagePrefix+\"movepaste\"+str+\".gif\";\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\n         ele.src=spreadsheet.imagePrefix+\"moveinsert\"+str+\".gif\";\n         if (editor.range2.hasrange) editor.RangeRemove();\n         break;\n\n      case \"movepaste\":\n      case \"moveinsert\":\n         if (editor.range2.hasrange) {\n            spreadsheet.context.cursorsuffix = \"\";\n            combostr = which+\" \"+\n               SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\n               SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\n               +\" \"+editor.ecell.coord;\n            spreadsheet.ExecuteCommand(combostr, \"\");\n            editor.Range2Remove();\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\n            ele.src=spreadsheet.imagePrefix+\"movefromoff.gif\";\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\n            ele.src=spreadsheet.imagePrefix+\"movepasteoff.gif\";\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\n            ele.src=spreadsheet.imagePrefix+\"moveinsertoff.gif\";\n            }\n         break;\n\n      case \"swapcolors\":\n         sheet = spreadsheet.sheet;\n         cell = sheet.GetAssuredCell(editor.ecell.coord);\n         defaultcolor = sheet.attribs.defaultcolor ? sheet.colors[sheet.attribs.defaultcolor] : \"rgb(0,0,0)\";\n         defaultbgcolor = sheet.attribs.defaultbgcolor ? sheet.colors[sheet.attribs.defaultbgcolor] : \"rgb(255,255,255)\";\n         color = cell.color ? sheet.colors[cell.color] : defaultcolor; // get color\n         if (color == defaultbgcolor) color = \"\"; // going to swap, so if same as background default, use default\n         bgcolor = cell.bgcolor ? sheet.colors[cell.bgcolor] : defaultbgcolor;\n         if (bgcolor == defaultcolor) bgcolor = \"\"; // going to swap, so if same as foreground default, use default\n         spreadsheet.ExecuteCommand(\"set %C color \"+bgcolor+\"%Nset %C bgcolor \"+color, \"\");\n         break;\n\n      default:\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\n         spreadsheet.ExecuteCommand(combostr, sstr);\n         break;\n      }\n\n   if (obj && obj.blur) obj.blur();\n   SocialCalc.KeyboardFocus();   \n\n   }\n\nSocialCalc.SpreadsheetCmdLookup = {\n 'copy': 'copy %C all',\n 'cut': 'cut %C all',\n 'paste': 'paste %C all',\n 'pasteformats': 'paste %C formats',\n 'lock': 'set %C readonly yes',\n 'unlock': 'set %C readonly no',\n 'delete': 'erase %C formulas',\n 'filldown': 'filldown %C all',\n 'fillright': 'fillright %C all',\n 'erase': 'erase %C all',\n 'borderon': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\n 'borderoff': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\n 'merge': 'merge %C',\n 'unmerge': 'unmerge %C',\n 'align-left': 'set %C cellformat left',\n 'align-center': 'set %C cellformat center',\n 'align-right': 'set %C cellformat right',\n 'align-default': 'set %C cellformat',\n 'insertrow': 'insertrow %C',\n 'insertcol': 'insertcol %C',\n 'deleterow': 'deleterow %C',\n 'deletecol': 'deletecol %C',\n 'hiderow': 'set %H hide yes',\n 'hidecol': 'set %W hide yes',\n 'undo': 'undo',\n 'redo': 'redo',\n 'recalc': 'recalc'\n }\n\nSocialCalc.SpreadsheetCmdSLookup = {\n 'borderon': '1px solid rgb(0,0,0)',\n 'borderoff': ''\n }\n\n/******* NO LONGER USED\n\nSocialCalc.SpreadsheetCmdTable = {\n cmd: [\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"},\n  {t:\"Copy\", s:\"all\", c:\"copy %C %S\"},\n  {t:\"Cut\", s:\"all\", c:\"cut %C %S\"},\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\n  {t:\"Merge Cells\", s:\"none\", c:\"merge %C\"},\n  {t:\"Unmerge\", s:\"none\", c:\"unmerge %C\"},\n  {t:\"Sort\", s:\"sortcol\", c:\"sort %R %S\"},\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\n  {t:\"Cell Borders\", s:\"borderOnOff\", c:\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\"},\n  {t:\"Column Width\", s:\"colWidths\", c:\"set %W width %S\"},\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"},\n  {t:\"Default Column Width\", s:\"colWidths\", c:\"set sheet defaultcolwidth %S\"}\n  ],\n rowcolstuff: [\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"}\n  ],\n text: [\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\n  {t:\"Cell Text Format\", s:\"tvf\", c:\"set %C textvalueformat %S\"},\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\n  {t:\"Default Text Format\", s:\"tvf\", c:\"set sheet defaulttextvalueformat %S\"},\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"}\n  ],\n slists: {\n  \"colors\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"Black\", s:\"rgb(0,0,0)\"},\n   {t:\"Dark Gray\", s:\"rgb(102,102,102)\"}, // #666\n   {t:\"Gray\", s:\"rgb(204,204,204)\"}, // #CCC\n   {t:\"White\", s:\"rgb(255,255,255)\"},\n   {t:\"Red\", s:\"rgb(255,0,0)\"},\n   {t:\"Dark Red\", s:\"rgb(153,0,0)\"},\n   {t:\"Orange\", s:\"rgb(255,153,0)\"},\n   {t:\"Yellow\", s:\"rgb(255,255,0)\"},\n   {t:\"Light Yellow\", s:\"rgb(255,255,204)\"},\n   {t:\"Green\", s:\"rgb(0,255,0)\"},\n   {t:\"Dark Green\", s:\"rgb(0,153,0)\"},\n   {t:\"Blue\", s:\"rgb(0,0,255)\"},\n   {t:\"Dark Blue\", s:\"rgb(0,0,153)\"},\n   {t:\"Light Blue\", s:\"rgb(204,204,255)\"}\n   ],\n  \"fonts\": [ // style weight size family\n   {t:\"Default\", s:\"\"},\n   {t:\"Bold\", s:\"normal bold * *\"},\n   {t:\"Italic\", s:\"italic normal * *\"},\n   {t:\"Small\", s:\"* small *\"},\n   {t:\"Medium\", s:\"* medium *\"},\n   {t:\"Large\", s:\"* large *\"},\n   {t:\"Bold Small\", s:\"normal bold small *\"},\n   {t:\"Bold Medium\", s:\"normal bold medium *\"},\n   {t:\"Bold Large\", s:\"normal bold large *\"}\n   ],\n  \"cellformat\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"Left\", s:\"left\"},\n   {t:\"Right\", s:\"right\"},\n   {t:\"Center\", s:\"center\"}\n   ],\n  \"borderOnOff\": [\n   {t:\"On\", s:\"1px solid rgb(0,0,0)\"},\n   {t:\"Off\", s:\"\"}\n   ],\n  \"colWidths\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"20\", s:\"20\"},\n   {t:\"40\", s:\"40\"},\n   {t:\"60\", s:\"60\"},\n   {t:\"80\", s:\"80\"},\n   {t:\"100\", s:\"100\"},\n   {t:\"120\", s:\"120\"},\n   {t:\"140\", s:\"140\"},\n   {t:\"160\", s:\"160\"},\n   {t:\"180\", s:\"180\"},\n   {t:\"200\", s:\"200\"},\n   {t:\"220\", s:\"220\"},\n   {t:\"240\", s:\"240\"},\n   {t:\"260\", s:\"260\"},\n   {t:\"280\", s:\"280\"},\n   {t:\"300\", s:\"300\"}\n   ],\n  \"ntvf\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"1234\", s:\"0\"},\n   {t:\"1,234\", s:\"#,##0\"},\n   {t:\"1,234.5\", s:\"#,##0.0\"},\n   {t:\"1,234.56\", s:\"#,##0.00\"},\n   {t:\"1,234.567\", s:\"#,##0.000\"},\n   {t:\"1,234%\", s:\"#,##0%\"},\n   {t:\"1,234.5%\", s:\"#,##0.0%\"},\n   {t:\"(1,234)\", s:\"#,##0_);(#,##0)\"},\n   {t:\"(1,234.5)\", s:\"#,##0.0_);(#,##0.0)\"},\n   {t:\"(1,234.56)\", s:\"#,##0.00_);(#,##0.00)\"},\n   {t:\"00\", s:\"00\"},\n   {t:\"000\", s:\"000\"},\n   {t:\"0000\", s:\"0000\"},\n   {t:\"$1,234.56\", s:\"$#,##0.00\"},\n   {t:\"2006-01-04\", s:\"yyyy-mm-dd\"},\n   {t:\"01:23:45\", s:\"hh:mm:ss\"},\n   {t:\"2006-01-04 01:23:45\", s:\"yyyy-mm-dd hh:mm:ss\"},\n   {t:\"Hidden\", s:\"hidden\"}\n   ],\n  \"tvf\": [\n   {t:\"Default\", s:\"\"},\n   {t:\"Automatic\", s:\"general\"},\n   {t:\"Plain Text\", s:\"text-plain\"},\n   {t:\"HTML\", s:\"text-html\"},\n   {t:\"Wiki\", s:\"text-wiki\"},\n   {t:\"Hidden\", s:\"hidden\"}\n   ],\n  \"ffal\": [ // Formulas, Formats, All\n   {t:\"All\", s:\"all\"},\n   {t:\"Contents\", s:\"formulas\"},\n   {t:\"Formats\", s:\"formats\"}\n   ],\n  \"all\": [ // All\n   {t:\"All\", s:\"all\"}\n   ],\n  \"rowcol\": [\n   {t:\"Row\", s:\"row\"},\n   {t:\"Column\", s:\"col\"}\n   ],\n  \"sortcol\": [\n   {t:\"A up\", s:\"A up\"},\n   {t:\"B up\", s:\"B up\"},\n   {t:\"C up\", s:\"C up\"},\n   {t:\"A down\", s:\"A down\"},\n   {t:\"B down\", s:\"B down\"},\n   {t:\"C down\", s:\"C down\"},\n   {t:\"A, B, C up\", s:\"A up B up C up\"}\n   ],\n  \"none\": [ // nothing\n   {t:\" \", s:\" \"}\n   ]\n  }\n }\n*********/\n\n//\n// SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr)\n//\n// xxx\n//\n\nSocialCalc.SpreadsheetControlExecuteCommand = function(obj, combostr, sstr) {\n\n   var i, commands;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var eobj = spreadsheet.editor;\n\n   var str = {};\n   str.P = \"%\";\n   str.N = \"\\n\"\n   if (eobj.range.hasrange) {\n      str.R = SocialCalc.crToCoord(eobj.range.left, eobj.range.top)+\n             \":\"+SocialCalc.crToCoord(eobj.range.right, eobj.range.bottom);\n      str.C = str.R;\n      str.W = SocialCalc.rcColname(eobj.range.left) + \":\" + SocialCalc.rcColname(eobj.range.right);\n      str.H = eobj.range.top + \":\" + eobj.range.bottom;\n      }\n   else if (eobj.ecell) {\n      str.C = eobj.ecell.coord;\n      str.R = eobj.ecell.coord+\":\"+eobj.ecell.coord;\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr(eobj.ecell.coord).col);\n      str.H = SocialCalc.coordToCr(eobj.ecell.coord).row;\n      }\n   else {\n      str.C = 'A1'\n      str.R = 'A1:A1'\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr('A1').col);\n      str.H = SocialCalc.coordToCr('A1').row;\n      }\n   str.S = sstr;\n   combostr = combostr.replace(/%C/g, str.C);\n   combostr = combostr.replace(/%R/g, str.R);\n   combostr = combostr.replace(/%N/g, str.N);\n   combostr = combostr.replace(/%S/g, str.S);\n   combostr = combostr.replace(/%W/g, str.W);\n   combostr = combostr.replace(/%H/g, str.H);\n   combostr = combostr.replace(/%P/g, str.P);\n\n   eobj.EditorScheduleSheetCommands(combostr, true, false);\n\n   }\n\n//\n// result = SocialCalc.SpreadsheetControlCreateSheetHTML(spreadsheet)\n//\n// Returns the HTML representation of the whole spreadsheet\n//\n\nSocialCalc.SpreadsheetControlCreateSheetHTML = function(spreadsheet) {\n\n   var context, div, ele;\n\n   var result = \"\";\n\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\n   div = document.createElement(\"div\");\n   ele = context.RenderSheet(null, {type: \"html\"});\n   div.appendChild(ele);\n   delete context;\n   result = div.innerHTML;\n   delete ele;\n   delete div;\n   return result;\n\n   }\n\n//\n// result = SocialCalc.SpreadsheetControlCreateCellHTML(spreadsheet, coord, linkstyle)\n//\n// Returns the HTML representation of a cell. Blank is \"\", not \"&nbsp;\".\n//\n\nSocialCalc.SpreadsheetControlCreateCellHTML = function(spreadsheet, coord, linkstyle) {\n\n   var result = \"\";\n   var cell = spreadsheet.sheet.cells[coord];\n\n   if (!cell) return \"\";\n\n   if (cell.displaystring == undefined) {\n      result = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\n      }\n   else {\n      result = cell.displaystring;\n      }\n\n   if (result == \"&nbsp;\") result = \"\";\n\n   return result;\n\n   }\n\n//\n// result = SocialCalc.SpreadsheetControlCreateCellHTMLSave(spreadsheet, range, linkstyle)\n//\n// Returns the HTML representation of a range of cells, or the whole sheet if range is null.\n// The form is:\n//    version:1.0\n//    coord:cell-HTML\n//    coord:cell-HTML\n//    ...\n//\n// Empty cells are skipped. The cell-HTML is encoded with \":\"=>\"\\c\", newline=>\"\\n\", and \"\\\"=>\"\\b\".\n//\n\nSocialCalc.SpreadsheetControlCreateCellHTMLSave = function(spreadsheet, range, linkstyle) {\n\n   var cr1, cr2, row, col, coord, cell, cellHTML;\n   var result = [];\n   var prange;\n\n   if (range) {\n      prange = SocialCalc.ParseRange(range);\n      }\n   else {\n      prange = {cr1: {row: 1, col:1},\n                cr2: {row: spreadsheet.sheet.attribs.lastrow, col: spreadsheet.sheet.attribs.lastcol}};\n      }\n   cr1 = prange.cr1;\n   cr2 = prange.cr2;\n\n   result.push(\"version:1.0\");\n\n   for (row=cr1.row; row <= cr2.row; row++) {\n      for (col=cr1.col; col <= cr2.col; col++) {\n         coord = SocialCalc.crToCoord(col, row);\n         cell=spreadsheet.sheet.cells[coord];\n         if (!cell) continue;\n         if (cell.displaystring == undefined) {\n            cellHTML = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\n            }\n         else {\n            cellHTML = cell.displaystring;\n            }\n         if (cellHTML == \"&nbsp;\") continue;\n         result.push(coord+\":\"+SocialCalc.encodeForSave(cellHTML));\n         }\n      }\n\n   result.push(\"\"); // one extra to get extra \\n\n   return result.join(\"\\n\");\n   }\n\n//\n// Formula Bar Button Routines\n//\n\nSocialCalc.SpreadsheetControl.DoFunctionList = function() {\n\n   var i, cname, str, f, ele;\n\n   var scf = SocialCalc.Formula;\n   var scc = SocialCalc.Constants;\n   var fcl = scc.function_classlist;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"function\";\n\n   ele = document.getElementById(idp+\"dialog\");\n   if (ele) return; // already have one\n\n   scf.FillFunctionInfo();\n\n   str = '<table><tr><td><span style=\"font-size:x-small;font-weight:bold\">%loc!Category!</span><br>'+\n      '<select id=\"'+idp+'class\" size=\"'+fcl.length+'\" style=\"width:120px;\" onchange=\"SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);\">';\n   for (i=0; i<fcl.length; i++) {\n      str += '<option value=\"'+fcl[i]+'\"'+(i==0?' selected>':'>')+SocialCalc.special_chars(scf.FunctionClasses[fcl[i]].name)+'</option>';\n      }\n   str += '</select></td><td>&nbsp;&nbsp;</td><td id=\"'+idp+'list\"><span style=\"font-size:x-small;font-weight:bold\">%loc!Functions!</span><br>'+\n      '<select id=\"'+idp+'name\" size=\"'+fcl.length+'\" style=\"width:240px;\" '+\n      'onchange=\"SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);\" ondblclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">';\n   str += SocialCalc.SpreadsheetControl.GetFunctionNamesStr(\"all\");\n   str += '</td></tr><tr><td colspan=\"3\">'+\n          '<div id=\"'+idp+'desc\" style=\"width:380px;height:80px;overflow:auto;font-size:x-small;\">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(scf.FunctionClasses[fcl[0]].items[0])+'</div>'+\n          '<div style=\"width:380px;text-align:right;padding-top:6px;font-size:small;\">'+\n          '<input type=\"button\" value=\"%loc!Paste!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">&nbsp;'+\n          '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\"></div>'+\n          '</td></tr></table>';\n\n   var main = document.createElement(\"div\");\n   main.id = idp+\"dialog\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\n\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;%loc!Function List!\"+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   str = SocialCalc.LocalizeSubstrings(str);\n\n   main.innerHTML = str;\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true,\n                 {MouseDown: SocialCalc.DragFunctionStart, \n                  MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main},\n                  spreadsheet.spreadsheetDiv);\n\n   spreadsheet.spreadsheetDiv.appendChild(main);\n\n   ele = document.getElementById(idp+\"name\");\n   ele.focus();\n   SocialCalc.CmdGotFocus(ele);\n//!!! need to do keyboard handling: if esc, hide; if All, letter scrolls to there\n\n   }\n\nSocialCalc.SpreadsheetControl.GetFunctionNamesStr = function(cname) {\n\n   var i, f;\n   var scf = SocialCalc.Formula;\n   var str = \"\";\n\n   f = scf.FunctionClasses[cname];\n   for (i=0; i<f.items.length; i++) {\n      str += '<option value=\"'+f.items[i]+'\"'+(i==0?' selected>':'>')+f.items[i]+'</option>';\n      }\n\n   return str;\n\n   }\n\nSocialCalc.SpreadsheetControl.FillFunctionNames = function(cname, ele) {\n\n   var i, f;\n   var scf = SocialCalc.Formula;\n\n   ele.length = 0;\n   f = scf.FunctionClasses[cname];\n   for (i=0; i<f.items.length; i++) {\n      ele.options[i] = new Option(f.items[i], f.items[i]);\n      if (i==0) {\n         ele.options[i].selected = true;\n         }\n      }\n   }\n\nSocialCalc.SpreadsheetControl.GetFunctionInfoStr = function(fname) {\n   \n   var scf = SocialCalc.Formula;\n   var f = scf.FunctionList[fname];\n   var scsc = SocialCalc.special_chars;\n\n   var str = \"<b>\"+fname+\"(\"+scsc(scf.FunctionArgString(fname))+\")</b><br>\";\n   str += scsc(f[3]);\n\n   return str;\n\n   }\n\nSocialCalc.SpreadsheetControl.FunctionClassChosen = function(cname) {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"function\";\n   var scf = SocialCalc.Formula;\n\n   SocialCalc.SpreadsheetControl.FillFunctionNames(cname, document.getElementById(idp+\"name\"));\n\n   SocialCalc.SpreadsheetControl.FunctionChosen(scf.FunctionClasses[cname].items[0]);\n\n   }\n\nSocialCalc.SpreadsheetControl.FunctionChosen = function(fname) {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"function\";\n\n   document.getElementById(idp+\"desc\").innerHTML = SocialCalc.SpreadsheetControl.GetFunctionInfoStr(fname);\n\n   }\n\nSocialCalc.SpreadsheetControl.HideFunctions = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functiondialog\");\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(ele);\n\n   SocialCalc.KeyboardFocus();\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   }\n\nSocialCalc.SpreadsheetControl.DoFunctionPaste = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functionname\");\n   var mele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\n\n   var text = ele.value+\"(\";\n\n   SocialCalc.SpreadsheetControl.HideFunctions();\n\n   if (mele) { // multi-line editing is in progress\n      mele.value += text;\n      mele.focus();\n      SocialCalc.CmdGotFocus(mele);\n      }\n   else {\n      editor.EditorAddToInput(text, \"=\");\n      }\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoMultiline = function() {\n\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\n\n   var str, ele, text;\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"multiline\";\n\n   ele = document.getElementById(idp+\"dialog\");\n   if (ele) return; // already have one\n\n   switch (editor.state) {\n      case \"start\":\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.RangeRemove();\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         text = editor.inputBox.GetText();\n         break;\n      }\n\n   editor.inputBox.element.disabled = true;\n\n   text = SocialCalc.special_chars(text);\n\n   str = '<textarea id=\"'+idp+'textarea\" style=\"width:380px;height:120px;margin:10px 0px 0px 6px;\">'+text+'</textarea>'+\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         SCLocSS('<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilinePaste();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilineClear();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\"></div>'+\n         '</div>');\n\n   var main = document.createElement(\"div\");\n   main.id = idp+\"dialog\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\n\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\n      SCLocSS(\"&nbsp;%loc!Multi-line Input Box!\")+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, \n                 {MouseDown: SocialCalc.DragFunctionStart, \n                  MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main},\n                  spreadsheet.spreadsheetDiv);\n\n   spreadsheet.spreadsheetDiv.appendChild(main);\n\n   ele = document.getElementById(idp+\"textarea\");\n   ele.focus();\n   SocialCalc.CmdGotFocus(ele);\n//!!! need to do keyboard handling: if esc, hide?\n\n   }\n\n\nSocialCalc.SpreadsheetControl.HideMultiline = function() {\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinedialog\");\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(ele);\n\n   SocialCalc.KeyboardFocus();\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   switch (editor.state) {\n      case \"start\":\n         editor.inputBox.DisplayCellContents(null);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.element.disabled = false;\n         editor.inputBox.Focus();\n         break;\n      }\n\n   }\n\nSocialCalc.SpreadsheetControl.DoMultilineClear = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\n\n   ele.value = \"\";\n   ele.focus();\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoMultilinePaste = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\n\n   var text = ele.value;\n\n   SocialCalc.SpreadsheetControl.HideMultiline();\n\n   switch (editor.state) {\n      case \"start\":\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         break;\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.Blur();\n         editor.inputBox.ShowInputBox(false);\n         editor.state = \"start\";\n         break;\n      }\n\n   editor.EditorSaveEdit(text);\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoLink = function() {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   var str, ele, text, cell, setformat, popup;\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var idp = spreadsheet.idPrefix+\"link\";\n\n   ele = document.getElementById(idp+\"dialog\");\n   if (ele) return; // already have one\n\n   switch (editor.state) {\n      case \"start\":\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         editor.RangeRemove();\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         text = editor.inputBox.GetText();\n         break;\n      }\n\n   editor.inputBox.element.disabled = true;\n\n   if (text.charAt(0)==\"'\") {\n      text = text.slice(1);\n      }\n\n   var parts = SocialCalc.ParseCellLinkText(text);\n\n   text = SocialCalc.special_chars(text);\n\n   cell = spreadsheet.sheet.cells[editor.ecell.coord];\n   if (!cell || !cell.textvalueformat) { // set to link format, but don't override\n      setformat = \" checked\";\n      }\n   else {\n      setformat = \"\";\n      }\n\n   popup = parts.newwin ? \" checked\" : \"\";\n\n   str = '<div style=\"padding:6px 0px 4px 6px;\">'+\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"Description\")+'</span><br>'+\n         '<input type=\"text\" id=\"'+idp+'desc\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.desc)+'\"><br>'+\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"URL\")+'</span><br>'+\n         '<input type=\"text\" id=\"'+idp+'url\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.url)+'\"><br>';\n   if (SocialCalc.Callbacks.MakePageLink) { // only show if handling pagenames here\n      str += '<span style=\"font-size:smaller;\">'+SCLoc(\"Page Name\")+'</span><br>'+\n             '<input type=\"text\" id=\"'+idp+'pagename\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.pagename)+'\"><br>'+\n             '<span style=\"font-size:smaller;\">'+SCLoc(\"Workspace\")+'</span><br>'+\n             '<input type=\"text\" id=\"'+idp+'workspace\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.workspace)+'\"><br>';\n      }\n   str += SocialCalc.LocalizeSubstrings('<input type=\"checkbox\" id=\"'+idp+'format\"'+setformat+'>&nbsp;'+\n         '<span style=\"font-size:smaller;\">%loc!Set to Link format!</span><br>'+\n         '<input type=\"checkbox\" id=\"'+idp+'popup\"'+popup+'>&nbsp;'+\n         '<span style=\"font-size:smaller;\">%loc!Show in new browser window!</span>'+\n         '</div>'+\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\n         '<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkPaste();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkClear();\">&nbsp;'+\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\"></div>'+\n         '</div>');\n\n   var main = document.createElement(\"div\");\n   main.id = idp+\"dialog\";\n\n   main.style.position = \"absolute\";\n\n   var vp = SocialCalc.GetViewportInfo();\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\n\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\n   main.style.zIndex = 100;\n   main.style.backgroundColor = \"#FFF\";\n   main.style.border = \"1px solid black\";\n\n   main.style.width = \"400px\";\n\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+SCLoc(\"Link Input Box\")+'</td>'+\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\">&nbsp;X&nbsp;</td></tr></table>'+\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\n\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, \n                 {MouseDown: SocialCalc.DragFunctionStart, \n                  MouseMove: SocialCalc.DragFunctionPosition,\n                  MouseUp: SocialCalc.DragFunctionPosition,\n                  Disabled: null, positionobj: main},\n                  spreadsheet.spreadsheetDiv);\n\n   spreadsheet.spreadsheetDiv.appendChild(main);\n\n   ele = document.getElementById(idp+\"url\");\n   ele.focus();\n   SocialCalc.CmdGotFocus(ele);\n//!!! need to do keyboard handling: if esc, hide?\n\n   }\n\n\nSocialCalc.SpreadsheetControl.HideLink = function() {\n\n   var scc = SocialCalc.Constants;\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkdialog\");\n   ele.innerHTML = \"\";\n\n   SocialCalc.DragUnregister(ele);\n\n   SocialCalc.KeyboardFocus();\n\n   if (ele.parentNode) {\n      ele.parentNode.removeChild(ele);\n      }\n\n   switch (editor.state) {\n      case \"start\":\n         editor.inputBox.DisplayCellContents(null);\n         break;\n\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.element.disabled = false;\n         editor.inputBox.Focus();\n         break;\n      }\n\n   }\n\nSocialCalc.SpreadsheetControl.DoLinkClear = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   document.getElementById(spreadsheet.idPrefix+\"linkdesc\").value = \"\";\n   document.getElementById(spreadsheet.idPrefix+\"linkpagename\").value = \"\";\n   document.getElementById(spreadsheet.idPrefix+\"linkworkspace\").value = \"\";\n\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\n   ele.value = \"\";\n   ele.focus();\n\n   }\n\n\nSocialCalc.SpreadsheetControl.DoLinkPaste = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var wval = editor.workingvalues;\n\n   var descele = document.getElementById(spreadsheet.idPrefix+\"linkdesc\");\n   var urlele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\n   var pagenameele = document.getElementById(spreadsheet.idPrefix+\"linkpagename\");\n   var workspaceele = document.getElementById(spreadsheet.idPrefix+\"linkworkspace\");\n   var formatele = document.getElementById(spreadsheet.idPrefix+\"linkformat\");\n   var popupele = document.getElementById(spreadsheet.idPrefix+\"linkpopup\");\n\n   var text = \"\";\n\n   var ltsym, gtsym, obsym, cbsym;\n\n   if (popupele.checked) {\n      ltsym = \"<<\"; gtsym = \">>\"; obsym = \"[[\"; cbsym = \"]]\";\n      }\n   else {\n      ltsym = \"<\"; gtsym = \">\"; obsym = \"[\"; cbsym = \"]\";\n      }\n\n   if (pagenameele && pagenameele.value) {\n      if (workspaceele.value) {\n         text = descele.value+\"{\"+workspaceele.value+obsym+pagenameele.value+cbsym+\"}\";\n         }\n      else {\n         text = descele.value+obsym+pagenameele.value+cbsym;\n         }\n      }\n   else {\n      text = descele.value+ltsym+urlele.value+gtsym;\n      }\n\n   SocialCalc.SpreadsheetControl.HideLink();\n\n   switch (editor.state) {\n      case \"start\":\n         wval.partialexpr = \"\";\n         wval.ecoord = editor.ecell.coord;\n         wval.erow = editor.ecell.row;\n         wval.ecol = editor.ecell.col;\n         break;\n      case \"input\":\n      case \"inputboxdirect\":\n         editor.inputBox.Blur();\n         editor.inputBox.ShowInputBox(false);\n         editor.state = \"start\";\n         break;\n      }\n\n   if (formatele.checked) {\n      SocialCalc.SpreadsheetControlExecuteCommand(null, \"set %C textvalueformat text-link\", \"\");\n      }\n\n   editor.EditorSaveEdit(text);\n\n   }\n\nSocialCalc.SpreadsheetControl.DoSum = function() {\n\n   var cmd, cell, row, col, sel, cr, foundvalue;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var editor = spreadsheet.editor;\n   var sheet = editor.context.sheetobj;\n\n   if (editor.range.hasrange) {\n      sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\n         \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      cmd = \"set \"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom+1)+\n         \" formula sum(\"+sel+\")\";\n      }\n   else {\n      row = editor.ecell.row - 1;\n      col = editor.ecell.col;\n      if (row<=1) {\n         cmd = \"set \"+editor.ecell.coord+\" constant e#REF! 0 #REF!\";\n         }\n      else {\n         foundvalue = false;\n         while (row>0) {\n            cr = SocialCalc.crToCoord(col, row);\n            cell = sheet.GetAssuredCell(cr);\n            if (!cell.datatype || cell.datatype==\"t\") {\n               if (foundvalue) {\n                  row++;\n                  break;\n                  }\n               }\n            else {\n               foundvalue = true;\n               }\n            row--;\n            }\n         cmd = \"set \"+editor.ecell.coord+\" formula sum(\"+\n            SocialCalc.crToCoord(col,row)+\":\"+SocialCalc.crToCoord(col, editor.ecell.row-1)+\")\";\n         }\n      }\n\n   editor.EditorScheduleSheetCommands(cmd, true, false);\n\n   }\n\nSocialCalc.SpreadsheetControl.FindInSheet = function() {\n    var searchstatus = $(\"#searchstatus\");\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n    if (!this.value.length) {\n        searchstatus.text(\"\");\n        spreadsheet.sheet.search_cells = [];\n        spreadsheet.sheet.selected_search_cell = undefined;\n        return;\n    }\n    var cells = spreadsheet.sheet.cells;\n    var regex = new RegExp(this.value, 'im');\n    var cell, cellvalue;\n    var search_cells = [];\n    for (var cell_id in cells) {\n        cell = cells[cell_id];\n        var cr = SocialCalc.coordToCr(cell_id);\n        if (spreadsheet.sheet.rowattribs.hide[cr.row] === 'yes' || spreadsheet.sheet.colattribs.hide[SocialCalc.rcColname(cr.col)] === 'yes') {\n            continue;\n        }\n        if (cell.datatype === 'c') {\n            cellvalue = cell.displaystring;\n        } else {\n            cellvalue = String(cell.datavalue);\n        }\n        if (cellvalue !== undefined && cellvalue.match(regex)) {\n           search_cells.push(cell_id);\n        } \n    }\n    spreadsheet.sheet.search_cells = search_cells;\n    if (search_cells.length) {\n        spreadsheet.sheet.selected_search_cell = 0;\n        spreadsheet.editor.MoveECell(search_cells[0]);\n        searchstatus.text(\"1 of \" + search_cells.length); \n    } else {\n        spreadsheet.sheet.selected_search_cell = undefined;\n        searchstatus.text(\"No Matches\");\n    }\n        \n}\n\nSocialCalc.SpreadsheetControl.SearchSheet = function(direction) {\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n    var sheet = spreadsheet.sheet;\n    var cells = sheet.search_cells;\n    if (!cells.length) {\n        return;\n    }\n    var selected_cell = sheet.selected_search_cell;\n    if (selected_cell === (direction === 0 ? 0 : cells.length-1)) {\n        selected_cell = (direction === 0 ? cells.length-1 : 0);\n    } else {\n        selected_cell += (direction === 0 ? -1 : 1);\n    }\n    var new_cell = cells[selected_cell];\n    sheet.selected_search_cell = selected_cell; \n    spreadsheet.editor.MoveECell(new_cell);\n    document.getElementById(\"searchstatus\").textContent = String(selected_cell+1) + \" of \" + cells.length;\n}\n \nSocialCalc.SpreadsheetControl.SearchUp = function() {\n    SocialCalc.SpreadsheetControl.SearchSheet(0);    \n}\n\nSocialCalc.SpreadsheetControl.SearchDown = function() {\n    SocialCalc.SpreadsheetControl.SearchSheet(1);\n}\n\n//\n// TAB Routines\n//\n\n// Sort\n\nSocialCalc.SpreadsheetControlSortOnclick = function(s, t) {\n\n   var name, i;\n   var namelist = [];\n   var nl = document.getElementById(s.idPrefix+\"sortlist\");\n   SocialCalc.LoadColumnChoosers(s);\n   s.editor.RangeChangeCallback.sort = SocialCalc.UpdateSortRangeProposal;\n\n   for (name in s.sheet.names) {\n      namelist.push(name);\n      }\n   namelist.sort();\n   nl.length = 0;\n   nl.options[0] = new Option(SocialCalc.LocalizeString(\"[select range]\"));\n   nl.options[1] = new Option(SocialCalc.LocalizeString(\"Sort All\"), \"all\");\n   n_options = nl.options.length;\n\n   for (i=0; i<namelist.length; i++) {\n      name = namelist[i];\n      nl.options[i+n_options] = new Option(name, name);\n      if (name == s.sortrange) {\n         nl.options[i+n_options].selected = true;\n         }\n      }\n   if (s.sortrange == \"\") {\n      nl.options[0].selected = true;\n      }\n\n   SocialCalc.UpdateSortRangeProposal(s.editor);\n   SocialCalc.KeyboardFocus();\n   return;\n\n   }\n\nSocialCalc.SpreadsheetControlSortSave = function(editor, setting) {\n   // Format is:\n   //    sort:sortrange:major:up/down:minor:up/down:last:up/down\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n   var str, sele, rele;\n\n   str = \"sort:\"+SocialCalc.encodeForSave(spreadsheet.sortrange)+\":\";\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n   rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\n   str += sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n   if (sele.selectedIndex>0) {\n      rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\n      }\n   else {\n      str += \"::\";\n      }\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n   if (sele.selectedIndex>0) {\n      rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\n      }\n    else {\n      str += \"::\";\n      }\n   return str+\"\\n\";\n   }\n\nSocialCalc.SpreadsheetControlSortLoad = function(editor, setting, line, flags) {\n   var parts, ele;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\n\n   parts = line.split(\":\");\n   spreadsheet.sortrange = SocialCalc.decodeFromSave(parts[1]);\n   ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\n   if (spreadsheet.sortrange) {\n      ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\n      ele.style.visibility = \"visible\";\n      }\n   else {\n      ele.style.visibility = \"hidden\";\n      }\n   SocialCalc.LoadColumnChoosers(spreadsheet);\n\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\n   sele.selectedIndex = parts[2]-0;\n   document.getElementById(spreadsheet.idPrefix+\"majorsort\"+parts[3]).checked = true;\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\n   if (parts[4]) {\n      sele.selectedIndex = parts[4]-0;\n      document.getElementById(spreadsheet.idPrefix+\"minorsort\"+parts[5]).checked = true;\n      }\n   else {\n      sele.selectedIndex = 0;\n      document.getElementById(spreadsheet.idPrefix+\"minorsortup\").checked = true;\n      }\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\n   if (parts[6]) {\n      sele.selectedIndex = parts[6]-0;\n      document.getElementById(spreadsheet.idPrefix+\"lastsort\"+parts[7]).checked = true;\n      }\n    else {\n      sele.selectedIndex = 0;\n      document.getElementById(spreadsheet.idPrefix+\"lastsortup\").checked = true;\n      }\n\n   return true;\n   }\n\n// Comment\n\nSocialCalc.SpreadsheetControlCommentOnclick = function(s, t) {\n   s.editor.MoveECellCallback.comment = SocialCalc.SpreadsheetControlCommentMoveECell;\n   SocialCalc.SpreadsheetControlCommentDisplay(s, t);\n   SocialCalc.KeyboardFocus();\n   return;\n   }\n\nSocialCalc.SpreadsheetControlCommentDisplay = function(s, t) {\n   var c = \"\";\n   if (s.editor.ecell && s.editor.ecell.coord && s.sheet.cells[s.editor.ecell.coord]) {\n      c = s.sheet.cells[s.editor.ecell.coord].comment || \"\";\n      }\n   document.getElementById(s.idPrefix+\"commenttext\").value = c;\n   }\n\nSocialCalc.SpreadsheetControlCommentMoveECell = function(editor) {\n   SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(), \"comment\");\n   }\n\nSocialCalc.SpreadsheetControlCommentSet = function() {\n   var s=SocialCalc.GetSpreadsheetControlObject();\n   s.ExecuteCommand(\"set %C comment \"+SocialCalc.encodeForSave(document.getElementById(s.idPrefix+\"commenttext\").value));\n   var cell=SocialCalc.GetEditorCellElement(s.editor, s.editor.ecell.row, s.editor.ecell.col);\n   if (!s.editor.ECellReadonly()) {\n      cell.element.title = document.getElementById(s.idPrefix+\"commenttext\").value;\n      s.editor.UpdateCellCSS(cell, s.editor.ecell.row, s.editor.ecell.col);\n      }\n   SocialCalc.KeyboardFocus();\n   }\n\nSocialCalc.SpreadsheetControlCommentOnunclick = function(s, t) {\n   delete s.editor.MoveECellCallback.comment;\n   }\n\n// Names\n\nSocialCalc.SpreadsheetControlNamesOnclick = function(s, t) {\n   document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n   document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n   document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n   s.editor.RangeChangeCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\n   s.editor.MoveECellCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\n   SocialCalc.SpreadsheetControlNamesRangeChange(s.editor);\n   SocialCalc.SpreadsheetControlNamesFillNameList();\n   SocialCalc.SpreadsheetControlNamesChangedName();\n   }\n\nSocialCalc.SpreadsheetControlNamesFillNameList = function() {\n   var SCLoc = SocialCalc.LocalizeString;\n   var name, i;\n   var namelist = [];\n   var s=SocialCalc.GetSpreadsheetControlObject();\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\n   var currentname = document.getElementById(s.idPrefix+\"namesname\").value.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\n   for (name in s.sheet.names) {\n      namelist.push(name);\n      }\n   namelist.sort();\n   nl.length = 0;\n   if (namelist.length > 0) {\n      nl.options[0] = new Option(SCLoc(\"[New]\"));\n      }\n   else {\n      nl.options[0] = new Option(SCLoc(\"[None]\"));\n      }\n   for (i=0; i<namelist.length; i++) {\n      name = namelist[i];\n      nl.options[i+1] = new Option(name, name);\n      if (name == currentname) {\n         nl.options[i+1].selected = true;\n         }\n      }\n   if (currentname == \"\") {\n      nl.options[0].selected = true;\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesChangedName = function() {\n   var s=SocialCalc.GetSpreadsheetControlObject();\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\n   var name = nl.options[nl.selectedIndex].value;\n   if (s.sheet.names[name]) {\n      document.getElementById(s.idPrefix+\"namesname\").value = name;\n      document.getElementById(s.idPrefix+\"namesdesc\").value = s.sheet.names[name].desc || \"\";\n      document.getElementById(s.idPrefix+\"namesvalue\").value = s.sheet.names[name].definition || \"\";\n      }\n   else {\n      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesRangeChange = function(editor) {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var ele = document.getElementById(s.idPrefix+\"namesrangeproposal\");\n   if (editor.range.hasrange) {\n      ele.value = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\n      }\n   else {\n      ele.value = editor.ecell.coord;\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesOnunclick = function(s, t) {\n   delete s.editor.RangeChangeCallback.names;\n   delete s.editor.MoveECellCallback.names;\n   }\n\nSocialCalc.SpreadsheetControlNamesSetValue = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   document.getElementById(s.idPrefix+\"namesvalue\").value = document.getElementById(s.idPrefix+\"namesrangeproposal\").value;\n   SocialCalc.KeyboardFocus();\n   }\n\nSocialCalc.SpreadsheetControlNamesSave = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   if (name != \"\") {\n      s.ExecuteCommand(\"name define \"+name+\" \"+document.getElementById(s.idPrefix+\"namesvalue\").value+\"\\n\"+\n         \"name desc \"+name+\" \"+document.getElementById(s.idPrefix+\"namesdesc\").value);\n      }\n   }\n\nSocialCalc.SpreadsheetControlNamesDelete = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   if (name != \"\") {\n      s.ExecuteCommand(\"name delete \"+name);\n//      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\n//      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\n//      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\n//      SocialCalc.SpreadsheetControlNamesFillNameList();\n      }\n   SocialCalc.KeyboardFocus();\n   }\n\n// Clipboard\n\nSocialCalc.SpreadsheetControlClipboardOnclick = function(s, t) {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\n   document.getElementById(s.idPrefix+\"clipboardformat-tab\").checked = true;\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\n   return;\n   }\n\nSocialCalc.SpreadsheetControlClipboardFormat = function(which) {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, which);\n   }\n\nSocialCalc.SpreadsheetControlClipboardLoad = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var savetype = \"tab\";\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   if (document.getElementById(s.idPrefix+\"clipboardformat-csv\").checked) {\n      savetype = \"csv\";\n      }\n   else if (document.getElementById(s.idPrefix+\"clipboardformat-scsave\").checked) {\n      savetype = \"scsave\";\n      }\n   s.editor.EditorScheduleSheetCommands(\"loadclipboard \"+\n      SocialCalc.encodeForSave(\n         SocialCalc.ConvertOtherFormatToSave(document.getElementById(s.idPrefix+\"clipboardtext\").value, savetype)), true, false);\n   }\n\nSocialCalc.SpreadsheetControlClipboardClear = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\n   clipele.value = \"\";\n   s.editor.EditorScheduleSheetCommands(\"clearclipboard\", true, false);\n   clipele.focus();\n   }\n\nSocialCalc.SpreadsheetControlClipboardExport = function() {\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   if (s.ExportCallback) {\n      s.ExportCallback(s);\n      }\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n   }\n\n// Settings\n\nSocialCalc.SpreadsheetControlSettingsSwitch = function(target) {\n   SocialCalc.SettingControlReset();\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var sheettable = document.getElementById(s.idPrefix+\"sheetsettingstable\");\n   var celltable = document.getElementById(s.idPrefix+\"cellsettingstable\");\n   var sheettoolbar = document.getElementById(s.idPrefix+\"sheetsettingstoolbar\");\n   var celltoolbar = document.getElementById(s.idPrefix+\"cellsettingstoolbar\");\n   if (target==\"sheet\") {\n      sheettable.style.display = \"block\";\n      celltable.style.display = \"none\";\n      sheettoolbar.style.display = \"block\";\n      celltoolbar.style.display = \"none\";\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.sheetspanel);\n      }\n   else {\n      sheettable.style.display = \"none\";\n      celltable.style.display = \"block\";\n      sheettoolbar.style.display = \"none\";\n      celltoolbar.style.display = \"block\";\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.cellspanel);\n      }\n   }\n\nSocialCalc.SettingsControlSave = function(target) {\n   var range, cmdstr;\n   var s = SocialCalc.GetSpreadsheetControlObject();\n   var sc = SocialCalc.SettingsControls;\n   var panelobj = sc.CurrentPanel;\n   var attribs = SocialCalc.SettingsControlUnloadPanel(panelobj);\n\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\n   SocialCalc.KeyboardFocus();\n\n   if (target==\"sheet\") {\n      cmdstr = s.sheet.DecodeSheetAttributes(attribs);\n      }\n   else if (target==\"cell\") {\n      if (s.editor.range.hasrange) {\n         range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\n            SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\n         }\n      cmdstr = s.sheet.DecodeCellAttributes(s.editor.ecell.coord, attribs, range);\n      }\n   else { // Cancel\n      }\n   if (cmdstr) {\n      s.editor.EditorScheduleSheetCommands(cmdstr, true, false);\n      }\n   }\n\n///////////////////////\n//\n// SAVE / LOAD ROUTINES\n//\n///////////////////////\n\n//\n// result = SocialCalc.SpreadsheetControlCreateSpreadsheetSave(spreadsheet, otherparts)\n//\n// Saves the spreadsheet's sheet data, editor settings, and audit trail (redo stack).\n// The serialized data strings are concatenated together in multi-part MIME format.\n// The first part lists the types of the subsequent parts (e.g., \"sheet\", \"editor\", and \"audit\")\n// in this format:\n//   # comments\n//   version:1.0\n//   part:type1\n//   part:type2\n//   ...\n//\n// If otherparts is non-null, it is an object with:\n//   partname1: \"part contents - should end with \\n\",\n//   partname2: \"part contents - should end with \\n\"\n//\n\n\nSocialCalc.SpreadsheetControlCreateSpreadsheetSave = function(spreadsheet, otherparts) {\n\n   var result;\n\n   var otherpartsstr = \"\";\n   var otherpartsnames = \"\";\n   var partname, extranl;\n\n   if (otherparts) {\n      for (partname in otherparts) {\n         if (otherparts[partname].charAt(otherparts[partname]-1) != \"\\n\") {\n            extranl = \"\\n\";\n            }\n         else {\n            extranl = \"\";\n            }\n         otherpartsstr += \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n            otherparts[partname] + extranl;\n         otherpartsnames += \"part:\"+partname + \"\\n\";\n         }\n      }\n\n   result = \"socialcalc:version:1.0\\n\" +\n      \"MIME-Version: 1.0\\nContent-Type: multipart/mixed; boundary=\"+\n      spreadsheet.multipartBoundary + \"\\n\" +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      \"# SocialCalc Spreadsheet Control Save\\nversion:1.0\\npart:sheet\\npart:edit\\npart:audit\\n\" + otherpartsnames +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      spreadsheet.CreateSheetSave() +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      spreadsheet.editor.SaveEditorSettings() +\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\n      spreadsheet.sheet.CreateAuditString() +\n      otherpartsstr +\n      \"--\" + spreadsheet.multipartBoundary + \"--\\n\";\n\n   return result;\n\n   }\n\n\n//\n// parts = SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(spreadsheet, str)\n//\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\n//\n//    {type1: {start: startpos, end: endpos}, type2:...}\n//\n\nSocialCalc.SpreadsheetControlDecodeSpreadsheetSave = function(spreadsheet, str) {\n\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\n   var parts = {};\n   var partlist = [];\n\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\n   if (pos1 < 0) return parts;\n\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\n   mpregex.lastIndex = pos1;\n\n   searchinfo = mpregex.exec(str);\n   if (mpregex.lastIndex <= 0) return parts;\n   boundary = searchinfo[1];\n\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\n   boundaryregex.lastIndex = mpregex.lastIndex;\n\n   searchinfo = boundaryregex.exec(str); // find header top boundary\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\n   if (!searchinfo) return parts;\n   start = blanklineregex.lastIndex;\n   boundaryregex.lastIndex = start;\n   searchinfo = boundaryregex.exec(str); // find end of header\n   if (!searchinfo) return parts;\n   ending = searchinfo.index;\n\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\n   for (i=0;i<lines.length;i++) {\n      line=lines[i];\n      p = line.split(\":\");\n      switch (p[0]) {\n         case \"version\":\n            break;\n         case \"part\":\n            partlist.push(p[1]);\n            break;\n         }\n      }\n\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\n      blanklineregex.lastIndex = ending;\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\n      if (!searchinfo) return parts;\n      start = blanklineregex.lastIndex;\n      if (pnum==partlist.length-1) { // last one has different boundary\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\n         }\n      boundaryregex.lastIndex = start;\n      searchinfo = boundaryregex.exec(str); // find ending boundary\n      if (!searchinfo) return parts;\n      ending = searchinfo.index;\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\n      }\n\n   return parts;\n\n   }\n\n\n/*\n* SettingsControls\n*\n* Each settings panel has an object in the following form:\n*\n*    {ctrl-name1: {setting: setting-nameA, type: ctrl-type, id: id-component},\n*     ctrl-name2: {setting: setting-nameB, type: ctrl-type, id: id-component, initialdata: optional-initialdata-override},\n*     ...}\n*\n* The ctrl-types are names that correspond to:\n*\n*    SocialCalc.SettingsControls.Controls = {\n*       ctrl-type1: {\n*          SetValue: function(panel-obj, ctrl-name, {def: true/false, val: value}) {...;},\n*          ColorValues: if true, Onchanged converts between hex and RGB\n*          GetValue: function(panel-obj, ctrl-name) {...return {def: true/false, val: value};},\n*          Initialize: function(panel-obj, ctrl-name) {...;}, // used to fill dropdowns, etc.\n*          InitialData: control-dependent, // used by Initialize (if no panel ctrlname.initialdata)\n*          OnReset: function(ctrl-name) {...;}, // called to put down popups, etc.\n*          ChangedCallback: function(ctrl-name) {...;} // if not null, called by control when user changes value\n*       }\n*\n*/\n\nSocialCalc.SettingsControls = {\n   Controls: {},\n   CurrentPanel: null // panel object to search on events\n   };\n\n//\n// SocialCalc.SettingsControlSetCurrentPanel(panel-object)\n//\n\nSocialCalc.SettingsControlSetCurrentPanel = function(panelobj) {\n\n   SocialCalc.SettingsControls.CurrentPanel = panelobj;\n\n   SocialCalc.SettingsControls.PopupChangeCallback({panelobj: panelobj}, \"\", null);\n\n   }\n\n\n//\n// SocialCalc.SettingsControlInitializePanel(panel-object)\n//\n\nSocialCalc.SettingsControlInitializePanel = function(panelobj) {\n\n   var ctrlname;\n   var sc = SocialCalc.SettingsControls;\n\n   for (ctrlname in panelobj) {\n      if (ctrlname==\"name\") continue;\n      ctrl = sc.Controls[panelobj[ctrlname].type];\n      if (ctrl && ctrl.Initialize) ctrl.Initialize(panelobj, ctrlname);\n      }\n\n   }\n\n\n//\n// SocialCalc.SettingsControlLoadPanel(panel-object, attribs)\n//\n\nSocialCalc.SettingsControlLoadPanel = function(panelobj, attribs) {\n\n   var ctrlname;\n   var sc = SocialCalc.SettingsControls;\n\n   for (ctrlname in panelobj) {\n      if (ctrlname==\"name\") continue;\n      ctrl = sc.Controls[panelobj[ctrlname].type];\n      if (ctrl && ctrl.SetValue) ctrl.SetValue(panelobj, ctrlname, attribs[panelobj[ctrlname].setting]);\n      }\n\n   }\n\n//\n// attribs = SocialCalc.SettingsControlUnloadPanel(panel-object)\n//\n\nSocialCalc.SettingsControlUnloadPanel = function(panelobj) {\n\n   var ctrlname;\n   var sc = SocialCalc.SettingsControls;\n   var attribs = {};\n\n   for (ctrlname in panelobj) {\n      if (ctrlname==\"name\") continue;\n      ctrl = sc.Controls[panelobj[ctrlname].type];\n      if (ctrl && ctrl.GetValue) attribs[panelobj[ctrlname].setting] = ctrl.GetValue(panelobj, ctrlname);\n      }\n\n   return attribs;\n\n   }\n\n//\n// SocialCalc.SettingsControls.PopupChangeCallback\n//\n\nSocialCalc.SettingsControls.PopupChangeCallback = function(attribs, id, value) {\n\n   var sc = SocialCalc.Constants;\n\n   var ele = document.getElementById(\"sample-text\");\n\n   if (!ele || !attribs || !attribs.panelobj) return;\n\n   var idPrefix = SocialCalc.CurrentSpreadsheetControlObject.idPrefix;\n\n   var c = attribs.panelobj.name == \"cell\" ? \"c\" : \"\";\n\n   var v, a, parts, str1, str2, i;\n\n   parts = sc.defaultCellLayout.match(/^padding.(\\S+) (\\S+) (\\S+) (\\S+).vertical.align.(\\S+);$/) || [];\n\n   var cv = {color: [\"textcolor\"], backgroundColor: [\"bgcolor\", \"#FFF\"],\n             fontSize: [\"fontsize\", sc.defaultCellFontSize], fontFamily: [\"fontfamily\"],\n             paddingTop: [\"padtop\", parts[1]], paddingRight: [\"padright\", parts[2]],\n             paddingBottom: [\"padbottom\", parts[3]], paddingLeft: [\"padleft\", parts[4]],\n             verticalAlign: [\"alignvert\", parts[5]]};\n\n   for (a in cv) {\n      v = SocialCalc.Popup.GetValue(idPrefix+c+cv[a][0]) || cv[a][1] || \"\";\n      ele.style[a] = v;\n      }\n\n   if (c==\"c\") {\n      cv = {borderTop: \"cbt\", borderRight: \"cbr\", borderBottom: \"cbb\", borderLeft: \"cbl\"};\n      for (a in cv) {\n         v = SocialCalc.SettingsControls.BorderSideGetValue(attribs.panelobj, cv[a]);\n         ele.style[a] = v ? (v.val || \"\") : \"\";\n         }\n      v = SocialCalc.Popup.GetValue(idPrefix+\"calignhoriz\");\n      ele.style.textAlign = v || \"left\";\n      ele.childNodes[1].style.textAlign = v || \"right\";\n      }\n   else {\n      ele.style.border = \"\";\n      v = SocialCalc.Popup.GetValue(idPrefix+\"textalignhoriz\");\n      ele.style.textAlign = v || \"left\";\n      v = SocialCalc.Popup.GetValue(idPrefix+\"numberalignhoriz\");\n      ele.childNodes[1].style.textAlign = v || \"right\";\n      }\n\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"fontlook\");\n   parts = v ? (v.match(/^(\\S+) (\\S+)$/) || []) : [];\n   ele.style.fontStyle = parts[1] || \"\";\n   ele.style.fontWeight = parts[2] || \"\";\n\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"formatnumber\") || \"General\";\n   str1 = SocialCalc.FormatNumber.formatNumberWithFormat(9.8765, v, \"\");\n   str2 = SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5, v, \"\");\n   if (str2 != \"??-???-??&nbsp;??:??:??\") { // not bad date from negative number\n      str1 += \"<br>\"+str2;\n      }\n      \n   ele.childNodes[1].innerHTML = str1;\n\n   }\n\n//\n// PopupList Control\n//\n\nSocialCalc.SettingsControls.PopupListSetValue = function(panelobj, ctrlname, value) {\n\n   if (!value) {alert(ctrlname+\" no value\"); return;}\n\n   var sp = SocialCalc.Popup;\n\n   if (!value.def) {\n      sp.SetValue(panelobj[ctrlname].id, value.val);\n      }\n   else {\n      sp.SetValue(panelobj[ctrlname].id, \"\");\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.PopupListGetValue\n//\n\nSocialCalc.SettingsControls.PopupListGetValue = function(panelobj, ctrlname) {\n\n   var ctl = panelobj[ctrlname];\n   if (!ctl) return null;\n\n   var value = SocialCalc.Popup.GetValue(ctl.id);\n   if (value) {\n      return {def: false, val: value};\n      }\n   else {\n      return {def: true, val: 0};\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.PopupListInitialize\n//\n\nSocialCalc.SettingsControls.PopupListInitialize = function(panelobj, ctrlname) {\n\n   var i, val, pos, otext;\n   var sc = SocialCalc.SettingsControls;\n   var initialdata = panelobj[ctrlname].initialdata || sc.Controls[panelobj[ctrlname].type].InitialData || \"\";\n   initialdata = SocialCalc.LocalizeSubstrings(initialdata);\n   var optionvals = initialdata.split(/\\|/);\n\n   var options = [];\n\n   for (i=0; i<(optionvals.length||0); i++) {\n      val = optionvals[i];\n      pos = val.indexOf(\":\");\n      otext = val.substring(0, pos);\n      if (otext.indexOf(\"\\\\\")!=-1) { // escape any colons\n         otext = otext.replace(/\\\\c/g,\":\");\n         otext = otext.replace(/\\\\b/g,\"\\\\\");\n\n         }\n      otext = SocialCalc.special_chars(otext);\n      if (otext == \"[custom]\") {\n         options[i] = {o: SocialCalc.Constants.s_PopupListCustom, v: val.substring(pos+1), a:{custom: true}};\n         }\n      else if (otext == \"[cancel]\") {\n         options[i] = {o: SocialCalc.Constants.s_PopupListCancel, v: \"\", a:{cancel: true}};\n         }\n      else if (otext == \"[break]\") {\n         options[i] = {o: \"-----\", v: \"\", a:{skip: true}};\n         }\n      else if (otext == \"[newcol]\") {\n         options[i] = {o: \"\", v: \"\", a:{newcol: true}};\n         }\n      else {\n         options[i] = {o: otext, v: val.substring(pos+1)};\n         }\n      }\n\n   SocialCalc.Popup.Create(\"List\", panelobj[ctrlname].id, {});\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id, \n      {options: options, \n       attribs:{changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\n\n   }\n\n\n//\n// SocialCalc.SettingsControls.PopupListReset\n//\n\nSocialCalc.SettingsControls.PopupListReset = function(ctrlname) {\n\n   SocialCalc.Popup.Reset(\"List\");\n\n   }\n\nSocialCalc.SettingsControls.Controls.PopupList = {\n   SetValue: SocialCalc.SettingsControls.PopupListSetValue,\n   GetValue: SocialCalc.SettingsControls.PopupListGetValue,\n   Initialize: SocialCalc.SettingsControls.PopupListInitialize,\n   OnReset: SocialCalc.SettingsControls.PopupListReset,\n   ChangedCallback: null\n   }\n\n//\n// ColorChooser Control\n//\n\nSocialCalc.SettingsControls.ColorChooserSetValue = function(panelobj, ctrlname, value) {\n\n   if (!value) {alert(ctrlname+\" no value\"); return;}\n\n   var sp = SocialCalc.Popup;\n\n   if (!value.def) {\n      sp.SetValue(panelobj[ctrlname].id, value.val);\n      }\n   else {\n      sp.SetValue(panelobj[ctrlname].id, \"\");\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.ColorChooserGetValue\n//\n\nSocialCalc.SettingsControls.ColorChooserGetValue = function(panelobj, ctrlname) {\n\n   var value = SocialCalc.Popup.GetValue(panelobj[ctrlname].id);\n   if (value) {\n      return {def: false, val: value};\n      }\n   else {\n      return {def: true, val: 0};\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.ColorChooserInitialize\n//\n\nSocialCalc.SettingsControls.ColorChooserInitialize = function(panelobj, ctrlname) {\n\n   var i, val, pos, otext;\n   var sc = SocialCalc.SettingsControls;\n\n   SocialCalc.Popup.Create(\"ColorChooser\", panelobj[ctrlname].id, {});\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id,\n      {attribs:{title: \"&nbsp;\", moveable: true, width: \"106px\",\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\n\n   }\n\n\n//\n// SocialCalc.SettingsControls.ColorChooserReset\n//\n\nSocialCalc.SettingsControls.ColorChooserReset = function(ctrlname) {\n\n   SocialCalc.Popup.Reset(\"ColorChooser\");\n\n   }\n\nSocialCalc.SettingsControls.Controls.ColorChooser = {\n   SetValue: SocialCalc.SettingsControls.ColorChooserSetValue,\n   GetValue: SocialCalc.SettingsControls.ColorChooserGetValue,\n   Initialize: SocialCalc.SettingsControls.ColorChooserInitialize,\n   OnReset: SocialCalc.SettingsControls.ColorChooserReset,\n   ChangedCallback: null\n   }\n\n\n//\n// SocialCalc.SettingsControls.BorderSideSetValue\n//\n\nSocialCalc.SettingsControls.BorderSideSetValue = function(panelobj, ctrlname, value) {\n\n   var sc = SocialCalc.SettingsControls;\n   var ele, found, idname, parts;\n   var idstart = panelobj[ctrlname].id;\n\n   if (!value) {alert(ctrlname+\" no value\"); return;}\n\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\n   if (!ele) return;\n\n   if (value.val) { // border does not use default: it looks only to the value currently\n      ele.checked = true;\n      ele.value = value.val;\n      parts = value.val.match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\n      idname = idstart+\"-color\";\n      SocialCalc.Popup.SetValue(idname, parts[3]);\n      SocialCalc.Popup.SetDisabled(idname, false);\n      }\n   else {\n      ele.checked = false;\n      ele.value = value.val;\n      idname = idstart+\"-color\";\n      SocialCalc.Popup.SetValue(idname, \"\");\n      SocialCalc.Popup.SetDisabled(idname, true);\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.BorderSideGetValue\n//\n\nSocialCalc.SettingsControls.BorderSideGetValue = function(panelobj, ctrlname) {\n\n   var sc = SocialCalc.SettingsControls;\n   var ele, value;\n   var idstart = panelobj[ctrlname].id;\n\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\n   if (!ele) return;\n\n\n   if (ele.checked) { // on\n      value = SocialCalc.Popup.GetValue(idstart+\"-color\");\n      value = \"1px solid \" + (value || \"rgb(0,0,0)\");\n      return {def: false, val: value};\n      }\n   else { // off\n      return {def: false, val: \"\"};\n      }\n\n   }\n\n//\n// SocialCalc.SettingsControls.BorderSideInitialize\n//\n\nSocialCalc.SettingsControls.BorderSideInitialize = function(panelobj, ctrlname) {\n\n   var sc = SocialCalc.SettingsControls;\n   var idstart = panelobj[ctrlname].id;\n\n   SocialCalc.Popup.Create(\"ColorChooser\", idstart+\"-color\", {});\n   SocialCalc.Popup.Initialize(idstart+\"-color\",\n      {attribs:{title: \"&nbsp;\", width: \"106px\", moveable: true,\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\n\n   }\n\n\n//\n// SocialCalc.SettingsControlOnchangeBorder = function(ele)\n//\n\nSocialCalc.SettingsControlOnchangeBorder = function(ele) {\n\n   var idname, value, found, ele2;\n   var sc = SocialCalc.SettingsControls;\n   var panelobj = sc.CurrentPanel;\n\n   var nameparts = ele.id.match(/(^.*\\-)(\\w+)\\-(\\w+)\\-(\\w+)$/);\n   if (!nameparts) return;\n   var prefix = nameparts[1];\n   var ctrlname = nameparts[2];\n   var ctrlsubid = nameparts[3]\n   var ctrlidsuffix = nameparts[4];\n   var ctrltype = panelobj[ctrlname].type;\n\n   switch (ctrlidsuffix) {\n      case \"bcb\": // border checkbox\n         if (ele.checked) {\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: ele.value || \"1px solid rgb(0,0,0)\"});\n            }\n         else {\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: \"\"});\n            }\n         break;\n      }\n\n   }\n\n\nSocialCalc.SettingsControls.Controls.BorderSide = {\n   SetValue: SocialCalc.SettingsControls.BorderSideSetValue,\n   GetValue: SocialCalc.SettingsControls.BorderSideGetValue,\n   OnClick: SocialCalc.SettingsControls.ColorComboOnClick,\n   Initialize: SocialCalc.SettingsControls.BorderSideInitialize,\n   InitialData: {thickness: \"1 pixel:1px\", style: \"Solid:solid\"},\n   ChangedCallback: null\n   }\n\n\nSocialCalc.SettingControlReset = function() {\n\n   var sc = SocialCalc.SettingsControls;\n   var ctrlname;\n\n   for (ctrlname in sc.Controls) {\n      if (sc.Controls[ctrlname].OnReset) sc.Controls[ctrlname].OnReset(ctrlname);\n      }\n   }\n\n\n/**********************\n*\n* CtrlSEditor implementation for editing SocialCalc.OtherSaveParts\n*\n*/\n\nSocialCalc.OtherSaveParts = {}; // holds other parts to save - must be set when loaded if you want to keep\n\nSocialCalc.CtrlSEditor = function(whichpart) {\n\n   var strtoedit, partname;\n   if (whichpart.length > 0) {\n      strtoedit = SocialCalc.special_chars(SocialCalc.OtherSaveParts[whichpart] || \"\");\n      }\n   else {\n      strtoedit = \"Listing of Parts\\n\";\n      for (partname in SocialCalc.OtherSaveParts) {\n         strtoedit += SocialCalc.special_chars(\"\\nPart: \"+partname+\"\\n=====\\n\"+SocialCalc.OtherSaveParts[partname]+\"\\n\");\n         }\n      }\n   var editbox = document.createElement(\"div\");\n   editbox.style.cssText = \"position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;\";\n   editbox.id = \"socialcalc-editbox\";\n   editbox.innerHTML = whichpart+'<br><br><textarea id=\"socialcalc-editbox-textarea\" style=\"width:250px;height:200px;\">'+\n      strtoedit + '</textarea><br><br><input type=button ' +\n      'onclick=\"SocialCalc.CtrlSEditorDone (\\'socialcalc-editbox\\', \\''+whichpart+'\\');\" value=\"OK\">';\n   document.body.appendChild(editbox);\n\n   var ebta = document.getElementById(\"socialcalc-editbox-textarea\");\n   ebta.focus();\n   SocialCalc.CmdGotFocus(ebta);\n\n   }\n\nSocialCalc.CtrlSEditorDone = function(idprefix, whichpart) {\n\n   var edittextarea = document.getElementById(idprefix+\"-textarea\");\n   var text = edittextarea.value;\n   if (whichpart.length > 0) {\n      if (text.length > 0) {\n         SocialCalc.OtherSaveParts[whichpart] = text;\n         }\n      else {\n         delete SocialCalc.OtherSaveParts[whichpart];\n         }\n      }\n\n   var editbox = document.getElementById(idprefix);\n   SocialCalc.KeyboardFocus();\n   editbox.parentNode.removeChild(editbox);\n\n   }\n\n//\n// SocialCalcViewer\n//\n/*\n// The code module of the SocialCalc package that lets you embed a spreadsheet viewer\n// with an optional simple toolbar into a web page.\n//\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\n// All Rights Reserved.\n//\n*/\n\n/*\n\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\n\nEXHIBIT A. Common Public Attribution License Version 1.0.\n\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \nSections 14 and 15 have been added to cover use of software over a computer network and provide for \nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \nconsistent with Exhibit B.\n\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \nKIND, either express or implied. See the License for the specific language governing rights and \nlimitations under the License.\n\nThe Original Code is SocialCalc JavaScript SpreadsheetViewer.\n\nThe Original Developer is the Initial Developer.\n\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\n\nContributor: Dan Bricklin.\n\n\nEXHIBIT B. Attribution Information\n\nWhen the SpreadsheetViewer is producing and/or controlling the display the Graphic Image must be\ndisplayed on the screen visible to the user in a manner comparable to that in the \nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\nthat image. The image must be linked to the Attribution URL so as to access that page\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\nfactual prominent attribution in a form similar to that in the \"about\" display included\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\n\nAttribution Copyright Notice:\n\n Copyright (C) 2010 Socialtext, Inc.\n All Rights Reserved.\n\nAttribution Phrase (not exceeding 10 words): SocialCalc\n\nAttribution URL: http://www.socialcalc.org/\n\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\na suitable replacement from http://www.socialcalc.org/licenses specified as\nbeing for SocialCalc.\n\nDisplay of Attribution Information is required in Larger Works which are defined \nin the CPAL as a work which combines Covered Code or portions thereof with code \nnot governed by the terms of the CPAL.\n\n*/\n\n//\n// Some of the other files in the SocialCalc package are licensed under\n// different licenses. Please note the licenses of the modules you use.\n//\n// Code History:\n//\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\n// JavaScript version of the code, not the SocialCalc Perl code.\n//\n\n/*\n\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\n\n*/\n\n   var SocialCalc;\n   if (!SocialCalc) {\n      alert(\"Main SocialCalc code module needed\");\n      SocialCalc = {};\n      }\n   if (!SocialCalc.TableEditor) {\n      alert(\"SocialCalc TableEditor code module needed\");\n      }\n\n// *************************************\n//\n// SpreadsheetViewer class:\n//\n// *************************************\n\n// Global constants:\n\n   SocialCalc.CurrentSpreadsheetViewerObject = null; // right now there can only be one active at a time\n\n\n// Constructor:\n\nSocialCalc.SpreadsheetViewer = function(idPrefix) {\n\n   var scc = SocialCalc.Constants;\n\n   // Properties:\n\n   this.parentNode = null;\n   this.spreadsheetDiv = null;\n   this.requestedHeight = 0;\n   this.requestedWidth = 0;\n   this.requestedSpaceBelow = 0;\n   this.height = 0;\n   this.width = 0;\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\n\n   // Dynamic properties:\n\n   this.sheet = null;\n   this.context = null;\n   this.editor = null;\n\n   this.spreadsheetDiv = null;\n   this.editorDiv = null;\n\n   this.sortrange = \"\"; // remembered range for sort tab\n\n   // Constants:\n\n   this.idPrefix = idPrefix || \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\n\n   this.statuslineheight = scc.SVStatuslineheight; // in pixels\n   this.statuslineCSS = scc.SVStatuslineCSS;\n\n   // Callbacks:\n\n   // Initialization Code:\n\n   this.sheet = new SocialCalc.Sheet();\n   this.context = new SocialCalc.RenderContext(this.sheet);\n   // eddy SpreadsheetViewer {\n   if(SocialCalc._app == true || SocialCalc._view == true) scc.defaultImagePrefix = this.imagePrefix = \"../\"+ this.imagePrefix;\n   if(SocialCalc._app == true) {\n     this.context.showGrid= false; \n     this.context.showRCHeaders= false;\n   } else {\n     this.context.showGrid= true; \n     this.context.showRCHeaders= true;     \n   }\n   // } SpreadsheetViewer\n   this.editor = new SocialCalc.TableEditor(this.context);\n   this.editor.noEdit = true;\n   this.editor.StatusCallback.statusline =\n      {func: SocialCalc.SpreadsheetViewerStatuslineCallback,\n       params: {}};\n   this.hasStatusLine = true; // default\n//   this.statuslineHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td width=\"100%\" style=\"overflow:hidden;\">{status}</td><td><a href=\"\">Will&nbsp;be&nbsp;link</a></td></tr></table>';\n   this.statuslineHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td width=\"100%\" style=\"overflow:hidden;\">{status}</td><td>&nbsp;</td></tr></table>';\n   this.statuslineFull = true;\n   this.noRecalc = true; // don't do a recalc when loaded, so no need for external sheet routines\n\n   // Repeating macro info\n\n   this.repeatingMacroTimer = null;\n   this.repeatingMacroInterval = 60; // default to 60 seconds\n   this.repeatingMacroCommands = \"\"; // what to execute\n\n\n   SocialCalc.CurrentSpreadsheetViewerObject = this; // remember this for rendezvousing on events\n\n   return;\n\n   }\n\n// Methods:\n\nSocialCalc.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer =\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetViewer(this, node, height, width, spacebelow);};\nSocialCalc.SpreadsheetViewer.prototype.LoadSave = function(str) {return SocialCalc.SpreadsheetViewerLoadSave(this, str);};\nSocialCalc.SpreadsheetViewer.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\nSocialCalc.SpreadsheetViewer.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\nSocialCalc.SpreadsheetViewer.prototype.DecodeSpreadsheetSave = \n   function(str) {return SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(this, str);};\n\n// Sheet Methods to make things a little easier:\n\nSocialCalc.SpreadsheetViewer.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\n\n\n// Functions:\n\n//\n// InitializeSpreadsheetViewer(spreadsheet, node, height, width, spacebelow)\n//\n// Creates the control elements and makes them the child of node (string or element).\n// If present, height and width specify size.\n// If either is 0 or null (missing), the maximum that fits on the screen\n// (taking spacebelow into account) is used.\n//\n// You should do a redisplay or recalc (which redisplays) after running this.\n//\n\nSocialCalc.InitializeSpreadsheetViewer = function(spreadsheet, node, height, width, spacebelow) {\n\n   var scc = SocialCalc.Constants;\n   var SCLoc = SocialCalc.LocalizeString;\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\n\n   var html, child, i, vname, v, style, button, bele;\n   var tabs = spreadsheet.tabs;\n   var views = spreadsheet.views;\n\n   spreadsheet.requestedHeight = height;\n   spreadsheet.requestedWidth = width;\n   spreadsheet.requestedSpaceBelow = spacebelow;\n\n   if (typeof node == \"string\") node = document.getElementById(node);\n\n   if (node == null) {\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\n      }\n\n   spreadsheet.parentNode = node;\n\n   // create node to hold spreadsheet view\n\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\n\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\n\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\n      node.removeChild(child);\n      }\n\n   node.appendChild(spreadsheet.spreadsheetDiv);\n\n   // create sheet div\n\n   spreadsheet.nonviewheight = spreadsheet.hasStatusLine ? spreadsheet.statuslineheight : 0;\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\n\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\n\n   // create statusline\n\n   if (spreadsheet.hasStatusLine) {\n      spreadsheet.statuslineDiv = document.createElement(\"div\");\n      spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\n      spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\n         (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\n         (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\n      spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\n      spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\n      spreadsheet.editor.StatusCallback.statusline =\n         {func: SocialCalc.SpreadsheetViewerStatuslineCallback,\n          params: {spreadsheetobj:spreadsheet}};\n      }\n\n   // eddy InitializeSpreadsheetViewer {\n   if(SocialCalc._app == true) {\n     spreadsheet.formDataViewer = new SocialCalc.SpreadsheetViewer(\"te_FormData-\");\n     // remove callback to stop drawing of table.\n     spreadsheet.formDataViewer.sheet.statuscallback = null;\n     // setup app viewer object\n     SocialCalc.CurrentSpreadsheetViewerObject = spreadsheet;\n   }\n   \n   // done - refresh screen needed\n\n   return;\n\n   }\n\nSocialCalc.SpreadsheetViewerLoadSave = function(spreadsheet, savestr) {\n\n   var rmstr, pos, t, t2;\n\n   var parts = spreadsheet.DecodeSpreadsheetSave(savestr);\n   if (parts) {\n      if (parts.sheet) {\n         spreadsheet.sheet.ResetSheet();\n         spreadsheet.sheet.ParseSheetSave(savestr.substring(parts.sheet.start, parts.sheet.end));\n         }\n      if (parts.edit) {\n         spreadsheet.editor.LoadEditorSettings(savestr.substring(parts.edit.start, parts.edit.end));\n         }\n      if (parts.startupmacro) { // executed now\n         spreadsheet.editor.EditorScheduleSheetCommands(savestr.substring(parts.startupmacro.start, parts.startupmacro.end), false, true);\n         }\n      if (parts.repeatingmacro) { // first line tells how many seconds before first execution. Last cmd must be \"cmdextension repeatmacro delay\" to continue repeating.\n         rmstr = savestr.substring(parts.repeatingmacro.start, parts.repeatingmacro.end);\n         rmstr = rmstr.replace(\"\\r\", \"\"); // make sure no CR, only LF\n         pos = rmstr.indexOf(\"\\n\");\n         if (pos > 0) {\n            t = rmstr.substring(0, pos)-0; // get number\n            t2 = t;\n//            if (!(t > 0)) t = 60; // handles NAN, too\n            spreadsheet.repeatingMacroInterval = t;\n            spreadsheet.repeatingMacroCommands = rmstr.substring(pos+1);\n            if (t2 > 0) { // zero means don't start yet\n               spreadsheet.repeatingMacroTimer = window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro, spreadsheet.repeatingMacroInterval * 1000);\n               }\t\n            }\n         }\n      }\n   if (spreadsheet.editor.context.sheetobj.attribs.recalc==\"off\" || spreadsheet.noRecalc) {\n      spreadsheet.editor.ScheduleRender();\n      }\n   else {\n      spreadsheet.editor.EditorScheduleSheetCommands(\"recalc\");\n      }\n   }\n\n//\n// SocialCalc.SpreadsheetViewerDoRepeatingMacro\n//\n// Called by a timer. Executes repeatingMacroCommands once.\n// Use the \"startcmdextension repeatmacro delay\" command last to schedule this again.\n//\n\nSocialCalc.SpreadsheetViewerDoRepeatingMacro = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\n   var editor = spreadsheet.editor;\n\n   spreadsheet.repeatingMacroTimer = null;\n\n   SocialCalc.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro = {func:SocialCalc.SpreadsheetViewerRepeatMacroCommand, data:null};\n\n   editor.EditorScheduleSheetCommands(spreadsheet.repeatingMacroCommands);\n\n}\n\nSocialCalc.SpreadsheetViewerRepeatMacroCommand = function(name, data, sheet, cmd, saveundo) {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\n\n   var rest = cmd.RestOfString();\n   var t = rest-0; // get number\n   if (!(t > 0)) t = spreadsheet.repeatingMacroInterval; // handles NAN, too, using last value\n   spreadsheet.repeatingMacroInterval = t;\n\n   spreadsheet.repeatingMacroTimer = window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro, spreadsheet.repeatingMacroInterval * 1000);\n\n}\n\nSocialCalc.SpreadsheetViewerStopRepeatingMacro = function() {\n\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\n\n   if (spreadsheet.repeatingMacroTimer) {\n      window.clearTimeout(spreadsheet.repeatingMacroTimer);\n      spreadsheet.repeatingMacroTimer = null;\n      }\n}\n\n//\n// SocialCalc.SpreadsheetViewerDoButtonCmd(e, buttoninfo, bobj)\n//\n// xxx\n//\n\nSocialCalc.SpreadsheetViewerDoButtonCmd = function(e, buttoninfo, bobj) {\n\n   var obj = bobj.element;\n   var which = bobj.functionobj.command;\n\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\n   var editor = spreadsheet.editor;\n\n   switch (which) {\n      case \"recalc\":\n         editor.EditorScheduleSheetCommands(\"recalc\");\n         break;\n\n      default:\n         break;\n      }\n\n   if (obj && obj.blur) obj.blur();\n   SocialCalc.KeyboardFocus();   \n\n   }\n\n\n//\n// outstr = SocialCalc.LocalizeString(str)\n//\n// SocialCalc function to make localization easier.\n// If str is \"Text to localize\", it returns\n// SocialCalc.Constants.s_loc_text_to_localize if\n// it exists, or else with just \"Text to localize\".\n// Note that spaces are replaced with \"_\" and other special\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\n// would look for SocialCalc.Constants.s_loc_a_X_b.\n//\n\nSocialCalc.LocalizeString = function(str) {\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\n   if (!cstr) { // no - look up\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\n      SocialCalc.LocalizeStringList[str] = cstr;\n      }\n   return cstr;\n   }\n\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\n\n//\n// outstr = SocialCalc.LocalizeSubstrings(str)\n//\n// SocialCalc function to make localization easier using %loc and %scc.\n//\n// Replaces sections of str with:\n//    %loc!Text to localize!\n// with SocialCalc.Constants.s_loc_text_to_localize if\n// it exists, or else with just \"Text to localize\".\n// Note that spaces are replaced with \"_\" and other special\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\n// would look for SocialCalc.Constants.s_loc_a_X_b.\n// Uses SocialCalc.LocalizeString for this.\n//\n// Replaces sections of str with:\n//    %ssc!constant-name!\n// with SocialCalc.Constants.constant-name.\n// If the constant doesn't exist, throws and alert.\n//\n\nSocialCalc.LocalizeSubstrings = function(str) {\n\n   var SCLoc = SocialCalc.LocalizeString;\n\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\n      if (t==\"ssc\") {\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\n         }\n      else {\n         return SCLoc(c);\n         }\n      });\n\n   }\n\n//\n// obj = GetSpreadsheetViewerObject()\n//\n// Returns the current spreadsheet view object\n//\n\nSocialCalc.GetSpreadsheetViewerObject = function() {\n\n   var csvo = SocialCalc.CurrentSpreadsheetViewerObject;\n   if (csvo) return csvo;\n\n   throw (\"No current SpreadsheetViewer object.\");\n\n   }\n\n\n//\n// SocialCalc.DoOnResize(spreadsheet)\n//\n// Processes an onResize event, setting the different views.\n//\n\nSocialCalc.DoOnResize = function(spreadsheet) {\n\n   var v;\n   var views = spreadsheet.views;\n\n   var needresize = spreadsheet.SizeSSDiv();\n   if (!needresize) return;\n\n   for (vname in views) {\n      v = views[vname].element;\n      v.style.width = spreadsheet.width + \"px\";\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\n      }\n\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\n\n   }\n\n\n//\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\n//\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\n// Sets ssdiv to that.\n// Return true if different than existing values.\n//\n\nSocialCalc.SizeSSDiv = function(spreadsheet) {\n\n   var sizes, pos, resized, nodestyle, newval;\n   var fudgefactorX = 10; // for IE\n   var fudgefactorY = 10;\n\n   resized = false;\n\n   sizes = SocialCalc.GetViewportInfo();\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\n   pos.bottom = 0;\n   pos.right = 0;\n\n   nodestyle = spreadsheet.parentNode.style;\n\n   if (nodestyle.marginTop) {\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\n      }\n   if (nodestyle.marginBottom) {\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\n      }\n   if (nodestyle.marginLeft) {\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\n      }\n   if (nodestyle.marginRight) {\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\n      }\n\n   newval = spreadsheet.requestedHeight ||\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\n               (spreadsheet.requestedSpaceBelow || 0);\n   if (spreadsheet.height != newval) {\n      spreadsheet.height = newval;\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\n      resized = true;\n      }\n   newval = spreadsheet.requestedWidth ||\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\n   if (spreadsheet.width != newval) {\n      spreadsheet.width = newval;\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\n      resized = true;\n      }\n\n   spreadsheet.spreadsheetDiv.style.position = \"relative\";\n\n   return resized;\n\n   }\n\n\n//\n// SocialCalc.SpreadsheetViewerStatuslineCallback\n//\n\nSocialCalc.SpreadsheetViewerStatuslineCallback = function(editor, status, arg, params) {\n\n   var spreadsheet = params.spreadsheetobj;\n   var slstr = \"\";\n\n   if (spreadsheet && spreadsheet.statuslineDiv) {\n      if (spreadsheet.statuslineFull) {\n         slstr = editor.GetStatuslineString(status, arg, params);\n         }\n      else {\n         slstr = editor.ecell.coord;\n         }\n      slstr = spreadsheet.statuslineHTML.replace(/\\{status\\}/, slstr);\n      spreadsheet.statuslineDiv.innerHTML = slstr;\n      }\n\n   switch (status) {\n      case \"cmdendnorender\":\n      case \"calcfinished\":\n      case \"doneposcalc\":\n         break; // not updating Recalc button since no toolbar\n\n      default:\n         break;\n      }\n\n   }\n\n\n//\n// SocialCalc.CmdGotFocus(obj)\n//\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\n//\n\nSocialCalc.CmdGotFocus = function(obj) {\n\n   SocialCalc.Keyboard.passThru = obj;\n\n   }\n\n\n//\n// result = SocialCalc.SpreadsheetViewerCreateSheetHTML(spreadsheet)\n//\n// Returns the HTML representation of the whole spreadsheet\n//\n\nSocialCalc.SpreadsheetViewerCreateSheetHTML = function(spreadsheet) {\n\n   var context, div, ele;\n\n   var result = \"\";\n\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\n   div = document.createElement(\"div\");\n   ele = context.RenderSheet(null, {type: \"html\"});\n   div.appendChild(ele);\n   delete context;\n   result = div.innerHTML;\n   delete ele;\n   delete div;\n   return result;\n\n   }\n\n\n///////////////////////\n//\n// LOAD ROUTINE\n//\n///////////////////////\n\n//\n// parts = SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(spreadsheet, str)\n//\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\n//\n//    {type1: {start: startpos, end: endpos}, type2:...}\n//\n\nSocialCalc.SpreadsheetViewerDecodeSpreadsheetSave = function(spreadsheet, str) {\n\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\n   var parts = {};\n   var partlist = [];\n\nvar hasreturnonly = /[^\\n]\\r[^\\n]/;\nif (hasreturnonly.test(str)) {\nstr = str.replace(/([^\\n])\\r([^\\n])/g, \"$1\\r\\n$2\");\n}\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\n   if (pos1 < 0) return parts;\n\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\n   mpregex.lastIndex = pos1;\n\n   searchinfo = mpregex.exec(str);\n   if (mpregex.lastIndex <= 0) return parts;\n   boundary = searchinfo[1];\n\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\n   boundaryregex.lastIndex = mpregex.lastIndex;\n\n   searchinfo = boundaryregex.exec(str); // find header top boundary\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\n   if (!searchinfo) return parts;\n   start = blanklineregex.lastIndex;\n   boundaryregex.lastIndex = start;\n   searchinfo = boundaryregex.exec(str); // find end of header\n   if (!searchinfo) return parts;\n   ending = searchinfo.index;\n\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\n   for (i=0;i<lines.length;i++) {\n      line=lines[i];\n      p = line.split(\":\");\n      switch (p[0]) {\n         case \"version\":\n            break;\n         case \"part\":\n            partlist.push(p[1]);\n            break;\n         }\n      }\n\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\n      blanklineregex.lastIndex = ending;\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\n      if (!searchinfo) return parts;\n      start = blanklineregex.lastIndex;\n      if (pnum==partlist.length-1) { // last one has different boundary\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\n         }\n      boundaryregex.lastIndex = start;\n      searchinfo = boundaryregex.exec(str); // find ending boundary\n      if (!searchinfo) return parts;\n      ending = searchinfo.index;\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\n      }\n\n   return parts;\n\n   }\n\n\n// END OF FILE\n\nif('undefined' === typeof document) {\n  // We don't really need a DOM-based presentation layer on the server\n  SocialCalc.GetEditorCellElement = function () {};\n  SocialCalc.ReplaceCell = function () {};\n  SocialCalc.EditorRenderSheet = function () {};\n  SocialCalc.SpreadsheetControlSortSave = function () { return \"\" };\n  SocialCalc.SpreadsheetControlStatuslineCallback = function () {};\n  SocialCalc.DoPositionCalculations = function (editor) {\n      SocialCalc.EditorSheetStatusCallback(\n\t  null, \"doneposcalc\", null, editor\n      );\n  }\n}\n\n// Compatibility with webworker-threads\nif (typeof self !== 'undefined' && self.thread) {\n    window.setTimeout = function (cb, ms) {\n        if (ms <= 1) { self.thread.nextTick(cb); }\n    };\n    window.clearTimeout = function () {};\n}\n\n    // Just return a value to define the module export.\n    return SocialCalc;\n}));\n","(function() {\n\nClass = function(classDefinition, classWrapper) {\n    if (!classDefinition) throw(\"Class requires a class definition string as its first argument\");\n    if (!classWrapper) throw(\"Class requires a class wrapper function as its second argument\");\n\n    if (! classDefinition.match(/^([\\w\\.]+)(?:\\(\\s*([\\w\\.]+)\\s*\\))?(?:\\s+(.*?)\\s*)?$/))\n        throw(\"Can't parse Class Definition: '\" + classDefinition + \"'\");\n    var className = RegExp.$1;\n    var baseClassName = RegExp.$2 || '';\n    var options = [];\n    if (RegExp.$3) {\n        options = RegExp.$3.split(/\\s+/);\n    }\n    var incValues = [];\n    var strict = true;\n    for (var i = 0, l = options.length; i < l; i++) {\n        var option = options[i];\n        if (option == '-nostrict') {\n            strict = false;\n        }\n        if (option.match(/^-inc=(.+)$/)) {\n            incValues = RegExp.$1.split(',');\n        }\n    }\n\n    var parts = className.split('.');\n    var klass = Class.global;\n    for (var i = 0; i < parts.length; i++) {\n        if (! klass[parts[i]]) {\n            klass[parts[i]] = function() {\n                try { this.init() } catch(e) {}\n            };\n        }\n        klass = klass[parts[i]];\n    }\n    klass.className = className;\n\n    klass.isa = function(baseName) {\n        klass.baseClassName = baseName;\n        if (baseName) {\n            klass.prototype = eval('new ' + baseName + '()');\n            klass.prototype.superFunc = function(name) {\n                return eval(baseName).prototype[name];\n            }\n        }\n    };\n    klass.isa(baseClassName);\n\n    klass.global = Class.global;\n\n    klass.addGlobal = function() {\n        this.newGlobals++;\n        return Class.global;\n    }\n\n    klass.extend = function(pairs) {\n        if (typeof pairs != 'object') {\n            throw(\"extend requires an object of name:value pairs\");\n        }\n        for (var name in pairs) {\n            klass.prototype[name] = pairs[name];\n        }\n    }\n\n    for (var ii = 0, ll = incValues.length; ii < ll; ii++) {\n        var value = incValues[ii];\n        if (value == 'proto') {\n            incValues[ii] = klass.prototype;\n        }\n        else if (value == 'this') {\n            incValues[ii] = klass;\n        }\n        else {\n            incValues[ii] = Class.global[value];\n        }\n    }\n\n    if (strict) {\n        Class.eval_strict(classWrapper, klass, incValues);\n    }\n    else {\n        classWrapper.apply(klass, incValues);\n    }\n\n    return klass;\n};\n\n})();\n\nClass.global = this;\n\nClass.eval_strict = function(classWrapper, klass, incValues) {\n    var globals = 0;\n    var last_key;\n\n    for (var k in Class.global) {\n        globals++;\n        last_key = k;\n    }\n\n    klass.newGlobals = 0;\n\n    classWrapper.apply(klass, incValues);\n\n    var globals_after = 0;\n    for (var k in Class.global) {\n        globals_after++;\n    }\n\n    if (globals + klass.newGlobals != globals_after) {\n        throw(\"Class '\" + klass.className + \"' defines \" + (globals_after - globals) + \" new global JavaScript variables without using this.addGlobal()\");\n    }\n\n    delete klass.newGlobals;\n};\n\n","Class('Document.Emitter', function() {\n\nvar proto = this.prototype;\nproto.className = 'Document.Emitter';\n\nproto.instantiate = function() {\n    return eval('new ' + this.className + '()');\n}\n\nproto.init = function() {\n    this.output = '';\n}\n\nproto.content = function() {\n    return this.output;\n}\n\nproto.insert = function(receiver) {\n    this.output += receiver.output;\n}\n\n});\n","Class('Document.Emitter.HTML(Document.Emitter)', function() {\n\nvar proto = this.prototype;\nproto.className = 'Document.Emitter.HTML';\n\nproto.begin_node = function(node) {\n    var tag = node.type;\n    switch (tag) {\n        case 'asis': case 'line': return;\n        case 'br': case 'hr': {\n            this.output += '<'+tag+' />';\n            return;\n        }\n        case 'html': {\n            this.output += '<span class=\"wafl\">Raw HTML section. Edit in Wiki Text mode.</span>';\n            return;\n        }\n        case 'waflparagraph': case 'waflphrase': case 'im': {\n            if (node._wafl.match(/^image:\\s*(\\S+)(?:\\s+size=(\\w+))?/)) {\n                var onload = \"if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/\"+node._label.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"\\\\'\").replace(/\\\\/g, \"\\\\\\\\\")+\"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'\";\n\n                var imageName = RegExp.$1;\n                var width = RegExp.$2;\n                switch (width) {\n                    case 'small':  { width = '100'; break; }\n                    case 'medium': { width = '300'; break; }\n                    case 'large':  { width = '600'; break; }\n                }\n                if (width) {\n                    width = ' width=\"'+width+'\"';\n                }\n                this.output += '<img src=\"'+imageName.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")+'\" onload=\"'+onload+'\"'+width+' />';\n                return;\n            }\n            this.output += '<span class=\"wafl\">'+node._label.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"\\\\'\").replace(/\\\\/g, \"\\\\\\\\\")+'</span>';\n\n            return;\n        }\n        case 'a': case 'wikilink': {\n            this.output += '<a href=\"'+encodeURI(node._href)+'\">';\n            return;\n        }\n        case 'file': {\n            this.output += '<a title=\"(network resource)\" href=\"'+encodeURI(node._href)+'\">';\n            return;\n        }\n        case 'ul': case 'ol': case 'table': case 'tr': {\n            this.output += '<'+tag+\">\\n\";\n            return;\n        }\n        default: {\n            this.output += '<'+tag+'>';\n            return;\n        }\n    }\n}\n\nproto.end_node = function(node) {\n    var tag = node.type;\n    switch (tag) {\n        case 'asis': case 'br': case 'hr': case 'html': case 'waflparagraph': case 'waflphrase': case 'im': return;\n        case 'line': {\n            this.output += '<br />';\n            return;\n        }\n        case 'file': case 'wikilink': {\n            this.output += '</a>';\n            return;\n        }\n        default: {\n            if (tag.search(/^(?:p|ul|ol|li|h\\d|table|tr|td)$/) == 0) {\n                this.output += '</'+tag+\">\\n\";\n            }\n            else {\n                this.output += '</'+tag+'>';\n            }\n            return;\n        }\n    }\n    return;\n}\n\nproto.text_node = function(text) {\n    this.output += text\n        .replace(/&/g, '&amp;')\n        .replace(/>/g, '&gt;')\n        .replace(/</g, '&lt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&apos;');\n}\n\n});\n","Class('Document.Parser', function() {\n\nvar proto = this.prototype;\n\nproto.className = 'Document.Parser';\n\nproto.init = function() {}\n\nproto.parse = function(input, receiver) {\n    this.input = (input.search(/\\n$/) == -1) ? input+\"\\n\" : input;\n    if (receiver) this.receiver = receiver;\n    this.receiver.init();\n    this.grammar = this.create_grammar();\n    this.parse_blocks('top');\n    return this.receiver.content();\n}\n\nproto.create_grammar = function() {\n    throw \"Please define create_grammar in a derived class of Document.Parser.\";\n};\n\n//------------------------------------------------------------------------------\n// Parse input into a series of blocks. With each iteration the parser must\n// match a block at position 0 of the text, and remove that block from the\n// input reparse it further. This continues until there is no input left.\n//------------------------------------------------------------------------------\nproto.parse_blocks = function(container_type) {\n    var types = this.grammar[container_type].blocks; // Document.contains[container_type];\n    if (!types) return;\n    while (this.input.length) {\n        var length = this.input.length;\n        for (var i = 0; i < types.length; i++) {\n            var type = types[i];\n            var matched = this.find_match('matched_block', type);\n            if (matched) {\n                this.input = this.input.substr(matched.end);\n                this.handle_match(type, matched);\n                break;\n            }\n        }\n        if (this.input.length >= length)\n            throw this.classname + ': Reduction error for:\\n' + this.input +\n            '\\n' + JSON.stringify(this);\n    }\n    return;\n}\n\nproto.handle_match = function(type, match) {\n    var grammar = this.grammar[type];\n    var parse = grammar.blocks ? 'parse_blocks' : 'parse_phrases';\n    // console.log(\"Subparsing \" + parse + '(' + type + '): ');\n    // console.log(match);\n    this.subparse(parse, match, type, grammar.filter);\n}\n\nproto.find_match = function(matched_func, type) {\n    var re = this.grammar[type].match;\n    if (!re) throw 'no regexp for type: ' + type;\n    var capture = this.input.match(re);\n    if (capture) {\n        // console.log(\"Found match \" + type + \" - \" + matched_func);\n        var match = this[matched_func].call(this, capture, this.grammar[type].lookbehind);\n        match.type = this.grammar[type].type || type;\n        // console.log(match);\n        return match;\n    }\n    return;\n};\n\n//------------------------------------------------------------------------------\n// This code parses a chunk into interleaved pieces of plain text and\n// phrases. It repeatedly tries to match every possible phrase and\n// then takes the match closest to the start. Everything before a\n// match is written as text. Matched phrases are subparsed according\n// to their rules. This continues until the input is all eaten.\n//------------------------------------------------------------------------------\nproto.parse_phrases = function(container_type) {\n    var types = this.grammar[container_type].phrases;\n    if (!types) { this.receiver.text_node(this.input || ''); return }\n    // console.log(\"INPUT: \" + this.input);\n    while (this.input.length) {\n        var match = null;\n        for (var i = 0; i < types.length; i++) {\n            var type = types[i];\n            var matched = this.find_match('matched_phrase', type);\n            if (! matched) continue;\n\n            if (!match || (matched.begin < match.begin)) {\n                match = matched;\n                if (match.begin == 0) break;\n            }\n        }\n        if (!match) {\n            // console.log(\"NO MATCH: \" + this.input);\n            this.receiver.text_node(this.input || '');\n            break;\n        }\n        if (match.begin != 0) {\n            // console.log(\"MATCH OFFSET:\" + this.input + \" (\" + match.type + \")\" + match.begin);\n            this.receiver.text_node(this.input.substr(0, match.begin) || '');\n            }\n        this.input = this.input.substr(match.end);\n        this.handle_match(match.type, match);\n    }\n    return;\n}\n\nproto.subparse = function(func, match, type, filter) {\n    /* The call could cause side effects to the match object. */\n    match.type = this.grammar[type].type;\n    if (match.type == null) match.type = type;\n\n    var filtered_text = filter ? filter(match) : null;\n\n    if (match.type) this.receiver.begin_node(match);\n\n    var parser = eval('new ' + this.className + '()');\n\n    parser.input = (filtered_text == null) ? match.text : filtered_text;\n    parser.grammar = this.grammar;\n    parser.receiver = this.receiver.instantiate();\n    // console.log(\"SEEDED: (\" + type + \")\" + parser.input);\n    parser[func].call(parser, type);\n    this.receiver.insert(parser.receiver);\n\n    if (match.type) this.receiver.end_node(match);\n}\n\n//------------------------------------------------------------------------------\n// Helper functions\n//\n// These are the odds and ends called by the code above.\n//------------------------------------------------------------------------------\n\n/* Blocks has no lookbehinds, so:\n * All match begins at 0. The first capture is text; the next ones are various parts.\n */\nproto.matched_block = function(capture) {\n    return {\n        begin: capture.index,\n        text: capture[1],\n        end: capture[0].length,\n        1: capture[2],\n        2: capture[3],\n        3: capture[4]\n    };\n}\n\n/* The first capture in a Phrases is the lookbehind. So:\n */\nproto.matched_phrase = function(capture, lookbehind) {\n    if (lookbehind) {\n        var text = capture[2];\n        var begin = this.input.indexOf(capture[1]);\n        return {\n            text: text,\n            begin: begin,\n            end: (begin + capture[1].length),\n            1: RegExp.$2,\n            2: RegExp.$3,\n            3: RegExp.$4\n        };\n    }\n\n    return {\n        begin: capture.index,\n        text: capture[1],\n        end: capture.index + capture[0].length,\n        1: capture[2],\n        2: capture[3],\n        3: capture[4]\n    };\n}\n\n});\n","Class('Document.Parser.Wikitext(Document.Parser)', function() {\n\nvar proto = this.prototype;\nproto.className = 'Document.Parser.Wikitext';\n\nproto.init = function() {}\n\nproto.create_grammar = function() {\n    var all_blocks = ['pre', 'html', 'hr', 'hx', 'waflparagraph', 'ul', 'ol', 'blockquote', 'p', 'empty', 'else'];\n\n    // Phrase TODO: im\n    var all_phrases = ['waflphrase', 'asis', 'wikilink', 'wikilink2', 'a', 'im', 'mail', 'file', 'tt', 'b', 'i', 'del', 'a'];\n\n    var re_huggy = function(brace1, brace2) {\n        brace2 = '\\\\' + (brace2 || brace1);\n        brace1 = '\\\\' + brace1;\n        return {\n            match: new RegExp('(?:^|[^'+brace1+'\\\\w])('+brace1+'(?=\\\\S)(?!'+brace2+')(.*?)'+brace2+'(?=[^'+brace2+'\\\\w]|$))'),\n            phrases: (brace1 == '\\\\`') ? null : all_phrases,\n            lookbehind: true\n        };\n    };\n\n    var im_types = {\n        yahoo: 'yahoo',\n        ymsgr: 'yahoo',\n        callto: 'callto',\n        callme: 'callto',\n        skype: 'callto',\n        aim: 'aim'\n    };\n\n    var im_label = {\n        aim: \"AIM: %1\",\n        yahoo: \"Yahoo: %1\",\n        callto: \"Skype: %1\"\n    };\n\n    var im_re = '(\\\\b(';\n    for (var key in im_types) {\n        im_re += key + '|';\n    }\n    im_re = im_re.replace(/\\|$/, ')\\\\:([^\\\\s\\\\>\\\\)]+))');\n\n    var re_list = function(bullet, filter_out) {\n        var exclusion = new RegExp('(^|\\n)' + filter_out + '\\ *', 'g');\n        return {\n            match: new RegExp(\n                \"^(\" + bullet + \"+\\ .*\\n\" +\n                \"(?:[\\*\\-\\+\\#]+\\ .*\\n)*\" +\n                \")(?:\\s*\\n)?\"\n            ),\n            blocks: ['ul', 'ol', 'subl', 'li'],\n            filter: function(node) {\n                return node.text.replace(exclusion, '$1');\n            }\n        };\n    };\n\n    return {\n        _all_blocks: all_blocks,\n        _all_phrases: all_phrases,\n        top: { blocks: all_blocks },\n        ol: re_list('#', '[*#]'),\n        ul: re_list('[-+*]', '[-+*#]'),\n        blockquote: {\n            match: /^((?:>[^\\n]*\\n)+)(?:\\s*\\n)?/,\n            blocks: ['blockquote', 'line'],\n            filter: function(node) { return node.text.replace(/(^|\\n)>\\ ?/g, '$1') }\n        },\n        line: {\n            match: /([^\\n]*)\\n/,\n            phrases: all_phrases\n        },\n        subl: {\n            type: 'li',\n            match: /^(([^\\n]*)\\n[*#]+\\ [^\\n]*\\n(?:[*#]+\\ [^\\n]*\\n)*)(?:\\s*\\n)?/,\n            blocks: ['ul', 'ol', 'li2']\n        },\n        li: {\n            match: /([^\\n]*)\\n/,\n            phrases: all_phrases\n        },\n        li2: {\n            type: '', // Do not emit begin/end node; just reparse\n            match: /([^\\n]*)\\n/,\n            phrases: all_phrases\n        },\n        html: {\n            match: /^(\\.html\\ *\\n(?:[^\\n]*\\n)*?\\.html)\\ *\\n(?:\\s*\\n)?/,\n            filter: function(node) {\n                node._html = node.text;\n                return '';\n            }\n        },\n        pre: { match: /^\\.pre\\ *\\n((?:[^\\n]*\\n)*?)\\.pre\\ *\\n(?:\\s*\\n)?/ },\n        hr: { match: /^--+(?:\\s*\\n)?/ },\n        hx: {\n            match: /^((\\^+) *([^\\n]*?)(\\s+=+)?\\s*?\\n+)/,\n            phrases: all_phrases,\n            filter: function(node) {\n                node.type = 'h' + node['1'].length;\n                return node[2];\n            }\n        },\n        p: {\n            match: /^((?:(?!(?:(?:\\^+|\\#+|\\*+|\\-+) |\\>|\\.\\w+\\s*\\n|\\{[^\\}]+\\}\\s*\\n))[^\\n]*\\S[^\\n]*\\n)+(?:(?=^|\\n)\\s*\\n)*)/,\n            phrases: all_phrases,\n            filter: function(node) { return node.text.replace(/\\n$/, '') }\n        },\n        empty: {\n            match: /^(\\s*\\n)/,\n            filter: function(node) { node.type = '' }\n        },\n        'else': {\n            match: /^(([^\\n]*)\\n)/,\n            phrases: [],\n            filter: function(node) {\n                node.type = 'p';\n            }\n        },\n        waflparagraph: {\n            match: /^\\{(.*)\\}[\\ \\t]*\\n(?:\\s*\\n)?/,\n            filter: function(node) {\n                node._wafl = node._label = node.text;\n                // node._function = node._wafl.replace(/[: ].*/, '');;\n                // node._options = node._wafl.replace(/^[^: ]*[: ]?/, '');\n                return '';\n            }\n        },\n        waflphrase: {\n            match: /(?:^|[\\s\\-])((?:\"([^\\n]+?)\")?\\{([\\w-]+(?=[\\:\\ \\}])(?:\\s*:)?\\s*[^\\n]*?\\s*)\\}(?=[\\W_]|$))/,\n            filter: function(node) {\n                node._wafl = node[2];\n                node._label = node[1] || node._wafl;\n                // node._function = node._wafl.replace(/[: ].*/, '');;\n                // node._options = node._wafl.replace(/^[^: ]*[: ]?/, '');\n                return '';\n            },\n            lookbehind: true\n        },\n        asis: {\n            match: /(\\{\\{([^\\n]*?)\\}\\}(\\}*))/,\n            filter: function(node) {\n                node.type = '';\n                return(node[1] + node[2]);\n            }\n        },\n        wikilink: {\n            match: /(?:^|[_\\W])(\\[()(?=[^\\s\\[\\]])(.*?)\\](?=[_\\W]|$))/,\n            filter: function(node) {\n                node._href = '?' + node[2];\n                return(node.text || node[2]);\n            },\n            lookbehind: true\n        },\n        wikilink2: {\n            type: 'wikilink',\n            match: /(?:\"([^\"]*)\"\\s*)(\\[(?=[^\\s\\[\\]])(.*?)\\](?=[_\\W]|$))/,\n            filter: function(node) {\n                node._href = '?' + node[2];\n                return(node[1] || node[2]);\n            }\n        },\n        a: {\n            match: /((?:\"([^\"]*)\"\\s*)?<?((?:http|https|ftp|irc|file):(?:\\/\\/)?[\\;\\/\\?\\:\\@\\&\\=\\+\\$\\,\\[\\]\\#A-Za-z0-9\\-\\_\\.\\!\\~\\*\\'\\(\\)]+[A-Za-z0-9\\/#])>?)/,\n            filter: function(node) {\n                node._href = node[2];\n                return(node[1] || node[2]);\n            }\n        },\n        file: {\n            match: /((?:\"([^\"]*)\")?<(\\\\\\\\[^\\s\\>\\)]+)>)/,\n            filter: function(node) {\n                var href = node[2].replace(/^\\\\\\\\/, '');\n                node._href = \"file://\" + href.replace(/\\\\/g, '/');\n                return(node['1'] || href);\n            }\n        },\n        im: {\n            match: (new RegExp(im_re)),\n            filter: function(node) {\n                node._wafl = node[1] + ': ' + node[2];\n                node._label = (im_label[im_types[node[1]]] || '%1').replace(/%1/g, node[2]);\n                return '';\n            }\n        },\n        mail: {\n            match: /([\\w+%\\-\\.]+@(?:[\\w\\-]+\\.)+[\\w\\-]+)/,\n            filter: function(node) {\n                node.type = 'a';\n                node._href = \"mailto:\" + node.text.replace(/%/g, '%25');\n            }\n        },\n        tt: re_huggy('`'), // Special-cased in re_huggy above to disallow subphrases\n        b: re_huggy('*'),\n        i: re_huggy('_'),\n        del: re_huggy('-')\n    };\n};\n\n});\n","/*! jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */\n!function(a,b){\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error(\"jQuery requires a window with a document\");return b(a)}:b(a)}(\"undefined\"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k=\"\".trim,l={},m=\"1.11.0\",n=function(a,b){return new n.fn.init(a,b)},o=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,p=/^-ms-/,q=/-([\\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:\"\",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for(\"boolean\"==typeof g&&(j=g,g=arguments[h]||{},h++),\"object\"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:\"jQuery\"+(m+Math.random()).replace(/\\D/g,\"\"),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return\"function\"===n.type(a)},isArray:Array.isArray||function(a){return\"array\"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||\"object\"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,\"constructor\")&&!j.call(a.constructor.prototype,\"isPrototypeOf\"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+\"\":\"object\"==typeof a||\"function\"==typeof a?h[i.call(a)]||\"object\":typeof a},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,\"ms-\").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:k&&!k.call(\"\\ufeff\\xa0\")?function(a){return null==a?\"\":k.call(a)}:function(a){return null==a?\"\":(a+\"\").replace(o,\"\")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,\"string\"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return\"string\"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(a,b){h[\"[object \"+b+\"]\"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return\"function\"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:\"array\"===c||0===b||\"number\"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=\"sizzle\"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A=\"undefined\",B=1<<31,C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},J=\"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",K=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",L=\"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",M=L.replace(\"w\",\"w#\"),N=\"\\\\[\"+K+\"*(\"+L+\")\"+K+\"*(?:([*^$|!~]?=)\"+K+\"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\"+M+\")|)|)\"+K+\"*\\\\]\",O=\":(\"+L+\")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+N.replace(3,8)+\")*)|.*)\\\\)|)\",P=new RegExp(\"^\"+K+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+K+\"+$\",\"g\"),Q=new RegExp(\"^\"+K+\"*,\"+K+\"*\"),R=new RegExp(\"^\"+K+\"*([>+~]|\"+K+\")\"+K+\"*\"),S=new RegExp(\"=\"+K+\"*([^\\\\]'\\\"]*?)\"+K+\"*\\\\]\",\"g\"),T=new RegExp(O),U=new RegExp(\"^\"+M+\"$\"),V={ID:new RegExp(\"^#(\"+L+\")\"),CLASS:new RegExp(\"^\\\\.(\"+L+\")\"),TAG:new RegExp(\"^(\"+L.replace(\"w\",\"w*\")+\")\"),ATTR:new RegExp(\"^\"+N),PSEUDO:new RegExp(\"^\"+O),CHILD:new RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+K+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+K+\"*(?:([+-]|)\"+K+\"*(\\\\d+)|))\"+K+\"*\\\\)|)\",\"i\"),bool:new RegExp(\"^(?:\"+J+\")$\",\"i\"),needsContext:new RegExp(\"^\"+K+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+K+\"*((?:-\\\\d)?\\\\d*)\"+K+\"*\\\\)|)(?=[^-]|$)\",\"i\")},W=/^(?:input|select|textarea|button)$/i,X=/^h\\d$/i,Y=/^[^{]+\\{\\s*\\[native \\w/,Z=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,$=/[+~]/,_=/'|\\\\/g,ab=new RegExp(\"\\\\\\\\([\\\\da-f]{1,6}\"+K+\"?|(\"+K+\")|.)\",\"ig\"),bb=function(a,b,c){var d=\"0x\"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType}catch(cb){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function db(a,b,d,e){var f,g,h,i,j,m,p,q,u,v;if((b?b.ownerDocument||b:t)!==l&&k(b),b=b||l,d=d||[],!a||\"string\"!=typeof a)return d;if(1!==(i=b.nodeType)&&9!==i)return[];if(n&&!e){if(f=Z.exec(a))if(h=f[1]){if(9===i){if(g=b.getElementById(h),!g||!g.parentNode)return d;if(g.id===h)return d.push(g),d}else if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h)return d.push(g),d}else{if(f[2])return G.apply(d,b.getElementsByTagName(a)),d;if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(h)),d}if(c.qsa&&(!o||!o.test(a))){if(q=p=s,u=b,v=9===i&&a,1===i&&\"object\"!==b.nodeName.toLowerCase()){m=ob(a),(p=b.getAttribute(\"id\"))?q=p.replace(_,\"\\\\$&\"):b.setAttribute(\"id\",q),q=\"[id='\"+q+\"'] \",j=m.length;while(j--)m[j]=q+pb(m[j]);u=$.test(a)&&mb(b.parentNode)||b,v=m.join(\",\")}if(v)try{return G.apply(d,u.querySelectorAll(v)),d}catch(w){}finally{p||b.removeAttribute(\"id\")}}}return xb(a.replace(P,\"$1\"),b,d,e)}function eb(){var a=[];function b(c,e){return a.push(c+\" \")>d.cacheLength&&delete b[a.shift()],b[c+\" \"]=e}return b}function fb(a){return a[s]=!0,a}function gb(a){var b=l.createElement(\"div\");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function hb(a,b){var c=a.split(\"|\"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function ib(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||B)-(~a.sourceIndex||B);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function jb(a){return function(b){var c=b.nodeName.toLowerCase();return\"input\"===c&&b.type===a}}function kb(a){return function(b){var c=b.nodeName.toLowerCase();return(\"input\"===c||\"button\"===c)&&b.type===a}}function lb(a){return fb(function(b){return b=+b,fb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function mb(a){return a&&typeof a.getElementsByTagName!==A&&a}c=db.support={},f=db.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?\"HTML\"!==b.nodeName:!1},k=db.setDocument=function(a){var b,e=a?a.ownerDocument||a:t,g=e.defaultView;return e!==l&&9===e.nodeType&&e.documentElement?(l=e,m=e.documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener(\"unload\",function(){k()},!1):g.attachEvent&&g.attachEvent(\"onunload\",function(){k()})),c.attributes=gb(function(a){return a.className=\"i\",!a.getAttribute(\"className\")}),c.getElementsByTagName=gb(function(a){return a.appendChild(e.createComment(\"\")),!a.getElementsByTagName(\"*\").length}),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){return a.innerHTML=\"<div class='a'></div><div class='a i'></div>\",a.firstChild.className=\"i\",2===a.getElementsByClassName(\"i\").length}),c.getById=gb(function(a){return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==A&&n){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){return a.getAttribute(\"id\")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){var c=typeof a.getAttributeNode!==A&&a.getAttributeNode(\"id\");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==A?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if(\"*\"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==A&&n?b.getElementsByClassName(a):void 0},p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){a.innerHTML=\"<select t=''><option selected=''></option></select>\",a.querySelectorAll(\"[t^='']\").length&&o.push(\"[*^$]=\"+K+\"*(?:''|\\\"\\\")\"),a.querySelectorAll(\"[selected]\").length||o.push(\"\\\\[\"+K+\"*(?:value|\"+J+\")\"),a.querySelectorAll(\":checked\").length||o.push(\":checked\")}),gb(function(a){var b=e.createElement(\"input\");b.setAttribute(\"type\",\"hidden\"),a.appendChild(b).setAttribute(\"name\",\"D\"),a.querySelectorAll(\"[name=d]\").length&&o.push(\"name\"+K+\"*[*^$|!~]?=\"),a.querySelectorAll(\":enabled\").length||o.push(\":enabled\",\":disabled\"),a.querySelectorAll(\"*,:x\"),o.push(\",.*:\")})),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){c.disconnectedMatch=q.call(a,\"div\"),q.call(a,\"[s!='']:x\"),p.push(\"!=\",O)}),o=o.length&&new RegExp(o.join(\"|\")),p=p.length&&new RegExp(p.join(\"|\")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},z=b?function(a,b){if(a===b)return j=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)}:function(a,b){if(a===b)return j=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0;if(f===g)return ib(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)k.unshift(c);while(h[d]===k[d])d++;return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0},e):l},db.matches=function(a,b){return db(a,null,null,b)},db.matchesSelector=function(a,b){if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,\"='$1']\"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b)))try{var d=q.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return db(b,l,null,[a]).length>0},db.contains=function(a,b){return(a.ownerDocument||a)!==l&&k(a),r(a,b)},db.attr=function(a,b){(a.ownerDocument||a)!==l&&k(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},db.error=function(a){throw new Error(\"Syntax error, unrecognized expression: \"+a)},db.uniqueSort=function(a){var b,d=[],e=0,f=0;if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return i=null,a},e=db.getText=function(a){var b,c=\"\",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if(\"string\"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=db.selectors={cacheLength:50,createPseudo:fb,match:V,attrHandle:{},find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||\"\").replace(ab,bb),\"~=\"===a[2]&&(a[3]=\" \"+a[3]+\" \"),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),\"nth\"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*(\"even\"===a[3]||\"odd\"===a[3])),a[5]=+(a[7]+a[8]||\"odd\"===a[3])):a[3]&&db.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(\")\",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ab,bb).toLowerCase();return\"*\"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=w[a+\" \"];return b||(b=new RegExp(\"(^|\"+K+\")\"+a+\"(\"+K+\"|$)\"))&&w(a,function(a){return b.test(\"string\"==typeof a.className&&a.className||typeof a.getAttribute!==A&&a.getAttribute(\"class\")||\"\")})},ATTR:function(a,b,c){return function(d){var e=db.attr(d,a);return null==e?\"!=\"===b:b?(e+=\"\",\"=\"===b?e===c:\"!=\"===b?e!==c:\"^=\"===b?c&&0===e.indexOf(c):\"*=\"===b?c&&e.indexOf(c)>-1:\"$=\"===b?c&&e.slice(-c.length)===c:\"~=\"===b?(\" \"+e+\" \").indexOf(c)>-1:\"|=\"===b?e===c||e.slice(0,c.length+1)===c+\"-\":!1):!0}},CHILD:function(a,b,c,d,e){var f=\"nth\"!==a.slice(0,3),g=\"last\"!==a.slice(-4),h=\"of-type\"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?\"nextSibling\":\"previousSibling\",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p=\"only\"===a&&!o&&\"nextSibling\"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&t){k=q[s]||(q[s]={}),j=k[a]||[],n=j[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[u,n,m];break}}else if(t&&(j=(b[s]||(b[s]={}))[a])&&j[0]===u)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(t&&((l[s]||(l[s]={}))[a]=[u,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error(\"unsupported pseudo: \"+a);return e[s]?e(b):e.length>1?(c=[a,a,\"\",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:fb(function(a){var b=[],c=[],d=g(a.replace(P,\"$1\"));return d[s]?fb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fb(function(a){return function(b){return db(a,b).length>0}}),contains:fb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:fb(function(a){return U.test(a||\"\")||db.error(\"unsupported lang: \"+a),a=a.replace(ab,bb).toLowerCase(),function(b){var c;do if(c=n?b.lang:b.getAttribute(\"xml:lang\")||b.getAttribute(\"lang\"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+\"-\");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===m},focus:function(a){return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&!!a.checked||\"option\"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&\"button\"===a.type||\"button\"===b},text:function(a){var b;return\"input\"===a.nodeName.toLowerCase()&&\"text\"===a.type&&(null==(b=a.getAttribute(\"type\"))||\"text\"===b.toLowerCase())},first:lb(function(){return[0]}),last:lb(function(a,b){return[b-1]}),eq:lb(function(a,b,c){return[0>c?c+b:c]}),even:lb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:lb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:lb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:lb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=jb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=kb(b);function nb(){}nb.prototype=d.filters=d.pseudos,d.setFilters=new nb;function ob(a,b){var c,e,f,g,h,i,j,k=x[a+\" \"];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=Q.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P,\" \")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?db.error(a):x(a,i).slice(0)}function pb(a){for(var b=0,c=a.length,d=\"\";c>b;b++)d+=a[b].value;return d}function qb(a,b,c){var d=b.dir,e=c&&\"parentNode\"===d,f=v++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[u,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[s]||(b[s]={}),(h=i[d])&&h[0]===u&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function rb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function tb(a,b,c,d,e,f){return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||wb(b||\"*\",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=sb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ub(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[\" \"],j=g?1:0,k=qb(function(a){return a===b},i,!0),l=qb(function(a){return I.call(b,a)>-1},i,!0),m=[function(a,c,d){return!g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>j;j++)if(c=d.relative[a[j].type])m=[qb(rb(m),c)];else{if(c=d.filter[a[j].type].apply(null,a[j].matches),c[s]){for(e=++j;f>e;e++)if(d.relative[a[e].type])break;return tb(j>1&&rb(m),j>1&&pb(a.slice(0,j-1).concat({value:\" \"===a[j-2].type?\"*\":\"\"})).replace(P,\"$1\"),c,e>j&&ub(a.slice(j,e)),f>e&&ub(a=a.slice(e)),f>e&&pb(a))}m.push(c)}return rb(m)}function vb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,i,j,k){var m,n,o,p=0,q=\"0\",r=f&&[],s=[],t=h,v=f||e&&d.find.TAG(\"*\",k),w=u+=null==t?1:Math.random()||.1,x=v.length;for(k&&(h=g!==l&&g);q!==x&&null!=(m=v[q]);q++){if(e&&m){n=0;while(o=a[n++])if(o(m,g,i)){j.push(m);break}k&&(u=w)}c&&((m=!o&&m)&&p--,f&&r.push(m))}if(p+=q,c&&q!==p){n=0;while(o=b[n++])o(r,s,g,i);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=E.call(j));s=sb(s)}G.apply(j,s),k&&!f&&s.length>0&&p+b.length>1&&db.uniqueSort(j)}return k&&(u=w,h=t),r};return c?fb(f):f}g=db.compile=function(a,b){var c,d=[],e=[],f=y[a+\" \"];if(!f){b||(b=ob(a)),c=b.length;while(c--)f=ub(b[c]),f[s]?d.push(f):e.push(f);f=y(a,vb(e,d))}return f};function wb(a,b,c){for(var d=0,e=b.length;e>d;d++)db(a,b[d],c);return c}function xb(a,b,e,f){var h,i,j,k,l,m=ob(a);if(!f&&1===m.length){if(i=m[0]=m[0].slice(0),i.length>2&&\"ID\"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0],!b)return e;a=a.slice(i.shift().value.length)}h=V.needsContext.test(a)?0:i.length;while(h--){if(j=i[h],d.relative[k=j.type])break;if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){if(i.splice(h,1),a=f.length&&pb(i),!a)return G.apply(e,f),e;break}}}return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e}return c.sortStable=s.split(\"\").sort(z).join(\"\")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){return 1&a.compareDocumentPosition(l.createElement(\"div\"))}),gb(function(a){return a.innerHTML=\"<a href='#'></a>\",\"#\"===a.firstChild.getAttribute(\"href\")})||hb(\"type|href|height|width\",function(a,b,c){return c?void 0:a.getAttribute(b,\"type\"===b.toLowerCase()?1:2)}),c.attributes&&gb(function(a){return a.innerHTML=\"<input/>\",a.firstChild.setAttribute(\"value\",\"\"),\"\"===a.firstChild.getAttribute(\"value\")})||hb(\"value\",function(a,b,c){return c||\"input\"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),gb(function(a){return null==a.getAttribute(\"disabled\")})||hb(J,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),db}(a);n.find=t,n.expr=t.selectors,n.expr[\":\"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,w=/^.[^:#\\[\\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if(\"string\"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return n.inArray(a,b)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=\":not(\"+a+\")\"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if(\"string\"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;e>b;b++)if(n.contains(d[b],this))return!0}));for(b=0;e>b;b++)n.find(a,d[b],c);return c=this.pushStack(e>1?n.unique(c):c),c.selector=this.selector?this.selector+\" \"+a:a,c},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,\"string\"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=a.document,A=/^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,B=n.fn.init=function(a,b){var c,d;if(!a)return this;if(\"string\"==typeof a){if(c=\"<\"===a.charAt(0)&&\">\"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:A.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=z.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return y.find(a);this.length=1,this[0]=d}return this.context=z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?\"undefined\"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};B.prototype=n.fn,y=n(z);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(n.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||\"string\"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?\"string\"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function E(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,\"parentNode\")},parentsUntil:function(a,b,c){return n.dir(a,\"parentNode\",c)},next:function(a){return E(a,\"nextSibling\")},prev:function(a){return E(a,\"previousSibling\")},nextAll:function(a){return n.dir(a,\"nextSibling\")},prevAll:function(a){return n.dir(a,\"previousSibling\")},nextUntil:function(a,b,c){return n.dir(a,\"nextSibling\",c)},prevUntil:function(a,b,c){return n.dir(a,\"previousSibling\",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,\"iframe\")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return\"Until\"!==a.slice(-5)&&(d=c),d&&\"string\"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)}});var F=/\\S+/g,G={};function H(a){var b=G[a]={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a=\"string\"==typeof a?G[a]||H(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){n.each(b,function(b,c){var d=n.type(c);\"function\"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&\"string\"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&n.each(arguments,function(a,c){var d;while((d=n.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},n.extend({Deferred:function(a){var b=[[\"resolve\",\"done\",n.Callbacks(\"once memory\"),\"resolved\"],[\"reject\",\"fail\",n.Callbacks(\"once memory\"),\"rejected\"],[\"notify\",\"progress\",n.Callbacks(\"memory\")]],c=\"pending\",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+\"With\"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+\"With\"](this===e?d:this,arguments),this},e[f[0]+\"With\"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var I;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(a===!0?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready);n.isReady=!0,a!==!0&&--n.readyWait>0||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger(\"ready\").off(\"ready\"))}}});function J(){z.addEventListener?(z.removeEventListener(\"DOMContentLoaded\",K,!1),a.removeEventListener(\"load\",K,!1)):(z.detachEvent(\"onreadystatechange\",K),a.detachEvent(\"onload\",K))}function K(){(z.addEventListener||\"load\"===event.type||\"complete\"===z.readyState)&&(J(),n.ready())}n.ready.promise=function(b){if(!I)if(I=n.Deferred(),\"complete\"===z.readyState)setTimeout(n.ready);else if(z.addEventListener)z.addEventListener(\"DOMContentLoaded\",K,!1),a.addEventListener(\"load\",K,!1);else{z.attachEvent(\"onreadystatechange\",K),a.attachEvent(\"onload\",K);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!n.isReady){try{c.doScroll(\"left\")}catch(a){return setTimeout(e,50)}J(),n.ready()}}()}return I.promise(b)};var L=\"undefined\",M;for(M in n(l))break;l.ownLast=\"0\"!==M,l.inlineBlockNeedsLayout=!1,n(function(){var a,b,c=z.getElementsByTagName(\"body\")[0];c&&(a=z.createElement(\"div\"),a.style.cssText=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px\",b=z.createElement(\"div\"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==L&&(b.style.cssText=\"border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1\",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=z.createElement(\"div\");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete a.test}catch(b){l.deleteExpando=!1}}a=null}(),n.acceptData=function(a){var b=n.noData[(a.nodeName+\" \").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute(\"classid\")===b};var N=/^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,O=/([A-Z])/g;function P(a,b,c){if(void 0===c&&1===a.nodeType){var d=\"data-\"+b.replace(O,\"-$1\").toLowerCase();if(c=a.getAttribute(d),\"string\"==typeof c){try{c=\"true\"===c?!0:\"false\"===c?!1:\"null\"===c?null:+c+\"\"===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}n.data(a,b,c)}else c=void 0}return c}function Q(a){var b;for(b in a)if((\"data\"!==b||!n.isEmptyObject(a[b]))&&\"toJSON\"!==b)return!1;return!0}function R(a,b,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||\"string\"!=typeof b)return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}:{toJSON:n.noop}),(\"object\"==typeof b||\"function\"==typeof b)&&(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),\"string\"==typeof b?(f=g[b],null==f&&(f=g[n.camelCase(b)])):f=g,f\n}}function S(a,b,c){if(n.acceptData(a)){var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){n.isArray(b)?b=b.concat(n.map(b,n.camelCase)):b in d?b=[b]:(b=n.camelCase(b),b=b in d?[b]:b.split(\" \")),e=b.length;while(e--)delete d[b[e]];if(c?!Q(d):!n.isEmptyObject(d))return}(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}n.extend({cache:{},noData:{\"applet \":!0,\"embed \":!0,\"object \":\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"},hasData:function(a){return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!Q(a)},data:function(a,b,c){return R(a,b,c)},removeData:function(a,b){return S(a,b)},_data:function(a,b,c){return R(a,b,c,!0)},_removeData:function(a,b){return S(a,b,!0)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,\"parsedAttrs\"))){c=g.length;while(c--)d=g[c].name,0===d.indexOf(\"data-\")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d]));n._data(f,\"parsedAttrs\",!0)}return e}return\"object\"==typeof a?this.each(function(){n.data(this,a)}):arguments.length>1?this.each(function(){n.data(this,a,b)}):f?P(f,a,n.data(f,a)):void 0},removeData:function(a){return this.each(function(){n.removeData(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||\"fx\")+\"queue\",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||\"fx\";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};\"inprogress\"===e&&(e=c.shift(),d--),e&&(\"fx\"===b&&c.unshift(\"inprogress\"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+\"queueHooks\";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks(\"once memory\").add(function(){n._removeData(a,b+\"queue\"),n._removeData(a,c)})})}}),n.fn.extend({queue:function(a,b){var c=2;return\"string\"!=typeof a&&(b=a,a=\"fx\",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),\"fx\"===a&&\"inprogress\"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||\"fx\",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};\"string\"!=typeof a&&(b=a,a=void 0),a=a||\"fx\";while(g--)c=n._data(f[g],a+\"queueHooks\"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var T=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,U=[\"Top\",\"Right\",\"Bottom\",\"Left\"],V=function(a,b){return a=b||a,\"none\"===n.css(a,\"display\")||!n.contains(a.ownerDocument,a)},W=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if(\"object\"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},X=/^(?:checkbox|radio)$/i;!function(){var a=z.createDocumentFragment(),b=z.createElement(\"div\"),c=z.createElement(\"input\");if(b.setAttribute(\"className\",\"t\"),b.innerHTML=\"  <link/><table></table><a href='/a'>a</a>\",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName(\"tbody\").length,l.htmlSerialize=!!b.getElementsByTagName(\"link\").length,l.html5Clone=\"<:nav></:nav>\"!==z.createElement(\"nav\").cloneNode(!0).outerHTML,c.type=\"checkbox\",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML=\"<textarea>x</textarea>\",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML=\"<input type='radio' checked='checked' name='t'/>\",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent(\"onclick\",function(){l.noCloneEvent=!1}),b.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete b.test}catch(d){l.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=z.createElement(\"div\");for(b in{submit:!0,change:!0,focusin:!0})c=\"on\"+b,(l[b+\"Bubbles\"]=c in a)||(d.setAttribute(c,\"t\"),l[b+\"Bubbles\"]=d.attributes[c].expando===!1);d=null}();var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\\.(.+)|)$/;function bb(){return!0}function cb(){return!1}function db(){try{return z.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof n===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||\"\").match(F)||[\"\"],h=b.length;while(h--)f=ab.exec(b[h])||[],o=q=f[1],p=(f[2]||\"\").split(\".\").sort(),o&&(j=n.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{},l=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(\".\")},i),(m=g[o])||(m=g[o]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent(\"on\"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);if(r&&(k=r.events)){b=(b||\"\").match(F)||[\"\"],j=b.length;while(j--)if(h=ab.exec(b[j])||[],o=q=h[1],p=(h[2]||\"\").split(\".\").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=k[o]||[],h=h[2]&&new RegExp(\"(^|\\\\.)\"+p.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),i=f=m.length;while(f--)g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&(\"**\"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,\"events\"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,\"type\")?b.type:b,q=j.call(b,\"namespace\")?b.namespace.split(\".\"):[];if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(p.indexOf(\".\")>=0&&(q=p.split(\".\"),p=q.shift(),q.sort()),g=p.indexOf(\":\")<0&&\"on\"+p,b=b[n.expando]?b:new n.Event(p,\"object\"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join(\".\"),b.namespace_re=b.namespace?new RegExp(\"(^|\\\\.)\"+q.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!n.isWindow(d)){for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)}m=0;while((h=o[m++])&&!b.isPropagationStopped())b.type=m>1?i:k.bindType||p,f=(n._data(h,\"events\")||{})[b.type]&&n._data(h,\"handle\"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){l=d[g],l&&(d[g]=null),n.event.triggered=p;try{d[p]()}catch(r){}n.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,\"events\")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((n.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||\"click\"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||\"click\"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+\" \",void 0===e[c]&&(e[c]=d.needsContext?n(c,this).index(i)>=0:n.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:\"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||z,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==db()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:\"focusin\"},blur:{trigger:function(){return this===db()&&this.blur?(this.blur(),!1):void 0},delegateType:\"focusout\"},click:{trigger:function(){return n.nodeName(this,\"input\")&&\"checkbox\"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,\"a\")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d=\"on\"+b;a.detachEvent&&(typeof a[d]===L&&(a[d]=null),a.detachEvent(d,c))},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()}},n.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),l.submitBubbles||(n.event.special.submit={setup:function(){return n.nodeName(this,\"form\")?!1:void n.event.add(this,\"click._submit keypress._submit\",function(a){var b=a.target,c=n.nodeName(b,\"input\")||n.nodeName(b,\"button\")?b.form:void 0;c&&!n._data(c,\"submitBubbles\")&&(n.event.add(c,\"submit._submit\",function(a){a._submit_bubble=!0}),n._data(c,\"submitBubbles\",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate(\"submit\",this.parentNode,a,!0))},teardown:function(){return n.nodeName(this,\"form\")?!1:void n.event.remove(this,\"._submit\")}}),l.changeBubbles||(n.event.special.change={setup:function(){return Y.test(this.nodeName)?((\"checkbox\"===this.type||\"radio\"===this.type)&&(n.event.add(this,\"propertychange._change\",function(a){\"checked\"===a.originalEvent.propertyName&&(this._just_changed=!0)}),n.event.add(this,\"click._change\",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate(\"change\",this,a,!0)})),!1):void n.event.add(this,\"beforeactivate._change\",function(a){var b=a.target;Y.test(b.nodeName)&&!n._data(b,\"changeBubbles\")&&(n.event.add(b,\"change._change\",function(a){!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate(\"change\",this.parentNode,a,!0)}),n._data(b,\"changeBubbles\",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||\"radio\"!==b.type&&\"checkbox\"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,\"._change\"),!Y.test(this.nodeName)}}),l.focusinBubbles||n.each({focus:\"focusin\",blur:\"focusout\"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=n._data(d,b);e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=n._data(d,b)-1;e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if(\"object\"==typeof a){\"string\"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&(\"string\"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=cb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return n().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+\".\"+d.namespace:d.origType,d.selector,d.handler),this;if(\"object\"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||\"function\"==typeof b)&&(c=b,b=void 0),c===!1&&(c=cb),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});function eb(a){var b=fb.split(\"|\"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var fb=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",gb=/ jQuery\\d+=\"(?:null|\\d+)\"/g,hb=new RegExp(\"<(?:\"+fb+\")[\\\\s/>]\",\"i\"),ib=/^\\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,kb=/<([\\w:]+)/,lb=/<tbody/i,mb=/<|&#?\\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\\s*(?:[^=]|=\\s*.checked.)/i,pb=/^$|\\/(?:java|ecma)script/i,qb=/^true\\/(.*)/,rb=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,sb={option:[1,\"<select multiple='multiple'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],area:[1,\"<map>\",\"</map>\"],param:[1,\"<object>\",\"</object>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:l.htmlSerialize?[0,\"\",\"\"]:[1,\"X<div>\",\"</div>\"]},tb=eb(z),ub=tb.appendChild(z.createElement(\"div\"));sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td;function vb(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==L?a.getElementsByTagName(b||\"*\"):typeof a.querySelectorAll!==L?a.querySelectorAll(b||\"*\"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b));return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f}function wb(a){X.test(a.type)&&(a.defaultChecked=a.checked)}function xb(a,b){return n.nodeName(a,\"table\")&&n.nodeName(11!==b.nodeType?b:b.firstChild,\"tr\")?a.getElementsByTagName(\"tbody\")[0]||a.appendChild(a.ownerDocument.createElement(\"tbody\")):a}function yb(a){return a.type=(null!==n.find.attr(a,\"type\"))+\"/\"+a.type,a}function zb(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute(\"type\"),a}function Ab(a,b){for(var c,d=0;null!=(c=a[d]);d++)n._data(c,\"globalEval\",!b||n._data(b[d],\"globalEval\"))}function Bb(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)n.event.add(b,c,h[c][d])}g.data&&(g.data=n.extend({},g.data))}}function Cb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){e=n._data(b);for(d in e.events)n.removeEvent(b,d,e.handle);b.removeAttribute(n.expando)}\"script\"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):\"object\"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):\"input\"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):\"option\"===c?b.defaultSelected=b.selected=a.defaultSelected:(\"input\"===c||\"textarea\"===c)&&(b.defaultValue=a.defaultValue)}}n.extend({clone:function(a,b,c){var d,e,f,g,h,i=n.contains(a.ownerDocument,a);if(l.html5Clone||n.isXMLDoc(a)||!hb.test(\"<\"+a.nodeName+\">\")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(d=vb(f),h=vb(a),g=0;null!=(e=h[g]);++g)d[g]&&Cb(e,d[g]);if(b)if(c)for(h=h||vb(a),d=d||vb(f),g=0;null!=(e=h[g]);g++)Bb(e,d[g]);else Bb(a,f);return d=vb(f,\"script\"),d.length>0&&Ab(d,!i&&vb(a,\"script\")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;m>q;q++)if(f=a[q],f||0===f)if(\"object\"===n.type(f))n.merge(p,f.nodeType?[f]:f);else if(mb.test(f)){h=h||o.appendChild(b.createElement(\"div\")),i=(kb.exec(f)||[\"\",\"\"])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,\"<$1></$2>\")+k[2],e=k[0];while(e--)h=h.lastChild;if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody){f=\"table\"!==i||lb.test(f)?\"<table>\"!==k[1]||lb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)n.nodeName(j=f.childNodes[e],\"tbody\")&&!j.childNodes.length&&f.removeChild(j)}n.merge(p,h.childNodes),h.textContent=\"\";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,\"input\"),wb),q=0;while(f=p[q++])if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),\"script\"),g&&Ab(h),c)){e=0;while(f=h[e++])pb.test(f.type||\"\")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;null!=(d=a[h]);h++)if((b||n.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle);j[f]&&(delete j[f],k?delete d[i]:typeof d.removeAttribute!==L?d.removeAttribute(i):d[i]=null,c.push(f))}}}),n.fn.extend({text:function(a){return W(this,function(a){return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,\"script\")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&n.cleanData(vb(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&n.nodeName(a,\"select\")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return W(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(gb,\"\"):void 0;if(!(\"string\"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||[\"\",\"\"])[1].toLowerCase()])){a=a.replace(jb,\"<$1></$2>\");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);if(q||k>1&&\"string\"==typeof p&&!l.checkClone&&ob.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(k&&(i=n.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=n.map(vb(i,\"script\"),yb),f=g.length;k>j;j++)d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,\"script\"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;f>j;j++)d=g[j],pb.test(d.type||\"\")&&!n._data(d,\"globalEval\")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||\"\").replace(rb,\"\")));i=c=null}return this}}),n.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(a,b){n.fn[a]=function(a){for(var c,d=0,e=[],g=n(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Db,Eb={};function Fb(b,c){var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],\"display\");return d.detach(),e}function Gb(a){var b=z,c=Eb[a];return c||(c=Fb(a,b),\"none\"!==c&&c||(Db=(Db||n(\"<iframe frameborder='0' width='0' height='0'/>\")).appendTo(b.documentElement),b=(Db[0].contentWindow||Db[0].contentDocument).document,b.write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c}!function(){var a,b,c=z.createElement(\"div\"),d=\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0\";c.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=c.getElementsByTagName(\"a\")[0],a.style.cssText=\"float:left;opacity:.5\",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip=\"content-box\",c.cloneNode(!0).style.backgroundClip=\"\",l.clearCloneStyle=\"content-box\"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=z.getElementsByTagName(\"body\")[0],!a)return;f=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px\",c=z.createElement(\"div\"),e=z.createElement(\"div\"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==L&&(e.style.cssText=d+\";width:1px;padding:1px;zoom:1\",e.innerHTML=\"<div></div>\",e.firstChild.style.width=\"5px\",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var Hb=/^margin/,Ib=new RegExp(\"^(\"+T+\")(?!px)[a-z%]+$\",\"i\"),Jb,Kb,Lb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Jb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(\"\"!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+\"\"}):z.documentElement.currentStyle&&(Jb=function(a){return a.currentStyle},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left=\"fontSize\"===b?\"1em\":g,g=h.pixelLeft+\"px\",h.left=d,f&&(e.left=f)),void 0===g?g:g+\"\"||\"auto\"});function Mb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h=z.createElement(\"div\"),i=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px\",j=\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0\";h.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",b=h.getElementsByTagName(\"a\")[0],b.style.cssText=\"float:left;opacity:.5\",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip=\"content-box\",h.cloneNode(!0).style.backgroundClip=\"\",l.clearCloneStyle=\"content-box\"===h.style.backgroundClip,b=h=null,n.extend(l,{reliableHiddenOffsets:function(){if(null!=c)return c;var a,b,d,e=z.createElement(\"div\"),f=z.getElementsByTagName(\"body\")[0];if(f)return e.setAttribute(\"className\",\"t\"),e.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=z.createElement(\"div\"),a.style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML=\"<table><tr><td></td><td>t</td></tr></table>\",b=e.getElementsByTagName(\"td\"),b[0].style.cssText=\"padding:0;margin:0;border:0;display:none\",d=0===b[0].offsetHeight,b[0].style.display=\"\",b[1].style.display=\"none\",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c},boxSizing:function(){return null==d&&k(),d},boxSizingReliable:function(){return null==e&&k(),e},pixelPosition:function(){return null==f&&k(),f},reliableMarginRight:function(){var b,c,d,e;if(null==g&&a.getComputedStyle){if(b=z.getElementsByTagName(\"body\")[0],!b)return;c=z.createElement(\"div\"),d=z.createElement(\"div\"),c.style.cssText=i,b.appendChild(c).appendChild(d),e=d.appendChild(z.createElement(\"div\")),e.style.cssText=d.style.cssText=j,e.style.marginRight=e.style.width=\"0\",d.style.width=\"1px\",g=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return g}});function k(){var b,c,h=z.getElementsByTagName(\"body\")[0];h&&(b=z.createElement(\"div\"),c=z.createElement(\"div\"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText=\"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%\",n.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){d=4===c.offsetWidth}),e=!0,f=!1,g=!0,a.getComputedStyle&&(f=\"1%\"!==(a.getComputedStyle(c,null)||{}).top,e=\"4px\"===(a.getComputedStyle(c,null)||{width:\"4px\"}).width),h.removeChild(b),c=h=null)}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Nb=/alpha\\([^)]*\\)/i,Ob=/opacity\\s*=\\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp(\"^(\"+T+\")(.*)$\",\"i\"),Rb=new RegExp(\"^([+-])=(\"+T+\")\",\"i\"),Sb={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Tb={letterSpacing:0,fontWeight:400},Ub=[\"Webkit\",\"O\",\"Moz\",\"ms\"];function Vb(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;while(e--)if(b=Ub[e]+c,b in a)return b;return d}function Wb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=n._data(d,\"olddisplay\"),c=d.style.display,b?(f[g]||\"none\"!==c||(d.style.display=\"\"),\"\"===d.style.display&&V(d)&&(f[g]=n._data(d,\"olddisplay\",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&\"none\"!==c||!e)&&n._data(d,\"olddisplay\",e?c:n.css(d,\"display\"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&\"none\"!==d.style.display&&\"\"!==d.style.display||(d.style.display=b?f[g]||\"\":\"none\"));return a}function Xb(a,b,c){var d=Qb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||\"px\"):b}function Yb(a,b,c,d,e){for(var f=c===(d?\"border\":\"content\")?4:\"width\"===b?1:0,g=0;4>f;f+=2)\"margin\"===c&&(g+=n.css(a,c+U[f],!0,e)),d?(\"content\"===c&&(g-=n.css(a,\"padding\"+U[f],!0,e)),\"margin\"!==c&&(g-=n.css(a,\"border\"+U[f]+\"Width\",!0,e))):(g+=n.css(a,\"padding\"+U[f],!0,e),\"padding\"!==c&&(g+=n.css(a,\"border\"+U[f]+\"Width\",!0,e)));return g}function Zb(a,b,c){var d=!0,e=\"width\"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&\"border-box\"===n.css(a,\"boxSizing\",!1,f);if(0>=e||null==e){if(e=Kb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ib.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Yb(a,b,c||(g?\"border\":\"content\"),d,f)+\"px\"}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Kb(a,\"opacity\");return\"\"===c?\"1\":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":l.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&\"get\"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,\"string\"===f&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f=\"number\"),null!=c&&c===c&&(\"number\"!==f||n.cssNumber[h]||(c+=\"px\"),l.clearCloneStyle||\"\"!==c||0!==b.indexOf(\"background\")||(i[b]=\"inherit\"),!(g&&\"set\"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=\"\",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&\"get\"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),\"normal\"===f&&b in Tb&&(f=Tb[b]),\"\"===c||c?(e=parseFloat(f),c===!0||n.isNumeric(e)?e||0:f):f}}),n.each([\"height\",\"width\"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Pb.test(n.css(a,\"display\"))?n.swap(a,Sb,function(){return Zb(a,b,d)}):Zb(a,b,d):void 0},set:function(a,c,d){var e=d&&Jb(a);return Xb(a,c,d?Yb(a,b,d,l.boxSizing()&&\"border-box\"===n.css(a,\"boxSizing\",!1,e),e):0)}}}),l.opacity||(n.cssHooks.opacity={get:function(a,b){return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||\"\")?.01*parseFloat(RegExp.$1)+\"\":b?\"1\":\"\"},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?\"alpha(opacity=\"+100*b+\")\":\"\",f=d&&d.filter||c.filter||\"\";c.zoom=1,(b>=1||\"\"===b)&&\"\"===n.trim(f.replace(Nb,\"\"))&&c.removeAttribute&&(c.removeAttribute(\"filter\"),\"\"===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+\" \"+e)}}),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){return b?n.swap(a,{display:\"inline-block\"},Kb,[a,\"marginRight\"]):void 0}),n.each({margin:\"\",padding:\"\",border:\"Width\"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f=\"string\"==typeof c?c.split(\" \"):[c];4>d;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Hb.test(a)||(n.cssHooks[a+b].set=Xb)}),n.fn.extend({css:function(a,b){return W(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Jb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)\n},a,b,arguments.length>1)},show:function(){return Wb(this,!0)},hide:function(){return Wb(this)},toggle:function(a){return\"boolean\"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}});function $b(a,b,c,d,e){return new $b.prototype.init(a,b,c,d,e)}n.Tween=$b,$b.prototype={constructor:$b,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||\"swing\",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?\"\":\"px\")},cur:function(){var a=$b.propHooks[this.prop];return a&&a.get?a.get(this):$b.propHooks._default.get(this)},run:function(a){var b,c=$b.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this}},$b.prototype.init.prototype=$b.prototype,$b.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,\"\"),b&&\"auto\"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},$b.propHooks.scrollTop=$b.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=$b.prototype.init,n.fx.step={};var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp(\"^(?:([+-])=|)(\"+T+\")([a-z%]*)$\",\"i\"),dc=/queueHooks$/,ec=[jc],fc={\"*\":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?\"\":\"px\"),g=(n.cssNumber[a]||\"px\"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||\".5\",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function gc(){return setTimeout(function(){_b=void 0}),_b=n.now()}function hc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=U[e],d[\"margin\"+c]=d[\"padding\"+c]=a;return b&&(d.opacity=d.width=a),d}function ic(a,b,c){for(var d,e=(fc[b]||[]).concat(fc[\"*\"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function jc(a,b,c){var d,e,f,g,h,i,j,k,m=this,o={},p=a.style,q=a.nodeType&&V(a),r=n._data(a,\"fxshow\");c.queue||(h=n._queueHooks(a,\"fx\"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,m.always(function(){m.always(function(){h.unqueued--,n.queue(a,\"fx\").length||h.empty.fire()})})),1===a.nodeType&&(\"height\"in b||\"width\"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,\"display\"),k=Gb(a.nodeName),\"none\"===j&&(j=k),\"inline\"===j&&\"none\"===n.css(a,\"float\")&&(l.inlineBlockNeedsLayout&&\"inline\"!==k?p.zoom=1:p.display=\"inline-block\")),c.overflow&&(p.overflow=\"hidden\",l.shrinkWrapBlocks()||m.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],bc.exec(e)){if(delete b[d],f=f||\"toggle\"===e,e===(q?\"hide\":\"show\")){if(\"show\"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||n.style(a,d)}if(!n.isEmptyObject(o)){r?\"hidden\"in r&&(q=r.hidden):r=n._data(a,\"fxshow\",{}),f&&(r.hidden=!q),q?n(a).show():m.done(function(){n(a).hide()}),m.done(function(){var b;n._removeData(a,\"fxshow\");for(b in o)n.style(a,b,o[b])});for(d in o)g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start=\"width\"===d||\"height\"===d?1:0))}}function kc(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&\"expand\"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function lc(a,b,c){var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(kc(k,j.opts.specialEasing);g>f;f++)if(d=ec[f].call(j,a,k,j.opts))return d;return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(lc,{tweener:function(a,b){n.isFunction(a)?(b=a,a=[\"*\"]):a=a.split(\" \");for(var c,d=0,e=a.length;e>d;d++)c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)},prefilter:function(a,b){b?ec.unshift(a):ec.push(a)}}),n.speed=function(a,b,c){var d=a&&\"object\"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:\"number\"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue=\"fx\"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css(\"opacity\",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=lc(this,n.extend({},a),f);(e||n._data(this,\"finish\"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return\"string\"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||\"fx\",[]),this.each(function(){var b=!0,e=null!=a&&a+\"queueHooks\",f=n.timers,g=n._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&dc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||\"fx\"),this.each(function(){var b,c=n._data(this),d=c[a+\"queue\"],e=c[a+\"queueHooks\"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each([\"toggle\",\"show\",\"hide\"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||\"boolean\"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)}}),n.each({slideDown:hc(\"show\"),slideUp:hc(\"hide\"),slideToggle:hc(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=n.timers,c=0;for(_b=n.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||n.fx.stop(),_b=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){ac||(ac=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(ac),ac=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||\"fx\",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=z.createElement(\"div\");e.setAttribute(\"className\",\"t\"),e.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=e.getElementsByTagName(\"a\")[0],c=z.createElement(\"select\"),d=c.appendChild(z.createElement(\"option\")),b=e.getElementsByTagName(\"input\")[0],a.style.cssText=\"top:1px\",l.getSetAttribute=\"t\"!==e.className,l.style=/top/.test(a.getAttribute(\"style\")),l.hrefNormalized=\"/a\"===a.getAttribute(\"href\"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement(\"form\").enctype,c.disabled=!0,l.optDisabled=!d.disabled,b=z.createElement(\"input\"),b.setAttribute(\"value\",\"\"),l.input=\"\"===b.getAttribute(\"value\"),b.value=\"t\",b.setAttribute(\"type\",\"radio\"),l.radioValue=\"t\"===b.value,a=b=c=d=e=null}();var mc=/\\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e=\"\":\"number\"==typeof e?e+=\"\":n.isArray(e)&&(e=n.map(e,function(a){return null==a?\"\":a+\"\"})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&\"set\"in b&&void 0!==b.set(this,e,\"value\")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&\"get\"in b&&void 0!==(c=b.get(e,\"value\"))?c:(c=e.value,\"string\"==typeof c?c.replace(mc,\"\"):null==c?\"\":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,\"value\");return null!=b?b:n.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f=\"select-one\"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute(\"disabled\"))||c.parentNode.disabled&&n.nodeName(c.parentNode,\"optgroup\"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)if(d=e[g],n.inArray(n.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),n.each([\"radio\",\"checkbox\"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute(\"value\")?\"on\":a.value})});var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;n.fn.extend({attr:function(a,b){return W(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&\"get\"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&\"set\"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+\"\"),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase(\"default-\"+c)]=a[d]=!1:n.attr(a,c,\"\"),a.removeAttribute(rc?c:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&\"radio\"===b&&n.nodeName(a,\"input\")){var c=a.value;return a.setAttribute(\"type\",b),c&&(a.value=c),b}}}}}),oc={set:function(a,b,c){return b===!1?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase(\"default-\"+c)]=a[c]=!0,c}},n.each(n.expr.match.bool.source.match(/\\w+/g),function(a,b){var c=pc[b]||n.find.attr;pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){var e,f;return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e}:function(a,b,c){return c?void 0:a[n.camelCase(\"default-\"+b)]?b.toLowerCase():null}}),sc&&rc||(n.attrHooks.value={set:function(a,b,c){return n.nodeName(a,\"input\")?void(a.defaultValue=b):nc&&nc.set(a,b,c)}}),rc||(nc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+=\"\",\"value\"===c||b===a.getAttribute(c)?b:void 0}},pc.id=pc.name=pc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&\"\"!==d.value?d.value:null},n.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:nc.set},n.attrHooks.contenteditable={set:function(a,b,c){nc.set(a,\"\"===b?!1:b,c)}},n.each([\"width\",\"height\"],function(a,b){n.attrHooks[b]={set:function(a,c){return\"\"===c?(a.setAttribute(b,\"auto\"),c):void 0}}})),l.style||(n.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+\"\"}});var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return W(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return a=n.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),n.extend({propFix:{\"for\":\"htmlFor\",\"class\":\"className\"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&\"set\"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&\"get\"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,\"tabindex\");return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1}}}}),l.hrefNormalized||n.each([\"href\",\"src\"],function(a,b){n.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),n.each([\"tabIndex\",\"readOnly\",\"maxLength\",\"cellSpacing\",\"cellPadding\",\"rowSpan\",\"colSpan\",\"useMap\",\"frameBorder\",\"contentEditable\"],function(){n.propFix[this.toLowerCase()]=this}),l.enctype||(n.propFix.enctype=\"encoding\");var vc=/[\\t\\r\\n\\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=\"string\"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||\"\").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(\" \"+c.className+\" \").replace(vc,\" \"):\" \")){f=0;while(e=b[f++])d.indexOf(\" \"+e+\" \")<0&&(d+=e+\" \");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||\"string\"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||\"\").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(\" \"+c.className+\" \").replace(vc,\" \"):\"\")){f=0;while(e=b[f++])while(d.indexOf(\" \"+e+\" \")>=0)d=d.replace(\" \"+e+\" \",\" \");g=a?n.trim(d):\"\",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return\"boolean\"==typeof b&&\"string\"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if(\"string\"===c){var b,d=0,e=n(this),f=a.match(F)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===L||\"boolean\"===c)&&(this.className&&n._data(this,\"__className__\",this.className),this.className=this.className||a===!1?\"\":n._data(this,\"__className__\")||\"\")})},hasClass:function(a){for(var b=\" \"+a+\" \",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(\" \"+this[c].className+\" \").replace(vc,\" \").indexOf(b)>=0)return!0;return!1}}),n.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,\"**\"):this.off(b,a||\"**\",c)}});var wc=n.now(),xc=/\\?/,yc=/(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g;n.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+\"\");var c,d=null,e=n.trim(b+\"\");return e&&!n.trim(e.replace(yc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,\"\")}))?Function(\"return \"+e)():n.error(\"Invalid JSON: \"+b)},n.parseXML=function(b){var c,d;if(!b||\"string\"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,\"text/xml\")):(c=new ActiveXObject(\"Microsoft.XMLDOM\"),c.async=\"false\",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName(\"parsererror\").length||n.error(\"Invalid XML: \"+b),c};var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/gm,Ec=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Fc=/^(?:GET|HEAD)$/,Gc=/^\\/\\//,Hc=/^([\\w.+-]+:)(?:\\/\\/(?:[^\\/?#]*@|)([^\\/?#:]*)(?::(\\d+)|)|)/,Ic={},Jc={},Kc=\"*/\".concat(\"*\");try{Ac=location.href}catch(Lc){Ac=z.createElement(\"a\"),Ac.href=\"\",Ac=Ac.href}zc=Hc.exec(Ac.toLowerCase())||[];function Mc(a){return function(b,c){\"string\"!=typeof b&&(c=b,b=\"*\");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))while(d=f[e++])\"+\"===d.charAt(0)?(d=d.slice(1)||\"*\",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nc(a,b,c,d){var e={},f=a===Jc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return\"string\"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e[\"*\"]&&g(\"*\")}function Oc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&n.extend(!0,a,c),a}function Pc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while(\"*\"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader(\"Content-Type\"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+\" \"+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Qc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if(\"*\"===f)f=i;else if(\"*\"!==i&&i!==f){if(g=j[i+\" \"+f]||j[\"* \"+f],!g)for(e in j)if(h=e.split(\" \"),h[1]===f&&(g=j[i+\" \"+h[0]]||j[\"* \"+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a[\"throws\"])b=g(b);else try{b=g(b)}catch(l){return{state:\"parsererror\",error:g?l:\"No conversion from \"+i+\" to \"+f}}}return{state:\"success\",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ac,type:\"GET\",isLocal:Ec.test(zc[1]),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Kc,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\",json:\"responseJSON\"},converters:{\"* text\":String,\"text html\":!0,\"text json\":n.parseJSON,\"text xml\":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)},ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){\"object\"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks(\"once memory\"),q=k.statusCode||{},r={},s={},t=0,u=\"canceled\",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Dc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+\"\").replace(Bc,\"\").replace(Gc,zc[1]+\"//\"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||\"*\").toLowerCase().match(F)||[\"\"],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||(\"http:\"===c[1]?\"80\":\"443\"))===(zc[3]||(\"http:\"===zc[1]?\"80\":\"443\")))),k.data&&k.processData&&\"string\"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t)return v;h=k.global,h&&0===n.active++&&n.event.trigger(\"ajaxStart\"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?\"&\":\"?\")+k.data,delete k.data),k.cache===!1&&(k.url=Cc.test(e)?e.replace(Cc,\"$1_=\"+wc++):e+(xc.test(e)?\"&\":\"?\")+\"_=\"+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader(\"If-Modified-Since\",n.lastModified[e]),n.etag[e]&&v.setRequestHeader(\"If-None-Match\",n.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader(\"Content-Type\",k.contentType),v.setRequestHeader(\"Accept\",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+(\"*\"!==k.dataTypes[0]?\", \"+Kc+\"; q=0.01\":\"\"):k.accepts[\"*\"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u=\"abort\";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Nc(Jc,k,b,v)){v.readyState=1,h&&m.trigger(\"ajaxSend\",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort(\"timeout\")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,\"No Transport\");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||\"\",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Pc(k,v,c)),u=Qc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader(\"Last-Modified\"),w&&(n.lastModified[e]=w),w=v.getResponseHeader(\"etag\"),w&&(n.etag[e]=w)),204===a||\"HEAD\"===k.type?x=\"nocontent\":304===a?x=\"notmodified\":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x=\"error\",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+\"\",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?\"ajaxSuccess\":\"ajaxError\",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger(\"ajaxComplete\",[v,k]),--n.active||n.event.trigger(\"ajaxStop\")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,\"json\")},getScript:function(a,b){return n.get(a,void 0,b,\"script\")}}),n.each([\"get\",\"post\"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:\"GET\",dataType:\"script\",async:!1,global:!1,\"throws\":!0})},n.fn.extend({wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,\"body\")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&\"none\"===(a.style&&a.style.display||n.css(a,\"display\"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Rc=/%20/g,Sc=/\\[\\]$/,Tc=/\\r?\\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;function Wc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Sc.test(a)?d(a,e):Wc(a+\"[\"+(\"object\"==typeof e?b:\"\")+\"]\",e,c,d)});else if(c||\"object\"!==n.type(b))d(a,b);else for(e in b)Wc(a+\"[\"+e+\"]\",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?\"\":b,d[d.length]=encodeURIComponent(a)+\"=\"+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Wc(c,a[c],b,e);return d.join(\"&\").replace(Rc,\"+\")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,\"elements\");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(\":disabled\")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Tc,\"\\r\\n\")}}):{name:b.name,value:c.replace(Tc,\"\\r\\n\")}}).get()}}),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||_c()}:$c;var Xc=0,Yc={},Zc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on(\"unload\",function(){for(var a in Yc)Yc[a](void 0,!0)}),l.cors=!!Zc&&\"withCredentials\"in Zc,Zc=l.ajax=!!Zc,Zc&&n.ajaxTransport(function(a){if(!a.crossDomain||l.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Xc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c[\"X-Requested-With\"]||(c[\"X-Requested-With\"]=\"XMLHttpRequest\");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+\"\");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Yc[g],b=void 0,f.onreadystatechange=n.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,\"string\"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=\"\"}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Yc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function $c(){try{return new a.XMLHttpRequest}catch(b){}}function _c(){try{return new a.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(b){}}n.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/(?:java|ecma)script/},converters:{\"text script\":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter(\"script\",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type=\"GET\",a.global=!1)}),n.ajaxTransport(\"script\",function(a){if(a.crossDomain){var b,c=z.head||n(\"head\")[0]||z.documentElement;return{send:function(d,e){b=z.createElement(\"script\"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,\"success\"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ad=[],bd=/(=)\\?(?=&|$)|\\?\\?/;n.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var a=ad.pop()||n.expando+\"_\"+wc++;return this[a]=!0,a}}),n.ajaxPrefilter(\"json jsonp\",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(bd.test(b.url)?\"url\":\"string\"==typeof b.data&&!(b.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&bd.test(b.data)&&\"data\");return h||\"jsonp\"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,\"$1\"+e):b.jsonp!==!1&&(b.url+=(xc.test(b.url)?\"&\":\"?\")+b.jsonp+\"=\"+e),b.converters[\"script json\"]=function(){return g||n.error(e+\" was not called\"),g[0]},b.dataTypes[0]=\"json\",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),\"script\"):void 0}),n.parseHTML=function(a,b,c){if(!a||\"string\"!=typeof a)return null;\"boolean\"==typeof b&&(c=b,b=!1),b=b||z;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var cd=n.fn.load;n.fn.load=function(a,b,c){if(\"string\"!=typeof a&&cd)return cd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(\" \");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&\"object\"==typeof b&&(f=\"POST\"),g.length>0&&n.ajax({url:a,type:f,dataType:\"html\",data:b}).done(function(a){e=arguments,g.html(d?n(\"<div>\").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var dd=a.document.documentElement;function ed(a){return n.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,\"position\"),l=n(a),m={};\"static\"===k&&(a.style.position=\"relative\"),h=l.offset(),f=n.css(a,\"top\"),i=n.css(a,\"left\"),j=(\"absolute\"===k||\"fixed\"===k)&&n.inArray(\"auto\",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),\"using\"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,n.contains(b,e)?(typeof e.getBoundingClientRect!==L&&(d=e.getBoundingClientRect()),c=ed(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return\"fixed\"===n.css(d,\"position\")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],\"html\")||(c=a.offset()),c.top+=n.css(a[0],\"borderTopWidth\",!0),c.left+=n.css(a[0],\"borderLeftWidth\",!0)),{top:b.top-c.top-n.css(d,\"marginTop\",!0),left:b.left-c.left-n.css(d,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||dd;while(a&&!n.nodeName(a,\"html\")&&\"static\"===n.css(a,\"position\"))a=a.offsetParent;return a||dd})}}),n.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(a,b){var c=/Y/.test(b);n.fn[a]=function(d){return W(this,function(a,d,e){var f=ed(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),n.each([\"top\",\"left\"],function(a,b){n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+\"px\":c):void 0})}),n.each({Height:\"height\",Width:\"width\"},function(a,b){n.each({padding:\"inner\"+a,content:b,\"\":\"outer\"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||\"boolean\"!=typeof d),g=c||(d===!0||e===!0?\"margin\":\"border\");return W(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement[\"client\"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body[\"scroll\"+a],e[\"scroll\"+a],b.body[\"offset\"+a],e[\"offset\"+a],e[\"client\"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,\"function\"==typeof define&&define.amd&&define(\"jquery\",[],function(){return n});var fd=a.jQuery,gd=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n},typeof b===L&&(a.jQuery=a.$=n),n});\n","/*! vex.js, vex.dialog.js 2.0.1 */\n(function(){var a;a=function(a){var b,c;return b=!1,a(function(){var d;return d=(document.body||document.documentElement).style,b=void 0!==d.animation||void 0!==d.WebkitAnimation||void 0!==d.MozAnimation||void 0!==d.MsAnimation||void 0!==d.OAnimation,a(window).bind(\"keyup.vex\",function(a){return 27===a.keyCode?c.closeByEscape():void 0})}),c={globalID:1,animationEndEvent:\"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend\",baseClassNames:{vex:\"vex\",content:\"vex-content\",overlay:\"vex-overlay\",close:\"vex-close\",closing:\"vex-closing\",open:\"vex-open\"},defaultOptions:{content:\"\",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:\"body\",className:\"\",css:{},overlayClassName:\"\",overlayCSS:{},contentClassName:\"\",contentCSS:{},closeClassName:\"\",closeCSS:{}},open:function(b){return b=a.extend({},c.defaultOptions,b),b.id=c.globalID,c.globalID+=1,b.$vex=a(\"<div>\").addClass(c.baseClassNames.vex).addClass(b.className).css(b.css).data({vex:b}),b.$vexOverlay=a(\"<div>\").addClass(c.baseClassNames.overlay).addClass(b.overlayClassName).css(b.overlayCSS).data({vex:b}),b.overlayClosesOnClick&&b.$vexOverlay.bind(\"click.vex\",function(b){return b.target===this?c.close(a(this).data().vex.id):void 0}),b.$vex.append(b.$vexOverlay),b.$vexContent=a(\"<div>\").addClass(c.baseClassNames.content).addClass(b.contentClassName).css(b.contentCSS).append(b.content).data({vex:b}),b.$vex.append(b.$vexContent),b.showCloseButton&&(b.$closeButton=a(\"<div>\").addClass(c.baseClassNames.close).addClass(b.closeClassName).css(b.closeCSS).data({vex:b}).bind(\"click.vex\",function(){return c.close(a(this).data().vex.id)}),b.$vexContent.append(b.$closeButton)),a(b.appendLocation).append(b.$vex),c.setupBodyClassName(b.$vex),b.afterOpen&&b.afterOpen(b.$vexContent,b),setTimeout(function(){return b.$vexContent.trigger(\"vexOpen\",b)},0),b.$vexContent},getAllVexes:function(){return a(\".\"+c.baseClassNames.vex+':not(\".'+c.baseClassNames.closing+'\") .'+c.baseClassNames.content)},getVexByID:function(b){return c.getAllVexes().filter(function(){return a(this).data().vex.id===b})},close:function(a){var b;if(!a){if(b=c.getAllVexes().last(),!b.length)return!1;a=b.data().vex.id}return c.closeByID(a)},closeAll:function(){var b;return b=c.getAllVexes().map(function(){return a(this).data().vex.id}).toArray(),(null!=b?b.length:void 0)?(a.each(b.reverse(),function(a,b){return c.closeByID(b)}),!0):!1},closeByID:function(d){var e,f,g,h,i;return f=c.getVexByID(d),f.length?(e=f.data().vex.$vex,i=a.extend({},f.data().vex),g=function(){return i.beforeClose?i.beforeClose(f,i):void 0},h=function(){return f.trigger(\"vexClose\",i),e.remove(),i.afterClose?i.afterClose(f,i):void 0},b?(g(),e.unbind(c.animationEndEvent).bind(c.animationEndEvent,function(){return h()}).addClass(c.baseClassNames.closing)):(g(),h()),!0):void 0},closeByEscape:function(){var b,d,e;return e=c.getAllVexes().map(function(){return a(this).data().vex.id}).toArray(),(null!=e?e.length:void 0)?(d=Math.max.apply(Math,e),b=c.getVexByID(d),b.data().vex.escapeButtonCloses!==!0?!1:c.closeByID(d)):!1},setupBodyClassName:function(b){return b.bind(\"vexOpen.vex\",function(){return a(\"body\").addClass(c.baseClassNames.open)}).bind(\"vexClose.vex\",function(){return c.getAllVexes().length?void 0:a(\"body\").removeClass(c.baseClassNames.open)})},hideLoading:function(){return a(\".vex-loading-spinner\").remove()},showLoading:function(){return c.hideLoading(),a(\"body\").append('<div class=\"vex-loading-spinner '+c.defaultOptions.className+'\"></div>')}}},\"function\"==typeof define&&define.amd?define([\"jquery\"],a):\"object\"==typeof exports?module.exports=a(require(\"jquery\")):window.vex=a(jQuery)}).call(this),function(){var a;a=function(a,b){var c,d;return null==b?a.error(\"Vex is required to use vex.dialog\"):(c=function(b){var c;return c={},a.each(b.serializeArray(),function(){return c[this.name]?(c[this.name].push||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||\"\")):c[this.name]=this.value||\"\"}),c},d={},d.buttons={YES:{text:\"OK\",type:\"submit\",className:\"vex-dialog-button-primary\"},NO:{text:\"Cancel\",type:\"button\",className:\"vex-dialog-button-secondary\",click:function(a){return a.data().vex.value=!1,b.close(a.data().vex.id)}}},d.defaultOptions={callback:function(){},afterOpen:function(){},message:\"Message\",input:'<input name=\"vex\" type=\"hidden\" value=\"_vex-empty-value\" />',value:!1,buttons:[d.buttons.YES,d.buttons.NO],showCloseButton:!1,onSubmit:function(e){var f,g;return f=a(this),g=f.parent(),e.preventDefault(),e.stopPropagation(),g.data().vex.value=d.getFormValueOnSubmit(c(f)),b.close(g.data().vex.id)},focusFirstInput:!0},d.defaultAlertOptions={message:\"Alert\",buttons:[d.buttons.YES]},d.defaultConfirmOptions={message:\"Confirm\"},d.open=function(c){var e;return c=a.extend({},b.defaultOptions,d.defaultOptions,c),c.content=d.buildDialogForm(c),c.beforeClose=function(a){return c.callback(a.data().vex.value)},e=b.open(c),c.focusFirstInput&&e.find('input[type=\"submit\"], textarea, input[type=\"date\"], input[type=\"datetime\"], input[type=\"datetime-local\"], input[type=\"email\"], input[type=\"month\"], input[type=\"number\"], input[type=\"password\"], input[type=\"search\"], input[type=\"tel\"], input[type=\"text\"], input[type=\"time\"], input[type=\"url\"], input[type=\"week\"]').first().focus(),e},d.alert=function(b){return\"string\"==typeof b&&(b={message:b}),b=a.extend({},d.defaultAlertOptions,b),d.open(b)},d.confirm=function(b){return\"string\"==typeof b?a.error(\"dialog.confirm(options) requires options.callback.\"):(b=a.extend({},d.defaultConfirmOptions,b),d.open(b))},d.prompt=function(b){var c;return\"string\"==typeof b?a.error(\"dialog.prompt(options) requires options.callback.\"):(c={message:'<label for=\"vex\">'+(b.label||\"Prompt:\")+\"</label>\",input:'<input name=\"vex\" type=\"text\" class=\"vex-dialog-prompt-input\" placeholder=\"'+(b.placeholder||\"\")+'\"  value=\"'+(b.value||\"\")+'\" />'},b=a.extend({},c,b),d.open(b))},d.buildDialogForm=function(b){var c,e,f;return c=a('<form class=\"vex-dialog-form\" />'),f=a('<div class=\"vex-dialog-message\" />'),e=a('<div class=\"vex-dialog-input\" />'),c.append(f.append(b.message)).append(e.append(b.input)).append(d.buttonsToDOM(b.buttons)).bind(\"submit.vex\",b.onSubmit),c},d.getFormValueOnSubmit=function(a){return a.vex||\"\"===a.vex?\"_vex-empty-value\"===a.vex?!0:a.vex:a},d.buttonsToDOM=function(c){var d;return d=a('<div class=\"vex-dialog-buttons\" />'),a.each(c,function(e,f){return d.append(a('<input type=\"'+f.type+'\" />').val(f.text).addClass(f.className+\" vex-dialog-button \"+(0===e?\"vex-first \":\"\")+(e===c.length-1?\"vex-last \":\"\")).bind(\"click.vex\",function(c){return f.click?f.click(a(this).parents(\".\"+b.baseClassNames.content),c):void 0}))}),d},d)},\"function\"==typeof define&&define.amd?define([\"jquery\",\"vex\"],a):\"object\"==typeof exports?module.exports=a(require(\"jquery\"),require(\"vex\")):window.vex.dialog=a(window.jQuery,window.vex)}.call(this);"]}