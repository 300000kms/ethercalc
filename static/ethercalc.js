// Auto-generated from "make depends"; ALL CHANGES HERE WILL BE LOST!
!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(e,this)):"object"==typeof module&&module.exports?module.exports=t.call(e,this):e.SocialCalc=t.call(e,this)}(this,function(e){var t;t||(t={}),t.Constants={cellDataType:{v:"value",n:"value",t:"text",f:"formula",c:"constant"},textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"3",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #C0C0C0;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultReadonlyClass:"",defaultReadonlyStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);",defaultReadonlyNoGridClass:"",defaultReadonlyNoGridStyle:"",defaultReadonlyComment:"Locked cell",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",defaultColnameClass:"",defaultColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;",defaultRownameClass:"",defaultRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",defaultUnhideLeftClass:"",defaultUnhideLeftStyle:"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;",defaultUnhideRightClass:"",defaultUnhideRightStyle:"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;",defaultUnhideTopClass:"",defaultUnhideTopStyle:"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;",defaultUnhideBottomClass:"",defaultUnhideBottomStyle:"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;",defaultColResizeBarClass:"col-resize-bar",defaultRowResizeBarClass:"row-resize-bar",s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatp:"#,##0.0%",defaultFormatc:"[$$]#,##0.00",defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"images/sc_",defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',s_statusline_circref:'<span style="color:red;">Circular reference: ',s_statusline_sendemail:"Sending Email ",s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoHintClass:"",defaultInputEchoHintStyle:"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;",ietUnknownFunction:"Unknown function ",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderClass:"tc-paneslider",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"tracklingine",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#ffffff;",SCTabbackground:"background-color:#CCC;",SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",SCToolbartext:"font-size:x-small;font-weight:bold;color:#888",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",SCFormatUserMaxCol:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",SCFormatUserMaxRow:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",ISCButtonNormalBackground:"transparent",ISCButtonBorderNormal:"none",ISCButtonBorderHover:"none",ISCButtonBorderDown:"none",ISCButtonDownBackground:"#888",s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",s_loc_delete_contents:"Delete Cell Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_hide_column:"Hide Column",s_loc_hide_row:"Hide Row",s_loc_horizontal:"Horizontal",s_loc_insert_column:"Insert Column Before",s_loc_insert_row:"Insert Row Before",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",s_loc_lock_cell:"Lock Cell",s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge/Unmerge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unlock_cell:"Unlock Cell",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s_FormatNumber_daynames3:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s_FormatNumber_monthnames:["January","February","March","April","May","June","July","August","September","October","November","December"],s_FormatNumber_monthnames3:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",s_fdef_YEAR:"Returns the year part of a date value. ",s_fdef_SUMPRODUCT:"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.",s_fdef_CEILING:"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)",s_fdef_FLOOR:"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period, [factor]",s_farg_find:"string1, string2, [start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",s_farg_hlookup:"value, range, row, [rangelookup]",s_farg_iffunc:"logical-expression, true-value, [false-value]",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",s_farg_replace:"text1, start, length, text2",s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext, [occurrence]",s_farg_sumif:"range1, criteria, [range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",s_farg_rangen:"range1, range2, ...",s_farg_vsig:"value, [significance]",function_classlist:["all","stat","lookup","datetime","financial","test","math","text","gui","action"],s_fclass_all:"All",s_fclass_stat:"Statistics",s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",s_fclass_action:"Email & Copy",s_fclass_gui:"Button & Input",lastone:null},t.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",TDpopupElement:""},t.ConstantsSetClasses=function(e){var o,n=t.ConstantsDefaultClasses,r=t.Constants;
e=e||"";for(o in n)"string"==typeof n[o]?(r[o+"Class"]=e+(n[o]||o),void 0!==r[o+"Style"]&&(r[o+"Style"]="")):"object"==typeof n[o]&&(r[o+"Class"]=e+(n[o].classname||o),r[o+"Style"]=n[o].style)},t.ConstantsSetImagePrefix=function(e){var o=t.Constants;for(var n in o)"string"==typeof o[n]&&(o[n]=o[n].replace(o.defaultImagePrefix,e));o.defaultImagePrefix=e};var t;t||(t={}),t.Callbacks={expand_wiki:null,expand_markup:function(e,o,n){return t.default_expand_markup(e,o,n)},MakePageLink:null,NormalizeSheetName:null},t.Cell=function(e){this.coord=e,this.datavalue="",this.datatype=null,this.formula="",this.valuetype="b",this.readonly=!1},t.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3},t.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"},t.Sheet=function(){t.ResetSheet(this),this.statuscallback=null,this.statuscallbackparams=null},t.ResetSheet=function(e){e.cells={},e.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0},e.rowattribs={hide:{},height:{}},e.colattribs={width:{},hide:{}},e.names={},e.layouts=[],e.layouthash={},e.fonts=[],e.fonthash={},e.colors=[],e.colorhash={},e.borderstyles=[],e.borderstylehash={},e.cellformats=[],e.cellformathash={},e.valueformats=[],e.valueformathash={},e.matched_cells=[],e.selected_search_cell=void 0,e.copiedfrom="",e.changes=new t.UndoStack,e.renderneeded=!1,e.changedrendervalues=!0,e.recalcchangedavalue=!1,e.hiddencolrow="",e.sci=new t.SheetCommandInfo(e),e.ioEventTree={},e.ioParameterList={}},t.Sheet.prototype.ResetSheet=function(){t.ResetSheet(this)},t.Sheet.prototype.AddCell=function(e){return this.cells[e.coord]=e},t.Sheet.prototype.LastCol=function(){var e=1;for(var o in this.cells){var n=t.coordToCr(o);n.col>e&&(e=n.col)}return e},t.Sheet.prototype.LastRow=function(){var e=1;for(var o in this.cells){var n=t.coordToCr(o);n.row>e&&(e=n.row)}return e},t.Sheet.prototype.GetAssuredCell=function(e){return this.cells[e]||this.AddCell(new t.Cell(e))},t.Sheet.prototype.ParseSheetSave=function(e){t.ParseSheetSave(e,this)},t.Sheet.prototype.CellFromStringParts=function(e,o,n){return t.CellFromStringParts(this,e,o,n)},t.Sheet.prototype.CreateSheetSave=function(e,o){return t.CreateSheetSave(this,e,o)},t.Sheet.prototype.CellToString=function(e){return t.CellToString(this,e)},t.Sheet.prototype.CanonicalizeSheet=function(e){return t.CanonicalizeSheet(this,e)},t.Sheet.prototype.EncodeCellAttributes=function(e){return t.EncodeCellAttributes(this,e)},t.Sheet.prototype.EncodeSheetAttributes=function(){return t.EncodeSheetAttributes(this)},t.Sheet.prototype.DecodeCellAttributes=function(e,o,n){return t.DecodeCellAttributes(this,e,o,n)},t.Sheet.prototype.DecodeSheetAttributes=function(e){return t.DecodeSheetAttributes(this,e)},t.Sheet.prototype.ScheduleSheetCommands=function(e,o){return t.ScheduleSheetCommands(this,e,o)},t.Sheet.prototype.SheetUndo=function(){return t.SheetUndo(this)},t.Sheet.prototype.SheetRedo=function(){return t.SheetRedo(this)},t.Sheet.prototype.CreateAuditString=function(){return t.CreateAuditString(this)},t.Sheet.prototype.GetStyleNum=function(e,o){return t.GetStyleNum(this,e,o)},t.Sheet.prototype.GetStyleString=function(e,o){return t.GetStyleString(this,e,o)},t.Sheet.prototype.RecalcSheet=function(){return t.RecalcSheet(this)},t.ParseSheetSave=function(e,o){var n,r,a,l,i,s,c,u,d,p=e.split(/\r\n|\n/),f=[],h=t.Constants;for(r=0;r<p.length;r++){switch(n=p[r],f=n.split(":"),f[0]){case"cell":c=o.GetAssuredCell(f[1]),a=2,o.CellFromStringParts(c,f,a);break;case"col":for(s=f[1],a=2;l=f[a++];)switch(l){case"w":o.colattribs.width[s]=f[a++];break;case"hide":o.colattribs.hide[s]=f[a++];break;default:throw h.s_pssUnknownColType+" '"+l+"'"}break;case"row":for(s=f[1]-0,a=2;l=f[a++];)switch(l){case"h":o.rowattribs.height[s]=f[a++]-0;break;case"hide":o.rowattribs.hide[s]=f[a++];break;default:throw h.s_pssUnknownRowType+" '"+l+"'"}break;case"sheet":for(u=o.attribs,a=1;l=f[a++];)switch(l){case"c":u.lastcol=f[a++]-0;break;case"r":u.lastrow=f[a++]-0;break;case"w":u.defaultcolwidth=f[a++]+"";break;case"h":u.defaultrowheight=f[a++]-0;break;case"tf":u.defaulttextformat=f[a++]-0;break;case"ntf":u.defaultnontextformat=f[a++]-0;break;case"layout":u.defaultlayout=f[a++]-0;break;case"font":u.defaultfont=f[a++]-0;break;case"tvf":u.defaulttextvalueformat=f[a++]-0;break;case"ntvf":u.defaultnontextvalueformat=f[a++]-0;break;case"color":u.defaultcolor=f[a++]-0;break;case"bgcolor":u.defaultbgcolor=f[a++]-0;break;case"circularreferencecell":u.circularreferencecell=f[a++];break;case"recalc":u.recalc=f[a++];break;case"needsrecalc":u.needsrecalc=f[a++];break;case"usermaxcol":u.usermaxcol=f[a++]-0;break;case"usermaxrow":u.usermaxrow=f[a++]-0;break;default:a+=1}break;case"name":d=t.decodeFromSave(f[1]).toUpperCase(),o.names[d]={desc:t.decodeFromSave(f[2])},o.names[d].definition=t.decodeFromSave(f[3]);break;case"layout":f=p[r].match(/^layout\:(\d+)\:(.+)$/),o.layouts[f[1]-0]=f[2],o.layouthash[f[2]]=f[1]-0;break;case"font":o.fonts[f[1]-0]=f[2],o.fonthash[f[2]]=f[1]-0;break;case"color":o.colors[f[1]-0]=f[2],o.colorhash[f[2]]=f[1]-0;break;case"border":o.borderstyles[f[1]-0]=f[2],o.borderstylehash[f[2]]=f[1]-0;break;case"cellformat":i=t.decodeFromSave(f[2]),o.cellformats[f[1]-0]=i,o.cellformathash[i]=f[1]-0;break;case"valueformat":i=t.decodeFromSave(f[2]),o.valueformats[f[1]-0]=i,o.valueformathash[i]=f[1]-0;break;case"version":break;case"copiedfrom":o.copiedfrom=f[1]+":"+f[2];break;case"clipboardrange":case"clipboard":break;case"":break;default:throw alert(h.s_pssUnknownLineType+" '"+f[0]+"'"),h.s_pssUnknownLineType+" '"+f[0]+"'"}f=null}},t.CellFromStringParts=function(e,o,n,r){for(var o,a,l;a=n[r++];)switch(a){case"v":o.datavalue=t.decodeFromSave(n[r++])-0,o.datatype="v",o.valuetype="n";break;case"t":o.datavalue=t.decodeFromSave(n[r++]),o.datatype="t",o.valuetype=t.Constants.textdatadefaulttype;break;case"vt":l=n[r++],o.valuetype=l,"n"==l.charAt(0)?(o.datatype="v",o.datavalue=t.decodeFromSave(n[r++])-0):(o.datatype="t",o.datavalue=t.decodeFromSave(n[r++]));break;case"vtf":l=n[r++],o.valuetype=l,o.datavalue="n"==l.charAt(0)?t.decodeFromSave(n[r++])-0:t.decodeFromSave(n[r++]),o.formula=t.decodeFromSave(n[r++]),o.datatype="f";break;case"vtc":l=n[r++],o.valuetype=l,o.datavalue="n"==l.charAt(0)?t.decodeFromSave(n[r++])-0:t.decodeFromSave(n[r++]),o.formula=t.decodeFromSave(n[r++]),o.datatype="c";break;case"ro":ro=t.decodeFromSave(n[r++]),o.readonly="yes"==ro.toLowerCase();break;case"e":o.errors=t.decodeFromSave(n[r++]);break;case"b":o.bt=n[r++]-0,o.br=n[r++]-0,o.bb=n[r++]-0,o.bl=n[r++]-0;break;case"l":o.layout=n[r++]-0;break;case"f":o.font=n[r++]-0;break;case"c":o.color=n[r++]-0;break;case"bg":o.bgcolor=n[r++]-0;break;case"cf":o.cellformat=n[r++]-0;break;case"ntvf":o.nontextvalueformat=n[r++]-0;break;case"tvf":o.textvalueformat=n[r++]-0;break;case"colspan":o.colspan=n[r++]-0;break;case"rowspan":o.rowspan=n[r++]-0;break;case"cssc":o.cssc=n[r++];break;case"csss":o.csss=t.decodeFromSave(n[r++]);break;case"mod":r+=1;break;case"comment":o.comment=t.decodeFromSave(n[r++]);break;default:throw t.Constants.s_cfspUnknownCellType+" '"+a+"'"}},t.sheetfields=["defaultrowheight","defaultcolwidth","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],t.sheetfieldsshort=["h","w","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],t.sheetfieldsxlat=["defaulttextformat","defaultnontextformat","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","defaultfont","defaultlayout"],t.sheetfieldsxlatshort=["tf","ntf","tvf","ntvf","color","bgcolor","font","layout"],t.sheetfieldsxlatxlt=["cellformat","cellformat","valueformat","valueformat","color","color","font","layout"],t.CreateSheetSave=function(e,o,n){var r,a,l,i,s,c,u,d,p,f,h,m=[];e.CanonicalizeSheet(n||t.Constants.doCanonicalizeSheet);var g=e.xlt;for(h=o?t.ParseRange(o):{cr1:{row:1,col:1},cr2:{row:g.maxrow,col:g.maxcol}},a=h.cr1,l=h.cr2,m.push("version:1.5"),i=a.row;i<=l.row;i++)for(s=a.col;s<=l.col;s++)c=t.crToCoord(s,i),r=e.cells[c],r&&(u=e.CellToString(r),0!=u.length&&(u="cell:"+c+u,m.push(u)));for(s=1;s<=g.maxcol;s++)c=t.rcColname(s),e.colattribs.width[c]&&m.push("col:"+c+":w:"+e.colattribs.width[c]),e.colattribs.hide[c]&&m.push("col:"+c+":hide:"+e.colattribs.hide[c]);for(i=1;i<=g.maxrow;i++)e.rowattribs.height[i]&&m.push("row:"+i+":h:"+e.rowattribs.height[i]),e.rowattribs.hide[i]&&m.push("row:"+i+":hide:"+e.rowattribs.hide[i]);for(u="sheet:c:"+g.maxcol+":r:"+g.maxrow,p=0;p<t.sheetfields.length;p++)d=t.encodeForSave(e.attribs[t.sheetfields[p]]),d&&(u+=":"+t.sheetfieldsshort[p]+":"+d);for(p=0;p<t.sheetfieldsxlat.length;p++)d=e.attribs[t.sheetfieldsxlat[p]],d&&(u+=":"+t.sheetfieldsxlatshort[p]+":"+g[t.sheetfieldsxlatxlt[p]+"sxlat"][d]);for(m.push(u),p=1;p<g.newborderstyles.length;p++)m.push("border:"+p+":"+g.newborderstyles[p]);for(p=1;p<g.newcellformats.length;p++)m.push("cellformat:"+p+":"+t.encodeForSave(g.newcellformats[p]));for(p=1;p<g.newcolors.length;p++)m.push("color:"+p+":"+g.newcolors[p]);for(p=1;p<g.newfonts.length;p++)m.push("font:"+p+":"+g.newfonts[p]);for(p=1;p<g.newlayouts.length;p++)m.push("layout:"+p+":"+g.newlayouts[p]);for(p=1;p<g.newvalueformats.length;p++)m.push("valueformat:"+p+":"+t.encodeForSave(g.newvalueformats[p]));for(p=0;p<g.namesorder.length;p++)f=g.namesorder[p],m.push("name:"+t.encodeForSave(f).toUpperCase()+":"+t.encodeForSave(e.names[f].desc)+":"+t.encodeForSave(e.names[f].definition));return o&&m.push("copiedfrom:"+t.crToCoord(a.col,a.row)+":"+t.crToCoord(l.col,l.row)),m.push(""),delete e.xlt,m.join("\n")},t.CellToString=function(e,o){var o,n,r,a,l,i,s,c,u;return n="",o?(r=t.encodeForSave(o.datavalue),"v"==o.datatype?n+="n"==o.valuetype?":v:"+r:":vt:"+o.valuetype+":"+r:"t"==o.datatype?n+=o.valuetype==t.Constants.textdatadefaulttype?":t:"+r:":vt:"+o.valuetype+":"+r:(a=t.encodeForSave(o.formula),"f"==o.datatype?n+=":vtf:"+o.valuetype+":"+r+":"+a:"c"==o.datatype&&(n+=":vtc:"+o.valuetype+":"+r+":"+a)),o.readonly&&(n+=":ro:yes"),o.errors&&(n+=":e:"+t.encodeForSave(o.errors)),l=o.bt||"",i=o.br||"",s=o.bb||"",c=o.bl||"",e.xlt?(u=e.xlt,(l||i||s||c)&&(n+=":b:"+u.borderstylesxlat[l||0]+":"+u.borderstylesxlat[i||0]+":"+u.borderstylesxlat[s||0]+":"+u.borderstylesxlat[c||0]),o.layout&&(n+=":l:"+u.layoutsxlat[o.layout]),o.font&&(n+=":f:"+u.fontsxlat[o.font]),o.color&&(n+=":c:"+u.colorsxlat[o.color]),o.bgcolor&&(n+=":bg:"+u.colorsxlat[o.bgcolor]),o.cellformat&&(n+=":cf:"+u.cellformatsxlat[o.cellformat]),o.textvalueformat&&(n+=":tvf:"+u.valueformatsxlat[o.textvalueformat]),o.nontextvalueformat&&(n+=":ntvf:"+u.valueformatsxlat[o.nontextvalueformat])):((l||i||s||c)&&(n+=":b:"+l+":"+i+":"+s+":"+c),o.layout&&(n+=":l:"+o.layout),o.font&&(n+=":f:"+o.font),o.color&&(n+=":c:"+o.color),o.bgcolor&&(n+=":bg:"+o.bgcolor),o.cellformat&&(n+=":cf:"+o.cellformat),o.textvalueformat&&(n+=":tvf:"+o.textvalueformat),o.nontextvalueformat&&(n+=":ntvf:"+o.nontextvalueformat)),o.colspan&&(n+=":colspan:"+o.colspan),o.rowspan&&(n+=":rowspan:"+o.rowspan),o.cssc&&(n+=":cssc:"+o.cssc),o.csss&&(n+=":csss:"+t.encodeForSave(o.csss)),o.mod&&(n+=":mod:"+o.mod),o.comment&&(n+=":comment:"+t.encodeForSave(o.comment)),n):n},t.CanonicalizeSheet=function(e,o){var n,r,a,l,i,s,c,u,d,p,f,h,m,g=0,v=0,b=["borderstyle","cellformat","color","font","layout","valueformat"],y={};y.namesorder=[];for(c in e.names)y.namesorder.push(c);if(y.namesorder.sort(),!t.Constants.doCanonicalizeSheet||!o){for(s=0;s<b.length;s++){for(c=b[s],y["new"+c+"s"]=e[c+"s"],n=e[c+"s"].length,d=new Array(n),d[0]="",h=1;n>h;h++)d[h]=h;y[c+"sxlat"]=d}return y.maxrow=e.attribs.lastrow,y.maxcol=e.attribs.lastcol,void(e.xlt=y)}for(s=0;s<b.length;s++)c=b[s],y[c+"sUsed"]={};var C=y.colorsUsed,x=y.borderstylesUsed,w=y.fontsUsed,S=y.layoutsUsed,T=y.cellformatsUsed,F=y.valueformatsUsed;for(r in e.cells)a=t.coordToCr(r),l=e.cells[r],i=!1,l.valuetype&&"b"!=l.valuetype&&(i=!0),l.color&&(C[l.color]=1,i=!0),l.bgcolor&&(C[l.bgcolor]=1,i=!0),l.bt&&(x[l.bt]=1,i=!0),l.br&&(x[l.br]=1,i=!0),l.bb&&(x[l.bb]=1,i=!0),l.bl&&(x[l.bl]=1,i=!0),l.layout&&(S[l.layout]=1,i=!0),l.font&&(w[l.font]=1,i=!0),l.cellformat&&(T[l.cellformat]=1,i=!0),l.textvalueformat&&(F[l.textvalueformat]=1,i=!0),l.nontextvalueformat&&(F[l.nontextvalueformat]=1,i=!0),i&&(a.row>g&&(g=a.row),a.col>v&&(v=a.col));for(h=0;h<t.sheetfieldsxlat.length;h++)m=e.attribs[t.sheetfieldsxlat[h]],m&&(y[t.sheetfieldsxlatxlt[h]+"sUsed"][m]=1);c={height:1,hide:1};for(m in c)for(a in e.rowattribs[m])a>g&&(g=a);c={hide:1,width:1};for(m in c)for(r in e.colattribs[m])a=t.coordToCr(r+"1"),a.col>v&&(v=a.col);for(s=0;s<b.length;s++){c=b[s],u=[],p=y[c+"sUsed"];for(m in p)u.push(e[c+"s"][m]);for(u.sort(),u.unshift(""),d=[""],f=e[c+"hash"],h=1;h<u.length;h++)d[f[u[h]]]=h;y[c+"sxlat"]=d,y["new"+c+"s"]=u}y.maxrow=g||1,y.maxcol=v||1,e.xlt=y},t.EncodeCellAttributes=function(e,t){var o,n,r,a={},l=function(e){a[e]={def:!0,val:""}},i=function(e){for(var t=0;t<e.length;t++)l(e[t])},s=function(e,t){a[e].def=!1,a[e].val=t||""},c=function(e,t){"*"!=t&&(a[e].def=!1,a[e].val=t)},u=e.GetAssuredCell(t);for(l("alignhoriz"),u.cellformat&&s("alignhoriz",e.cellformats[u.cellformat]),i(["alignvert","padtop","padright","padbottom","padleft"]),u.layout&&(parts=e.layouts[u.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),c("padtop",parts[1]),c("padright",parts[2]),c("padbottom",parts[3]),c("padleft",parts[4]),c("alignvert",parts[5])),i(["fontfamily","fontlook","fontsize"]),u.font&&(parts=e.fonts[u.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),c("fontfamily",parts[3]),c("fontsize",parts[2]),c("fontlook",parts[1])),l("textcolor"),u.color&&s("textcolor",e.colors[u.color]),l("bgcolor"),u.bgcolor&&s("bgcolor",e.colors[u.bgcolor]),i(["numberformat","textformat"]),u.nontextvalueformat&&s("numberformat",e.valueformats[u.nontextvalueformat]),u.textvalueformat&&s("textformat",e.valueformats[u.textvalueformat]),i(["colspan","rowspan"]),s("colspan",u.colspan||1),s("rowspan",u.rowspan||1),o=0;4>o;o++)n="trbl".charAt(o),r="b"+n,l(r),s(r,u[r]?e.borderstyles[u[r]]:""),l(r+"thickness"),l(r+"style"),l(r+"color"),u[r]&&(parts=e.borderstyles[u[r]].match(/(\S+)\s+(\S+)\s+(\S.+)/),s(r+"thickness",parts[1]),s(r+"style",parts[2]),s(r+"color",parts[3]));return i(["cssc","csss","mod"]),s("cssc",u.cssc||""),s("csss",u.csss||""),s("mod",u.mod||"n"),a},t.EncodeSheetAttributes=function(e){var t,o=e.attribs,n={},r=function(e){n[e]={def:!0,val:""}},a=function(e){for(var t=0;t<e.length;t++)r(e[t])},l=function(e,o){n[e].def=!1,n[e].val=o||t},i=function(e,t){"*"!=t&&(n[e].def=!1,n[e].val=t)};return r("colwidth"),o.defaultcolwidth&&l("colwidth",o.defaultcolwidth),r("rowheight"),o.rowheight&&l("rowheight",o.defaultrowheight),r("textalignhoriz"),o.defaulttextformat&&l("textalignhoriz",e.cellformats[o.defaulttextformat]),r("numberalignhoriz"),o.defaultnontextformat&&l("numberalignhoriz",e.cellformats[o.defaultnontextformat]),a(["alignvert","padtop","padright","padbottom","padleft"]),o.defaultlayout&&(parts=e.layouts[o.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),i("padtop",parts[1]),i("padright",parts[2]),i("padbottom",parts[3]),i("padleft",parts[4]),i("alignvert",parts[5])),a(["fontfamily","fontlook","fontsize"]),o.defaultfont&&(parts=e.fonts[o.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),i("fontfamily",parts[3]),i("fontsize",parts[2]),i("fontlook",parts[1])),r("textcolor"),o.defaultcolor&&l("textcolor",e.colors[o.defaultcolor]),r("bgcolor"),o.defaultbgcolor&&l("bgcolor",e.colors[o.defaultbgcolor]),a(["numberformat","textformat"]),o.defaultnontextvalueformat&&l("numberformat",e.valueformats[o.defaultnontextvalueformat]),o.defaulttextvalueformat&&l("textformat",e.valueformats[o.defaulttextvalueformat]),r("recalc"),o.recalc&&l("recalc",o.recalc),r("usermaxcol"),o.usermaxcol&&l("usermaxcol",o.usermaxcol),r("usermaxrow"),o.usermaxrow&&l("usermaxrow",o.usermaxrow),n},t.DecodeCellAttributes=function(e,t,o,n){var r,a,l,s=e.GetAssuredCell(t),c=!1,u=function(e,t,n){var r;o[e]&&(r=o[e].def?"":o[e].val,r!=(t||"")&&p(n+" "+r))},d="",p=function(e){d&&(d+="\n"),d+="set "+(n||t)+" "+e,c=!0};for(u("alignhoriz",e.cellformats[s.cellformat],"cellformat"),r=o.alignvert.def&&o.padtop.def&&o.padright.def&&o.padbottom.def&&o.padleft.def?"":"padding:"+(o.padtop.def?"* ":o.padtop.val+" ")+(o.padright.def?"* ":o.padright.val+" ")+(o.padbottom.def?"* ":o.padbottom.val+" ")+(o.padleft.def?"*":o.padleft.val)+";vertical-align:"+(o.alignvert.def?"*;":o.alignvert.val+";"),r!=(e.layouts[s.layout]||"")&&p("layout "+r),r=o.fontlook.def&&o.fontsize.def&&o.fontfamily.def?"":(o.fontlook.def?"* ":o.fontlook.val+" ")+(o.fontsize.def?"* ":o.fontsize.val+" ")+(o.fontfamily.def?"*":o.fontfamily.val),r!=(e.fonts[s.font]||"")&&p("font "+r),u("textcolor",e.colors[s.color],"color"),u("bgcolor",e.colors[s.bgcolor],"bgcolor"),u("numberformat",e.valueformats[s.nontextvalueformat],"nontextvalueformat"),u("textformat",e.valueformats[s.textvalueformat],"textvalueformat"),i=0;4>i;i++)a="trbl".charAt(i),l="b"+a,u(l,e.borderstyles[s[l]],l);return u("cssc",s.cssc,"cssc"),u("csss",s.csss,"csss"),o.mod&&(r=o.mod.def?"n":o.mod.val,r!=(s.mod||"n")&&("n"==r&&(r=""),p("mod "+r))),c?d:null},t.DecodeSheetAttributes=function(e,t){var o,n=e.attribs,r=!1,a=function(e,o,n){var r;t[e]&&(r=t[e].def?"":t[e].val,r!=(o||"")&&i(n+" "+r))},l="",i=function(e){l&&(l+="\n"),l+="set sheet "+e,r=!0};return a("colwidth",n.defaultcolwidth,"defaultcolwidth"),a("rowheight",n.defaultrowheight,"defaultrowheight"),a("textalignhoriz",e.cellformats[n.defaulttextformat],"defaulttextformat"),a("numberalignhoriz",e.cellformats[n.defaultnontextformat],"defaultnontextformat"),o=t.alignvert.def&&t.padtop.def&&t.padright.def&&t.padbottom.def&&t.padleft.def?"":"padding:"+(t.padtop.def?"* ":t.padtop.val+" ")+(t.padright.def?"* ":t.padright.val+" ")+(t.padbottom.def?"* ":t.padbottom.val+" ")+(t.padleft.def?"*":t.padleft.val)+";vertical-align:"+(t.alignvert.def?"*;":t.alignvert.val+";"),o!=(e.layouts[n.defaultlayout]||"")&&i("defaultlayout "+o),o=t.fontlook.def&&t.fontsize.def&&t.fontfamily.def?"":(t.fontlook.def?"* ":t.fontlook.val+" ")+(t.fontsize.def?"* ":t.fontsize.val+" ")+(t.fontfamily.def?"*":t.fontfamily.val),o!=(e.fonts[n.defaultfont]||"")&&i("defaultfont "+o),a("textcolor",e.colors[n.defaultcolor],"defaultcolor"),a("bgcolor",e.colors[n.defaultbgcolor],"defaultbgcolor"),a("numberformat",e.valueformats[n.defaultnontextvalueformat],"defaultnontextvalueformat"),a("textformat",e.valueformats[n.defaulttextvalueformat],"defaulttextvalueformat"),a("recalc",e.attribs.recalc,"recalc"),a("usermaxcol",e.attribs.usermaxcol,"usermaxcol"),a("usermaxrow",e.attribs.usermaxrow,"usermaxrow"),r?l:null},t.SheetCommandInfo=function(e){this.sheetobj=e,this.timerobj=null,this.firsttimerdelay=50,this.timerdelay=1,this.maxtimeslice=100,this.saveundo=!1,this.CmdExtensionCallbacks={}},t.ScheduleSheetCommands=function(o,n,r){var a=o.sci,l=new t.Parse(n);a.sheetobj.statuscallback&&o.statuscallback(a,"cmdstart","",a.sheetobj.statuscallbackparams),r&&a.sheetobj.changes.PushChange(""),a.timerobj=e.setTimeout(function(){t.SheetCommandsTimerRoutine(a,l,r)},a.firsttimerdelay)},t.SheetCommandsTimerRoutine=function(o,n,r){var a,l=new Date;for(o.timerobj=null;!n.EOF();)if(a=t.ExecuteSheetCommand(o.sheetobj,n,r),a&&("function"==typeof alert?alert(a):console.log(a)),n.NextLine(),new Date-l>=o.maxtimeslice)return void(o.timerobj=e.setTimeout(function(){t.SheetCommandsTimerRoutine(o,n,r)},o.timerdelay));o.sheetobj.statuscallback&&o.sheetobj.statuscallback(o,"cmdend","",o.sheetobj.statuscallbackparams)},t.ExecuteSheetCommand=function(e,o,n){function r(o){function n(e){return"v"==e||"c"==e}var r=t.GetSpreadsheetControlObject().editor,a=r.range2,l=void 0;if(a.hasrange){var i,s;o&&a.bottom-a.top==1&&a.left==a.right?(i=e.GetAssuredCell(t.crToCoord(a.left,a.top)),s=e.GetAssuredCell(t.crToCoord(a.left,a.bottom)),n(i.datatype)&&n(s.datatype)&&(l=s.datavalue-i.datavalue)):o||a.left==a.right||(i=e.GetAssuredCell(t.crToCoord(a.left,a.top)),s=e.GetAssuredCell(t.crToCoord(a.right,a.top)),n(i.datatype)&&n(s.datatype)&&(l=s.datavalue-i.datavalue))}return r.Range2Remove(),l}var a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C,x,w,S,T,F,E,k,_,A,P,R,L,M,D,N,I,O,B,U,z,H,j,G,V,W,$,X,K,q,Y,J,Z,Q,et,tt,ot,nt,rt,at,lt,it,st,ct,ut,dt,b,y,pt,ft,ht,mt=e.attribs,gt=e.changes,vt=t.CellProperties,bt=t.Constants,yt=!1,Ct=function(){var e=t.ParseRange(s);g=e.cr1,v=e.cr2,v.col>mt.lastcol&&(mt.lastcol=v.col),v.row>mt.lastrow&&(mt.lastrow=v.row)};switch(f="",a=o.RestOfStringNoMove(),n&&e.changes.AddDo(a),l=o.NextToken()){case"set":if(s=o.NextToken(),c=o.NextToken(),i=o.RestOfString(),h="set "+s+" "+c,"sheet"==s)switch(e.renderneeded=!0,c){case"defaultcolwidth":n&&gt.AddUndo(h,mt[c]),mt[c]=i;break;case"defaultcolor":case"defaultbgcolor":n&&gt.AddUndo(h,e.GetStyleString("color",mt[c])),mt[c]=e.GetStyleNum("color",i);break;case"defaultlayout":n&&gt.AddUndo(h,e.GetStyleString("layout",mt[c])),mt[c]=e.GetStyleNum("layout",i);break;case"defaultfont":n&&gt.AddUndo(h,e.GetStyleString("font",mt[c])),"* * *"==i&&(i=""),mt[c]=e.GetStyleNum("font",i);break;case"defaulttextformat":case"defaultnontextformat":n&&gt.AddUndo(h,e.GetStyleString("cellformat",mt[c])),mt[c]=e.GetStyleNum("cellformat",i);break;case"defaulttextvalueformat":case"defaultnontextvalueformat":n&&gt.AddUndo(h,e.GetStyleString("valueformat",mt[c])),mt[c]=e.GetStyleNum("valueformat",i);for(C in e.cells)delete e.cells[C].displaystring;break;case"lastcol":case"lastrow":n&&gt.AddUndo(h,mt[c]-0),u=i-0,"number"==typeof u&&(mt[c]=u>0?u:1);break;case"recalc":n&&gt.AddUndo(h,mt[c]),"off"==i?mt.recalc=i:delete mt.recalc;break;case"usermaxcol":case"usermaxrow":n&&gt.AddUndo(h,mt[c]-0),u=i-0,"number"==typeof u&&(mt[c]=u>0?u:0);break;default:f=bt.s_escUnknownSheetCmd+a}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(s))for(e.renderneeded=!0,s=s.toUpperCase(),d=s.indexOf(":"),d>=0?(g=t.coordToCr(s.substring(0,d)+"1"),v=t.coordToCr(s.substring(d+1)+"1")):(g=t.coordToCr(s+"1"),v=g),b=g.col;b<=v.col;b++)"width"==c?(C=t.rcColname(b),n&&gt.AddUndo("set "+C+" width",e.colattribs.width[C]),i.length>0?e.colattribs.width[C]=i:delete e.colattribs.width[C]):"hide"==c&&(e.hiddencolrow="col",C=t.rcColname(b),n&&gt.AddUndo("set "+C+" hide",e.colattribs.hide[C]),i.length>0?e.colattribs.hide[C]=i:delete e.colattribs.hide[C]);else if(/^\d+(:\d+)?$/i.test(s))for(e.renderneeded=!0,s=s.toUpperCase(),d=s.indexOf(":"),d>=0?(g=t.coordToCr("A"+s.substring(0,d)),v=t.coordToCr("A"+s.substring(d+1))):(g=t.coordToCr("A"+s),v=g),y=g.row;y<=v.row;y++)"height"==c?(n&&gt.AddUndo("set "+y+" height",e.rowattribs.height[y]),i.length>0?e.rowattribs.height[y]=i:delete e.rowattribs.height[y]):"hide"==c&&(e.hiddencolrow="row",n&&gt.AddUndo("set "+y+" hide",e.rowattribs.hide[y]),i.length>0?e.rowattribs.hide[y]=i:delete e.rowattribs.hide[y]);else if(/^[a-z]{1,2}\d+(:[a-z]{1,2}\d+)?$/i.test(s))for(yt=!0,Ct(),g.row!=v.row||g.col!=v.col||e.celldisplayneeded||e.renderneeded?(e.renderneeded=!0,e.celldisplayneeded=""):e.celldisplayneeded=t.crToCoord(g.col,g.row),y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),x=e.GetAssuredCell(C),x.readonly&&"readonly"!=c||(n&&gt.AddUndo("set "+C+" all",e.CellToString(x)),"value"==c?(d=i.indexOf(" "),x.datavalue=i.substring(d+1)-0,delete x.errors,x.datatype="v",x.valuetype=i.substring(0,d),delete x.displaystring,delete x.parseinfo,mt.needsrecalc="yes"):"text"==c?(d=i.indexOf(" "),x.datavalue=t.decodeFromSave(i.substring(d+1)),delete x.errors,x.datatype="t",x.valuetype=i.substring(0,d),delete x.displaystring,delete x.parseinfo,mt.needsrecalc="yes"):"formula"==c?(x.datavalue=0,delete x.errors,x.datatype="f",t._app&&"e#N/A"!=x.valuetype&&(x.prevvaluetype=x.valuetype),x.valuetype="e#N/A",x.formula=i,delete x.displaystring,delete x.parseinfo,mt.needsrecalc="yes"):"constant"==c?(d=i.indexOf(" "),p=i.substring(d+1).indexOf(" "),x.datavalue=i.substring(d+1,d+1+p)-0,x.valuetype=i.substring(0,d),"e"==x.valuetype.charAt(0)?x.errors=x.valuetype.substring(1):delete x.errors,x.datatype="c",x.formula=i.substring(d+p+2),delete x.displaystring,delete x.parseinfo,mt.needsrecalc="yes"):"empty"==c?(x.datavalue="",delete x.errors,x.datatype=null,x.formula="",x.valuetype="b",delete x.displaystring,delete x.parseinfo,mt.needsrecalc="yes"):"all"==c?(i.length>0?(x=new t.Cell(C),e.CellFromStringParts(x,i.split(":"),1),e.cells[C]=x):delete e.cells[C],mt.needsrecalc="yes"):/^b[trbl]$/.test(c)?(x[c]=e.GetStyleNum("borderstyle",i),e.renderneeded=!0):"color"==c||"bgcolor"==c?x[c]=e.GetStyleNum("color",i):"layout"==c||"cellformat"==c?x[c]=e.GetStyleNum(c,i):"font"==c?("* * *"==i&&(i=""),x[c]=e.GetStyleNum("font",i)):"textvalueformat"==c||"nontextvalueformat"==c?(x[c]=e.GetStyleNum("valueformat",i),delete x.displaystring):"cssc"==c?(i=i.replace(/[^a-zA-Z0-9\-]/g,""),x.cssc=i):"csss"==c?(i=i.replace(/\n/g,""),x.csss=i):"mod"==c?(i=i.replace(/[^yY]/g,"").toLowerCase(),x.mod=i):"comment"==c?x.comment=t.decodeFromSave(i):"readonly"==c?x.readonly="yes"==i.toLowerCase():f=bt.s_escUnknownSetCoordCmd+a);break;case"merge":if(e.renderneeded=!0,s=o.NextToken(),i=o.RestOfString(),Ct(),x=e.GetAssuredCell(g.coord),x.readonly)break;n&&gt.AddUndo("unmerge "+g.coord),v.col>g.col?x.colspan=v.col-g.col+1:delete x.colspan,v.row>g.row?x.rowspan=v.row-g.row+1:delete x.rowspan,e.changedrendervalues=!0;break;case"unmerge":if(e.renderneeded=!0,s=o.NextToken(),i=o.RestOfString(),Ct(),x=e.GetAssuredCell(g.coord),x.readonly)break;n&&gt.AddUndo("merge "+g.coord+":"+t.crToCoord(g.col+(x.colspan||1)-1,g.row+(x.rowspan||1)-1)),delete x.colspan,delete x.rowspan,e.changedrendervalues=!0;break;case"erase":case"cut":for(e.renderneeded=!0,e.changedrendervalues=!0,s=o.NextToken(),i=o.RestOfString(),Ct(),n&&gt.AddUndo("changedrendervalues"),"cut"==l&&(n&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.CreateSheetSave(e,s)),y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),x=e.GetAssuredCell(C),x.readonly||(n&&gt.AddUndo("set "+C+" all",e.CellToString(x)),"all"==i?delete e.cells[C]:"formulas"==i?(x.datavalue="",x.datatype=null,x.formula="",x.valuetype="b",delete x.errors,delete x.displaystring,delete x.parseinfo,x.comment&&delete x.comment):"formats"==i&&(w=new t.Cell(C),w.datavalue=x.datavalue,w.datatype=x.datatype,w.formula=x.formula,w.valuetype=x.valuetype,x.comment&&(w.comment=x.comment),e.cells[C]=w));mt.needsrecalc="yes";break;case"fillright":case"filldown":e.renderneeded=!0,e.changedrendervalues=!0,n&&gt.AddUndo("changedrendervalues"),s=o.NextToken(),i=o.RestOfString(),Ct();var xt;for("fillright"==l?(S=!0,T=g.row,F=g.col+1,xt=r(!1)):(S=!1,T=g.row+1,F=g.col,xt=r(!0)),y=T;y<=v.row;y++)for(b=F;b<=v.col;b++)if(C=t.crToCoord(b,y),x=e.GetAssuredCell(C),!x.readonly){if(n&&gt.AddUndo("set "+C+" all",e.CellToString(x)),S?(E=t.crToCoord(g.col,y),_=b-F+1,k=0):(E=t.crToCoord(b,g.row),_=0,k=y-T+1),A=e.GetAssuredCell(E),"all"==i||"formats"==i)for(c in vt)1!=vt[c]&&(void 0===typeof A[c]||3==vt[c]?delete x[c]:x[c]=A[c]);("all"==i||"formulas"==i)&&(x.datavalue=void 0!==xt?A.datavalue+(S?_:k)*xt:A.datavalue,x.datatype=A.datatype,x.valuetype=A.valuetype,x.formula="f"==x.datatype?t.OffsetFormulaCoords(A.formula,_,k):A.formula,delete x.parseinfo,x.errors=A.errors),delete x.displaystring}mt.needsrecalc="yes";break;case"copy":s=o.NextToken(),i=o.RestOfString(),n&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.CreateSheetSave(e,s);break;case"loadclipboard":i=o.RestOfString(),n&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.decodeFromSave(i);break;case"clearclipboard":n&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard="";break;case"paste":if(e.renderneeded=!0,e.changedrendervalues=!0,n&&gt.AddUndo("changedrendervalues"),s=o.NextToken(),i=o.RestOfString(),Ct(),!t.Clipboard.clipboard)break;for(P=new t.Sheet,P.ParseSheetSave(t.Clipboard.clipboard),R=t.ParseRange(P.copiedfrom),_=g.col-R.cr1.col,k=g.row-R.cr1.row,L=Math.max(v.col-g.col+1,R.cr2.col-R.cr1.col+1),M=Math.max(v.row-g.row+1,R.cr2.row-R.cr1.row+1),g.col+L-1>mt.lastcol&&(mt.lastcol=g.col+L-1),g.row+M-1>mt.lastrow&&(mt.lastrow=g.row+M-1),y=g.row;y<g.row+M;y++)for(b=g.col;b<g.col+L;b++)if(C=t.crToCoord(b,y),x=e.GetAssuredCell(C),!x.readonly){if(n&&gt.AddUndo("set "+C+" all",e.CellToString(x)),E=t.crToCoord(R.cr1.col+(b-g.col)%(R.cr2.col-R.cr1.col+1),R.cr1.row+(y-g.row)%(R.cr2.row-R.cr1.row+1)),A=P.GetAssuredCell(E),"all"==i||"formats"==i)for(c in vt)1!=vt[c]&&(void 0===typeof A[c]||3==vt[c]?delete x[c]:(D=t.CellPropertiesTable[c],x[c]=D&&A[c]?e.GetStyleNum(D,P.GetStyleString(D,A[c])):A[c]));("all"==i||"formulas"==i)&&(x.datavalue=A.datavalue,x.datatype=A.datatype,x.valuetype=A.valuetype,x.formula="f"==x.datatype?t.OffsetFormulaCoords(A.formula,_,k):A.formula,delete x.parseinfo,x.errors=A.errors,A.comment?x.comment=A.comment:x.comment&&delete x.comment),delete x.displaystring}mt.needsrecalc="yes";break;case"sort":for(e.renderneeded=!0,e.changedrendervalues=!0,n&&gt.AddUndo("changedrendervalues"),s=o.NextToken(),Ct(),Y=[],J=[],Z=0,Q=0;3>=Q;Q++)Y[Q]=o.NextToken(),J[Q]=o.NextToken(),Y[Q]&&(Z=Q);for(tt={},et=[],ot=[],nt=[],y=g.row;y<=v.row;y++){for(b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),x=e.cells[C],x?(tt[C]=e.CellToString(x),n&&gt.AddUndo("set "+C+" all",tt[C])):n&&gt.AddUndo("set "+C+" all");for(et.push(et.length),ot.push([]),nt.push([]),slast=nt.length-1,Q=0;Z>=Q;Q++)C=Y[Q]+y,x=e.GetAssuredCell(C),m=x.datavalue,at=x.valuetype.charAt(0)||"b","t"==at&&(m=m.toLowerCase()),ot[slast].push(m),nt[slast].push(at)}for(rt=function(e,t){var o,n,r,a,l;for(o=0;Z>=o;o++)if("up"==J[o]?(n=e,r=t):(n=t,r=e),a=nt[n][o],tb=nt[r][o],"t"==a?"t"==tb?(n=ot[n][o],r=ot[r][o],l=n>r?1:r>n?-1:0):"n"==tb?l=1:"b"==tb?l="up"==J[o]?-1:1:"e"==tb&&(l=-1):"n"==a?"t"==tb?l=-1:"n"==tb?(n=ot[n][o]-0,r=ot[r][o]-0,l=n>r?1:r>n?-1:0):"b"==tb?l="up"==J[o]?-1:1:"e"==tb&&(l=-1):"e"==a?"e"==tb?(n=ot[n][o],r=ot[r][o],l=n>r?1:r>n?-1:0):l="b"==tb&&"up"==J[o]?-1:1:"b"==a&&(l="b"==tb?0:"up"==J[o]?1:-1),l)return l;return l=e>t?1:t>e?-1:0},et.sort(rt),y=g.row;y<=v.row;y++)for(lt=et[y-g.row],b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),it=t.crToCoord(b,lt+g.row),tt[it]?(x=new t.Cell(C),e.CellFromStringParts(x,tt[it].split(":"),1),"f"==x.datatype&&(x.formula=t.OffsetFormulaCoords(x.formula,0,y-g.row-lt)),e.cells[C]=x):delete e.cells[C];mt.needsrecalc="yes";break;case"insertcol":case"insertrow":for(e.renderneeded=!0,e.changedrendervalues=!0,e.widgetsClean=!1,s=o.NextToken(),i=o.RestOfString(),Ct(),"insertcol"==l?(_=1,N=g.col,k=0,I=1,O=g.col,U=g.col,B=1,z=mt.lastrow,n&&gt.AddUndo("deletecol "+g.coord)):(_=0,N=1,k=1,I=g.row,O=1,U=mt.lastcol,B=g.row,z=g.row,n&&gt.AddUndo("deleterow "+g.coord)),y=mt.lastrow;y>=I;y--)for(b=mt.lastcol;b>=N;b--)E=t.crToCoord(b,y),C=t.crToCoord(b+_,y+k),e.cells[E]?e.cells[C]=e.cells[E]:delete e.cells[C];for(y=B;z>=y;y++)for(b=O;U>=b;b++){C=t.crToCoord(b,y),x=new t.Cell(C),e.cells[C]=x,E=t.crToCoord(b-_,y-k),A=e.GetAssuredCell(E);for(c in vt)2==vt[c]&&(x[c]=A[c])}for(C in e.cells)x=e.cells[C],x&&"f"==x.datatype&&(x.formula=t.AdjustFormulaCoords(x.formula,g.col,_,g.row,k)),x&&delete x.parseinfo;for(st in e.names)e.names[st]&&(ct=e.names[st].definition,ut="","="==ct.charAt(0)&&(ut="=",ct=ct.substring(1)),e.names[st].definition=ut+t.AdjustFormulaCoords(ct,g.col,_,g.row,k));for(y=mt.lastrow;y>=I&&"insertrow"==l;y--){H=y+k;for(c in e.rowattribs)m=e.rowattribs[c][y],e.rowattribs[c][H]!=m&&(m?e.rowattribs[c][H]=m:delete e.rowattribs[c][H])}for(b=mt.lastcol;b>=N&&"insertcol"==l;b--){G=t.rcColname(b),j=t.rcColname(b+_);
for(c in e.colattribs)m=e.colattribs[c][G],e.colattribs[c][j]!=m&&(m?e.colattribs[c][j]=m:delete e.colattribs[c][j])}var wt=new t.RenderContext(e);wt.CalculateCellSkipData();var St={};for(var Tt in wt.cellskip){var Ft=t.coordToCr(Tt),Et=wt.cellskip[Tt];"insertcol"===l&&Ft.col===O&&(St[Et]||(e.GetAssuredCell(Et).colspan+=_),St[Et]=!0),"insertrow"===l&&Ft.row===B&&(St[Et]||(e.GetAssuredCell(Et).rowspan+=k),St[Et]=!0)}mt.lastcol+=_,mt.lastrow+=k,mt.needsrecalc="yes";break;case"deletecol":case"deleterow":for(e.renderneeded=!0,e.changedrendervalues=!0,e.widgetsClean=!1,s=o.NextToken(),i=o.RestOfString(),W=mt.lastcol,V=mt.lastrow,Ct(),"deletecol"==l?(_=g.col-v.col-1,k=0,F=v.col+1,T=1):(_=0,k=g.row-v.row-1,F=1,T=v.row+1),y=T;V-k>=y;y++)for(b=F;W-_>=b;b++)if(C=t.crToCoord(b+_,y+k),x=e.cells[C],x&&x.readonly)return f="Unable to remove "+("deletecol"==l?"column":"row")+", because cell "+x.coord+" is locked";for(y=T;V-k>=y;y++)for(b=F;W-_>=b;b++)C=t.crToCoord(b+_,y+k),n&&(T-k>y||F-_>b)&&(x=e.cells[C],x?gt.AddUndo("set "+C+" all",e.CellToString(x)):gt.AddUndo("erase "+C+" all")),E=t.crToCoord(b,y),x=e.cells[E],x?e.cells[C]=x:delete e.cells[C];for(C in e.cells)x=e.cells[C],x&&("f"==x.datatype?(K=x.formula,x.formula=t.AdjustFormulaCoords(K,g.col,_,g.row,k),x.formula!=K&&(delete x.parseinfo,n&&-1!=x.formula.indexOf("#REF!")&&(q=t.coordToCr(C),gt.AddUndo("set "+t.rcColname(q.col-_)+(q.row-k)+" formula "+K)))):delete x.parseinfo);for(st in e.names)e.names[st]&&(ct=e.names[st].definition,ut="","="==ct.charAt(0)&&(ut="=",ct=ct.substring(1)),e.names[st].definition=ut+t.AdjustFormulaCoords(ct,g.col,_,g.row,k));for(y=T;V-k>=y&&"deleterow"==l;y++){$=y+k;for(c in e.rowattribs)m=e.rowattribs[c][y],e.rowattribs[c][$]!=m&&(n&&gt.AddUndo("set "+$+" "+c,e.rowattribs[c][$]),m?e.rowattribs[c][$]=m:delete e.rowattribs[c][$])}for(b=F;W-_>=b&&"deletecol"==l;b++){G=t.rcColname(b),X=t.rcColname(b+_);for(c in e.colattribs)m=e.colattribs[c][G],e.colattribs[c][X]!=m&&(n&&gt.AddUndo("set "+X+" "+c,e.colattribs[c][X]),m?e.colattribs[c][X]=m:delete e.colattribs[c][X])}var wt=new t.RenderContext(e);wt.CalculateCellSkipData();var kt={};for(var Tt in wt.cellskip){var Ft=t.coordToCr(Tt),Et=wt.cellskip[Tt],_t=wt.coordToCR[Et];"deletecol"===l&&Ft.col===F+_&&_t.col<Ft.col&&(kt[Et]||(e.GetAssuredCell(Et).colspan+=_),kt[Et]=!0),"deleterow"===l&&Ft.row===T+k&&_t.row<Ft.row&&(kt[Et]||(e.GetAssuredCell(Et).rowspan+=k),kt[Et]=!0)}if(n)if("deletecol"==l)for(b=g.col;b<=v.col;b++)gt.AddUndo("insertcol "+t.rcColname(g.col));else for(y=g.row;y<=v.row;y++)gt.AddUndo("insertrow "+g.row);"deletecol"==l?g.col<=W&&(v.col<=W?mt.lastcol+=_:mt.lastcol=g.col-1):g.row<=V&&(v.row<=V?mt.lastrow+=k:mt.lastrow=g.row-1),mt.needsrecalc="yes";break;case"movepaste":case"moveinsert":var At,Pt,Rt,Lt,Mt,Dt,Nt;for(e.renderneeded=!0,e.changedrendervalues=!0,n&&gt.AddUndo("changedrendervalues"),s=o.NextToken(),Pt=o.NextToken(),i=o.RestOfString(),""==i&&(i="all"),Ct(),Rt=t.coordToCr(Pt),_=Rt.col-g.col,k=Rt.row-g.row,L=v.col-g.col+1,M=v.row-g.row+1,At={},y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)if(C=t.crToCoord(b,y),x=e.GetAssuredCell(C),!x.readonly&&(n&&gt.AddUndo("set "+C+" all",e.CellToString(x)),e.cells[C])){At[C]=new t.Cell(C);for(c in vt)void 0!==typeof x[c]&&(At[C][c]=x[c],"all"==i&&delete x[c],"formulas"==i&&(1==vt[c]||3==vt[c])&&delete x[c],"formats"==i&&2==vt[c]&&delete x[c]);"formulas"==i&&(x.datavalue="",x.datatype=null,x.formula="",x.valuetype="b"),"all"==i&&delete e.cells[C]}if("moveinsert"==l&&(Lt=!1,Mt=!1,0==k&&(Rt.col<g.col||Rt.col>v.col)?Rt.col<g.col?(Dt=g.col-Rt.col,Lt=-1):(Rt.col-=1,_=Rt.col-v.col,Dt=Rt.col-v.col,Lt=1):0==_&&(Rt.row<g.row||Rt.row>v.row)?Rt.row<g.row?(Dt=g.row-Rt.row,Mt=-1):(Rt.row-=1,k=Rt.row-v.row,Dt=Rt.row-v.row,Mt=1):l="movepaste"),Nt={},Mt)for(y=0;Dt>y;y++)for(b=g.col;b<=v.col;b++){if(0>Mt?(E=t.crToCoord(b,Rt.row+Dt-y-1),C=t.crToCoord(b,v.row-y)):(E=t.crToCoord(b,Rt.row-Dt+y+1),C=t.crToCoord(b,g.row+y)),A=e.GetAssuredCell(E),n&&gt.AddUndo("set "+E+" all",e.CellToString(A)),x=e.GetAssuredCell(C),"all"==i||"formats"==i)for(c in vt)1!=vt[c]&&(void 0===typeof A[c]||3==vt[c]?delete x[c]:x[c]=A[c]);("all"==i||"formulas"==i)&&(x.datavalue=A.datavalue,x.datatype=A.datatype,x.valuetype=A.valuetype,x.formula=A.formula,delete x.parseinfo,x.errors=A.errors),delete x.displaystring,Nt[E]=C}if(Lt)for(b=0;Dt>b;b++)for(y=g.row;y<=v.row;y++){if(0>Lt?(E=t.crToCoord(Rt.col+Dt-b-1,y),C=t.crToCoord(v.col-b,y)):(E=t.crToCoord(Rt.col-Dt+b+1,y),C=t.crToCoord(g.col+b,y)),A=e.GetAssuredCell(E),n&&gt.AddUndo("set "+E+" all",e.CellToString(A)),x=e.GetAssuredCell(C),"all"==i||"formats"==i)for(c in vt)1!=vt[c]&&(void 0===typeof A[c]||3==vt[c]?delete x[c]:x[c]=A[c]);("all"==i||"formulas"==i)&&(x.datavalue=A.datavalue,x.datatype=A.datatype,x.valuetype=A.valuetype,x.formula=A.formula,delete x.parseinfo,x.errors=A.errors),delete x.displaystring,Nt[E]=C}for(Rt.col+L-1>mt.lastcol&&(mt.lastcol=Rt.col+L-1),Rt.row+M-1>mt.lastrow&&(mt.lastrow=Rt.row+M-1),y=g.row;y<g.row+M;y++)for(b=g.col;b<g.col+L;b++)if(C=t.crToCoord(b+_,y+k),x=e.GetAssuredCell(C),!x.readonly)if(n&&gt.AddUndo("set "+C+" all",e.CellToString(x)),E=t.crToCoord(b,y),Nt[E]=C,"all"!=i||At[E]){if(A=At[E],A||(A=e.GetAssuredCell(E)),"all"==i||"formats"==i)for(c in vt)1!=vt[c]&&(void 0===typeof A[c]||3==vt[c]?delete x[c]:x[c]=A[c]);("all"==i||"formulas"==i)&&(x.datavalue=A.datavalue,x.datatype=A.datatype,x.valuetype=A.valuetype,x.formula=A.formula,delete x.parseinfo,x.errors=A.errors,A.comment?x.comment=A.comment:x.comment&&delete x.comment),delete x.displaystring}else delete e.cells[C];for(C in e.cells)x=e.cells[C],x&&("f"==x.datatype?(K=x.formula,x.formula=t.ReplaceFormulaCoords(K,Nt),x.formula!=K&&(delete x.parseinfo,n&&!Nt[C]&&gt.AddUndo("set "+C+" formula "+K))):delete x.parseinfo);for(st in e.names)e.names[st]&&(ct=e.names[st].definition,K=ct,ut="","="==ct.charAt(0)&&(ut="=",ct=ct.substring(1)),e.names[st].definition=ut+t.ReplaceFormulaCoords(ct,Nt),n&&e.names[st].definition!=K&&gt.AddUndo("name define "+st+" "+K));mt.needsrecalc="yes";break;case"name":if(s=o.NextToken(),st=o.NextToken(),i=o.RestOfString(),st=st.toUpperCase().replace(/[^A-Z0-9_\.]/g,""),""==st)break;if("define"==s){if(""==i)break;e.names[st]?(n&&gt.AddUndo("name define "+st+" "+e.names[st].definition),e.names[st].definition=i):(n&&gt.AddUndo("name delete "+st),e.names[st]={definition:i,desc:""})}else"desc"==s?e.names[st]&&(n&&gt.AddUndo("name desc "+st+" "+e.names[st].desc),e.names[st].desc=i):"delete"==s&&(n&&(e.names[st].desc&&gt.AddUndo("name desc "+st+" "+e.names[st].desc),gt.AddUndo("name define "+st+" "+e.names[st].definition)),delete e.names[st]);mt.needsrecalc="yes";break;case"recalc":mt.needsrecalc="yes",e.recalconce=!0;break;case"redisplay":e.renderneeded=!0;break;case"changedrendervalues":e.changedrendervalues=!0;break;case"pane":if(st=o.NextToken().toUpperCase(),ft=1,pt=t.GetSpreadsheetControlObject().editor,"ROW"===st.toUpperCase()){for(y=parseInt(o.NextToken(),10),"undefined"!=typeof pt.context.rowpanes[1]&&"number"==typeof pt.context.rowpanes[1].first&&(ft=pt.context.rowpanes[1].first),n&&gt.AddUndo("pane row "+ft);"yes"==pt.context.sheetobj.rowattribs.hide[y];)y++;(!y||y<=pt.context.rowpanes[0].first)&&pt.context.rowpanes.length>1?pt.context.rowpanes.length=1:pt.context.rowpanes.length-1&&!pt.timeout?(pt.context.SetRowPaneFirstLast(0,pt.context.rowpanes[0].first,y-1),pt.context.SetRowPaneFirstLast(1,y,y)):(pt.context.SetRowPaneFirstLast(0,pt.context.rowpanes[0].first,y-1),pt.context.SetRowPaneFirstLast(1,y,y)),pt.griddiv&&(ht=document.getElementById("trackingline-vertical"),ht&&(pt.griddiv.removeChild(ht),pt.FitToEditTable()))}else{for(b=parseInt(o.NextToken(),10),"undefined"!=typeof pt.context.colpanes[1]&&"number"==typeof pt.context.colpanes[1].first&&(ft=pt.context.colpanes[1].first),n&&gt.AddUndo("pane col "+ft);"yes"==pt.context.sheetobj.colattribs.hide[t.rcColname(b)];)b++;(!b||b<=pt.context.colpanes[0].first)&&pt.context.colpanes.length>1?pt.context.colpanes.length=1:pt.context.colpanes.length-1&&!pt.timeout?(pt.context.SetColPaneFirstLast(0,pt.context.colpanes[0].first,b-1),pt.context.SetColPaneFirstLast(1,b,b)):(pt.context.SetColPaneFirstLast(0,pt.context.colpanes[0].first,b-1),pt.context.SetColPaneFirstLast(1,b,b)),pt.griddiv&&(ht=document.getElementById("trackingline-horizon"),ht&&(pt.griddiv.removeChild(ht),pt.FitToEditTable()))}e.renderneeded=!0;break;case"startcmdextension":st=o.NextToken(),dt=e.sci.CmdExtensionCallbacks[st],dt&&dt.func(st,dt.data,e,o,n);break;case"settimetrigger":case"sendemail":case"submitform":break;default:f=bt.s_escUnknownCmd+a}return t._app&&(yt?1==e.renderneeded&&"value"!=c&&"text"!=c&&"formula"!=c&&"constant"!=c&&"empty"!=c?e.widgetsClean=!1:"all"==c&&(e.widgetsClean=!1):1==e.renderneeded&&(e.widgetsClean=!1)),f},t.SheetUndo=function(e){var t,o=e.changes.TOS(),n=o?o.undo.length-1:-1,r="";for(t=n;t>=0;t--)r&&(r+="\n"),r+=o.undo[t];e.changes.Undo(),e.ScheduleSheetCommands(r,!1)},t.SheetRedo=function(e){var t,o,n=e.changes.Redo();if(!n)return void e.ScheduleSheetCommands("",!1);t=e.changes.TOS();var r="";for(o=0;t&&o<t.command.length;o++)r&&(r+="\n"),r+=t.command[o];e.ScheduleSheetCommands(r,!1)},t.CreateAuditString=function(e){var t,o,n="",r=e.changes.stack,a=e.changes.tos;for(t=0;a>=t;t++)for(o=0;o<r[t].command.length;o++)n+=r[t].command[o]+"\n";return n},t.GetStyleNum=function(e,t,o){var n;return 0==o.length?0:(n=e[t+"hash"][o],n||(e[t+"s"].length<1&&e[t+"s"].push(""),n=e[t+"s"].push(o)-1,e[t+"hash"][o]=n,e.changedrendervalues=!0),n)},t.GetStyleString=function(e,t,o){return o?e[t+"s"][o]:null},t.OffsetFormulaCoords=function(e,o,n){var r,a,l,i,s,c,u="",d=t.Formula;if(!d)return"Need SocialCalc.Formula";var p=d.TokenType,f=p.op,h=p.string,m=p.coord,g=d.TokenOpExpansion;for(r=d.ParseFormulaIntoTokens(e),i=0;i<r.length;i++)l=r[i].type,a=r[i].text,l==m?(c="",s=t.coordToCr(a),"$"!=a.charAt(0)?s.col+=o:c+="$",c+=t.rcColname(s.col),-1==a.indexOf("$",1)?s.row+=n:c+="$",c+=s.row,(s.row<1||s.col<1)&&(c="#REF!"),u+=c):u+=l==h?a.indexOf('"')>=0?'"'+a.replace(/"/,'""')+'"':'"'+a+'"':l==f?g[a]||a:a;return u},t.AdjustFormulaCoords=function(e,o,n,r,a){var l,i,s,c,u="",d=!1,p=t.Formula;if(!p)return"Need SocialCalc.Formula";var f=p.TokenType,h=f.op,m=f.string,g=f.coord,v=p.TokenOpExpansion;for(parseinfo=t.Formula.ParseFormulaIntoTokens(e),s=0;s<parseinfo.length;s++)l=parseinfo[s].type,i=parseinfo[s].text,l==h&&("!"==i?d=!0:":"!=i&&(d=!1),i=v[i]||i),l==g?(cr=t.coordToCr(i),(0>n&&cr.col>=o&&cr.col<o-n||0>a&&cr.row>=r&&cr.row<r-a)&&(d||(cr.col=0,cr.row=0)),d||(cr.col>=o&&(cr.col+=n),cr.row>=r&&(cr.row+=a)),c="$"==i.charAt(0)?"$"+t.rcColname(cr.col):t.rcColname(cr.col),c+=-1!=i.indexOf("$",1)?"$"+cr.row:cr.row,(cr.row<1||cr.col<1)&&(c="#REF!"),i=c):l==m&&(i=i.indexOf('"')>=0?'"'+i.replace(/"/,'""')+'"':'"'+i+'"'),u+=i;return u},t.ReplaceFormulaCoords=function(e,o){var n,r,a,l,i,s="",c=!1,u=t.Formula;if(!u)return"Need SocialCalc.Formula";var d=u.TokenType,p=d.op,f=d.string,h=d.coord,m=u.TokenOpExpansion;for(parseinfo=t.Formula.ParseFormulaIntoTokens(e),a=0;a<parseinfo.length;a++)n=parseinfo[a].type,r=parseinfo[a].text,n==p&&("!"==r?c=!0:":"!=r&&(c=!1),r=m[r]||r),n==h?(cr=t.coordToCr(r),i=t.crToCoord(cr.col,cr.row),o[i]&&!c&&(cr=t.coordToCr(o[i]),l="$"==r.charAt(0)?"$"+t.rcColname(cr.col):t.rcColname(cr.col),l+=-1!=r.indexOf("$",1)?"$"+cr.row:cr.row,r=l)):n==f&&(r=r.indexOf('"')>=0?'"'+r.replace(/"/,'""')+'"':'"'+r+'"'),s+=r;return s},t.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(){return!1}},t.RecalcData=function(){this.inrecalc=!0,this.celllist=[],this.celllistitem=0,this.calclist=null,this.calclistlength=0,this.firstcalc=null,this.lastcalc=null,this.nextcalc=null,this.count=0,this.checkinfo={}},t.RecalcCheckInfo=function(){this.oldcoord=null,this.parsepos=0,this.inrange=!1,this.inrangestart=!1,this.cr1=null,this.cr2=null,this.c1=null,this.c2=null,this.r1=null,this.r2=null,this.c=null,this.r=null},t.RecalcSheet=function(e){var o=t.RecalcInfo;return o.currentState!=o.state.idle?void o.queue.push(e):(delete e.attribs.circularreferencecell,t.Formula.FreshnessInfoReset(),t.RecalcClearTimeout(),o.sheet=e,o.currentState=o.state.start_calc,o.starttime=new Date,e.statuscallback&&e.statuscallback(o,"calcstart",null,e.statuscallbackparams),void t.RecalcSetTimeout())},t.RecalcSetTimeout=function(){var o=t.RecalcInfo;o.recalctimer=e.setTimeout(t.RecalcTimerRoutine,o.timeslicedelay)},t.RecalcClearTimeout=function(){var o=t.RecalcInfo;o.recalctimer&&(e.clearTimeout(o.recalctimer),o.recalctimer=null)},t.RecalcLoadedSheet=function(e,o,n,r){var a,l=t.RecalcInfo,i=t.Formula;a=t.Formula.AddSheetToCache(e||i.SheetCache.waitingForLoading,o,r),n&&a&&"off"!=a.attribs.recalc&&(a.previousrecalcsheet=l.sheet,l.sheet=a,l.currentState=l.state.start_calc),i.SheetCache.waitingForLoading=null,t.RecalcSetTimeout()},t.RecalcTimerRoutine=function(){var e,o,n,r,a,l=new Date,i=0,s=t.Formula;if(!s)return"Need SocialCalc.Formula";var c=t.RecalcInfo,u=c.sheet;if(u){var d=u.recalcdata||(u.recalcdata={}),p=function(e,t){u.statuscallback&&u.statuscallback(d,e,t,u.statuscallbackparams)};if(t.RecalcClearTimeout(),c.currentState==c.state.start_calc){d=new t.RecalcData,u.recalcdata=d;for(n in u.cells)n&&d.celllist.push(n);d.calclist={},c.currentState=c.state.order}if(c.currentState==c.state.order){for(;d.celllistitem<d.celllist.length;)if(n=d.celllist[d.celllistitem++],r=t.RecalcCheckCell(u,n),new Date-l>=c.maxtimeslice)return p("calcorder",{coord:n,total:d.celllist.length,count:d.celllistitem}),void t.RecalcSetTimeout();return p("calccheckdone",d.calclistlength),d.nextcalc=d.firstcalc,c.currentState=c.state.calc,void t.RecalcSetTimeout()}if(c.currentState==c.state.start_wait){if(c.currentState=c.state.done_wait,c.LoadSheet&&(a=c.LoadSheet(s.SheetCache.waitingForLoading)))return;return void t.RecalcLoadedSheet(null,"",!1)}if(c.currentState==c.state.done_wait)return c.currentState=c.state.calc,void t.RecalcSetTimeout();for(c.currentState!=c.state.calc&&alert("Recalc state error: "+c.currentState+". Error in SocialCalc code."),n=u.recalcdata.nextcalc;n;){if(o=u.cells[n],o.parseinfo||(o.parseinfo=s.ParseFormulaIntoTokens(o.formula)),o.parseinfo.coord=n,e=s.evaluate_parsed_formula(o.parseinfo,u,!1),s.SheetCache.waitingForLoading){if(1!=c.firstRenderScheduled){var f=t.GetSpreadsheetControlObject().editor;f.ScheduleRender(!1),c.firstRenderScheduled=!0}return d.nextcalc=n,d.count+=i,p("calcloading",{sheetname:s.SheetCache.waitingForLoading}),c.currentState=c.state.start_wait,void t.RecalcSetTimeout()}if(s.RemoteFunctionInfo.waitingForServer)return d.nextcalc=n,d.count+=i,p("calcserverfunc",{funcname:s.RemoteFunctionInfo.waitingForServer,coord:n,total:d.calclistlength,count:d.count}),void(c.currentState=c.state.done_wait);if((o.datavalue!=e.value||o.valuetype!=e.type)&&(o.datavalue=e.value,o.valuetype=e.type,delete o.displaystring,u.recalcchangedavalue=!0),e.error&&(o.errors=e.error),i++,n=u.recalcdata.calclist[n],new Date-l>=c.maxtimeslice)return d.nextcalc=n,d.count+=i,p("calcstep",{coord:n,total:d.calclistlength,count:d.count}),void t.RecalcSetTimeout()}if(d.inrecalc=!1,u.reRenderCellList=u.recalcdata.celllist,delete u.recalcdata,delete u.attribs.needsrecalc,c.sheet=u.previousrecalcsheet||null,c.sheet)return c.currentState=c.state.calc,void t.RecalcSetTimeout();s.FreshnessInfo.recalc_completed=!0,c.currentState=c.state.idle,p("calcfinished",new Date-c.starttime),c.queue.length>0&&(u=c.queue.shift(),u.RecalcSheet())}},t.RecalcCheckCell=function(e,o){var n,r,a,l,i,s,c,u,d,p,f=t.Formula;if(!f)return"Need SocialCalc.Formula";var h=f.TokenType,m=h.op,g=h.name,v=h.coord,b=e.recalcdata,y=b.checkinfo,C=!1,x=null,w=o;e:for(;w;)if(d=e.cells[w],p=y[w],!d||"f"!=d.datatype||p&&"object"!=typeof p)w=x,y[w]&&(x=y[w].oldcoord);else{for(p||(p=new t.RecalcCheckInfo,y[w]=p),d.errors&&delete d.errors,d.parseinfo||(d.parseinfo=f.ParseFormulaIntoTokens(d.formula)),n=d.parseinfo,l=p.parsepos;l<n.length;l++){if(p.inrange){if(p.inrangestart&&(p.cr1.col>p.cr2.col?(p.c1=p.cr2.col,p.c2=p.cr1.col):(p.c1=p.cr1.col,p.c2=p.cr2.col),p.c=p.c1-1,p.cr1.row>p.cr2.row?(p.r1=p.cr2.row,p.r2=p.cr1.row):(p.r1=p.cr1.row,p.r2=p.cr2.row),p.r=p.r1,p.inrangestart=!1),p.c+=1,p.c>p.c2){if(p.r+=1,p.r>p.r2){p.inrange=!1;continue}p.c=p.c1}if(i=t.crToCoord(p.c,p.r),p.parsepos=l,p.oldcoord=x,x=w,w=i,y[w]&&"object"==typeof y[w])return d.errors=t.Constants.s_caccCircRef+o,y[o]=!0,b.firstcalc?b.calclist[b.lastcalc]=o:b.firstcalc=o,b.lastcalc=o,b.calclistlength++,e.attribs.circularreferencecell=w+"|"+x,d.errors;continue e}if(a=n[l].type,r=n[l].text,a==m&&("!"==r?C=!0:":"!=r&&(C=!1)),a==g)if(s=f.LookupName(e,r),"range"==s.type){if(c=s.value.indexOf("|"),-1!=c){p.cr1=t.coordToCr(s.value.substring(0,c)),u=s.value.indexOf("|",c+1),p.cr2=t.coordToCr(s.value.substring(c+1,u)),p.inrange=!0,p.inrangestart=!0,l-=1;continue}}else"coord"==s.type&&(a=v,r=s.value);if(a==v){if(l>=2&&n[l-1].type==m&&":"==n[l-1].text&&n[l-2].type==v&&!C){p.cr1=t.coordToCr(n[l-2].text),p.cr2=t.coordToCr(r),p.inrange=!0,p.inrangestart=!0,l-=1;continue}if(!C){if(-1!=r.indexOf("$")&&(r=r.replace(/\$/g,"")),p.parsepos=l+1,p.oldcoord=x,x=w,w=r,y[w]&&"object"==typeof y[w])return d.errors=t.Constants.s_caccCircRef+o,y[o]=!0,b.firstcalc?b.calclist[b.lastcalc]=o:b.firstcalc=o,b.lastcalc=o,b.calclistlength++,e.attribs.circularreferencecell=w+"|"+x,d.errors;continue e}}}C=!1,y[w]=!0,b.firstcalc?b.calclist[b.lastcalc]=w:b.firstcalc=w,b.lastcalc=w,b.calclistlength++,w=x,x=y[w]?y[w].oldcoord:null}return""},t.Parse=function(e){this.str=e,this.pos=0,this.delimiter=" ",this.lineEnd=e.indexOf("\n"),this.lineEnd<0&&(this.lineEnd=e.length)},t.Parse.prototype.NextToken=function(){if(this.pos<0)return"";var e=this.str.indexOf(this.delimiter,this.pos),t=this.pos;return e>this.lineEnd&&(e=this.lineEnd),e>=0?(this.pos=e+1,this.str.substring(t,e)):(this.pos=this.lineEnd,this.str.substring(t,this.lineEnd))},t.Parse.prototype.RestOfString=function(){var e=this.pos;return this.pos<0||this.pos>=this.lineEnd?"":(this.pos=this.lineEnd,this.str.substring(e,this.lineEnd))},t.Parse.prototype.RestOfStringNoMove=function(){return this.pos<0||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)},t.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1,this.lineEnd=this.str.indexOf("\n",this.pos),this.lineEnd<0&&(this.lineEnd=this.str.length)},t.Parse.prototype.EOF=function(){return this.pos<0||this.pos>=this.str.length?!0:!1},t.UndoStack=function(){this.stack=[],this.tos=-1,this.maxRedo=0,this.maxUndo=50},t.UndoStack.prototype.PushChange=function(e){for(;this.stack.length>0&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:e,undo:[]}),this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift(),this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]),this.tos=this.stack.length-1},t.UndoStack.prototype.AddDo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].command.push(o)}},t.UndoStack.prototype.AddUndo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].undo.push(o)}},t.UndoStack.prototype.TOS=function(){return this.tos>=0?this.stack[this.tos]:null},t.UndoStack.prototype.Undo=function(){return this.tos>=0&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)?(this.tos-=1,!0):!1},t.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1?(this.tos+=1,!0):!1},t.Clipboard={clipboard:""},t.RenderContext=function(e){var o=e.attribs,n=t.Constants;if(this.sheetobj=e,this.hideRowsCols=!1,this.showGrid=!1,this.showRCHeaders=!1,this.rownamewidth=n.defaultRowNameWidth,this.pixelsPerRow=n.defaultAssumedRowHeight,this.cellskip={},this.coordToCR={},this.colwidth=[],this.rowheight=[],this.totalwidth=0,this.totalheight=0,this.rowpanes=[],this.colpanes=[],this.colunhideleft=[],this.colunhideright=[],this.rowunhidetop=[],this.rowunhidebottom=[],this.maxcol=0,this.maxrow=0,this.highlights={},this.cursorsuffix="",this.highlightTypes={cursor:{style:n.defaultHighlightTypeCursorStyle,className:n.defaultHighlightTypeCursorClass},range:{style:n.defaultHighlightTypeRangeStyle,className:n.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+n.defaultImagePrefix+"cursorinsertup.gif);",className:n.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+n.defaultImagePrefix+"cursorinsertleft.gif);",className:n.defaultHighlightTypeCursorClass},range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+n.defaultImagePrefix+"range2.gif);",className:""}},this.cellIDprefix=n.defaultCellIDPrefix,this.defaultlinkstyle=null,this.defaultHTMLlinkstyle={type:"html"},this.defaultfontstyle=n.defaultCellFontStyle,this.defaultfontsize=n.defaultCellFontSize,this.defaultfontfamily=n.defaultCellFontFamily,this.defaultlayout=n.defaultCellLayout,this.defaultpanedividerwidth=n.defaultPaneDividerWidth,this.defaultpanedividerheight=n.defaultPaneDividerHeight,this.gridCSS=n.defaultGridCSS,this.commentClassName=n.defaultCommentClass,this.commentCSS=n.defaultCommentStyle,this.commentNoGridClassName=n.defaultCommentNoGridClass,this.commentNoGridCSS=n.defaultCommentNoGridStyle,this.readonlyClassName=n.defaultReadonlyClass,this.readonlyCSS=n.defaultReadonlyStyle,this.readonlyNoGridClassName=n.defaultReadonlyNoGridClass,this.readonlyNoGridCSS=n.defaultReadonlyNoGridStyle,this.readonlyComment=n.defaultReadonlyComment,this.classnames={colname:n.defaultColnameClass,rowname:n.defaultRownameClass,selectedcolname:n.defaultSelectedColnameClass,selectedrowname:n.defaultSelectedRownameClass,upperleft:n.defaultUpperLeftClass,skippedcell:n.defaultSkippedCellClass,panedivider:n.defaultPaneDividerClass,unhideleft:n.defaultUnhideLeftClass,unhideright:n.defaultUnhideRightClass,unhidetop:n.defaultUnhideTopClass,unhidebottom:n.defaultUnhideBottomClass,colresizebar:n.defaultColResizeBarClass,rowresizebar:n.defaultRowResizeBarClass},this.explicitStyles={colname:n.defaultColnameStyle,rowname:n.defaultRownameStyle,selectedcolname:n.defaultSelectedColnameStyle,selectedrowname:n.defaultSelectedRownameStyle,upperleft:n.defaultUpperLeftStyle,skippedcell:n.defaultSkippedCellStyle,panedivider:n.defaultPaneDividerStyle,unhideleft:n.defaultUnhideLeftStyle,unhideright:n.defaultUnhideRightStyle,unhidetop:n.defaultUnhideTopStyle,unhidebottom:n.defaultUnhideBottomStyle},this.cellskip=null,this.needcellskip=!0,this.fonts=[],this.layouts=[],this.needprecompute=!0,!o)throw n.s_rcMissingSheet;this.rowpanes[0]={first:1,last:o.lastrow},this.colpanes[0]={first:1,last:o.lastcol},this.usermaxcol=o.usermaxcol,this.usermaxrow=o.usermaxrow},t.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){t.PrecomputeSheetFontsAndLayouts(this)},t.RenderContext.prototype.CalculateCellSkipData=function(){t.CalculateCellSkipData(this)},t.RenderContext.prototype.CalculateColWidthData=function(){t.CalculateColWidthData(this)},t.RenderContext.prototype.CalculateRowHeightData=function(){t.CalculateRowHeightData(this)},t.RenderContext.prototype.SetRowPaneFirstLast=function(e,t,o){this.rowpanes[e]={first:t,last:o}},t.RenderContext.prototype.SetColPaneFirstLast=function(e,t,o){this.colpanes[e]={first:t,last:o}},t.RenderContext.prototype.CoordInPane=function(e,o,n){return t.CoordInPane(this,e,o,n)},t.RenderContext.prototype.CellInPane=function(e,o,n,r){return t.CellInPane(this,e,o,n,r)},t.RenderContext.prototype.InitializeTable=function(e){t.InitializeTable(this,e)},t.RenderContext.prototype.RenderSheet=function(e,o){return t.RenderSheet(this,e,o)},t.RenderContext.prototype.RenderColGroup=function(){return t.RenderColGroup(this)},t.RenderContext.prototype.RenderColHeaders=function(){return t.RenderColHeaders(this)},t.RenderContext.prototype.RenderSizingRow=function(){return t.RenderSizingRow(this)},t.RenderContext.prototype.RenderRow=function(e,o,n){return t.RenderRow(this,e,o,n)},t.RenderContext.prototype.RenderSpacingRow=function(){return t.RenderSpacingRow(this)},t.RenderContext.prototype.RenderCell=function(e,o,n,r,a,l){return t.RenderCell(this,e,o,n,r,a,l)},t.PrecomputeSheetFontsAndLayouts=function(e){var o,n,r,a,l,i,s,c,u=e.sheetobj,d=u.attribs;for(d.defaultfont&&(o=u.fonts[d.defaultfont],o=o.replace(/^\*/,t.Constants.defaultCellFontStyle),o=o.replace(/(.+)\*(.+)/,"$1"+t.Constants.defaultCellFontSize+"$2"),o=o.replace(/\*$/,t.Constants.defaultCellFontFamily),n=o.match(/^(\S+? \S+?) (\S+?) (\S.*)$/),e.defaultfontstyle=n[1],e.defaultfontsize=n[2],e.defaultfontfamily=n[3]),i=1;i<u.fonts.length;i++)s=u.fonts[i],s=s.replace(/^\*/,e.defaultfontstyle),s=s.replace(/(.+)\*(.+)/,"$1"+e.defaultfontsize+"$2"),s=s.replace(/\*$/,e.defaultfontfamily),n=s.match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/),e.fonts[i]={style:n[1],weight:n[2],size:n[3],family:n[4]};for(r=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/,a=t.Constants.defaultCellLayout.match(r),l=d.defaultlayout?u.layouts[d.defaultlayout].match(r):["","*","*","*","*","*"],i=1;i<u.layouts.length;i++){for(s=u.layouts[i],n=s.match(r),c=1;5>=c;c++)"*"==n[c]&&(n[c]="*"!=l[c]?l[c]:a[c]);e.layouts[i]="padding:"+n[1]+" "+n[2]+" "+n[3]+" "+n[4]+";vertical-align:"+n[5]+";"}e.needprecompute=!1},t.CalculateCellSkipData=function(e){{var o,n,r,a,l,i,s,c,u,d=e.sheetobj;d.rowattribs,d.colattribs}for(e.maxrow=0,e.maxcol=0,e.cellskip={},o=1;o<=d.attribs.lastrow;o++)for(n=1;n<=d.attribs.lastcol;n++)if(r=t.crToCoord(n,o),a=d.cells[r],void 0!==a&&!e.cellskip[r]&&(l=a.colspan||1,i=a.rowspan||1,l>1||i>1))for(s=o;o+i>s;s++)for(c=n;n+l>c;c++)u=t.crToCoord(c,s),u==r?e.coordToCR[r]={row:o,col:n}:e.cellskip[u]=r,s>e.maxrow&&(maxrow=s),c>e.maxcol&&(maxcol=c);e.needcellskip=!1},t.CalculateColWidthData=function(e){{var o,n,r,a,l=e.sheetobj;l.colattribs}for(a=e.showRCHeaders?e.rownamewidth-0:0,colpane=0;colpane<e.colpanes.length;colpane++)for(o=e.colpanes[colpane].first;o<=e.colpanes[colpane].last;o++)n=t.rcColname(o),"yes"==l.colattribs.hide[n]?e.colwidth[o]=0:(r=l.colattribs.width[n]||l.attribs.defaultcolwidth||t.Constants.defaultColWidth,("blank"==r||"auto"==r)&&(r=""),e.colwidth[o]=r+"",a+=r&&r-0>0?r-0:10);e.totalwidth=a},t.CalculateRowHeightData=function(e){var o,n,r,a=e.sheetobj;for(r=e.showRCHeaders?e.pixelsPerRow:0,rowpane=0;rowpane<e.rowpanes.length;rowpane++)for(o=e.rowpanes[rowpane].first;o<=e.rowpanes[rowpane].last;o++)"yes"===a.rowattribs.hide[o]?e.rowheight[o]=0:(n=a.rowattribs.height[o]||a.attribs.defaultrowheight||t.Constants.defaultAssumedRowHeight,("blank"===n||"auto"===n)&&(n=""),e.rowheight[o]=n+"",r+=n&&n-0>0?n-0:10);e.totalheight=r},t.InitializeTable=function(e,t){t.style.borderCollapse="collapse",t.cellSpacing="0",t.cellPadding="0",t.style.width=e.totalwidth+"px"},t.RenderSheet=function(e,t,o){var n,r,a,l,i,s;for(e.sheetobj.changedrendervalues&&(e.needcellskip=!0,e.needprecompute=!0,e.sheetobj.changedrendervalues=!1),e.needcellskip&&e.CalculateCellSkipData(),e.needprecompute&&e.PrecomputeSheetFontsAndLayouts(),e.CalculateColWidthData(),e.CalculateRowHeightData(),a=document.createElement("table"),e.InitializeTable(a),l=e.RenderColGroup(),a.appendChild(l),i=document.createElement("tbody"),i.appendChild(e.RenderSizingRow()),e.showRCHeaders&&(n=e.RenderColHeaders(),n&&i.appendChild(n)),r=0;r<e.rowpanes.length;r++){for(rownum=e.rowpanes[r].first;rownum<=e.rowpanes[r].last;rownum++)n=e.RenderRow(rownum,r,o),i.appendChild(n);r<e.rowpanes.length-1&&(n=e.RenderSpacingRow(),i.appendChild(n))}return a.appendChild(i),t&&(s=t.parentNode,s&&s.replaceChild(a,t)),a},t.RenderRow=function(e,o,n,r){var a,l,i,s,c=e.sheetobj,u=document.createElement("tr");if(e.showRCHeaders){if(l=document.createElement("td"),e.classnames&&(l.className=e.classnames.rowname),e.explicitStyles&&(l.style.cssText=e.explicitStyles.rowname),l.width=e.rownamewidth,l.height=e.rowheight[o],l.style.verticalAlign="top",l.innerHTML=o+"",o<e.rowpanes[e.rowpanes.length-1].last&&"yes"==c.rowattribs.hide[o+1]){var d=document.createElement("div");d.style.position="relative";var p=document.createElement("div");e.classnames&&(p.className=e.classnames.unhidetop),e.explicitStyles&&(p.style.cssText=e.explicitStyles.unhidetop);var f=e.rowheight[o]-0-t.Constants.defaultAssumedRowHeight;f=0===f?4:f,p.style.bottom="-"+f+"px",e.rowunhidetop[o]=p,d.appendChild(p),l.appendChild(d)}if(o>1&&"yes"==c.rowattribs.hide[o-1]){var p=document.createElement("div");e.classnames&&(p.className=e.classnames.unhidebottom),e.explicitStyles&&(p.style.cssText=e.explicitStyles.unhidebottom),e.rowunhidebottom[o]=p,l.appendChild(p)}var h=document.createElement("div");h.className=e.classnames.rowresizebar,l.appendChild(h),u.appendChild(l)}for(i=0;i<e.colpanes.length;i++){for(a=e.colpanes[i].first;a<=e.colpanes[i].last;a++)l=e.RenderCell(o,a,n,i,null,r),l&&u.appendChild(l);i<e.colpanes.length-1&&(l=document.createElement("td"),l.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(l.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(l.style.cssText=e.explicitStyles.panedivider),s=document.createElement("div"),s.style.width=e.defaultpanedividerwidth+"px",s.style.overflow="hidden",l.appendChild(s),u.appendChild(l))}return"yes"==c.rowattribs.hide[o]&&(u.style.cssText+=";display:none"),u},t.RenderSpacingRow=function(e){var t,o,n,r,a=(e.sheetobj,document.createElement("tr"));for(e.showRCHeaders&&(o=document.createElement("td"),o.width=e.rownamewidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),a.appendChild(o)),n=0;n<e.colpanes.length;n++){for(t=e.colpanes[n].first;t<=e.colpanes[n].last;t++)o=document.createElement("td"),r=e.colwidth[t],r&&(o.width=r),o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),o&&a.appendChild(o);n<e.colpanes.length-1&&(o=document.createElement("td"),o.width=e.defaultpanedividerwidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),a.appendChild(o))}return a},t.RenderColHeaders=function(e){var o,n,r=e.sheetobj,a=document.createElement("tr");if(!e.showRCHeaders)return null;for(n=document.createElement("td"),e.classnames&&(n.className=e.classnames.upperleft),e.explicitStyles&&(n.style.cssText=e.explicitStyles.upperleft),n.width=e.rownamewidth,a.appendChild(n),colpane=0;colpane<e.colpanes.length;colpane++){for(o=e.colpanes[colpane].first;o<=e.colpanes[colpane].last;o++){if(n=document.createElement("td"),e.classnames&&(n.className=e.classnames.colname),e.explicitStyles&&(n.style.cssText=e.explicitStyles.colname),"yes"==r.colattribs.hide[t.rcColname(o)]&&(n.style.cssText+=";display:none"),n.innerHTML=t.rcColname(o),o<e.colpanes[e.colpanes.length-1].last&&"yes"==r.colattribs.hide[t.rcColname(o+1)]){var l=document.createElement("div");e.classnames&&(l.className=e.classnames.unhideleft),e.explicitStyles&&(l.style.cssText=e.explicitStyles.unhideleft),e.colunhideleft[o]=l,n.appendChild(l)}o>1&&"yes"==r.colattribs.hide[t.rcColname(o-1)]&&(l=document.createElement("div"),e.classnames&&(l.className=e.classnames.unhideright),e.explicitStyles&&(l.style.cssText=e.explicitStyles.unhideright),e.colunhideright[o]=l,n.appendChild(l));var i=document.createElement("span");i.style.height=t.Constants.defaultAssumedRowHeight+"px",i.className=e.classnames.colresizebar,n.appendChild(i),a.appendChild(n)
}colpane<e.colpanes.length-1&&(n=document.createElement("td"),n.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(n.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(n.style.cssText=e.explicitStyles.panedivider),a.appendChild(n))}return a},t.RenderColGroup=function(e){var o,n,r,a,l=e.sheetobj,i=document.createElement("colgroup");for(e.showRCHeaders&&(r=document.createElement("col"),r.width=e.rownamewidth,i.appendChild(r)),o=0;o<e.colpanes.length;o++){for(n=e.colpanes[o].first;n<=e.colpanes[o].last;n++)r=document.createElement("col"),"yes"==l.colattribs.hide[t.rcColname(n)]?r.width="1":(a=e.colwidth[n],a&&(r.width=a),i.appendChild(r));o<e.colpanes.length-1&&(r=document.createElement("col"),r.width=e.defaultpanedividerwidth,i.appendChild(r))}return i},t.RenderSizingRow=function(e){var o,n,r,a,l=e.sheetobj,i=document.createElement("tr");for(e.showRCHeaders&&(r=document.createElement("td"),r.style.width=e.rownamewidth+"px",r.height="1",i.appendChild(r)),o=0;o<e.colpanes.length;o++){for(n=e.colpanes[o].first;n<=e.colpanes[o].last;n++)r=document.createElement("td"),"yes"==l.colattribs.hide[t.rcColname(n)]?r.width="1":(a=e.colwidth[n],a&&(r.width=a)),r.height="1",i.appendChild(r);o<e.colpanes.length-1&&(r=document.createElement("td"),r.width=e.defaultpanedividerwidth,r.height="1",i.appendChild(r))}return i},t.RenderCell=function(e,o,n,r,a,l,i){var s,c,u,d,p,f,h,m=e.sheetobj,g="";o-=0,n-=0;var v=t.crToCoord(n,o);if(e.cellskip[v])return e.CoordInPane(e.cellskip[v],r,a)?null:(u=l?t.CreatePseudoElement():document.createElement("td"),e.classnames.skippedcell&&(u.className=e.classnames.skippedcell),e.explicitStyles.skippedcell&&(u.style.cssText=e.explicitStyles.skippedcell),u.innerHTML="&nbsp;",u);if(u=l?t.CreatePseudoElement():document.createElement("td"),e.cellIDprefix&&(u.id=e.cellIDprefix+v),p=m.cells[v],p||(p=new t.Cell(v)),h=m.attribs,scc=t.Constants,p.colspan>1){for(d=1,s=1;s<p.colspan;s++)"yes"!=m.colattribs.hide[t.rcColname(n+s)]&&e.CellInPane(o,n+s,r,a)&&d++;u.colSpan=d}if(p.rowspan>1){for(d=1,s=1;s<p.rowspan;s++)"yes"!=m.rowattribs.hide[o+s+""]&&e.CellInPane(o+s,n,r,a)&&d++;u.rowSpan=d}return(void 0==p.displaystring||0==m.widgetsClean)&&(p.displaystring=t.FormatValueForDisplay(m,p.datavalue,v,i||e.defaultlinkstyle)),u.innerHTML=p.displaystring,s=p.layout||h.defaultlayout,g+=s&&"undefined"!=typeof e.layouts[s]?e.layouts[s]:scc.defaultCellLayout,s=p.font||h.defaultfont,s&&"undefined"!=typeof e.fonts[s]?(c=e.fonts[s],g+="font-style:"+c.style+";font-weight:"+c.weight+";font-size:"+c.size+";font-family:"+c.family+";"):(scc.defaultCellFontSize&&(g+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(g+="font-family:"+scc.defaultCellFontFamily+";")),s=p.color||h.defaultcolor,s&&"undefined"!=typeof m.colors[s]&&(g+="color:"+m.colors[s]+";"),s=p.bgcolor||h.defaultbgcolor,s&&"undefined"!=typeof m.colors[s]&&(g+="background-color:"+m.colors[s]+";"),s=p.cellformat,s&&"undefined"!=typeof m.cellformats[s]?g+="text-align:"+m.cellformats[s]+";":(c=p.valuetype.charAt(0),"t"==c?(s=h.defaulttextformat,s&&"undefined"!=typeof m.cellformats[s]&&(g+="text-align:"+m.cellformats[s]+";")):"n"==c?(s=h.defaultnontextformat,g+=s&&"undefined"!=typeof m.cellformats[s]?"text-align:"+m.cellformats[s]+";":"text-align:right;"):g+="text-align:left;"),(p.colspan>1||p.rowspan>1)&&(f=m.cells[t.crToCoord(n+(p.colspan||1)-1,o+(p.rowspan||1)-1)]),s=p.bt,s&&"undefined"!=typeof m.borderstyles[s]&&(g+="border-top:"+m.borderstyles[s]+";"),s="undefined"!=typeof f?f.br:p.br,s&&"undefined"!=typeof m.borderstyles[s]?g+="border-right:"+m.borderstyles[s]+";":e.showGrid&&(c=e.CellInPane(o,n+(p.colspan||1),r,a)?t.crToCoord(n+(p.colspan||1),o):"nomatch",e.cellskip[c]&&(c=e.cellskip[c]),m.cells[c]&&m.cells[c].bl||(g+="border-right:"+e.gridCSS)),s="undefined"!=typeof f?f.bb:p.bb,s&&"undefined"!=typeof m.borderstyles[s]?g+="border-bottom:"+m.borderstyles[s]+";":e.showGrid&&(c=e.CellInPane(o+(p.rowspan||1),n,r,a)?t.crToCoord(n,o+(p.rowspan||1)):"nomatch",e.cellskip[c]&&(c=e.cellskip[c]),m.cells[c]&&m.cells[c].bt||(g+="border-bottom:"+e.gridCSS)),s=p.bl,s&&"undefined"!=typeof m.borderstyles[s]&&(g+="border-left:"+m.borderstyles[s]+";"),p.comment&&(u.title=p.comment,e.showGrid?(e.commentClassName&&(u.className=(u.className?u.className+" ":"")+e.commentClassName),g+=e.commentCSS):(e.commentNoGridClassName&&(u.className=(u.className?u.className+" ":"")+e.commentNoGridClassName),g+=e.commentNoGridCSS)),p.readonly&&(p.comment||(u.title=e.readonlyComment),e.showGrid?(e.readonlyClassName&&(u.className=(u.className?u.className+" ":"")+e.readonlyClassName),g+=e.readonlyCSS):(e.readonlyNoGridClassName&&(u.className=(u.className?u.className+" ":"")+e.readonlyNoGridClassName),g+=e.readonlyNoGridCSS)),u.style.cssText=g,void 0!==p.cssc&&(l?u.className=(u.className?u.className+" ":"")+p.cssc:u.classList.add(p.cssc)),c=e.highlights[v],c&&("cursor"==c&&(c+=e.cursorsuffix),e.highlightTypes[c].className&&(u.className=(u.className?u.className+" ":"")+e.highlightTypes[c].className),t.setStyles(u,e.highlightTypes[c].style)),"yes"==m.colattribs.hide[t.rcColname(n)]&&(u.style.cssText+=";display:none"),"yes"==m.rowattribs.hide[o]&&(u.style.cssText+=";display:none"),u},t.CoordInPane=function(e,t,o,n){var r=e.coordToCR[t];if(!r||!r.row||!r.col)throw"Bad coordToCR for "+t;return e.CellInPane(r.row,r.col,o,n)},t.CellInPane=function(e,t,o,n,r){var a=e.rowpanes[n],l=e.colpanes[r];if(!a||!l)throw"CellInPane called with unknown panes "+n+"/"+r;return t<a.first||t>a.last?!1:o<l.first||o>l.last?!1:!0},t.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}},t.rcColname=function(e){e>702&&(e=702),1>e&&(e=1);var t=(e-1)%26+65,o=Math.floor((e-1)/26);return o?String.fromCharCode(o+64)+String.fromCharCode(t):String.fromCharCode(t)},t.letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.crToCoord=function(e,o){var n;1>e&&(e=1),e>702&&(e=702),1>o&&(o=1);var r=(e-1)%26,a=Math.floor((e-1)/26);return n=a?t.letters[a-1]+t.letters[r]+o:t.letters[r]+o},t.coordToCol={},t.coordToRow={},t.coordToCr=function(e){var o,n,r,a=t.coordToRow[e];if(a)return{row:a,col:t.coordToCol[e]};for(o=0,a=0,n=0;n<e.length;n++)r=e.charCodeAt(n),36==r||(57>=r?a=10*a+r-48:r>=97?o=26*o+r-96:r>=65&&(o=26*o+r-64));return t.coordToCol[e]=o,t.coordToRow[e]=a,{row:a,col:o}},t.ParseRange=function(e){var o,n,r,a;return e||(e="A1:A1"),e=e.toUpperCase(),o=e.indexOf(":"),o>=0?(n=e.substring(0,o),r=t.coordToCr(n),r.coord=n,n=e.substring(o+1),a=t.coordToCr(n),a.coord=n):(r=t.coordToCr(e),r.coord=e,a=t.coordToCr(e),a.coord=e),{cr1:r,cr2:a}},t.decodeFromSave=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t.replace(/\\b/g,"\\")},t.decodeFromAjax=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t=t.replace(/\\e/g,"]]"),t.replace(/\\b/g,"\\")},t.encodeForSave=function(e){return"string"!=typeof e?e:(-1!=e.indexOf("\\")&&(e=e.replace(/\\/g,"\\b")),-1!=e.indexOf(":")&&(e=e.replace(/:/g,"\\c")),-1!=e.indexOf("\n")&&(e=e.replace(/\n/g,"\\n")),e)},t.special_chars=function(e){return/[&<>"]/.test(e)&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;")),e},t.Lookup=function(e,t){for(i=0;i<t.length;i++)if(t[i]>e)return i>0?i-1:null;return t.length-1},t.setStyles=function(e,t){var o,n,r,a,l;if(t)for(o=t.split(";"),n=0;n<o.length;n++)r=o[n].indexOf(":"),-1!=r&&(a=o[n].substring(0,r),l=o[n].substring(r+1),a&&l&&(e.style[a]=l))},t.GetViewportInfo=function(){var t={};return e.innerWidth?(t.width=e.innerWidth,t.height=e.innerHeight,t.horizontalScroll=e.pageXOffset,t.verticalScroll=e.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight,t.horizontalScroll=document.documentElement.scrollLeft,t.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(t.width=document.body.clientWidth,t.height=document.body.clientHeight,t.horizontalScroll=document.body.scrollLeft,t.verticalScroll=document.body.scrollTop),t},t.GetElementPosition=function(e){for(var o=0,n=0;e&&"relative"!=t.GetComputedStyle(e,"position");)o+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:o,top:n}},t.GetElementPositionWithScroll=function(e){var t=e.getBoundingClientRect();return{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width?t.width:t.right-t.left,height:t.height?t.height:t.bottom-t.top}},t.GetElementFixedParent=function(e){for(;e&&"HTML"!=e.tagName;){if("fixed"==t.GetComputedStyle(e,"position"))return e;e=e.parentNode}return!1},t.GetComputedStyle=function(e,t){var o;return o="undefined"!=typeof e.currentStyle?e.currentStyle:document.defaultView.getComputedStyle(e,null),o[t]},t.LookupElement=function(e,t){var o;for(o=0;o<t.length;o++)if(t[o].element==e)return t[o];return null},t.AssignID=function(e,t,o){e.idPrefix&&(t.id=e.idPrefix+o)},t.GetCellContents=function(e,t){var o="",n=e.cells[t];if(n)switch(n.datatype){case"v":o=n.datavalue+"";break;case"t":o="'"+n.datavalue;break;case"f":o="="+n.formula;break;case"c":o=n.formula}return o},t.FormatValueForDisplay=function(e,o,n,r){var a,l,i,s,c=e.attribs,u=(t.Constants,e.cells[n]);u||(u=new t.Cell(n)),s=o,l=u.valuetype||"",i=l.substring(1),valueinputwidget=l.charAt(1);var d=l.substring(2),p=null,f=null;if(l=l.charAt(0),u.errors||"e"==l)return s=u.errors||i||"Error in cell";if("t"==l){if(a=e.valueformats[u.textvalueformat-0]||e.valueformats[c.defaulttextvalueformat-0]||"","formula"==a)return s="f"==u.datatype?t.special_chars("="+u.formula)||"&nbsp;":"c"==u.datatype?t.special_chars("'"+u.formula)||"&nbsp;":t.special_chars("'"+s)||"&nbsp;";var p=s;s=t.format_text_for_display(s,u.valuetype,a,e,r,u.nontextvalueformat);var f=s}else if("n"==l){if(a=u.nontextvalueformat,(null==a||""==a)&&(a=c.defaultnontextvalueformat),a=e.valueformats[a-0],(null==a||"none"==a)&&(a=""),"formula"==a)return s="f"==u.datatype?t.special_chars("="+u.formula)||"&nbsp;":"c"==u.datatype?t.special_chars("'"+u.formula)||"&nbsp;":t.special_chars("'"+s)||"&nbsp;";if("forcetext"==a)return s="f"==u.datatype?t.special_chars("="+u.formula)||"&nbsp;":"c"==u.datatype?t.special_chars(u.formula)||"&nbsp;":t.special_chars(s)||"&nbsp;";var p=s;s=t.format_number_for_display(s,u.valuetype,a);var f=s}else s="&nbsp;";if("i"==valueinputwidget&&null!=p&&null!=f){var h=e.ioParameterList[n],m=t.Formula.FunctionList[d];if(m){var g=m[5],v=0==p?"":"checked";g=g.replace(/<%=checked%>/g,v),g=g.replace(/<%=formated_value%>/g,f),g=g.replace(/<%=display_value%>/g,p);var b;if(h){for(var y=0;y<h.length;y++){b="coord"==h[y].type?e.GetAssuredCell(h[y].value).datavalue:h[y].value;var C=new RegExp("<%=parameter"+y+"_value%>","g");g=g.replace(C,b)}if(h.html)for(var x=0;x<h.html.length;x++){var C=new RegExp("<%=html"+x+"_value%>","g");g=g.replace(C,h.html[x])}h.css&&(g=g.replace(/^(<\w+)(\W)/,"$1 style='"+h.css+"'$2"))}return g.replace(/<%=cell_reference%>/g,n)}return"error:Widget HTML missing"}return s},t.format_text_for_display=function(e,o,n,r,a,l){var n,i,s,c,u,d;return i=o.substring(1),d=e,("none"==n||null==n)&&(n=""),/^(text-|custom|hidden)/.test(n)||(n=""),(""==n||"General"==n)&&("h"==i&&(n="text-html"),("w"==i||"r"==i)&&(n="text-wiki"),"l"==i&&(n="text-link"),i||(n="text-plain")),"text-html"==n||(t.Callbacks.expand_wiki&&/^text-wiki/.test(n)?d=t.Callbacks.expand_wiki(d,r,a,n):"text-wiki"==n?d=t.Callbacks.expand_markup&&t.Callbacks.expand_markup(d,r,a)||t.special_chars("wiki-text:"+d):"text-url"==n?(s=t.special_chars(d),c=encodeURI(d),d='<a href="'+c+'">'+s+"</a>"):"text-link"==n?d=t.expand_text_link(d,r,a,n):"text-image"==n?(c=encodeURI(d),d='<img src="'+c+'">'):"text-custom:"==n.substring(0,12)?(s=t.special_chars(d),s=s.replace(/  /g,"&nbsp; "),s=s.replace(/\n/g,"<br>"),c=encodeURI(d),u={},u.r=d,u.s=s,u.u=c,d=n.substring(12),d=d.replace(/@(r|s|u)/g,function(e,t){return u[t]})):"custom"==n.substring(0,6)?(d=t.special_chars(d),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"),d+=" (custom format)"):"hidden"==n?d="&nbsp;":null!=l&&""!=l&&"none"!=r.valueformats[l-0]&&""!=r.valueformats[l-0]?(n=r.valueformats[l],d=t.format_number_for_display(e,o,n)):(d=t.special_chars(d),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"))),d},t.format_number_for_display=function(e,o,n){var r,a,l=t.Constants;return r=e-0,a=o.substring(1),("Auto"==n||""==n)&&(n="%"==a?l.defaultFormatp:"$"==a?l.defaultFormatc:"dt"==a?l.defaultFormatdt:"d"==a?l.defaultFormatd:"t"==a?l.defaultFormatt:"l"==a?"logical":"General"),"logical"==n?r?l.defaultDisplayTRUE:l.defaultDisplayFALSE:"hidden"==n?"&nbsp;":t.FormatNumber.formatNumberWithFormat(e,n,"")},t.DetermineValueType=function(e){var o,n,r,a,l,i,s,c,u,d,p=e+"",f="t";return o=p.replace(/^\s+/,""),o=o.replace(/\s+$/,""),0==p.length?f="":p.match(/^\s+$/)||(o.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/)?(p=o-0,isNaN(p)?p=e+"":f="n"):o.match(/^[-+]?\d*(?:\.)?\d*\s*%$/)?(p=(o.slice(0,-1)-0)/100,f="n%"):o.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&o.match(/\d/)?(p=o.replace(/\$/,"")-0,f="n$"):o.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/)?(p=o.replace(/,/g,"")-0,f="n"):o.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/)?(p=(o.replace(/[%,]/g,"")-0)/100,f="n%"):o.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&o.match(/\d/)?(p=o.replace(/[\$,]/g,"")-0,f="n$"):(n=p.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))?(r=n[3]-0,r=1e3>r?r+2e3:r,p=0===navigator.language.indexOf("fr")?t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[1]-0)-2415019:t.FormatNumber.convert_date_gregorian_to_julian(r,n[1]-0,n[2]-0)-2415019,f="nd"):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))?(r=n[1]-0,r=1e3>r?r+2e3:r,p=t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[3]-0)-2415019,f="nd"):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2})\s*$/))?(r=n[1]-0,r=1e3>r?r+2e3:r,a=n[4]-0,l=n[5]-0,p=t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[3]-0)-2415019,f="nd",24>a&&60>l&&(p+=a/24+l/1440,f="ndt")):(n=p.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(r=n[1]-0,r=1e3>r?r+2e3:r,a=n[4]-0,l=n[5]-0,i=n[6]-0,p=t.FormatNumber.convert_date_gregorian_to_julian(r,n[2]-0,n[3]-0)-2415019,f="nd",24>a&&60>l&&60>i&&(p+=a/24+l/1440+i/86400,f="ndt")):(n=p.match(/^(\d{1,2}):(\d{1,2})\s*$/))?(a=n[1]-0,l=n[2]-0,24>a&&60>l&&(p=a/24+l/1440,f="nt")):(n=p.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(a=n[1]-0,l=n[2]-0,i=n[3]-0,24>a&&60>l&&60>i&&(p=a/24+l/1440+i/86400,f="nt")):(n=p.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/))?(u=n[1]-0,c=n[2]-0,s=n[3]-0,s&&s>0&&(p=u+(0>u?-c/s:c/s),f="n")):(d=t.InputConstants[p.toUpperCase()])?(c=d.indexOf(","),p=d.substring(0,c)-0,f=d.substring(c+1)):o.length>7&&"http://"==o.substring(0,7).toLowerCase()?(p=o,f="tl"):o.match(/<([A-Z][A-Z0-9]*)\b[^>]*>[\s\S]*?<\/\1>/i)&&(p=o,f="th")),{value:p,type:f}},t.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},t.default_expand_markup=function(e){var o=e;return o=t.special_chars(o),o=o.replace(/  /g,"&nbsp; "),o=o.replace(/\n/g,"<br>")},t.expand_text_link=function(e,o,n,r){var a,l,i,s=t.Constants,c="",u=t.ParseCellLinkText(e+"");return a=u.desc?t.special_chars(u.desc):u.pagename?s.defaultPageLinkFormatString:s.defaultLinkFormatString,e.length>7&&"http://"==e.substring(0,7).toLowerCase()&&">"!=e.charAt(e.length-1)&&(a=a.substring(7)),l=u.newwin||!n?' target="_blank"':"",u.pagename?t.Callbacks.MakePageLink&&(c=t.Callbacks.MakePageLink(u.pagename,u.workspacename,n,r)):c=encodeURI(u.url),i='<a href="'+c+'"'+l+">"+a+"</a>"},t.ParseCellLinkText=function(e){var t={url:"",desc:"",newwin:!1,pagename:"",workspace:""},o=!1,n=e.length-1,r=0,a=e.lastIndexOf("<"),l=e.lastIndexOf("["),i=e.lastIndexOf("{"),s=-1;return">"==e.charAt(n)&&-1!=a||"]"==e.charAt(n)&&-1!=l||!("}"!=e.charAt(n)||"]"!=e.charAt(n-1)||-1==i||-1==l||i>l)?(">"==e.charAt(n)?(s=a-1,a>0&&"<"==e.charAt(s)&&">"==e.charAt(n-1)&&(s--,n--,t.newwin=!0)):"]"==e.charAt(n)?(s=l-1,o=!0,l>0&&"["==e.charAt(s)&&"]"==e.charAt(n-1)&&(s--,n--,t.newwin=!0)):"}"==e.charAt(n)&&(s=i-1,o=!0,wsend=l,n--,l>0&&"["==e.charAt(l-1)&&"]"==e.charAt(n-1)&&(wsend=l-1,n--,t.newwin=!0)," "==e.charAt(wsend-1)&&wsend--,t.workspace=e.substring(i+1,wsend)||"")," "==e.charAt(s)&&s--,'"'==e.charAt(r)&&'"'==e.charAt(s)&&(r++,s--)):(n++,s=n),o?t.pagename=e.substring(l+1,n)||"":t.url=e.substring(a+1,n)||"",s>=r&&(t.desc=e.substring(r,s+1)),t},t.ConvertSaveToOtherFormat=function(e,o,n){var r,a,l,i,s,c,u,d,p,f,h="";if("scsave"==o)return e;if(""==e)return"";if(r=new t.Sheet,r.ParseSheetSave(e),n)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";if(l=r.copiedfrom?t.ParseRange(r.copiedfrom):{cr1:{row:1,col:1},cr2:{row:r.attribs.lastrow,col:r.attribs.lastcol}},"html"==o)return a=new t.RenderContext(r),r.copiedfrom&&(a.rowpanes[0]={first:l.cr1.row,last:l.cr2.row},a.colpanes[0]={first:l.cr1.col,last:l.cr2.col}),i=document.createElement("div"),s=a.RenderSheet(null,a.defaultHTMLlinkstyle),i.appendChild(s),delete a,delete r,h=i.innerHTML,delete s,delete i,h;for(c=l.cr1.row;c<=l.cr2.row;c++){for(u=l.cr1.col;u<=l.cr2.col;u++)d=t.crToCoord(u,c),p=r.GetAssuredCell(d),f=p.errors?p.errors:p.datavalue+"","csv"==o?(-1!=f.indexOf('"')&&(f=f.replace(/"/g,'""')),/[, \n"]/.test(f)&&(f='"'+f+'"'),u>l.cr1.col&&(f=","+f)):"tab"==o&&(-1!=f.indexOf("\n")&&(-1!=f.indexOf('"')&&(f=f.replace(/"/g,'""')),f='"'+f+'"'),u>l.cr1.col&&(f="	"+f)),h+=f;h+="\n"}return h},t.ConvertOtherFormatToSave=function(e,o){var n,r,a,l,i,s,c,u,d,p,f,h,m="",g=function(){p++,p>h&&(h=p),f=t.crToCoord(p,d),t.SetConvertedCell(n,f,i),i=""};if("scsave"==o)return e;if(n=new t.Sheet,r=e.split(/\r\n|\n/),h=0,"csv"==o){for(d=0,s=!1,a=0;a<r.length&&(a!=r.length-1||""!=r[a]);a++)for(s?i+="\n":(i="",d++,p=0),l=r[a],c=0;c<l.length;c++)u=l.charAt(c),'"'!=u?(","!=u||s?i+=u:g(),c!=l.length-1||s||g()):s?c<l.length-1&&'"'==l.charAt(c+1)?(c++,i+='"'):(s=!1,c==l.length-1&&g()):s=!0;h>0&&(n.attribs.lastrow=d,n.attribs.lastcol=h,m=n.CreateSheetSave("A1:"+t.crToCoord(h,d)))}if("tab"==o){for(d=0,s=!1,a=0;a<r.length&&(a!=r.length-1||""!=r[a]);a++)for(s?i+="\n":(i="",d++,p=0),l=r[a],c=0;c<l.length;c++){if(u=l.charAt(c),'"'==u){if(s){c<l.length-1?'"'==l.charAt(c+1)?(c++,i+='"'):"	"==l.charAt(c+1)&&(c++,s=!1,g()):(s=!1,g());continue}if(""==i){s=!0;continue}}"	"!=u||s?i+=u:g(),c!=l.length-1||s||g()}h>0&&(n.attribs.lastrow=d,n.attribs.lastcol=h,m=n.CreateSheetSave("A1:"+t.crToCoord(h,d)))}return m},t.SetConvertedCell=function(e,o,n){var r,a;r=e.GetAssuredCell(o),a=t.DetermineValueType(n),"n"==a.type&&a.value==n?(r.datatype="v",r.valuetype="n",r.datavalue=a.value):"t"==a.type.charAt(0)?(r.datatype="t",r.valuetype=a.type,r.datavalue=a.value):(r.datatype="c",r.valuetype=a.type,r.datavalue=a.value,r.formula=n)};var t;t||(t={}),t.TableEditor=function(o){var n=t.Constants;this.context=o,this.toplevel=null,this.fullgrid=null,this.noEdit=!1,this.width=null,this.tablewidth=null,this.height=null,this.tableheight=null,this.inputBox=null,this.inputEcho=null,this.verticaltablecontrol=null,this.horizontaltablecontrol=null,this.logo=null,this.cellhandles=null,this.timeout=null,this.busy=!1,this.ensureecell=!1,this.deferredCommands=[],this.deferredEmailCommands=[],this.gridposition=null,this.headposition=null,this.firstscrollingrow=null,this.firstscrollingrowtop=null,this.lastnonscrollingrow=null,this.lastvisiblerow=null,this.firstscrollingcol=null,this.firstscrollingcolleft=null,this.lastnonscrollingcol=null,this.lastvisiblecol=null,this.rowpositions=[],this.colpositions=[],this.rowheight=[],this.colwidth=[],this.ecell=null,this.state="start",this.workingvalues={},this.imageprefix=n.defaultImagePrefix,this.idPrefix=n.defaultTableEditorIDPrefix,this.pageUpDnAmount=n.defaultPageUpDnAmount,this.recalcFunction=function(e){return e.context.sheetobj.RecalcSheet?void e.context.sheetobj.RecalcSheet(t.EditorSheetStatusCallback,e):null},this.ctrlkeyFunction=function(o,n){var r,a,l,i,s,c;switch(n){case"[ctrl-c]":case"[ctrl-x]":return r=o.pasteTextarea,r.value="",a=t.GetEditorCellElement(o,o.ecell.row,o.ecell.col),a&&(l=t.GetElementPosition(a.element),r.style.left=l.left-1+"px",r.style.top=l.top-1+"px"),s=o.range.hasrange?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):o.ecell.coord,c=t.ConvertSaveToOtherFormat(t.CreateSheetSave(o.context.sheetobj,s),"tab"),i="[ctrl-c]"==n||o.noEdit||o.ECellReadonly()?"copy "+s+" formulas":"cut "+s+" formulas",o.EditorScheduleSheetCommands(i,!0,!1),r.style.display="block",r.value=c,r.focus(),r.select(),e.setTimeout(function(){var e=o.pasteTextarea;e.blur(),e.style.display="none",t.KeyboardFocus()},200),!0;case"[ctrl-v]":return o.noEdit||o.ECellReadonly()?!0:(r=o.pasteTextarea,r.value="",a=t.GetEditorCellElement(o,o.ecell.row,o.ecell.col),a&&(l=t.GetElementPosition(a.element),r.style.left=l.left-1+"px",r.style.top=l.top-1+"px"),r.style.display="block",r.value="",r.focus(),e.setTimeout(function(){var e=o.pasteTextarea,n=e.value;e.blur(),e.style.display="none";var r="";if(o.pastescclipboard)o.pastescclipboard=!1;else{var a=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,"tab");n=n.replace(/\r\n/g,"\n"),n==a||n.length-a.length==1&&n.substring(0,n.length-1)==a||(r="loadclipboard "+t.encodeForSave(t.ConvertOtherFormatToSave(n,"tab"))+"\n")}var l;if(o.range.hasrange){var i=new t.Sheet;i.ParseSheetSave(t.Clipboard.clipboard);var s=i.copiedfrom.match(/(.+):(.+)/);l=null!==s&&s[1]===s[2]?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):t.crToCoord(o.range.left,o.range.top)}else l=o.ecell.coord;r+="paste "+l+" formulas",o.EditorScheduleSheetCommands(r,!0,!1),t.KeyboardFocus()},200),!0);case"[ctrl-z]":return o.EditorScheduleSheetCommands("undo",!0,!1),!1;case"[ctrl-s]":if(!t.Constants.AllowCtrlS)break;return e.setTimeout(function(){var n=o.context.sheetobj,r=n.GetAssuredCell(o.ecell.coord),a=r.nontextvalueformat?n.valueformats[r.nontextvalueformat-0]||"":"",l=e.prompt("Advanced Feature:\n\nCustom Numeric Format or Command",a);if(null!=l){if(l.match(/^cmd:/))i=l.substring(4);else{if(l.match(/^edit:/))return i=l.substring(5),void(t.CtrlSEditor&&t.CtrlSEditor(i));s=o.range.hasrange?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):o.ecell.coord,i="set "+s+" nontextvalueformat "+l}o.EditorScheduleSheetCommands(i,!0,!1)}},200),!1}return!0},o.sheetobj.statuscallback=t.EditorSheetStatusCallback,o.sheetobj.statuscallbackparams=this,this.StatusCallback={},this.MoveECellCallback={},this.RangeChangeCallback={},this.SettingsCallbacks={},this.ecell={coord:"A1",row:1,col:1},o.highlights[this.ecell.coord]="cursor",this.range={hasrange:!1},this.range2={hasrange:!1}},t.TableEditor.prototype.CreateTableEditor=function(e,o){return t.CreateTableEditor(this,e,o)},t.TableEditor.prototype.ResizeTableEditor=function(e,o){return t.ResizeTableEditor(this,e,o)},t.TableEditor.prototype.SaveEditorSettings=function(){return t.SaveEditorSettings(this)},t.TableEditor.prototype.LoadEditorSettings=function(e,o){return t.LoadEditorSettings(this,e,o)},t.TableEditor.prototype.EditorRenderSheet=function(){t.EditorRenderSheet(this)},t.TableEditor.prototype.EditorScheduleSheetCommands=function(e,o,n){t.EditorScheduleSheetCommands(this,e,o,n)},t.TableEditor.prototype.ScheduleSheetCommands=function(e,t){this.context.sheetobj.ScheduleSheetCommands(e,t)},t.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()},t.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()},t.TableEditor.prototype.EditorStepSet=function(e,o){t.EditorStepSet(this,e,o)},t.TableEditor.prototype.GetStatuslineString=function(e,o,n){return t.EditorGetStatuslineString(this,e,o,n)},t.TableEditor.prototype.EditorMouseRegister=function(){return t.EditorMouseRegister(this)},t.TableEditor.prototype.EditorMouseUnregister=function(){return t.EditorMouseUnregister(this)},t.TableEditor.prototype.EditorMouseRange=function(e){return t.EditorMouseRange(this,e)},t.TableEditor.prototype.EditorProcessKey=function(e,o){return t.EditorProcessKey(this,e,o)},t.TableEditor.prototype.EditorAddToInput=function(e,o){return t.EditorAddToInput(this,e,o)},t.TableEditor.prototype.DisplayCellContents=function(){return t.EditorDisplayCellContents(this)},t.TableEditor.prototype.EditorSaveEdit=function(e){return t.EditorSaveEdit(this,e)},t.TableEditor.prototype.EditorApplySetCommandsToRange=function(e,o){return t.EditorApplySetCommandsToRange(this,e,o)},t.TableEditor.prototype.MoveECellWithKey=function(e){return t.MoveECellWithKey(this,e)},t.TableEditor.prototype.MoveECell=function(e){return t._app?"A1":t.MoveECell(this,e)},t.TableEditor.prototype.ReplaceCell=function(e,o,n){t.ReplaceCell(this,e,o,n)},t.TableEditor.prototype.UpdateCellCSS=function(e,o,n){t.UpdateCellCSS(this,e,o,n)},t.TableEditor.prototype.SetECellHeaders=function(e){t.SetECellHeaders(this,e)},t.TableEditor.prototype.EnsureECellVisible=function(){t.EnsureECellVisible(this)},t.TableEditor.prototype.ECellReadonly=function(e){return t.ECellReadonly(this,e)},t.TableEditor.prototype.RangeAnchor=function(e){t.RangeAnchor(this,e)},t.TableEditor.prototype.RangeExtend=function(e){t.RangeExtend(this,e)},t.TableEditor.prototype.RangeRemove=function(){t.RangeRemove(this)},t.TableEditor.prototype.Range2Remove=function(){t.Range2Remove(this)},t.TableEditor.prototype.FitToEditTable=function(){t.FitToEditTable(this)},t.TableEditor.prototype.CalculateEditorPositions=function(){t.CalculateEditorPositions(this)},t.TableEditor.prototype.ScheduleRender=function(){this.ScheduleRender(!0)},t.TableEditor.prototype.ScheduleRender=function(e){t._app&&1==e&&(this.context.sheetobj.widgetsClean=!1),t.ScheduleRender(this)},t.TableEditor.prototype.DoRenderStep=function(){t.DoRenderStep(this)},t.TableEditor.prototype.SchedulePositionCalculations=function(){t.SchedulePositionCalculations(this)},t.TableEditor.prototype.DoPositionCalculations=function(){t.DoPositionCalculations(this)},t.TableEditor.prototype.CalculateRowPositions=function(e,o,n){return t.CalculateRowPositions(this,e,o,n)},t.TableEditor.prototype.CalculateColPositions=function(e,o,n){return t.CalculateColPositions(this,e,o,n)},t.TableEditor.prototype.ScrollRelative=function(e,o){t.ScrollRelative(this,e,o)},t.TableEditor.prototype.ScrollRelativeBoth=function(e,o){t.ScrollRelativeBoth(this,e,o)},t.TableEditor.prototype.PageRelative=function(e,o){t.PageRelative(this,e,o)},t.TableEditor.prototype.LimitLastPanes=function(){t.LimitLastPanes(this)},t.TableEditor.prototype.ScrollTableUpOneRow=function(){return t.ScrollTableUpOneRow(this)},t.TableEditor.prototype.ScrollTableDownOneRow=function(){return t.ScrollTableDownOneRow(this)},t.TableEditor.prototype.ScrollTableLeftOneCol=function(){return t.ScrollTableLeftOneCol(this)},t.TableEditor.prototype.ScrollTableRightOneCol=function(){return t.ScrollTableRightOneCol(this)},t.TableEditor.prototype.StopPropagation=function(){return t.StopPropagation(this)},t.TableEditor.prototype.SetMouseMoveUp=function(){return t.SetMouseMoveUp(this)},t.TableEditor.prototype.RemoveMouseMoveUp=function(){return t.RemoveMouseMoveUp(this)},t.CreateTableEditor=function(o,n,r){var a=t.Constants,l=t.AssignID;o.toplevel=document.createElement("div"),o.toplevel.style.position="relative",l(o,o.toplevel,"toplevel"),o.width=n,o.height=r,o.griddiv=document.createElement("div"),o.tablewidth=Math.max(0,n-a.defaultTableControlThickness),o.tableheight=Math.max(0,r-a.defaultTableControlThickness),o.griddiv.style.width=o.tablewidth+"px",o.griddiv.style.height=o.tableheight+"px",o.griddiv.style.overflow="hidden",o.griddiv.style.cursor="default",a.cteGriddivClass&&(o.griddiv.className=a.cteGriddivClass),l(o,o.griddiv,"griddiv"),o.FitToEditTable(),o.EditorRenderSheet(),o.griddiv.appendChild(o.fullgrid),o.verticaltablecontrol=new t.TableControl(o,!0,o.tableheight),o.verticaltablecontrol.CreateTableControl(),l(o,o.verticaltablecontrol.main,"tablecontrolv"),o.horizontaltablecontrol=new t.TableControl(o,!1,o.tablewidth),o.horizontaltablecontrol.CreateTableControl(),l(o,o.horizontaltablecontrol.main,"tablecontrolh");var i,s,c,u,d;return i=document.createElement("table"),o.layouttable=i,i.cellSpacing=0,i.cellPadding=0,l(o,i,"layouttable"),s=document.createElement("tbody"),i.appendChild(s),c=document.createElement("tr"),s.appendChild(c),u=document.createElement("td"),u.appendChild(o.griddiv),c.appendChild(u),1!=t._app&&(u=document.createElement("td"),u.appendChild(o.verticaltablecontrol.main),c.appendChild(u)),c=document.createElement("tr"),s.appendChild(c),1!=t._app&&(u=document.createElement("td"),u.appendChild(o.horizontaltablecontrol.main),c.appendChild(u)),u=document.createElement("td"),u.style.background=t._app?"url("+o.imageprefix+"logo.gif) no-repeat right center":"url("+o.imageprefix+"logo.gif) no-repeat center center",u.innerHTML="<div style='cursor:pointer;font-size:1px;'><img src='"+o.imageprefix+"1x1.gif' border='0' width='18' height='18'></div>",c.appendChild(u),o.logo=u,l(o,o.logo,"logo"),t.TooltipRegister(u.firstChild.firstChild,"SocialCalc",null,o.toplevel),o.toplevel.appendChild(o.layouttable),o.noEdit||(o.inputEcho=new t.InputEcho(o),l(o,o.inputEcho.main,"inputecho")),o.cellhandles=new t.CellHandles(o),d=document.createElement("textarea"),t.setStyles(d,"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);"),d.value="",o.pasteTextarea=d,l(o,o.pasteTextarea,"pastetextarea"),navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//)&&(e.removeEventListener("beforepaste",t.SafariPasteFunction,!1),e.addEventListener("beforepaste",t.SafariPasteFunction,!1),e.removeEventListener("beforecopy",t.SafariPasteFunction,!1),e.addEventListener("beforecopy",t.SafariPasteFunction,!1),e.removeEventListener("beforecut",t.SafariPasteFunction,!1),e.addEventListener("beforecut",t.SafariPasteFunction,!1)),o.toplevel.appendChild(o.pasteTextarea),t.MouseWheelRegister(o.toplevel,{WheelMove:t.EditorProcessMouseWheel,editor:o}),t.KeyboardSetFocus(o),t.EditorSheetStatusCallback(null,"startup",null,o),o.toplevel},t.SafariPasteFunction=function(e){e.preventDefault()},t.ResizeTableEditor=function(e,o,n){var r=t.Constants;e.width=o,e.height=n,e.toplevel.style.width=o+"px",e.toplevel.style.height=n+"px",e.tablewidth=t._app?Math.max(0,o):Math.max(0,o-r.defaultTableControlThickness),e.tableheight=Math.max(0,n-r.defaultTableControlThickness),e.griddiv.style.width=e.tablewidth+"px",e.griddiv.style.height=e.tableheight+"px",e.verticaltablecontrol.main.style.height=e.tableheight+"px",e.horizontaltablecontrol.main.style.width=e.tablewidth+"px",e.FitToEditTable(),e.ScheduleRender()},t.SaveEditorSettings=function(e){var t,o,n=e.context,r=e.range,a="";for(a+="version:1.0\n",t=0;t<n.rowpanes.length;t++)a+="rowpane:"+t+":"+n.rowpanes[t].first+":"+n.rowpanes[t].last+"\n";for(t=0;t<n.colpanes.length;t++)a+="colpane:"+t+":"+n.colpanes[t].first+":"+n.colpanes[t].last+"\n";e.ecell&&(a+="ecell:"+e.ecell.coord+"\n"),r.hasrange&&(a+="range:"+r.anchorcoord+":"+r.top+":"+r.bottom+":"+r.left+":"+r.right+"\n");for(o in e.SettingsCallbacks)a+=e.SettingsCallbacks[o].save(e,o);return a},t.LoadEditorSettings=function(e,o,n){var r,a,l,i,s,c,u,d,p,f=o.split(/\r\n|\n/),h=[],m=e.context;for(m.rowpanes=[{first:1,last:1}],m.colpanes=[{first:1,last:1}],e.ecell=null,e.range={hasrange:!1},e.range2={hasrange:!1},p=e.range,m.highlights={},d=m.highlights,a=0;a<f.length;a++)switch(r=f[a],h=r.split(":"),u=h[0]){case"version":break;case"rowpane":m.rowpanes[h[1]-0]={first:h[2]-0,last:h[3]-0};break;case"colpane":m.colpanes[h[1]-0]={first:h[2]-0,last:h[3]-0};break;case"ecell":e.ecell=t.coordToCr(h[1]),e.ecell.coord=h[1],d[h[1]]="cursor";break;case"range":for(p.hasrange=!0,p.anchorcoord=h[1],l=t.coordToCr(p.anchorcoord),p.anchorrow=l.row,p.anchorcol=l.col,p.top=h[2]-0,p.bottom=h[3]-0,p.left=h[4]-0,p.right=h[5]-0,i=p.top;i<=p.bottom;i++)for(s=p.left;s<=p.right;s++)c=t.crToCoord(s,i),"cursor"!=d[c]&&(d[c]="range");
break;default:e.SettingsCallbacks[u]&&e.SettingsCallbacks[u].load(e,u,r,n)}},t.EditorRenderSheet=function(e){e.EditorMouseUnregister();var o=e.context.sheetobj;if(null!=o.reRenderCellList&&t._app&&o.widgetsClean===!0){for(var n in o.reRenderCellList){var r=o.reRenderCellList[n],a=o.cells[r].valuetype;("i"!=a.charAt(1)||a!=o.cells[r].prevvaluetype)&&(cr=t.coordToCr(r),cell=t.GetEditorCellElement(e,cr.row,cr.col),null!=cell&&e.ReplaceCell(cell,cr.row,cr.col))}o.reRenderCellList=[]}else e.fullgrid=e.context.RenderSheet(e.fullgrid),null!=o.reRenderCellList&&t._app&&(o.widgetsClean=!0,o.reRenderCellList=[]);e.ecell&&e.SetECellHeaders("selected"),t.AssignID(e,e.fullgrid,"fullgrid"),t._app||(e.fullgrid.className="te_download"),e.EditorMouseRegister()},t.EditorScheduleSheetCommands=function(e,o,n,r){if("start"==e.state||r){if(e.busy&&!r)return void e.deferredCommands.push({cmdstr:o,saveundo:n});var a=o.split(" ");switch(a[0]){case"recalc":case"redisplay":e.context.sheetobj.ScheduleSheetCommands(o,!1);break;case"undo":t._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetUndo();break;case"redo":t._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetRedo();break;case"setemailparameters":t.TriggerIoAction.Email(a[1],a[2]);break;default:e.context.sheetobj.ScheduleSheetCommands(o,n)}}},t.EditorSheetStatusCallback=function(e,o,n,r){var a,l,i,s=r.context.sheetobj,c=function(e){for(a in r.StatusCallback)r.StatusCallback[a].func&&r.StatusCallback[a].func(r,e,n,r.StatusCallback[a].params)};switch(o){case"startup":break;case"cmdstart":r.busy=!0,s.celldisplayneeded="";break;case"cmdextension":break;case"cmdend":if(c(o),s.changedrendervalues&&(r.context.PrecomputeSheetFontsAndLayouts(),r.context.CalculateCellSkipData(),s.changedrendervalues=!1),s.celldisplayneeded&&!s.renderneeded&&s.cells[s.celldisplayneeded]&&"e#N/A"!=s.cells[s.celldisplayneeded].valuetype&&(cr=t.coordToCr(s.celldisplayneeded),l=t.GetEditorCellElement(r,cr.row,cr.col),r.ReplaceCell(l,cr.row,cr.col)),r.deferredCommands.length)return i=r.deferredCommands.shift(),void r.EditorScheduleSheetCommands(i.cmdstr,i.saveundo,!0);if(s.attribs.needsrecalc&&("off"!=s.attribs.recalc||s.recalconce)&&r.recalcFunction?(r.FitToEditTable(),s.renderneeded=!1,s.recalconce&&delete s.recalconce,r.recalcFunction(r)):s.renderneeded?(r.FitToEditTable(),s.renderneeded=!1,r.ScheduleRender(!1)):r.SchedulePositionCalculations(),"col"==s.hiddencolrow&&null!==r.ecell){for(var u=r.ecell.col;"yes"==s.colattribs.hide[t.rcColname(u)];)u++;var d=t.crToCoord(u,r.ecell.row);r.MoveECell(d),s.hiddencolrow=""}if("row"==s.hiddencolrow&&null!==r.ecell){for(var p=r.ecell.row;"yes"==s.rowattribs.hide[p];)p++;var d=t.crToCoord(r.ecell.col,p);r.MoveECell(d),s.hiddencolrow=""}return;case"calcstart":r.busy=!0;break;case"calccheckdone":case"calcorder":case"calcstep":case"calcloading":case"calcserverfunc":break;case"calcfinished":return c(o),void r.ScheduleRender(!1);case"schedrender":r.busy=!0;break;case"renderdone":break;case"schedposcalc":r.busy=!0;break;case"doneposcalc":if(r.deferredEmailCommands.length){c(o);var f=r.deferredEmailCommands.shift();return void r.EditorScheduleSheetCommands(f.cmdstr,f.saveundo,!0)}return void(r.deferredCommands.length?(c(o),i=r.deferredCommands.shift(),r.EditorScheduleSheetCommands(i.cmdstr,i.saveundo,!0)):(r.busy=!1,c(o),"start"==r.state&&r.DisplayCellContents()));case"emailing":case"confirmemailsent":break;default:alert("Unknown status: "+o)}c(o)},t.EditorGetStatuslineString=function(e,o,n,r){var a,l,i,s,c,u,d,p,f=t.Constants;switch(l="",o){case"moveecell":case"rangechange":case"startup":break;case"cmdstart":r.command=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",l=f.s_statusline_executing;break;case"cmdextension":l="Command Extension: "+n;break;case"cmdend":r.command=!1;break;case"schedrender":l=f.s_statusline_displaying;break;case"renderdone":l=" ";break;case"schedposcalc":l=f.s_statusline_displaying;break;case"cmdendnorender":case"doneposcalc":document.body.style.cursor="default",e.griddiv.style.cursor="default","sent"==r.emailing&&(l=r.emailreponse,r.emailreponse="",r.emailing="done");break;case"calcorder":l=f.s_statusline_ordering+Math.floor(100*n.count/(n.total||1))+"%";break;case"calcstep":l=f.s_statusline_calculating+Math.floor(100*n.count/(n.total||1))+"%";break;case"calcloading":l=f.s_statusline_calculatingls+": "+n.sheetname;break;case"calcserverfunc":l=f.s_statusline_calculating+Math.floor(100*n.count/(n.total||1))+"%, "+f.s_statusline_doingserverfunc+n.funcname+f.s_statusline_incell+n.coord;break;case"calcstart":r.calculating=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",l=f.s_statusline_calcstart;break;case"calccheckdone":break;case"calcfinished":r.calculating=!1;break;case"emailing":r.emailing="sending",r.emailreponse="";break;case"confirmemailsent":r.emailing="sent","undefined"==typeof r.emailreponse&&(r.emailreponse=""),r.emailreponse+=n;break;default:l=o}if("sending"==r.emailing&&(l+=f.s_statusline_sendemail),"sent"==r.emailing&&(l+=r.emailreponse),!l&&r.calculating&&(l=f.s_statusline_calculating),!(r.calculating||r.command||l||!e.range.hasrange||e.range.left==e.range.right&&e.range.top==e.range.bottom)){for(p=0,c=e.range.top;c<=e.range.bottom;c++)for(u=e.range.left;u<=e.range.right;u++)d=e.context.sheetobj.cells[t.crToCoord(u,c)],d&&d.valuetype&&"n"==d.valuetype.charAt(0)&&(p+=d.datavalue-0);p=t.FormatNumber.formatNumberWithFormat(p,"[,]General",""),i=t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom),l=i+" ("+(e.range.right-e.range.left+1)+"x"+(e.range.bottom-e.range.top+1)+") "+f.s_statusline_sum+"="+p+" "+l}return a=(e.ecell||{}).coord+" &nbsp; "+l,r.calculating||"yes"!=e.context.sheetobj.attribs.needsrecalc||(a+=" &nbsp; "+f.s_statusline_recalcneeded),s=e.context.sheetobj.attribs.circularreferencecell,s&&(s=s.replace(/\|/," referenced by "),a+=" &nbsp; "+f.s_statusline_circref+s+"</span>"),a+=""},t.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:"",mouselastcoord:"",mouseresizecol:"",mouseresizeclientx:null,mouseresizedisplay:null},t.EditorMouseRegister=function(e){var o,n=t.EditorMouseInfo,r=e.fullgrid;for(o=0;o<n.registeredElements.length;o++)if(n.registeredElements[o].editor==e){if(n.registeredElements[o].element==r)return;break}if(o<n.registeredElements.length?n.registeredElements[o].element=r:n.registeredElements.push({element:r,editor:e}),r.addEventListener)r.addEventListener("mousedown",t.ProcessEditorMouseDown,!1),r.addEventListener("dblclick",t.ProcessEditorDblClick,!1);else{if(!r.attachEvent)throw"Browser not supported";r.attachEvent("onmousedown",t.ProcessEditorMouseDown),r.attachEvent("ondblclick",t.ProcessEditorDblClick)}n.ignore=!1},t.EditorMouseUnregister=function(e){{var o,n,r=t.EditorMouseInfo;e.fullgrid}for(o=0;o<r.registeredElements.length&&r.registeredElements[o].editor!=e;o++);o<r.registeredElements.length&&(n=r.registeredElements[o].element,n.removeEventListener?(n.removeEventListener("mousedown",t.ProcessEditorMouseDown,!1),n.removeEventListener("dblclick",t.ProcessEditorDblClick,!1)):n.detachEvent&&(n.detachEvent("onmousedown",t.ProcessEditorMouseDown),n.detachEvent("ondblclick",t.ProcessEditorDblClick)),r.registeredElements.splice(o,1))},t.StopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},t.SetMouseMoveUp=function(e,o,n,r){document.addEventListener?(document.addEventListener("mousemove",e,!0),document.addEventListener("mouseup",o,!0)):n.attachEvent&&(n.setCapture(),n.attachEvent("onmousemove",e),n.attachEvent("onmouseup",o),n.attachEvent("onlosecapture",o)),t.StopPropagation(r)},t.RemoveMouseMoveUp=function(e,o,n,r){t.StopPropagation(r),document.removeEventListener?(document.removeEventListener("mousemove",e,!0),document.removeEventListener("mouseup",o,!0)):n.detachEvent&&(n.detachEvent("onlosecapture",o),n.detachEvent("onmouseup",o),n.detachEvent("onmousemove",e),n.releaseCapture())},t.ProcessEditorMouseDown=function(o){var n,r,a,l,i=o||e.event,s=t.EditorMouseInfo,c=i.target||i.srcElement,u=c;3==u.nodeType&&(u=u.parentNode);var d;if(!s.ignore){for(d=null;!d&&c;c=c.parentNode)d=t.LookupElement(c,s.registeredElements);if(!d)return void(s.editor=null);n=d.editor,s.element=c,l=n.range;var p=t.GetElementPositionWithScroll(n.toplevel),f=i.clientX-p.left,h=i.clientY-p.top;if(r=t.GridMousePosition(n,f,h)){if(s.editor=n,r.rowheader)return void(r.rowselect?t.ProcessEditorRowselectMouseDown(o,c,r):t.ProcessEditorRowsizeMouseDown(o,c,r));if(r.colheader)return void(r.colselect?t.ProcessEditorColselectMouseDown(o,c,r):t.ProcessEditorColsizeMouseDown(o,c,r));if(r.coord){if(l.hasrange||o.shiftKey&&n.RangeAnchor(),a=n.MoveECell(r.coord),1==t._app)return void t.CmdGotFocus(!0);var m=n.context.sheetobj.cells[a];if(m&&"i"==m.valuetype.charAt(1)){var g=m.valuetype.substring(2),v=g+"_"+a;if(u&&v==u.id){var b=document.getElementById(v);t.CmdGotFocus(b)}}else l.hasrange&&(o.shiftKey?n.RangeExtend():n.RangeRemove()),s.mousedowncoord=a,s.mouselastcoord=a,n.EditorMouseRange(a),t.KeyboardSetFocus(n),"start"!=n.state&&n.inputBox&&n.inputBox.element.focus(),t.SetMouseMoveUp(t.ProcessEditorMouseMove,t.ProcessEditorMouseUp,c,i)}}}},t.EditorMouseRange=function(e,o){var n,r,a=e.range;switch(e.state){case"input":n=e.inputBox.GetText(),r=e.workingvalues,("(+-*/,:!&<>=^".indexOf(n.slice(-1))>=0&&"="==n.slice(0,1)||"="==n)&&(r.partialexpr=n),r.partialexpr?o&&e.inputBox.SetText(a.hasrange?r.partialexpr+t.crToCoord(a.left,a.top)+":"+t.crToCoord(a.right,a.bottom):r.partialexpr+o):(e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null));break;case"inputboxdirect":e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null)}},t.ProcessEditorMouseMove=function(o){var n,r,a,l=o||e.event,i=t.EditorMouseInfo;if(n=i.editor,n&&!i.ignore){r=i.element;var s=t.GetElementPositionWithScroll(n.toplevel),c=l.clientX-s.left,u=l.clientY-s.top;if(a=t.GridMousePosition(n,c,u)){if(a&&!a.coord)return void t.SetDragAutoRepeat(n,a);t.SetDragAutoRepeat(n,null),a.coord&&(a.coord!=i.mouselastcoord&&(o.shiftKey||n.range.hasrange||n.RangeAnchor(i.mousedowncoord),n.MoveECell(a.coord),n.RangeExtend()),i.mouselastcoord=a.coord,n.EditorMouseRange(a.coord),t.StopPropagation(l))}}},t.ProcessEditorMouseUp=function(o){var n,r,a,l=o||e.event,i=t.EditorMouseInfo;if(n=i.editor,n&&!i.ignore){r=i.element;var s=t.GetElementPositionWithScroll(n.toplevel),c=l.clientX-s.left,u=l.clientY-s.top;if(a=t.GridMousePosition(n,c,u),t.SetDragAutoRepeat(n,null),a)return a.coord||(a.coord=n.ecell.coord),n.range.hasrange?(n.MoveECell(a.coord),n.RangeExtend()):a.coord&&a.coord!=i.mousedowncoord&&(n.RangeAnchor(i.mousedowncoord),n.MoveECell(a.coord),n.RangeExtend()),n.EditorMouseRange(a.coord),i.editor=null,t.RemoveMouseMoveUp(t.ProcessEditorMouseMove,t.ProcessEditorMouseUp,r,l),!1}},t.ProcessEditorColsizeMouseDown=function(o,n,r){var a=o||e.event,l=t.EditorMouseInfo,i=l.editor,s=t.GetElementPositionWithScroll(i.toplevel),c=a.clientX-s.left;if(l.mouseresizecolnum=r.coltoresize,l.mouseresizecol=t.rcColname(r.coltoresize),l.mousedownclientx=c,l.mousecoltounhide=r.coltounhide,r.coltoresize){var u=document.createElement("div");l.mouseresizedisplay=u,u.style.width="auto",u.style.position="absolute",u.style.zIndex=100,u.style.top=i.headposition.top+"px",u.style.left=i.colpositions[r.coltoresize]+"px",u.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(i.context.colwidth[l.mouseresizecolnum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+i.context.colwidth[l.mouseresizecolnum]+"</div></td></tr></table>",t.setStyles(u.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;"),i.toplevel.appendChild(u)}t.SetMouseMoveUp(t.ProcessEditorColsizeMouseMove,t.ProcessEditorColsizeMouseUp,i.toplevel,a)},t.ProcessEditorColsizeMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,a=r.editor;if(a){if(r.mouseresizecolnum){var l=t.GetElementPositionWithScroll(a.toplevel),i=n.clientX-l.left,s=a.context.colwidth[r.mouseresizecolnum]-0+(i-r.mousedownclientx);s<t.Constants.defaultMinimumColWidth&&(s=t.Constants.defaultMinimumColWidth);var c=r.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(s-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+s+"</div></td></tr></table>",t.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;")}t.StopPropagation(n)}},t.ProcessEditorColsizeMouseUp=function(o){var n=o||e.event,r=t.EditorMouseInfo,a=r.editor;if(a){element=r.element;var l=t.GetElementPositionWithScroll(a.toplevel),i=n.clientX-l.left;if(t.RemoveMouseMoveUp(t.ProcessEditorColsizeMouseMove,t.ProcessEditorColsizeMouseUp,a.toplevel,n),r.mousecoltounhide)a.EditorScheduleSheetCommands("set "+t.rcColname(r.mousecoltounhide)+" hide",!0,!1);else if(r.mouseresizecolnum){var s=a.context.colwidth[r.mouseresizecolnum]-0+(i-r.mousedownclientx);s<t.Constants.defaultMinimumColWidth&&(s=t.Constants.defaultMinimumColWidth),a.EditorScheduleSheetCommands("set "+r.mouseresizecol+" width "+s,!0,!1),a.timeout&&e.clearTimeout(a.timeout),a.timeout=e.setTimeout(t.FinishColRowSize,1)}return!1}},t.FinishColRowSize=function(){var e=t.EditorMouseInfo,o=e.editor;o&&(o.toplevel.removeChild(e.mouseresizedisplay),e.mouseresizedisplay=null,e.editor=null)},t.ProcessEditorRowselectMouseDown=function(o,n,r){var a=o||e.event,l=t.EditorMouseInfo,i=l.editor,s=t.GetSpreadsheetControlObject().sheet;coord1=t.crToCoord(1,r.row),coord2=t.crToCoord(s.LastCol(),r.row),coord3=t.crToCoord(i.firstscrollingcol,r.row),i.RangeAnchor(coord1),i.RangeExtend(coord2),i.MoveECell(coord3),t.SetMouseMoveUp(t.ProcessEditorRowselectMouseMove,t.ProcessEditorRowselectMouseUp,i.toplevel,a)},t.ProcessEditorRowselectMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,a=r.editor,l=t.GetSpreadsheetControlObject().sheet;if(a){var i=t.GetElementPositionWithScroll(a.toplevel),s=n.clientX-i.left,c=n.clientY-i.top;result=t.GridMousePosition(a,s,c),coord2=t.crToCoord(l.LastCol(),result.row),coord3=t.crToCoord(a.firstscrollingcol,result.row),a.RangeExtend(coord2),a.MoveECell(coord3)}},t.ProcessEditorRowselectMouseUp=function(o){var n=(o||e.event,t.EditorMouseInfo),r=n.editor;r&&t.RemoveMouseMoveUp(t.ProcessEditorRowselectMouseMove,t.ProcessEditorRowselectMouseUp,r.toplevel,o)},t.ProcessEditorColselectMouseDown=function(o,n,r){var a=o||e.event,l=t.EditorMouseInfo,i=l.editor,s=t.GetSpreadsheetControlObject().sheet;coord1=t.crToCoord(r.col,1),coord2=t.crToCoord(r.col,s.LastRow()),coord3=t.crToCoord(r.col,i.firstscrollingrow),i.RangeAnchor(coord1),i.RangeExtend(coord2),i.MoveECell(coord3),t.SetMouseMoveUp(t.ProcessEditorColselectMouseMove,t.ProcessEditorColselectMouseUp,i.toplevel,a)},t.ProcessEditorColselectMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,a=r.editor,l=t.GetSpreadsheetControlObject().sheet;if(a){var i=t.GetElementPositionWithScroll(a.toplevel),s=n.clientX-i.left,c=n.clientY-i.top;result=t.GridMousePosition(a,s,c),coord2=t.crToCoord(result.col,l.LastRow()),coord3=t.crToCoord(result.col,a.firstscrollingrow),a.RangeExtend(coord2),a.MoveECell(coord3)}},t.ProcessEditorColselectMouseUp=function(o){var n=(o||e.event,t.EditorMouseInfo),r=n.editor;r&&t.RemoveMouseMoveUp(t.ProcessEditorColselectMouseMove,t.ProcessEditorColselectMouseUp,r.toplevel,o)},t.ProcessEditorRowsizeMouseDown=function(o,n,r){var a=o||e.event,l=t.EditorMouseInfo,i=l.editor,s=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,c=a.clientY-s;if(l.mouseresizerownum=r.rowtoresize,l.mouseresizerow=r.rowtoresize,l.mousedownclienty=c,l.mouserowtounhide=r.rowtounhide,r.rowtoresize){var u=document.createElement("div");l.mouseresizedisplay=u,u.style.width=i.context.totalwidth+"px",u.style.height=i.rowpositions[r.rowtoresize]+"px",u.style.position="absolute",u.style.zIndex=100,u.style.top=i.rowpositions[r.rowtoresize]+"px",u.style.left=i.headposition.left+"px",u.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100pxborder:1px dashed black;background-color:white;height:'+(i.context.rowheight[l.mouseresizerownum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+i.context.rowheight[l.mouseresizerownum]+"</div></td></tr></table>",t.setStyles(u.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;"),i.toplevel.appendChild(u)}t.SetMouseMoveUp(t.ProcessEditorRowsizeMouseMove,t.ProcessEditorRowsizeMouseUp,i.toplevel,a)},t.ProcessEditorRowsizeMouseMove=function(o){var n=o||e.event,r=t.EditorMouseInfo,a=r.editor;if(a){if(r.mouseresizerownum){var l=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,i=n.clientY-l,s=a.context.rowheight[r.mouseresizerownum]-0+(i-r.mousedownclienty);s<t.Constants.defaultAssumedRowHeight&&(s=t.Constants.defaultAssumedRowHeight);var c=r.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100px;border:1px dashed black;background-color:white;height:'+(s-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+s+"</div></td></tr></table>",t.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;")}t.StopPropagation(n)}},t.ProcessEditorRowsizeMouseUp=function(o){var n=o||e.event,r=t.EditorMouseInfo,a=r.editor;if(a){element=r.element;var l=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,i=n.clientY-l;if(t.RemoveMouseMoveUp(t.ProcessEditorRowsizeMouseMove,t.ProcessEditorRowsizeMouseUp,a.toplevel,n),r.mouserowtounhide)a.EditorScheduleSheetCommands("set "+r.mouserowtounhide+" hide",!0,!1);else if(r.mouseresizerownum){var s=a.context.rowheight[r.mouseresizerownum]-0+(i-r.mousedownclienty);s<t.Constants.defaultAssumedRowHeight&&(s=t.Constants.defaultAssumedRowHeight),a.EditorScheduleSheetCommands("set "+r.mouseresizerownum+" height "+s,!0,!1),a.timeout&&e.clearTimeout(a.timeout),a.timeout=e.setTimeout(t.FinishColRowSize,1)}return!1}},t.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1e3,editor:null,repeatcallback:null},t.SetDragAutoRepeat=function(o,n,r){var a,l,i=t.AutoRepeatInfo;if(i.repeatcallback=r,!n)return i.timer&&(e.clearTimeout(i.timer),i.timer=null),void(i.mouseinfo=null);if(i.editor=o,i.mouseinfo&&(n.rowheader||n.rowfooter?n.row!=i.mouseinfo.row&&(a=t.crToCoord(o.ecell.col,n.row),i.repeatcallback?(l=n.row<i.mouseinfo.row?"left":n.row>i.mouseinfo.row?"right":"",i.repeatcallback(a,l)):(o.MoveECell(a),o.MoveECell(a),o.RangeExtend(),o.EditorMouseRange(a))):(n.colheader||n.colfooter)&&n.col!=i.mouseinfo.col&&(a=t.crToCoord(n.col,o.ecell.row),i.repeatcallback?(l=n.row<i.mouseinfo.row?"left":n.row>i.mouseinfo.row?"right":"",i.repeatcallback(a,l)):(o.MoveECell(a),o.RangeExtend(),o.EditorMouseRange(a)))),i.mouseinfo=n,n.distance<5)i.repeatinterval=333;else if(n.distance<10)i.repeatinterval=250;else if(n.distance<25)i.repeatinterval=100;else{if(!(n.distance<35))return void(i.timer&&(e.clearTimeout(i.timer),i.timer=null));i.repeatinterval=75}i.timer||(i.timer=e.setTimeout(t.DragAutoRepeat,i.repeatinterval))},t.DragAutoRepeat=function(){var o,n,r,a=t.AutoRepeatInfo,l=a.mouseinfo;l.rowheader?o="left":l.rowfooter?o="right":l.colheader?o="up":l.colfooter&&(o="down"),a.repeatcallback?(r=t.coordToCr(a.editor.ecell.coord),"left"==o&&r.col>1?r.col--:"right"==o?r.col++:"up"==o&&r.row>1?r.row--:"down"==o&&r.row++,n=t.crToCoord(r.col,r.row),a.repeatcallback(n,o)):(n=a.editor.MoveECellWithKey("[a"+o+"]shifted"),n&&a.editor.EditorMouseRange(n)),a.timer=e.setTimeout(t.DragAutoRepeat,a.repeatinterval)},t.ProcessEditorDblClick=function(o){var n,r,a,l,i=o||e.event,s=t.EditorMouseInfo,c=i.target||i.srcElement;if(!s.ignore){for(l=null;!l&&c;c=c.parentNode)l=t.LookupElement(c,s.registeredElements);if(!l)return void(s.editor=null);n=l.editor;var u=t.GetElementPositionWithScroll(n.toplevel),d=i.clientX-u.left,p=i.clientY-u.top;if(r=t.GridMousePosition(n,d,p),r&&r.coord){switch(s.editor=n,s.element=c,a=n.range,sheetobj=n.context.sheetobj,n.state){case"start":t.EditorOpenCellEdit(n);break;case"input":}t.StopPropagation(i)}}},t.EditorOpenCellEdit=function(e){var t;return e.ecell&&e.inputBox?e.inputBox.element.disabled?!0:(e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(""),e.inputBox.DisplayCellContents(),e.inputBox.Select("end"),t=e.workingvalues,t.partialexpr="",t.ecoord=e.ecell.coord,t.erow=e.ecell.row,void(t.ecol=e.ecell.col)):!0},t.EditorProcessKey=function(e,o,n){var r,a,l,i,s=(e.context.sheetobj,e.workingvalues),c=e.range;switch("string"!=typeof o&&(o=""),e.state){case"start":if(n.shiftKey&&"[a"==o.substr(0,2)&&(o+="shifted"),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=n.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)||"[pg"==o.substr(0,3)||"[home]"==o)return r=e.MoveECellWithKey(o),!r;if("[del]"==o||"[backspace]"==o){e.noEdit||e.ECellReadonly()||e.EditorApplySetCommandsToRange("empty","");break}if("[esc]"==o){if(c.hasrange){e.RangeRemove(),e.MoveECell(c.anchorcoord);for(i in e.StatusCallback)e.StatusCallback[i].func(e,"specialkey",o,e.StatusCallback[i].params)}return!1}if("[f2]"==o)return e.noEdit||e.ECellReadonly()?!0:(t.EditorOpenCellEdit(e),e.state="inputboxdirect",!1);if(o.length>1&&"["==o.substr(0,1)||0==o.length)return e.ctrlkeyFunction&&o.length>0?e.ctrlkeyFunction(e,o):!0;if(!e.ecell)return!0;if(!e.inputBox)return!0;if(e.ECellReadonly())return!0;e.inputBox.element.disabled=!1,e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(o),e.inputBox.Select("end"),s.partialexpr="",s.ecoord=e.ecell.coord,s.erow=e.ecell.row,s.ecol=e.ecell.col,e.RangeRemove();break;case"input":if(l=e.inputBox.GetText(),e.inputBox.skipOne)return!1;if("[esc]"==o||"[enter]"==o||"[tab]"==o||o&&"[a"==o.substr(0,2)){if(("(+-*/,:!&<>=^".indexOf(l.slice(-1))>=0&&"="==l.slice(0,1)||"="==l)&&(s.partialexpr=l),s.partialexpr&&(n.shiftKey&&"[a"==o.substr(0,2)&&(o+="shifted"),a=e.MoveECellWithKey(o)))return e.inputBox.SetText(c.hasrange?s.partialexpr+t.crToCoord(c.left,c.top)+":"+t.crToCoord(c.right,c.bottom):s.partialexpr+a),!1;e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"!=o?(e.EditorSaveEdit(),e.ecell.coord!=s.ecoord&&e.MoveECell(s.ecoord),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=n.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)&&e.MoveECellWithKey(o)):(e.inputBox.DisplayCellContents(),e.RangeRemove(),e.MoveECell(s.ecoord));break}return s.partialexpr&&"[backspace]"==o?(e.inputBox.SetText(s.partialexpr),s.partialexpr="",e.RangeRemove(),e.MoveECell(s.ecoord),e.inputBox.ShowInputBox(!0),!1):"[f2]"==o?(e.state="inputboxdirect",!1):(c.hasrange&&e.RangeRemove(),e.MoveECell(s.ecoord),s.partialexpr&&(e.inputBox.ShowInputBox(!0),s.partialexpr=""),!0);case"inputboxdirect":if(l=e.inputBox.GetText(),"[esc]"==o||"[enter]"==o||"[tab]"==o){e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"==o?e.inputBox.DisplayCellContents():(e.EditorSaveEdit(),e.ecell.coord!=s.ecoord&&e.MoveECell(s.ecoord),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=n.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)&&e.MoveECellWithKey(o));break}return"[f2]"==o?(e.state="input",!1):!0;case"skip-and-start":return e.state="start",e.cellhandles.ShowCellHandles(!0),!1;default:return!0}return!1},t.EditorAddToInput=function(e,t,o){var n=e.workingvalues;if(!e.noEdit&&!e.ECellReadonly())switch(e.state){case"start":e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.element.disabled=!1,e.inputBox.Focus(),e.inputBox.SetText((o||"")+t),e.inputBox.Select("end"),n.partialexpr="",n.ecoord=e.ecell.coord,n.erow=e.ecell.row,n.ecol=e.ecell.col,e.RangeRemove();break;case"input":case"inputboxdirect":e.inputBox.element.focus(),n.partialexpr&&(e.inputBox.SetText(n.partialexpr),n.partialexpr="",e.RangeRemove(),e.MoveECell(n.ecoord)),e.inputBox.SetText(e.inputBox.GetText()+t)}},t.EditorDisplayCellContents=function(e){e.inputBox&&e.inputBox.DisplayCellContents()},t.EditorSaveEdit=function(e,o){var n,r,a,l,i,s,c=e.context.sheetobj,u=e.workingvalues;a="text t",l="string"==typeof o?o:e.inputBox.GetText(),i=t.GetCellContents(c,u.ecoord)+"",l!=i&&(r=l.charAt(0),"="==r&&-1==l.indexOf("\n")?(a="formula",l=l.substring(1)):"'"==r?(a="text t",l=l.substring(1),n=t.DetermineValueType(l),"t"==n.type.charAt(0)&&(a="text "+n.type)):0==l.length?a="empty":(n=t.DetermineValueType(l),a="n"==n.type&&l==n.value+""?"value n":"t"==n.type.charAt(0)?"text "+n.type:""==n.type?"text t":"constant "+n.type+" "+n.value),"t"==a.charAt(0)&&(l=t.encodeForSave(l)),s="set "+u.ecoord+" "+a+" "+l,e.EditorScheduleSheetCommands(s,!0,!1),"undefined"!=typeof c.ioEventTree&&"undefined"!=typeof c.ioParameterList&&"undefined"!=typeof c.ioEventTree[u.ecoord]&&t.EditedTriggerCell(c.ioEventTree[u.ecoord],u.ecoord,e,c))},t.EditedTriggerCell=function(e,t,o,n){for(var r in e){var a=n.ioParameterList[r];if("undefined"!=typeof a)switch(a.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":cmdline="setemailparameters "+r+" "+t,o.deferredEmailCommands.push({cmdstr:cmdline,saveundo:!1})}}},t.EditorApplySetCommandsToRange=function(e,o){var n,r,a=(e.context.sheetobj,e.ecell),l=e.range;l.hasrange?(coord=t.crToCoord(l.left,l.top)+":"+t.crToCoord(l.right,l.bottom),n="set "+coord+" "+o,r=e.EditorScheduleSheetCommands(n,!0,!1)):(n="set "+a.coord+" "+o,r=e.EditorScheduleSheetCommands(n,!0,!1)),e.DisplayCellContents()},t.EditorProcessMouseWheel=function(e,t,o,n){n.functionobj.editor.busy||(t>0&&n.functionobj.editor.ScrollRelative(!0,Math.floor(1.5*-t)),0>t&&n.functionobj.editor.ScrollRelative(!0,Math.ceil(1.5*-t)))},t.GridMousePosition=function(e,o,n){var r,a,l,i,s,c,u={};for(r=1;r<e.rowpositions.length&&!(e.rowheight[r]&&e.rowpositions[r]+e.rowheight[r]>n);r++);for(l=1;l<e.colpositions.length&&!(e.colwidth[l]&&e.colpositions[l]+e.colwidth[l]>o);l++);if(u.row=r,u.col=l,e.headposition){if(o<e.headposition.left&&o>=e.gridposition.left){for(u.rowheader=!0,u.distance=e.headposition.left-o,u.rowtoresize=!1,u.rowselect=!1,s=1;s<e.rowpositions.length;s++)if(e.rowheight[s]&&e.rowpositions[s]+e.rowheight[s]-3<=n&&e.rowpositions[s]+e.rowheight[s]+3>=n){u.rowtoresize=s;break}for((unhide=e.context.rowunhidetop[r])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=e.rowpositions[r]+e.rowheight[r]-unhide.offsetHeight&&n<e.rowpositions[r]+e.rowheight[r]&&(u.rowtounhide=r+1)),(unhide=e.context.rowunhidebottom[r])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=e.rowpositions[r]&&n<e.rowpositions[r]+unhide.offsetHeight&&(u.rowtounhide=r-1)),a=0;a<e.context.rowpanes.length;a++)if(u.rowtoresize>=e.context.rowpanes[a].first&&u.rowtoresize<=e.context.rowpanes[a].last)return u;return delete u.rowtoresize,u.rowselect=!0,u}if(n<e.headposition.top&&n>e.gridposition.top){for(u.colheader=!0,u.distance=e.headposition.top-n,u.coltoresize=!1,u.colselect=!1,c=1;c<e.colpositions.length;c++)if(e.colwidth[c]&&e.colpositions[c]+e.colwidth[c]-3<=o&&e.colpositions[c]+e.colwidth[c]+3>=o){u.coltoresize=c;break}for((unhide=e.context.colunhideleft[l])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=pos.top&&n<pos.top+unhide.offsetHeight&&(u.coltounhide=l+1)),(unhide=e.context.colunhideright[l])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&n>=pos.top&&n<pos.top+unhide.offsetHeight&&(u.coltounhide=l-1)),i=0;i<e.context.colpanes.length;i++)if(u.coltoresize>=e.context.colpanes[i].first&&u.coltoresize<=e.context.colpanes[i].last)return u;return delete u.coltoresize,u.colselect=!0,u}return o>=e.verticaltablecontrol.controlborder?(u.rowfooter=!0,u.distance=o-e.verticaltablecontrol.controlborder,u):n>=e.horizontaltablecontrol.controlborder?(u.colfooter=!0,u.distance=n-e.horizontaltablecontrol.controlborder,u):o<e.gridposition.left?(u.rowheader=!0,u.distance=e.headposition.left-o,u):n<=e.gridposition.top?(u.colheader=!0,u.distance=e.headposition.top-n,u):(u.coord=t.crToCoord(u.col,u.row),e.context.cellskip[u.coord]&&(u.coord=e.context.cellskip[u.coord]),u)}return null},t.GetEditorCellElement=function(e,o,n){var r=0,a=0;if(0==e.context.showRCHeaders)var r=-1,a=-1;var l,i,s,c,u=0,d=0;for(l=0;l<e.context.rowpanes.length;l++){if(o>=e.context.rowpanes[l].first&&o<=e.context.rowpanes[l].last)for(i=0;i<e.context.colpanes.length;i++){if(n>=e.context.colpanes[i].first&&n<=e.context.colpanes[i].last){for(u+=o-e.context.rowpanes[l].first+2,s=e.context.colpanes[i].first;n>=s;s++)c=e.context.cellskip[t.crToCoord(s,o)],c&&e.context.CoordInPane(c,l,i)||d++;return{element:e.griddiv.firstChild.lastChild.childNodes[u+a].childNodes[d+r],rowpane:l,colpane:i}}for(s=e.context.colpanes[i].first;s<=e.context.colpanes[i].last;s++)c=e.context.cellskip[t.crToCoord(s,o)],c&&e.context.CoordInPane(c,l,i)||d++;d+=1}u+=e.context.rowpanes[l].last-e.context.rowpanes[l].first+1+1}return null},t.MoveECellWithKey=function(e,o){var n,r,a,l,i=!1,s=1;if(!e.ecell)return null;switch("shifted"==o.slice(-7)&&(o=o.slice(0,-7),i=!0),r=e.ecell.row,a=e.ecell.col,l=e.context.sheetobj.cells[e.ecell.coord],o){case"[adown]":r+=l&&l.rowspan||1;break;case"[aup]":r--,s=-1;break;case"[pgdn]":r+=e.pageUpDnAmount-1+(l&&l.rowspan||1);break;case"[pgup]":r-=e.pageUpDnAmount,s=-1;break;case"[aright]":a+=l&&l.colspan||1;break;case"[aleft]":a--,s=-1;break;case"[home]":r=1,a=1;break;default:return null}for(e.context.sheetobj.attribs.usermaxcol&&(a=Math.min(e.context.sheetobj.attribs.usermaxcol,a)),e.context.sheetobj.attribs.usermaxrow&&(r=Math.min(e.context.sheetobj.attribs.usermaxrow,r));"yes"==e.context.sheetobj.colattribs.hide[t.rcColname(a)];)a+=s,1>a&&(s=-s,a=1);for(;"yes"==e.context.sheetobj.rowattribs.hide[r];)r+=s,1>r&&(s=-s,r=1);return e.range.hasrange||i&&e.RangeAnchor(),n=e.MoveECell(t.crToCoord(a,r)),e.range.hasrange&&(i?e.RangeExtend():e.RangeRemove()),n},t.MoveECell=function(e,o){var n,r,a=e.context.highlights,l=t.coordToCr(o);if(e.context.sheetobj.attribs.usermaxcol&&l.col>e.context.sheetobj.attribs.usermaxcol&&(l.col=e.context.sheetobj.attribs.usermaxcol),e.context.sheetobj.attribs.usermaxrow&&l.row>e.context.sheetobj.attribs.usermaxrow&&(l.row=e.context.sheetobj.attribs.usermaxrow),o=t.crToCoord(l.col,l.row),e.ecell){if(e.ecell.coord==o)return o;n=t.GetEditorCellElement(e,e.ecell.row,e.ecell.col),delete a[e.ecell.coord],e.range2.hasrange&&e.ecell.row>=e.range2.top&&e.ecell.row<=e.range2.bottom&&e.ecell.col>=e.range2.left&&e.ecell.col<=e.range2.right&&(a[e.ecell.coord]="range2"),e.UpdateCellCSS(n,e.ecell.row,e.ecell.col),e.SetECellHeaders(""),e.cellhandles&&e.cellhandles.ShowCellHandles(!1)}o=e.context.cellskip[o]||o,e.ecell=t.coordToCr(o),e.ecell.coord=o,n=t.GetEditorCellElement(e,e.ecell.row,e.ecell.col),a[o]="cursor";for(r in e.MoveECellCallback)e.MoveECellCallback[r](e);e.UpdateCellCSS(n,e.ecell.row,e.ecell.col),e.SetECellHeaders("selected");for(r in e.StatusCallback)e.StatusCallback[r].func(e,"moveecell",o,e.StatusCallback[r].params);return e.busy?e.ensureecell=!0:(e.ensureecell=!1,e.EnsureECellVisible()),o},t.EnsureECellVisible=function(e){var t=0,o=0;e.ecell.row>e.lastnonscrollingrow&&(e.ecell.row<e.firstscrollingrow?t=e.ecell.row-e.firstscrollingrow-Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2):e.ecell.row+1>e.lastvisiblerow&&(t=e.ecell.row-e.lastvisiblerow+Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2))),e.ecell.col>e.lastnonscrollingcol&&(e.ecell.col<e.firstscrollingcol?o=e.ecell.col-e.firstscrollingcol-Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2):e.ecell.col+1>e.lastvisiblecol&&(o=e.ecell.col-e.lastvisiblecol+Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2))),0!=t||0!=o?e.ScrollRelativeBoth(t,o):e.cellhandles.ShowCellHandles(!0)
},t.ReplaceCell=function(e,t,o,n){var r,a;if(t&&(r=e.context.RenderCell(o,n,t.rowpane,t.colpane,!0,null),r&&t.element)){t.element.innerHTML=r.innerHTML,t.element.style.cssText="",t.element.className=r.className;for(a in r.style)"cssText"!=r.style[a]&&(t.element.style[a]=r.style[a])}},t.UpdateCellCSS=function(e,t,o,n){var r,a;if(t&&(r=e.context.RenderCell(o,n,t.rowpane,t.colpane,!0,null))){t.element.style.cssText="",t.element.className=r.className;for(a in r.style)"cssText"!=r.style[a]&&(t.element.style[a]=r.style[a])}},t.SetECellHeaders=function(e,o){if(e.context.showRCHeaders!==!1){var n,r,a,l,i,s=e.ecell,c=e.context,u=0,d=0;if(s){for(;"yes"==c.sheetobj.colattribs.hide[t.rcColname(s.col)];)s.col++;for(;"yes"==c.sheetobj.rowattribs.hide[s.row];)s.row++;for(s.coord=t.crToCoord(s.col,s.row),n=0;n<c.rowpanes.length;n++)a=c.rowpanes[n].first,l=c.rowpanes[n].last,s.row>=a&&s.row<=l&&null!==e.fullgrid&&(i=e.fullgrid.childNodes[1].childNodes[2+u+s.row-a].childNodes[0],i&&(c.classnames&&(i.className=c.classnames[o+"rowname"]),c.explicitStyles&&(i.style.cssText=c.explicitStyles[o+"rowname"]),i.style.verticalAlign="top")),u+=l-a+1+1;for(r=0;r<c.colpanes.length;r++)a=c.colpanes[r].first,l=c.colpanes[r].last,s.col>=a&&s.col<=l&&null!==e.fullgrid&&(i=e.fullgrid.childNodes[1].childNodes[1].childNodes[1+d+s.col-a],i&&(c.classnames&&(i.className=c.classnames[o+"colname"]),c.explicitStyles&&(i.style.cssText=c.explicitStyles[o+"colname"]))),d+=l-a+1+1}}},t.ECellReadonly=function(e,t){if(!t&&e.ecell&&(t=e.ecell.coord),!t)return!1;var o=e.context.sheetobj.cells[t];return o&&o.readonly},t.RangeAnchor=function(e,t){e.range.hasrange&&e.RangeRemove(),e.RangeExtend(t)},t.RangeExtend=function(e,o){var n,r,a,l,i,s,c,u=e.context.highlights,d=e.range,p=e.range2;if(o?(c=t.coordToCr(o),c.coord=o):c=e.ecell,c){d.hasrange||(d.anchorcoord=c.coord,d.anchorrow=c.row,d.top=c.row,d.bottom=c.row,d.anchorcol=c.col,d.left=c.col,d.right=c.col,d.hasrange=!0),d.anchorrow<c.row?(d.top=d.anchorrow,d.bottom=c.row):(d.top=c.row,d.bottom=d.anchorrow),d.anchorcol<c.col?(d.left=d.anchorcol,d.right=c.col):(d.left=c.col,d.right=d.anchorcol);for(a in u)switch(u[a]){case"range":u[a]="unrange";break;case"range2":u[a]="unrange2"}for(l=d.top;l<=d.bottom;l++)for(i=d.left;i<=d.right;i++)switch(a=t.crToCoord(i,l),u[a]){case"unrange":u[a]="range";break;case"cursor":break;case"unrange2":default:u[a]="newrange"}for(l=p.top;p.hasrange&&l<=p.bottom;l++)for(i=p.left;i<=p.right;i++)switch(a=t.crToCoord(i,l),u[a]){case"unrange2":u[a]="range2";break;case"range":case"newrange":case"cursor":break;default:u[a]="newrange2"}for(a in u){switch(u[a]){case"unrange":delete u[a];break;case"newrange":u[a]="range";break;case"newrange2":u[a]="range2";break;case"range":case"range2":case"cursor":continue}r=t.coordToCr(a),n=t.GetEditorCellElement(e,r.row,r.col),e.UpdateCellCSS(n,r.row,r.col)}for(s in e.RangeChangeCallback)e.RangeChangeCallback[s](e);a=t.crToCoord(e.range.left,e.range.top),(e.range.left!=e.range.right||e.range.top!=e.range.bottom)&&(a+=":"+t.crToCoord(e.range.right,e.range.bottom));for(s in e.StatusCallback)e.StatusCallback[s].func(e,"rangechange",a,e.StatusCallback[s].params)}},t.RangeRemove=function(e){var o,n,r,a,l,i,s=e.context.highlights,c=e.range,u=e.range2;if(c.hasrange||u.hasrange){for(a=u.top;u.hasrange&&a<=u.bottom;a++)for(l=u.left;l<=u.right;l++)switch(r=t.crToCoord(l,a),s[r]){case"range":s[r]="newrange2";break;case"range2":case"cursor":break;default:s[r]="newrange2"}for(r in s){switch(s[r]){case"range":delete s[r];break;case"newrange2":s[r]="range2";break;case"cursor":continue}n=t.coordToCr(r),o=t.GetEditorCellElement(e,n.row,n.col),e.UpdateCellCSS(o,n.row,n.col)}c.hasrange=!1;for(i in e.RangeChangeCallback)e.RangeChangeCallback[i](e);for(i in e.StatusCallback)e.StatusCallback[i].func(e,"rangechange","",e.StatusCallback[i].params)}},t.Range2Remove=function(e){var o,n,r,a=e.context.highlights,l=e.range2;if(l.hasrange){for(r in a){switch(a[r]){case"range2":delete a[r];break;case"range":case"cursor":continue}n=t.coordToCr(r),o=t.GetEditorCellElement(e,n.row,n.col),e.UpdateCellCSS(o,n.row,n.col)}l.hasrange=!1}},t.FitToEditTable=function(e){{var o,n,r,a,l,i,s,c,u=e.context,d=u.sheetobj;d.colattribs}for(a=u.showRCHeaders?u.rownamewidth-0:0,colpane=0;colpane<u.colpanes.length-1;colpane++)for(o=u.colpanes[colpane].first;o<=u.colpanes[colpane].last;o++)n=t.rcColname(o),"yes"!=d.colattribs.hide[n]&&(r=d.colattribs.width[n]||d.attribs.defaultcolwidth||t.Constants.defaultColWidth,("blank"==r||"auto"==r)&&(r=""),a+=r&&r-0>0?r-0:10);for(o=u.colpanes[colpane].first;1e4>=o&&(n=t.rcColname(o),"yes"!=d.colattribs.hide[n]&&(r=d.colattribs.width[n]||d.attribs.defaultcolwidth||t.Constants.defaultColWidth,("blank"==r||"auto"==r)&&(r=""),a+=r&&r-0>0?r-0:10),!(a>e.tablewidth));o++);u.colpanes[colpane].last=u.sheetobj.attribs.usermaxcol||o;for(var p=u.rowpanes[0].first,f=u.sheetobj.attribs.lastrow;"yes"==d.rowattribs.hide[p]&&f>p;)p++;for(u.rowpanes[0].first=p,l=u.showRCHeaders?1:0,s=0;s<u.rowpanes.length-1;s++)for(l+=u.rowpanes[s].last-u.rowpanes[s].first+1,i=u.rowpanes[s].first;i<=u.rowpanes[s].last;i++)"yes"==d.rowattribs.hide[i]&&l--;c=e.tableheight-l*u.pixelsPerRow,u.rowpanes[s].last=u.sheetobj.attribs.usermaxrow||u.rowpanes[s].first+Math.floor(c/u.pixelsPerRow)+1},t.CalculateEditorPositions=function(e){var o,n,r;e.gridposition=t.GetElementPosition(e.griddiv);var a=e.griddiv.firstChild.lastChild.childNodes[1].childNodes[0];for(e.headposition=t.GetElementPosition(a),e.headposition.left+=a.offsetWidth,e.headposition.top+=a.offsetHeight,e.rowpositions=[],o=0;o<e.context.rowpanes.length;o++)e.CalculateRowPositions(o,e.rowpositions,e.rowheight);for(r=0;r<e.rowpositions.length&&!(e.rowpositions[r]>e.gridposition.top+e.tableheight);r++);for(e.lastvisiblerow=r-1,e.colpositions=[],n=0;n<e.context.colpanes.length;n++)e.CalculateColPositions(n,e.colpositions,e.colwidth);for(r=0;r<e.colpositions.length&&!(e.colpositions[r]>e.gridposition.left+e.tablewidth);r++);for(e.lastvisiblecol=r-1,e.firstscrollingrow=e.context.rowpanes[e.context.rowpanes.length-1].first;"yes"==e.context.sheetobj.rowattribs.hide[e.firstscrollingrow];)e.firstscrollingrow++;for(e.firstscrollingrowtop=e.rowpositions[e.firstscrollingrow]||e.headposition.top,e.lastnonscrollingrow=e.context.rowpanes.length-1>0?e.context.rowpanes[e.context.rowpanes.length-2].last:0,e.firstscrollingcol=e.context.colpanes[e.context.colpanes.length-1].first;"yes"==e.context.sheetobj.colattribs.hide[t.rcColname(e.firstscrollingcol)];)e.firstscrollingcol++;e.firstscrollingcolleft=e.colpositions[e.firstscrollingcol]||e.headposition.left,e.lastnonscrollingcol=e.context.colpanes.length-1>0?e.context.colpanes[e.context.colpanes.length-2].last:0,e.verticaltablecontrol.ComputeTableControlPositions(),e.horizontaltablecontrol.ComputeTableControlPositions()},t.ScheduleRender=function(o){1!=o.ignoreRender&&(o.timeout&&e.clearTimeout(o.timeout),t.EditorSheetStatusCallback(null,"schedrender",null,o),o.timeout=e.setTimeout(function(){t.DoRenderStep(o)},1))},t.DoRenderStep=function(o){o.timeout=null,o.EditorRenderSheet(),t.EditorSheetStatusCallback(null,"renderdone",null,o),t.EditorSheetStatusCallback(null,"schedposcalc",null,o),o.timeout=e.setTimeout(function(){t.DoPositionCalculations(o)},1)},t.SchedulePositionCalculations=function(o){t.EditorSheetStatusCallback(null,"schedposcalc",null,o),o.timeout=e.setTimeout(function(){t.DoPositionCalculations(o)},1)},t.DoPositionCalculations=function(e){e.timeout=null,e.CalculateEditorPositions(),e.verticaltablecontrol.PositionTableControlElements(),e.horizontaltablecontrol.PositionTableControlElements(),t.EditorSheetStatusCallback(null,"doneposcalc",null,e),e.ensureecell&&e.ecell&&!e.deferredCommands.length&&(e.ensureecell=!1,e.EnsureECellVisible()),e.cellhandles.ShowCellHandles(!0)},t.CalculateRowPositions=function(e,t,o,n){{var r,a,l,i,s,c,u=e.context;u.sheetobj}if(u.showRCHeaders){for(c=e.fullgrid.lastChild,r=2,a=0;t>a;a++)r+=u.rowpanes[a].last-u.rowpanes[a].first+2;for(i=0,l=u.rowpanes[a].first;l<=u.rowpanes[a].last;l++)s=c.childNodes[r+i],i++,s&&(o[l]||(o[l]=s.firstChild.offsetTop,n[l]=s.firstChild.offsetHeight))}},t.CalculateColPositions=function(e,o,n,r){{var a,l,i,s,c,u,d,p=e.context;p.sheetobj}if(p.showRCHeaders){for(d=e.fullgrid.lastChild,a=1,l=0;o>l;l++)a+=p.colpanes[l].last-p.colpanes[l].first+2;for(c=d.childNodes[1],s=0,i=p.colpanes[l].first;i<=p.colpanes[l].last;i++)u=t.GetElementPosition(c.childNodes[a+s]),n[i]||(n[i]=u.left,c.childNodes[a+s]&&(r[i]=c.childNodes[a+s].offsetWidth)),s++}},t.ScrollRelative=function(e,t,o){t?e.ScrollRelativeBoth(o,0):e.ScrollRelativeBoth(0,o)},t.ScrollRelativeBoth=function(e,o,n){var r=e.context,a=o>0?1:-1,l=n>0?1:-1,i=r.rowpanes.length,s=i>1?r.rowpanes[i-2].last+1:1;r.rowpanes[i-1].first+o<s&&(o=-r.rowpanes[i-1].first+s);var c=r.colpanes.length,u=c>1?r.colpanes[c-2].last+1:1;for(r.colpanes[c-1].first+n<u&&(n=-r.colpanes[c-1].first+u);"yes"==r.sheetobj.colattribs.hide[t.rcColname(r.colpanes[c-1].first+n)];)if(n+=l,1>n){n=0;break}for(;"yes"==r.sheetobj.rowattribs.hide[r.rowpanes[i-1].first+o];)if(o+=a,1>o){o=0;break}return 1!=o&&-1!=o||0!=n?void((0!=o||0!=n)&&(r.rowpanes[i-1].first+=o,r.rowpanes[i-1].last+=o,r.colpanes[c-1].first+=n,r.colpanes[c-1].last+=n,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender())):(1==o?e.ScrollTableUpOneRow():e.ScrollTableDownOneRow(),e.ecell&&e.SetECellHeaders("selected"),void e.SchedulePositionCalculations())},t.PageRelative=function(e,o,n){var r,a,l,i,s=e.context,c=o?"rowpanes":"colpanes",u=s[c][s[c].length-1],d=o?"lastvisiblerow":"lastvisiblecol",p=o?e.rowheight:e.colwidth,f=o?t.Constants.defaultAssumedRowHeight:t.Constants.defaultColWidth;if(n>0)a=e[d],a==u.first&&(a+=1);else{for(l=o?e.tableheight-(e.firstscrollingrowtop-e.gridposition.top):e.tablewidth-(e.firstscrollingcolleft-e.gridposition.left),l-=p[e[d]]>0?p[e[d]]:f,a=u.first-1;a>0&&(r=p[a]>0?p[a]:f,!(r>l));a--)l-=r;i=u.first,a>=i&&(a=i-1),1>a&&(a=1)}u.first=a,u.last=a+1,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender()},t.LimitLastPanes=function(e){var t,o=e.context;t=o.rowpanes.length,t>1&&o.rowpanes[t-1].first<=o.rowpanes[t-2].last&&(o.rowpanes[t-1].first=o.rowpanes[t-2].last+1),o.sheetobj.attribs.usermaxrow&&o.rowpanes[t-1].first>o.sheetobj.attribs.usermaxrow&&(o.rowpanes[t-1].first=o.sheetobj.attribs.usermaxrow),t=o.colpanes.length,t>1&&o.colpanes[t-1].first<=o.colpanes[t-2].last&&(o.colpanes[t-1].first=o.colpanes[t-2].last+1),o.sheetobj.attribs.usermaxcol&&o.colpanes[t-1].first>o.sheetobj.attribs.usermaxcol&&(o.colpanes[t-1].first=o.sheetobj.attribs.usermaxcol)},t.ScrollTableUpOneRow=function(e){var o,n,r,a,l,i,s,c,u,d,p,f,h={},m=e.context,g=m.sheetobj,v=e.fullgrid;for(f=v.lastChild,o=m.showRCHeaders?2:1,n=0;n<m.rowpanes.length-1;n++)o+=m.rowpanes[n].last-m.rowpanes[n].first+2;if(m.sheetobj.attribs.usermaxrow&&m.sheetobj.attribs.usermaxrow-m.rowpanes[n].first<1)return v;for(f.removeChild(f.childNodes[o]),m.rowpanes[n].first++,m.rowpanes[n].last++,e.FitToEditTable(),m.CalculateColWidthData(),m.sheetobj.attribs.usermaxrow&&m.rowpanes[n].last==m.sheetobj.attribs.usermaxrow||(c=m.RenderRow(m.rowpanes[n].last,n),f.appendChild(c)),maxrowspan=1,s=m.rowpanes[n].first-1,l=0;l<m.colpanes.length;l++)for(a=m.colpanes[l].first;a<=m.colpanes[l].last;a++)coord=t.crToCoord(a,s),m.cellskip[coord]||(i=g.cells[coord],i&&i.rowspan>maxrowspan&&(maxrowspan=i.rowspan));if(maxrowspan>1)for(r=1;maxrowspan>r&&!(r+s>=m.rowpanes[n].last);r++)u=m.RenderRow(r+s,n),d=f.childNodes[o+r-1],f.replaceChild(u,d);for(p=m.rowpanes[n].last,l=0;l<m.colpanes.length;l++)for(a=m.colpanes[l].first;a<=m.colpanes[l].last;a++)coord=m.cellskip[t.crToCoord(a,p)],coord&&(r=m.coordToCR[coord].row-0,r==m.rowpanes[n].last||r<m.rowpanes[n].first||(i=g.cells[coord],i&&i.rowspan>1&&(h[r]=!0)));for(r in h)u=m.RenderRow(r,n),d=f.childNodes[o+(r-m.rowpanes[n].first)],f.replaceChild(u,d);return v},t.ScrollTableDownOneRow=function(e){var o,n,r,a,l,i,s,c,u,d,p,f={},h=e.context,m=h.sheetobj,g=e.fullgrid;for(p=g.lastChild,o=h.showRCHeaders?2:1,n=0;n<h.rowpanes.length-1;n++)o+=h.rowpanes[n].last-h.rowpanes[n].first+2;for(h.sheetobj.attribs.usermaxrow||p.removeChild(p.childNodes[o+(h.rowpanes[n].last-h.rowpanes[n].first)]),h.rowpanes[n].first--,h.rowpanes[n].last--,e.FitToEditTable(),h.CalculateColWidthData(),c=h.RenderRow(h.rowpanes[n].first,n),p.insertBefore(c,p.childNodes[o]),maxrowspan=1,s=h.rowpanes[n].first,l=0;l<h.colpanes.length;l++)for(a=h.colpanes[l].first;a<=h.colpanes[l].last;a++)coord=t.crToCoord(a,s),h.cellskip[coord]||(i=m.cells[coord],i&&i.rowspan>maxrowspan&&(maxrowspan=i.rowspan));if(maxrowspan>1)for(r=1;maxrowspan>r&&!(r+s>h.rowpanes[n].last);r++)c=h.RenderRow(r+s,n),u=p.childNodes[o+r],p.replaceChild(c,u);for(d=h.rowpanes[n].last,l=0;l<h.colpanes.length;l++)for(a=h.colpanes[l].first;a<=h.colpanes[l].last;a++)coord=t.crToCoord(a,d),i=m.cells[coord],i&&i.rowspan>1?f[d]=!0:(coord=h.cellskip[t.crToCoord(a,d)],coord&&(r=h.coordToCR[coord].row-0,r==d||r<h.rowpanes[n].first||(i=m.cells[coord],i&&i.rowspan>1&&(f[r]=!0))));for(r in f)c=h.RenderRow(r,n),u=p.childNodes[o+(r-h.rowpanes[n].first)],p.replaceChild(c,u);return g},t.InputBox=function(e,o){e&&(this.element=e,this.editor=o,this.inputEcho=null,o.inputBox=this,e.onmousedown=t.InputBoxOnMouseDown,o.MoveECellCallback.formulabar=function(e){"start"==e.state&&o.inputBox.DisplayCellContents(e.ecell.coord)})},t.InputBox.prototype.DisplayCellContents=function(e){t.InputBoxDisplayCellContents(this,e)},t.InputBox.prototype.ShowInputBox=function(e){this.editor.inputEcho.ShowInputEcho(e)},t.InputBox.prototype.GetText=function(){return this.element.value},t.InputBox.prototype.SetText=function(e){this.element&&(this.element.value=e,this.editor.inputEcho.SetText(e+"_"))},t.InputBox.prototype.Focus=function(){t.InputBoxFocus(this)},t.InputBox.prototype.Blur=function(){return this.element.blur()},t.InputBox.prototype.Select=function(e){if(this.element)switch(e){case"end":if(document.selection&&document.selection.createRange)try{var t=document.selection.createRange().duplicate();t.moveToElementText(this.element),t.collapse(!1),t.select()}catch(o){void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}else void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}},t.InputBoxDisplayCellContents=function(e,o){var n=t.Constants;if(e){if(!o){if(!e.editor)return;if(!e.editor.ecell)return;o=e.editor.ecell.coord}var r=t.GetCellContents(e.editor.context.sheetobj,o);-1!=r.indexOf("\n")?(r=n.s_inputboxdisplaymultilinetext,e.element.disabled=!0):e.element.disabled=e.editor.ECellReadonly()?!0:!1,e.SetText(r)}},t.InputBoxFocus=function(e){if(e){e.element.focus();var t=e.editor;t.state="input";var o=t.workingvalues;o.partialexpr="",o.ecoord=t.ecell.coord,o.erow=t.ecell.row,o.ecol=t.ecell.col}},t.InputBoxOnMouseDown=function(){var e=t.Keyboard.focusTable;if(!e)return!0;var o=e.workingvalues;switch(e.state){case"start":e.state="inputboxdirect",o.partialexpr="",o.ecoord=e.ecell.coord,o.erow=e.ecell.row,o.ecol=e.ecell.col,e.inputEcho.ShowInputEcho(!0);break;case"input":o.partialexpr="",e.MoveECell(o.ecoord),e.state="inputboxdirect",t.KeyboardFocus();break;case"inputboxdirect":}},t.InputEcho=function(e){var o=t.Constants;this.editor=e,this.text="",this.interval=null,this.container=null,this.main=null,this.prompt=null,this.hint=null,this.functionbox=null,this.container=document.createElement("div"),t.setStyles(this.container,"display:none;position:absolute;zIndex:10;"),this.main=document.createElement("div"),o.defaultInputEchoClass&&(this.main.className=o.defaultInputEchoClass),o.defaultInputEchoStyle&&t.setStyles(this.main,o.defaultInputEchoStyle),this.main.innerHTML="&nbsp;",this.hint=document.createElement("div"),o.defaultInputEchoHintClass&&(this.hint.className=o.defaultInputEchoHintClass),o.defaultInputEchoHintStyle&&t.setStyles(this.hint,o.defaultInputEchoHintStyle),this.hint.innerHTML="",this.container.appendChild(this.hint),this.container.appendChild(this.main),this.prompt=document.createElement("div"),o.defaultInputEchoPromptClass&&(this.prompt.className=o.defaultInputEchoPromptClass),o.defaultInputEchoPromptStyle&&t.setStyles(this.prompt,o.defaultInputEchoPromptStyle),this.prompt.innerHTML="",this.container.appendChild(this.prompt),t.DragRegister(this.main,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:this.container},this.editor.toplevel),e.toplevel.appendChild(this.container)},t.InputEcho.prototype.ShowInputEcho=function(e){return t.ShowInputEcho(this,e)},t.InputEcho.prototype.SetText=function(e){return t.SetInputEchoText(this,e)},t.ShowInputEcho=function(o,n){var r,a,l=o.editor;l&&(n?(l.cellhandles.ShowCellHandles(!1),r=t.GetEditorCellElement(l,l.ecell.row,l.ecell.col),r&&(a=t.GetElementPosition(r.element),o.container.style.left=a.left-1+"px",o.container.style.top=a.top-1+"px"),o.hint.innerHTML=l.ecell.coord,o.container.style.display="block",o.interval&&e.clearInterval(o.interval),o.interval=e.setInterval(t.InputEchoHeartbeat,50)):(o.interval&&e.clearInterval(o.interval),o.container.style.display="none"))},t.SetInputEchoText=function(e,o){var n,r,a=t.Constants,l=t.special_chars(o);l=l.replace(/\n/g,"<br>"),e.text!=l&&(e.main.innerHTML=l,e.text=l);var i=o.match(/.*[\+\-\*\/\&\^\<\>\=\,\(]([A-Za-z][A-Za-z][\w\.]*?)\([^\)]*$/);"="==o.charAt(0)&&i?(n=i[1].toUpperCase(),t.Formula.FunctionList[n]?(t.Formula.FillFunctionInfo(),r=t.special_chars(n+"("+t.Formula.FunctionArgString(n)+")")):r=a.ietUnknownFunction+n,e.prompt.innerHTML!=r&&(e.prompt.innerHTML=r,e.prompt.style.display="block")):"none"!=e.prompt.style.display&&(e.prompt.innerHTML="",e.prompt.style.display="none")},t.InputEchoHeartbeat=function(){var e=t.Keyboard.focusTable;return e?void e.inputEcho.SetText(e.inputBox.GetText()+"_"):!0},t.InputEchoMouseDown=function(o){var n=(o||e.event,t.Keyboard.focusTable);return n?void n.inputBox.element.focus():!0},t.CellHandles=function(e){t.Constants;if(!e.noEdit){this.editor=e,this.noCursorSuffix=!1,this.movedmouse=!1,this.draghandle=document.createElement("div"),t.setStyles(this.draghandle,"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;"),this.draghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.draghandle),t.AssignID(e,this.draghandle,"draghandle");var o="png";if(navigator.userAgent.match(/MSIE 6\.0/)&&(o="gif"),this.dragpalette=document.createElement("div"),t.setStyles(this.dragpalette,"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url("+t.Constants.defaultImagePrefix+"drag-handles."+o+");"),this.dragpalette.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragpalette),t.AssignID(e,this.dragpalette,"dragpalette"),this.dragtooltip=document.createElement("div"),t.setStyles(this.dragtooltip,"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;"),this.dragtooltip.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragtooltip),t.AssignID(e,this.dragtooltip,"dragtooltip"),this.fillinghandle=document.createElement("div"),t.setStyles(this.fillinghandle,"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;"),this.fillinghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.fillinghandle),t.AssignID(e,this.fillinghandle,"fillinghandle"),this.draghandle.addEventListener)this.draghandle.addEventListener("mousemove",t.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener("mousedown",t.CellHandlesMouseDown,!1),this.dragpalette.addEventListener("mousemove",t.CellHandlesMouseMoveOnHandle,!1);else{if(!this.draghandle.attachEvent)throw"Browser not supported";this.draghandle.attachEvent("onmousemove",t.CellHandlesMouseMoveOnHandle),this.dragpalette.attachEvent("onmousedown",t.CellHandlesMouseDown),this.dragpalette.attachEvent("onmousemove",t.CellHandlesMouseMoveOnHandle)}}},t.CellHandles.prototype.ShowCellHandles=function(e,o){return t.ShowCellHandles(this,e,o)},t.ShowCellHandles=function(e,o,n){var r,a,l,i=e.editor,s=!1,c=1,u=1;if(i&&i.ecell){do{if(!o)break;if(a=i.ecell.row,l=i.ecell.col,"start"!=i.state)break;if(a>=i.lastvisiblerow)break;if(l>=i.lastvisiblecol)break;if(a<i.firstscrollingrow)break;if(l<i.firstscrollingcol)break;for(;"yes"==i.context.sheetobj.colattribs.hide[t.rcColname(l+c)];)c++;for(;"yes"==i.context.sheetobj.rowattribs.hide[a+u];)u++;if(r=i.context.sheetobj.cells[t.crToCoord(l+c-1,a+u-1)],"undefined"!=typeof r&&(c+=(r.colspan||1)-1,u+=(r.rowspan||1)-1),i.rowpositions[a+u]+20>i.horizontaltablecontrol.controlborder)break;if(i.rowpositions[a+u]-10<i.headposition.top)break;if(i.colpositions[l+c]+20>i.verticaltablecontrol.controlborder)break;if(i.colpositions[l+c]-30<i.headposition.left)break;e.draghandle.style.left=i.colpositions[l+c]-1+"px",e.draghandle.style.top=i.rowpositions[a+u]-1+"px",e.draghandle.style.display="block",n&&(e.draghandle.style.display="none",e.dragpalette.style.left=i.colpositions[l+c]-45+"px",e.dragpalette.style.top=i.rowpositions[a+u]-45+"px",e.dragpalette.style.display="block",e.dragtooltip.style.left=i.colpositions[l+c]-45+"px",e.dragtooltip.style.top=i.rowpositions[a+u]+45+"px",e.dragtooltip.style.display="none"),s=!0}while(!1);s||(e.draghandle.style.display="none"),n||(e.dragpalette.style.display="none",e.dragtooltip.style.display="none")}},t.CellHandlesMouseMoveOnHandle=function(o){var n=t.Constants,r=o||e.event,a=r.target||r.srcElement,l=t.Keyboard.focusTable;if(!l)return!0;var i=l.cellhandles;if(!i.editor)return!0;var s=t.GetElementPositionWithScroll(l.toplevel),c=r.clientX-s.left,u=r.clientY-s.top;if(!l.cellhandles.mouseDown){if(l.cellhandles.ShowCellHandles(!0,!0),a==i.dragpalette){var d=t.SegmentDivHit([n.CH_radius1,n.CH_radius2],l.cellhandles.dragpalette,c,u);if(0==d)return void t.CellHandlesHoverTimeout();i.tooltipstimer&&(e.clearTimeout(i.tooltipstimer),i.tooltipstimer=null),i.tooltipswhichhandle=d,i.tooltipstimer=e.setTimeout(t.CellHandlesTooltipsTimeout,700)}i.timer&&(e.clearTimeout(i.timer),i.timer=null),i.timer=e.setTimeout(t.CellHandlesHoverTimeout,3e3)}},t.SegmentDivHit=function(e,t,o,n){var r=t.offsetWidth,a=t.offsetHeight,l=t.offsetLeft,i=t.offsetTop,s=0,c=e,u=Math.sqrt(Math.pow(o-l-(r/2-.5),2)+Math.pow(n-i-(a/2-.5),2));if(2==c.length)return o>=l&&l+r/2>o&&n>=i&&i+a/2>n&&(u<=e[0]?s=-1:u<=e[1]&&(s=1)),o>=l+r/2&&l+r>o&&n>=i&&i+a/2>n&&(u<=e[0]?s=-2:u<=e[1]&&(s=2)),o>=l+r/2&&l+r>o&&n>=i+a/2&&i+a>n&&(u<=e[0]?s=-3:u<=e[1]&&(s=3)),o>=l&&l+r/2>o&&n>=i+a/2&&i+a>n&&(u<=e[0]?s=-4:u<=e[1]&&(s=4)),s;for(;;)if(o>=l&&l+r/2>o&&n>=i&&i+a/2>n){if(quadrant+="1",s=c[0],"number"==typeof s)break;c=s,r/=2,a/=2}else if(o>=l+r/2&&l+r>o&&n>=i&&i+a/2>n){if(quadrant+="2",s=c[1],"number"==typeof s)break;c=s,r/=2,l+=r,a/=2}else if(o>=l+r/2&&l+r>o&&n>=i+a/2&&i+a>n){if(quadrant+="3",s=c[2],"number"==typeof s)break;c=s,r/=2,l+=r,a/=2,i+=a}else{if(!(o>=l&&l+r/2>o&&n>=i+a/2&&i+a>n))return 0;if(quadrant+="4",s=c[3],"number"==typeof s)break;c=s,r/=2,a/=2,i+=a}return s},t.CellHandlesHoverTimeout=function(){if(editor=t.Keyboard.focusTable,!editor)return!0;var o=editor.cellhandles;o.timer&&(e.clearTimeout(o.timer),o.timer=null),o.tooltipstimer&&(e.clearTimeout(o.tooltipstimer),o.tooltipstimer=null),editor.cellhandles.ShowCellHandles(!0,!1)},t.CellHandlesTooltipsTimeout=function(){if(editor=t.Keyboard.focusTable,!editor)return!0;var o=editor.cellhandles;o.tooltipstimer&&(e.clearTimeout(o.tooltipstimer),o.tooltipstimer=null);var n=o.tooltipswhichhandle;if(0==n)return void t.CellHandlesHoverTimeout();if(-3==n)o.dragtooltip.innerHTML=scc.s_CHfillAllTooltip;else if(3==n)o.dragtooltip.innerHTML=scc.s_CHfillContentsTooltip;else if(-2==n)o.dragtooltip.innerHTML=scc.s_CHmovePasteAllTooltip;else if(-4==n)o.dragtooltip.innerHTML=scc.s_CHmoveInsertAllTooltip;else if(2==n)o.dragtooltip.innerHTML=scc.s_CHmovePasteContentsTooltip;else{if(4!=n)return o.dragtooltip.innerHTML="&nbsp;",void(o.dragtooltip.style.display="none");o.dragtooltip.innerHTML=scc.s_CHmoveInsertContentsTooltip}o.dragtooltip.style.display="block"},t.CellHandlesMouseDown=function(o){var n,r,a,l=t.Constants,i=o||e.event,s=t.EditorMouseInfo;if(n=t.Keyboard.focusTable,!n)return!0;if(!n.busy){var c=n.cellhandles;c.movedmouse=!1;var u=t.GetElementPositionWithScroll(n.toplevel),d=i.clientX-u.left,p=i.clientY-u.top;c.timer&&(e.clearTimeout(c.timer),c.timer=null),c.tooltipstimer&&(e.clearTimeout(c.tooltipstimer),c.tooltipstimer=null),c.dragtooltip.innerHTML="&nbsp;",c.dragtooltip.style.display="none",a=n.range;var f=t.SegmentDivHit([l.CH_radius1,l.CH_radius2],n.cellhandles.dragpalette,d,p);if(1==f||-1==f||0==f)return void c.ShowCellHandles(!0,!1);switch(s.ignore=!0,-3==f?(c.dragtype="Fill",c.noCursorSuffix=!1):3==f?(c.dragtype="FillC",c.noCursorSuffix=!1):-2==f?(c.dragtype="Move",c.noCursorSuffix=!0):-4==f?(c.dragtype="MoveI",c.noCursorSuffix=!1):2==f?(c.dragtype="MoveC",c.noCursorSuffix=!0):4==f&&(c.dragtype="MoveIC",c.noCursorSuffix=!1),c.filltype=null,c.dragtype){case"Fill":case"FillC":a.hasrange||n.RangeAnchor(),n.range2.top=n.range.top,n.range2.right=n.range.right,n.range2.bottom=n.range.bottom,n.range2.left=n.range.left,n.range2.hasrange=!0;break;case"Move":case"MoveI":case"MoveC":case"MoveIC":a.hasrange||n.RangeAnchor(),n.range2.top=n.range.top,n.range2.right=n.range.right,n.range2.bottom=n.range.bottom,n.range2.left=n.range.left,n.range2.hasrange=!0,n.RangeRemove();break;default:return}c.fillinghandle.style.left=d+"px",c.fillinghandle.style.top=p-17+"px",c.fillinghandle.innerHTML=l.s_CHindicatorOperationLookup[c.dragtype]+(l.s_CHindicatorDirectionLookup[n.cellhandles.filltype]||""),c.fillinghandle.style.display="block",c.ShowCellHandles(!0,!1),c.mouseDown=!0,s.editor=n,r=n.ecell.coord,c.startingcoord=r,c.startingX=d,c.startingY=p,s.mouselastcoord=r,t.KeyboardSetFocus(n),document.addEventListener?(document.addEventListener("mousemove",t.CellHandlesMouseMove,!0),document.addEventListener("mouseup",t.CellHandlesMouseUp,!0)):c.draghandle.attachEvent&&(c.draghandle.setCapture(),c.draghandle.attachEvent("onmousemove",t.CellHandlesMouseMove),c.draghandle.attachEvent("onmouseup",t.CellHandlesMouseUp),c.draghandle.attachEvent("onlosecapture",t.CellHandlesMouseUp)),t.StopPropagation(i)}},t.CellHandlesMouseMove=function(o){var n,r,a,l,i,s,c,u=t.Constants,d=o||e.event,p=t.EditorMouseInfo;if(n=p.editor){var f=n.cellhandles;r=p.element;var h=t.GetElementPositionWithScroll(n.toplevel),m=d.clientX-h.left,g=d.clientY-h.top;if(a=t.GridMousePosition(n,m,g)){if(a&&!a.coord)return void t.SetDragAutoRepeat(n,a,t.CellHandlesDragAutoRepeat);if(t.SetDragAutoRepeat(n,null),a.coord){switch(l=t.coordToCr(n.cellhandles.startingcoord),i=t.coordToCr(a.coord),f.movedmouse=!0,f.dragtype){case"Fill":case"FillC":a.coord==f.startingcoord?(f.filltype=null,f.startingX=m,f.startingY=g):f.filltype?"Down"==f.filltype?(i.col=l.col,i.row<l.row&&(i.row=l.row)):(i.row=l.row,i.col<l.col&&(i.col=l.col)):(Math.abs(g-f.startingY)>10?f.filltype="Down":Math.abs(m-f.startingX)>10&&(f.filltype="Right"),i.col=l.col,i.row=l.row),a.coord=t.crToCoord(i.col,i.row),a.coord!=p.mouselastcoord&&(n.MoveECell(a.coord),n.RangeExtend());break;case"Move":case"MoveC":a.coord!=p.mouselastcoord&&(n.MoveECell(a.coord),s=n.range2.right-n.range2.left+a.col,c=n.range2.bottom-n.range2.top+a.row,n.RangeAnchor(t.crToCoord(s,c)),n.RangeExtend());break;case"MoveI":case"MoveIC":a.coord==f.startingcoord?(f.filltype=null,f.startingX=m,f.startingY=g):f.filltype?"Vertical"==f.filltype?(i.col=n.range2.left,i.row>=n.range2.top&&i.row<=n.range2.bottom+1&&(i.row=n.range2.bottom+2)):(i.row=n.range2.top,i.col>=n.range2.left&&i.col<=n.range2.right+1&&(i.col=n.range2.right+2)):(Math.abs(g-f.startingY)>10?f.filltype="Vertical":Math.abs(m-f.startingX)>10&&(f.filltype="Horizontal"),i.col=l.col,i.row=l.row),a.coord=t.crToCoord(i.col,i.row),a.coord!=p.mouselastcoord&&(n.MoveECell(a.coord),f.filltype?(s=n.range2.right-n.range2.left+i.col,c=n.range2.bottom-n.range2.top+i.row,n.RangeAnchor(t.crToCoord(s,c)),n.RangeExtend()):n.RangeRemove())}f.fillinghandle.style.left=m+"px",f.fillinghandle.style.top=g-17+"px",f.fillinghandle.innerHTML=u.s_CHindicatorOperationLookup[f.dragtype]+(u.s_CHindicatorDirectionLookup[n.cellhandles.filltype]||""),f.fillinghandle.style.display="block",p.mouselastcoord=a.coord,t.StopPropagation(d)}}}},t.CellHandlesDragAutoRepeat=function(e,o){var n=t.EditorMouseInfo,r=n.editor;if(r){var a,l,i,s=r.cellhandles,c=t.coordToCr(r.cellhandles.startingcoord),u=t.coordToCr(e),d=0,p=0;switch("left"==o?p=-1:"right"==o?p=1:"up"==o?d=-1:"down"==o&&(d=1),r.ScrollRelativeBoth(d,p),s.dragtype){case"Fill":case"FillC":s.filltype?"Down"==s.filltype?(u.col=c.col,u.row<c.row&&(u.row=c.row)):(u.row=c.row,u.col<c.col&&(u.col=c.col)):(u.col=c.col,u.row=c.row),a=t.crToCoord(u.col,u.row),a!=n.mouselastcoord&&(r.MoveECell(e),r.RangeExtend());break;case"Move":case"MoveC":e!=n.mouselastcoord&&(r.MoveECell(e),l=r.range2.right-r.range2.left+r.ecell.col,i=r.range2.bottom-r.range2.top+r.ecell.row,r.RangeAnchor(t.crToCoord(l,i)),r.RangeExtend());break;case"MoveI":case"MoveIC":s.filltype?"Vertical"==s.filltype?(u.col=r.range2.left,u.row>=r.range2.top&&u.row<=r.range2.bottom+1&&(u.row=r.range2.bottom+2)):(u.row=r.range2.top,u.col>=r.range2.left&&u.col<=r.range2.right+1&&(u.col=r.range2.right+2)):(u.col=c.col,u.row=c.row),a=t.crToCoord(u.col,u.row),a!=n.mouselastcoord&&(r.MoveECell(a),l=r.range2.right-r.range2.left+u.col,i=r.range2.bottom-r.range2.top+u.row,r.RangeAnchor(t.crToCoord(l,i)),r.RangeExtend())}n.mouselastcoord=a}},t.CellHandlesMouseUp=function(o){var n,r,a,l,i,s,c,u,d,p,f,h,m=o||e.event,g=t.EditorMouseInfo;if(n=g.editor){var v=n.cellhandles;r=g.element,g.ignore=!1;var b=t.GetElementPositionWithScroll(n.toplevel),y=m.clientX-b.left,C=m.clientY-b.top;switch(a=t.GridMousePosition(n,y,C),t.SetDragAutoRepeat(n,null),v.mouseDown=!1,v.noCursorSuffix=!1,v.fillinghandle.style.display="none",a||(a={}),a.coord||(a.coord=n.ecell.coord),v.dragtype){case"Fill":case"Move":case"MoveI":s=" all";break;case"FillC":case"MoveC":case"MoveIC":s=" formulas"}switch(v.movedmouse||(v.dragtype="Nothing"),v.dragtype){case"Nothing":n.Range2Remove(),n.RangeRemove();break;case"Fill":case"FillC":c=t.coordToCr(v.startingcoord),u=t.coordToCr(a.coord),v.filltype&&("Down"==v.filltype?u.col=c.col:u.row=c.row),a.coord=t.crToCoord(u.col,u.row),n.MoveECell(a.coord),n.RangeExtend(),i="Right"==n.cellhandles.filltype?"right":"down",l="fill"+i+" "+t.crToCoord(n.range.left,n.range.top)+":"+t.crToCoord(n.range.right,n.range.bottom)+s,n.EditorScheduleSheetCommands(l,!0,!1);break;case"Move":case"MoveC":n.context.cursorsuffix="",l="movepaste "+t.crToCoord(n.range2.left,n.range2.top)+":"+t.crToCoord(n.range2.right,n.range2.bottom)+" "+n.ecell.coord+s,n.EditorScheduleSheetCommands(l,!0,!1),n.Range2Remove();break;case"MoveI":case"MoveIC":n.context.cursorsuffix="",d=n.range2.right-n.range2.left,p=n.range2.bottom-n.range2.top,f=n.ecell.col-n.range2.left,h=n.ecell.row-n.range2.top,l="moveinsert "+t.crToCoord(n.range2.left,n.range2.top)+":"+t.crToCoord(n.range2.right,n.range2.bottom)+" "+n.ecell.coord+s,n.EditorScheduleSheetCommands(l,!0,!1),n.Range2Remove(),n.RangeRemove()," Horizontal"==n.cellhandles.filltype&&f>0?n.MoveECell(t.crToCoord(n.ecell.col-d-1,n.ecell.row)):" Vertical"==n.cellhandles.filltype&&h>0&&n.MoveECell(t.crToCoord(n.ecell.col,n.ecell.row-p-1)),n.RangeAnchor(t.crToCoord(n.ecell.col+d,n.ecell.row+p)),n.RangeExtend()}return t.RemoveMouseMoveUp(t.CellHandlesMouseMove,t.CellHandlesMouseUp,v.draghandle,m),g.editor=null,!1}},t.TableControl=function(e,o,n){var r=t.Constants;this.editor=e,this.vertical=o,this.size=n,this.main=null,this.endcap=null,this.paneslider=null,this.lessbutton=null,this.morebutton=null,this.scrollarea=null,this.thumb=null,this.controlborder=null,this.endcapstart=null,this.panesliderstart=null,this.lessbuttonstart=null,this.morebuttonstart=null,this.scrollareastart=null,this.scrollareaend=null,this.scrollareasize=null,this.thumbpos=null,this.controlthickness=r.defaultTableControlThickness,this.sliderthickness=r.defaultTCSliderThickness,this.buttonthickness=r.defaultTCButtonThickness,this.thumbthickness=r.defaultTCThumbThickness,this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20
},t.TableControl.prototype.CreateTableControl=function(){return t.CreateTableControl(this)},t.TableControl.prototype.PositionTableControlElements=function(){t.PositionTableControlElements(this)},t.TableControl.prototype.ComputeTableControlPositions=function(){t.ComputeTableControlPositions(this)},t.CreateTableControl=function(e){var o,n,r,a=t.AssignID,l=t.setStyles,i=t.Constants,s=function(o,n,r){i["s_"+n+"Tooltip"+r]&&t.TooltipRegister(o,i["s_"+n+"Tooltip"+r],null,e.editor.toplevel)},c=e.editor.imageprefix,u=e.vertical?"v":"h";return e.main=document.createElement("div"),o=e.main.style,o.height=(e.vertical?e.size:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.size)+"px",o.zIndex=0,l(e.main,i.TCmainStyle),o.backgroundImage="url("+c+"main-"+u+".gif)",i.TCmainClass&&(e.main.className=i.TCmainClass),e.main.style.display="none",e.endcap=document.createElement("div"),o=e.endcap.style,o.height=e.controlthickness+"px",o.width=e.controlthickness+"px",o.zIndex=1,o.overflow="hidden",o.position="absolute",l(e.endcap,i.TCendcapStyle),o.backgroundImage="url("+c+"endcap-"+u+".gif)",i.TCendcapClass&&(e.endcap.className=i.TCendcapClass),a(e.editor,e.endcap,"endcap"+u),e.main.appendChild(e.endcap),e.paneslider=document.createElement("div"),o=e.paneslider.style,o.height=(e.vertical?e.sliderthickness:e.controlthickness)+"px",o.overflow="hidden",o.width=(e.vertical?e.controlthickness:e.sliderthickness)+"px",o.position="absolute",o[e.vertical?"top":"left"]="4px",o.zIndex=3,o.backgroundImage="url("+c+"paneslider-"+u+".gif)",i.TCpanesliderClass&&(e.paneslider.className=i.TCpanesliderClass),a(e.editor,e.paneslider,"paneslider"+u),s(e.paneslider,"paneslider",u),n={MouseDown:t.TCPSDragFunctionStart,MouseMove:t.TCPSDragFunctionMove,MouseUp:t.TCPSDragFunctionStop,Disabled:function(){return e.editor.busy}},n.control=e,1!=t._app&&t.DragRegister(e.paneslider,e.vertical,!e.vertical,n,e.editor.toplevel),e.main.appendChild(e.paneslider),e.lessbutton=document.createElement("div"),o=e.lessbutton.style,o.height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",l(e.lessbutton,i.TClessbuttonStyle),o.backgroundImage="url("+c+"less-"+u+"n.gif)",i.TClessbuttonClass&&(e.lessbutton.className=i.TClessbuttonClass),a(e.editor,e.lessbutton,"lessbutton"+u),r={repeatwait:i.TClessbuttonRepeatWait,repeatinterval:i.TClessbuttonRepeatInterval,normalstyle:"backgroundImage:url("+c+"less-"+u+"n.gif);",downstyle:"backgroundImage:url("+c+"less-"+u+"d.gif);",hoverstyle:"backgroundImage:url("+c+"less-"+u+"h.gif);"},n={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Disabled:function(){return e.editor.busy}},t.ButtonRegister(e.editor,e.lessbutton,r,n),e.main.appendChild(e.lessbutton),e.morebutton=document.createElement("div"),o=e.morebutton.style,o.height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",l(e.morebutton,i.TCmorebuttonStyle),o.backgroundImage="url("+c+"more-"+u+"n.gif)",i.TCmorebuttonClass&&(e.morebutton.className=i.TCmorebuttonClass),a(e.editor,e.morebutton,"morebutton"+u),r={repeatwait:i.TCmorebuttonRepeatWait,repeatinterval:i.TCmorebuttonRepeatInterval,normalstyle:"backgroundImage:url("+c+"more-"+u+"n.gif);",downstyle:"backgroundImage:url("+c+"more-"+u+"d.gif);",hoverstyle:"backgroundImage:url("+c+"more-"+u+"h.gif);"},n={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Disabled:function(){return e.editor.busy}},t.ButtonRegister(e.editor,e.morebutton,r,n),e.main.appendChild(e.morebutton),e.scrollarea=document.createElement("div"),o=e.scrollarea.style,o.height=e.controlthickness+"px",o.width=e.controlthickness+"px",o.zIndex=1,o.overflow="hidden",o.position="absolute",l(e.scrollarea,i.TCscrollareaStyle),o.backgroundImage="url("+c+"scrollarea-"+u+".gif)",i.TCscrollareaClass&&(e.scrollarea.className=i.TCscrollareaClass),a(e.editor,e.scrollarea,"scrollarea"+u),r={repeatwait:i.TCscrollareaRepeatWait,repeatinterval:i.TCscrollareaRepeatWait},n={MouseDown:t.ScrollAreaClick,Repeat:t.ScrollAreaClick,Disabled:function(){return e.editor.busy}},n.control=e,t.ButtonRegister(e.editor,e.scrollarea,r,n),e.main.appendChild(e.scrollarea),e.thumb=document.createElement("div"),o=e.thumb.style,o.height=(e.vertical?e.thumbthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.thumbthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",l(e.thumb,i.TCthumbStyle),e.thumb.style.backgroundImage="url("+c+"thumb-"+u+"n.gif)",i.TCthumbClass&&(e.thumb.className=i.TCthumbClass),a(e.editor,e.thumb,"thumb"+u),n={MouseDown:t.TCTDragFunctionStart,MouseMove:t.TCTDragFunctionMove,MouseUp:t.TCTDragFunctionStop,Disabled:function(){return e.editor.busy}},n.control=e,1!=t._app&&t.DragRegister(e.thumb,e.vertical,!e.vertical,n,e.editor.toplevel),r={normalstyle:"backgroundImage:url("+c+"thumb-"+u+"n.gif)",name:"Thumb",downstyle:"backgroundImage:url("+c+"thumb-"+u+"d.gif)",hoverstyle:"backgroundImage:url("+c+"thumb-"+u+"h.gif)"},t.ButtonRegister(e.editor,e.thumb,r,null),e.main.appendChild(e.thumb),e.main},t.ScrollAreaClick=function(e,o,n){var r=n.functionobj.control,a=t.GetElementPositionWithScroll(r.editor.toplevel),l=r.vertical?o.clientY-a.top:o.clientX-a.left;r.editor.busy||r.editor.PageRelative(r.vertical,l>r.thumbpos?1:-1)},t.PositionTableControlElements=function(e){var t,o,n,r=e.editor;e.vertical?(t=e.controlborder+"px",e.endcap.style.top=e.endcapstart+"px",e.endcap.style.left=t,e.paneslider.style.top=e.panesliderstart+"px",e.paneslider.style.left=t,e.lessbutton.style.top=e.lessbuttonstart+"px",e.lessbutton.style.left=t,e.morebutton.style.top=e.morebuttonstart+"px",e.morebutton.style.left=t,e.scrollarea.style.top=e.scrollareastart+"px",e.scrollarea.style.left=t,e.scrollarea.style.height=e.scrollareasize+"px",o=Math.max(r.context.sheetobj.attribs.lastrow,r.firstscrollingrow+1),n=(r.firstscrollingrow-(r.lastnonscrollingrow+1))*(e.scrollareasize-3*e.thumbthickness)/(o-(r.lastnonscrollingrow+1))+e.scrollareastart-1,n=Math.floor(n),e.thumb.style.top=n+"px",e.thumb.style.left=t):(t=e.controlborder+"px",e.endcap.style.left=e.endcapstart+"px",e.endcap.style.top=t,e.paneslider.style.left=e.panesliderstart+"px",e.paneslider.style.top=t,e.lessbutton.style.left=e.lessbuttonstart+"px",e.lessbutton.style.top=t,e.morebutton.style.left=e.morebuttonstart+"px",e.morebutton.style.top=t,e.scrollarea.style.left=e.scrollareastart+"px",e.scrollarea.style.top=t,e.scrollarea.style.width=e.scrollareasize+"px",o=Math.max(r.context.sheetobj.attribs.lastcol,r.firstscrollingcol+1),n=(r.firstscrollingcol-(r.lastnonscrollingcol+1))*(e.scrollareasize-e.thumbthickness)/(o-r.lastnonscrollingcol)+e.scrollareastart-1,n=Math.floor(n),e.thumb.style.left=n+"px",e.thumb.style.top=t),e.thumbpos=n,e.main.style.display="block"},t.ComputeTableControlPositions=function(e){var t=e.editor;if(!t.gridposition||!t.headposition)throw"Can't compute table control positions before editor positions";e.vertical?(e.controlborder=t.gridposition.left+t.tablewidth,e.endcapstart=t.gridposition.top,e.panesliderstart=t.firstscrollingrowtop-e.sliderthickness,e.lessbuttonstart=t.firstscrollingrowtop-1,e.morebuttonstart=t.gridposition.top+t.tableheight-e.buttonthickness,e.scrollareastart=t.firstscrollingrowtop-1+e.buttonthickness,e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1):(e.controlborder=t.gridposition.top+t.tableheight,e.endcapstart=t.gridposition.left,e.panesliderstart=t.firstscrollingcolleft-e.sliderthickness,e.lessbuttonstart=t.firstscrollingcolleft-1,e.morebuttonstart=t.gridposition.left+t.tablewidth-e.buttonthickness,e.scrollareastart=t.firstscrollingcolleft-1+e.buttonthickness,e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1)},t.TCPSDragFunctionStart=function(e,o,n){var r=n.functionobj.control.editor,a=t.Constants;t.DragFunctionStart(e,o,n),o.trackingline=document.createElement("div"),o.trackingline.style.height=n.vertical?a.TCPStrackinglineThickness:r.tableheight-(r.headposition.top-r.gridposition.top)+"px",o.trackingline.style.width=n.vertical?r.tablewidth-(r.headposition.left-r.gridposition.left)+"px":a.TCPStrackinglineThickness,o.trackingline.style.backgroundImage="url("+r.imageprefix+"trackingline-"+(n.vertical?"v":"h")+".gif)",a.TCPStrackinglineClass&&(o.trackingline.className=a.TCPStrackinglineClass),t.setStyles(o.trackingline,a.TCPStrackinglineStyle),n.vertical?(row=t.Lookup(o.clientY+n.functionobj.control.sliderthickness,r.rowpositions),o.trackingline.style.top=(r.rowpositions[row]||r.headposition.top)+"px",o.trackingline.style.left=r.headposition.left+"px",o.trackingline.id="trackingline-vertical",r.context.rowpanes.length-1&&(r.context.SetRowPaneFirstLast(1,r.context.rowpanes[0].last+1,r.context.rowpanes[0].last+1),r.FitToEditTable(),r.ScheduleRender())):(col=t.Lookup(o.clientX+n.functionobj.control.sliderthickness,r.colpositions),o.trackingline.style.top=r.headposition.top+"px",o.trackingline.style.left=(r.colpositions[col]||r.headposition.left)+"px",o.trackingline.id="trackingline-horizon",r.context.colpanes.length-1&&(r.context.SetColPaneFirstLast(1,r.context.colpanes[0].last+1,r.context.colpanes[0].last+1),r.FitToEditTable(),r.ScheduleRender())),r.griddiv.appendChild(o.trackingline)},t.TCPSDragFunctionMove=function(e,o,n){var r,a,l,i,s=n.functionobj.control,c=s.sliderthickness,u=s.editor;if(n.vertical){for(l=s.morebuttonstart-s.minscrollingpanesize-o.offsetY,o.clientY>l&&(o.clientY=l),i=u.headposition.top-c-o.offsetY,o.clientY<i&&(o.clientY=i),r=t.Lookup(o.clientY+c,u.rowpositions);"yes"==u.context.sheetobj.rowattribs.hide[r];)r++;o.trackingline.style.top=(u.rowpositions[r]||u.headposition.top)+"px"}else{for(l=s.morebuttonstart-s.minscrollingpanesize-o.offsetX,o.clientX>l&&(o.clientX=l),i=u.headposition.left-c-o.offsetX,o.clientX<i&&(o.clientX=i),a=t.Lookup(o.clientX+c,u.colpositions);"yes"==u.context.sheetobj.colattribs.hide[t.rcColname(a)];)a++;o.trackingline.style.left=(u.colpositions[a]||u.headposition.left)+"px"}t.DragFunctionPosition(e,o,n)},t.TCPSDragFunctionStop=function(e,o,n){var r,a,l,i,s=n.functionobj.control,c=s.sliderthickness,u=s.editor;if(n.vertical){for(l=s.morebuttonstart-s.minscrollingpanesize-o.offsetY,o.clientY>l&&(o.clientY=l),i=u.headposition.top-c-o.offsetY,o.clientY<i&&(o.clientY=i),r=t.Lookup(o.clientY+c,u.rowpositions),r>u.context.sheetobj.attribs.lastrow&&(r=u.context.sheetobj.attribs.lastrow);"yes"==u.context.sheetobj.rowattribs.hide[r];)r++;u.EditorScheduleSheetCommands("pane row "+r,!0,!1)}else{for(l=s.morebuttonstart-s.minscrollingpanesize-o.offsetX,o.clientX>l&&(o.clientX=l),i=u.headposition.left-c-o.offsetX,o.clientX<i&&(o.clientX=i),a=t.Lookup(o.clientX+c,u.colpositions),a>u.context.sheetobj.attribs.lastcol&&(a=u.context.sheetobj.attribs.lastcol);"yes"==u.context.sheetobj.colattribs.hide[t.rcColname(a)];)a++;u.EditorScheduleSheetCommands("pane col "+a,!0,!1)}},t.TCTDragFunctionStart=function(e,o,n){var r=n.functionobj.control,a=r.editor,l=t.Constants;if(t.DragFunctionStart(e,o,n),o.thumbstatus&&(o.thumbstatus.rowmsgele&&(o.thumbstatus.rowmsgele=null),o.thumbstatus.rowpreviewele&&(o.thumbstatus.rowpreviewele=null),a.toplevel.removeChild(o.thumbstatus),o.thumbstatus=null),o.thumbstatus=document.createElement("div"),n.vertical){l.TCTDFSthumbstatusvClass&&(o.thumbstatus.className=l.TCTDFSthumbstatusvClass),t.setStyles(o.thumbstatus,l.TCTDFSthumbstatusvStyle),o.thumbstatus.style.top=o.clientY+l.TCTDFStopOffsetv+"px",o.thumbstatus.style.left=r.controlborder-10-a.tablewidth/2+"px",o.thumbstatus.style.width=a.tablewidth/2+"px",o.thumbcontext=new t.RenderContext(a.context.sheetobj),o.thumbcontext.showGrid=!0,o.thumbcontext.rowpanes=[{first:1,last:1}];var i=a.context.colpanes[a.context.colpanes.length-1];o.thumbcontext.colpanes=[{first:i.first,last:i.last}],o.thumbstatus.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td valign="top" style="'+l.TCTDFSthumbstatusrownumStyle+'" class="'+l.TCTDFSthumbstatusrownumClass+'"><div>msg</div></td><td valign="top"><div style="overflow:hidden;">preview</div></td></tr></table>',o.thumbstatus.rowmsgele=o.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild,o.thumbstatus.rowpreviewele=o.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild,a.toplevel.appendChild(o.thumbstatus),t.TCTDragFunctionRowSetStatus(o,a,a.firstscrollingrow||1)}else l.TCTDFSthumbstatushClass&&(o.thumbstatus.className=l.TCTDFSthumbstatushClass),t.setStyles(o.thumbstatus,l.TCTDFSthumbstatushStyle),o.thumbstatus.style.top=r.controlborder+l.TCTDFStopOffseth+"px",o.thumbstatus.style.left=o.clientX+l.TCTDFSleftOffseth+"px",a.toplevel.appendChild(o.thumbstatus),o.thumbstatus.innerHTML=l.s_TCTDFthumbstatusPrefixh+t.rcColname(a.firstscrollingcol)},t.TCTDragFunctionRowSetStatus=function(e,o,n){var r=t.Constants,a=r.s_TCTDFthumbstatusPrefixv+n+" ";e.thumbstatus.rowmsgele.innerHTML=a,e.thumbcontext.rowpanes=[{first:n,last:n}],e.thumbrowshown=n;e.thumbcontext.RenderSheet(e.thumbstatus.rowpreviewele.firstChild,{type:"html"})},t.TCTDragFunctionMove=function(e,o,n){var r,a,l=n.functionobj.control,i=(l.thumbthickness,l.editor),s=t.Constants;n.vertical?(o.clientY>l.scrollareaend-o.offsetY-l.thumbthickness+2&&(o.clientY=l.scrollareaend-o.offsetY-l.thumbthickness+2),o.clientY<l.scrollareastart-o.offsetY-1&&(o.clientY=l.scrollareastart-o.offsetY-1),o.thumbstatus.style.top=o.clientY+"px",r=(o.clientY+o.offsetY-l.scrollareastart+1)/(l.scrollareasize-l.thumbthickness)*(i.context.sheetobj.attribs.lastrow-i.lastnonscrollingrow)+i.lastnonscrollingrow+1,r=Math.floor(r),r<=i.lastnonscrollingrow&&(r=i.lastnonscrollingrow+1),r>i.context.sheetobj.attribs.lastrow&&(r=i.context.sheetobj.attribs.lastrow),r!=o.thumbrowshown&&t.TCTDragFunctionRowSetStatus(o,i,r)):(o.clientX>l.scrollareaend-o.offsetX-l.thumbthickness+2&&(o.clientX=l.scrollareaend-o.offsetX-l.thumbthickness+2),o.clientX<l.scrollareastart-o.offsetX-1&&(o.clientX=l.scrollareastart-o.offsetX-1),o.thumbstatus.style.left=o.clientX+"px",r=(o.clientX+o.offsetX-l.scrollareastart+1)/(l.scrollareasize-l.thumbthickness)*(i.context.sheetobj.attribs.lastcol-i.lastnonscrollingcol)+i.lastnonscrollingcol+1,r=Math.floor(r),r<=i.lastnonscrollingcol&&(r=i.lastnonscrollingcol+1),r>i.context.sheetobj.attribs.lastcol&&(r=i.context.sheetobj.attribs.lastcol),a=s.s_TCTDFthumbstatusPrefixh+t.rcColname(r),o.thumbstatus.innerHTML=a),t.DragFunctionPosition(e,o,n)},t.TCTDragFunctionStop=function(e,t,o){var n,r=o.functionobj.control,a=r.editor;o.vertical?(n=(t.clientY+t.offsetY-r.scrollareastart+1)/(r.scrollareasize-r.thumbthickness)*(a.context.sheetobj.attribs.lastrow-a.lastnonscrollingrow)+a.lastnonscrollingrow+1,n=Math.floor(n),n<=a.lastnonscrollingrow&&(n=a.lastnonscrollingrow+1),n>a.context.sheetobj.attribs.lastrow&&(n=a.context.sheetobj.attribs.lastrow),a.context.SetRowPaneFirstLast(a.context.rowpanes.length-1,n,n+1)):(n=(t.clientX+t.offsetX-r.scrollareastart+1)/(r.scrollareasize-r.thumbthickness)*(a.context.sheetobj.attribs.lastcol-a.lastnonscrollingcol)+a.lastnonscrollingcol+1,n=Math.floor(n),n<=a.lastnonscrollingcol&&(n=a.lastnonscrollingcol+1),n>a.context.sheetobj.attribs.lastcol&&(n=a.context.sheetobj.attribs.lastcol),a.context.SetColPaneFirstLast(a.context.colpanes.length-1,n,n+1)),a.FitToEditTable(),t.thumbstatus.rowmsgele&&(t.thumbstatus.rowmsgele=null),t.thumbstatus.rowpreviewele&&(t.thumbstatus.rowpreviewele=null),a.toplevel.removeChild(t.thumbstatus),t.thumbstatus=null,a.ScheduleRender()},t.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,relativeOffset:{left:0,top:0}},t.DragRegister=function(e,o,n,r,a){var l=t.DragInfo;if(r||(r={MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null}),l.registeredElements.push({element:e,vertical:o,horizontal:n,functionobj:r,parent:a}),e.addEventListener)e.addEventListener("mousedown",t.DragMouseDown,!1);else{if(!e.attachEvent)throw t.Constants.s_BrowserNotSupported;e.attachEvent("onmousedown",t.DragMouseDown)}},t.DragUnregister=function(e){var o,n=t.DragInfo;if(e)for(o=0;o<n.registeredElements.length;o++)if(n.registeredElements[o].element==e)return n.registeredElements.splice(o,1),void(e.removeEventListener?e.removeEventListener("mousedown",t.DragMouseDown,!1):e.detachEvent("onmousedown",t.DragMouseDown))},t.DragMouseDown=function(o){var n=o||e.event,r=t.DragInfo,a=t.LookupElement(n.target||n.srcElement,r.registeredElements);return!a||a&&a.functionobj&&a.functionobj.Disabled&&a.functionobj.Disabled(n,r,a)?void 0:(r.draggingElement=a,a.parent&&(r.relativeOffset=t.GetElementPositionWithScroll(a.parent)),r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,r.startX=r.clientX,r.startY=r.clientY,r.startZ=a.element.style.zIndex,r.offsetX=0,r.offsetY=0,a.element.style.zIndex="100",t.SetMouseMoveUp(t.DragMouseMove,t.DragMouseUp,a.element,n),a&&a.functionobj&&a.functionobj.MouseDown&&a.functionobj.MouseDown(n,r,a),!1)},t.DragMouseMove=function(o){var n=o||e.event,r=t.DragInfo,a=r.draggingElement;return r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,t.StopPropagation(n),a&&a.functionobj&&a.functionobj.MouseMove&&a.functionobj.MouseMove(n,r,a),!1},t.DragMouseUp=function(o){var n=o||e.event,r=t.DragInfo,a=r.draggingElement;return r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,a.element.style.zIndex=r.startZ,a&&a.functionobj&&a.functionobj.MouseUp&&a.functionobj.MouseUp(n,r,a),t.RemoveMouseMoveUp(t.DragMouseMove,t.DragMouseUp,a.element,n),r.draggingElement=null,!1},t.DragFunctionStart=function(e,t,o){var n=o.functionobj.positionobj||o.element;t.offsetY=parseInt(n.style.top)-t.clientY,t.offsetX=parseInt(n.style.left)-t.clientX},t.DragFunctionPosition=function(e,t,o){var n=o.functionobj.positionobj||o.element;o.vertical&&(n.style.top=t.clientY+t.offsetY+"px"),o.horizontal&&(n.style.left=t.clientX+t.offsetX+"px")},t.TooltipInfo={registeredElements:[],registered:!1,tooltipElement:null,timer:null,popupElement:null,clientX:0,clientY:0,offsetX:t.Constants.TooltipOffsetX,offsetY:t.Constants.TooltipOffsetY},t.TooltipRegister=function(e,o,n,r){var a=t.TooltipInfo;if(a.registeredElements.push({element:e,tiptext:o,functionobj:n,parent:r}),!a.registered){if(document.addEventListener)document.addEventListener("mousemove",t.TooltipMouseMove,!1);else{if(!document.attachEvent)throw t.Constants.s_BrowserNotSupported;document.attachEvent("onmousemove",t.TooltipMouseMove)}a.registered=!0}},t.TooltipMouseMove=function(o){var n=o||e.event,r=t.TooltipInfo;r.clientX=n.clientX,r.clientY=n.clientY;var a=t.LookupElement(n.target||n.srcElement,r.registeredElements);r.timer&&(e.clearTimeout(r.timer),r.timer=null),r.popupElement&&t.TooltipHide(),r.tooltipElement=a||null,a&&!t.ButtonInfo.buttonDown&&(r.timer=e.setTimeout(t.TooltipWaitDone,700),r.tooltipElement.element.addEventListener?r.tooltipElement.element.addEventListener("mousedown",t.TooltipMouseDown,!1):r.tooltipElement.element.attachEvent&&r.tooltipElement.element.attachEvent("onmousedown",t.TooltipMouseDown))},t.TooltipMouseDown=function(o){var n=(o||e.event,t.TooltipInfo);n.timer&&(e.clearTimeout(n.timer),n.timer=null),n.popupElement&&t.TooltipHide(),n.tooltipElement&&(n.tooltipElement.element.removeEventListener?n.tooltipElement.element.removeEventListener("mousedown",t.TooltipMouseDown,!1):n.tooltipElement.element.attachEvent&&n.tooltipElement.element.detachEvent("onmousedown",t.TooltipMouseDown),n.tooltipElement=null)},t.TooltipDisplay=function(e){var o=t.TooltipInfo,n=t.Constants,r=e.functionobj&&"number"==typeof e.functionobj.offsetx?e.functionobj.offsetx:o.offsetX,a=e.functionobj&&"number"==typeof e.functionobj.offsety?e.functionobj.offsety:o.offsetY,l=t.GetViewportInfo(),i=t.GetElementPositionWithScroll(e.parent);o.popupElement=document.createElement("div"),n.TDpopupElementClass&&(o.popupElement.className=n.TDpopupElementClass),t.setStyles(o.popupElement,n.TDpopupElementStyle),o.popupElement.innerHTML=e.tiptext,o.clientX>l.width/2?(o.popupElement.style.bottom=i.height-o.clientY+a+i.top+"px",o.popupElement.style.right=i.width-o.clientX+r+i.left+"px"):(o.popupElement.style.bottom=i.height-o.clientY+a+i.top+"px",o.popupElement.style.left=o.clientX+r-i.left+"px"),o.clientY<50&&(o.popupElement.style.bottom=i.height-o.clientY+a-50+i.top+"px"),e.parent.appendChild(o.popupElement)},t.TooltipHide=function(){var e=t.TooltipInfo;e.popupElement&&(e.popupElement.parentNode.removeChild(e.popupElement),e.popupElement=null)},t.TooltipWaitDone=function(){var e=t.TooltipInfo;e.timer=null,t.TooltipDisplay(e.tooltipElement)},t.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,relativeOffset:null,clientX:0,clientY:0},t.ButtonRegister=function(e,o,n,r){var a=t.ButtonInfo;if(n||(n={}),a.registeredElements.push({name:n.name,element:o,editor:e,normalstyle:n.normalstyle,hoverstyle:n.hoverstyle,downstyle:n.downstyle,repeatwait:n.repeatwait,repeatinterval:n.repeatinterval,functionobj:r}),o.addEventListener)o.addEventListener("mousedown",t.ButtonMouseDown,!1),o.addEventListener("mouseover",t.ButtonMouseOver,!1),o.addEventListener("mouseout",t.ButtonMouseOut,!1);else{if(!o.attachEvent)throw t.Constants.s_BrowserNotSupported;o.attachEvent("onmousedown",t.ButtonMouseDown),o.attachEvent("onmouseover",t.ButtonMouseOver),o.attachEvent("onmouseout",t.ButtonMouseOut)}},t.ButtonMouseOver=function(o){var n=o||e.event,r=t.ButtonInfo,a=t.LookupElement(n.target||n.srcElement,r.registeredElements);if(a){if(r.buttonDown)return void(r.buttonElement==a&&(r.doingHover=!0));r.buttonElement&&r.buttonElement!=a&&r.doingHover&&t.setStyles(r.buttonElement.element,r.buttonElement.normalstyle),r.buttonElement=a,r.doingHover=!0,t.setStyles(a.element,a.hoverstyle),a&&a.functionobj&&a.functionobj.MouseOver&&a.functionobj.MouseOver(n,r,a)}},t.ButtonMouseOut=function(o){var n=o||e.event,r=t.ButtonInfo;if(r.buttonDown)return void(r.doingHover=!1);var a=t.LookupElement(n.target||n.srcElement,r.registeredElements);r.doingHover&&(r.buttonElement&&t.setStyles(r.buttonElement.element,r.buttonElement.normalstyle),r.buttonElement=null,r.doingHover=!1),a&&a.functionobj&&a.functionobj.MouseOut&&a.functionobj.MouseOut(n,r,a)},t.ButtonMouseDown=function(o){var n=o||e.event,r=t.ButtonInfo,a=(t.GetViewportInfo(),t.LookupElement(n.target||n.srcElement,r.registeredElements));a&&(a&&a.functionobj&&a.functionobj.Disabled&&a.functionobj.Disabled(n,r,a)||(r.buttonElement=a,r.buttonDown=!0,t.setStyles(a.element,r.buttonElement.downstyle),document.addEventListener?document.addEventListener("mouseup",t.ButtonMouseUp,!0):a.element.attachEvent&&(a.element.setCapture(),a.element.attachEvent("onmouseup",t.ButtonMouseUp),a.element.attachEvent("onlosecapture",t.ButtonMouseUp)),t.StopPropagation(n),r.relativeOffset=t.GetElementPositionWithScroll(a.editor.toplevel),r.clientX=n.clientX-r.relativeOffset.left,r.clientY=n.clientY-r.relativeOffset.top,a&&a.functionobj&&a.functionobj.MouseDown&&a.functionobj.MouseDown(n,r,a),a.repeatwait&&(r.timer=e.setTimeout(t.ButtonRepeat,a.repeatwait))))},t.ButtonMouseUp=function(o){var n=o||e.event,r=t.ButtonInfo,a=r.buttonElement;r.timer&&(e.clearTimeout(r.timer),r.timer=null),r.buttonDown&&(t.StopPropagation(n),document.removeEventListener?document.removeEventListener("mouseup",t.ButtonMouseUp,!0):document.detachEvent&&(a.element.detachEvent("onlosecapture",t.ButtonMouseUp),a.element.detachEvent("onmouseup",t.ButtonMouseUp),a.element.releaseCapture()),r.buttonElement.downstyle&&(r.doingHover?t.setStyles(a.element,r.buttonElement.hoverstyle):t.setStyles(a.element,r.buttonElement.normalstyle)),r.buttonDown=!1,a&&a.functionobj&&a.functionobj.MouseUp&&a.functionobj.MouseUp(n,r,a))},t.ButtonRepeat=function(){var o=t.ButtonInfo,n=o.buttonElement;n&&(n&&n.functionobj&&n.functionobj.Repeat&&n.functionobj.Repeat(null,o,n),o.timer=e.setTimeout(t.ButtonRepeat,n.repeatinterval||100))},t.MouseWheelInfo={registeredElements:[]},t.MouseWheelRegister=function(e,o){var n=t.MouseWheelInfo;if(n.registeredElements.push({element:e,functionobj:o}),e.addEventListener)e.addEventListener("DOMMouseScroll",t.ProcessMouseWheel,!1),e.addEventListener("mousewheel",t.ProcessMouseWheel,!1);else{if(!e.attachEvent)throw t.Constants.s_BrowserNotSupported;e.attachEvent("onmousewheel",t.ProcessMouseWheel)}},t.ProcessMouseWheel=function(o){var n,r=o||e.event;if(!t.Keyboard.passThru){var a,l=t.MouseWheelInfo,i=r.target||r.srcElement;for(a=null;!a&&i;i=i.parentNode)a=t.LookupElement(i,l.registeredElements);a&&(n=r.wheelDelta?r.wheelDelta/120:-r.detail/3,n||(n=0),a.functionobj&&a.functionobj.WheelMove&&a.functionobj.WheelMove(r,n,l,a),r.preventDefault&&r.preventDefault(),r.returnValue=!1)}},t.keyboardTables={specialKeysCommon:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},specialKeysIE:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysIE:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysOpera:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysOpera:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysSafari:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",63232:"[aup]",63233:"[adown]",63234:"[aleft]",63235:"[aright]",63272:"[del]",63273:"[home]",63275:"[end]",63276:"[pgup]",63277:"[pgdn]",63237:"[f2]"},controlKeysSafari:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysSafari:{63236:"[f1]",63238:"[f3]",63239:"[f4]",63240:"[f5]",63241:"[f6]",63242:"[f7]",63243:"[f8]",63244:"[f9]",63245:"[f10]",63246:"[f11]",63247:"[f12]",63289:"[numlock]"},specialKeysFirefox:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysFirefox:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysFirefox:{16:"[shift]",17:"[ctrl]",18:"[alt]",20:"[capslock]",19:"[pause]",44:"[printscreen]",91:"[windows]",92:"[windows]",112:"[f1]",114:"[f3]",115:"[f4]",116:"[f5]",117:"[f6]",118:"[f7]",119:"[f8]",120:"[f9]",121:"[f10]",122:"[f11]",123:"[f12]",144:"[numlock]",145:"[scrolllock]",224:"[cmd]"}},t.Keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:""},t.KeyboardSetFocus=function(o){t.Keyboard.focusTable=o,t.Keyboard.areListener||(document.onkeydown=t.ProcessKeyDown,document.onkeypress=t.ProcessKeyPress,t.Keyboard.areListener=!0),t.Keyboard.passThru&&(t.Keyboard.passThru.blur&&t.Keyboard.passThru.blur(),t.Keyboard.passThru=null),e.focus()},t.KeyboardFocus=function(){t.Keyboard.passThru=null,e.focus()},t.ProcessKeyDown=function(o){var n=t.keyboardTables;n.didProcessKey=!1,n.statusFromProcessKey=!1,n.repeatingKeyPress=!1;var r="",a=!0;if(!t._app&&!t.Keyboard.passThru){if(o=o||e.event,void 0==o.which){if(r=n.specialKeysCommon[o.keyCode],!r&&(o.ctrlKey&&(r=n.controlKeysIE[o.keyCode]),!r))return!0;a=t.ProcessKey(r,o),a||(o.preventDefault&&o.preventDefault(),o.returnValue=!1)}else{if(r=n.specialKeysCommon[o.keyCode],!r&&((o.ctrlKey||o.metaKey)&&(r=n.controlKeysIE[o.keyCode]),!r))return!0;a=t.ProcessKey(r,o),n.didProcessKey=!0,n.statusFromProcessKey=a,n.chForProcessKey=r}return a}},t.ProcessKeyPress=function(o){var n=t.keyboardTables,r="";if(o=o||e.event,!t._app&&!t.Keyboard.passThru){if(n.didProcessKey)return n.repeatingKeyPress?t.ProcessKey(n.chForProcessKey,o):(n.repeatingKeyPress=!0,n.statusFromProcessKey);if(void 0==o.which)r=String.fromCharCode(o.keyCode);else{if(!o.which)return!1;if(void 0==o.charCode){if(0==o.which)return!0;if(o.which<32||144==o.which){if(r=n.specialKeysOpera[o.which])return!0}else r=o.ctrlKey?n.controlKeysOpera[o.keyCode]:String.fromCharCode(o.which)}else{if(0==o.keyCode&&0==o.charCode)return;if(o.keyCode==o.charCode){if(r=n.specialKeysSafari[o.keyCode],!r){if(n.ignoreKeysSafari[o.keyCode])return!0;r=o.metaKey?n.controlKeysSafari[o.keyCode]:String.fromCharCode(o.which)}}else{if(n.specialKeysFirefox[o.keyCode])return!0;r=String.fromCharCode(o.which),(o.ctrlKey||o.metaKey)&&(r=n.controlKeysFirefox[o.which])}}}var a=t.ProcessKey(r,o);return a||(o.preventDefault&&o.preventDefault(),o.returnValue=!1),a}},t.ProcessKey=function(e,o){var n=t.Keyboard.focusTable;return n?n.EditorProcessKey(e,o):!0};var t;t||(t={}),t.FormatNumber={},t.FormatNumber.format_definitions={},t.FormatNumber.separatorchar=",",t.FormatNumber.decimalchar=".",t.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"],t.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},t.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"},t.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},t.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600},t.FormatNumber.formatNumberWithFormat=function(e,o,n){var r,a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C,x,w,S,T,F,E,k,_,A,P,R,L,M,D,N,I,O,B,U,z,H,j,G=t.Constants,V=t.FormatNumber,W="";if("string"==typeof e&&!e.length)return"";if(j=e-0,!isFinite(j))return"string"==typeof e?V.formatTextWithFormat(e,o):"NaN";e=j;var $=0>j?1:0;$&&(j=-j);var X=0==j?1:0;if(n=n||G.FormatNumber_DefaultCurrency,V.parse_format_string(V.format_definitions,o),C=V.format_definitions[o],!C)throw"Format not parsed error!";if(x=C.sectioninfo.length-1,C.hascomparison)for(x=0,w=0,F=0;;F++){if(r=C.operators[F],a=C.operands[F],!r){w&&(o="General",V.parse_format_string(V.format_definitions,o),C=V.format_definitions[o],x=0);break}if(r!=V.commands.section){if(r==V.commands.comparison){if(_=a.indexOf(":"),S=a.substring(0,_),T=a.substring(_+1)-0,"<"==S&&T>e||"<="==S&&T>=e||"="==S&&e==T||"<>"==S&&e!=T||">="==S&&e>=T||">"==S&&e>T)break;w=1}}else{if(!w)break;w=0,x++}}else x>0&&(1==x?$?($=0,x=1):x=0:(2==x||3==x)&&($?($=0,x=1):x=X?2:0));if(k=C.sectioninfo[x],k.commas>0)for(_=0;_<k.commas;_++)j/=1e3;if(k.percent>0)for(_=0;_<k.percent;_++)j*=100;for(A=1,_=0;_<k.fractiondigits;_++)A*=10;if(P=Math.floor(j*A+.5),P/=A,"number"!=typeof P)return"NaN";if(!isFinite(P))return"NaN";if(R=P+"",0==P&&(k.fractiondigits||k.integerdigits)&&($=0),R.indexOf("e")>=0)return e+"";if(L=R.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!L)return"NaN";if(M=L[1],M&&"0"!=M||(M=""),D=L[2],D||(D=""),k.hasdate){if(0>e)return"??-???-??&nbsp;??:??:??";for(c=(e-Math.floor(e))*V.datevalues.seconds_in_a_day,u=e*V.datevalues.seconds_in_a_day,d=Math.floor(c/V.datevalues.seconds_in_an_hour),h=Math.floor(u/V.datevalues.seconds_in_an_hour),c-=d*V.datevalues.seconds_in_an_hour,p=Math.floor(c/60),m=Math.floor(u/60),f=c-60*p,A=1,_=0;_<k.fractiondigits;_++)A*=10;
for(f=Math.floor(f*A+.5),f/=A,g=Math.floor(u*A+.5),g/=A,f>=60&&(f=0,p++,m++,p>=60&&(p=0,d++,h++,d>=24&&(d=0,e++))),D=f-Math.floor(f)+"",D=D.substring(2),b=t.FormatNumber.convert_date_julian_to_gregorian(Math.floor(e+V.datevalues.julian_offset)),y=0,mspos=k.sectionstart;(r=C.operators[mspos],a=C.operands[mspos],r)&&r!=V.commands.section;mspos++)r==V.commands.date?("am/pm"!=a.toLowerCase()&&"a/p"!=a.toLowerCase()||v||(d>=12?(d-=12,v="a/p"==a.toLowerCase()?G.s_FormatNumber_pm1:G.s_FormatNumber_pm):v="a/p"==a.toLowerCase()?G.s_FormatNumber_am1:G.s_FormatNumber_am,a.indexOf(v)<0&&(v=v.toLowerCase())),!y||"m"!=a&&"mm"!=a||(C.operands[mspos]+="in"),y="h"==a.charAt(0)?1:0):r!=V.commands.copy&&(y=0);for(y=0,--mspos;(r=C.operators[mspos],a=C.operands[mspos],r)&&r!=V.commands.section;mspos--)r==V.commands.date?(!y||"m"!=a&&"mm"!=a||(C.operands[mspos]+="in"),y="ss"==a?1:0):r!=V.commands.copy&&(y=0)}for(N=0,I=0,O=0,B="",U="",z=G.FormatNumber_separatorchar,z.indexOf(" ")>=0&&(z=z.replace(/ /g,"&nbsp;")),H=G.FormatNumber_decimalchar,H.indexOf(" ")>=0&&(H=H.replace(/ /g,"&nbsp;")),E=k.sectionstart;r=C.operators[E];)if(a=C.operands[E++],r==V.commands.copy)W+=a;else if(r==V.commands.color)B=a;else if(r==V.commands.style)U=a;else if(r==V.commands.integer_placeholder){if($&&(W+="-",$=0),N++,1==N&&M.length>k.integerdigits)for(;I<M.length-k.integerdigits;I++)W+=M.charAt(I),k.thousandssep&&(l=M.length-I-1,l>2&&l%3==0&&(W+=z));M.length<k.integerdigits&&N<=k.integerdigits-M.length?("0"==a||"?"==a)&&(W+="0"==a?"0":"&nbsp;",k.thousandssep&&(l=k.integerdigits-N,l>2&&l%3==0&&(W+=z))):(W+=M.charAt(I),k.thousandssep&&(l=M.length-I-1,l>2&&l%3==0&&(W+=z)),I++)}else if(r==V.commands.fraction_placeholder)O>=D.length?("0"==a||"?"==a)&&(W+="0"==a?"0":"&nbsp;"):W+=D.charAt(O),O++;else if(r==V.commands.decimal)$&&(W+="-",$=0),W+=H;else if(r==V.commands.currency)$&&(W+="-",$=0),W+=a;else if(r==V.commands.general){if(0!=j){var K=Math.floor(Math.LOG10E*Math.log(j));if(K=Math.pow(10,13-K),j=Math.floor(K*j+.5)/K,!isFinite(j))return"NaN"}if($&&(W+="-"),R=j+"",R.indexOf("e")>=0){W+=R;continue}if(L=R.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),M=L[1],M&&"0"!=M||(M=""),D=L[2],D||(D=""),I=0,O=0,M.length)for(;I<M.length;I++)W+=M.charAt(I),k.thousandssep&&(l=M.length-I-1,l>2&&l%3==0&&(W+=z));else W+="0";if(D.length)for(W+=H;O<D.length;O++)W+=D.charAt(O)}else if(r==V.commands.date)s=a.toLowerCase(),"y"==s||"yy"==s?W+=(b.year+"").substring(2):"yyyy"==s?W+=b.year+"":"d"==s?W+=b.day+"":"dd"==s?(i=1e3+b.day,W+=(i+"").substr(2)):"ddd"==s?(i=Math.floor(e+6)%7,W+=G.s_FormatNumber_daynames3[i]):"dddd"==s?(i=Math.floor(e+6)%7,W+=G.s_FormatNumber_daynames[i]):"m"==s?W+=b.month+"":"mm"==s?(i=1e3+b.month,W+=(i+"").substr(2)):"mmm"==s?W+=G.s_FormatNumber_monthnames3[b.month-1]:"mmmm"==s?W+=G.s_FormatNumber_monthnames[b.month-1]:"mmmmm"==s?W+=G.s_FormatNumber_monthnames[b.month-1].charAt(0):"h"==s?W+=d+"":"h]"==s?W+=h+"":"mmin"==s?(i=1e3+p+"",W+=i.substr(2)):"mm]"==s?100>m?(i=1e3+m+"",W+=i.substr(2)):W+=m+"":"min"==s?W+=p+"":"m]"==s?W+=m+"":"hh"==s?(i=1e3+d+"",W+=i.substr(2)):"s"==s?(i=Math.floor(f),W+=i+""):"ss"==s?(i=1e3+Math.floor(f)+"",W+=i.substr(2)):"am/pm"==s||"a/p"==s?W+=v:"ss]"==s&&(100>g?(i=1e3+Math.floor(g)+"",W+=i.substr(2)):(i=Math.floor(g),W+=i+""));else{if(r==V.commands.section)break;if(r==V.commands.comparison)continue;W+="!! Parse error !!"}return B&&(W='<span style="color:'+B+';">'+W+"</span>"),U&&(W='<span style="'+U+';">'+W+"</span>"),W},t.FormatNumber.formatTextWithFormat=function(e,o){var n,r,a,l,i=(t.Constants,t.FormatNumber),s=e+"",c="",u="",d="";if(i.parse_format_string(i.format_definitions,o),thisformat=i.format_definitions[o],!thisformat)throw"Format not parsed error!";if(n=thisformat.sectioninfo.length-1,0==n)n=0;else{if(3!=n)return s;n=3}for(r=thisformat.sectioninfo[n],a=r.sectionstart;op=thisformat.operators[a];)l=thisformat.operands[a++],op==i.commands.copy?c+="@"==l?s:l.replace(/ /g,"&nbsp;"):op==i.commands.color?u=l:op==i.commands.style&&(d=l);return u&&(c='<span style="color:'+u+';">'+c+"</span>"),d&&(c='<span style="'+d+';">'+c+"</span>"),c},t.FormatNumber.parse_format_string=function(e,o){var n,r,a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C=t.FormatNumber,x=1;if(!e[o]){for(n={operators:[],operands:[],sectioninfo:[{}]},e[o]=n,r=0,sectioninfo=n.sectioninfo[r],sectioninfo.sectionstart=0,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,b=0;b<o.length;b++)if(y=o.charAt(b),c){if('"'==y){c=0,n.operators.push(C.commands.copy),n.operands.push(u);continue}u+=y}else if(d){if("]"==y){if(d=0,f=t.FormatNumber.parse_format_bracket(p),f.operator==C.commands.separator){sectioninfo.thousandssep=1;continue}f.operator==C.commands.date&&(sectioninfo.hasdate=1),f.operator==C.commands.comparison&&(n.hascomparison=1),n.operators.push(f.operator),n.operands.push(f.operand);continue}p+=y}else if(l)n.operators.push(C.commands.copy),n.operands.push(y),l=!1;else if(i)n.operators.push(C.commands.copy),n.operands.push(y+y+y+y+y),i=!1;else if(s)n.operators.push(C.commands.copy),n.operands.push("&nbsp;"),s=!1;else{if(h){if("general".charAt(h)==y.toLowerCase()){h++,7==h&&(n.operators.push(C.commands.general),n.operands.push(y),h=0);continue}h=0}if(v){if(v.charAt(0)==y){v+=y;continue}n.operators.push(C.commands.date),n.operands.push(v),sectioninfo.hasdate=1,v=""}m?(m+=y,g=m.toLowerCase(),g!="am/pm".substring(0,g.length)&&g!="a/p".substring(0,g.length)?ampstr="":("am/pm"==g||"a/p"==g)&&(n.operators.push(C.commands.date),n.operands.push(m),m="")):"#"==y||"0"==y||"?"==y?x?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=0),a=1,n.operators.push(C.commands.integer_placeholder),n.operands.push(y)):(sectioninfo.fractiondigits++,a=1,n.operators.push(C.commands.fraction_placeholder),n.operands.push(y)):"."==y?(a=0,n.operators.push(C.commands.decimal),n.operands.push(y),x=0):"$"==y?(a=0,n.operators.push(C.commands.currency),n.operands.push(y)):","==y?a?sectioninfo.commas++:(n.operators.push(C.commands.copy),n.operands.push(y)):"%"==y?(a=0,sectioninfo.percent++,n.operators.push(C.commands.copy),n.operands.push(y)):'"'==y?(a=0,c=1,u=""):"["==y?(a=0,d=1,p=""):"\\"==y?(l=1,a=0):"*"==y?(i=1,a=0):"_"==y?(s=1,a=0):";"==y?(r++,n.sectioninfo[r]={},sectioninfo=n.sectioninfo[r],sectioninfo.sectionstart=1+n.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,x=1,a=0,n.operators.push(C.commands.section),n.operands.push(y)):"g"==y.toLowerCase()?(h=1,a=0):"a"==y.toLowerCase()?(m=y,a=0):"dmyhHs".indexOf(y)>=0?v=y:(a=0,n.operators.push(C.commands.copy),n.operands.push(y))}v&&(n.operators.push(C.commands.date),n.operands.push(v),sectioninfo.hasdate=1)}},t.FormatNumber.parse_format_bracket=function(e){var o,n=t.FormatNumber,r=t.Constants,a={};return"$"==e.charAt(0)?(a.operator=n.commands.currency,o=e.match(/^\$(.+?)(\-.+?){0,1}$/),a.operand=o?o[1]||r.FormatNumber_defaultCurrency||"$":e.substring(1)||r.FormatNumber_defaultCurrency||"$"):"?$"==e?(a.operator=n.commands.currency,a.operand="[?$]"):n.allowedcolors[e.toUpperCase()]?(a.operator=n.commands.color,a.operand=n.allowedcolors[e.toUpperCase()]):(o=e.match(/^style=([^"]*)$/))?(a.operator=n.commands.style,a.operand=o[1]):","==e?(a.operator=n.commands.separator,a.operand=e):n.alloweddates[e.toUpperCase()]?(a.operator=n.commands.date,a.operand=n.alloweddates[e.toUpperCase()]):(o=e.match(/^[<>=]/))?(o=e.match(/^([<>=]+)(.+)$/),a.operator=n.commands.comparison,a.operand=o[1]+":"+o[2]):(a.operator=n.commands.copy,a.operand="["+e+"]"),a},t.FormatNumber.convert_date_gregorian_to_julian=function(e,o,n){var r;return r=n-32075+t.intFunc(1461*(e+4800+t.intFunc((o-14)/12))/4),r+=t.intFunc(367*(o-2-12*t.intFunc((o-14)/12))/12),r-=t.intFunc(3*t.intFunc((e+4900+t.intFunc((o-14)/12))/100)/4)},t.FormatNumber.convert_date_julian_to_gregorian=function(e){var t,o,n,r,a;return t=e+68569,o=Math.floor(4*t/146097),t-=Math.floor((146097*o+3)/4),n=Math.floor(4e3*(t+1)/1461001),t=t-Math.floor(1461*n/4)+31,r=Math.floor(80*t/2447),a=t-Math.floor(2447*r/80),t=Math.floor(r/11),r=r+2-12*t,n=100*(o-49)+n+t,{year:n,month:r,day:a}},t.intFunc=function(e){return 0>e?-Math.floor(-e):Math.floor(e)};var t;t||(t={}),t.Formula={},t.TriggerIoAction={},t.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9},t.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7},t.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10},t.Formula.CharClassTable={" ":9,"!":3,'"':8,"'":8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5},t.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z"},t.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},t.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9},t.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"},t.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|ni:1|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","n*":"|ni:1|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|","t*":"|t*:t|e*:2|","e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}},t.Formula.ParseFormulaIntoTokens=function(e){var o,n,r,a,l,i,s,c,u=t.Formula,d=t.Constants,p=u.ParseState,f=u.TokenType,h=u.CharClass,m=u.CharClassTable,g=u.UpperCaseTable,v=u.ParsePushToken,b=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,y=[],C="",x=0,a=!1;for(o=0;o<=e.length;o++)o<e.length?(n=e.charAt(o),r=m[n]):(n="",r=h.eof),x==p.num&&(r==h.num?C+=n:r!=h.numstart||a?"E"==n||"e"==n?(C+=n,a=!1,x=p.numexp1):(v(y,C,f.num,0),a=!1,x=0):(a=!0,C+=n)),x==p.numexp1&&(r==p.num?x=p.numexp2:"+"!=n&&"-"!=n||"E"!=g[C.charAt(C.length-1)]?"E"==n||"e"==n||(v(y,d.s_parseerrexponent,f.error,0),x=0):C+=n),x==p.numexp2&&(r==h.num?C+=n:(v(y,C,f.num,0),x=0)),x==p.alpha&&(r==h.num?x=p.coord:r==h.alpha||"."==n?C+=n:r==h.incoord?x=p.coord:r==h.op||r==h.numstart||r==h.space||r==h.eof?(v(y,C.toUpperCase(),f.name,0),x=0):(v(y,d.s_parseerrchar,f.error,0),x=0)),x==p.coord&&(r==h.num?C+=n:r==h.incoord?C+=n:r==h.alpha?x=p.alphanumeric:r==h.op||r==h.numstart||r==h.eof||r==h.space?(c=b.test(C)?f.coord:f.name,v(y,C.toUpperCase(),c,0),x=0):(v(y,d.s_parseerrchar,f.error,0),x=0)),x==p.alphanumeric&&(r==h.num||r==h.alpha?C+=n:r==h.op||r==h.numstart||r==h.space||r==h.eof?(v(y,C.toUpperCase(),f.name,0),x=0):(v(y,d.s_parseerrchar,f.error,0),x=0)),x==p.string?r==h.quote?x=p.stringquote:r==h.eof?(v(y,d.s_parseerrstring,f.error,0),x=0):C+=n:x==p.stringquote?r==h.quote?(C+=n,x=p.string):(v(y,C,f.string,0),x=0):x==p.specialvalue&&("!"==C.charAt(C.length-1)?(v(y,C,f.name,0),x=0):r==h.eof?(v(y,d.s_parseerrspecialvalue,f.error,0),x=0):C+=n),0==x&&(r==h.num?(C=n,x=p.num):r==h.numstart?(C=n,a=!0,x=p.num):r==h.alpha||r==h.incoord?(C=n,x=p.alpha):r==h.specialstart?(C=n,x=p.specialvalue):r==h.op?(C=n,y.length>0?(l=y[y.length-1],i=l.type,s=l.text,i==h.op&&("<"==s||">"==s)&&(C=s+C,y.pop(),y.length>0?(l=y[y.length-1],i=l.type,s=l.text):(i=h.eof,s="EOF"))):(i=h.eof,s="EOF"),c=f.op,0==y.length||i==h.op&&")"!=s&&"%"!=s?"-"==C?(C="M",n="M"):"+"==C?(C="P",n="P"):")"==C&&"("==s||"("!=C&&(c=f.error,C=d.s_parseerrtwoops):C.length>1&&(">="==C?(C="G",n="G"):"<="==C?(C="L",n="L"):"<>"==C?(C="N",n="N"):(c=f.error,C=d.s_parseerrtwoops)),v(y,C,c,n),x=0):r==h.quote?(C="",x=p.string):r==h.space||r==h.eof||v(y,d.s_parseerrchar,f.error,0));return y},t.Formula.ParsePushToken=function(e,t,o,n){e.push({text:t,type:o,opcode:n})},t.Formula.evaluate_parsed_formula=function(e,o,n){{var r,a,l=t.Formula;l.TokenType}return a=l.ConvertInfixToPolish(e),r=l.EvaluatePolish(e,a,o,n)},t.Formula.ConvertInfixToPolish=function(e){var o,n,r,a,l,i,s=t.Formula,c=t.Constants,u=s.TokenType,d=s.TokenPrecedence,p=[],f=[],h="",m=-1;for(o=0;o<e.length;o++)if(n=e[o],r=n.type,a=n.text,r==u.num||r==u.coord||r==u.string)p.push(o);else if(r==u.name)f.push(o),p.push(m);else{if(r==u.space)continue;if(","==a){for(;f.length&&"("!=e[f[f.length-1]].text;)p.push(f.pop());if(0==f.length){h=c.s_parseerrmissingopenparen;break}}else if("("==a)f.push(o);else if(")"==a){for(;f.length&&"("!=e[f[f.length-1]].text;)p.push(f.pop());if(0==f.length){h=c.s_parseerrcloseparennoopen;break}f.pop(),f.length&&e[f[f.length-1]].type==u.name&&p.push(f.pop())}else{if(r!=u.op){if(r==u.error){h=a;break}h="Internal error while processing parsed formula. ";break}for(f.length&&e[f[f.length-1]].type==u.name&&p.push(f.pop());!(!f.length||e[f[f.length-1]].type!=u.op||"("==e[f[f.length-1]].text||(l=d[n.opcode],i=d[e[f[f.length-1]].opcode],l>=0&&i>l)||0>l&&(l=-l,0>i&&(i=-i),i>=l));)p.push(f.pop());f.push(o)}}for(;f.length>0;){if("("==e[f[f.length-1]].text){h=c.s_parseerrmissingcloseparen;break}p.push(f.pop())}return h?h:p},"undefined"==typeof t.debug_log&&(t.debug_log=[]),t.DebugLog=function(){},t.Formula.EvaluatePolish=function(e,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g,v,b,y=t.Formula,C=t.Constants,x=y.TokenType,w=y.LookupResultType,S=y.TypeLookupTable,T=y.OperandAsNumber,F=y.OperandAsText,E=y.OperandValueAndType,k=y.OperandsAsCoordOnSheet,_=t.format_number_for_display||function(e){return e+""},A="",P=-1,R={value:"",type:"e#VALUE!",error:C.s_parseerrmissingoperand},L=[],M=function(e,t){L.push({type:e,value:t})};if(!(e.length&&o instanceof Array))return{value:"",type:"e#VALUE!",error:"string"==typeof o?o:""};var D=[];for(a=0;a<o.length;a++)if(l=o[a],l!=P)if(i=e[l],s=i.type,c=i.text,D.push(i),s==x.num)M("n",c-0);else if(s==x.coord)M("coord",c);else if(s==x.string)M("t",c);else if(s==x.op){if(L.length<=0)return R;if("M"==c)u=T(n,L),h=w(u.type,u.type,S.unaryminus),M(h,-u.value);else if("P"==c)u=T(n,L),h=w(u.type,u.type,S.unaryplus),M(h,u.value);else if("%"==c)u=T(n,L),h=w(u.type,u.type,S.unarypercent),M(h,.01*u.value);else if("&"==c){if(L.length<=1)return R;d=F(n,L),u=F(n,L),h=w(u.type,u.type,S.concat),M(h,u.value+d.value)}else if(":"==c){if(L.length<=1)return R;u=y.OperandsAsRangeOnSheet(n,L),u.error&&(A=A||u.error),M(u.type,u.value)}else if("!"==c){if(L.length<=1)return R;u=k(n,L),u.error&&(A=A||u.error),M(u.type,u.value)}else if("<"==c||"L"==c||"="==c||"G"==c||">"==c||"N"==c){if(L.length<=1){A=C.s_parseerrmissingoperand;break}d=E(n,L),u=E(n,L),"n"==u.type.charAt(0)&&"n"==d.type.charAt(0)?(g=0,"<"==c?g=u.value<d.value?1:0:"L"==c?g=u.value<=d.value?1:0:"="==c?g=u.value==d.value?1:0:"G"==c?g=u.value>=d.value?1:0:">"==c?g=u.value>d.value?1:0:"N"==c&&(g=u.value!=d.value?1:0),M("nl",g)):"e"==u.type.charAt(0)?M(u.type,0):"e"==d.type.charAt(0)?M(d.type,0):(p=u.type.charAt(0),f=d.type.charAt(0),"n"==p?u.value=_(u.value,"n",""):"b"==p&&(u.value=""),"n"==f?d.value=_(d.value,"n",""):"b"==f&&(d.value=""),g=0,u.value=u.value.toLowerCase(),d.value=d.value.toLowerCase(),"<"==c?g=u.value<d.value?1:0:"L"==c?g=u.value<=d.value?1:0:"="==c?g=u.value==d.value?1:0:"G"==c?g=u.value>=d.value?1:0:">"==c?g=u.value>d.value?1:0:"N"==c&&(g=u.value!=d.value?1:0),M("nl",g))}else{if(L.length<=1){A=C.s_parseerrmissingoperand;break}"+"==c?(d=E(n,L),u=E(n,L),h=w(u.type,d.type,S.plus),M(h,u.value+d.value)):(d=T(n,L),u=T(n,L)),"-"==c?(h=w(u.type,d.type,S.plus),M(h,u.value-d.value)):"*"==c?(h=w(u.type,d.type,S.plus),M(h,u.value*d.value)):"/"==c?0!=d.value?M("n",u.value/d.value):M("e#DIV/0!",0):"^"==c&&(u.value=Math.pow(u.value,d.value),u.type="n",isNaN(u.value)&&(u.value=0,u.type="e#NUM!"),M(u.type,u.value))}}else{if(s!=x.name){A=C.s_InternalError+"Unknown token "+s+" ("+c+"). ";break}if(A=y.CalculateFunction(c,L,n,e.coord))break}else M("start",0);return value=L[0]?L[0].value:"",p=L[0]?L[0].type:"","name"==p&&(u=t.Formula.LookupName(n,value),value=u.value,p=u.type,A=A||u.error),"coord"==p&&(u=E(n,L),value=u.value,p=u.type,"b"==p&&(p="n",value=0)),L.length>1&&!A&&(A+=C.s_parseerrerrorinformula),m=p,"e"==p.charAt(0)?A=A||p.substring(1)||C.s_calcerrerrorvalueinformula:"range"==p&&(v=value.match(/^(.*)\|(.*)\|/),b=v[1].indexOf("!"),v[1]=b>=0?v[1].substring(b+1)+"!"+v[1].substring(0,b).toUpperCase():v[1].toUpperCase(),value=v[1]+":"+v[2].toUpperCase(),r||(A=C.s_formularangeresult+" "+value)),A&&"e"!=m.charAt(0)&&(value=A,m="e"),"n"!=m.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,m="e#NUM!",A=isNaN(value)?C.s_calcerrnumericnan:C.s_calcerrnumericoverflow),{value:value,type:m,error:A}},t.Formula.LookupResultType=function(e,t,o){var n,r,a,l=o[e];return l||(l=o[e.charAt(0)+"*"])?(n=l.indexOf("|"+t+":"),n>=0?(r=l.indexOf("|",n+1),0>r?"e#VALUE! (internal error, incorrect LookupResultType "+l+")":(a=l.substring(n+t.length+2,r),"1"==a?e:"2"==a?t:a)):(n=l.indexOf("|"+t.charAt(0)+"*:"),n>=0?(r=l.indexOf("|",n+1),0>r?"e#VALUE! (internal error, incorrect LookupResultType "+l+")":(a=l.substring(n+4,r),"1"==a?e:"2"==a?t:a)):"e#VALUE!")):"e#VALUE! (internal error, missing LookupResultType "+e.charAt(0)+"*)"},t.Formula.TopOfStackValueAndType=function(e,o){var n=t.Formula,r={type:"",value:""},a=o.length;return a?(r.value=o[a-1].value,r.type=o[a-1].type,o.pop(),"name"==r.type&&(r=n.LookupName(e,r.value)),r):(r.error=t.Constants.s_InternalError+"no operand on stack",r)},t.Formula.OperandAsNumber=function(e,o){var n,r,a=t.Formula.OperandValueAndType(e,o);return n=a.type.charAt(0),"n"==n?a.value=a.value-0:"b"==n?(a.type="n",a.value=0):"e"==n?a.value=0:(r=t.DetermineValueType?t.DetermineValueType(a.value):{value:a.value-0,type:"n"},"n"==r.type.charAt(0)?(a.value=r.value-0,a.type=r.type):(a.value=0,a.type=r.type)),a},t.Formula.OperandAsText=function(e,o){var n,r=t.Formula.OperandValueAndType(e,o);return n=r.type.charAt(0),"t"==n||("n"==n?(r.value=t.format_number_for_display?t.format_number_for_display(r.value,r.type,""):r.value=r.value+"",r.type="t"):"b"==n?(r.value="",r.type="t"):"e"==n?r.value="":(o.value=r.value+"",o.type="t")),r},t.Formula.OperandValueAndType=function(e,o){var n,r,a,l,i=t.Formula,s={type:"",value:""},c=o.length;if(!c)return s.error=t.Constants.s_InternalError+"no operand on stack",s;if(s.value=o[c-1].value,s.type=o[c-1].type,o.pop(),"name"==s.type&&(s=i.LookupName(e,s.value)),"range"==s.type&&(s=i.StepThroughRangeDown(o,s.value)),"coord"==s.type){if(l=e,a=s.value.indexOf("!"),-1!=a){if(l=i.FindInSheetCache(s.value.substring(a+1)),null==l)return s.type="e#REF!",s.error=t.Constants.s_sheetunavailable+" "+s.value.substring(a+1),s.value=0,s;s.value=s.value.substring(0,a)}l?(r=l.cells[t.Formula.PlainCoord(s.value)],r?(n=r.valuetype,s.value=r.datavalue):n="b"):(n="e#N/A",s.value=0),s.type=n||"b","b"==s.type&&(s.value=0)}return s},t.Formula.OperandAsCoord=function(e,o){return t.Formula.OperandAsType(e,o,"coord")},t.Formula.OperandAsRange=function(e,o){return t.Formula.OperandAsType(e,o,"range")},t.Formula.OperandAsType=function(e,o,n){var r=(t.Formula,{type:"",value:""}),a=o.length;return r.value=o[a-1].value,r.type=o[a-1].type,o.pop(),"name"==r.type&&(r=t.Formula.LookupName(e,r.value)),r.type==n?r:(r.value=t.Constants.s_calcerrcellrefmissing,r.type="e#REF!",r)},t.Formula.OperandsAsCoordOnSheet=function(e,o){var n,r,a,l,i={},s={},c=t.Formula,u=o.length;return i.value=o[u-1].value,i.type=o[u-1].type,o.pop(),n=c.OperandAsSheetName(e,o),r=c.FindInSheetCache(n.value),null==r?(s.type="e#REF!",s.value=0,s.error=t.Constants.s_sheetunavailable+" "+n.value,s):("name"==i.type&&(i=c.LookupName(r,i.value)),s.type=i.type,"coord"==i.type?s.value=i.value+"!"+n.value:"range"==i.type?(a=i.value.indexOf("|"),l=i.value.indexOf("|",a+1),s.value=i.value.substring(0,a)+"!"+n.value+"|"+i.value.substring(a+1,l)+"|"):"e"==i.type.charAt(0)?s.value=i.value:(s.error=t.Constants.s_calcerrcellrefmissing,s.type="e#REF!",s.value=0),s)},t.Formula.OperandsAsRangeOnSheet=function(e,o){var n,r,a,l,i={},s=t.Formula,c=t.Constants,u=o.length;return i.value=o[u-1].value,i.type=o[u-1].type,o.pop(),n=s.OperandAsCoord(e,o),"coord"!=n.type?{value:0,type:"e#REF!"}:(r=e,a=n.value.indexOf("!"),-1!=a&&(l=n.value.indexOf("|",a+1),0>l&&(l=n.value.length),r=s.FindInSheetCache(n.value.substring(a+1,l)),null==r)?{value:0,type:"e#REF!",errortext:c.s_sheetunavailable+" "+n.value.substring(a+1,l)}:("name"==i.type&&(i=s.LookupName(r,i.value,"end")),"coord"==i.type?{value:n.value+"|"+i.value+"|",type:"range"}:{value:c.s_calcerrcellrefmissing,type:"e#REF!"}))},t.Formula.OperandAsSheetName=function(e,o){var n,r,a=(t.Formula,{type:"",value:""}),l=o.length;if(a.value=o[l-1].value,a.type=o[l-1].type,o.pop(),"name"==a.type){if(n=t.Formula.LookupName(e,a.value),!n.value)return a;a.value=n.value,a.type=n.type}return"coord"==a.type&&(r=e.cells[t.Formula.PlainCoord(a.value)],r?(a.value=r.datavalue,a.type=r.valuetype):(a.value="",a.type="b")),"t"==a.type.charAt(0)?a:(a.value="",a.error=t.Constants.s_calcerrsheetnamemissing,a)},t.Formula.LookupName=function(e,o,n){var r,a,l,i=e.names,s={},c=!1;if(i[o.toUpperCase()]){if(s.value=i[o.toUpperCase()].definition,"="==s.value.charAt(0)){if(e.checknamecirc){if(e.checknamecirc[o])return s.type="e#NAME?",s.error=t.Constants.s_circularnameref+' "'+o+'".',s}else e.checknamecirc={},c=!0;if(e.checknamecirc[o]=!0,l=t.Formula.ParseFormulaIntoTokens(s.value.substring(1)),s=t.Formula.evaluate_parsed_formula(l,e,1),delete e.checknamecirc[o],c&&delete e.checknamecirc,"range"!=s.type)return s}return r=s.value.indexOf(":"),-1!=r?(s.type="range",s.value=s.value.substring(0,r)+"|"+s.value.substring(r+1)+"|",s.value=s.value.toUpperCase()):(s.type="coord",s.value=s.value.toUpperCase()),s}return(a=t.Formula.SpecialConstants[o.toUpperCase()])?(r=a.indexOf(","),s.value=a.substring(0,r)-0,s.type=a.substring(r+1),s):/^[a-zA-Z][a-zA-Z]?$/.test(o)?(s.type="coord",s.value=o.toUpperCase()+(n?e.attribs.lastrow:1),s):(s.value="",s.type="e#NAME?",s.error=t.Constants.s_calcerrunknownname+' "'+o+'"',s)},t.Formula.StepThroughRangeDown=function(e,o){var n,r,a,l,i,s,c,u,d,p,f=t.Formula;for(l=o.indexOf("|"),i=o.indexOf("|",l+1),n=o.substring(0,l),r=o.substring(l+1,i),a=o.substring(i+1)-0,l=n.indexOf("!"),-1!=l?(s=n.substring(l),n=n.substring(0,l)):s="",l=r.indexOf("!"),-1!=l&&(r=r.substring(0,l)),c=f.OrderRangeParts(n,r),p=0,d=c.r1;d<=c.r2;d++)for(u=c.c1;u<=c.c2;u++)if(p++,p>a)return(d!=c.r2||u!=c.c2)&&f.PushOperand(e,"range",n+s+"|"+r+"|"+p),{value:t.crToCoord(u,d)+s,type:"coord"}},t.Formula.DecodeRangeParts=function(e,o){var n,r,a,l,i,s,c,u=t.Formula;return a=o.indexOf("|"),l=o.indexOf("|",a+1),n=o.substring(0,a),r=o.substring(a+1,l),a=n.indexOf("!"),-1!=a?(i=n.substring(a+1),n=n.substring(0,a)):i="",a=r.indexOf("!"),-1!=a&&(r=r.substring(0,a)),s=e,i&&(s=u.FindInSheetCache(i),null==s)?null:(c=u.OrderRangeParts(n,r),{sheetdata:s,sheetname:i,col1num:c.c1,ncols:c.c2-c.c1+1,row1num:c.r1,nrows:c.r2-c.r1+1})},t.Formula.FunctionList||(t.Formula.FunctionList={}),t.Formula.FunctionClasses=null,t.Formula.FunctionArgDefs={},t.Formula.StoreIoEventFormula=function(e,o,n,r,a){var l=[];if(t.Formula.Clone(l,n),l.reverse(),0!=l.length){if("undefined"==typeof r.ioEventTree&&(r.ioEventTree={}),"undefined"==typeof r.ioParameterList&&(r.ioParameterList={}),"undefined"==typeof r.ioTimeTriggerList&&(r.ioTimeTriggerList={}),"undefined"==typeof r.radioGroupList&&(r.radioGroupList={}),"undefined"==typeof r.ioParameterList[o]&&(r.ioParameterList[o]={}),r.ioParameterList[o]=l,r.ioParameterList[o].function_name=e,"TimeTrigger"==a){var i=function(e,t,o){var n=o.cells[t];"undefined"!=typeof n&&"n"==n.valuetype.charAt(0)&&e.push(n.datavalue)},s=t.Formula.PlainCoord(l[0].value),c=[];if("range"==l[0].type)for(var u=t.Formula.DecodeRangeParts(r,s),d=0;d<u.ncols;d++)for(var p=0;p<u.nrows;p++){var f=t.crToCoord(u.col1num+d,u.row1num+p);i(c,f,r)}if("coord"==l[0].type&&i(c,s,r),"n"==l[0].type.charAt(0)&&c.push(l[0].value),"undefined"==typeof r.ioTimeTriggerList[o]||0==t.Formula.ArrayValuesEqual(r.ioTimeTriggerList[o],c)){r.ioTimeTriggerList[o]=c;for(var h=(new Date).getTimezoneOffset(),m=25569,g=[],v=0;v<c.length;++v)g[v]=Math.floor(24*(c[v]-m)*60+h);r.ScheduleSheetCommands("settimetrigger "+o+" "+g.toString())}}if("EventTree"==a&&("coord"==l[0].type||"range"==l[0].type)){var b=l[0].value.replace(/\$/g,""),y=function(e,t,o){"undefined"==typeof e[t]&&(e[t]={}),e[t][o]=o};if("range"==l[0].type)for(var u=t.Formula.DecodeRangeParts(r,b),d=0;d<u.ncols;d++)for(var p=0;p<u.nrows;p++){var C=t.crToCoord(u.col1num+d,u.row1num+p);y(r.ioEventTree,C,o)}"coord"==l[0].type&&y(r.ioEventTree,b,o)}if("Input"==a){var x=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=x&&1==x.loaded){null==x.formFields&&t.Formula.LoadFormFields();var w=(e+o).toLowerCase(),S=null;if(null==x.formFields[w]){var T=x.formFields[w]=x.formFieldsLength++ +2,F=t.crToCoord(T,1);S="set "+F+" text t "+t.encodeForSave(e.toLowerCase()+o)}if("t"==l[0].type.charAt(0)||"n"==l[0].type.charAt(0)){var E=t.crToCoord(x.formFields[w],2);if(null==x.sheet.cells[E]||x.sheet.cells[E].datavalue!=l[0].value){var k="set "+E+" text t "+t.encodeForSave(l[0].value);S=null!=S?S+"\n"+k:k}}null!=S&&x.sheet.ScheduleSheetCommands(S,!1)}}}},t.Formula.ArrayValuesEqual=function(e,t){var o=e.length;if(o!=t.length)return!1;for(;o--;)if(e[o]!==t[o])return!1;return!0},t.Formula.Clone=function(e,o){for(var n in o)"object"==typeof o[n]&&null!==o[n]&&e[n]?t.Formula.Clone(e[n],o[n]):e[n]=o[n]},t.Formula.LoadFormFields=function(){var e=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;e.formFields={},null==e.sheet.cells.A1&&e.sheet.ScheduleSheetCommands("set A1 text t "+t.encodeForSave("FieldName:"),!1),null==e.sheet.cells.A2&&e.sheet.ScheduleSheetCommands("set A2 text t "+t.encodeForSave("Pending:"),!1);for(var o=2;;){var n=t.crToCoord(o,1),r=e.sheet.cells[n];if(!r)break;e.formFields[r.datavalue.toLowerCase()]=o,o++}e.formFieldsLength=o-2},t.Formula.CalculateFunction=function(e,o,n,r){var a,l,i,s,c,u=t.Formula,d="";if(a=u.FunctionList[e]){if(l=[],i=a[0],s=a[1],u.CopyFunctionArgs(o,l),a[6]&&""!=a[6]&&(t.DebugLog("action:"+e),u.StoreIoEventFormula(e,r,l,n,a[6])),100!=s)if(0>s){if(l.length<-s)return d=u.FunctionArgsError(e,o)}else if(l.length!=s)return d=u.FunctionArgsError(e,o);d=i(e,o,l,n,r)}else c=e,o.length&&"start"==o[o.length-1].type?(o.pop(),u.PushOperand(o,"name",c)):d=t.Constants.s_sheetfuncunknownfunction+" "+c+". ";return d},t.Formula.PushOperand=function(e,t,o){e.push({type:t,value:o})},t.Formula.CopyFunctionArgs=function(e,o){var o;for(t.Formula;e.length>0&&"start"!=e[e.length-1].type;)o.push(e.pop());e.pop()},t.Formula.FunctionArgsError=function(e,o){var n=t.Constants.s_calcerrincorrectargstofunction+" "+e+". ";return t.Formula.PushOperand(o,"e#VALUE!",n),n},t.Formula.FunctionSpecificError=function(e,o,n,r){return t.Formula.PushOperand(o,n,r),r},t.Formula.CheckForErrorValue=function(e,t){return"e"==t.type.charAt(0)?(e.push(t),!0):!1},t.Formula.FillFunctionInfo=function(){var e,o,n,r,a,l=t.Formula,i=t.Constants;if(!l.FunctionClasses){for(e in l.FunctionList)o=l.FunctionList[e],o[2]&&(l.FunctionArgDefs[o[2]]=i["s_farg_"+o[2]]||""),o[3]||i["s_fdef_"+e]&&(l.FunctionList[e][3]=i["s_fdef_"+e]);for(l.FunctionClasses={},a=0;a<i.function_classlist.length;a++)r=i.function_classlist[a],l.FunctionClasses[r]={name:i["s_fclass_"+r],items:[]};for(e in l.FunctionList)for(o=l.FunctionList[e],n=o[4]?o[4].split(","):[],n.push("all"),a=0;a<n.length;a++)r=n[a],l.FunctionClasses[r].items.push(e);for(r in l.FunctionClasses)l.FunctionClasses[r].items.sort()}},t.Formula.FunctionArgString=function(e){var o,n,r,a=t.Formula,l=a.FunctionList[e],i=l[2];if(!i){if(o=l[1],0!=o){if(o>0){for(r="v1",n=2;o>=n;n++)r+=", v"+n;return r}if(0>o){for(r="v1",n=2;-o>n;n++)r+=", v"+n;return r+", ..."}return"nargs: "+o}i=" "}return r=a.FunctionArgDefs[i]||i},t.Formula.SeriesFunctions=function(e,o,n,r){for(var a,l,i,s,c,u,d,p,f,h=t.Formula,m=h.OperandValueAndType,g=h.LookupResultType,v=h.TypeLookupTable.plus,b=function(e,t){o.push({type:e,value:t})},y=0,C="",x=0,w=0,S=0,T=1;n.length>0;)a=m(r,n),l=a.type.charAt(0),"n"==l&&(x+=1),"b"!=l&&(w+=1),"b"==l&&(S+=1),"n"==l?(i=a.value-0,y+=i,T*=i,s=void 0!=s?i>s?i:s:i,c=void 0!=c?c>i?i:c:i,1==x?(p=i,f=0):(u=p+(i-p)/x,d=f+(i-p)*(i-u),f=d,p=u),C=g(a.type,C||a.type,v)):"e"==l&&"e"!=C.charAt(0)&&(C=a.type);switch(C=C||"n",e){case"SUM":b(C,y);break;case"PRODUCT":b(C,T);break;case"MIN":b(C,c||0);break;case"MAX":b(C,s||0);break;case"COUNT":b("n",x);break;case"COUNTA":b("n",w);break;case"COUNTBLANK":b("n",S);break;case"AVERAGE":x>0?b(C,y/x):b("e#DIV/0!",0);break;case"STDEV":x>1?b(C,Math.sqrt(d/(x-1))):b("e#DIV/0!",0);break;case"STDEVP":x>1?b(C,Math.sqrt(d/x)):b("e#DIV/0!",0);break;case"VAR":x>1?b(C,d/(x-1)):b("e#DIV/0!",0);break;case"VARP":x>1?b(C,d/x):b("e#DIV/0!",0)}return null},t.Formula.FunctionList.AVERAGE=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNT=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNTA=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNTBLANK=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.MAX=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.MIN=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.PRODUCT=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.STDEV=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.STDEVP=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.SUM=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.VAR=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.VARP=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.SumProductFunction=function(e,o,n,r){for(var a,l=[],s=0,c=t.Formula,u=0,d=0,p=function(e,t){o.push({type:e,value:t})};n.length>0;){if(a=c.TopOfStackValueAndType(r,n),"range"!=a.type)return void p("e#VALUE!",0);if(rangeinfo=c.DecodeRangeParts(r,a.value),u){if(u!=rangeinfo.ncols)return void p("e#VALUE!",0)}else u=rangeinfo.ncols;if(d){if(d!=rangeinfo.nrows)return void p("e#VALUE!",0)}else d=rangeinfo.nrows;for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=t.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,l[k]=("undefined"!=typeof l[k]?l[k]:1)*value
}for(i=0;i<l.length;i++)s+=l[i];p("n",s)},t.Formula.FunctionList.SUMPRODUCT=[t.Formula.SumProductFunction,-1,"rangen","","stat"],t.Formula.DSeriesFunctions=function(e,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C,x,w,S,T,F,E,k,_,A,P,R=t.Formula,L=(R.OperandValueAndType,R.LookupResultType),M=R.TypeLookupTable.plus,D=function(e,t){o.push({type:e,value:t})},a={},N=0,I="",O=0,B=0,U=0,z=0,H=1;if(i=R.TopOfStackValueAndType(r,n),s=R.OperandValueAndType(r,n),c=R.TopOfStackValueAndType(r,n),"range"!=i.type||"range"!=c.type)return R.FunctionArgsError(e,o);if(u=R.DecodeRangeParts(r,i.value),d=R.DecodeRangeParts(r,c.value),p=R.FieldToColnum(u.sheetdata,u.col1num,u.ncols,u.row1num,s.value,s.type),0>=p)return void D("e#VALUE!",0);for(f=u.col1num+p-1,b=[],h=0;h<d.ncols;h++){if(v=d.sheetdata.GetAssuredCell(t.crToCoord(d.col1num+h,d.row1num)),criterianum=R.FieldToColnum(u.sheetdata,u.col1num,u.ncols,u.row1num,v.datavalue,v.valuetype),0>=criterianum)return void D("e#VALUE!",0);b.push(u.col1num+criterianum-1)}for(h=1;h<u.nrows;h++){y=!1;e:for(m=1;m<d.nrows;m++){for(g=0;g<d.ncols;g++)if(C=t.crToCoord(d.col1num+g,d.row1num+m),v=d.sheetdata.GetAssuredCell(C),x=v.datavalue,("string"!=typeof x||0!=x.length)&&(w=b[g],S=t.crToCoord(w,u.row1num+h),v=u.sheetdata.GetAssuredCell(S),!R.TestCriteria(v.datavalue,v.valuetype||"b",x)))continue e;y=!0;break e}y&&(l=t.crToCoord(f,u.row1num+h),v=u.sheetdata.GetAssuredCell(l),a.value=v.datavalue,a.type=v.valuetype,T=a.type.charAt(0),z+=1,"n"==T&&(O+=1),"b"!=T&&(B+=1),"b"==T&&(U+=1),"n"==T?(v1=a.value-0,N+=v1,H*=v1,F=void 0!=F?v1>F?v1:F:v1,E=void 0!=E?E>v1?v1:E:v1,1==O?(A=v1,P=0):(k=A+(v1-A)/O,_=P+(v1-A)*(v1-k),P=_,A=k),I=L(a.type,I||a.type,M)):"e"==T&&"e"!=I.charAt(0)&&(I=a.type))}switch(I=I||"n",e){case"DSUM":D(I,N);break;case"DPRODUCT":D(I,H);break;case"DMIN":D(I,E||0);break;case"DMAX":D(I,F||0);break;case"DCOUNT":D("n",O);break;case"DCOUNTA":D("n",B);break;case"DAVERAGE":O>0?D(I,N/O):D("e#DIV/0!",0);break;case"DSTDEV":O>1?D(I,Math.sqrt(_/(O-1))):D("e#DIV/0!",0);break;case"DSTDEVP":O>1?D(I,Math.sqrt(_/O)):D("e#DIV/0!",0);break;case"DVAR":O>1?D(I,_/(O-1)):D("e#DIV/0!",0);break;case"DVARP":O>1?D(I,_/O):D("e#DIV/0!",0);break;case"DGET":1==z?D(a.type,a.value):0==z?D("e#VALUE!",0):D("e#NUM!",0)}},t.Formula.FunctionList.DAVERAGE=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DCOUNT=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DCOUNTA=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DGET=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DMAX=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DMIN=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DPRODUCT=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSTDEV=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSTDEVP=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSUM=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DVAR=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DVARP=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FieldToColnum=function(e,o,n,r,a,l){var i,s,c;if("n"==l.charAt(0))return i=a-0,0>=i||i>n?0:Math.floor(i);if("t"!=l.charAt(0))return 0;for(a=a?a.toLowerCase():"",i=0;n>i;i++)if(s=e.GetAssuredCell(t.crToCoord(o+i,r)),c=s.datavalue,c=(c+"").toLowerCase(),c==a)return i+1;return 0},t.Formula.LookupFunctions=function(e,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C,a,x=t.Formula,w=x.OperandValueAndType,S=(x.LookupResultType,x.TypeLookupTable.plus,function(e,t){o.push({type:e,value:t})});if(a=w(r,n),"string"==typeof a.value&&(a.value=a.value.toLowerCase()),l=x.TopOfStackValueAndType(r,n),i=1,"MATCH"==e){if(n.length){if(i=x.OperandAsNumber(r,n),"n"!=i.type.charAt(0))return void S("e#VALUE!",0);if(n.length)return x.FunctionArgsError(e,o),0;i=i.value-0}}else{if(s=x.OperandAsNumber(r,n),"n"!=s.type.charAt(0))return void S("e#VALUE!",0);if(s=Math.floor(s.value),n.length){if(i=x.OperandAsNumber(r,n),"n"!=i.type.charAt(0))return void S("e#VALUE!",0);if(n.length)return x.FunctionArgsError(e,o),0;i=i.value?1:0}}if(a.type=a.type.charAt(0),"n"==a.type&&(a.value=a.value-0),"range"!=l.type)return x.FunctionArgsError(e,o),0;if(c=x.DecodeRangeParts(r,l.value,l.type),!c)return void S("e#REF!",0);if(u=0,d=0,p=0,f=0,"HLOOKUP"==e){if(p=1,s>c.nrows)return void S("e#REF!",0)}else if("VLOOKUP"==e){if(f=1,s>c.ncols)return void S("e#REF!",0)}else{if("MATCH"!=e)return x.FunctionArgsError(e,o),0;if(c.ncols>1){if(c.nrows>1)return void S("e#N/A",0);p=1}else f=1}if(1>s&&"MATCH"!=e)return S("e#VALUE!",0),0;for(;;){if(C=t.crToCoord(c.col1num+u,c.row1num+d),v=c.sheetdata.GetAssuredCell(C),b=v.datavalue,y=v.valuetype?v.valuetype.charAt(0):"b","n"==y&&(b-=0),i){if("n"==a.type&&"n"==y){if(a.value==b)break;if(i>0&&a.value>b||0>i&&a.value<b)h=1,m=u,g=d;else if(h){h=2;break}}else if("t"==a.type&&"t"==y){if(b="string"==typeof b?b.toLowerCase():"",a.value==b)break;if(i>0&&a.value>b||0>i&&a.value<b)h=1,m=u,g=d;else if(h){h=2;break}}}else if("n"==a.type&&"n"==y){if(a.value==b)break}else if("t"==a.type&&"t"==y&&(b="string"==typeof b?b.toLowerCase():"",a.value==b))break;if(d+=f,u+=p,d>=c.nrows||u>=c.ncols){if(h){h=2;break}return void S("e#N/A",0)}}2==h&&(d=g,u=m),"MATCH"==e?(b=u+d+1,y="n"):(C=t.crToCoord(c.col1num+u+("VLOOKUP"==e?s-1:0),c.row1num+d+("HLOOKUP"==e?s-1:0)),v=c.sheetdata.GetAssuredCell(C),b=v.datavalue,y=v.valuetype),S(y,b)},t.Formula.FunctionList.HLOOKUP=[t.Formula.LookupFunctions,-3,"hlookup","","lookup"],t.Formula.FunctionList.MATCH=[t.Formula.LookupFunctions,-2,"match","","lookup"],t.Formula.FunctionList.VLOOKUP=[t.Formula.LookupFunctions,-3,"vlookup","","lookup"],t.Formula.IndexFunction=function(e,o,n,r){var a,l,i,s,c,u,d,p=t.Formula,f=function(e,t){o.push({type:e,value:t})};if(a=p.TopOfStackValueAndType(r,n),"range"!=a.type)return p.FunctionArgsError(e,o),0;if(i=p.DecodeRangeParts(r,a.value,a.type),l=i.sheetname?"!"+i.sheetname:"",s={value:0},c={value:0},n.length){if(s=p.OperandAsNumber(r,n),"n"!=s.type.charAt(0)||s.value<0)return void f("e#VALUE!",0);if(n.length){if(c=p.OperandAsNumber(r,n),"n"!=c.type.charAt(0)||c.value<0)return void f("e#VALUE!",0);if(n.length)return p.FunctionArgsError(e,o),0}else 1==i.nrows&&(c.value=s.value,s.value=0)}return s.value>i.nrows||c.value>i.ncols?void f("e#REF!",0):(0==s.value?0==c.value?1==i.nrows&&1==i.ncols?(u=t.crToCoord(i.col1num,i.row1num)+l,d="coord"):(u=t.crToCoord(i.col1num,i.row1num)+l+"|"+t.crToCoord(i.col1num+i.ncols-1,i.row1num+i.nrows-1)+"|",d="range"):1==i.nrows?(u=t.crToCoord(i.col1num+c.value-1,i.row1num)+l,d="coord"):(u=t.crToCoord(i.col1num+c.value-1,i.row1num)+l+"|"+t.crToCoord(i.col1num+c.value-1,i.row1num+i.nrows-1)+"|",d="range"):0==c.value?1==i.ncols?(u=t.crToCoord(i.col1num,i.row1num+s.value-1)+l,d="coord"):(u=t.crToCoord(i.col1num,i.row1num+s.value-1)+l+"|"+t.crToCoord(i.col1num+i.ncols-1,i.row1num+s.value-1)+"|",d="range"):(u=t.crToCoord(i.col1num+c.value-1,i.row1num+s.value-1)+l,d="coord"),void f(d,u))},t.Formula.FunctionList.INDEX=[t.Formula.IndexFunction,-1,"index","","lookup"],t.Formula.CountifSumifFunctions=function(e,o,n,r){var a,l,i,s,c,u,d=0,p="",f=0,h=t.Formula,m=h.OperandValueAndType,g=h.LookupResultType,v=h.TypeLookupTable.plus,b=function(e,t){o.push({type:e,value:t})};if(a=h.TopOfStackValueAndType(r,n),l=h.OperandAsText(r,n),"SUMIF"==e)if(1==n.length)i=h.TopOfStackValueAndType(r,n);else{if(0!=n.length)return h.FunctionArgsError(e,o),0;i={value:a.value,type:a.type}}else i={value:a.value,type:a.type};if("n"==l.type.charAt(0)?l.value=l.value+"":"e"==l.type.charAt(0)?l.value=null:"b"==l.type.charAt(0)&&(l.value=null),"coord"!=a.type&&"range"!=a.type)return h.FunctionArgsError(e,o),0;if("SUMIF"==e&&"coord"!=i.type&&"range"!=i.type)return h.FunctionArgsError(e,o),0;for(n.push(a),s=[],s.push(i);n.length;)c=m(r,n),u=m(r,s),h.TestCriteria(c.value,c.type,l.value)&&(f+=1,"n"==u.type.charAt(0)?(d+=u.value-0,p=g(u.type,p||u.type,v)):"e"==u.type.charAt(0)&&"e"!=p.charAt(0)&&(p=u.type));p=p||"n","SUMIF"==e?b(p,d):"COUNTIF"==e&&b("n",f)},t.Formula.FunctionList.COUNTIF=[t.Formula.CountifSumifFunctions,2,"rangec","","stat"],t.Formula.FunctionList.SUMIF=[t.Formula.CountifSumifFunctions,-2,"sumif","","stat"],t.Formula.IfFunction=function(e,o,n,r){var a,l;if(a=t.Formula.OperandValueAndType(r,n),l=a.type.charAt(0),"n"!=l&&"b"!=l)return void o.push({type:"e#VALUE!",value:0});var i,s;if(i=n.pop(),1==n.length)s=n.pop();else{if(0!=n.length)return void scf.FunctionArgsError(e,o);s={type:"n",value:0}}o.push(a.value?i:s)},t.Formula.FunctionList.IF=[t.Formula.IfFunction,-2,"iffunc","","test"],t.Formula.DateFunction=function(e,o,n,r){var a=t.Formula,l=0,i=a.OperandAsNumber(r,n),s=a.OperandAsNumber(r,n),c=a.OperandAsNumber(r,n),u=a.LookupResultType(i.type,s.type,a.TypeLookupTable.twoargnumeric);u=a.LookupResultType(u,c.type,a.TypeLookupTable.twoargnumeric),"n"==u.charAt(0)&&(l=t.FormatNumber.convert_date_gregorian_to_julian(Math.floor(i.value),Math.floor(s.value),Math.floor(c.value))-t.FormatNumber.datevalues.julian_offset,u="nd"),a.PushOperand(o,u,l)},t.Formula.FunctionList.DATE=[t.Formula.DateFunction,3,"date","","datetime"],t.Formula.TimeFunction=function(e,o,n,r){var a=t.Formula,l=0,i=a.OperandAsNumber(r,n),s=a.OperandAsNumber(r,n),c=a.OperandAsNumber(r,n),u=a.LookupResultType(i.type,s.type,a.TypeLookupTable.twoargnumeric);u=a.LookupResultType(u,c.type,a.TypeLookupTable.twoargnumeric),"n"==u.charAt(0)&&(l=(60*i.value*60+60*s.value+c.value)/86400,u="nt"),a.PushOperand(o,u,l)},t.Formula.FunctionList.TIME=[t.Formula.TimeFunction,3,"hms","","datetime"],t.Formula.DMYFunctions=function(e,o,n,r){var a,l,i,s=t.Formula,c=0,u=s.OperandAsNumber(r,n),d=s.LookupResultType(u.type,u.type,s.TypeLookupTable.oneargnumeric);if("n"==d.charAt(0))switch(a=t.FormatNumber.convert_date_julian_to_gregorian(Math.floor(u.value+t.FormatNumber.datevalues.julian_offset)),e){case"DAY":c=a.day;break;case"MONTH":c=a.month;break;case"YEAR":c=a.year;break;case"WEEKDAY":if(l={value:1},n.length){if(l=s.OperandAsNumber(r,n),"n"!=l.type.charAt(0)||l.value<1||l.value>3)return void s.PushOperand(o,"e#VALUE!",0);if(n.length)return void s.FunctionArgsError(e,o)}i=6,l.value>1&&(i-=1),c=Math.floor(u.value+i)%7+(l.value<3?1:0)}s.PushOperand(o,d,c)},t.Formula.FunctionList.DAY=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.MONTH=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.YEAR=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.WEEKDAY=[t.Formula.DMYFunctions,-1,"weekday","","datetime"],t.Formula.HMSFunctions=function(e,o,n,r){var a,l,i,s,c=t.Formula,u=0,d=c.OperandAsNumber(r,n),p=c.LookupResultType(d.type,d.type,c.TypeLookupTable.oneargnumeric);if("n"==p.charAt(0)){if(d.value<0)return void c.PushOperand(o,"e#NUM!",0);s=d.value-Math.floor(d.value),s*=24,a=Math.floor(s),s-=Math.floor(s),s*=60,l=Math.floor(s),s-=Math.floor(s),s*=60,i=Math.floor(s+(d.value>=0?.5:-.5)),"HOUR"==e?u=a:"MINUTE"==e?u=l:"SECOND"==e&&(u=i)}c.PushOperand(o,p,u)},t.Formula.FunctionList.HOUR=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.FunctionList.MINUTE=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.FunctionList.SECOND=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.ExactFunction=function(e,o,n,r){var a=t.Formula,l=0,i="nl",s=a.OperandValueAndType(r,n),c=s.type.charAt(0),u=a.OperandValueAndType(r,n),d=u.type.charAt(0);"t"==c?"t"==d?l=s.value==u.value?1:0:"b"==d?l=s.value.length?0:1:"n"==d?l=s.value==u.value+""?1:0:"e"==d?(l=u.value,i=u.type):l=0:"n"==c?"n"==d?l=s.value-0==u.value-0?1:0:"b"==d?l=0:"t"==d?l=s.value+""==u.value?1:0:"e"==d?(l=u.value,i=u.type):l=0:"b"==c?"t"==d?l=u.value.length?0:1:"b"==d?l=1:"n"==d?l=0:"e"==d?(l=u.value,i=u.type):l=0:"e"==c&&(l=s.value,i=s.type),a.PushOperand(o,i,l)},t.Formula.FunctionList.EXACT=[t.Formula.ExactFunction,2,"","","text"],t.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],HEXCODE:[1],UPPER:[1]},t.Formula.StringFunctions=function(e,o,n,r){var a,l,i,s,c,u,d=t.Formula,p=0,f="e#VALUE!",h=n.length,m=d.ArgList[e],g=[],v=[];for(a=1;h>=a;a++){if(a>m.length)return void d.FunctionArgsError(e,o);if(0==m[a-1]?l=d.OperandAsNumber(r,n):1==m[a-1]?l=d.OperandAsText(r,n):-1==m[a-1]&&(l=d.OperandValueAndType(r,n)),g[a]=l.value,v[a]=l.type,"e"==l.type.charAt(0))return void d.PushOperand(o,l.type,p)}switch(e){case"FIND":i=v[3]?g[3]-1:0,0>i?p="Start is before string":(p=g[2].indexOf(g[1],i),p>=0?(p+=1,f="n"):p="Not found");break;case"LEFT":s=v[2]?g[2]-0:1,0>s?p="Negative length":(p=g[1].substring(0,s),f="t");break;case"LEN":p=g[1].length,f="n";break;case"LOWER":p=g[1].toLowerCase(),f="t";break;case"MID":c=g[2]-0,s=g[3]-0,1>s||1>c?p="Bad arguments":(p=g[1].substring(c-1,c+s-1),f="t");break;case"PROPER":p=g[1].replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),f="t";break;case"REPLACE":c=g[2]-0,s=g[3]-0,0>s||1>c?p="Bad arguments":(p=g[1].substring(0,c-1)+g[4]+g[1].substring(c-1+s),f="t");break;case"REPT":if(u=g[2]-0,0>u)p="Negative count";else{for(p="";u>0;u--)p+=g[1];f="t"}break;case"RIGHT":s=v[2]?g[2]-0:1,0>s?p="Negative length":(p=g[1].slice(-s),f="t");break;case"SUBSTITUTE":if(fulltext=g[1],oldtext=g[2],newtext=g[3],null!=g[4]){if(which=g[4]-0,0>=which){p="Non-positive instance number";break}}else which=0;for(u=0,oldpos=0,p="";;){if(pos=fulltext.indexOf(oldtext,oldpos),!(pos>=0)){p+=fulltext.substring(oldpos);break}if(u++,p+=fulltext.substring(oldpos,pos),0==which)p+=newtext;else{if(which==u){p+=newtext+fulltext.substring(pos+oldtext.length);break}p+=oldtext}oldpos=pos+oldtext.length}f="t";break;case"TRIM":p=g[1],p=p.replace(/^ */,""),p=p.replace(/ *$/,""),p=p.replace(/ +/g," "),f="t";break;case"HEXCODE":p=String(g[1]);var b=p.charCodeAt(0);if(b>=55296&&56319>=b){var y=p.charCodeAt(1);y>=56320&&57343>=y&&(b=1024*(b-55296)+(y-56320)+65536)}p=b.toString(16).toUpperCase(),f="t";break;case"UPPER":p=g[1].toUpperCase(),f="t"}d.PushOperand(o,f,p)},t.Formula.FunctionList.FIND=[t.Formula.StringFunctions,-2,"find","","text"],t.Formula.FunctionList.LEFT=[t.Formula.StringFunctions,-2,"tc","","text"],t.Formula.FunctionList.LEN=[t.Formula.StringFunctions,1,"txt","","text"],t.Formula.FunctionList.LOWER=[t.Formula.StringFunctions,1,"txt","","text"],t.Formula.FunctionList.MID=[t.Formula.StringFunctions,3,"mid","","text"],t.Formula.FunctionList.PROPER=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.REPLACE=[t.Formula.StringFunctions,4,"replace","","text"],t.Formula.FunctionList.REPT=[t.Formula.StringFunctions,2,"tc","","text"],t.Formula.FunctionList.RIGHT=[t.Formula.StringFunctions,-1,"tc","","text"],t.Formula.FunctionList.SUBSTITUTE=[t.Formula.StringFunctions,-3,"subs","","text"],t.Formula.FunctionList.TRIM=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.HEXCODE=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.UPPER=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.IsFunctions=function(e,o,n,r){var a=t.Formula,l=0,i="nl",s=a.OperandValueAndType(r,n),c=s.type.charAt(0);switch(e){case"ISBLANK":l="b"==s.type?1:0;break;case"ISERR":l="e"==c?"e#N/A"==s.type?0:1:0;break;case"ISERROR":l="e"==c?1:0;break;case"ISLOGICAL":l="nl"==s.type?1:0;break;case"ISNA":l="e#N/A"==s.type?1:0;break;case"ISNONTEXT":l="t"==c?0:1;break;case"ISNUMBER":l="n"==c?1:0;break;case"ISTEXT":l="t"==c?1:0}a.PushOperand(o,i,l)},t.Formula.FunctionList.ISBLANK=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISERR=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISERROR=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISLOGICAL=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNA=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNONTEXT=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNUMBER=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISTEXT=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.NTVFunctions=function(e,o,n,r){var a=t.Formula,l=0,i="e#VALUE!",s=a.OperandValueAndType(r,n),c=s.type.charAt(0);switch(e){case"N":l="n"==c?s.value-0:0,i="n";break;case"T":l="t"==c?s.value+"":"",i="t";break;case"VALUE":"n"==c||"b"==c?(l=s.value||0,i="n"):"t"==c&&(s=t.DetermineValueType(s.value),"n"!=s.type.charAt(0)?(l=0,i="e#VALUE!"):(l=s.value-0,i="n"))}"e"==c&&(i=s.type),a.PushOperand(o,i,l)},t.Formula.FunctionList.N=[t.Formula.NTVFunctions,1,"v","","math"],t.Formula.FunctionList.T=[t.Formula.NTVFunctions,1,"v","","text"],t.Formula.FunctionList.VALUE=[t.Formula.NTVFunctions,1,"v","","text"],t.Formula.Math1Functions=function(e,o,n,r){var a,l,i,s={},c=t.Formula;if(a=c.OperandAsNumber(r,n),l=a.value,s.type=c.LookupResultType(a.type,a.type,c.TypeLookupTable.oneargnumeric),"n"==s.type)switch(e){case"ABS":l=Math.abs(l);break;case"ACOS":l>=-1&&1>=l?l=Math.acos(l):s.type="e#NUM!";break;case"ASIN":l>=-1&&1>=l?l=Math.asin(l):s.type="e#NUM!";break;case"ATAN":l=Math.atan(l);break;case"COS":l=Math.cos(l);break;case"DEGREES":l=180*l/Math.PI;break;case"EVEN":l=0>l?-l:l,l!=Math.floor(l)?l=Math.floor(l+1)+Math.floor(l+1)%2:l+=l%2,a.value<0&&(l=-l);break;case"EXP":l=Math.exp(l);break;case"FACT":for(i=1,l=Math.floor(l);l>0;l--)i*=l;l=i;break;case"INT":l=Math.floor(l);break;case"LN":0>=l&&(s.type="e#NUM!",s.error=t.Constants.s_sheetfunclnarg),l=Math.log(l);break;case"LOG10":0>=l&&(s.type="e#NUM!",s.error=t.Constants.s_sheetfunclog10arg),l=Math.log(l)/Math.log(10);break;case"ODD":l=0>l?-l:l,l!=Math.floor(l)?l=Math.floor(l+1)+(1-Math.floor(l+1)%2):l+=1-l%2,a.value<0&&(l=-l);break;case"RADIANS":l=l*Math.PI/180;break;case"SIN":l=Math.sin(l);break;case"SQRT":l>=0?l=Math.sqrt(l):s.type="e#NUM!";break;case"TAN":0!=Math.cos(l)?l=Math.tan(l):s.type="e#NUM!"}return s.value=l,o.push(s),null},t.Formula.FunctionList.ABS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ACOS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ASIN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ATAN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.COS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.DEGREES=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.EVEN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.EXP=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.FACT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.INT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.LN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.LOG10=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ODD=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.RADIANS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.SIN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.SQRT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.TAN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.Math2Functions=function(e,o,n,r){var a,l,i,s,c,u,d={},p=t.Formula;if(a=p.OperandAsNumber(r,n),l=p.OperandAsNumber(r,n),i=0,d.type=p.LookupResultType(a.type,l.type,p.TypeLookupTable.twoargnumeric),"n"==d.type)switch(e){case"ATAN2":0==a.value&&0==l.value?d.type="e#DIV/0!":d.value=Math.atan2(l.value,a.value);break;case"POWER":d.value=Math.pow(a.value,l.value),isNaN(d.value)&&(d.value=0,d.type="e#NUM!");break;case"MOD":0==l.value?d.type="e#DIV/0!":(s=a.value/l.value,s=Math.floor(s),d.value=a.value-s*l.value);break;case"TRUNC":if(c=1,l.value>=0){for(l.value=Math.floor(l.value),u=0;u<l.value;u++)c*=10;d.value=Math.floor(Math.abs(a.value)*c)/c}else if(l.value<0){for(l.value=Math.floor(-l.value),u=0;u<l.value;u++)c*=10;d.value=Math.floor(Math.abs(a.value)/c)*c}a.value<0&&(d.value=-d.value)}return o.push(d),null},t.Formula.FunctionList.ATAN2=[t.Formula.Math2Functions,2,"xy","","math"],t.Formula.FunctionList.MOD=[t.Formula.Math2Functions,2,"","","math"],t.Formula.FunctionList.POWER=[t.Formula.Math2Functions,2,"","","math"],t.Formula.FunctionList.TRUNC=[t.Formula.Math2Functions,2,"valpre","","math"],t.Formula.LogFunction=function(e,o,n,r){var a,l,i={},s=t.Formula;if(i.value=0,a=s.OperandAsNumber(r,n),i.type=s.LookupResultType(a.type,a.type,s.TypeLookupTable.oneargnumeric),1==n.length){if(l=s.OperandAsNumber(r,n),"n"!=l.type.charAt(0)||l.value<=0)return s.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfunclogsecondarg),0}else{if(0!=n.length)return s.FunctionArgsError(e,o),0;l={value:Math.E,type:"n"}}if("n"==i.type){if(a.value<=0)return s.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfunclogfirstarg),0;i.value=Math.log(a.value)/Math.log(l.value)}o.push(i)},t.Formula.FunctionList.LOG=[t.Formula.LogFunction,-1,"log","","math"],t.Formula.RoundFunction=function(e,o,n,r){var a,l,i,s,c=t.Formula,u=0,d="e#VALUE!",p=c.OperandValueAndType(r,n),d=c.LookupResultType(p.type,p.type,c.TypeLookupTable.oneargnumeric);if(1==n.length){if(a=c.OperandValueAndType(r,n),"n"!=a.type.charAt(0))return c.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=n.length)return c.FunctionArgsError(e,o),0;a={value:0,type:"n"}}if("n"==d)if(a.value=a.value-0,0==a.value)u=Math.round(p.value);else if(a.value>0){for(l=1,a.value=Math.floor(a.value),s=0;s<a.value;s++)l*=10;i=Math.round(p.value*l),u=i/l}else if(a.value<0){for(l=1,a.value=Math.floor(-a.value),s=0;s<a.value;s++)l*=10;i=Math.round(p.value/l),u=i*l}c.PushOperand(o,d,u)},t.Formula.FunctionList.ROUND=[t.Formula.RoundFunction,-1,"vp","","math"],t.Formula.CeilingFloorFunctions=function(e,o,n,r){var a,l,i,s=t.Formula,c=function(e,t){o.push({type:e,value:t})};if(a=s.OperandValueAndType(r,n),i=a.type.charAt(0),"n"!=i)return void c("e#VALUE!",0);if(0==a.value)return void c("n",0);if(1==n.length){if(l=s.OperandValueAndType(r,n),i=a.type.charAt(0),"n"!=i)return void c("e#VALUE!",0)}else{if(0!=n.length)return void c("e#VALUE!",0);l={type:"n",value:a.value>0?1:-1}}if(0==l.value)return void c("n",0);if(l.value*a.value<0)return void c("e#NUM!",0);switch(e){case"CEILING":c("n",Math.ceil(a.value/l.value)*l.value);break;case"FLOOR":c("n",Math.floor(a.value/l.value)*l.value)}},t.Formula.FunctionList.CEILING=[t.Formula.CeilingFloorFunctions,-1,"vsig","","math"],t.Formula.FunctionList.FLOOR=[t.Formula.CeilingFloorFunctions,-1,"vsig","","math"],t.Formula.AndOrFunctions=function(e,o,n,r){var a,l,i=t.Formula,s="";for("AND"==e?l=1:"OR"==e&&(l=0);n.length;)a=i.OperandValueAndType(r,n),"n"==a.type.charAt(0)?(a.value=a.value-0,"AND"==e?l=0!=a.value?l:0:"OR"==e&&(l=0!=a.value?1:l),s=i.LookupResultType(a.type,s||"nl",i.TypeLookupTable.propagateerror)):"e"==a.type.charAt(0)&&"e"!=s.charAt(0)&&(s=a.type);s.length<1&&(s="e#VALUE!",l=0),i.PushOperand(o,s,l)},t.Formula.FunctionList.AND=[t.Formula.AndOrFunctions,-1,"vn","","test"],t.Formula.FunctionList.OR=[t.Formula.AndOrFunctions,-1,"vn","","test"],t.Formula.NotFunction=function(e,o,n,r){var a=0,l=t.Formula,i=l.OperandValueAndType(r,n),s=l.LookupResultType(i.type,i.type,l.TypeLookupTable.propagateerror);"n"==i.type.charAt(0)||"b"==i.type?(a=i.value-0!=0?0:1,s="nl"):"t"==i.type.charAt(0)&&(s="e#VALUE!"),l.PushOperand(o,s,a)},t.Formula.FunctionList.NOT=[t.Formula.NotFunction,1,"v","","test"],t.Formula.ChooseFunction=function(e,o,n,r){var a,l,i,s=0,c=t.Formula,u=c.OperandAsNumber(r,n);for("n"!=u.type.charAt(0)&&(u.value=0),u.value=Math.floor(u.value),l=0;n.length;)if(i=c.TopOfStackValueAndType(r,n),l+=1,u.value==l){s=i.value,a=i.type;break}a?c.PushOperand(o,a,s):c.PushOperand(o,"e#VALUE!",0)},t.Formula.FunctionList.CHOOSE=[t.Formula.ChooseFunction,-2,"choose","","lookup"],t.Formula.ColumnsRowsFunctions=function(e,o,n,r){var a,l,i=0,s=t.Formula,c=s.TopOfStackValueAndType(r,n);"coord"==c.type?(i=1,a="n"):"range"==c.type?(l=s.DecodeRangeParts(r,c.value),"COLUMNS"==e?i=l.ncols:"ROWS"==e&&(i=l.nrows),a="n"):(i=0,a="e#VALUE!"),s.PushOperand(o,a,i)},t.Formula.FunctionList.COLUMNS=[t.Formula.ColumnsRowsFunctions,1,"range","","lookup"],t.Formula.FunctionList.ROWS=[t.Formula.ColumnsRowsFunctions,1,"range","","lookup"],t.Formula.ZeroArgFunctions=function(e,o){var n,r,a,l,i,s={value:0};switch(e){case"FALSE":s.type="nl",s.value=0;break;case"NA":s.type="e#N/A";break;case"NOW":n=new Date,r=n.getTimezoneOffset(),n=n.getTime()/1e3,a=25569,l=86400,i=a+n/l-r/1440,s.value=i,s.type="ndt",t.Formula.FreshnessInfo.volatile.NOW=!0;break;case"PI":s.type="n",s.value=Math.PI;break;case"TODAY":n=new Date,r=n.getTimezoneOffset(),n=n.getTime()/1e3,a=25569,l=86400,i=a+n/l-r/1440,s.value=Math.floor(i),s.type="nd",t.Formula.FreshnessInfo.volatile.TODAY=!0;break;case"TRUE":s.type="nl",s.value=1}return o.push(s),null},t.Formula.FunctionList.FALSE=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.FunctionList.NA=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.FunctionList.NOW=[t.Formula.ZeroArgFunctions,0,"","","datetime"],t.Formula.FunctionList.PI=[t.Formula.ZeroArgFunctions,0,"","","math"],t.Formula.FunctionList.TODAY=[t.Formula.ZeroArgFunctions,0,"","","datetime"],t.Formula.FunctionList.TRUE=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.DDBFunction=function(e,o,n,r){var a,l,i,s,c=t.Formula,u=c.OperandAsNumber(r,n),d=c.OperandAsNumber(r,n),p=c.OperandAsNumber(r,n),f=c.OperandAsNumber(r,n);if(!(c.CheckForErrorValue(o,u)||c.CheckForErrorValue(o,d)||c.CheckForErrorValue(o,p)||c.CheckForErrorValue(o,f))){if(p.value<1)return c.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncddblife),0;if(a={value:2,type:"n"},n.length>0&&(a=c.OperandAsNumber(r,n)),0!=n.length)return c.FunctionArgsError(e,o),0;if(!c.CheckForErrorValue(o,a)){for(l=0,i=0,s=1;s<=f.value-0&&s<=p.value;s++)l=(u.value-i)*(a.value/p.value),u.value-i-l<d.value&&(l=u.value-i-d.value),i+=l;c.PushOperand(o,"n$",l)}}},t.Formula.FunctionList.DDB=[t.Formula.DDBFunction,-4,"ddb","","financial"],t.Formula.SLNFunction=function(e,o,n,r){var a,l=t.Formula,i=l.OperandAsNumber(r,n),s=l.OperandAsNumber(r,n),c=l.OperandAsNumber(r,n);if(!l.CheckForErrorValue(o,i)&&!l.CheckForErrorValue(o,s)&&!l.CheckForErrorValue(o,c)){if(c.value<1)return l.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncslnlife),0;a=(i.value-s.value)/c.value,l.PushOperand(o,"n$",a)}},t.Formula.FunctionList.SLN=[t.Formula.SLNFunction,3,"csl","","financial"],t.Formula.SYDFunction=function(e,o,n,r){var a,l,i=t.Formula,s=i.OperandAsNumber(r,n),c=i.OperandAsNumber(r,n),u=i.OperandAsNumber(r,n),d=i.OperandAsNumber(r,n);if(!(i.CheckForErrorValue(o,s)||i.CheckForErrorValue(o,c)||i.CheckForErrorValue(o,u)||i.CheckForErrorValue(o,d))){if(u.value<1||d.value<=0)return i.PushOperand(o,"e#NUM!",0),0;l=(u.value+1)*u.value/2,a=(s.value-c.value)*(u.value-d.value+1)/l,i.PushOperand(o,"n$",a)}},t.Formula.FunctionList.SYD=[t.Formula.SYDFunction,4,"cslp","","financial"],t.Formula.InterestFunctions=function(e,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C,x,w,S,T,p,F,E,k=t.Formula,_=k.OperandAsNumber(r,n),A=k.OperandAsNumber(r,n),P=k.OperandAsNumber(r,n);if(a=k.LookupResultType(_.type,A.type,k.TypeLookupTable.twoargnumeric),a=k.LookupResultType(a,P.type,k.TypeLookupTable.twoargnumeric),n.length&&(i=k.OperandAsNumber(r,n),a=k.LookupResultType(a,i.type,k.TypeLookupTable.twoargnumeric),n.length&&(s=k.OperandAsNumber(r,n),a=k.LookupResultType(a,s.type,k.TypeLookupTable.twoargnumeric),n.length))){if("RATE"!=e)return k.FunctionArgsError(e,o),0;c=k.OperandAsNumber(r,n),a=k.LookupResultType(a,c.type,k.TypeLookupTable.twoargnumeric)}if("n"==a)switch(e){case"FV":p=_.value,f=A.value,h=P.value,u=null!=i?i.value:0,m=null!=s&&s.value?1:0,d=0==p?-u-h*f:-(u*Math.pow(1+p,f)+h*(1+p*m)*(Math.pow(1+p,f)-1)/p),l=d,a="n$";break;case"NPER":if(p=_.value,h=A.value,u=P.value,d=null!=i?i.value:0,m=null!=s&&s.value?1:0,0==p){if(0==h)return void k.PushOperand(o,"e#NUM!",0);f=(u+d)/-h}else{if(v=h*(1+p*m)/p,b=u+v,0==b||-1>=p)return void k.PushOperand(o,"e#NUM!",0);if(y=(v-d)/b,0>=y)return void k.PushOperand(o,"e#NUM!",0);C=Math.log(y),x=Math.log(1+p),f=C/x}l=f,a="n";break;case"PMT":if(p=_.value,f=A.value,u=P.value,d=null!=i?i.value:0,m=null!=s&&s.value?1:0,0==f)return void k.PushOperand(o,"e#NUM!",0);h=0==p?(d-u)/f:(0-d-u*Math.pow(1+p,f))/((1+p*m)*(Math.pow(1+p,f)-1)/p),l=h,a="n$";break;case"PV":if(p=_.value,f=A.value,h=P.value,d=null!=i?i.value:0,m=null!=s&&s.value?1:0,-1==p)return void k.PushOperand(o,"e#DIV/0!",0);u=0==p?-d-h*f:(-d-h*(1+p*m)*(Math.pow(1+p,f)-1)/p)/Math.pow(1+p,f),l=u,a="n$";break;case"RATE":for(f=_.value,h=A.value,u=P.value,d=null!=i?i.value:0,m=null!=s&&s.value?1:0,g=null!=c?c.value:.1,S=100,T=0,delta=1,epsilon=1e-7,p=g||1e-8;(delta>=0?delta:-delta)>epsilon&&p!=F;)if(delta=d+u*Math.pow(1+p,f)+h*(1+p*m)*(Math.pow(1+p,f)-1)/p,null!=w?(E=(delta-w)/(p-F)||.001,F=p,p-=delta/E,w=delta):(F=p,p=1.1*p,w=delta),T++,T>=S)return void k.PushOperand(o,"e#NUM!",0);l=p,a="n%"}k.PushOperand(o,a,l)},t.Formula.FunctionList.FV=[t.Formula.InterestFunctions,-3,"fv","","financial"],t.Formula.FunctionList.NPER=[t.Formula.InterestFunctions,-3,"nper","","financial"],t.Formula.FunctionList.PMT=[t.Formula.InterestFunctions,-3,"pmt","","financial"],t.Formula.FunctionList.PV=[t.Formula.InterestFunctions,-3,"pv","","financial"],t.Formula.FunctionList.RATE=[t.Formula.InterestFunctions,-3,"rate","","financial"],t.Formula.NPVFunction=function(e,o,n,r){var a,l,i,s,c,u=t.Formula,l=u.OperandAsNumber(r,n);if(!u.CheckForErrorValue(o,l)){for(i=0,a="n",s=1;n.length;)if(c=u.OperandValueAndType(r,n),"n"==c.type.charAt(0)){if(s*=1+l.value,0==s)return void u.PushOperand(o,"e#DIV/0!",0);i+=c.value/s,a=u.LookupResultType(c.type,a||c.type,u.TypeLookupTable.plus)}else if("e"==c.type.charAt(0)&&"e"!=a.charAt(0)){a=c.type;break}"n"==a.charAt(0)&&(a="n$"),u.PushOperand(o,a,i)}},t.Formula.FunctionList.NPV=[t.Formula.NPVFunction,-2,"npv","","financial"],t.Formula.IRRFunction=function(e,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g,v=[],b=[],y=t.Formula;for(v.push(n.pop());v.length;)if(a=y.OperandValueAndType(r,v),"n"==a.type.charAt(0))b.push(a.value);else if("e"==a.type.charAt(0))return void y.PushOperand(o,"e#VALUE!",0);if(!b.length)return void y.PushOperand(o,"e#NUM!",0);if(l={value:0},n.length){if(l=y.OperandAsNumber(r,n),"n"!=l.type.charAt(0)&&"b"!=l.type.charAt(0))return void y.PushOperand(o,"e#VALUE!",0);if(n.length)return void y.FunctionArgsError(e,o)}for(l.value=l.value||.1,s=20,c=0,u=1e-7,d=l.value,h=1;(h>=0?h:-h)>u&&d!=p;){for(h=0,m=1,g=0;g<b.length;g++){if(m*=1+d,0==m)return void y.PushOperand(o,"e#DIV/0!",0);h+=b[g]/m}if(null!=i?(f=(h-i)/(d-p),p=d,d-=h/f,i=h):(p=d,d=1.1*d,i=h),c++,c>=s)return void y.PushOperand(o,"e#NUM!",0)}y.PushOperand(o,"n%",d)},t.Formula.FunctionList.IRR=[t.Formula.IRRFunction,-1,"irr","","financial"],t.Formula.IoFunctions=function(o,n,r,a,l){var i,s,c,u,d={BUTTON:[2],IMAGEBUTTON:[2],EMAIL:[14,14,14,14],EMAILIF:[13,14,14,14,14],EMAILONEDIT:[14,14,14,14,14],EMAILAT:[13,14,14,14,14],EMAILONEDITIF:[14,13,14,14,14,14],EMAILATIF:[13,13,14,14,14,14],SUBMIT:[2],TEXTBOX:[2],AUTOCOMPLETE:[2,14],SELECT:[2,14,1,1],CHECKBOX:[3],RADIOBUTTON:[2,2],COPYVALUE:[4,12,15],COPYFORMULA:[4,12,12],INSERT:[4,8,-12,-15],DELETEIF:[4,7,8],COMMAND:[4,14],COMMANDIF:[4,13,14],PANEL:[15,-12],SPLASH:[12],STYLE:[6]},p=t.Formula,f=0,h="e#VALUE!",m=r.length,g=d[o],v=[],b=[],y=-1;for(i=1;m>=i;i++){if(-1!=y)u=Math.abs(g[c+(i-1-c)%y]);else{if(i>g.length)return void p.FunctionArgsError(o,n);u=g[i-1],0>u&&(y=g.length-(i-1),c=i-1,u=Math.abs(u))}if(1==u)s=p.OperandAsNumber(a,r);else if(2==u)s=p.OperandAsText(a,r);else if(3==u)s=p.OperandValueAndType(a,r);else{var C=r[r.length-1].type,x=!1;if(("n"==C.charAt(0)&&0!=(1&u)||"t"==C.charAt(0)&&0!=(2&u))&&(x=!0,s=p.OperandValueAndType(a,r)),"coord"==C&&0!=(4&u)&&(x=!0,s=p.OperandAsCoord(a,r),s.value=t.Formula.PlainCoord(s.value)),"range"==C&&0!=(8&u)&&(x=!0,s=p.OperandAsRange(a,r),s.value=t.Formula.PlainCoord(s.value)),0==x)return void p.FunctionArgsError(o,n)}if(v[i]=s.value,b[i]=s.type,"e"==s.type.charAt(0))return void p.PushOperand(n,s.type,f)
}switch(o){case"STYLE":var w=a.ioParameterList[l];if(w){var S=t.Formula.getStandardizedList(a,{value:v[1],type:b[1]});S.length>0&&(w.css=S[0],w.cssParameter="t"==b[1]?'"'+v[1]+'"':v[1]),f="",h="ni"}break;case"SELECT":var w=a.ioParameterList[l],T=t.Formula.getStandardizedList(a,w[1]);if(w.html=[],w.html[0]=1==v[4]?"multiple":"",w.html[1]=v[3]?""+v[3]:"1",T.length>0){var F="<option>"+T.join("</option><option>")+"</option>",E=new RegExp("<option>"+v[1],"");w.html[2]=F.replace(E,"<option selected>"+v[1])}f=v[1],h="ti"+o;break;case"SUBMIT":f="Submit";case"BUTTON":case"IMAGEBUTTON":case"TEXTBOX":case"AUTOCOMPLETE":m>0&&(f=v[1]),h="ti"+o;break;case"EMAIL":case"EMAILIF":h="ti"+o,f="Send";break;case"EMAILONEDIT":case"EMAILONEDITIF":case"EMAILAT":case"EMAILATIF":h="ti"+o,f="Send Now";break;case"CHECKBOX":case"RADIOBUTTON":f="t"==b[1].charAt(0)?"TRUE"==v[1].toUpperCase()?1:0:0==v[1]?0:1,h="ni"+o;break;case"COPYVALUE":case"COPYFORMULA":case"INSERT":case"DELETEIF":case"COMMAND":case"COMMANDIF":var k=a.cells[v[1]];if("undefined"==typeof k)break;f=k.datavalue,f=String(f).split("/"),f=f[f.length-1],h="t";break;case"PANEL":case"SPLASH":var _,A=2;if("SPLASH"==o){if(f="SPLASH:"+v[1],h="t",1==a.splashdone)break;a.splashdone=!0,A=1,_=[0]}else _=t.Formula.getStandardizedList(a,{value:v[1],type:b[1]}),f=o+":"+_;if(h="t",t._app){for(var P=[],R=[],L=A;L<v.length;++L){var M=!1;for(var D in _)if(_[D]==L-1){M=!0;break}if(M!==!1){for(var N=t.Formula.getStandardizedCoords(a,{value:v[L],type:b[L]}),i=0;i<N.ncols;i++)R[N.col1num+i]=!0;for(var I=0;I<N.nrows;I++)P[N.row1num+I]=!0}}var O=e.spreadsheet;null==O&&(O=e.ss);var B=!1,U=function(e,t,o,n,r){for(var a=1;t>=a;a++){var l=r(a);"undefined"==typeof o[l]?n[a]!==!0&&(o[l]="yes",B=!0):n[a]===!0&&(delete o[l],B=!0)}},z=function(e){return e};U(a,a.attribs.lastrow,a.rowattribs.hide,P,z),U(a,a.attribs.lastcol,a.colattribs.hide,R,t.rcColname),B&&(a.renderneeded=!0,a.widgetsClean=!1,O.editor.context.rowpanes[0].first=1,O.editor.FitToEditTable())}}p.PushOperand(n,h,f)},t.Formula.FunctionList.BUTTON=[t.Formula.IoFunctions,1,"label","","gui","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.IMAGEBUTTON=[t.Formula.IoFunctions,1,"imageurl","","gui","<input type='image' src='<%=display_value%>' alt='Submit' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\">","ParameterList"],t.Formula.FunctionList.EMAIL=[t.Formula.IoFunctions,-3,"to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.EMAILIF=[t.Formula.IoFunctions,-4,"condition_range, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.EMAILONEDIT=[t.Formula.IoFunctions,-4,"editRange, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],t.Formula.FunctionList.EMAILAT=[t.Formula.IoFunctions,-4,"datetime_value, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],t.Formula.FunctionList.EMAILONEDITIF=[t.Formula.IoFunctions,-5,"editRange, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],t.Formula.FunctionList.EMAILATIF=[t.Formula.IoFunctions,-5,"datetime_value, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],t.Formula.FunctionList.SUBMIT=[t.Formula.IoFunctions,100,"[label]","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.TEXTBOX=[t.Formula.IoFunctions,1,"value","","gui","<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\" value='<%=display_value%>' >","Input"],t.Formula.FunctionList.AUTOCOMPLETE=[t.Formula.IoFunctions,2,"value, range or csv_text","","gui","<input type='text' id='AUTOCOMPLETE_<%=cell_reference%>' onfocus=\"SocialCalc.TriggerIoAction.AddAutocomplete('<%=cell_reference%>');\" onblur='SocialCalc.CmdGotFocus(null);' value='<%=display_value%>' >","Input"],t.Formula.FunctionList.SELECT=[t.Formula.IoFunctions,-2,"value, range or csv_text [,size]","","gui","<select size='<%=html1_value%>' id='SELECT_<%=cell_reference%>' onchange=\"SocialCalc.TriggerIoAction.SelectList('<%=cell_reference%>')\" <%=html0_value%>><%=html2_value%></select>","Input"],t.Formula.FunctionList.CHECKBOX=[t.Formula.IoFunctions,1,"value","","gui","<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\" >","Input"],t.Formula.FunctionList.RADIOBUTTON=[t.Formula.IoFunctions,2,"value, groupname","","gui","<input type='radio' value='<%=cell_reference%>' id='RADIOBUTTON_<%=cell_reference%>' <%=checked%> name='<%=parameter1_value%>' onblur=\"SocialCalc.CmdGotFocus(null);\" onclick=\"SocialCalc.TriggerIoAction.RadioButton('<%=parameter1_value%>');\" >","Input"],t.Formula.FunctionList.COPYVALUE=[t.Formula.IoFunctions,3,"trigger_cell, destinationCell, value_or_range","","action","","EventTree"],t.Formula.FunctionList.COPYFORMULA=[t.Formula.IoFunctions,3,"trigger_cell, destinationCell, formula_range","","action","","EventTree"],t.Formula.FunctionList.INSERT=[t.Formula.IoFunctions,-2,"trigger_cell, destination_range [,formula_range,value_or_range,formula_range, ...]","","action","","EventTree"],t.Formula.FunctionList.DELETEIF=[t.Formula.IoFunctions,-1,"trigger_cell, criteria , test_range","","action","","EventTree"],t.Formula.FunctionList.COMMAND=[t.Formula.IoFunctions,-1,"trigger_cell, commands","","action","","EventTree"],t.Formula.FunctionList.COMMANDIF=[t.Formula.IoFunctions,-1,"trigger_cell, conditions, commands","","action","","EventTree"],t.Formula.FunctionList.PANEL=[t.Formula.IoFunctions,-1,"showindices_range_or_csv, panel1_range [, panel2_range , ...]","","gui",""],t.Formula.FunctionList.SPLASH=[t.Formula.IoFunctions,-1,"splash_panel_range","","gui",""],t.Formula.FunctionList.STYLE=[t.Formula.IoFunctions,-1,"css","","gui",""],t.TriggerIoAction.AddAutocomplete=function(o){var n=e.spreadsheet;null==n&&(n=e.ss);var r=n.sheet,a=(t.Formula,r.ioParameterList[o]);if("undefined"!=typeof a){var l=t.Formula.getStandardizedList(r,a[1]);$.ui.autocomplete.filter=function(e,t){var o=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(t),"i");return $.grep(e,function(e){return o.test(e.label||e.value||e)})},$("#AUTOCOMPLETE_"+o).autocomplete({source:l,minLength:1,autoFocus:!0,select:function(e,n){$(this).val(n.item.label),t.TriggerIoAction.AutoComplete(o)},change:function(e,n){null===n.item&&$(this).val(""),t.TriggerIoAction.AutoComplete(o)}})}},t.TriggerIoAction.Button=function(o){var n=e.spreadsheet;null==n&&(n=e.ss);{var r=n.sheet;t.Formula}if("undefined"!=typeof r.ioEventTree&&"undefined"!=typeof r.ioParameterList&&"undefined"!==r.ioEventTree[o])for(var a in r.ioEventTree[o]){var l=r.ioParameterList[a],i=null;switch(l.function_name){case"COPYVALUE":var s=t.Formula.getStandardizedValues(r,l[2]),c=t.coordToCr(l[1].value),u=t.TriggerIoAction.CopyValueToRange(s,c);n.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"COPYFORMULA":var s=t.Formula.getStandardizedValues(r,l[2]),c=t.coordToCr(l[1].value),u=t.TriggerIoAction.CopyFormulaToRange(s,c);n.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"INSERT":var s=t.Formula.getStandardizedValues(r,l[1]);if("range"!=s.type)break;var d,p,f;s.ncols>1&&(p=1,f=0,d="insertcol"),s.nrows>1&&(p=0,f=1,d="insertrow");for(var h=s.cellcoord[p][f],u=d+" "+h,c=t.coordToCr(h),m=2;m<l.length;)("range"==l[m].type||"coord"==l[m].type||m%2==1)&&(copyCellRange=t.Formula.getStandardizedValues(r,l[m]),u=m%2==0?u+"\n"+t.TriggerIoAction.CopyFormulaToRange(copyCellRange,c):u+"\n"+t.TriggerIoAction.CopyValueToRange(copyCellRange,c),s.nrows>1&&(c.col+=copyCellRange.ncols),s.ncols>1&&(c.row+=copyCellRange.nrows)),m++;n.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"DELETEIF":var p,f,g,v=t.Formula.getStandardizedValues(r,l[1]),b=t.Formula.getStandardizedValues(r,l[2]),u="";if(b.ncols>1&&b.nrows>1)return;b.ncols>1&&(p=1,f=0,g="deletecol"),b.nrows>1&&(p=0,f=1,g="deleterow");for(var y=v.celldata[0][0].datavalue,C=b.ncols-p-1;C>=p;C--)for(var x=b.nrows-f-1;x>=f;x--){var w=b.celldata[C][x];1==t.Formula.TestCriteria(w.datavalue,w.valuetype,y)&&(""!=u&&(u+="\n"),u=u+g+" "+b.cellcoord[C][x])}""!=u&&n.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"COMMANDIF":i=t.Formula.getStandardizedValues(r,l[1]);case"COMMAND":var S,u="";if(null!=i){var S=t.Formula.getStandardizedValues(r,l[2]);if(i.ncols!=S.ncols||i.nrows!=S.nrows)break}else S=t.Formula.getStandardizedValues(r,l[1]);for(var C=0;C<S.ncols;C++)for(var x=0;x<S.nrows;x++){if(null!=i){var T=i.celldata[C][x];if(0==T.datavalue)continue}""!=u&&(u+="\n");var F=S.celldata[C][x];u+=F.datavalue.toString().trim()}""!=u&&n.editor.EditorScheduleSheetCommands(u,!0,!1)}}},t.TriggerIoAction.CopyFormulaToRange=function(e,o){for(var n,r="",a=0;a<e.ncols;a++)for(var l=0;l<e.nrows;l++){var i=e.celldata[a][l],s=t.crToCoord(o.col+a,o.row+l);if((0!=a||0!=l)&&(r+="\n"),"undefined"!=typeof i&&"b"!=i.valuetype){var c=i.datatype,u=i.valuetype,d=i.datavalue,p=i.formula;"f"==c?(p=t.OffsetFormulaCoords(p,o.col-e.col1num,o.row-e.row1num),d="",u=""):"c"!=c&&(p=""),n="set "+s+" "+t.Constants.cellDataType[c]+" "+u+" "+t.encodeForSave(d)+" "+p}else n="set "+s+" empty";r+=n.trim()}return r},t.TriggerIoAction.CopyValueToRange=function(e,o){for(var n,r="",a=0;a<e.ncols;a++)for(var l=0;l<e.nrows;l++){var i=e.celldata[a][l],s=t.crToCoord(o.col+a,o.row+l);if((0!=a||0!=l)&&(r+="\n"),"undefined"!=typeof i&&"b"!=i.valuetype){var c=i.datatype,u=i.valuetype,d=i.datavalue,p=i.formula;"f"==c?(p="",c=u,"n"!=u&&"t"!=u.charAt(0)&&(c="c",p=i.displaystring),"t"==u.charAt(0)&&(c="t")):"c"!=c&&(p=""),n="set "+s+" "+t.Constants.cellDataType[c]+" "+u+" "+t.encodeForSave(d)+" "+p}else n="set "+s+" empty";r+=n.trim()}return r},t.TriggerIoAction.Email=function(o,n){n="undefined"!=typeof n?n:null;var r=t.Formula,a=e.spreadsheet;null==a&&(a=e.ss);var l=a.sheet,i=l.cells[o];if("undefined"!=typeof l.ioParameterList){var s=l.ioParameterList[o];if("undefined"!=typeof s){for(var c=[],u=[],d=1,p=0;p<s.length;p++)if("t"==s[p].type.charAt(0)&&(c[p]=[String(s[p].value).replace(/ /g,"%20")]),"coord"==s[p].type&&(c[p]=[String(l.GetAssuredCell(s[p].value).datavalue).replace(/ /g,"%20")]),"range"==s[p].type){var f=r.DecodeRangeParts(l,s[p].value);c[p]=[],u[p]=[];for(var h=0,m=0;m<f.ncols;m++)for(var g=0;g<f.nrows;g++){var v=t.crToCoord(f.col1num+m,f.row1num+g),i=f.sheetdata.GetAssuredCell(v);c[p].push(i.datavalue.toString().replace(/ /g,"%20")),u[p].push(v),h++}h>d&&(d=h)}var b=-1,y=0;switch(s.function_name){case"EMAILIF":b=0;case"EMAILAT":case"EMAILONEDIT":y=1;break;case"EMAILONEDITIF":case"EMAILATIF":b=1,y=2;break;case"EMAIL":}switch(s.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":n&&"coord"==s[0].type&&s[0].value==n&&(n=null);break;default:n=null}for(var C=!1,x=[],w=d-1;w>-1;w--){if(-1!=b){var S=w>=c[b].length?0:w;if(0==c[b][S])continue}if(!n||n==u[0][w]){var T=w>=c[y].length?0:w,F=w>=c[y+1].length?0:w,E=w>=c[y+2].length?0:w,k=c[y][T]+" "+c[y+1][F]+" "+c[y+2][E];C=!0,l.ScheduleSheetCommands("sendemail "+k,!1),x.push([c[y][T],c[y+1][F],c[y+2][E]])}}return C&&t.EditorSheetStatusCallback(null,"emailing",null,a.editor),x}}},t.TriggerIoAction.Submit=function(){var o=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=o&&1==o.loaded){var n=e.spreadsheet;null==n&&(n=e.ss);for(var r=n.sheet,a=new Date,l=""+a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds(),i=2;i<=o.formFieldsLength+1;i++){var s=t.crToCoord(i,2);l+="\r"+o.sheet.cells[s].datavalue}r.ScheduleSheetCommands("submitform \r"+l,!1)}},t.TriggerIoAction.SelectList=function(e){var o=function(e){return e.value},n="SELECT";t.TriggerIoAction.updateInputWidgetFormula(n,e,o)},t.TriggerIoAction.AutoComplete=function(e){var o=function(e){return e.value},n="AUTOCOMPLETE";t.TriggerIoAction.updateInputWidgetFormula(n,e,o)},t.TriggerIoAction.TextBox=function(e){var o=function(e){return e.value},n="TEXTBOX";t.TriggerIoAction.updateInputWidgetFormula(n,e,o)},t.TriggerIoAction.CheckBox=function(e){var o=function(e){return e.checked?"TRUE":"FALSE"},n="CHECKBOX";t.TriggerIoAction.updateInputWidgetFormula(n,e,o)},t.TriggerIoAction.RadioButton=function(e){var o=function(e){return e.checked?"TRUE":"FALSE"},n="RADIOBUTTON";$('input[name="'+e+'"]').each(function(){t.TriggerIoAction.updateInputWidgetFormula(n,$(this).attr("id").replace(/RADIOBUTTON_/,""),o)})},t.TriggerIoAction.updateInputWidgetFormula=function(o,n,r){var a=e.spreadsheet;null==a&&(a=e.ss);var l=a.sheet,i=(l.cells[n],l.ioParameterList[n]);if("undefined"!=typeof i){var s=document.getElementById(o+"_"+n),c=r(s);c=t.encodeForSave(c);for(var u="set "+n+" formula "+o+'("'+c+'"',d=1;d<i.length;d++)"n"==i[d].type.charAt(0)&&(u+=","+i[d].value),"t"==i[d].type.charAt(0)&&(u+=',"'+i[d].value+'"'),"range"==i[d].type&&(u+=","+i[d].value.toString().replace(/(\$?[A-Z]+\$?[0-9]+)([!]?)([^|]*)[|](\$?[A-Z]+\$?[0-9]+)[|]/i,"$3$2$1:$4")),"coord"==i[d].type&&(u+=","+i[d].value);u+=")",i.cssParameter&&(u+="+style("+i.cssParameter+")"),a.editor.EditorScheduleSheetCommands(u,!0,!1),t.TriggerIoAction.UpdateFormDataSheet(o,n,c)}},t.TriggerIoAction.UpdateFormDataSheet=function(e,o,n){var r=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=r){var a=(e+o).toLowerCase();if(null!=r.formFields[a]){var l=t.crToCoord(r.formFields[a],2);r.sheet.ScheduleSheetCommands("set "+l+" text t "+n,!1)}}},t.Formula.getStandardizedValues=function(e,o){return t.Formula.getStandardizedParameter(e,o,!0,!0)},t.Formula.getStandardizedCoords=function(e,o){return t.Formula.getStandardizedParameter(e,o,!0,!1)},t.Formula.getStandardizedList=function(e,o){var n=[],r=t.Formula.getStandardizedValues(e,o);if(1==r.ncols&&1==r.nrows)n=String(r.celldata[0][0].datavalue).split(",");else for(var a=0;a<r.ncols;a++)for(var l=0;l<r.nrows;l++){var i=r.celldata[a][l];n.push(i.datavalue.toString())}return n},t.Formula.getStandardizedParameter=function(e,o,n,r){var a={type:o.type,value:o.value};if(r&&(a.celldata=[]),"coord"!=o.type&&"range"!=o.type){if(a.ncols=1,a.nrows=1,a.col1num=1,a.row1num=1,n&&(a.cellcoord=null),r){a.celldata[0]=[];var l="n"==o.type?"v":"t"==o.type?o.type:"c";a.celldata[0][0]={coord:null,datatype:l,valuetype:o.type,datavalue:o.value}}}else{var i,s=t.Formula;if("coord"==o.type){var c=t.Formula.PlainCoord(o.value);i=s.DecodeRangeParts(e,c+"|"+c+"|")}"range"==o.type&&(i=s.DecodeRangeParts(e,o.value)),n&&(a.cellcoord=[]);for(var u=0;u<i.ncols;u++)for(var d=0;d<i.nrows;d++){var p=t.crToCoord(i.col1num+u,i.row1num+d);if(n&&("undefined"==typeof a.cellcoord[u]&&(a.cellcoord[u]=[]),a.cellcoord[u][d]=p),r){"undefined"==typeof a.celldata[u]&&(a.celldata[u]=[]);var f=i.sheetdata.GetAssuredCell(p);a.celldata[u][d]=f}}a.ncols=i.ncols,a.nrows=i.nrows,a.col1num=i.col1num,a.row1num=i.row1num}return a},t.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null},t.Formula.FindInSheetCache=function(e){var o=t.Formula.SheetCache,n=t.Formula.NormalizeSheetName(e);return o.sheets[n]?o.sheets[n].sheet:o.waitingForLoading?null:o.loadsheet?(alert("Using SocialCalc.Formula.SheetCache.loadsheet - deprecated"),t.Formula.AddSheetToCache(n,o.loadsheet(n))):(o.waitingForLoading=n,null)},t.Formula.AddSheetToCache=function(e,o,n){var r=null,a=t.Formula.SheetCache,l=a.constants,i=t.Formula.NormalizeSheetName(e);return o&&(r=new t.Sheet,r.ParseSheetSave(o)),a.sheets[i]={sheet:r,recalcstate:l.asloaded,name:i},t.Formula.FreshnessInfo.sheets[i]="undefined"==typeof n||n===!1,r},t.Formula.NormalizeSheetName=function(e){return t.Callbacks.NormalizeSheetName?t.Callbacks.NormalizeSheetName(e):e.toLowerCase()},t.Formula.RemoteFunctionInfo={waitingForServer:null},t.Formula.FreshnessInfo={sheets:{},"volatile":{},recalc_completed:!1},t.Formula.FreshnessInfoReset=function(){var e=t.Formula.FreshnessInfo,o=t.Formula.SheetCache;for(var n in e.sheets)e.sheets[n]===!1&&delete o.sheets[n];e.sheets={},e.volatile={},e.recalc_completed=!1},t.Formula.PlainCoord=function(e){return-1==e.indexOf("$")?e:e.replace(/\$/g,"")},t.Formula.OrderRangeParts=function(e,o){var n,r,a={};return n=t.coordToCr(e),r=t.coordToCr(o),n.col>r.col?(a.c1=r.col,a.c2=n.col):(a.c1=n.col,a.c2=r.col),n.row>r.row?(a.r1=r.row,a.r2=n.row):(a.r1=n.row,a.r2=r.row),a},t.Formula.TestCriteria=function(e,o,n){var r,a,l,i,s;if(null==n)return!1;if(n+="",r=n.charAt(0),"="==r||"<"==r||">"==r?a=n.substring(1):-1!=n.search(/([^~]\*|^\*)/)||-1!=n.search(/([^~]\?|^\?)/)?(r="regex","*"==n?a=".+":(a=n.split("").reverse().join(""),a=a.replace(/\?(?=[^~])|\?$/g,"?.").replace(/\?~/g,"?\\").replace(/\*(?=[^~])|\*$/g,"*.").replace(/\*~/,"*\\"),a=a.split("").reverse().join("")),a="^"+a+"$"):(r=n.substring(0,2),"<="==r||"<>"==r||">="==r?a=n.substring(2):(r="none",a=n)),l=t.DetermineValueType(a),!l.type){if("none"==r)return!1;if("b"==o.charAt(0)){if("="==r)return!0}else if("<>"==r)return!0;return!1}if(i=!1,"n"==l.type.charAt(0)&&"t"==o.charAt(0)&&(s=t.DetermineValueType(e),"n"==s.type.charAt(0)&&(e=s.value,o=s.type)),"n"==o.charAt(0)&&"n"==l.type.charAt(0))switch(e-=0,l.value=l.value-0,r){case"<":i=e<l.value;break;case"<=":i=e<=l.value;break;case"=":case"none":i=e==l.value;break;case">=":i=e>=l.value;break;case">":i=e>l.value;break;case"<>":i=e!=l.value}else if("e"==o.charAt(0))i=!1;else if("e"==l.type.charAt(0))i=!1;else{if("n"==o.charAt(0)&&(e=t.format_number_for_display(e,"n","")),"n"==l.type.charAt(0))return!1;switch(e=e?e.toLowerCase():"",l.value=l.value?l.value.toLowerCase():"",r){case"<":i=e<l.value;break;case"<=":i=e<=l.value;break;case"=":i=e==l.value;break;case"none":i=e.substring(0,l.value.length)==l.value;break;case">=":i=e>=l.value;break;case">":i=e>l.value;break;case"<>":i=e!=l.value;break;case"regex":try{i=-1!=e.search(new RegExp(l.value))}catch(c){i=!1}}}return i};var t;t||(t={}),t.Popup={},t.Popup.Types={},t.Popup.Controls={},t.Popup.Current={},t.Popup.LocalizeString=function(e){return e},t.Popup.Create=function(e,o,n){var r=t.Popup.Types[e];r&&r.Create&&r.Create(e,o,n),t.Popup.imagePrefix=t.Constants.defaultImagePrefix},t.Popup.SetValue=function(e,o){var n=t.Popup,r=n.Types,a=n.Controls;if(!a[e])return void alert("Unknown control "+e);var l=a[e].type,i=r[l],s=a[e].data;i&&i.Create&&(i.SetValue(l,e,o),s.attribs&&s.attribs.changedcallback&&s.attribs.changedcallback(s.attribs,e,o))},t.Popup.SetDisabled=function(e,o){var n=t.Popup,r=n.Types,a=n.Controls;if(!a[e])return void alert("Unknown control "+e);var l=a[e].type,i=r[l];i&&i.Create&&(n.Current.id&&e==n.Current.id&&(i.Hide(l,n.Current.id),n.Current.id=null),i.SetDisabled(l,e,o))},t.Popup.GetValue=function(e){var o=t.Popup,n=o.Types,r=o.Controls;if(!r[e])return void alert("Unknown control "+e);var a=r[e].type,l=n[a];return l&&l.Create?l.GetValue(a,e):null},t.Popup.Initialize=function(e,o){var n=t.Popup,r=n.Types,a=n.Controls;if(!a[e])return void alert("Unknown control "+e);var l=a[e].type,i=r[l];i&&i.Initialize&&i.Initialize(l,e,o)},t.Popup.Reset=function(e){{var o=t.Popup,n=o.Types;o.Controls}n[e].Reset&&n[e].Reset(e)},t.Popup.CClick=function(e){var o=t.Popup,n=o.Types,r=o.Controls;if(!r[e])return void alert("Unknown control "+e);if(!r[e].data||!r[e].data.disabled){var a=r[e].type,l=n[a];if(o.Current.id&&(n[r[o.Current.id].type].Hide(a,o.Current.id),e==o.Current.id))return void(o.Current.id=null);l&&l.Show&&l.Show(a,e),o.Current.id=e}},t.Popup.Close=function(){{var e=t.Popup;e.Types,e.Controls}e.Current.id&&e.CClick(e.Current.id)},t.Popup.Cancel=function(){var e=t.Popup,o=e.Types,n=e.Controls;if(e.Current.id){var r=n[e.Current.id].type,a=o[r];a.Cancel(r,e.Current.id),e.Current.id=null}},t.Popup.CreatePopupDiv=function(e,o){var n,r=t.Popup,a=r.Controls,l=a[e].data,i=document.createElement("div");return i.style.position="absolute",n=t.GetElementPosition(l.mainele),i.style.top=n.top+l.mainele.offsetHeight+"px",i.style.left=n.left+"px",i.style.zIndex=100,i.style.backgroundColor="#FFF",i.style.border="1px solid black",o.width&&(i.style.width=o.width),l.mainele.appendChild(i),o.title&&(i.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+o.title+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.Popup.Cancel();">&nbsp;X&nbsp;</td></tr></table>',o.moveable&&(l.dragregistered=i.firstChild.firstChild.firstChild.firstChild,t.DragRegister(l.dragregistered,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:i},l.mainele))),i},t.Popup.EnsurePosition=function(e,o){function n(e){var o=t.GetElementPosition(e);return o.height=e.offsetHeight,o.width=e.offsetWidth,o.bottom=o.top+o.height,o.right=o.left+o.width,o}var r=t.Popup,a=r.Controls,l=a[e].data,i=l.mainele.firstChild;if(!i)return void alert("No main popup element firstChild.");var s=l.popupele,c=n(s),u=n(o),d=n(i),p=0;d.bottom+c.height<u.bottom&&d.left+c.width<u.right?(s.style.top=d.bottom+"px",s.style.left=d.left+"px",p=1):d.top-c.height>u.top&&d.left+c.width<u.right?(s.style.top=d.top-c.height+"px",s.style.left=d.left+"px",p=2):d.bottom+c.height<u.bottom&&d.right-c.width>u.left?(s.style.top=d.bottom+"px",s.style.left=d.right-c.width+"px",p=3):d.top-c.height>u.top&&d.right-c.width>u.left?(s.style.top=d.top-c.height+"px",s.style.left=d.right-c.width+"px",p=4):d.bottom+c.height<u.bottom&&c.width<u.width?(s.style.top=d.bottom+"px",s.style.left=u.left+Math.floor((u.width-c.width)/2)+"px",p=5):d.top-c.height>u.top&&c.width<u.width?(s.style.top=d.top-c.height+"px",s.style.left=u.left+Math.floor((u.width-c.width)/2)+"px",p=6):c.height<u.height&&d.right+c.width<u.right?(s.style.top=u.top+Math.floor((u.height-c.height)/2)+"px",s.style.left=d.right+"px",p=7):c.height<u.height&&d.left-c.width>u.left&&(s.style.top=u.top+Math.floor((u.height-c.height)/2)+"px",s.style.left=d.left-c.width+"px",p=8)},t.Popup.DestroyPopupDiv=function(e,o){e&&(e.innerHTML="",t.DragUnregister(o),e.parentNode&&e.parentNode.removeChild(e))},t.Popup.RGBToHex=function(e){var o=t.Popup;if(""==e)return"000000";var n=e.match(/(\d+)\D+(\d+)\D+(\d+)/);return n?o.ToHex(n[1])+o.ToHex(n[2])+o.ToHex(n[3]):"000000"},t.Popup.HexDigits="0123456789ABCDEF",t.Popup.ToHex=function(e){var o=t.Popup,n=Math.floor(e/16),r=e%16;return o.HexDigits.charAt(n)+o.HexDigits.charAt(r)},t.Popup.FromHex=function(e){var o=t.Popup,n=o.HexDigits.indexOf(e.charAt(0).toUpperCase()),r=o.HexDigits.indexOf(e.charAt(1).toUpperCase());return 16*(n>=0?n:0)+(r>=0?r:0)},t.Popup.HexToRGB=function(e){var o=t.Popup;return"rgb("+o.FromHex(e.substring(1,3))+","+o.FromHex(e.substring(3,5))+","+o.FromHex(e.substring(5,7))+")"},t.Popup.makeRGB=function(e,t,o){return"rgb("+(e>0?e:0)+","+(t>0?t:0)+","+(o>0?o:0)+")"},t.Popup.splitRGB=function(e){var t=e.match(/(\d+)\D+(\d+)\D+(\d+)\D/);return t?{r:t[1]-0,g:t[2]-0,b:t[3]-0}:{r:0,g:0,b:0}},t.Popup.Types.List={},t.Popup.Types.List.Create=function(e,o,n){var r=t.Popup,a=(r.Types,r.Controls),l={type:e,value:"",display:"",data:{}};a[o]=l;var i=l.data;i.attribs=n||{};var s=document.getElementById(o);return s?(i.mainele=s,s.innerHTML='<input style="cursor:pointer;width:100px;font-size:smaller;" onfocus="this.blur();" onclick="SocialCalc.Popup.CClick(\''+o+'\');" value="">',void(i.options=[])):void alert("Missing element "+o)},t.Popup.Types.List.SetValue=function(e,n,r){var a,l=t.Popup,i=(l.Types,l.Controls),s=i[n].data;for(s.value=r,s.custom=!1,a=0;a<s.options.length;a++)if(o=s.options[a],!(o.a&&(o.a.skip||o.a.custom||o.a.cancel)||o.v!=s.value)){s.display=o.o;break}a==s.options.length&&(s.display="Custom",s.custom=!0),s.mainele&&s.mainele.firstChild&&(s.mainele.firstChild.value=s.display)},t.Popup.Types.List.SetDisabled=function(e,o,n){var r=t.Popup,a=(r.Types,r.Controls),l=a[o].data;l.disabled=n,l.mainele&&l.mainele.firstChild&&(l.mainele.firstChild.disabled=n)},t.Popup.Types.List.GetValue=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data;return a.value},t.Popup.Types.List.Initialize=function(e,o,n){var r,a=t.Popup,l=(a.Types,a.Controls),i=l[o].data;for(r in n.attribs)i.attribs[r]=n.attribs[r];i.options=n?n.options:[],n.value&&a.SetValue(o,n.value)},t.Popup.Types.List.Reset=function(e){var o=t.Popup,n=o.Types,r=o.Controls;o.Current.id&&r[o.Current.id].type==e&&(n[e].Hide(e,o.Current.id),o.Current.id=null)},t.Popup.Types.List.Show=function(e,o){var n,r=t.Popup,a=(r.Types,r.Controls),l=a[o].data,i="";l.popupele=r.CreatePopupDiv(o,l.attribs),l.custom?(i=t.Popup.Types.List.MakeCustom(e,o),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+i+"</div>",l.customele=n.firstChild.firstChild.childNodes[1],l.listdiv=null,l.contentele=n):(i=t.Popup.Types.List.MakeList(e,o),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;">'+i+"</div>",l.customele=null,l.listdiv=n.firstChild,l.contentele=n),l.mainele&&l.mainele.firstChild&&(l.mainele.firstChild.disabled=!0),l.popupele.appendChild(n),l.attribs.ensureWithin&&t.Popup.EnsurePosition(o,l.attribs.ensureWithin)},t.Popup.Types.List.MakeList=function(e,o){var n,r,a,l=t.Popup,i=(l.Types,l.Controls),s=i[o].data,c='<table cellspacing="0" cellpadding="0"><tr>',u='<td style="vertical-align:top;">';for(c+=u,s.ncols=1,n=0;n<s.options.length;n++){if(r=s.options[n],r.a){if(r.a.newcol){c+="</td>"+u+"&nbsp;&nbsp;&nbsp;&nbsp;</td>"+u,s.ncols+=1;continue}if(r.a.skip){c+='<div style="font-size:x-small;white-space:nowrap;">'+r.o+"</div>";continue}}a=r.v!=s.value||r.a&&(r.a.custom||r.a.cancel)?"":"background-color:#DDF;",c+='<div style="font-size:x-small;white-space:nowrap;'+a+'" onclick="SocialCalc.Popup.Types.List.ItemClicked(\''+o+"','"+n+"');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove('"+o+"',this);\">"+r.o+"</div>"}return c+="</td></tr></table>"},t.Popup.Types.List.MakeCustom=function(e,o){var n=t.Popup.LocalizeString,r=t.Popup,a=(r.Types,r.Controls),l=a[o].data,i='style="font-size:smaller;"',s="",c=l.value;return c=t.special_chars(c),s='<div style="white-space:nowrap;"><br><input id="customvalue" value="'+c+'"><br><br><input '+i+' type="button" value="'+n("OK")+'" onclick="SocialCalc.Popup.Types.List.CustomOK(\''+o+"');return false;\"><input "+i+' type="button" value="'+n("List")+'" onclick="SocialCalc.Popup.Types.List.CustomToList(\''+o+"');\"><input "+i+' type="button" value="'+n("Cancel")+'" onclick="SocialCalc.Popup.Close();"><br></div>'},t.Popup.Types.List.ItemClicked=function(e,o){var n,r,a,l=t.Popup,i=(l.Types,l.Controls),s=i[e].data,c=s.options[o].a;return c&&c.custom?(n=s.contentele,r=t.Popup.Types.List.MakeCustom("List",e),a=document.createElement("div"),a.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+r+"</div>",s.customele=a.firstChild.firstChild.childNodes[1],s.listdiv=null,s.contentele=a,s.popupele.replaceChild(a,n),void(s.attribs.ensureWithin&&t.Popup.EnsurePosition(e,s.attribs.ensureWithin))):c&&c.cancel?void t.Popup.Close():(t.Popup.SetValue(e,s.options[o].v),void t.Popup.Close())},t.Popup.Types.List.CustomToList=function(e){var o,n,r,a=t.Popup,l=(a.Types,a.Controls),i=l[e].data;o=i.contentele,n=t.Popup.Types.List.MakeList("List",e),r=document.createElement("div"),r.innerHTML='<div style="cursor:default;padding:4px;">'+n+"</div>",i.customele=null,i.listdiv=r.firstChild,i.contentele=r,i.popupele.replaceChild(r,o),i.attribs.ensureWithin&&t.Popup.EnsurePosition(e,i.attribs.ensureWithin)},t.Popup.Types.List.CustomOK=function(e){var o=t.Popup,n=(o.Types,o.Controls),r=n[e].data;t.Popup.SetValue(e,r.customele.value),t.Popup.Close()},t.Popup.Types.List.MouseMove=function(e,o){var n,r,a=t.Popup,l=(a.Types,a.Controls),i=l[e].data,s=i.listdiv;if(s){var c=s.firstChild.firstChild.firstChild;for(n=0;n<i.ncols;n++)for(r=0;r<c.childNodes[2*n].childNodes.length;r++)c.childNodes[2*n].childNodes[r].style.backgroundColor="#FFF";o.style.backgroundColor="#DDF"}},t.Popup.Types.List.Hide=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data;n.DestroyPopupDiv(a.popupele,a.dragregistered),a.popupele=null,a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=!1)},t.Popup.Types.List.Cancel=function(e,o){t.Popup.Types.List.Hide(e,o)},t.Popup.Types.ColorChooser={},t.Popup.Types.ColorChooser.Create=function(e,o,n){var r=t.Popup,a=(r.Types,r.Controls),l={type:e,value:"",display:"",data:{}};a[o]=l;var i=l.data;i.attribs=n||{};var s=i.attribs;i.value="";var c=document.getElementById(o);return c?(i.mainele=c,void(c.innerHTML='<div style="cursor:pointer;border:1px solid black;vertical-align:top;width:'+(s.sampleWidth||"15px")+";height:"+(s.sampleHeight||"15px")+';" onclick="SocialCalc.Popup.Types.ColorChooser.ControlClicked(\''+o+"');\">&nbsp;</div>")):void alert("Missing element "+o)},t.Popup.Types.ColorChooser.SetValue=function(e,o,n){var r,a,l=t.Popup,i=(l.Types,l.Controls),s=i[o].data,c=s.attribs;s.value=n,s.custom=!1,s.mainele&&s.mainele.firstChild&&(s.value?(s.mainele.firstChild.style.backgroundColor=s.value,r=c.backgroundImage?"url("+l.imagePrefix+c.backgroundImage+")":"",a="center center"):(s.mainele.firstChild.style.backgroundColor="#FFF",c.backgroundImageDefault?(r="url("+l.imagePrefix+c.backgroundImageDefault+")",a="center center"):(r="url("+l.imagePrefix+"defaultcolor.gif)",a="left top")),s.mainele.firstChild.style.backgroundPosition=a,s.mainele.firstChild.style.backgroundImage=r)},t.Popup.Types.ColorChooser.SetDisabled=function(e,o,n){var r=t.Popup,a=(r.Types,r.Controls),l=a[o].data,i=l.attribs;l.disabled=n,l.mainele&&l.mainele.firstChild&&(n?(l.mainele.firstChild.style.backgroundColor="#DDD",i.backgroundImageDisabled?(img="url("+r.imagePrefix+i.backgroundImageDisabled+")",pos="center center"):(img="url("+r.imagePrefix+"defaultcolor.gif)",pos="left top"),l.mainele.firstChild.style.backgroundPosition=pos,l.mainele.firstChild.style.backgroundImage=img):r.SetValue(o,l.value))},t.Popup.Types.ColorChooser.GetValue=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data;return a.value},t.Popup.Types.ColorChooser.Initialize=function(e,o,n){var r,a=t.Popup,l=(a.Types,a.Controls),i=l[o].data;for(r in n.attribs)i.attribs[r]=n.attribs[r];n.value&&a.SetValue(o,n.value)},t.Popup.Types.ColorChooser.Reset=function(e){var o=t.Popup,n=o.Types,r=o.Controls;o.Current.id&&r[o.Current.id].type==e&&(n[e].Hide(e,o.Current.id),o.Current.id=null)},t.Popup.Types.ColorChooser.Show=function(e,o){var n,r,a=t.Popup,l=(a.Types,a.Controls),i=l[o].data,s="";i.oldvalue=i.value,i.popupele=a.CreatePopupDiv(o,i.attribs),i.custom?(s=t.Popup.Types.ColorChooser.MakeCustom(e,o),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+s+"</div>",i.customele=n.firstChild.firstChild.childNodes[2],i.contentele=n):(r=t.Popup.Types.ColorChooser.CreateGrid(e,o),n=document.createElement("div"),n.style.padding="3px",n.style.backgroundColor="#CCC",n.appendChild(r),i.customele=null,i.contentele=n),i.popupele.appendChild(n),i.attribs.ensureWithin&&t.Popup.EnsurePosition(o,i.attribs.ensureWithin)
},t.Popup.Types.ColorChooser.MakeCustom=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data,l=n.LocalizeString,i='style="font-size:smaller;"',s="";return s='<div style="white-space:nowrap;"><br>#<input id="customvalue" style="width:75px;" value="'+a.value+'"><br><br><input '+i+' type="button" value="'+l("OK")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomOK(\''+o+"');return false;\"><input "+i+' type="button" value="'+l("Grid")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\''+o+"');\"><br></div>"},t.Popup.Types.ColorChooser.ItemClicked=function(e){{var o=t.Popup,n=(o.Types,o.Controls);n[e].data}t.Popup.Close()},t.Popup.Types.ColorChooser.CustomToList=function(e){{var o=t.Popup,n=(o.Types,o.Controls);n[e].data}},t.Popup.Types.ColorChooser.CustomOK=function(e){var o=t.Popup,n=(o.Types,o.Controls),r=n[e].data;o.SetValue(e,r.customele.value),o.Close()},t.Popup.Types.ColorChooser.Hide=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data;n.DestroyPopupDiv(a.popupele,a.dragregistered),a.popupele=null},t.Popup.Types.ColorChooser.Cancel=function(e,o){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data;n.SetValue(o,a.oldvalue),t.Popup.Types.ColorChooser.Hide(e,o)},t.Popup.Types.ColorChooser.CreateGrid=function(e,o){var n,r,a,l,i,s=t.Popup,c=s.Types,u=s.Controls,d=s.LocalizeString,p=u[o].data;p.grid={};var f=p.grid,h=document.createElement("div");for(n=document.createElement("table"),n.cellSpacing=0,n.cellPadding=0,n.style.width="100px",f.table=n,n=document.createElement("tbody"),f.table.appendChild(n),f.tbody=n,r=0;16>r;r++){for(a=document.createElement("tr"),l=0;5>l;l++)i={},f[r+","+l]=i,n=document.createElement("td"),n.style.fontSize="1px",n.innerHTML="&nbsp;",n.style.height="10px",1>=l?(n.style.width="17px",n.style.borderRight="3px solid white"):(n.style.width="20px",n.style.backgroundRepeat="no-repeat"),a.appendChild(n),i.ele=n;f.tbody.appendChild(a)}return h.appendChild(f.table),n=document.createElement("div"),n.style.marginTop="3px",n.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td style="width:17px;background-color:#FFF;background-image:url('+s.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;" title="'+d("Default")+'">&nbsp;</td><td style="width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;" title="'+d("Custom")+'">#</td><td style="width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;">'+d("OK")+"</td></tr></table>",f.defaultbox=n.firstChild.firstChild.firstChild.childNodes[0],f.defaultbox.onclick=c.ColorChooser.DefaultClicked,f.custom=n.firstChild.firstChild.firstChild.childNodes[1],f.custom.onclick=c.ColorChooser.CustomClicked,f.msg=n.firstChild.firstChild.firstChild.childNodes[2],f.msg.onclick=c.ColorChooser.CloseOK,h.appendChild(n),f.table.onmousedown=c.ColorChooser.GridMouseDown,c.ColorChooser.DetermineColors(o),c.ColorChooser.SetColors(o),h},t.Popup.Types.ColorChooser.gridToG=function(e,t,o){return e[t+","+o]},t.Popup.Types.ColorChooser.DetermineColors=function(e){var o,n,r=t.Popup,a=r.Types,l=a.ColorChooser,i=r.Controls,s=i[e].data,c=s.grid,u=r.splitRGB(s.value);for(o=2,n=16-Math.floor((u.r+16)/16),c["selectedrow"+o]=n,n=0;16>n;n++)l.gridToG(c,n,o).rgb=r.makeRGB(17*(15-n),0,0);for(o=3,n=16-Math.floor((u.g+16)/16),c["selectedrow"+o]=n,n=0;16>n;n++)l.gridToG(c,n,o).rgb=r.makeRGB(0,17*(15-n),0);for(o=4,n=16-Math.floor((u.b+16)/16),c["selectedrow"+o]=n,n=0;16>n;n++)l.gridToG(c,n,o).rgb=r.makeRGB(0,0,17*(15-n));for(o=1,n=0;16>n;n++)l.gridToG(c,n,o).rgb=r.makeRGB(17*(15-n),17*(15-n),17*(15-n));o=0;var d,p=[0,68,153,204,255],f=["400","310","420","440","442","340","040","042","032","044","024","004","204","314","402","414"];for(n=0;16>n;n++)d=f[n],l.gridToG(c,n,o).rgb="rgb("+p[d.charAt(0)-0]+","+p[d.charAt(1)-0]+","+p[d.charAt(2)-0]+")"},t.Popup.Types.ColorChooser.SetColors=function(e){var o,n,r,a,l=t.Popup,i=l.Types,s=i.ColorChooser,c=l.Controls,u=c[e].data,d=u.grid;for(o=0;16>o;o++)for(n=0;5>n;n++)r=s.gridToG(d,o,n),r.ele.style.backgroundColor=r.rgb,r.ele.title=l.RGBToHex(r.rgb),r.ele.style.backgroundImage=d["selectedrow"+n]==o?"url("+l.imagePrefix+"chooserarrow.gif)":"";l.SetValue(e,u.value),d.msg.style.backgroundColor=u.value,a=l.splitRGB(u.value||"rgb(255,255,255)"),d.msg.style.color=a.r+a.g+a.b<220?"#FFF":"#000",u.value?(d.msg.style.backgroundImage="",d.msg.title=l.RGBToHex(u.value)):(d.msg.style.backgroundColor="#FFF",d.msg.style.backgroundImage="url("+l.imagePrefix+"defaultcolor.gif)",d.msg.title="Default")},t.Popup.Types.ColorChooser.GridMouseDown=function(o){var n=o||e.event,r=t.Popup,a=r.Types,l=a.ColorChooser,i=r.Controls,s=r.Current.id;if(s){var c=i[s].data,u=c.grid;switch(n.type){case"mousedown":u.mousedown=!0;break;case"mouseup":u.mousedown=!1;break;case"mousemove":if(!u.mousedown)return}var d=t.GetElementPositionWithScroll(c.mainele),p=n.clientX-d.left,f=n.clientY-d.top,h=t.GetElementPositionWithScroll(u.table);h.left-=d.left,h.top-=d.top;var m=Math.floor((f-h.top-2)/10);m=0>m?0:m;var g=Math.floor((p-h.left)/20);m=0>m?0:m>15?15:m,g=0>g?0:g>4?4:g;var v=l.gridToG(u,m,g).ele.style.backgroundColor,b=r.splitRGB(v),y=r.splitRGB(c.value);switch(g){case 2:c.value=r.makeRGB(b.r,y.g,y.b);break;case 3:c.value=r.makeRGB(y.r,b.g,y.b);break;case 4:c.value=r.makeRGB(y.r,y.g,b.b);break;case 0:case 1:c.value=v}l.DetermineColors(s),l.SetColors(s)}},t.Popup.Types.ColorChooser.ControlClicked=function(e){var o=t.Popup,n=o.Types,r=n.ColorChooser,a=(o.Controls,o.Current.id);return a&&e==a?void r.CloseOK():void o.CClick(e)},t.Popup.Types.ColorChooser.DefaultClicked=function(o){var n=(o||e.event,t.Popup),r=n.Types,a=(r.ColorChooser,n.Controls),l=n.Current.id;if(l){var i=a[l].data;i.value="",t.Popup.SetValue(l,i.value),t.Popup.Close()}},t.Popup.Types.ColorChooser.CustomClicked=function(o){var n=(o||e.event,t.Popup),r=n.Types,a=(r.ColorChooser,n.Controls),l=n.Current.id;if(l){var i,s,c,u=a[l].data;i=u.contentele,s=t.Popup.Types.ColorChooser.MakeCustom("ColorChooser",l),c=document.createElement("div"),c.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+s+"</div>",u.customele=c.firstChild.firstChild.childNodes[2],u.contentele=c,u.popupele.replaceChild(c,i),u.customele.value=n.RGBToHex(u.value),u.attribs.ensureWithin&&t.Popup.EnsurePosition(l,u.attribs.ensureWithin)}},t.Popup.Types.ColorChooser.CustomToGrid=function(e){var o,n,r=t.Popup,a=(r.Types,r.Controls),l=a[e].data;t.Popup.SetValue(e,r.HexToRGB("#"+l.customele.value));var o,i,n;o=l.contentele,i=t.Popup.Types.ColorChooser.CreateGrid("ColorChooser",e),n=document.createElement("div"),n.style.padding="3px",n.style.backgroundColor="#CCC",n.appendChild(i),l.customele=null,l.contentele=n,l.popupele.replaceChild(n,o),l.attribs.ensureWithin&&t.Popup.EnsurePosition(e,l.attribs.ensureWithin)},t.Popup.Types.ColorChooser.CustomOK=function(e){var o=t.Popup,n=(o.Types,o.Controls),r=n[e].data;t.Popup.SetValue(e,o.HexToRGB("#"+r.customele.value)),t.Popup.Close()},t.Popup.Types.ColorChooser.CloseOK=function(o){var n=(o||e.event,t.Popup),r=n.Types,a=(r.ColorChooser,n.Controls),l=n.Current.id;if(l){var i=a[l].data;t.Popup.SetValue(l,i.value),t.Popup.Close()}};var t;t||(alert("Main SocialCalc code module needed"),t={}),t.TableEditor||alert("SocialCalc TableEditor code module needed"),t.CurrentSpreadsheetControlObject=null,t.SpreadsheetControl=function(e){var o=t.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.tabs=[],this.tabnums={},this.tabreplacements={},this.currentTab=-1,this.views={},this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.moverange="",this.idPrefix=e||"SocialCalc-",this.multipartBoundary="SocialCalcSpreadsheetControlSave",this.imagePrefix=o.defaultImagePrefix,this.toolbarbackground=o.SCToolbarbackground,this.tabbackground=o.SCTabbackground,this.tabselectedCSS=o.SCTabselectedCSS,this.tabplainCSS=o.SCTabplainCSS,this.toolbartext=o.SCToolbartext,this.formulabarheight=o.SCFormulabarheight,this.statuslineheight=o.SCStatuslineheight,this.statuslineCSS=o.SCStatuslineCSS,this.ExportCallback=null,"undefined"==typeof t.debug_log&&(t.debug_log=[]),this.sheet=new t.Sheet,this.context=new t.RenderContext(this.sheet),this.context.showGrid=!0,this.context.showRCHeaders=!0,this.editor=new t.TableEditor(this.context),this.editor.StatusCallback.statusline={func:t.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+"statusline",recalcid1:this.idPrefix+"divider_recalc",recalcid2:this.idPrefix+"button_recalc"}},t.CurrentSpreadsheetControlObject=this,this.editor.MoveECellCallback.movefrom=function(e){var o=t.GetSpreadsheetControlObject();o.context.cursorsuffix="",e.range2.hasrange&&!e.cellhandles.noCursorSuffix&&(e.ecell.row==e.range2.top&&(e.ecell.col<e.range2.left||e.ecell.col>e.range2.right+1)&&(o.context.cursorsuffix="insertleft"),e.ecell.col==e.range2.left&&(e.ecell.row<e.range2.top||e.ecell.row>e.range2.bottom+1)&&(o.context.cursorsuffix="insertup"))},this.formulabuttons={formulafunctions:{image:"insertformula.png",tooltip:"Functions",command:t.SpreadsheetControl.DoFunctionList},multilineinput:{image:"listbox.png",tooltip:"Multi-line Input Box",command:t.SpreadsheetControl.DoMultiline},link:{image:"inserthyperlink.png",tooltip:"Link Input Box",command:t.SpreadsheetControl.DoLink},sum:{image:"autosum.png",tooltip:"Auto Sum",command:t.SpreadsheetControl.DoSum}},this.findbuttons={last:{image:"upsearch.png",tooltip:"Find Previous",command:t.SpreadsheetControl.SearchUp},next:{image:"downsearch.png",tooltip:"Find Next",command:t.SpreadsheetControl.SearchDown}},this.tabnums.edit=this.tabs.length,this.tabs.push({name:"edit",text:"Edit",html:' <div id="%id.edittools" style="padding:10px 0px 0px 0px;">&nbsp;<img id="%id.button_undo" src="%img.undo.png" style="vertical-align:bottom;"> <img id="%id.button_redo" src="%img.redo.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_copy" src="%img.copy.png" style="vertical-align:bottom;"> <img id="%id.button_cut" src="%img.cut.png" style="vertical-align:bottom;"> <img id="%id.button_paste" src="%img.paste.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_delete" src="%img.delete.png" style="vertical-align:bottom;"> <img id="%id.button_pasteformats" src="%img.formatpaintbrush.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;  <span id="%id.locktools"><img id="%id.button_lock" src="%img.lock.png" style="vertical-align:bottom;"> <img id="%id.button_unlock" src="%img.unlock.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;</span> <img id="%id.button_filldown" src="%img.filldown.png" style="vertical-align:bottom;"> <img id="%id.button_fillright" src="%img.fillright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_movefrom" src="%img.movefromoff.gif" style="vertical-align:bottom;"> <img id="%id.button_movepaste" src="%img.movepasteoff.gif" style="vertical-align:bottom;"> <img id="%id.button_moveinsert" src="%img.moveinsertoff.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_alignleft" src="%img.alignleft.png" style="vertical-align:bottom;"> <img id="%id.button_aligncenter" src="%img.aligncenter.png" style="vertical-align:bottom;"> <img id="%id.button_alignright" src="%img.alignright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_borderon" src="%img.borderson.png" style="vertical-align:bottom;">  <img id="%id.button_borderoff" src="%img.bordersoff.png" style="vertical-align:bottom;">  <img id="%id.button_swapcolors" src="%img.swapcolors.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_merge" src="%img.mergecells.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_insertrow" src="%img.insertrows.png" style="vertical-align:bottom;">  <img id="%id.button_insertcol" src="%img.insertcolumns.png" style="vertical-align:bottom;">  <img id="%id.button_deleterow" src="%img.deleterows.png" style="vertical-align:bottom;">  <img id="%id.button_deletecol" src="%img.deletecolumns.png" style="vertical-align:bottom;">  <img id="%id.button_hiderow" src="%img.hiderow.png" style="vertical-align:bottom;">  <img id="%id.button_hidecol" src="%img.hidecol.png" style="vertical-align:bottom;">  &nbsp;<img id="%id.divider_recalc" src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_recalc" src="%img.recalc.png" style="vertical-align:bottom;">  </div>',oncreate:null,onclick:null}),this.tabnums.settings=this.tabs.length,this.tabs.push({name:"settings",text:"Format",html:'<div id="%id.settingstools" style="display:none;"> <div id="%id.sheetsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id="%id.settings-savesheet" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'sheet\');">   <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">   <input type="button" value="%loc!Show Cell Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'cell\');return false;">   </td></tr></table> </div> <div id="%id.cellsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!CELL SETTINGS!: <span id="%id.settingsecell">&nbsp;</span></div>   </td></tr><tr><td>  <input id="%id.settings-savecell" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'cell\');">  <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">  <input type="button" value="%loc!Show Sheet Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'sheet\');return false;">  </td></tr></table> </div></div>',view:"settings",onclick:function(e){t.SettingsControls.idPrefix=e.idPrefix,t.SettingControlReset();var o=e.sheet.EncodeSheetAttributes(),n=e.sheet.EncodeCellAttributes(e.editor.ecell.coord);t.SettingsControlLoadPanel(e.views.settings.values.sheetspanel,o),t.SettingsControlLoadPanel(e.views.settings.values.cellspanel,n),document.getElementById(e.idPrefix+"settingsecell").innerHTML=e.editor.ecell.coord,t.SpreadsheetControlSettingsSwitch("cell"),e.views.settings.element.style.height=e.viewheight+"px",e.views.settings.element.firstChild.style.height=e.viewheight+"px";var r;r=e.editor.range.hasrange?t.crToCoord(e.editor.range.left,e.editor.range.top)+":"+t.crToCoord(e.editor.range.right,e.editor.range.bottom):e.editor.ecell.coord,document.getElementById(e.idPrefix+"settings-savecell").value=t.LocalizeString("Save to")+": "+r},onclickFocus:!0}),this.views.settings={name:"settings",values:{},oncreate:function(e,o){var n=t.Constants;o.values.sheetspanel={colorchooser:{id:e.idPrefix+"scolorchooser"},formatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"formatnumber",initialdata:n.SCFormatNumberFormats},formattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"formattext",initialdata:n.SCFormatTextFormats},fontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"fontfamily",initialdata:n.SCFormatFontfamilies},fontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"fontlook",initialdata:n.SCFormatFontlook},fontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"fontsize",initialdata:n.SCFormatFontsizes},textalignhoriz:{setting:"textalignhoriz",type:"PopupList",id:e.idPrefix+"textalignhoriz",initialdata:n.SCFormatTextAlignhoriz},numberalignhoriz:{setting:"numberalignhoriz",type:"PopupList",id:e.idPrefix+"numberalignhoriz",initialdata:n.SCFormatNumberAlignhoriz},alignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"alignvert",initialdata:n.SCFormatAlignVertical},textcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"textcolor"},bgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"bgcolor"},padtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"padtop",initialdata:n.SCFormatPadsizes},padright:{setting:"padright",type:"PopupList",id:e.idPrefix+"padright",initialdata:n.SCFormatPadsizes},padbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"padbottom",initialdata:n.SCFormatPadsizes},padleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"padleft",initialdata:n.SCFormatPadsizes},colwidth:{setting:"colwidth",type:"PopupList",id:e.idPrefix+"colwidth",initialdata:n.SCFormatColwidth},recalc:{setting:"recalc",type:"PopupList",id:e.idPrefix+"recalc",initialdata:n.SCFormatRecalc},usermaxcol:{setting:"usermaxcol",type:"PopupList",id:e.idPrefix+"usermaxcol",initialdata:n.SCFormatUserMaxCol},usermaxrow:{setting:"usermaxrow",type:"PopupList",id:e.idPrefix+"usermaxrow",initialdata:n.SCFormatUserMaxRow}},o.values.cellspanel={name:"cell",colorchooser:{id:e.idPrefix+"scolorchooser"},cformatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"cformatnumber",initialdata:n.SCFormatNumberFormats},cformattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"cformattext",initialdata:n.SCFormatTextFormats},cfontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"cfontfamily",initialdata:n.SCFormatFontfamilies},cfontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"cfontlook",initialdata:n.SCFormatFontlook},cfontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"cfontsize",initialdata:n.SCFormatFontsizes},calignhoriz:{setting:"alignhoriz",type:"PopupList",id:e.idPrefix+"calignhoriz",initialdata:n.SCFormatTextAlignhoriz},calignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"calignvert",initialdata:n.SCFormatAlignVertical},ctextcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"ctextcolor"},cbgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"cbgcolor"},cbt:{setting:"bt",type:"BorderSide",id:e.idPrefix+"cbt"},cbr:{setting:"br",type:"BorderSide",id:e.idPrefix+"cbr"},cbb:{setting:"bb",type:"BorderSide",id:e.idPrefix+"cbb"},cbl:{setting:"bl",type:"BorderSide",id:e.idPrefix+"cbl"},cpadtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"cpadtop",initialdata:n.SCFormatPadsizes},cpadright:{setting:"padright",type:"PopupList",id:e.idPrefix+"cpadright",initialdata:n.SCFormatPadsizes},cpadbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"cpadbottom",initialdata:n.SCFormatPadsizes},cpadleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"cpadleft",initialdata:n.SCFormatPadsizes}},t.SettingsControlInitializePanel(o.values.sheetspanel),t.SettingsControlInitializePanel(o.values.cellspanel)},replacements:{itemtitle:{regex:/\%itemtitle\./g,replacement:'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},sectiontitle:{regex:/\%sectiontitle\./g,replacement:'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},parttitle:{regex:/\%parttitle\./g,replacement:'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},itembody:{regex:/\%itembody\./g,replacement:'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},bodypart:{regex:/\%bodypart\./g,replacement:'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}},divStyle:"border:1px solid black;overflow:auto;",html:'<div id="%id.scolorchooser" style="display:none;position:absolute;z-index:20;"></div><table cellspacing="0" cellpadding="0"> <tr><td style="vertical-align:top;"><table id="%id.sheetsettingstable" style="display:none;" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.formatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.formattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id="%id.textalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id="%id.numberalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.alignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.fontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.fontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.fontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.textcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.bgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.padtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.padright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.padbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.padleft"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.colwidth"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.recalc"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Dimensions!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Columns!</div>     <span id="%id.usermaxcol"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Rows!</div>     <span id="%id.usermaxrow"></span>    </td>   </tr></table> </td></tr></table><table id="%id.cellsettingstable" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.cformatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.cformattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id="%id.calignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.calignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.cfontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.cfontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.cfontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.ctextcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.cbgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0">    <tr><td %bodypart. colspan="3"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id="%id.cbt-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbt-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbr-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbr-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbb-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbb-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbl-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbl-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.cpadtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.cpadright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.cpadbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.cpadleft"></span>    </td>   </tr></table> </td></tr></table> </td><td style="vertical-align:top;padding:12px 0px 0px 12px;">  <div style="width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;">   <table cellspacing="0" cellpadding="0"><tr>    <td id="sample-text" style="height:100px;width:100px;"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'},this.tabnums.sort=this.tabs.length,this.tabs.push({name:"sort",text:"Sort",html:' <div id="%id.sorttools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:4px;width:160px;">    <div style="%tbt.">%loc!Set Cells To Sort!</div>    <select id="%id.sortlist" size="1" onfocus="%s.CmdGotFocus(this);"><option selected>[select range]</option><option value="all">Sort All</option></select>    <input type="button" value="%loc!OK!" onclick="%s.DoCmd(this, \'ok-setsort\');" style="font-size:x-small;">   </td>   <td style="vertical-align:middle;padding-right:16px;width:100px;text-align:right;">    <div style="%tbt.">&nbsp;</div>    <input type="button" id="%id.sortbutton" value="%loc!Sort Cells! A1:A1" onclick="%s.DoCmd(this, \'dosort\');" style="visibility:hidden;">   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Major Sort!</div>      <select id="%id.majorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="majorsort" id="%id.majorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="majorsort" id="%id.majorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Minor Sort!</div>      <select id="%id.minorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="minorsort" id="%id.minorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="minorsort" id="%id.minorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Last Sort!</div>      <select id="%id.lastsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="lastsort" id="%id.lastsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="lastsort" id="%id.lastsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',onclick:t.SpreadsheetControlSortOnclick}),this.editor.SettingsCallbacks.sort={save:t.SpreadsheetControlSortSave,load:t.SpreadsheetControlSortLoad},this.tabnums.audit=this.tabs.length,this.tabs.push({name:"audit",text:"Audit",html:'<div id="%id.audittools" style="display:none;"> <div style="%tbt.">&nbsp;</div></div>',view:"audit",onclick:function(e){var o,n,r=t.LocalizeString,a='<table cellspacing="0" cellpadding="0" style="margin-bottom:10px;"><tr><td style="font-size:small;padding:6px;"><b>'+r("Audit Trail This Session")+":</b><br><br>",l=e.sheet.changes.stack,i=e.sheet.changes.tos;for(o=0;o<l.length;o++)for(o==i+1&&(a+='<br></td></tr><tr><td style="font-size:small;background-color:#EEE;padding:6px;">'+r("UNDONE STEPS")+":<br>"),n=0;n<l[o].command.length;n++)a+=t.special_chars(l[o].command[n])+"<br>";var s=function(e){if("string"==typeof e)return e;if(!e)return"null";if("object"==typeof e){s.check||(s.check=new Array);for(var t=0,o=s.check.length;o>t;++t)if(s.check[t]==e)return"{}";s.check.push(e)}var o="",n="undefined"==typeof e.length?1:0,r="";for(var a in e)n&&(o="'"+a+"':"),r+="string"==typeof e[a]?o+"'"+e[a]+"',":"object"==typeof e[a]?o+s(e[a])+",":o+e[a]+",";return"object"==typeof e&&s.check.pop(),n?"{"+r.slice(0,-1)+"}":"["+r.slice(0,-1)+"]"};if("undefined"!=typeof t.debug_log)for(var c in t.debug_log)a+=s(t.debug_log[c])+"<br>";e.views.audit.element.innerHTML=a+"</td></tr></table>",t.CmdGotFocus(!0)},onclickFocus:!0}),this.views.audit={name:"audit",divStyle:"border:1px solid black;overflow:auto;",html:"Audit Trail"},this.tabnums.comment=this.tabs.length,this.tabs.push({name:"comment",text:"Comment",html:'<div id="%id.commenttools" style="display:none;"><table cellspacing="0" cellpadding="0"><tr><td><textarea id="%id.commenttext" style="font-size:small;height:32px;width:600px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea></td><td style="vertical-align:top;">&nbsp;<input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlCommentSet();" style="font-size:x-small;"></td></tr></table></div>',view:"sheet",onclick:t.SpreadsheetControlCommentOnclick,onunclick:t.SpreadsheetControlCommentOnunclick}),this.tabnums.names=this.tabs.length,this.tabs.push({name:"names",text:"Names",html:'<div id="%id.namestools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">%loc!Existing Names!</div>    <select id="%id.nameslist" size="1" onchange="%s.SpreadsheetControlNamesChangedName();" onfocus="%s.CmdGotFocus(this);"><option selected>[New]</option></select>   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Name!</div>    <input type="text" id="%id.namesname" style="font-size:x-small;width:75px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Description!</div>    <input type="text" id="%id.namesdesc" style="font-size:x-small;width:150px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Value!</div>    <input type="text" id="%id.namesvalue" width="16" style="font-size:x-small;width:100px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:12px;width:100px;">    <div style="%tbt.">%loc!Set Value To!</div>    <input type="button" id="%id.namesrangeproposal" value="A1" onclick="%s.SpreadsheetControlNamesSetValue();" style="font-size:x-small;">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">&nbsp;</div>    <input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlNamesSave();" style="font-size:x-small;">    <input type="button" value="%loc!Delete!" onclick="%s.SpreadsheetControlNamesDelete()" style="font-size:x-small;">   </td>  </tr></table></div>',view:"sheet",onclick:t.SpreadsheetControlNamesOnclick,onunclick:t.SpreadsheetControlNamesOnunclick}),this.tabnums.clipboard=this.tabs.length,this.tabs.push({name:"clipboard",text:"Clipboard",html:'<div id="%id.clipboardtools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">     &nbsp;    </div>   </td>  </tr></table></div>',view:"clipboard",onclick:t.SpreadsheetControlClipboardOnclick,onclickFocus:"clipboardtext"}),this.views.clipboard={name:"clipboard",divStyle:"overflow:auto;",html:' <div style="font-size:x-small;padding:5px 0px 10px 0px;">  <b>%loc!Display Clipboard in!:</b>  <input type="radio" id="%id.clipboardformat-tab" name="%id.clipboardformat" checked onclick="%s.SpreadsheetControlClipboardFormat(\'tab\');"> %loc!Tab-delimited format! &nbsp;  <input type="radio" id="%id.clipboardformat-csv" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'csv\');"> %loc!CSV format! &nbsp;  <input type="radio" id="%id.clipboardformat-scsave" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'scsave\');"> %loc!SocialCalc-save format! </div> <input type="button" value="%loc!Load SocialCalc Clipboard With This!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardLoad();">&nbsp;  <input type="button" value="%loc!Clear SocialCalc Clipboard!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardClear();">&nbsp;  <br> <textarea id="%id.clipboardtext" style="font-size:small;height:350px;width:800px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea>'}
},t.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(e,o,n,r){return t.InitializeSpreadsheetControl(this,e,o,n,r)},t.SpreadsheetControl.prototype.DoOnResize=function(){return t.DoOnResize(this)},t.SpreadsheetControl.prototype.SizeSSDiv=function(){return t.SizeSSDiv(this)},t.SpreadsheetControl.prototype.ExecuteCommand=function(e,o){return t.SpreadsheetControlExecuteCommand(this,e,o)},t.SpreadsheetControl.prototype.CreateSheetHTML=function(){return t.SpreadsheetControlCreateSheetHTML(this)},t.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(e){return t.SpreadsheetControlCreateSpreadsheetSave(this,e)},t.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(e){return t.SpreadsheetControlDecodeSpreadsheetSave(this,e)},t.SpreadsheetControl.prototype.CreateCellHTML=function(e){return t.SpreadsheetControlCreateCellHTML(this,e)},t.SpreadsheetControl.prototype.CreateCellHTMLSave=function(e){return t.SpreadsheetControlCreateCellHTMLSave(this,e)},t.SpreadsheetControl.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},t.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()},t.InitializeSpreadsheetControl=function(e,o,n,r,a){var l,i,s,c,u,d,p,f,h=t.Constants,m=t.LocalizeString,g=t.LocalizeSubstrings,v=e.tabs,b=e.views;for(e.requestedHeight=n,e.requestedWidth=r,e.requestedSpaceBelow=a,"string"==typeof o&&(o=document.getElementById(o)),null==o&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=o,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),i=o.firstChild;null!=i;i=o.firstChild)o.removeChild(i);for(l="<div>",l+='<div style="'+e.tabbackground+'"><table cellpadding="0" cellspacing="0"><tr>',s=0;s<v.length;s++)l+='  <td id="%id.'+v[s].name+'tab" style="'+(0==s?e.tabselectedCSS:e.tabplainCSS)+'" onclick="%s.SetTab(this);">'+m(v[s].text)+"</td>";for(l+=" </tr></table></div>",l+='<div style="'+e.toolbarbackground+'padding:12px 10px 10px 4px;">',s=0;s<v.length;s++)l+=v[s].html;l+="</div>",l+="</div>",e.currentTab=0;for(d in e.tabreplacements)l=l.replace(e.tabreplacements[d].regex,e.tabreplacements[d].replacement);l=l.replace(/\%s\./g,"SocialCalc."),l=l.replace(/\%id\./g,e.idPrefix),l=l.replace(/\%tbt\./g,e.toolbartext),l=l.replace(/\%img\./g,e.imagePrefix),l=g(l),e.spreadsheetDiv.innerHTML=l,o.appendChild(e.spreadsheetDiv),e.Buttons={button_undo:{tooltip:"Undo",command:"undo"},button_redo:{tooltip:"Redo",command:"redo"},button_copy:{tooltip:"Copy",command:"copy"},button_cut:{tooltip:"Cut",command:"cut"},button_paste:{tooltip:"Paste",command:"paste"},button_pasteformats:{tooltip:"Paste Formats",command:"pasteformats"},button_lock:{tooltip:"Lock Cell",command:"lock"},button_unlock:{tooltip:"Unlock Cell",command:"unlock"},button_delete:{tooltip:"Delete Cell Contents",command:"delete"},button_filldown:{tooltip:"Fill Down",command:"filldown"},button_fillright:{tooltip:"Fill Right",command:"fillright"},button_movefrom:{tooltip:"Set/Clear Move From",command:"movefrom"},button_movepaste:{tooltip:"Move Paste",command:"movepaste"},button_moveinsert:{tooltip:"Move Insert",command:"moveinsert"},button_alignleft:{tooltip:"Align Left",command:"align-left"},button_aligncenter:{tooltip:"Align Center",command:"align-center"},button_alignright:{tooltip:"Align Right",command:"align-right"},button_borderon:{tooltip:"Borders On",command:"borderon"},button_borderoff:{tooltip:"Borders Off",command:"borderoff"},button_swapcolors:{tooltip:"Swap Colors",command:"swapcolors"},button_merge:{tooltip:"Merge/Unmerge Cells",command:"merge"},button_insertrow:{tooltip:"Insert Row Before",command:"insertrow"},button_insertcol:{tooltip:"Insert Column Before",command:"insertcol"},button_deleterow:{tooltip:"Delete Row",command:"deleterow"},button_deletecol:{tooltip:"Delete Column",command:"deletecol"},button_hiderow:{tooltip:"Hide Row",command:"hiderow"},button_hidecol:{tooltip:"Hide Column",command:"hidecol"},button_recalc:{tooltip:"Recalculate",command:"recalc"}};for(p in e.Buttons)f=document.getElementById(e.idPrefix+p),f?(f.style.border="1px solid "+h.ISCButtonBorderNormal,t.TooltipRegister(f,m(e.Buttons[p].tooltip),{},e.spreadsheetDiv),t.ButtonRegister(e.editor,f,{normalstyle:"border:1px solid "+h.ISCButtonBorderNormal+";background-color:"+h.ISCButtonNormalBackground+";",hoverstyle:"border:1px solid "+h.ISCButtonBorderHover+";background-color:"+h.ISCButtonHoverBackground+";",downstyle:"border:1px solid "+h.ISCButtonBorderDown+";background-color:"+h.ISCButtonDownBackground+";"},{MouseDown:t.DoButtonCmd,command:e.Buttons[p].command})):alert("Button "+(e.idPrefix+p)+" missing");e.formulabarDiv=document.createElement("div"),e.formulabarDiv.innerHTML='<input type="text" size="60" value="">&nbsp;',e.spreadsheetDiv.appendChild(e.formulabarDiv);new t.InputBox(e.formulabarDiv.firstChild,e.editor);for(p in e.formulabuttons)f=document.createElement("img"),f.id=e.idPrefix+p,f.src=(e.formulabuttons[p].skipImagePrefix?"":e.imagePrefix)+e.formulabuttons[p].image,f.style.verticalAlign="middle",f.style.border="1px solid #FFF",f.style.marginLeft="4px",t.TooltipRegister(f,m(e.formulabuttons[p].tooltip),{},e.spreadsheetDiv),t.ButtonRegister(e.editor,f,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.formulabuttons[p].command,Disabled:function(){return e.editor.ECellReadonly()}}),e.formulabarDiv.appendChild(f);var y=$("<input id='searchbarinput' value='' placeholder='Search sheet…'>"),C=$("<span id='searchbar'></span>");C.append("<div id='searchstatus'></div>"),C.append(y);for(p in e.findbuttons)f=document.createElement("img"),f.id=e.idPrefix+p,f.src=e.imagePrefix+e.findbuttons[p].image,f.style.verticalAlign="middle",f.style.border="1px solid #FFF",t.TooltipRegister(f,m(e.findbuttons[p].tooltip),{},e.formulabardiv),t.ButtonRegister(e.editor,f,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.findbuttons[p].command,Disabled:function(){return!1}}),C[0].appendChild(f);for(y.on("input",t.SpreadsheetControl.FindInSheet),y.on("focus",function(){t.Keyboard.passThru=!0}),y.on("blur",function(){t.Keyboard.passThru=!1}),y.keyup(function(e){13==e.keyCode&&(e.shiftKey?t.SpreadsheetControl.SearchUp():t.SpreadsheetControl.SearchDown())}),e.formulabarDiv.appendChild(C[0]),s=0;s<v.length;s++)v[s].oncreate&&v[s].oncreate(e,v[s].name);t.CalculateSheetNonViewHeight(e),e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight);var x=document.createElement("div");x.id="te_appView",x.appendChild(e.editorDiv),e.editorDiv=x;var w=document.createElement("div");w.id="te_formData",w.style.display="none",e.editorDiv.appendChild(w),e.spreadsheetDiv.appendChild(e.editorDiv),e.formDataViewer=new t.SpreadsheetViewer("te_FormData-"),e.formDataViewer.InitializeSpreadsheetViewer(w.id,180,0,200);for(c in b){l=b[c].html;for(d in b[c].replacements)l=l.replace(b[c].replacements[d].regex,b[c].replacements[d].replacement);l=l.replace(/\%s\./g,"SocialCalc."),l=l.replace(/\%id\./g,e.idPrefix),l=l.replace(/\%tbt\./g,e.toolbartext),l=l.replace(/\%img\./g,e.imagePrefix),u=document.createElement("div"),t.setStyles(u,b[c].divStyle),u.style.display="none",u.style.width=e.width+"px",u.style.height=e.viewheight+"px",u.id=e.idPrefix+b[c].name+"view",l=g(l),u.innerHTML=l,e.spreadsheetDiv.appendChild(u),b[c].element=u,b[c].oncreate&&b[c].oncreate(e,b[c])}if(b.sheet={name:"sheet",element:e.editorDiv},e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-(e.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(e.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.spreadsheetDiv.addEventListener)e.spreadsheetDiv.addEventListener("mousedown",function(){t.SetSpreadsheetControlObject(e)},!1),e.spreadsheetDiv.addEventListener("mouseover",function(){t.SetSpreadsheetControlObject(e)},!1);else{if(!e.spreadsheetDiv.attachEvent)throw t.Constants.s_BrowserNotSupported;e.spreadsheetDiv.attachEvent("onmousedown",function(){t.SetSpreadsheetControlObject(e)}),e.spreadsheetDiv.attachEvent("onmouseover",function(){t.SetSpreadsheetControlObject(e)})}},t.CalculateSheetNonViewHeight=function(e){e.nonviewheight=e.statuslineheight;for(var t=0;t<e.spreadsheetDiv.childNodes.length;t++)"SocialCalc-statusline"!=e.spreadsheetDiv.childNodes[t].id&&(e.nonviewheight+=e.spreadsheetDiv.childNodes[t].offsetHeight)},t.LocalizeString=function(e){var o=t.LocalizeStringList[e];return o||(o=t.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,t.LocalizeStringList[e]=o),o},t.LocalizeStringList={},t.LocalizeSubstrings=function(e){var o=t.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,n,r){return"ssc"==n?t.Constants[r]||alert("Missing constant: "+r):o(r)})},t.GetSpreadsheetControlObject=function(){var e=t.CurrentSpreadsheetControlObject;return e?e:void 0},t.SetSpreadsheetControlObject=function(e){t.CurrentSpreadsheetControlObject=e,t.Keyboard.focusTable&&e&&(t.Keyboard.focusTable=e.editor)},t.DoOnResize=function(e){var t,o=e.views,n=e.SizeSSDiv();if(n){for(vname in o)t=o[vname].element,t.style.width=e.width+"px",t.style.height=e.height-e.nonviewheight+"px";e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},t.SizeSSDiv=function(e){var o,n,r,a,l,i=10,s=10;return r=!1,o=t.GetViewportInfo(),n=t.GetElementPosition(e.parentNode),n.bottom=0,n.right=0,a=e.parentNode.style,a.marginTop&&(n.top+=a.marginTop.slice(0,-2)-0),a.marginBottom&&(n.bottom+=a.marginBottom.slice(0,-2)-0),a.marginLeft&&(n.left+=a.marginLeft.slice(0,-2)-0),a.marginRight&&(n.right+=a.marginRight.slice(0,-2)-0),l=e.requestedHeight||o.height-(n.top+n.bottom+s)-(e.requestedSpaceBelow||0),e.height!=l&&(e.height=l,e.spreadsheetDiv.style.height=l+"px",r=!0),l=e.requestedWidth||o.width-(n.left+n.right+i)||700,e.width!=l&&(e.width=l,e.spreadsheetDiv.style.width=l+"px",r=!0),e.spreadsheetDiv.style.position="relative",r},t.SetTab=function(e){var o,n,r,a,l,i,s,c={},u={},d=t.GetSpreadsheetControlObject(),p=d.tabs,f=d.views;if(o="string"==typeof e?e:e.id.slice(d.idPrefix.length,-3),d.editor.busy&&(!p[d.currentTab].view||"sheet"==p[d.currentTab].view))for(l=0;l<p.length;l++)if(p[l].name==o&&p[l].view&&"sheet"!=p[l].view)return;for(d.tabs[d.currentTab].onunclick&&d.tabs[d.currentTab].onunclick(d,d.tabs[d.currentTab].name),l=0;l<p.length;l++)n=p[l].name,c[n]=document.getElementById(d.idPrefix+n+"tab"),u[n]=document.getElementById(d.idPrefix+n+"tools"),n==o?(r=l,u[n].style.display="block",c[n].style.cssText=d.tabselectedCSS):(u[n].style.display="none",c[n].style.cssText=d.tabplainCSS);d.currentTab=r,p[r].onclick&&p[r].onclick(d,o);for(i in f)!p[r].view&&"sheet"==i||p[r].view==i?(f[i].element.style.display="block",a=i):f[i].element.style.display="none";p[r].onclickFocus?(s=p[r].onclickFocus,"string"==typeof s&&(s=document.getElementById(d.idPrefix+s),s.focus()),t.CmdGotFocus(s)):t.KeyboardFocus(),f[a].needsresize&&f[a].onresize&&(f[a].needsresize=!1,f[a].onresize(d,f[a])),"sheet"==a?(d.statuslineDiv.style.display="block",d.editor.ScheduleRender()):d.statuslineDiv.style.display="none"},t.SpreadsheetControlStatuslineCallback=function(e,t,o,n){var r,a,l=document.getElementById(n.statuslineid);switch(l&&(l.innerHTML=e.GetStatuslineString(t,o,n)),t){case"cmdendnorender":case"calcfinished":case"doneposcalc":if(r=document.getElementById(n.recalcid1),a=document.getElementById(n.recalcid2),!r||!a)break;"yes"==e.context.sheetobj.attribs.needsrecalc?(r.style.display="inline",a.style.display="inline"):(r.style.display="none",a.style.display="none")}},t.UpdateSortRangeProposal=function(e){var o=document.getElementById(t.GetSpreadsheetControlObject().idPrefix+"sortlist");o.options[0].text=e.range.hasrange?t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom):t.LocalizeString("[select range]")},t.LoadColumnChoosers=function(e){var o,n,r,a,l,i,s,c=t.LocalizeString;e.sortrange&&-1==e.sortrange.indexOf(":")?(n=t.Formula.LookupName(e.sheet,e.sortrange||""),"range"==n.type?(r=n.value.match(/^(.*)\|(.*)\|$/),o=r[1]+":"+r[2]):o="A1:A1"):o=e.sortrange;var u=t.ParseRange(o);i=document.getElementById(e.idPrefix+"majorsort"),s=i.selectedIndex,i.options.length=0,i.options[i.options.length]=new Option(c("[None]"),"");for(var a=u.cr1.col;a<=u.cr2.col;a++)l=t.rcColname(a),i.options[i.options.length]=new Option(c("Column ")+l,l);i.selectedIndex=s>1&&s<=u.cr2.col-u.cr1.col+1?s:1,i=document.getElementById(e.idPrefix+"minorsort"),s=i.selectedIndex,i.options.length=0,i.options[i.options.length]=new Option(c("[None]"),"");for(var a=u.cr1.col;a<=u.cr2.col;a++)l=t.rcColname(a),i.options[i.options.length]=new Option(l,l);i.selectedIndex=s>0&&s<=u.cr2.col-u.cr1.col+1?s:0,i=document.getElementById(e.idPrefix+"lastsort"),s=i.selectedIndex,i.options.length=0,i.options[i.options.length]=new Option(c("[None]"),"");for(var a=u.cr1.col;a<=u.cr2.col;a++)l=t.rcColname(a),i.options[i.options.length]=new Option(l,l);i.selectedIndex=s>0&&s<=u.cr2.col-u.cr1.col+1?s:0},t.CmdGotFocus=function(e){t.Keyboard.passThru=e},t.DoButtonCmd=function(e,o,n){t.DoCmd(n.element,n.functionobj.command)},t.DoCmd=function(e,o){var n,r,a,l,i,s,c,u,d,p,f,h,m,g,v,b,y,C,x,w,S,T=t.GetSpreadsheetControlObject(),F=T.editor;switch(o){case"undo":T.ExecuteCommand("undo","");break;case"redo":T.ExecuteCommand("redo","");break;case"fill-rowcolstuff":case"fill-text":for(a=o.substring(5),i=document.getElementById(T.idPrefix+a+"list"),i.length=0,l=0;l<t.SpreadsheetCmdTable[a].length;l++)i.options[l]=new Option(t.SpreadsheetCmdTable[a][l].t);o="changed-"+a;case"changed-rowcolstuff":case"changed-text":for(a=o.substring(8),i=document.getElementById(T.idPrefix+a+"list"),s=t.SpreadsheetCmdTable.slists[t.SpreadsheetCmdTable[a][i.selectedIndex].s],c=document.getElementById(T.idPrefix+a+"slist"),c.length=0,l=0;l<(s.length||0);l++)c.options[l]=new Option(s[l].t,s[l].s);return;case"ok-rowcolstuff":case"ok-text":a=o.substring(3),i=document.getElementById(T.idPrefix+a+"list"),c=document.getElementById(T.idPrefix+a+"slist"),n=t.SpreadsheetCmdTable[a][i.selectedIndex].c,r=c[c.selectedIndex].value,t.SpreadsheetControlExecuteCommand(e,n,r);break;case"ok-setsort":if(f=document.getElementById(T.idPrefix+"sortlist"),0==f.selectedIndex)T.sortrange=F.range.hasrange?t.crToCoord(F.range.left,F.range.top)+":"+t.crToCoord(F.range.right,F.range.bottom):F.ecell.coord+":"+F.ecell.coord;else{var E=f.options[f.selectedIndex].value;if("all"==E){var k=T.sheet.cells,_=-1,A=-1,P=-1,R=-1;for(var L in k){var M=t.coordToCr(L);(-1==P||M.row<P)&&(P=M.row),(-1==_||M.col<_)&&(_=M.col),(-1==R||M.row>R)&&(R=M.row),(-1==A||M.col>A)&&(A=M.col)}T.sortrange=t.crToCoord(_,P)+":"+t.crToCoord(A,R),f.options[f.selectedIndex].text+=" ("+T.sortrange+")"}else T.sortrange=f.options[f.selectedIndex].value}return h=document.getElementById(T.idPrefix+"sortbutton"),h.value=t.LocalizeString("Sort ")+T.sortrange,h.style.visibility="visible",t.LoadColumnChoosers(T),e&&e.blur&&e.blur(),void t.KeyboardFocus();case"dosort":if(T.sortrange&&-1==T.sortrange.indexOf(":")){if(g=t.Formula.LookupName(T.sheet,T.sortrange||""),"range"!=g.type)return;v=g.value.match(/^(.*)\|(.*)\|$/),m=v[1]+":"+v[2]}else m=T.sortrange;if("A1:A1"==m)return;u="sort "+m+" ",d=document.getElementById(T.idPrefix+"majorsort"),p=document.getElementById(T.idPrefix+"majorsortup"),u+=d.options[d.selectedIndex].value+(p.checked?" up":" down"),d=document.getElementById(T.idPrefix+"minorsort"),d.selectedIndex>0&&(p=document.getElementById(T.idPrefix+"minorsortup"),u+=" "+d.options[d.selectedIndex].value+(p.checked?" up":" down")),d=document.getElementById(T.idPrefix+"lastsort"),d.selectedIndex>0&&(p=document.getElementById(T.idPrefix+"lastsortup"),u+=" "+d.options[d.selectedIndex].value+(p.checked?" up":" down")),T.ExecuteCommand(u,"");break;case"merge":n=t.SpreadsheetCmdLookup[o]||"",r=t.SpreadsheetCmdSLookup[o]||"",T.ExecuteCommand(n,r),F.range.hasrange&&(F.MoveECell(t.crToCoord(F.range.left,F.range.top)),F.RangeRemove());break;case"movefrom":F.range2.hasrange?(T.context.cursorsuffix="",F.Range2Remove(),T.ExecuteCommand("redisplay","")):F.range.hasrange?(F.range2.top=F.range.top,F.range2.right=F.range.right,F.range2.bottom=F.range.bottom,F.range2.left=F.range.left,F.range2.hasrange=!0,F.MoveECell(t.crToCoord(F.range.left,F.range.top))):(F.range2.top=F.ecell.row,F.range2.right=F.ecell.col,F.range2.bottom=F.ecell.row,F.range2.left=F.ecell.col,F.range2.hasrange=!0),u=F.range2.hasrange?"":"off",h=document.getElementById(T.idPrefix+"button_movefrom"),h.src=T.imagePrefix+"movefrom"+u+".gif",h=document.getElementById(T.idPrefix+"button_movepaste"),h.src=T.imagePrefix+"movepaste"+u+".gif",h=document.getElementById(T.idPrefix+"button_moveinsert"),h.src=T.imagePrefix+"moveinsert"+u+".gif",F.range2.hasrange&&F.RangeRemove();break;case"movepaste":case"moveinsert":F.range2.hasrange&&(T.context.cursorsuffix="",n=o+" "+t.crToCoord(F.range2.left,F.range2.top)+":"+t.crToCoord(F.range2.right,F.range2.bottom)+" "+F.ecell.coord,T.ExecuteCommand(n,""),F.Range2Remove(),h=document.getElementById(T.idPrefix+"button_movefrom"),h.src=T.imagePrefix+"movefromoff.gif",h=document.getElementById(T.idPrefix+"button_movepaste"),h.src=T.imagePrefix+"movepasteoff.gif",h=document.getElementById(T.idPrefix+"button_moveinsert"),h.src=T.imagePrefix+"moveinsertoff.gif");break;case"swapcolors":b=T.sheet,y=b.GetAssuredCell(F.ecell.coord),w=b.attribs.defaultcolor?b.colors[b.attribs.defaultcolor]:"rgb(0,0,0)",S=b.attribs.defaultbgcolor?b.colors[b.attribs.defaultbgcolor]:"rgb(255,255,255)",C=y.color?b.colors[y.color]:w,C==S&&(C=""),x=y.bgcolor?b.colors[y.bgcolor]:S,x==w&&(x=""),T.ExecuteCommand("set %C color "+x+"%Nset %C bgcolor "+C,"");break;default:n=t.SpreadsheetCmdLookup[o]||"",r=t.SpreadsheetCmdSLookup[o]||"",T.ExecuteCommand(n,r)}e&&e.blur&&e.blur(),t.KeyboardFocus()},t.SpreadsheetCmdLookup={copy:"copy %C all",cut:"cut %C all",paste:"paste %C all",pasteformats:"paste %C formats",lock:"set %C readonly yes",unlock:"set %C readonly no","delete":"erase %C formulas",filldown:"filldown %C all",fillright:"fillright %C all",erase:"erase %C all",borderon:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",borderoff:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",merge:"merge %C",unmerge:"unmerge %C","align-left":"set %C cellformat left","align-center":"set %C cellformat center","align-right":"set %C cellformat right","align-default":"set %C cellformat",insertrow:"insertrow %C",insertcol:"insertcol %C",deleterow:"deleterow %C",deletecol:"deletecol %C",hiderow:"set %H hide yes",hidecol:"set %W hide yes",undo:"undo",redo:"redo",recalc:"recalc"},t.SpreadsheetCmdSLookup={borderon:"1px solid rgb(0,0,0)",borderoff:""},t.SpreadsheetControlExecuteCommand=function(e,o,n){var r=t.GetSpreadsheetControlObject(),a=r.editor,l={};l.P="%",l.N="\n",a.range.hasrange?(l.R=t.crToCoord(a.range.left,a.range.top)+":"+t.crToCoord(a.range.right,a.range.bottom),l.C=l.R,l.W=t.rcColname(a.range.left)+":"+t.rcColname(a.range.right),l.H=a.range.top+":"+a.range.bottom):a.ecell?(l.C=a.ecell.coord,l.R=a.ecell.coord+":"+a.ecell.coord,l.W=t.rcColname(t.coordToCr(a.ecell.coord).col),l.H=t.coordToCr(a.ecell.coord).row):(l.C="A1",l.R="A1:A1",l.W=t.rcColname(t.coordToCr("A1").col),l.H=t.coordToCr("A1").row),l.S=n,o=o.replace(/%C/g,l.C),o=o.replace(/%R/g,l.R),o=o.replace(/%N/g,l.N),o=o.replace(/%S/g,l.S),o=o.replace(/%W/g,l.W),o=o.replace(/%H/g,l.H),o=o.replace(/%P/g,l.P),a.EditorScheduleSheetCommands(o,!0,!1)},t.SpreadsheetControlCreateSheetHTML=function(e){var o,n,r,a="";return o=new t.RenderContext(e.sheet),n=document.createElement("div"),r=o.RenderSheet(null,{type:"html"}),n.appendChild(r),delete o,a=n.innerHTML,delete r,delete n,a},t.SpreadsheetControlCreateCellHTML=function(e,o,n){var r="",a=e.sheet.cells[o];return a?(r=void 0==a.displaystring?t.FormatValueForDisplay(e.sheet,a.datavalue,o,n||e.context.defaultHTMLlinkstyle):a.displaystring,"&nbsp;"==r&&(r=""),r):""},t.SpreadsheetControlCreateCellHTMLSave=function(e,o,n){var r,a,l,i,s,c,u,d,p=[];for(d=o?t.ParseRange(o):{cr1:{row:1,col:1},cr2:{row:e.sheet.attribs.lastrow,col:e.sheet.attribs.lastcol}},r=d.cr1,a=d.cr2,p.push("version:1.0"),l=r.row;l<=a.row;l++)for(i=r.col;i<=a.col;i++)s=t.crToCoord(i,l),c=e.sheet.cells[s],c&&(u=void 0==c.displaystring?t.FormatValueForDisplay(e.sheet,c.datavalue,s,n||e.context.defaultHTMLlinkstyle):c.displaystring,"&nbsp;"!=u&&p.push(s+":"+t.encodeForSave(u)));return p.push(""),p.join("\n")},t.SpreadsheetControl.DoFunctionList=function(){var e,o,n,r=t.Formula,a=t.Constants,l=a.function_classlist,i=t.GetSpreadsheetControlObject(),s=i.idPrefix+"function";if(n=document.getElementById(s+"dialog"),!n){for(r.FillFunctionInfo(),o='<table><tr><td><span style="font-size:x-small;font-weight:bold">%loc!Category!</span><br><select id="'+s+'class" size="'+l.length+'" style="width:120px;" onchange="SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);">',e=0;e<l.length;e++)o+='<option value="'+l[e]+'"'+(0==e?" selected>":">")+t.special_chars(r.FunctionClasses[l[e]].name)+"</option>";o+='</select></td><td>&nbsp;&nbsp;</td><td id="'+s+'list"><span style="font-size:x-small;font-weight:bold">%loc!Functions!</span><br><select id="'+s+'name" size="'+l.length+'" style="width:240px;" onchange="SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);" ondblclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">',o+=t.SpreadsheetControl.GetFunctionNamesStr("all"),o+='</td></tr><tr><td colspan="3"><div id="'+s+'desc" style="width:380px;height:80px;overflow:auto;font-size:x-small;">'+t.SpreadsheetControl.GetFunctionInfoStr(r.FunctionClasses[l[0]].items[0])+'</div><div style="width:380px;text-align:right;padding-top:6px;font-size:small;"><input type="button" value="%loc!Paste!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();"></div></td></tr></table>';var c=document.createElement("div");c.id=s+"dialog",c.style.position="absolute";var u=t.GetViewportInfo(),d=t.GetElementPositionWithScroll(i.spreadsheetDiv);c.style.top=u.height/3-d.top+"px",c.style.left=u.width/3-d.left+"px",c.style.zIndex=100,c.style.backgroundColor="#FFF",c.style.border="1px solid black",c.style.width="400px",o='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;%loc!Function List!</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+o+"</div>",o=t.LocalizeSubstrings(o),c.innerHTML=o,t.DragRegister(c.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:c},i.spreadsheetDiv),i.spreadsheetDiv.appendChild(c),n=document.getElementById(s+"name"),n.focus(),t.CmdGotFocus(n)}},t.SpreadsheetControl.GetFunctionNamesStr=function(e){var o,n,r=t.Formula,a="";for(n=r.FunctionClasses[e],o=0;o<n.items.length;o++)a+='<option value="'+n.items[o]+'"'+(0==o?" selected>":">")+n.items[o]+"</option>";return a},t.SpreadsheetControl.FillFunctionNames=function(e,o){var n,r,a=t.Formula;for(o.length=0,r=a.FunctionClasses[e],n=0;n<r.items.length;n++)o.options[n]=new Option(r.items[n],r.items[n]),0==n&&(o.options[n].selected=!0)},t.SpreadsheetControl.GetFunctionInfoStr=function(e){var o=t.Formula,n=o.FunctionList[e],r=t.special_chars,a="<b>"+e+"("+r(o.FunctionArgString(e))+")</b><br>";return a+=r(n[3])},t.SpreadsheetControl.FunctionClassChosen=function(e){var o=t.GetSpreadsheetControlObject(),n=o.idPrefix+"function",r=t.Formula;t.SpreadsheetControl.FillFunctionNames(e,document.getElementById(n+"name")),t.SpreadsheetControl.FunctionChosen(r.FunctionClasses[e].items[0])},t.SpreadsheetControl.FunctionChosen=function(e){var o=t.GetSpreadsheetControlObject(),n=o.idPrefix+"function";document.getElementById(n+"desc").innerHTML=t.SpreadsheetControl.GetFunctionInfoStr(e)},t.SpreadsheetControl.HideFunctions=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"functiondialog");o.innerHTML="",t.DragUnregister(o),t.KeyboardFocus(),o.parentNode&&o.parentNode.removeChild(o)},t.SpreadsheetControl.DoFunctionPaste=function(){var e=t.GetSpreadsheetControlObject(),o=e.editor,n=document.getElementById(e.idPrefix+"functionname"),r=document.getElementById(e.idPrefix+"multilinetextarea"),a=n.value+"(";t.SpreadsheetControl.HideFunctions(),r?(r.value+=a,r.focus(),t.CmdGotFocus(r)):o.EditorAddToInput(a,"=")},t.SpreadsheetControl.DoMultiline=function(){var e,o,n,r=t.LocalizeSubstrings,a=(t.Constants,t.GetSpreadsheetControlObject()),l=a.editor,i=l.workingvalues,a=t.GetSpreadsheetControlObject(),s=a.idPrefix+"multiline";if(o=document.getElementById(s+"dialog"),!o){switch(l.state){case"start":i.ecoord=l.ecell.coord,i.erow=l.ecell.row,i.ecol=l.ecell.col,l.RangeRemove(),n=t.GetCellContents(l.context.sheetobj,i.ecoord);break;case"input":case"inputboxdirect":n=l.inputBox.GetText()}l.inputBox.element.disabled=!0,n=t.special_chars(n),e='<textarea id="'+s+'textarea" style="width:380px;height:120px;margin:10px 0px 0px 6px;">'+n+'</textarea><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;">'+r('<input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilinePaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilineClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();"></div></div>');var c=document.createElement("div");c.id=s+"dialog",c.style.position="absolute";var u=t.GetViewportInfo(),d=t.GetElementPositionWithScroll(a.spreadsheetDiv);c.style.top=u.height/3-d.top+"px",c.style.left=u.width/3-d.left+"px",c.style.zIndex=100,c.style.backgroundColor="#FFF",c.style.border="1px solid black",c.style.width="400px",c.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+r("&nbsp;%loc!Multi-line Input Box!")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+e+"</div>",t.DragRegister(c.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:c},a.spreadsheetDiv),a.spreadsheetDiv.appendChild(c),o=document.getElementById(s+"textarea"),o.focus(),t.CmdGotFocus(o)}},t.SpreadsheetControl.HideMultiline=function(){var e=(t.Constants,t.GetSpreadsheetControlObject()),o=e.editor,n=document.getElementById(e.idPrefix+"multilinedialog");switch(n.innerHTML="",t.DragUnregister(n),t.KeyboardFocus(),n.parentNode&&n.parentNode.removeChild(n),o.state){case"start":o.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":o.inputBox.element.disabled=!1,o.inputBox.Focus()}},t.SpreadsheetControl.DoMultilineClear=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"multilinetextarea");o.value="",o.focus()},t.SpreadsheetControl.DoMultilinePaste=function(){var e=t.GetSpreadsheetControlObject(),o=e.editor,n=o.workingvalues,r=document.getElementById(e.idPrefix+"multilinetextarea"),a=r.value;switch(t.SpreadsheetControl.HideMultiline(),o.state){case"start":n.partialexpr="",n.ecoord=o.ecell.coord,n.erow=o.ecell.row,n.ecol=o.ecell.col;break;case"input":case"inputboxdirect":o.inputBox.Blur(),o.inputBox.ShowInputBox(!1),o.state="start"}o.EditorSaveEdit(a)},t.SpreadsheetControl.DoLink=function(){var e,o,n,r,a,l,i=t.LocalizeString,s=(t.Constants,t.GetSpreadsheetControlObject()),c=s.editor,u=c.workingvalues,s=t.GetSpreadsheetControlObject(),d=s.idPrefix+"link";if(o=document.getElementById(d+"dialog"),!o){switch(c.state){case"start":u.ecoord=c.ecell.coord,u.erow=c.ecell.row,u.ecol=c.ecell.col,c.RangeRemove(),n=t.GetCellContents(c.context.sheetobj,u.ecoord);break;case"input":case"inputboxdirect":n=c.inputBox.GetText()}c.inputBox.element.disabled=!0,"'"==n.charAt(0)&&(n=n.slice(1));var p=t.ParseCellLinkText(n);n=t.special_chars(n),r=s.sheet.cells[c.ecell.coord],a=r&&r.textvalueformat?"":" checked",l=p.newwin?" checked":"",e='<div style="padding:6px 0px 4px 6px;"><span style="font-size:smaller;">'+i("Description")+'</span><br><input type="text" id="'+d+'desc" style="width:380px;" value="'+t.special_chars(p.desc)+'"><br><span style="font-size:smaller;">'+i("URL")+'</span><br><input type="text" id="'+d+'url" style="width:380px;" value="'+t.special_chars(p.url)+'"><br>',t.Callbacks.MakePageLink&&(e+='<span style="font-size:smaller;">'+i("Page Name")+'</span><br><input type="text" id="'+d+'pagename" style="width:380px;" value="'+t.special_chars(p.pagename)+'"><br><span style="font-size:smaller;">'+i("Workspace")+'</span><br><input type="text" id="'+d+'workspace" style="width:380px;" value="'+t.special_chars(p.workspace)+'"><br>'),e+=t.LocalizeSubstrings('<input type="checkbox" id="'+d+'format"'+a+'>&nbsp;<span style="font-size:smaller;">%loc!Set to Link format!</span><br><input type="checkbox" id="'+d+'popup"'+l+'>&nbsp;<span style="font-size:smaller;">%loc!Show in new browser window!</span></div><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;"><input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkPaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideLink();"></div></div>');var f=document.createElement("div");f.id=d+"dialog",f.style.position="absolute";var h=t.GetViewportInfo(),m=t.GetElementPositionWithScroll(s.spreadsheetDiv);f.style.top=h.height/3-m.top+"px",f.style.left=h.width/3-m.left+"px",f.style.zIndex=100,f.style.backgroundColor="#FFF",f.style.border="1px solid black",f.style.width="400px",f.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;'+i("Link Input Box")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideLink();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+e+"</div>",t.DragRegister(f.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:f},s.spreadsheetDiv),s.spreadsheetDiv.appendChild(f),o=document.getElementById(d+"url"),o.focus(),t.CmdGotFocus(o)}},t.SpreadsheetControl.HideLink=function(){var e=(t.Constants,t.GetSpreadsheetControlObject()),o=e.editor,n=document.getElementById(e.idPrefix+"linkdialog");switch(n.innerHTML="",t.DragUnregister(n),t.KeyboardFocus(),n.parentNode&&n.parentNode.removeChild(n),o.state){case"start":o.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":o.inputBox.element.disabled=!1,o.inputBox.Focus()}},t.SpreadsheetControl.DoLinkClear=function(){var e=t.GetSpreadsheetControlObject();
document.getElementById(e.idPrefix+"linkdesc").value="",document.getElementById(e.idPrefix+"linkpagename").value="",document.getElementById(e.idPrefix+"linkworkspace").value="";var o=document.getElementById(e.idPrefix+"linkurl");o.value="",o.focus()},t.SpreadsheetControl.DoLinkPaste=function(){var e,o,n,r,a=t.GetSpreadsheetControlObject(),l=a.editor,i=l.workingvalues,s=document.getElementById(a.idPrefix+"linkdesc"),c=document.getElementById(a.idPrefix+"linkurl"),u=document.getElementById(a.idPrefix+"linkpagename"),d=document.getElementById(a.idPrefix+"linkworkspace"),p=document.getElementById(a.idPrefix+"linkformat"),f=document.getElementById(a.idPrefix+"linkpopup"),h="";switch(f.checked?(e="<<",o=">>",n="[[",r="]]"):(e="<",o=">",n="[",r="]"),h=u&&u.value?d.value?s.value+"{"+d.value+n+u.value+r+"}":s.value+n+u.value+r:s.value+e+c.value+o,t.SpreadsheetControl.HideLink(),l.state){case"start":i.partialexpr="",i.ecoord=l.ecell.coord,i.erow=l.ecell.row,i.ecol=l.ecell.col;break;case"input":case"inputboxdirect":l.inputBox.Blur(),l.inputBox.ShowInputBox(!1),l.state="start"}p.checked&&t.SpreadsheetControlExecuteCommand(null,"set %C textvalueformat text-link",""),l.EditorSaveEdit(h)},t.SpreadsheetControl.DoSum=function(){var e,o,n,r,a,l,i,s=t.GetSpreadsheetControlObject(),c=s.editor,u=c.context.sheetobj;if(c.range.hasrange)a=t.crToCoord(c.range.left,c.range.top)+":"+t.crToCoord(c.range.right,c.range.bottom),e="set "+t.crToCoord(c.range.right,c.range.bottom+1)+" formula sum("+a+")";else if(n=c.ecell.row-1,r=c.ecell.col,1>=n)e="set "+c.ecell.coord+" constant e#REF! 0 #REF!";else{for(i=!1;n>0;){if(l=t.crToCoord(r,n),o=u.GetAssuredCell(l),o.datatype&&"t"!=o.datatype)i=!0;else if(i){n++;break}n--}e="set "+c.ecell.coord+" formula sum("+t.crToCoord(r,n)+":"+t.crToCoord(r,c.ecell.row-1)+")"}c.EditorScheduleSheetCommands(e,!0,!1)},t.SpreadsheetControl.FindInSheet=function(){var e=$("#searchstatus"),o=t.GetSpreadsheetControlObject();if(!this.value.length)return e.text(""),o.sheet.search_cells=[],void(o.sheet.selected_search_cell=void 0);var n,r,a=o.sheet.cells,l=new RegExp(this.value,"im"),i=[];for(var s in a){n=a[s];var c=t.coordToCr(s);"yes"!==o.sheet.rowattribs.hide[c.row]&&"yes"!==o.sheet.colattribs.hide[t.rcColname(c.col)]&&(r="c"===n.datatype?n.displaystring:String(n.datavalue),void 0!==r&&r.match(l)&&i.push(s))}o.sheet.search_cells=i,i.length?(o.sheet.selected_search_cell=0,o.editor.MoveECell(i[0]),e.text("1 of "+i.length)):(o.sheet.selected_search_cell=void 0,e.text("No Matches"))},t.SpreadsheetControl.SearchSheet=function(e){var o=t.GetSpreadsheetControlObject(),n=o.sheet,r=n.search_cells;if(r.length){var a=n.selected_search_cell;a===(0===e?0:r.length-1)?a=0===e?r.length-1:0:a+=0===e?-1:1;var l=r[a];n.selected_search_cell=a,o.editor.MoveECell(l),document.getElementById("searchstatus").textContent=String(a+1)+" of "+r.length}},t.SpreadsheetControl.SearchUp=function(){t.SpreadsheetControl.SearchSheet(0)},t.SpreadsheetControl.SearchDown=function(){t.SpreadsheetControl.SearchSheet(1)},t.SpreadsheetControlSortOnclick=function(e){var o,n,r=[],a=document.getElementById(e.idPrefix+"sortlist");t.LoadColumnChoosers(e),e.editor.RangeChangeCallback.sort=t.UpdateSortRangeProposal;for(o in e.sheet.names)r.push(o);for(r.sort(),a.length=0,a.options[0]=new Option(t.LocalizeString("[select range]")),a.options[1]=new Option(t.LocalizeString("Sort All"),"all"),n_options=a.options.length,n=0;n<r.length;n++)o=r[n],a.options[n+n_options]=new Option(o,o),o==e.sortrange&&(a.options[n+n_options].selected=!0);""==e.sortrange&&(a.options[0].selected=!0),t.UpdateSortRangeProposal(e.editor),t.KeyboardFocus()},t.SpreadsheetControlSortSave=function(){var e,o,n,r=t.GetSpreadsheetControlObject();return e="sort:"+t.encodeForSave(r.sortrange)+":",o=document.getElementById(r.idPrefix+"majorsort"),n=document.getElementById(r.idPrefix+"majorsortup"),e+=o.selectedIndex+(n.checked?":up":":down"),o=document.getElementById(r.idPrefix+"minorsort"),o.selectedIndex>0?(n=document.getElementById(r.idPrefix+"minorsortup"),e+=":"+o.selectedIndex+(n.checked?":up":":down")):e+="::",o=document.getElementById(r.idPrefix+"lastsort"),o.selectedIndex>0?(n=document.getElementById(r.idPrefix+"lastsortup"),e+=":"+o.selectedIndex+(n.checked?":up":":down")):e+="::",e+"\n"},t.SpreadsheetControlSortLoad=function(e,o,n){var r,a,l=t.GetSpreadsheetControlObject();return r=n.split(":"),l.sortrange=t.decodeFromSave(r[1]),a=document.getElementById(l.idPrefix+"sortbutton"),l.sortrange?(a.value=t.LocalizeString("Sort ")+l.sortrange,a.style.visibility="visible"):a.style.visibility="hidden",t.LoadColumnChoosers(l),sele=document.getElementById(l.idPrefix+"majorsort"),sele.selectedIndex=r[2]-0,document.getElementById(l.idPrefix+"majorsort"+r[3]).checked=!0,sele=document.getElementById(l.idPrefix+"minorsort"),r[4]?(sele.selectedIndex=r[4]-0,document.getElementById(l.idPrefix+"minorsort"+r[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(l.idPrefix+"minorsortup").checked=!0),sele=document.getElementById(l.idPrefix+"lastsort"),r[6]?(sele.selectedIndex=r[6]-0,document.getElementById(l.idPrefix+"lastsort"+r[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(l.idPrefix+"lastsortup").checked=!0),!0},t.SpreadsheetControlCommentOnclick=function(e,o){e.editor.MoveECellCallback.comment=t.SpreadsheetControlCommentMoveECell,t.SpreadsheetControlCommentDisplay(e,o),t.KeyboardFocus()},t.SpreadsheetControlCommentDisplay=function(e){var t="";e.editor.ecell&&e.editor.ecell.coord&&e.sheet.cells[e.editor.ecell.coord]&&(t=e.sheet.cells[e.editor.ecell.coord].comment||""),document.getElementById(e.idPrefix+"commenttext").value=t},t.SpreadsheetControlCommentMoveECell=function(){t.SpreadsheetControlCommentDisplay(t.GetSpreadsheetControlObject(),"comment")},t.SpreadsheetControlCommentSet=function(){var e=t.GetSpreadsheetControlObject();e.ExecuteCommand("set %C comment "+t.encodeForSave(document.getElementById(e.idPrefix+"commenttext").value));var o=t.GetEditorCellElement(e.editor,e.editor.ecell.row,e.editor.ecell.col);e.editor.ECellReadonly()||(o.element.title=document.getElementById(e.idPrefix+"commenttext").value,e.editor.UpdateCellCSS(o,e.editor.ecell.row,e.editor.ecell.col)),t.KeyboardFocus()},t.SpreadsheetControlCommentOnunclick=function(e){delete e.editor.MoveECellCallback.comment},t.SpreadsheetControlNamesOnclick=function(e){document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="",e.editor.RangeChangeCallback.names=t.SpreadsheetControlNamesRangeChange,e.editor.MoveECellCallback.names=t.SpreadsheetControlNamesRangeChange,t.SpreadsheetControlNamesRangeChange(e.editor),t.SpreadsheetControlNamesFillNameList(),t.SpreadsheetControlNamesChangedName()},t.SpreadsheetControlNamesFillNameList=function(){var e,o,n=t.LocalizeString,r=[],a=t.GetSpreadsheetControlObject(),l=document.getElementById(a.idPrefix+"nameslist"),i=document.getElementById(a.idPrefix+"namesname").value.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");for(e in a.sheet.names)r.push(e);for(r.sort(),l.length=0,l.options[0]=new Option(r.length>0?n("[New]"):n("[None]")),o=0;o<r.length;o++)e=r[o],l.options[o+1]=new Option(e,e),e==i&&(l.options[o+1].selected=!0);""==i&&(l.options[0].selected=!0)},t.SpreadsheetControlNamesChangedName=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"nameslist"),n=o.options[o.selectedIndex].value;e.sheet.names[n]?(document.getElementById(e.idPrefix+"namesname").value=n,document.getElementById(e.idPrefix+"namesdesc").value=e.sheet.names[n].desc||"",document.getElementById(e.idPrefix+"namesvalue").value=e.sheet.names[n].definition||""):(document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="")},t.SpreadsheetControlNamesRangeChange=function(e){var o=t.GetSpreadsheetControlObject(),n=document.getElementById(o.idPrefix+"namesrangeproposal");n.value=e.range.hasrange?t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom):e.ecell.coord},t.SpreadsheetControlNamesOnunclick=function(e){delete e.editor.RangeChangeCallback.names,delete e.editor.MoveECellCallback.names},t.SpreadsheetControlNamesSetValue=function(){var e=t.GetSpreadsheetControlObject();document.getElementById(e.idPrefix+"namesvalue").value=document.getElementById(e.idPrefix+"namesrangeproposal").value,t.KeyboardFocus()},t.SpreadsheetControlNamesSave=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"namesname").value;t.SetTab(e.tabs[0].name),t.KeyboardFocus(),""!=o&&e.ExecuteCommand("name define "+o+" "+document.getElementById(e.idPrefix+"namesvalue").value+"\nname desc "+o+" "+document.getElementById(e.idPrefix+"namesdesc").value)},t.SpreadsheetControlNamesDelete=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"namesname").value;t.SetTab(e.tabs[0].name),t.KeyboardFocus(),""!=o&&e.ExecuteCommand("name delete "+o),t.KeyboardFocus()},t.SpreadsheetControlClipboardOnclick=function(e){var e=t.GetSpreadsheetControlObject();clipele=document.getElementById(e.idPrefix+"clipboardtext"),document.getElementById(e.idPrefix+"clipboardformat-tab").checked=!0,clipele.value=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,"tab")},t.SpreadsheetControlClipboardFormat=function(e){var o=t.GetSpreadsheetControlObject();clipele=document.getElementById(o.idPrefix+"clipboardtext"),clipele.value=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,e)},t.SpreadsheetControlClipboardLoad=function(){var e=t.GetSpreadsheetControlObject(),o="tab";t.SetTab(e.tabs[0].name),t.KeyboardFocus(),document.getElementById(e.idPrefix+"clipboardformat-csv").checked?o="csv":document.getElementById(e.idPrefix+"clipboardformat-scsave").checked&&(o="scsave"),e.editor.EditorScheduleSheetCommands("loadclipboard "+t.encodeForSave(t.ConvertOtherFormatToSave(document.getElementById(e.idPrefix+"clipboardtext").value,o)),!0,!1)},t.SpreadsheetControlClipboardClear=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"clipboardtext");o.value="",e.editor.EditorScheduleSheetCommands("clearclipboard",!0,!1),o.focus()},t.SpreadsheetControlClipboardExport=function(){var e=t.GetSpreadsheetControlObject();e.ExportCallback&&e.ExportCallback(e),t.SetTab(e.tabs[0].name),t.KeyboardFocus()},t.SpreadsheetControlSettingsSwitch=function(e){t.SettingControlReset();var o=t.GetSpreadsheetControlObject(),n=document.getElementById(o.idPrefix+"sheetsettingstable"),r=document.getElementById(o.idPrefix+"cellsettingstable"),a=document.getElementById(o.idPrefix+"sheetsettingstoolbar"),l=document.getElementById(o.idPrefix+"cellsettingstoolbar");"sheet"==e?(n.style.display="block",r.style.display="none",a.style.display="block",l.style.display="none",t.SettingsControlSetCurrentPanel(o.views.settings.values.sheetspanel)):(n.style.display="none",r.style.display="block",a.style.display="none",l.style.display="block",t.SettingsControlSetCurrentPanel(o.views.settings.values.cellspanel))},t.SettingsControlSave=function(e){var o,n,r=t.GetSpreadsheetControlObject(),a=t.SettingsControls,l=a.CurrentPanel,i=t.SettingsControlUnloadPanel(l);t.SetTab(r.tabs[0].name),t.KeyboardFocus(),"sheet"==e?n=r.sheet.DecodeSheetAttributes(i):"cell"==e&&(r.editor.range.hasrange&&(o=t.crToCoord(r.editor.range.left,r.editor.range.top)+":"+t.crToCoord(r.editor.range.right,r.editor.range.bottom)),n=r.sheet.DecodeCellAttributes(r.editor.ecell.coord,i,o)),n&&r.editor.EditorScheduleSheetCommands(n,!0,!1)},t.SpreadsheetControlCreateSpreadsheetSave=function(e,t){var o,n,r,a="",l="";if(t)for(n in t)r="\n"!=t[n].charAt(t[n]-1)?"\n":"",a+="--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+t[n]+r,l+="part:"+n+"\n";return o="socialcalc:version:1.0\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary="+e.multipartBoundary+"\n--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n# SocialCalc Spreadsheet Control Save\nversion:1.0\npart:sheet\npart:edit\npart:audit\n"+l+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.CreateSheetSave()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.editor.SaveEditorSettings()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.sheet.CreateAuditString()+a+"--"+e.multipartBoundary+"--\n"},t.SpreadsheetControlDecodeSpreadsheetSave=function(e,t){var o,n,r,a,l,i,s,c,u,d,u,p,f={},h=[];if(o=t.search(/^MIME-Version:\s1\.0/im),0>o)return f;if(n=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim,n.lastIndex=o,r=n.exec(t),n.lastIndex<=0)return f;if(a=r[1],l=new RegExp("^--"+a+"(?:\r\n|\n)","mg"),l.lastIndex=n.lastIndex,r=l.exec(t),i=/(?:\r\n|\n)(?:\r\n|\n)/gm,i.lastIndex=l.lastIndex,r=i.exec(t),!r)return f;if(s=i.lastIndex,l.lastIndex=s,r=l.exec(t),!r)return f;for(c=r.index,u=t.substring(s,c).split(/\r\n|\n/),d=0;d<u.length;d++)switch(line=u[d],p=line.split(":"),p[0]){case"version":break;case"part":h.push(p[1])}for(pnum=0;pnum<h.length;pnum++){if(i.lastIndex=c,r=i.exec(t),!r)return f;if(s=i.lastIndex,pnum==h.length-1&&(l=new RegExp("^--"+a+"--$","mg")),l.lastIndex=s,r=l.exec(t),!r)return f;c=r.index,f[h[pnum]]={start:s,end:c}}return f},t.SettingsControls={Controls:{},CurrentPanel:null},t.SettingsControlSetCurrentPanel=function(e){t.SettingsControls.CurrentPanel=e,t.SettingsControls.PopupChangeCallback({panelobj:e},"",null)},t.SettingsControlInitializePanel=function(e){var o,n=t.SettingsControls;for(o in e)"name"!=o&&(ctrl=n.Controls[e[o].type],ctrl&&ctrl.Initialize&&ctrl.Initialize(e,o))},t.SettingsControlLoadPanel=function(e,o){var n,r=t.SettingsControls;for(n in e)"name"!=n&&(ctrl=r.Controls[e[n].type],ctrl&&ctrl.SetValue&&ctrl.SetValue(e,n,o[e[n].setting]))},t.SettingsControlUnloadPanel=function(e){var o,n=t.SettingsControls,r={};for(o in e)"name"!=o&&(ctrl=n.Controls[e[o].type],ctrl&&ctrl.GetValue&&(r[e[o].setting]=ctrl.GetValue(e,o)));return r},t.SettingsControls.PopupChangeCallback=function(e){var o=t.Constants,n=document.getElementById("sample-text");if(n&&e&&e.panelobj){var r,a,l,i,s,c=t.CurrentSpreadsheetControlObject.idPrefix,u="cell"==e.panelobj.name?"c":"";l=o.defaultCellLayout.match(/^padding.(\S+) (\S+) (\S+) (\S+).vertical.align.(\S+);$/)||[];var d={color:["textcolor"],backgroundColor:["bgcolor","#FFF"],fontSize:["fontsize",o.defaultCellFontSize],fontFamily:["fontfamily"],paddingTop:["padtop",l[1]],paddingRight:["padright",l[2]],paddingBottom:["padbottom",l[3]],paddingLeft:["padleft",l[4]],verticalAlign:["alignvert",l[5]]};for(a in d)r=t.Popup.GetValue(c+u+d[a][0])||d[a][1]||"",n.style[a]=r;if("c"==u){d={borderTop:"cbt",borderRight:"cbr",borderBottom:"cbb",borderLeft:"cbl"};for(a in d)r=t.SettingsControls.BorderSideGetValue(e.panelobj,d[a]),n.style[a]=r?r.val||"":"";r=t.Popup.GetValue(c+"calignhoriz"),n.style.textAlign=r||"left",n.childNodes[1].style.textAlign=r||"right"}else n.style.border="",r=t.Popup.GetValue(c+"textalignhoriz"),n.style.textAlign=r||"left",r=t.Popup.GetValue(c+"numberalignhoriz"),n.childNodes[1].style.textAlign=r||"right";r=t.Popup.GetValue(c+u+"fontlook"),l=r?r.match(/^(\S+) (\S+)$/)||[]:[],n.style.fontStyle=l[1]||"",n.style.fontWeight=l[2]||"",r=t.Popup.GetValue(c+u+"formatnumber")||"General",i=t.FormatNumber.formatNumberWithFormat(9.8765,r,""),s=t.FormatNumber.formatNumberWithFormat(-1234.5,r,""),"??-???-??&nbsp;??:??:??"!=s&&(i+="<br>"+s),n.childNodes[1].innerHTML=i}},t.SettingsControls.PopupListSetValue=function(e,o,n){if(!n)return void alert(o+" no value");var r=t.Popup;n.def?r.SetValue(e[o].id,""):r.SetValue(e[o].id,n.val)},t.SettingsControls.PopupListGetValue=function(e,o){var n=e[o];if(!n)return null;var r=t.Popup.GetValue(n.id);return r?{def:!1,val:r}:{def:!0,val:0}},t.SettingsControls.PopupListInitialize=function(e,o){var n,r,a,l,i=t.SettingsControls,s=e[o].initialdata||i.Controls[e[o].type].InitialData||"";s=t.LocalizeSubstrings(s);var c=s.split(/\|/),u=[];for(n=0;n<(c.length||0);n++)r=c[n],a=r.indexOf(":"),l=r.substring(0,a),-1!=l.indexOf("\\")&&(l=l.replace(/\\c/g,":"),l=l.replace(/\\b/g,"\\")),l=t.special_chars(l),u[n]="[custom]"==l?{o:t.Constants.s_PopupListCustom,v:r.substring(a+1),a:{custom:!0}}:"[cancel]"==l?{o:t.Constants.s_PopupListCancel,v:"",a:{cancel:!0}}:"[break]"==l?{o:"-----",v:"",a:{skip:!0}}:"[newcol]"==l?{o:"",v:"",a:{newcol:!0}}:{o:l,v:r.substring(a+1)};t.Popup.Create("List",e[o].id,{}),t.Popup.Initialize(e[o].id,{options:u,attribs:{changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControls.PopupListReset=function(){t.Popup.Reset("List")},t.SettingsControls.Controls.PopupList={SetValue:t.SettingsControls.PopupListSetValue,GetValue:t.SettingsControls.PopupListGetValue,Initialize:t.SettingsControls.PopupListInitialize,OnReset:t.SettingsControls.PopupListReset,ChangedCallback:null},t.SettingsControls.ColorChooserSetValue=function(e,o,n){if(!n)return void alert(o+" no value");var r=t.Popup;n.def?r.SetValue(e[o].id,""):r.SetValue(e[o].id,n.val)},t.SettingsControls.ColorChooserGetValue=function(e,o){var n=t.Popup.GetValue(e[o].id);return n?{def:!1,val:n}:{def:!0,val:0}},t.SettingsControls.ColorChooserInitialize=function(e,o){t.SettingsControls;t.Popup.Create("ColorChooser",e[o].id,{}),t.Popup.Initialize(e[o].id,{attribs:{title:"&nbsp;",moveable:!0,width:"106px",changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControls.ColorChooserReset=function(){t.Popup.Reset("ColorChooser")},t.SettingsControls.Controls.ColorChooser={SetValue:t.SettingsControls.ColorChooserSetValue,GetValue:t.SettingsControls.ColorChooserGetValue,Initialize:t.SettingsControls.ColorChooserInitialize,OnReset:t.SettingsControls.ColorChooserReset,ChangedCallback:null},t.SettingsControls.BorderSideSetValue=function(e,o,n){var r,a,l,i=(t.SettingsControls,e[o].id);return n?(r=document.getElementById(i+"-onoff-bcb"),void(r&&(n.val?(r.checked=!0,r.value=n.val,l=n.val.match(/(\S+)\s+(\S+)\s+(\S.+)/),a=i+"-color",t.Popup.SetValue(a,l[3]),t.Popup.SetDisabled(a,!1)):(r.checked=!1,r.value=n.val,a=i+"-color",t.Popup.SetValue(a,""),t.Popup.SetDisabled(a,!0))))):void alert(o+" no value")},t.SettingsControls.BorderSideGetValue=function(e,o){var n,r,a=(t.SettingsControls,e[o].id);return(n=document.getElementById(a+"-onoff-bcb"))?n.checked?(r=t.Popup.GetValue(a+"-color"),r="1px solid "+(r||"rgb(0,0,0)"),{def:!1,val:r}):{def:!1,val:""}:void 0},t.SettingsControls.BorderSideInitialize=function(e,o){var n=(t.SettingsControls,e[o].id);t.Popup.Create("ColorChooser",n+"-color",{}),t.Popup.Initialize(n+"-color",{attribs:{title:"&nbsp;",width:"106px",moveable:!0,changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControlOnchangeBorder=function(e){var o=t.SettingsControls,n=o.CurrentPanel,r=e.id.match(/(^.*\-)(\w+)\-(\w+)\-(\w+)$/);if(r){var a=(r[1],r[2]),l=(r[3],r[4]),i=n[a].type;switch(l){case"bcb":e.checked?o.Controls[i].SetValue(o.CurrentPanel,a,{def:!1,val:e.value||"1px solid rgb(0,0,0)"}):o.Controls[i].SetValue(o.CurrentPanel,a,{def:!1,val:""})}}},t.SettingsControls.Controls.BorderSide={SetValue:t.SettingsControls.BorderSideSetValue,GetValue:t.SettingsControls.BorderSideGetValue,OnClick:t.SettingsControls.ColorComboOnClick,Initialize:t.SettingsControls.BorderSideInitialize,InitialData:{thickness:"1 pixel:1px",style:"Solid:solid"},ChangedCallback:null},t.SettingControlReset=function(){var e,o=t.SettingsControls;for(e in o.Controls)o.Controls[e].OnReset&&o.Controls[e].OnReset(e)},t.OtherSaveParts={},t.CtrlSEditor=function(e){var o,n;if(e.length>0)o=t.special_chars(t.OtherSaveParts[e]||"");else{o="Listing of Parts\n";for(n in t.OtherSaveParts)o+=t.special_chars("\nPart: "+n+"\n=====\n"+t.OtherSaveParts[n]+"\n")}var r=document.createElement("div");r.style.cssText="position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;",r.id="socialcalc-editbox",r.innerHTML=e+'<br><br><textarea id="socialcalc-editbox-textarea" style="width:250px;height:200px;">'+o+"</textarea><br><br><input type=button onclick=\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '"+e+'\');" value="OK">',document.body.appendChild(r);var a=document.getElementById("socialcalc-editbox-textarea");a.focus(),t.CmdGotFocus(a)},t.CtrlSEditorDone=function(e,o){var n=document.getElementById(e+"-textarea"),r=n.value;o.length>0&&(r.length>0?t.OtherSaveParts[o]=r:delete t.OtherSaveParts[o]);var a=document.getElementById(e);t.KeyboardFocus(),a.parentNode.removeChild(a)};var t;return t||(alert("Main SocialCalc code module needed"),t={}),t.TableEditor||alert("SocialCalc TableEditor code module needed"),t.CurrentSpreadsheetViewerObject=null,t.SpreadsheetViewer=function(e){var o=t.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.idPrefix=e||"SocialCalc-",this.imagePrefix=o.defaultImagePrefix,this.statuslineheight=o.SVStatuslineheight,this.statuslineCSS=o.SVStatuslineCSS,this.sheet=new t.Sheet,this.context=new t.RenderContext(this.sheet),(1==t._app||1==t._view)&&(o.defaultImagePrefix=this.imagePrefix="../"+this.imagePrefix),1==t._app?(this.context.showGrid=!1,this.context.showRCHeaders=!1,this.context.highlightTypes.range.style="",this.context.sheetobj.cells.A1=new t.Cell("A1"),this.context.sheetobj.cells.A1.displaystring="Loading ... "):(this.context.showGrid=!0,this.context.showRCHeaders=!0),this.editor=new t.TableEditor(this.context),this.editor.noEdit=!0,this.editor.StatusCallback.statusline={func:t.SpreadsheetViewerStatuslineCallback,params:{}},this.hasStatusLine=!0,this.statuslineHTML='<table cellspacing="0" cellpadding="0"><tr><td width="100%" style="overflow:hidden;">{status}</td><td>&nbsp;</td></tr></table>',this.statuslineFull=!0,this.noRecalc=!0,this.repeatingMacroTimer=null,this.repeatingMacroInterval=60,this.repeatingMacroCommands="",t.CurrentSpreadsheetViewerObject=this},t.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer=function(e,o,n,r){return t.InitializeSpreadsheetViewer(this,e,o,n,r)},t.SpreadsheetViewer.prototype.LoadSave=function(e){return t.SpreadsheetViewerLoadSave(this,e)},t.SpreadsheetViewer.prototype.DoOnResize=function(){return t.DoOnResize(this)},t.SpreadsheetViewer.prototype.SizeSSDiv=function(){return t.SizeSSDiv(this)},t.SpreadsheetViewer.prototype.DecodeSpreadsheetSave=function(e){return t.SpreadsheetViewerDecodeSpreadsheetSave(this,e)},t.SpreadsheetViewer.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},t.InitializeSpreadsheetViewer=function(e,o,n,r,a){{var l;t.Constants,t.LocalizeString,t.LocalizeSubstrings,e.tabs,e.views}for(e.requestedHeight=n,e.requestedWidth=r,e.requestedSpaceBelow=a,"string"==typeof o&&(o=document.getElementById(o)),null==o&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=o,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),l=o.firstChild;null!=l;l=o.firstChild)o.removeChild(l);o.appendChild(e.spreadsheetDiv),e.nonviewheight=e.hasStatusLine?e.statuslineheight:0,e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight),e.spreadsheetDiv.appendChild(e.editorDiv),e.hasStatusLine&&(e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-(e.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(e.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.editor.StatusCallback.statusline={func:t.SpreadsheetViewerStatuslineCallback,params:{spreadsheetobj:e}}),1==t._app&&(e.formDataViewer=new t.SpreadsheetViewer("te_FormData-"),e.formDataViewer.sheet.statuscallback=null,t.CurrentSpreadsheetViewerObject=e)},t.SpreadsheetViewerLoadSave=function(o,n){var r,a,l,i,s=o.DecodeSpreadsheetSave(n);s&&(s.sheet&&(o.sheet.ResetSheet(),o.sheet.ParseSheetSave(n.substring(s.sheet.start,s.sheet.end))),s.edit&&o.editor.LoadEditorSettings(n.substring(s.edit.start,s.edit.end)),s.startupmacro&&o.editor.EditorScheduleSheetCommands(n.substring(s.startupmacro.start,s.startupmacro.end),!1,!0),s.repeatingmacro&&(r=n.substring(s.repeatingmacro.start,s.repeatingmacro.end),r=r.replace("\r",""),a=r.indexOf("\n"),a>0&&(l=r.substring(0,a)-0,i=l,o.repeatingMacroInterval=l,o.repeatingMacroCommands=r.substring(a+1),i>0&&(o.repeatingMacroTimer=e.setTimeout(t.SpreadsheetViewerDoRepeatingMacro,1e3*o.repeatingMacroInterval))))),"off"==o.editor.context.sheetobj.attribs.recalc||o.noRecalc?o.editor.ScheduleRender():o.editor.EditorScheduleSheetCommands("recalc")},t.SpreadsheetViewerDoRepeatingMacro=function(){var e=t.GetSpreadsheetViewerObject(),o=e.editor;e.repeatingMacroTimer=null,t.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro={func:t.SpreadsheetViewerRepeatMacroCommand,data:null},o.EditorScheduleSheetCommands(e.repeatingMacroCommands)},t.SpreadsheetViewerRepeatMacroCommand=function(o,n,r,a){var l=t.GetSpreadsheetViewerObject(),i=a.RestOfString(),s=i-0;s>0||(s=l.repeatingMacroInterval),l.repeatingMacroInterval=s,l.repeatingMacroTimer=e.setTimeout(t.SpreadsheetViewerDoRepeatingMacro,1e3*l.repeatingMacroInterval)},t.SpreadsheetViewerStopRepeatingMacro=function(){var o=t.GetSpreadsheetViewerObject();o.repeatingMacroTimer&&(e.clearTimeout(o.repeatingMacroTimer),o.repeatingMacroTimer=null)},t.SpreadsheetViewerDoButtonCmd=function(e,o,n){var r=n.element,a=n.functionobj.command,l=t.GetSpreadsheetViewerObject(),i=l.editor;switch(a){case"recalc":i.EditorScheduleSheetCommands("recalc")}r&&r.blur&&r.blur(),t.KeyboardFocus()},t.LocalizeString=function(e){var o=t.LocalizeStringList[e];return o||(o=t.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,t.LocalizeStringList[e]=o),o},t.LocalizeStringList={},t.LocalizeSubstrings=function(e){var o=t.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,n,r){return"ssc"==n?t.Constants[r]||alert("Missing constant: "+r):o(r)})},t.GetSpreadsheetViewerObject=function(){var e=t.CurrentSpreadsheetViewerObject;if(e)return e;throw"No current SpreadsheetViewer object."},t.DoOnResize=function(e){var o,n=e.views,r=e.SizeSSDiv();if(r){for(vname in n)o=n[vname].element,o.style.width=e.width+"px",o.style.height=e.height-e.nonviewheight+"px";t._app||e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},t.SizeSSDiv=function(e){var o,n,r,a,l,i=10,s=10;return r=!1,o=t.GetViewportInfo(),n=t.GetElementPosition(e.parentNode),n.bottom=0,n.right=0,a=e.parentNode.style,a.marginTop&&(n.top+=a.marginTop.slice(0,-2)-0),a.marginBottom&&(n.bottom+=a.marginBottom.slice(0,-2)-0),a.marginLeft&&(n.left+=a.marginLeft.slice(0,-2)-0),a.marginRight&&(n.right+=a.marginRight.slice(0,-2)-0),l=e.requestedHeight||o.height-(n.top+n.bottom+s)-(e.requestedSpaceBelow||0),e.height!=l&&(e.height=l,e.spreadsheetDiv.style.height=l+"px",r=!0),l=e.requestedWidth||o.width-(n.left+n.right+i)||700,e.width!=l&&(e.width=l,e.spreadsheetDiv.style.width=l+"px",r=!0),e.spreadsheetDiv.style.position="relative",r},t.SpreadsheetViewerStatuslineCallback=function(e,t,o,n){var r=n.spreadsheetobj,a="";switch(r&&r.statuslineDiv&&(a=r.statuslineFull?e.GetStatuslineString(t,o,n):e.ecell.coord,a=r.statuslineHTML.replace(/\{status\}/,a),r.statuslineDiv.innerHTML=a),t){case"cmdendnorender":case"calcfinished":case"doneposcalc":}},t.CmdGotFocus=function(e){t.Keyboard.passThru=e},t.SpreadsheetViewerCreateSheetHTML=function(e){var o,n,r,a="";return o=new t.RenderContext(e.sheet),n=document.createElement("div"),r=o.RenderSheet(null,{type:"html"}),n.appendChild(r),delete o,a=n.innerHTML,delete r,delete n,a},t.SpreadsheetViewerDecodeSpreadsheetSave=function(e,t){var o,n,r,a,l,i,s,c,u,d,u,p,f={},h=[],m=/[^\n]\r[^\n]/;if(m.test(t)&&(t=t.replace(/([^\n])\r([^\n])/g,"$1\r\n$2")),o=t.search(/^MIME-Version:\s1\.0/im),0>o)return f;if(n=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim,n.lastIndex=o,r=n.exec(t),n.lastIndex<=0)return f;if(a=r[1],l=new RegExp("^--"+a+"(?:\r\n|\n)","mg"),l.lastIndex=n.lastIndex,r=l.exec(t),i=/(?:\r\n|\n)(?:\r\n|\n)/gm,i.lastIndex=l.lastIndex,r=i.exec(t),!r)return f;if(s=i.lastIndex,l.lastIndex=s,r=l.exec(t),!r)return f;for(c=r.index,u=t.substring(s,c).split(/\r\n|\n/),d=0;d<u.length;d++)switch(line=u[d],p=line.split(":"),p[0]){case"version":break;case"part":h.push(p[1])}for(pnum=0;pnum<h.length;pnum++){if(i.lastIndex=c,r=i.exec(t),!r)return f;if(s=i.lastIndex,pnum==h.length-1&&(l=new RegExp("^--"+a+"--$","mg")),l.lastIndex=s,r=l.exec(t),!r)return f;c=r.index,f[h[pnum]]={start:s,end:c}}return f},"undefined"==typeof document&&(t.GetEditorCellElement=function(){},t.ReplaceCell=function(){},t.EditorRenderSheet=function(){},t.SpreadsheetControlSortSave=function(){return""},t.SpreadsheetControlStatuslineCallback=function(){},t.DoPositionCalculations=function(e){t.EditorSheetStatusCallback(null,"doneposcalc",null,e)}),"undefined"!=typeof self&&self.thread&&(e.setTimeout=function(e,t){1>=t&&self.thread.nextTick(e)},e.clearTimeout=function(){}),t}),function(){Class=function(classDefinition,classWrapper){if(!classDefinition)throw"Class requires a class definition string as its first argument";if(!classWrapper)throw"Class requires a class wrapper function as its second argument";if(!classDefinition.match(/^([\w\.]+)(?:\(\s*([\w\.]+)\s*\))?(?:\s+(.*?)\s*)?$/))throw"Can't parse Class Definition: '"+classDefinition+"'";var className=RegExp.$1,baseClassName=RegExp.$2||"",options=[];RegExp.$3&&(options=RegExp.$3.split(/\s+/));for(var incValues=[],strict=!0,i=0,l=options.length;l>i;i++){var option=options[i];"-nostrict"==option&&(strict=!1),option.match(/^-inc=(.+)$/)&&(incValues=RegExp.$1.split(","))}for(var parts=className.split("."),klass=Class.global,i=0;i<parts.length;i++)klass[parts[i]]||(klass[parts[i]]=function(){try{this.init()}catch(e){}}),klass=klass[parts[i]];klass.className=className,klass.isa=function(baseName){klass.baseClassName=baseName,baseName&&(klass.prototype=eval("new "+baseName+"()"),klass.prototype.superFunc=function(name){return eval(baseName).prototype[name]})},klass.isa(baseClassName),klass.global=Class.global,klass.addGlobal=function(){return this.newGlobals++,Class.global},klass.extend=function(e){if("object"!=typeof e)throw"extend requires an object of name:value pairs";for(var t in e)klass.prototype[t]=e[t]};for(var ii=0,ll=incValues.length;ll>ii;ii++){var value=incValues[ii];incValues[ii]="proto"==value?klass.prototype:"this"==value?klass:Class.global[value]}return strict?Class.eval_strict(classWrapper,klass,incValues):classWrapper.apply(klass,incValues),klass}}(),Class.global=this,Class.eval_strict=function(e,t,o){var n,r=0;for(var a in Class.global)r++,n=a;t.newGlobals=0,e.apply(t,o);var l=0;for(var a in Class.global)l++;if(r+t.newGlobals!=l)throw"Class '"+t.className+"' defines "+(l-r)+" new global JavaScript variables without using this.addGlobal()";delete t.newGlobals},Class("Document.Emitter",function(){var proto=this.prototype;proto.className="Document.Emitter",proto.instantiate=function(){return eval("new "+this.className+"()")},proto.init=function(){this.output=""},proto.content=function(){return this.output},proto.insert=function(e){this.output+=e.output}}),Class("Document.Emitter.HTML(Document.Emitter)",function(){var e=this.prototype;e.className="Document.Emitter.HTML",e.begin_node=function(e){var t=e.type;switch(t){case"asis":case"line":return;case"br":case"hr":return void(this.output+="<"+t+" />");case"html":return void(this.output+='<span class="wafl">Raw HTML section. Edit in Wiki Text mode.</span>');case"waflparagraph":case"waflphrase":case"im":if(e._wafl.match(/^image:\s*(\S+)(?:\s+size=(\w+))?/)){var o="if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/"+e._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'",n=RegExp.$1,r=RegExp.$2;
switch(r){case"small":r="100";break;case"medium":r="300";break;case"large":r="600"}return r&&(r=' width="'+r+'"'),void(this.output+='<img src="'+n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" onload="'+o+'"'+r+" />")}return void(this.output+='<span class="wafl">'+e._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"</span>");case"a":case"wikilink":return void(this.output+='<a href="'+encodeURI(e._href)+'">');case"file":return void(this.output+='<a title="(network resource)" href="'+encodeURI(e._href)+'">');case"ul":case"ol":case"table":case"tr":return void(this.output+="<"+t+">\n");default:return void(this.output+="<"+t+">")}},e.end_node=function(e){var t=e.type;switch(t){case"asis":case"br":case"hr":case"html":case"waflparagraph":case"waflphrase":case"im":return;case"line":return void(this.output+="<br />");case"file":case"wikilink":return void(this.output+="</a>");default:return void(this.output+=0==t.search(/^(?:p|ul|ol|li|h\d|table|tr|td)$/)?"</"+t+">\n":"</"+t+">")}},e.text_node=function(e){this.output+=e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}),Class("Document.Parser",function(){var proto=this.prototype;proto.className="Document.Parser",proto.init=function(){},proto.parse=function(e,t){return this.input=-1==e.search(/\n$/)?e+"\n":e,t&&(this.receiver=t),this.receiver.init(),this.grammar=this.create_grammar(),this.parse_blocks("top"),this.receiver.content()},proto.create_grammar=function(){throw"Please define create_grammar in a derived class of Document.Parser."},proto.parse_blocks=function(e){var t=this.grammar[e].blocks;if(t)for(;this.input.length;){for(var o=this.input.length,n=0;n<t.length;n++){var r=t[n],a=this.find_match("matched_block",r);if(a){this.input=this.input.substr(a.end),this.handle_match(r,a);break}}if(this.input.length>=o)throw this.classname+": Reduction error for:\n"+this.input+"\n"+JSON.stringify(this)}},proto.handle_match=function(e,t){var o=this.grammar[e],n=o.blocks?"parse_blocks":"parse_phrases";this.subparse(n,t,e,o.filter)},proto.find_match=function(e,t){var o=this.grammar[t].match;if(!o)throw"no regexp for type: "+t;var n=this.input.match(o);if(n){var r=this[e].call(this,n,this.grammar[t].lookbehind);return r.type=this.grammar[t].type||t,r}},proto.parse_phrases=function(e){var t=this.grammar[e].phrases;if(!t)return void this.receiver.text_node(this.input||"");for(;this.input.length;){for(var o=null,n=0;n<t.length;n++){var r=t[n],a=this.find_match("matched_phrase",r);if(a&&(!o||a.begin<o.begin)&&(o=a,0==o.begin))break}if(!o){this.receiver.text_node(this.input||"");break}0!=o.begin&&this.receiver.text_node(this.input.substr(0,o.begin)||""),this.input=this.input.substr(o.end),this.handle_match(o.type,o)}},proto.subparse=function(func,match,type,filter){match.type=this.grammar[type].type,null==match.type&&(match.type=type);var filtered_text=filter?filter(match):null;match.type&&this.receiver.begin_node(match);var parser=eval("new "+this.className+"()");parser.input=null==filtered_text?match.text:filtered_text,parser.grammar=this.grammar,parser.receiver=this.receiver.instantiate(),parser[func].call(parser,type),this.receiver.insert(parser.receiver),match.type&&this.receiver.end_node(match)},proto.matched_block=function(e){return{begin:e.index,text:e[1],end:e[0].length,1:e[2],2:e[3],3:e[4]}},proto.matched_phrase=function(e,t){if(t){var o=e[2],n=this.input.indexOf(e[1]);return{text:o,begin:n,end:n+e[1].length,1:RegExp.$2,2:RegExp.$3,3:RegExp.$4}}return{begin:e.index,text:e[1],end:e.index+e[0].length,1:e[2],2:e[3],3:e[4]}}}),Class("Document.Parser.Wikitext(Document.Parser)",function(){var e=this.prototype;e.className="Document.Parser.Wikitext",e.init=function(){},e.create_grammar=function(){var e=["pre","html","hr","hx","waflparagraph","ul","ol","blockquote","p","empty","else"],t=["waflphrase","asis","wikilink","wikilink2","a","im","mail","file","tt","b","i","del","a"],o=function(e,o){return o="\\"+(o||e),e="\\"+e,{match:new RegExp("(?:^|[^"+e+"\\w])("+e+"(?=\\S)(?!"+o+")(.*?)"+o+"(?=[^"+o+"\\w]|$))"),phrases:"\\`"==e?null:t,lookbehind:!0}},n={yahoo:"yahoo",ymsgr:"yahoo",callto:"callto",callme:"callto",skype:"callto",aim:"aim"},r={aim:"AIM: %1",yahoo:"Yahoo: %1",callto:"Skype: %1"},a="(\\b(";for(var l in n)a+=l+"|";a=a.replace(/\|$/,")\\:([^\\s\\>\\)]+))");var i=function(e,t){var o=new RegExp("(^|\n)"+t+" *","g");return{match:new RegExp("^("+e+"+ .*\n(?:[*-+#]+ .*\n)*)(?:s*\n)?"),blocks:["ul","ol","subl","li"],filter:function(e){return e.text.replace(o,"$1")}}};return{_all_blocks:e,_all_phrases:t,top:{blocks:e},ol:i("#","[*#]"),ul:i("[-+*]","[-+*#]"),blockquote:{match:/^((?:>[^\n]*\n)+)(?:\s*\n)?/,blocks:["blockquote","line"],filter:function(e){return e.text.replace(/(^|\n)>\ ?/g,"$1")}},line:{match:/([^\n]*)\n/,phrases:t},subl:{type:"li",match:/^(([^\n]*)\n[*#]+\ [^\n]*\n(?:[*#]+\ [^\n]*\n)*)(?:\s*\n)?/,blocks:["ul","ol","li2"]},li:{match:/([^\n]*)\n/,phrases:t},li2:{type:"",match:/([^\n]*)\n/,phrases:t},html:{match:/^(\.html\ *\n(?:[^\n]*\n)*?\.html)\ *\n(?:\s*\n)?/,filter:function(e){return e._html=e.text,""}},pre:{match:/^\.pre\ *\n((?:[^\n]*\n)*?)\.pre\ *\n(?:\s*\n)?/},hr:{match:/^--+(?:\s*\n)?/},hx:{match:/^((\^+) *([^\n]*?)(\s+=+)?\s*?\n+)/,phrases:t,filter:function(e){return e.type="h"+e[1].length,e[2]}},p:{match:/^((?:(?!(?:(?:\^+|\#+|\*+|\-+) |\>|\.\w+\s*\n|\{[^\}]+\}\s*\n))[^\n]*\S[^\n]*\n)+(?:(?=^|\n)\s*\n)*)/,phrases:t,filter:function(e){return e.text.replace(/\n$/,"")}},empty:{match:/^(\s*\n)/,filter:function(e){e.type=""}},"else":{match:/^(([^\n]*)\n)/,phrases:[],filter:function(e){e.type="p"}},waflparagraph:{match:/^\{(.*)\}[\ \t]*\n(?:\s*\n)?/,filter:function(e){return e._wafl=e._label=e.text,""}},waflphrase:{match:/(?:^|[\s\-])((?:"([^\n]+?)")?\{([\w-]+(?=[\:\ \}])(?:\s*:)?\s*[^\n]*?\s*)\}(?=[\W_]|$))/,filter:function(e){return e._wafl=e[2],e._label=e[1]||e._wafl,""},lookbehind:!0},asis:{match:/(\{\{([^\n]*?)\}\}(\}*))/,filter:function(e){return e.type="",e[1]+e[2]}},wikilink:{match:/(?:^|[_\W])(\[()(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(e){return e._href="?"+e[2],e.text||e[2]},lookbehind:!0},wikilink2:{type:"wikilink",match:/(?:"([^"]*)"\s*)(\[(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(e){return e._href="?"+e[2],e[1]||e[2]}},a:{match:/((?:"([^"]*)"\s*)?<?((?:http|https|ftp|irc|file):(?:\/\/)?[\;\/\?\:\@\&\=\+\$\,\[\]\#A-Za-z0-9\-\_\.\!\~\*\'\(\)]+[A-Za-z0-9\/#])>?)/,filter:function(e){return e._href=e[2],e[1]||e[2]}},file:{match:/((?:"([^"]*)")?<(\\\\[^\s\>\)]+)>)/,filter:function(e){var t=e[2].replace(/^\\\\/,"");return e._href="file://"+t.replace(/\\/g,"/"),e[1]||t}},im:{match:new RegExp(a),filter:function(e){return e._wafl=e[1]+": "+e[2],e._label=(r[n[e[1]]]||"%1").replace(/%1/g,e[2]),""}},mail:{match:/([\w+%\-\.]+@(?:[\w\-]+\.)+[\w\-]+)/,filter:function(e){e.type="a",e._href="mailto:"+e.text.replace(/%/g,"%25")}},tt:o("`"),b:o("*"),i:o("_"),del:o("-")}}}),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function o(e){var t=e.length,o=at.type(e);return"function"===o||at.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===o||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,o){if(at.isFunction(t))return at.grep(e,function(e,n){return!!t.call(e,n,e)!==o});if(t.nodeType)return at.grep(e,function(e){return e===t!==o});if("string"==typeof t){if(ft.test(t))return at.filter(t,e,o);t=at.filter(t,e)}return at.grep(e,function(e){return at.inArray(e,t)>=0!==o})}function r(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function a(e){var t=xt[e]={};return at.each(e.match(Ct)||[],function(e,o){t[o]=!0}),t}function l(){mt.addEventListener?(mt.removeEventListener("DOMContentLoaded",i,!1),e.removeEventListener("load",i,!1)):(mt.detachEvent("onreadystatechange",i),e.detachEvent("onload",i))}function i(){(mt.addEventListener||"load"===event.type||"complete"===mt.readyState)&&(l(),at.ready())}function s(e,t,o){if(void 0===o&&1===e.nodeType){var n="data-"+t.replace(Et,"-$1").toLowerCase();if(o=e.getAttribute(n),"string"==typeof o){try{o="true"===o?!0:"false"===o?!1:"null"===o?null:+o+""===o?+o:Ft.test(o)?at.parseJSON(o):o}catch(r){}at.data(e,t,o)}else o=void 0}return o}function c(e){var t;for(t in e)if(("data"!==t||!at.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function u(e,t,o,n){if(at.acceptData(e)){var r,a,l=at.expando,i=e.nodeType,s=i?at.cache:e,c=i?e[l]:e[l]&&l;if(c&&s[c]&&(n||s[c].data)||void 0!==o||"string"!=typeof t)return c||(c=i?e[l]=K.pop()||at.guid++:l),s[c]||(s[c]=i?{}:{toJSON:at.noop}),("object"==typeof t||"function"==typeof t)&&(n?s[c]=at.extend(s[c],t):s[c].data=at.extend(s[c].data,t)),a=s[c],n||(a.data||(a.data={}),a=a.data),void 0!==o&&(a[at.camelCase(t)]=o),"string"==typeof t?(r=a[t],null==r&&(r=a[at.camelCase(t)])):r=a,r}}function d(e,t,o){if(at.acceptData(e)){var n,r,a=e.nodeType,l=a?at.cache:e,i=a?e[at.expando]:at.expando;if(l[i]){if(t&&(n=o?l[i]:l[i].data)){at.isArray(t)?t=t.concat(at.map(t,at.camelCase)):t in n?t=[t]:(t=at.camelCase(t),t=t in n?[t]:t.split(" ")),r=t.length;for(;r--;)delete n[t[r]];if(o?!c(n):!at.isEmptyObject(n))return}(o||(delete l[i].data,c(l[i])))&&(a?at.cleanData([e],!0):nt.deleteExpando||l!=l.window?delete l[i]:l[i]=null)}}}function p(){return!0}function f(){return!1}function h(){try{return mt.activeElement}catch(e){}}function m(e){var t=Ot.split("|"),o=e.createDocumentFragment();if(o.createElement)for(;t.length;)o.createElement(t.pop());return o}function g(e,t){var o,n,r=0,a=typeof e.getElementsByTagName!==Tt?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==Tt?e.querySelectorAll(t||"*"):void 0;if(!a)for(a=[],o=e.childNodes||e;null!=(n=o[r]);r++)!t||at.nodeName(n,t)?a.push(n):at.merge(a,g(n,t));return void 0===t||t&&at.nodeName(e,t)?at.merge([e],a):a}function v(e){Rt.test(e.type)&&(e.defaultChecked=e.checked)}function b(e,t){return at.nodeName(e,"table")&&at.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function y(e){return e.type=(null!==at.find.attr(e,"type"))+"/"+e.type,e}function C(e){var t=Kt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function x(e,t){for(var o,n=0;null!=(o=e[n]);n++)at._data(o,"globalEval",!t||at._data(t[n],"globalEval"))}function w(e,t){if(1===t.nodeType&&at.hasData(e)){var o,n,r,a=at._data(e),l=at._data(t,a),i=a.events;if(i){delete l.handle,l.events={};for(o in i)for(n=0,r=i[o].length;r>n;n++)at.event.add(t,o,i[o][n])}l.data&&(l.data=at.extend({},l.data))}}function S(e,t){var o,n,r;if(1===t.nodeType){if(o=t.nodeName.toLowerCase(),!nt.noCloneEvent&&t[at.expando]){r=at._data(t);for(n in r.events)at.removeEvent(t,n,r.handle);t.removeAttribute(at.expando)}"script"===o&&t.text!==e.text?(y(t).text=e.text,C(t)):"object"===o?(t.parentNode&&(t.outerHTML=e.outerHTML),nt.html5Clone&&e.innerHTML&&!at.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===o&&Rt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===o?t.defaultSelected=t.selected=e.defaultSelected:("input"===o||"textarea"===o)&&(t.defaultValue=e.defaultValue)}}function T(t,o){var n=at(o.createElement(t)).appendTo(o.body),r=e.getDefaultComputedStyle?e.getDefaultComputedStyle(n[0]).display:at.css(n[0],"display");return n.detach(),r}function F(e){var t=mt,o=eo[e];return o||(o=T(e,t),"none"!==o&&o||(Qt=(Qt||at("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Qt[0].contentWindow||Qt[0].contentDocument).document,t.write(),t.close(),o=T(e,t),Qt.detach()),eo[e]=o),o}function E(e,t){return{get:function(){var o=e();return null!=o?o?void delete this.get:(this.get=t).apply(this,arguments):void 0}}}function k(e,t){if(t in e)return t;for(var o=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=ho.length;r--;)if(t=ho[r]+o,t in e)return t;return n}function _(e,t){for(var o,n,r,a=[],l=0,i=e.length;i>l;l++)n=e[l],n.style&&(a[l]=at._data(n,"olddisplay"),o=n.style.display,t?(a[l]||"none"!==o||(n.style.display=""),""===n.style.display&&At(n)&&(a[l]=at._data(n,"olddisplay",F(n.nodeName)))):a[l]||(r=At(n),(o&&"none"!==o||!r)&&at._data(n,"olddisplay",r?o:at.css(n,"display"))));for(l=0;i>l;l++)n=e[l],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?a[l]||"":"none"));return e}function A(e,t,o){var n=co.exec(t);return n?Math.max(0,n[1]-(o||0))+(n[2]||"px"):t}function P(e,t,o,n,r){for(var a=o===(n?"border":"content")?4:"width"===t?1:0,l=0;4>a;a+=2)"margin"===o&&(l+=at.css(e,o+_t[a],!0,r)),n?("content"===o&&(l-=at.css(e,"padding"+_t[a],!0,r)),"margin"!==o&&(l-=at.css(e,"border"+_t[a]+"Width",!0,r))):(l+=at.css(e,"padding"+_t[a],!0,r),"padding"!==o&&(l+=at.css(e,"border"+_t[a]+"Width",!0,r)));return l}function R(e,t,o){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,a=to(e),l=nt.boxSizing()&&"border-box"===at.css(e,"boxSizing",!1,a);if(0>=r||null==r){if(r=oo(e,t,a),(0>r||null==r)&&(r=e.style[t]),ro.test(r))return r;n=l&&(nt.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+P(e,t,o||(l?"border":"content"),n,a)+"px"}function L(e,t,o,n,r){return new L.prototype.init(e,t,o,n,r)}function M(){return setTimeout(function(){mo=void 0}),mo=at.now()}function D(e,t){var o,n={height:e},r=0;for(t=t?1:0;4>r;r+=2-t)o=_t[r],n["margin"+o]=n["padding"+o]=e;return t&&(n.opacity=n.width=e),n}function N(e,t,o){for(var n,r=(xo[t]||[]).concat(xo["*"]),a=0,l=r.length;l>a;a++)if(n=r[a].call(o,t,e))return n}function I(e,t,o){var n,r,a,l,i,s,c,u,d=this,p={},f=e.style,h=e.nodeType&&At(e),m=at._data(e,"fxshow");o.queue||(i=at._queueHooks(e,"fx"),null==i.unqueued&&(i.unqueued=0,s=i.empty.fire,i.empty.fire=function(){i.unqueued||s()}),i.unqueued++,d.always(function(){d.always(function(){i.unqueued--,at.queue(e,"fx").length||i.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(o.overflow=[f.overflow,f.overflowX,f.overflowY],c=at.css(e,"display"),u=F(e.nodeName),"none"===c&&(c=u),"inline"===c&&"none"===at.css(e,"float")&&(nt.inlineBlockNeedsLayout&&"inline"!==u?f.zoom=1:f.display="inline-block")),o.overflow&&(f.overflow="hidden",nt.shrinkWrapBlocks()||d.always(function(){f.overflow=o.overflow[0],f.overflowX=o.overflow[1],f.overflowY=o.overflow[2]}));for(n in t)if(r=t[n],vo.exec(r)){if(delete t[n],a=a||"toggle"===r,r===(h?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;h=!0}p[n]=m&&m[n]||at.style(e,n)}if(!at.isEmptyObject(p)){m?"hidden"in m&&(h=m.hidden):m=at._data(e,"fxshow",{}),a&&(m.hidden=!h),h?at(e).show():d.done(function(){at(e).hide()}),d.done(function(){var t;at._removeData(e,"fxshow");for(t in p)at.style(e,t,p[t])});for(n in p)l=N(h?m[n]:0,n,d),n in m||(m[n]=l.start,h&&(l.end=l.start,l.start="width"===n||"height"===n?1:0))}}function O(e,t){var o,n,r,a,l;for(o in e)if(n=at.camelCase(o),r=t[n],a=e[o],at.isArray(a)&&(r=a[1],a=e[o]=a[0]),o!==n&&(e[n]=a,delete e[o]),l=at.cssHooks[n],l&&"expand"in l){a=l.expand(a),delete e[n];for(o in a)o in e||(e[o]=a[o],t[o]=r)}else t[n]=r}function B(e,t,o){var n,r,a=0,l=Co.length,i=at.Deferred().always(function(){delete s.elem}),s=function(){if(r)return!1;for(var t=mo||M(),o=Math.max(0,c.startTime+c.duration-t),n=o/c.duration||0,a=1-n,l=0,s=c.tweens.length;s>l;l++)c.tweens[l].run(a);return i.notifyWith(e,[c,a,o]),1>a&&s?o:(i.resolveWith(e,[c]),!1)},c=i.promise({elem:e,props:at.extend({},t),opts:at.extend(!0,{specialEasing:{}},o),originalProperties:t,originalOptions:o,startTime:mo||M(),duration:o.duration,tweens:[],createTween:function(t,o){var n=at.Tween(e,c.opts,t,o,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var o=0,n=t?c.tweens.length:0;if(r)return this;for(r=!0;n>o;o++)c.tweens[o].run(1);return t?i.resolveWith(e,[c,t]):i.rejectWith(e,[c,t]),this}}),u=c.props;for(O(u,c.opts.specialEasing);l>a;a++)if(n=Co[a].call(c,e,u,c.opts))return n;return at.map(u,N,c),at.isFunction(c.opts.start)&&c.opts.start.call(e,c),at.fx.timer(at.extend(s,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function U(e){return function(t,o){"string"!=typeof t&&(o=t,t="*");var n,r=0,a=t.toLowerCase().match(Ct)||[];if(at.isFunction(o))for(;n=a[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(o)):(e[n]=e[n]||[]).push(o)}}function z(e,t,o,n){function r(i){var s;return a[i]=!0,at.each(e[i]||[],function(e,i){var c=i(t,o,n);return"string"!=typeof c||l||a[c]?l?!(s=c):void 0:(t.dataTypes.unshift(c),r(c),!1)}),s}var a={},l=e===Wo;return r(t.dataTypes[0])||!a["*"]&&r("*")}function H(e,t){var o,n,r=at.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:o||(o={}))[n]=t[n]);return o&&at.extend(!0,e,o),e}function j(e,t,o){for(var n,r,a,l,i=e.contents,s=e.dataTypes;"*"===s[0];)s.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(l in i)if(i[l]&&i[l].test(r)){s.unshift(l);break}if(s[0]in o)a=s[0];else{for(l in o){if(!s[0]||e.converters[l+" "+s[0]]){a=l;break}n||(n=l)}a=a||n}return a?(a!==s[0]&&s.unshift(a),o[a]):void 0}function G(e,t,o,n){var r,a,l,i,s,c={},u=e.dataTypes.slice();if(u[1])for(l in e.converters)c[l.toLowerCase()]=e.converters[l];for(a=u.shift();a;)if(e.responseFields[a]&&(o[e.responseFields[a]]=t),!s&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),s=a,a=u.shift())if("*"===a)a=s;else if("*"!==s&&s!==a){if(l=c[s+" "+a]||c["* "+a],!l)for(r in c)if(i=r.split(" "),i[1]===a&&(l=c[s+" "+i[0]]||c["* "+i[0]])){l===!0?l=c[r]:c[r]!==!0&&(a=i[0],u.unshift(i[1]));break}if(l!==!0)if(l&&e["throws"])t=l(t);else try{t=l(t)}catch(d){return{state:"parsererror",error:l?d:"No conversion from "+s+" to "+a}}}return{state:"success",data:t}}function V(e,t,o,n){var r;if(at.isArray(t))at.each(t,function(t,r){o||qo.test(e)?n(e,r):V(e+"["+("object"==typeof r?t:"")+"]",r,o,n)});else if(o||"object"!==at.type(t))n(e,t);else for(r in t)V(e+"["+r+"]",t[r],o,n)}function W(){try{return new e.XMLHttpRequest}catch(t){}}function $(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function X(e){return at.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var K=[],q=K.slice,Y=K.concat,J=K.push,Z=K.indexOf,Q={},et=Q.toString,tt=Q.hasOwnProperty,ot="".trim,nt={},rt="1.11.0",at=function(e,t){return new at.fn.init(e,t)},lt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,it=/^-ms-/,st=/-([\da-z])/gi,ct=function(e,t){return t.toUpperCase()};at.fn=at.prototype={jquery:rt,constructor:at,selector:"",length:0,toArray:function(){return q.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:q.call(this)},pushStack:function(e){var t=at.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return at.each(this,e,t)},map:function(e){return this.pushStack(at.map(this,function(t,o){return e.call(t,o,t)}))},slice:function(){return this.pushStack(q.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,o=+e+(0>e?t:0);return this.pushStack(o>=0&&t>o?[this[o]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:K.sort,splice:K.splice},at.extend=at.fn.extend=function(){var e,t,o,n,r,a,l=arguments[0]||{},i=1,s=arguments.length,c=!1;for("boolean"==typeof l&&(c=l,l=arguments[i]||{},i++),"object"==typeof l||at.isFunction(l)||(l={}),i===s&&(l=this,i--);s>i;i++)if(null!=(r=arguments[i]))for(n in r)e=l[n],o=r[n],l!==o&&(c&&o&&(at.isPlainObject(o)||(t=at.isArray(o)))?(t?(t=!1,a=e&&at.isArray(e)?e:[]):a=e&&at.isPlainObject(e)?e:{},l[n]=at.extend(c,a,o)):void 0!==o&&(l[n]=o));return l},at.extend({expando:"jQuery"+(rt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===at.type(e)},isArray:Array.isArray||function(e){return"array"===at.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==at.type(e)||e.nodeType||at.isWindow(e))return!1;try{if(e.constructor&&!tt.call(e,"constructor")&&!tt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(o){return!1}if(nt.ownLast)for(t in e)return tt.call(e,t);for(t in e);return void 0===t||tt.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Q[et.call(e)]||"object":typeof e},globalEval:function(t){t&&at.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(it,"ms-").replace(st,ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,a=0,l=e.length,i=o(e);if(n){if(i)for(;l>a&&(r=t.apply(e[a],n),r!==!1);a++);else for(a in e)if(r=t.apply(e[a],n),r===!1)break}else if(i)for(;l>a&&(r=t.call(e[a],a,e[a]),r!==!1);a++);else for(a in e)if(r=t.call(e[a],a,e[a]),r===!1)break;return e},trim:ot&&!ot.call("﻿ ")?function(e){return null==e?"":ot.call(e)}:function(e){return null==e?"":(e+"").replace(lt,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(o(Object(e))?at.merge(n,"string"==typeof e?[e]:e):J.call(n,e)),n},inArray:function(e,t,o){var n;if(t){if(Z)return Z.call(t,e,o);for(n=t.length,o=o?0>o?Math.max(0,n+o):o:0;n>o;o++)if(o in t&&t[o]===e)return o}return-1},merge:function(e,t){for(var o=+t.length,n=0,r=e.length;o>n;)e[r++]=t[n++];if(o!==o)for(;void 0!==t[n];)e[r++]=t[n++];return e.length=r,e},grep:function(e,t,o){for(var n,r=[],a=0,l=e.length,i=!o;l>a;a++)n=!t(e[a],a),n!==i&&r.push(e[a]);return r},map:function(e,t,n){var r,a=0,l=e.length,i=o(e),s=[];if(i)for(;l>a;a++)r=t(e[a],a,n),null!=r&&s.push(r);else for(a in e)r=t(e[a],a,n),null!=r&&s.push(r);return Y.apply([],s)},guid:1,proxy:function(e,t){var o,n,r;return"string"==typeof t&&(r=e[t],t=e,e=r),at.isFunction(e)?(o=q.call(arguments,2),n=function(){return e.apply(t||this,o.concat(q.call(arguments)))},n.guid=e.guid=e.guid||at.guid++,n):void 0},now:function(){return+new Date},support:nt}),at.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Q["[object "+t+"]"]=t.toLowerCase()});var ut=function(e){function t(e,t,o,n){var r,a,l,i,s,c,d,h,m,g;if((t?t.ownerDocument||t:z)!==L&&R(t),t=t||L,o=o||[],!e||"string"!=typeof e)return o;if(1!==(i=t.nodeType)&&9!==i)return[];if(D&&!n){if(r=bt.exec(e))if(l=r[1]){if(9===i){if(a=t.getElementById(l),!a||!a.parentNode)return o;if(a.id===l)return o.push(a),o}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(l))&&B(t,a)&&a.id===l)return o.push(a),o}else{if(r[2])return Q.apply(o,t.getElementsByTagName(e)),o;if((l=r[3])&&S.getElementsByClassName&&t.getElementsByClassName)return Q.apply(o,t.getElementsByClassName(l)),o}if(S.qsa&&(!N||!N.test(e))){if(h=d=U,m=t,g=9===i&&e,1===i&&"object"!==t.nodeName.toLowerCase()){for(c=p(e),(d=t.getAttribute("id"))?h=d.replace(Ct,"\\$&"):t.setAttribute("id",h),h="[id='"+h+"'] ",s=c.length;s--;)c[s]=h+f(c[s]);m=yt.test(e)&&u(t.parentNode)||t,g=c.join(",")}if(g)try{return Q.apply(o,m.querySelectorAll(g)),o}catch(v){}finally{d||t.removeAttribute("id")}}}return x(e.replace(st,"$1"),t,o,n)}function o(){function e(o,n){return t.push(o+" ")>T.cacheLength&&delete e[t.shift()],e[o+" "]=n}var t=[];return e}function n(e){return e[U]=!0,e}function r(e){var t=L.createElement("div");try{return!!e(t)}catch(o){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var o=e.split("|"),n=e.length;n--;)T.attrHandle[o[n]]=t}function l(e,t){var o=t&&e,n=o&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(n)return n;if(o)for(;o=o.nextSibling;)if(o===t)return-1;return e?1:-1}function i(e){return function(t){var o=t.nodeName.toLowerCase();return"input"===o&&t.type===e}}function s(e){return function(t){var o=t.nodeName.toLowerCase();return("input"===o||"button"===o)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(o,n){for(var r,a=e([],o.length,t),l=a.length;l--;)o[r=a[l]]&&(o[r]=!(n[r]=o[r]))})})}function u(e){return e&&typeof e.getElementsByTagName!==X&&e}function d(){}function p(e,o){var n,r,a,l,i,s,c,u=V[e+" "];if(u)return o?0:u.slice(0);for(i=e,s=[],c=T.preFilter;i;){(!n||(r=ct.exec(i)))&&(r&&(i=i.slice(r[0].length)||i),s.push(a=[])),n=!1,(r=ut.exec(i))&&(n=r.shift(),a.push({value:n,type:r[0].replace(st," ")}),i=i.slice(n.length));for(l in T.filter)!(r=ht[l].exec(i))||c[l]&&!(r=c[l](r))||(n=r.shift(),a.push({value:n,type:l,matches:r}),i=i.slice(n.length));if(!n)break}return o?i.length:i?t.error(e):V(e,s).slice(0)}function f(e){for(var t=0,o=e.length,n="";o>t;t++)n+=e[t].value;return n}function h(e,t,o){var n=t.dir,r=o&&"parentNode"===n,a=j++;return t.first?function(t,o,a){for(;t=t[n];)if(1===t.nodeType||r)return e(t,o,a)}:function(t,o,l){var i,s,c=[H,a];if(l){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,o,l))return!0}else for(;t=t[n];)if(1===t.nodeType||r){if(s=t[U]||(t[U]={}),(i=s[n])&&i[0]===H&&i[1]===a)return c[2]=i[2];if(s[n]=c,c[2]=e(t,o,l))return!0}}}function m(e){return e.length>1?function(t,o,n){for(var r=e.length;r--;)if(!e[r](t,o,n))return!1;return!0}:e[0]}function g(e,t,o,n,r){for(var a,l=[],i=0,s=e.length,c=null!=t;s>i;i++)(a=e[i])&&(!o||o(a,n,r))&&(l.push(a),c&&t.push(i));return l}function v(e,t,o,r,a,l){return r&&!r[U]&&(r=v(r)),a&&!a[U]&&(a=v(a,l)),n(function(n,l,i,s){var c,u,d,p=[],f=[],h=l.length,m=n||C(t||"*",i.nodeType?[i]:i,[]),v=!e||!n&&t?m:g(m,p,e,i,s),b=o?a||(n?e:h||r)?[]:l:v;if(o&&o(v,b,i,s),r)for(c=g(b,f),r(c,[],i,s),u=c.length;u--;)(d=c[u])&&(b[f[u]]=!(v[f[u]]=d));if(n){if(a||e){if(a){for(c=[],u=b.length;u--;)(d=b[u])&&c.push(v[u]=d);a(null,b=[],c,s)}for(u=b.length;u--;)(d=b[u])&&(c=a?tt.call(n,d):p[u])>-1&&(n[c]=!(l[c]=d))}}else b=g(b===l?b.splice(h,b.length):b),a?a(null,l,b,s):Q.apply(l,b)})}function b(e){for(var t,o,n,r=e.length,a=T.relative[e[0].type],l=a||T.relative[" "],i=a?1:0,s=h(function(e){return e===t},l,!0),c=h(function(e){return tt.call(t,e)>-1},l,!0),u=[function(e,o,n){return!a&&(n||o!==_)||((t=o).nodeType?s(e,o,n):c(e,o,n))}];r>i;i++)if(o=T.relative[e[i].type])u=[h(m(u),o)];else{if(o=T.filter[e[i].type].apply(null,e[i].matches),o[U]){for(n=++i;r>n&&!T.relative[e[n].type];n++);return v(i>1&&m(u),i>1&&f(e.slice(0,i-1).concat({value:" "===e[i-2].type?"*":""})).replace(st,"$1"),o,n>i&&b(e.slice(i,n)),r>n&&b(e=e.slice(n)),r>n&&f(e))}u.push(o)}return m(u)}function y(e,o){var r=o.length>0,a=e.length>0,l=function(n,l,i,s,c){var u,d,p,f=0,h="0",m=n&&[],v=[],b=_,y=n||a&&T.find.TAG("*",c),C=H+=null==b?1:Math.random()||.1,x=y.length;for(c&&(_=l!==L&&l);h!==x&&null!=(u=y[h]);h++){if(a&&u){for(d=0;p=e[d++];)if(p(u,l,i)){s.push(u);break}c&&(H=C)}r&&((u=!p&&u)&&f--,n&&m.push(u))}if(f+=h,r&&h!==f){for(d=0;p=o[d++];)p(m,v,l,i);if(n){if(f>0)for(;h--;)m[h]||v[h]||(v[h]=J.call(s));v=g(v)}Q.apply(s,v),c&&!n&&v.length>0&&f+o.length>1&&t.uniqueSort(s)}return c&&(H=C,_=b),m};return r?n(l):l}function C(e,o,n){for(var r=0,a=o.length;a>r;r++)t(e,o[r],n);return n}function x(e,t,o,n){var r,a,l,i,s,c=p(e);if(!n&&1===c.length){if(a=c[0]=c[0].slice(0),a.length>2&&"ID"===(l=a[0]).type&&S.getById&&9===t.nodeType&&D&&T.relative[a[1].type]){if(t=(T.find.ID(l.matches[0].replace(xt,wt),t)||[])[0],!t)return o;e=e.slice(a.shift().value.length)}for(r=ht.needsContext.test(e)?0:a.length;r--&&(l=a[r],!T.relative[i=l.type]);)if((s=T.find[i])&&(n=s(l.matches[0].replace(xt,wt),yt.test(a[0].type)&&u(t.parentNode)||t))){if(a.splice(r,1),e=n.length&&f(a),!e)return Q.apply(o,n),o;break}}return k(e,c)(n,t,!D,o,yt.test(e)&&u(t.parentNode)||t),o}var w,S,T,F,E,k,_,A,P,R,L,M,D,N,I,O,B,U="sizzle"+-new Date,z=e.document,H=0,j=0,G=o(),V=o(),W=o(),$=function(e,t){return e===t&&(P=!0),0},X="undefined",K=1<<31,q={}.hasOwnProperty,Y=[],J=Y.pop,Z=Y.push,Q=Y.push,et=Y.slice,tt=Y.indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(this[t]===e)return t;return-1},ot="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",rt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",at=rt.replace("w","w#"),lt="\\["+nt+"*("+rt+")"+nt+"*(?:([*^$|!~]?=)"+nt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+at+")|)|)"+nt+"*\\]",it=":("+rt+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+lt.replace(3,8)+")*)|.*)\\)|)",st=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ct=new RegExp("^"+nt+"*,"+nt+"*"),ut=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),dt=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),pt=new RegExp(it),ft=new RegExp("^"+at+"$"),ht={ID:new RegExp("^#("+rt+")"),CLASS:new RegExp("^\\.("+rt+")"),TAG:new RegExp("^("+rt.replace("w","w*")+")"),ATTR:new RegExp("^"+lt),PSEUDO:new RegExp("^"+it),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+ot+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,Ct=/'|\\/g,xt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),wt=function(e,t,o){var n="0x"+t-65536;return n!==n||o?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Q.apply(Y=et.call(z.childNodes),z.childNodes),Y[z.childNodes.length].nodeType}catch(St){Q={apply:Y.length?function(e,t){Z.apply(e,et.call(t))}:function(e,t){for(var o=e.length,n=0;e[o++]=t[n++];);e.length=o-1}}}S=t.support={},E=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},R=t.setDocument=function(e){var t,o=e?e.ownerDocument||e:z,n=o.defaultView;return o!==L&&9===o.nodeType&&o.documentElement?(L=o,M=o.documentElement,D=!E(o),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){R()},!1):n.attachEvent&&n.attachEvent("onunload",function(){R()})),S.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),S.getElementsByTagName=r(function(e){return e.appendChild(o.createComment("")),!e.getElementsByTagName("*").length}),S.getElementsByClassName=vt.test(o.getElementsByClassName)&&r(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),S.getById=r(function(e){return M.appendChild(e).id=U,!o.getElementsByName||!o.getElementsByName(U).length}),S.getById?(T.find.ID=function(e,t){if(typeof t.getElementById!==X&&D){var o=t.getElementById(e);return o&&o.parentNode?[o]:[]}},T.filter.ID=function(e){var t=e.replace(xt,wt);return function(e){return e.getAttribute("id")===t}}):(delete T.find.ID,T.filter.ID=function(e){var t=e.replace(xt,wt);return function(e){var o=typeof e.getAttributeNode!==X&&e.getAttributeNode("id");return o&&o.value===t}}),T.find.TAG=S.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==X?t.getElementsByTagName(e):void 0}:function(e,t){var o,n=[],r=0,a=t.getElementsByTagName(e);if("*"===e){for(;o=a[r++];)1===o.nodeType&&n.push(o);return n}return a},T.find.CLASS=S.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==X&&D?t.getElementsByClassName(e):void 0},I=[],N=[],(S.qsa=vt.test(o.querySelectorAll))&&(r(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&N.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+nt+"*(?:value|"+ot+")"),e.querySelectorAll(":checked").length||N.push(":checked")}),r(function(e){var t=o.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+nt+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")
})),(S.matchesSelector=vt.test(O=M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&r(function(e){S.disconnectedMatch=O.call(e,"div"),O.call(e,"[s!='']:x"),I.push("!=",it)}),N=N.length&&new RegExp(N.join("|")),I=I.length&&new RegExp(I.join("|")),t=vt.test(M.compareDocumentPosition),B=t||vt.test(M.contains)?function(e,t){var o=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(o.contains?o.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=t?function(e,t){if(e===t)return P=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!S.sortDetached&&t.compareDocumentPosition(e)===n?e===o||e.ownerDocument===z&&B(z,e)?-1:t===o||t.ownerDocument===z&&B(z,t)?1:A?tt.call(A,e)-tt.call(A,t):0:4&n?-1:1)}:function(e,t){if(e===t)return P=!0,0;var n,r=0,a=e.parentNode,i=t.parentNode,s=[e],c=[t];if(!a||!i)return e===o?-1:t===o?1:a?-1:i?1:A?tt.call(A,e)-tt.call(A,t):0;if(a===i)return l(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;s[r]===c[r];)r++;return r?l(s[r],c[r]):s[r]===z?-1:c[r]===z?1:0},o):L},t.matches=function(e,o){return t(e,null,null,o)},t.matchesSelector=function(e,o){if((e.ownerDocument||e)!==L&&R(e),o=o.replace(dt,"='$1']"),!(!S.matchesSelector||!D||I&&I.test(o)||N&&N.test(o)))try{var n=O.call(e,o);if(n||S.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return t(o,L,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==L&&R(e),B(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==L&&R(e);var o=T.attrHandle[t.toLowerCase()],n=o&&q.call(T.attrHandle,t.toLowerCase())?o(e,t,!D):void 0;return void 0!==n?n:S.attributes||!D?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,o=[],n=0,r=0;if(P=!S.detectDuplicates,A=!S.sortStable&&e.slice(0),e.sort($),P){for(;t=e[r++];)t===e[r]&&(n=o.push(r));for(;n--;)e.splice(o[n],1)}return A=null,e},F=t.getText=function(e){var t,o="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)o+=F(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)o+=F(t);return o},T=t.selectors={cacheLength:50,createPseudo:n,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xt,wt),e[3]=(e[4]||e[5]||"").replace(xt,wt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,o=!e[5]&&e[2];return ht.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:o&&pt.test(o)&&(t=p(o,!0))&&(t=o.indexOf(")",o.length-t)-o.length)&&(e[0]=e[0].slice(0,t),e[2]=o.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xt,wt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=G[e+" "];return t||(t=new RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&G(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==X&&e.getAttribute("class")||"")})},ATTR:function(e,o,n){return function(r){var a=t.attr(r,e);return null==a?"!="===o:o?(a+="","="===o?a===n:"!="===o?a!==n:"^="===o?n&&0===a.indexOf(n):"*="===o?n&&a.indexOf(n)>-1:"$="===o?n&&a.slice(-n.length)===n:"~="===o?(" "+a+" ").indexOf(n)>-1:"|="===o?a===n||a.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,o,n,r){var a="nth"!==e.slice(0,3),l="last"!==e.slice(-4),i="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,o,s){var c,u,d,p,f,h,m=a!==l?"nextSibling":"previousSibling",g=t.parentNode,v=i&&t.nodeName.toLowerCase(),b=!s&&!i;if(g){if(a){for(;m;){for(d=t;d=d[m];)if(i?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;h=m="only"===e&&!h&&"nextSibling"}return!0}if(h=[l?g.firstChild:g.lastChild],l&&b){for(u=g[U]||(g[U]={}),c=u[e]||[],f=c[0]===H&&c[1],p=c[0]===H&&c[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(p=f=0)||h.pop();)if(1===d.nodeType&&++p&&d===t){u[e]=[H,f,p];break}}else if(b&&(c=(t[U]||(t[U]={}))[e])&&c[0]===H)p=c[1];else for(;(d=++f&&d&&d[m]||(p=f=0)||h.pop())&&((i?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++p||(b&&((d[U]||(d[U]={}))[e]=[H,p]),d!==t)););return p-=r,p===n||p%n===0&&p/n>=0}}},PSEUDO:function(e,o){var r,a=T.pseudos[e]||T.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return a[U]?a(o):a.length>1?(r=[e,e,"",o],T.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,r=a(e,o),l=r.length;l--;)n=tt.call(e,r[l]),e[n]=!(t[n]=r[l])}):function(e){return a(e,0,r)}):a}},pseudos:{not:n(function(e){var t=[],o=[],r=k(e.replace(st,"$1"));return r[U]?n(function(e,t,o,n){for(var a,l=r(e,null,n,[]),i=e.length;i--;)(a=l[i])&&(e[i]=!(t[i]=a))}):function(e,n,a){return t[0]=e,r(t,null,a,o),!o.pop()}}),has:n(function(e){return function(o){return t(e,o).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||F(t)).indexOf(e)>-1}}),lang:n(function(e){return ft.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(xt,wt).toLowerCase(),function(t){var o;do if(o=D?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return o=o.toLowerCase(),o===e||0===o.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var o=e.location&&e.location.hash;return o&&o.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===L.activeElement&&(!L.hasFocus||L.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return mt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,o){return[0>o?o+t:o]}),even:c(function(e,t){for(var o=0;t>o;o+=2)e.push(o);return e}),odd:c(function(e,t){for(var o=1;t>o;o+=2)e.push(o);return e}),lt:c(function(e,t,o){for(var n=0>o?o+t:o;--n>=0;)e.push(n);return e}),gt:c(function(e,t,o){for(var n=0>o?o+t:o;++n<t;)e.push(n);return e})}},T.pseudos.nth=T.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[w]=i(w);for(w in{submit:!0,reset:!0})T.pseudos[w]=s(w);return d.prototype=T.filters=T.pseudos,T.setFilters=new d,k=t.compile=function(e,t){var o,n=[],r=[],a=W[e+" "];if(!a){for(t||(t=p(e)),o=t.length;o--;)a=b(t[o]),a[U]?n.push(a):r.push(a);a=W(e,y(r,n))}return a},S.sortStable=U.split("").sort($).join("")===U,S.detectDuplicates=!!P,R(),S.sortDetached=r(function(e){return 1&e.compareDocumentPosition(L.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,o){return o?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),S.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,o){return o||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||a(ot,function(e,t,o){var n;return o?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);at.find=ut,at.expr=ut.selectors,at.expr[":"]=at.expr.pseudos,at.unique=ut.uniqueSort,at.text=ut.getText,at.isXMLDoc=ut.isXML,at.contains=ut.contains;var dt=at.expr.match.needsContext,pt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ft=/^.[^:#\[\.,]*$/;at.filter=function(e,t,o){var n=t[0];return o&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?at.find.matchesSelector(n,e)?[n]:[]:at.find.matches(e,at.grep(t,function(e){return 1===e.nodeType}))},at.fn.extend({find:function(e){var t,o=[],n=this,r=n.length;if("string"!=typeof e)return this.pushStack(at(e).filter(function(){for(t=0;r>t;t++)if(at.contains(n[t],this))return!0}));for(t=0;r>t;t++)at.find(e,n[t],o);return o=this.pushStack(r>1?at.unique(o):o),o.selector=this.selector?this.selector+" "+e:e,o},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&dt.test(e)?at(e):e||[],!1).length}});var ht,mt=e.document,gt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,vt=at.fn.init=function(e,t){var o,n;if(!e)return this;if("string"==typeof e){if(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:gt.exec(e),!o||!o[1]&&t)return!t||t.jquery?(t||ht).find(e):this.constructor(t).find(e);if(o[1]){if(t=t instanceof at?t[0]:t,at.merge(this,at.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:mt,!0)),pt.test(o[1])&&at.isPlainObject(t))for(o in t)at.isFunction(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}if(n=mt.getElementById(o[2]),n&&n.parentNode){if(n.id!==o[2])return ht.find(e);this.length=1,this[0]=n}return this.context=mt,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):at.isFunction(e)?"undefined"!=typeof ht.ready?ht.ready(e):e(at):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),at.makeArray(e,this))};vt.prototype=at.fn,ht=at(mt);var bt=/^(?:parents|prev(?:Until|All))/,yt={children:!0,contents:!0,next:!0,prev:!0};at.extend({dir:function(e,t,o){for(var n=[],r=e[t];r&&9!==r.nodeType&&(void 0===o||1!==r.nodeType||!at(r).is(o));)1===r.nodeType&&n.push(r),r=r[t];return n},sibling:function(e,t){for(var o=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&o.push(e);return o}}),at.fn.extend({has:function(e){var t,o=at(e,this),n=o.length;return this.filter(function(){for(t=0;n>t;t++)if(at.contains(this,o[t]))return!0})},closest:function(e,t){for(var o,n=0,r=this.length,a=[],l=dt.test(e)||"string"!=typeof e?at(e,t||this.context):0;r>n;n++)for(o=this[n];o&&o!==t;o=o.parentNode)if(o.nodeType<11&&(l?l.index(o)>-1:1===o.nodeType&&at.find.matchesSelector(o,e))){a.push(o);break}return this.pushStack(a.length>1?at.unique(a):a)},index:function(e){return e?"string"==typeof e?at.inArray(this[0],at(e)):at.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(at.unique(at.merge(this.get(),at(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),at.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return at.dir(e,"parentNode")},parentsUntil:function(e,t,o){return at.dir(e,"parentNode",o)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return at.dir(e,"nextSibling")},prevAll:function(e){return at.dir(e,"previousSibling")},nextUntil:function(e,t,o){return at.dir(e,"nextSibling",o)},prevUntil:function(e,t,o){return at.dir(e,"previousSibling",o)},siblings:function(e){return at.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return at.sibling(e.firstChild)},contents:function(e){return at.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:at.merge([],e.childNodes)}},function(e,t){at.fn[e]=function(o,n){var r=at.map(this,t,o);return"Until"!==e.slice(-5)&&(n=o),n&&"string"==typeof n&&(r=at.filter(n,r)),this.length>1&&(yt[e]||(r=at.unique(r)),bt.test(e)&&(r=r.reverse())),this.pushStack(r)}});var Ct=/\S+/g,xt={};at.Callbacks=function(e){e="string"==typeof e?xt[e]||a(e):at.extend({},e);var t,o,n,r,l,i,s=[],c=!e.once&&[],u=function(a){for(o=e.memory&&a,n=!0,l=i||0,i=0,r=s.length,t=!0;s&&r>l;l++)if(s[l].apply(a[0],a[1])===!1&&e.stopOnFalse){o=!1;break}t=!1,s&&(c?c.length&&u(c.shift()):o?s=[]:d.disable())},d={add:function(){if(s){var n=s.length;!function a(t){at.each(t,function(t,o){var n=at.type(o);"function"===n?e.unique&&d.has(o)||s.push(o):o&&o.length&&"string"!==n&&a(o)})}(arguments),t?r=s.length:o&&(i=n,u(o))}return this},remove:function(){return s&&at.each(arguments,function(e,o){for(var n;(n=at.inArray(o,s,n))>-1;)s.splice(n,1),t&&(r>=n&&r--,l>=n&&l--)}),this},has:function(e){return e?at.inArray(e,s)>-1:!(!s||!s.length)},empty:function(){return s=[],r=0,this},disable:function(){return s=c=o=void 0,this},disabled:function(){return!s},lock:function(){return c=void 0,o||d.disable(),this},locked:function(){return!c},fireWith:function(e,o){return!s||n&&!c||(o=o||[],o=[e,o.slice?o.slice():o],t?c.push(o):u(o)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},at.extend({Deferred:function(e){var t=[["resolve","done",at.Callbacks("once memory"),"resolved"],["reject","fail",at.Callbacks("once memory"),"rejected"],["notify","progress",at.Callbacks("memory")]],o="pending",n={state:function(){return o},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return at.Deferred(function(o){at.each(t,function(t,a){var l=at.isFunction(e[t])&&e[t];r[a[1]](function(){var e=l&&l.apply(this,arguments);e&&at.isFunction(e.promise)?e.promise().done(o.resolve).fail(o.reject).progress(o.notify):o[a[0]+"With"](this===n?o.promise():this,l?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?at.extend(e,n):n}},r={};return n.pipe=n.then,at.each(t,function(e,a){var l=a[2],i=a[3];n[a[1]]=l.add,i&&l.add(function(){o=i},t[1^e][2].disable,t[2][2].lock),r[a[0]]=function(){return r[a[0]+"With"](this===r?n:this,arguments),this},r[a[0]+"With"]=l.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,o,n,r=0,a=q.call(arguments),l=a.length,i=1!==l||e&&at.isFunction(e.promise)?l:0,s=1===i?e:at.Deferred(),c=function(e,o,n){return function(r){o[e]=this,n[e]=arguments.length>1?q.call(arguments):r,n===t?s.notifyWith(o,n):--i||s.resolveWith(o,n)}};if(l>1)for(t=new Array(l),o=new Array(l),n=new Array(l);l>r;r++)a[r]&&at.isFunction(a[r].promise)?a[r].promise().done(c(r,n,a)).fail(s.reject).progress(c(r,o,t)):--i;return i||s.resolveWith(n,a),s.promise()}});var wt;at.fn.ready=function(e){return at.ready.promise().done(e),this},at.extend({isReady:!1,readyWait:1,holdReady:function(e){e?at.readyWait++:at.ready(!0)},ready:function(e){if(e===!0?!--at.readyWait:!at.isReady){if(!mt.body)return setTimeout(at.ready);at.isReady=!0,e!==!0&&--at.readyWait>0||(wt.resolveWith(mt,[at]),at.fn.trigger&&at(mt).trigger("ready").off("ready"))}}}),at.ready.promise=function(t){if(!wt)if(wt=at.Deferred(),"complete"===mt.readyState)setTimeout(at.ready);else if(mt.addEventListener)mt.addEventListener("DOMContentLoaded",i,!1),e.addEventListener("load",i,!1);else{mt.attachEvent("onreadystatechange",i),e.attachEvent("onload",i);var o=!1;try{o=null==e.frameElement&&mt.documentElement}catch(n){}o&&o.doScroll&&!function r(){if(!at.isReady){try{o.doScroll("left")}catch(e){return setTimeout(r,50)}l(),at.ready()}}()}return wt.promise(t)};var St,Tt="undefined";for(St in at(nt))break;nt.ownLast="0"!==St,nt.inlineBlockNeedsLayout=!1,at(function(){var e,t,o=mt.getElementsByTagName("body")[0];o&&(e=mt.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=mt.createElement("div"),o.appendChild(e).appendChild(t),typeof t.style.zoom!==Tt&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(nt.inlineBlockNeedsLayout=3===t.offsetWidth)&&(o.style.zoom=1)),o.removeChild(e),e=t=null)}),function(){var e=mt.createElement("div");if(null==nt.deleteExpando){nt.deleteExpando=!0;try{delete e.test}catch(t){nt.deleteExpando=!1}}e=null}(),at.acceptData=function(e){var t=at.noData[(e.nodeName+" ").toLowerCase()],o=+e.nodeType||1;return 1!==o&&9!==o?!1:!t||t!==!0&&e.getAttribute("classid")===t};var Ft=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Et=/([A-Z])/g;at.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?at.cache[e[at.expando]]:e[at.expando],!!e&&!c(e)},data:function(e,t,o){return u(e,t,o)},removeData:function(e,t){return d(e,t)},_data:function(e,t,o){return u(e,t,o,!0)},_removeData:function(e,t){return d(e,t,!0)}}),at.fn.extend({data:function(e,t){var o,n,r,a=this[0],l=a&&a.attributes;if(void 0===e){if(this.length&&(r=at.data(a),1===a.nodeType&&!at._data(a,"parsedAttrs"))){for(o=l.length;o--;)n=l[o].name,0===n.indexOf("data-")&&(n=at.camelCase(n.slice(5)),s(a,n,r[n]));at._data(a,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){at.data(this,e)}):arguments.length>1?this.each(function(){at.data(this,e,t)}):a?s(a,e,at.data(a,e)):void 0},removeData:function(e){return this.each(function(){at.removeData(this,e)})}}),at.extend({queue:function(e,t,o){var n;return e?(t=(t||"fx")+"queue",n=at._data(e,t),o&&(!n||at.isArray(o)?n=at._data(e,t,at.makeArray(o)):n.push(o)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var o=at.queue(e,t),n=o.length,r=o.shift(),a=at._queueHooks(e,t),l=function(){at.dequeue(e,t)};"inprogress"===r&&(r=o.shift(),n--),r&&("fx"===t&&o.unshift("inprogress"),delete a.stop,r.call(e,l,a)),!n&&a&&a.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return at._data(e,o)||at._data(e,o,{empty:at.Callbacks("once memory").add(function(){at._removeData(e,t+"queue"),at._removeData(e,o)})})}}),at.fn.extend({queue:function(e,t){var o=2;return"string"!=typeof e&&(t=e,e="fx",o--),arguments.length<o?at.queue(this[0],e):void 0===t?this:this.each(function(){var o=at.queue(this,e,t);at._queueHooks(this,e),"fx"===e&&"inprogress"!==o[0]&&at.dequeue(this,e)})},dequeue:function(e){return this.each(function(){at.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var o,n=1,r=at.Deferred(),a=this,l=this.length,i=function(){--n||r.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";l--;)o=at._data(a[l],e+"queueHooks"),o&&o.empty&&(n++,o.empty.add(i));return i(),r.promise(t)}});var kt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_t=["Top","Right","Bottom","Left"],At=function(e,t){return e=t||e,"none"===at.css(e,"display")||!at.contains(e.ownerDocument,e)},Pt=at.access=function(e,t,o,n,r,a,l){var i=0,s=e.length,c=null==o;if("object"===at.type(o)){r=!0;for(i in o)at.access(e,t,i,o[i],!0,a,l)}else if(void 0!==n&&(r=!0,at.isFunction(n)||(l=!0),c&&(l?(t.call(e,n),t=null):(c=t,t=function(e,t,o){return c.call(at(e),o)})),t))for(;s>i;i++)t(e[i],o,l?n:n.call(e[i],i,t(e[i],o)));return r?e:c?t.call(e):s?t(e[0],o):a},Rt=/^(?:checkbox|radio)$/i;!function(){var e=mt.createDocumentFragment(),t=mt.createElement("div"),o=mt.createElement("input");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",nt.leadingWhitespace=3===t.firstChild.nodeType,nt.tbody=!t.getElementsByTagName("tbody").length,nt.htmlSerialize=!!t.getElementsByTagName("link").length,nt.html5Clone="<:nav></:nav>"!==mt.createElement("nav").cloneNode(!0).outerHTML,o.type="checkbox",o.checked=!0,e.appendChild(o),nt.appendChecked=o.checked,t.innerHTML="<textarea>x</textarea>",nt.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",nt.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,nt.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){nt.noCloneEvent=!1}),t.cloneNode(!0).click()),null==nt.deleteExpando){nt.deleteExpando=!0;try{delete t.test}catch(n){nt.deleteExpando=!1}}e=t=o=null}(),function(){var t,o,n=mt.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})o="on"+t,(nt[t+"Bubbles"]=o in e)||(n.setAttribute(o,"t"),nt[t+"Bubbles"]=n.attributes[o].expando===!1);n=null}();var Lt=/^(?:input|select|textarea)$/i,Mt=/^key/,Dt=/^(?:mouse|contextmenu)|click/,Nt=/^(?:focusinfocus|focusoutblur)$/,It=/^([^.]*)(?:\.(.+)|)$/;at.event={global:{},add:function(e,t,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g=at._data(e);if(g){for(o.handler&&(s=o,o=s.handler,r=s.selector),o.guid||(o.guid=at.guid++),(l=g.events)||(l=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof at===Tt||e&&at.event.triggered===e.type?void 0:at.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(Ct)||[""],i=t.length;i--;)a=It.exec(t[i])||[],f=m=a[1],h=(a[2]||"").split(".").sort(),f&&(c=at.event.special[f]||{},f=(r?c.delegateType:c.bindType)||f,c=at.event.special[f]||{},d=at.extend({type:f,origType:m,data:n,handler:o,guid:o.guid,selector:r,needsContext:r&&at.expr.match.needsContext.test(r),namespace:h.join(".")},s),(p=l[f])||(p=l[f]=[],p.delegateCount=0,c.setup&&c.setup.call(e,n,h,u)!==!1||(e.addEventListener?e.addEventListener(f,u,!1):e.attachEvent&&e.attachEvent("on"+f,u))),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=o.guid)),r?p.splice(p.delegateCount++,0,d):p.push(d),at.event.global[f]=!0);e=null}},remove:function(e,t,o,n,r){var a,l,i,s,c,u,d,p,f,h,m,g=at.hasData(e)&&at._data(e);if(g&&(u=g.events)){for(t=(t||"").match(Ct)||[""],c=t.length;c--;)if(i=It.exec(t[c])||[],f=m=i[1],h=(i[2]||"").split(".").sort(),f){for(d=at.event.special[f]||{},f=(n?d.delegateType:d.bindType)||f,p=u[f]||[],i=i[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=a=p.length;a--;)l=p[a],!r&&m!==l.origType||o&&o.guid!==l.guid||i&&!i.test(l.namespace)||n&&n!==l.selector&&("**"!==n||!l.selector)||(p.splice(a,1),l.selector&&p.delegateCount--,d.remove&&d.remove.call(e,l));s&&!p.length&&(d.teardown&&d.teardown.call(e,h,g.handle)!==!1||at.removeEvent(e,f,g.handle),delete u[f])}else for(f in u)at.event.remove(e,f+t[c],o,n,!0);at.isEmptyObject(u)&&(delete g.handle,at._removeData(e,"events"))}},trigger:function(t,o,n,r){var a,l,i,s,c,u,d,p=[n||mt],f=tt.call(t,"type")?t.type:t,h=tt.call(t,"namespace")?t.namespace.split("."):[];if(i=u=n=n||mt,3!==n.nodeType&&8!==n.nodeType&&!Nt.test(f+at.event.triggered)&&(f.indexOf(".")>=0&&(h=f.split("."),f=h.shift(),h.sort()),l=f.indexOf(":")<0&&"on"+f,t=t[at.expando]?t:new at.Event(f,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=h.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),o=null==o?[t]:at.makeArray(o,[t]),c=at.event.special[f]||{},r||!c.trigger||c.trigger.apply(n,o)!==!1)){if(!r&&!c.noBubble&&!at.isWindow(n)){for(s=c.delegateType||f,Nt.test(s+f)||(i=i.parentNode);i;i=i.parentNode)p.push(i),u=i;u===(n.ownerDocument||mt)&&p.push(u.defaultView||u.parentWindow||e)}for(d=0;(i=p[d++])&&!t.isPropagationStopped();)t.type=d>1?s:c.bindType||f,a=(at._data(i,"events")||{})[t.type]&&at._data(i,"handle"),a&&a.apply(i,o),a=l&&i[l],a&&a.apply&&at.acceptData(i)&&(t.result=a.apply(i,o),t.result===!1&&t.preventDefault());if(t.type=f,!r&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(p.pop(),o)===!1)&&at.acceptData(n)&&l&&n[f]&&!at.isWindow(n)){u=n[l],u&&(n[l]=null),at.event.triggered=f;try{n[f]()}catch(m){}at.event.triggered=void 0,u&&(n[l]=u)}return t.result}},dispatch:function(e){e=at.event.fix(e);var t,o,n,r,a,l=[],i=q.call(arguments),s=(at._data(this,"events")||{})[e.type]||[],c=at.event.special[e.type]||{};if(i[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(l=at.event.handlers.call(this,e,s),t=0;(r=l[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,a=0;(n=r.handlers[a++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(n.namespace))&&(e.handleObj=n,e.data=n.data,o=((at.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,i),void 0!==o&&(e.result=o)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var o,n,r,a,l=[],i=t.delegateCount,s=e.target;if(i&&s.nodeType&&(!e.button||"click"!==e.type))for(;s!=this;s=s.parentNode||this)if(1===s.nodeType&&(s.disabled!==!0||"click"!==e.type)){for(r=[],a=0;i>a;a++)n=t[a],o=n.selector+" ",void 0===r[o]&&(r[o]=n.needsContext?at(o,this).index(s)>=0:at.find(o,this,null,[s]).length),r[o]&&r.push(n);r.length&&l.push({elem:s,handlers:r})}return i<t.length&&l.push({elem:this,handlers:t.slice(i)}),l},fix:function(e){if(e[at.expando])return e;var t,o,n,r=e.type,a=e,l=this.fixHooks[r];for(l||(this.fixHooks[r]=l=Dt.test(r)?this.mouseHooks:Mt.test(r)?this.keyHooks:{}),n=l.props?this.props.concat(l.props):this.props,e=new at.Event(a),t=n.length;t--;)o=n[t],e[o]=a[o];return e.target||(e.target=a.srcElement||mt),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,l.filter?l.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var o,n,r,a=t.button,l=t.fromElement;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||mt,r=n.documentElement,o=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?t.toElement:l),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==h()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return at.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return at.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,o,n){var r=at.extend(new at.Event,o,{type:e,isSimulated:!0,originalEvent:{}});n?at.event.trigger(r,null,t):at.event.dispatch.call(t,r),r.isDefaultPrevented()&&o.preventDefault()}},at.removeEvent=mt.removeEventListener?function(e,t,o){e.removeEventListener&&e.removeEventListener(t,o,!1)}:function(e,t,o){var n="on"+t;e.detachEvent&&(typeof e[n]===Tt&&(e[n]=null),e.detachEvent(n,o))},at.Event=function(e,t){return this instanceof at.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault())?p:f):this.type=e,t&&at.extend(this,t),this.timeStamp=e&&e.timeStamp||at.now(),void(this[at.expando]=!0)):new at.Event(e,t)},at.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=p,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=p,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=p,this.stopPropagation()}},at.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){at.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,n=this,r=e.relatedTarget,a=e.handleObj;return(!r||r!==n&&!at.contains(n,r))&&(e.type=a.origType,o=a.handler.apply(this,arguments),e.type=t),o}}}),nt.submitBubbles||(at.event.special.submit={setup:function(){return at.nodeName(this,"form")?!1:void at.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,o=at.nodeName(t,"input")||at.nodeName(t,"button")?t.form:void 0;o&&!at._data(o,"submitBubbles")&&(at.event.add(o,"submit._submit",function(e){e._submit_bubble=!0}),at._data(o,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&at.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return at.nodeName(this,"form")?!1:void at.event.remove(this,"._submit")}}),nt.changeBubbles||(at.event.special.change={setup:function(){return Lt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(at.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),at.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),at.event.simulate("change",this,e,!0)})),!1):void at.event.add(this,"beforeactivate._change",function(e){var t=e.target;Lt.test(t.nodeName)&&!at._data(t,"changeBubbles")&&(at.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||at.event.simulate("change",this.parentNode,e,!0)}),at._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return at.event.remove(this,"._change"),!Lt.test(this.nodeName)}}),nt.focusinBubbles||at.each({focus:"focusin",blur:"focusout"},function(e,t){var o=function(e){at.event.simulate(t,e.target,at.event.fix(e),!0)};at.event.special[t]={setup:function(){var n=this.ownerDocument||this,r=at._data(n,t);r||n.addEventListener(e,o,!0),at._data(n,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=at._data(n,t)-1;r?at._data(n,t,r):(n.removeEventListener(e,o,!0),at._removeData(n,t))}}}),at.fn.extend({on:function(e,t,o,n,r){var a,l;if("object"==typeof e){"string"!=typeof t&&(o=o||t,t=void 0);for(a in e)this.on(a,t,o,e[a],r);return this}if(null==o&&null==n?(n=t,o=t=void 0):null==n&&("string"==typeof t?(n=o,o=void 0):(n=o,o=t,t=void 0)),n===!1)n=f;else if(!n)return this;return 1===r&&(l=n,n=function(e){return at().off(e),l.apply(this,arguments)},n.guid=l.guid||(l.guid=at.guid++)),this.each(function(){at.event.add(this,e,n,o,t)})},one:function(e,t,o,n){return this.on(e,t,o,n,1)},off:function(e,t,o){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,at(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return(t===!1||"function"==typeof t)&&(o=t,t=void 0),o===!1&&(o=f),this.each(function(){at.event.remove(this,e,o,t)})},trigger:function(e,t){return this.each(function(){at.event.trigger(e,t,this)})},triggerHandler:function(e,t){var o=this[0];return o?at.event.trigger(e,t,o,!0):void 0}});var Ot="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Bt=/ jQuery\d+="(?:null|\d+)"/g,Ut=new RegExp("<(?:"+Ot+")[\\s/>]","i"),zt=/^\s+/,Ht=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,jt=/<([\w:]+)/,Gt=/<tbody/i,Vt=/<|&#?\w+;/,Wt=/<(?:script|style|link)/i,$t=/checked\s*(?:[^=]|=\s*.checked.)/i,Xt=/^$|\/(?:java|ecma)script/i,Kt=/^true\/(.*)/,qt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Yt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:nt.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Jt=m(mt),Zt=Jt.appendChild(mt.createElement("div"));
Yt.optgroup=Yt.option,Yt.tbody=Yt.tfoot=Yt.colgroup=Yt.caption=Yt.thead,Yt.th=Yt.td,at.extend({clone:function(e,t,o){var n,r,a,l,i,s=at.contains(e.ownerDocument,e);if(nt.html5Clone||at.isXMLDoc(e)||!Ut.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(Zt.innerHTML=e.outerHTML,Zt.removeChild(a=Zt.firstChild)),!(nt.noCloneEvent&&nt.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||at.isXMLDoc(e)))for(n=g(a),i=g(e),l=0;null!=(r=i[l]);++l)n[l]&&S(r,n[l]);if(t)if(o)for(i=i||g(e),n=n||g(a),l=0;null!=(r=i[l]);l++)w(r,n[l]);else w(e,a);return n=g(a,"script"),n.length>0&&x(n,!s&&g(e,"script")),n=i=r=null,a},buildFragment:function(e,t,o,n){for(var r,a,l,i,s,c,u,d=e.length,p=m(t),f=[],h=0;d>h;h++)if(a=e[h],a||0===a)if("object"===at.type(a))at.merge(f,a.nodeType?[a]:a);else if(Vt.test(a)){for(i=i||p.appendChild(t.createElement("div")),s=(jt.exec(a)||["",""])[1].toLowerCase(),u=Yt[s]||Yt._default,i.innerHTML=u[1]+a.replace(Ht,"<$1></$2>")+u[2],r=u[0];r--;)i=i.lastChild;if(!nt.leadingWhitespace&&zt.test(a)&&f.push(t.createTextNode(zt.exec(a)[0])),!nt.tbody)for(a="table"!==s||Gt.test(a)?"<table>"!==u[1]||Gt.test(a)?0:i:i.firstChild,r=a&&a.childNodes.length;r--;)at.nodeName(c=a.childNodes[r],"tbody")&&!c.childNodes.length&&a.removeChild(c);for(at.merge(f,i.childNodes),i.textContent="";i.firstChild;)i.removeChild(i.firstChild);i=p.lastChild}else f.push(t.createTextNode(a));for(i&&p.removeChild(i),nt.appendChecked||at.grep(g(f,"input"),v),h=0;a=f[h++];)if((!n||-1===at.inArray(a,n))&&(l=at.contains(a.ownerDocument,a),i=g(p.appendChild(a),"script"),l&&x(i),o))for(r=0;a=i[r++];)Xt.test(a.type||"")&&o.push(a);return i=null,p},cleanData:function(e,t){for(var o,n,r,a,l=0,i=at.expando,s=at.cache,c=nt.deleteExpando,u=at.event.special;null!=(o=e[l]);l++)if((t||at.acceptData(o))&&(r=o[i],a=r&&s[r])){if(a.events)for(n in a.events)u[n]?at.event.remove(o,n):at.removeEvent(o,n,a.handle);s[r]&&(delete s[r],c?delete o[i]:typeof o.removeAttribute!==Tt?o.removeAttribute(i):o[i]=null,K.push(r))}}}),at.fn.extend({text:function(e){return Pt(this,function(e){return void 0===e?at.text(this):this.empty().append((this[0]&&this[0].ownerDocument||mt).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var o,n=e?at.filter(e,this):this,r=0;null!=(o=n[r]);r++)t||1!==o.nodeType||at.cleanData(g(o)),o.parentNode&&(t&&at.contains(o.ownerDocument,o)&&x(g(o,"script")),o.parentNode.removeChild(o));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&at.cleanData(g(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&at.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return at.clone(this,e,t)})},html:function(e){return Pt(this,function(e){var t=this[0]||{},o=0,n=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Bt,""):void 0;if(!("string"!=typeof e||Wt.test(e)||!nt.htmlSerialize&&Ut.test(e)||!nt.leadingWhitespace&&zt.test(e)||Yt[(jt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ht,"<$1></$2>");try{for(;n>o;o++)t=this[o]||{},1===t.nodeType&&(at.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(r){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,at.cleanData(g(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=Y.apply([],e);var o,n,r,a,l,i,s=0,c=this.length,u=this,d=c-1,p=e[0],f=at.isFunction(p);if(f||c>1&&"string"==typeof p&&!nt.checkClone&&$t.test(p))return this.each(function(o){var n=u.eq(o);f&&(e[0]=p.call(this,o,n.html())),n.domManip(e,t)});if(c&&(i=at.buildFragment(e,this[0].ownerDocument,!1,this),o=i.firstChild,1===i.childNodes.length&&(i=o),o)){for(a=at.map(g(i,"script"),y),r=a.length;c>s;s++)n=i,s!==d&&(n=at.clone(n,!0,!0),r&&at.merge(a,g(n,"script"))),t.call(this[s],n,s);if(r)for(l=a[a.length-1].ownerDocument,at.map(a,C),s=0;r>s;s++)n=a[s],Xt.test(n.type||"")&&!at._data(n,"globalEval")&&at.contains(l,n)&&(n.src?at._evalUrl&&at._evalUrl(n.src):at.globalEval((n.text||n.textContent||n.innerHTML||"").replace(qt,"")));i=o=null}return this}}),at.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){at.fn[e]=function(e){for(var o,n=0,r=[],a=at(e),l=a.length-1;l>=n;n++)o=n===l?this:this.clone(!0),at(a[n])[t](o),J.apply(r,o.get());return this.pushStack(r)}});var Qt,eo={};!function(){var e,t,o=mt.createElement("div"),n="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";o.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=o.getElementsByTagName("a")[0],e.style.cssText="float:left;opacity:.5",nt.opacity=/^0.5/.test(e.style.opacity),nt.cssFloat=!!e.style.cssFloat,o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",nt.clearCloneStyle="content-box"===o.style.backgroundClip,e=o=null,nt.shrinkWrapBlocks=function(){var e,o,r,a;if(null==t){if(e=mt.getElementsByTagName("body")[0],!e)return;a="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",o=mt.createElement("div"),r=mt.createElement("div"),e.appendChild(o).appendChild(r),t=!1,typeof r.style.zoom!==Tt&&(r.style.cssText=n+";width:1px;padding:1px;zoom:1",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t=3!==r.offsetWidth),e.removeChild(o),e=o=r=null}return t}}();var to,oo,no=/^margin/,ro=new RegExp("^("+kt+")(?!px)[a-z%]+$","i"),ao=/^(top|right|bottom|left)$/;e.getComputedStyle?(to=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},oo=function(e,t,o){var n,r,a,l,i=e.style;return o=o||to(e),l=o?o.getPropertyValue(t)||o[t]:void 0,o&&(""!==l||at.contains(e.ownerDocument,e)||(l=at.style(e,t)),ro.test(l)&&no.test(t)&&(n=i.width,r=i.minWidth,a=i.maxWidth,i.minWidth=i.maxWidth=i.width=l,l=o.width,i.width=n,i.minWidth=r,i.maxWidth=a)),void 0===l?l:l+""}):mt.documentElement.currentStyle&&(to=function(e){return e.currentStyle},oo=function(e,t,o){var n,r,a,l,i=e.style;return o=o||to(e),l=o?o[t]:void 0,null==l&&i&&i[t]&&(l=i[t]),ro.test(l)&&!ao.test(t)&&(n=i.left,r=e.runtimeStyle,a=r&&r.left,a&&(r.left=e.currentStyle.left),i.left="fontSize"===t?"1em":l,l=i.pixelLeft+"px",i.left=n,a&&(r.left=a)),void 0===l?l:l+""||"auto"}),!function(){function t(){var t,o,n=mt.getElementsByTagName("body")[0];n&&(t=mt.createElement("div"),o=mt.createElement("div"),t.style.cssText=c,n.appendChild(t).appendChild(o),o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",at.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){r=4===o.offsetWidth}),a=!0,l=!1,i=!0,e.getComputedStyle&&(l="1%"!==(e.getComputedStyle(o,null)||{}).top,a="4px"===(e.getComputedStyle(o,null)||{width:"4px"}).width),n.removeChild(t),o=n=null)}var o,n,r,a,l,i,s=mt.createElement("div"),c="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",u="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";s.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",o=s.getElementsByTagName("a")[0],o.style.cssText="float:left;opacity:.5",nt.opacity=/^0.5/.test(o.style.opacity),nt.cssFloat=!!o.style.cssFloat,s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",nt.clearCloneStyle="content-box"===s.style.backgroundClip,o=s=null,at.extend(nt,{reliableHiddenOffsets:function(){if(null!=n)return n;var e,t,o,r=mt.createElement("div"),a=mt.getElementsByTagName("body")[0];return a?(r.setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=mt.createElement("div"),e.style.cssText=c,a.appendChild(e).appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t=r.getElementsByTagName("td"),t[0].style.cssText="padding:0;margin:0;border:0;display:none",o=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",n=o&&0===t[0].offsetHeight,a.removeChild(e),r=a=null,n):void 0},boxSizing:function(){return null==r&&t(),r},boxSizingReliable:function(){return null==a&&t(),a},pixelPosition:function(){return null==l&&t(),l},reliableMarginRight:function(){var t,o,n,r;if(null==i&&e.getComputedStyle){if(t=mt.getElementsByTagName("body")[0],!t)return;o=mt.createElement("div"),n=mt.createElement("div"),o.style.cssText=c,t.appendChild(o).appendChild(n),r=n.appendChild(mt.createElement("div")),r.style.cssText=n.style.cssText=u,r.style.marginRight=r.style.width="0",n.style.width="1px",i=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight),t.removeChild(o)}return i}})}(),at.swap=function(e,t,o,n){var r,a,l={};for(a in t)l[a]=e.style[a],e.style[a]=t[a];r=o.apply(e,n||[]);for(a in t)e.style[a]=l[a];return r};var lo=/alpha\([^)]*\)/i,io=/opacity\s*=\s*([^)]*)/,so=/^(none|table(?!-c[ea]).+)/,co=new RegExp("^("+kt+")(.*)$","i"),uo=new RegExp("^([+-])=("+kt+")","i"),po={position:"absolute",visibility:"hidden",display:"block"},fo={letterSpacing:0,fontWeight:400},ho=["Webkit","O","Moz","ms"];at.extend({cssHooks:{opacity:{get:function(e,t){if(t){var o=oo(e,"opacity");return""===o?"1":o}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":nt.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,o,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,a,l,i=at.camelCase(t),s=e.style;if(t=at.cssProps[i]||(at.cssProps[i]=k(s,i)),l=at.cssHooks[t]||at.cssHooks[i],void 0===o)return l&&"get"in l&&void 0!==(r=l.get(e,!1,n))?r:s[t];if(a=typeof o,"string"===a&&(r=uo.exec(o))&&(o=(r[1]+1)*r[2]+parseFloat(at.css(e,t)),a="number"),null!=o&&o===o&&("number"!==a||at.cssNumber[i]||(o+="px"),nt.clearCloneStyle||""!==o||0!==t.indexOf("background")||(s[t]="inherit"),!(l&&"set"in l&&void 0===(o=l.set(e,o,n)))))try{s[t]="",s[t]=o}catch(c){}}},css:function(e,t,o,n){var r,a,l,i=at.camelCase(t);return t=at.cssProps[i]||(at.cssProps[i]=k(e.style,i)),l=at.cssHooks[t]||at.cssHooks[i],l&&"get"in l&&(a=l.get(e,!0,o)),void 0===a&&(a=oo(e,t,n)),"normal"===a&&t in fo&&(a=fo[t]),""===o||o?(r=parseFloat(a),o===!0||at.isNumeric(r)?r||0:a):a}}),at.each(["height","width"],function(e,t){at.cssHooks[t]={get:function(e,o,n){return o?0===e.offsetWidth&&so.test(at.css(e,"display"))?at.swap(e,po,function(){return R(e,t,n)}):R(e,t,n):void 0},set:function(e,o,n){var r=n&&to(e);return A(e,o,n?P(e,t,n,nt.boxSizing()&&"border-box"===at.css(e,"boxSizing",!1,r),r):0)}}}),nt.opacity||(at.cssHooks.opacity={get:function(e,t){return io.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var o=e.style,n=e.currentStyle,r=at.isNumeric(t)?"alpha(opacity="+100*t+")":"",a=n&&n.filter||o.filter||"";o.zoom=1,(t>=1||""===t)&&""===at.trim(a.replace(lo,""))&&o.removeAttribute&&(o.removeAttribute("filter"),""===t||n&&!n.filter)||(o.filter=lo.test(a)?a.replace(lo,r):a+" "+r)}}),at.cssHooks.marginRight=E(nt.reliableMarginRight,function(e,t){return t?at.swap(e,{display:"inline-block"},oo,[e,"marginRight"]):void 0}),at.each({margin:"",padding:"",border:"Width"},function(e,t){at.cssHooks[e+t]={expand:function(o){for(var n=0,r={},a="string"==typeof o?o.split(" "):[o];4>n;n++)r[e+_t[n]+t]=a[n]||a[n-2]||a[0];return r}},no.test(e)||(at.cssHooks[e+t].set=A)}),at.fn.extend({css:function(e,t){return Pt(this,function(e,t,o){var n,r,a={},l=0;if(at.isArray(t)){for(n=to(e),r=t.length;r>l;l++)a[t[l]]=at.css(e,t[l],!1,n);return a}return void 0!==o?at.style(e,t,o):at.css(e,t)},e,t,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){At(this)?at(this).show():at(this).hide()})}}),at.Tween=L,L.prototype={constructor:L,init:function(e,t,o,n,r,a){this.elem=e,this.prop=o,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=a||(at.cssNumber[o]?"":"px")},cur:function(){var e=L.propHooks[this.prop];return e&&e.get?e.get(this):L.propHooks._default.get(this)},run:function(e){var t,o=L.propHooks[this.prop];return this.pos=t=this.options.duration?at.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=at.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){at.fx.step[e.prop]?at.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[at.cssProps[e.prop]]||at.cssHooks[e.prop])?at.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},at.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},at.fx=L.prototype.init,at.fx.step={};var mo,go,vo=/^(?:toggle|show|hide)$/,bo=new RegExp("^(?:([+-])=|)("+kt+")([a-z%]*)$","i"),yo=/queueHooks$/,Co=[I],xo={"*":[function(e,t){var o=this.createTween(e,t),n=o.cur(),r=bo.exec(t),a=r&&r[3]||(at.cssNumber[e]?"":"px"),l=(at.cssNumber[e]||"px"!==a&&+n)&&bo.exec(at.css(o.elem,e)),i=1,s=20;if(l&&l[3]!==a){a=a||l[3],r=r||[],l=+n||1;do i=i||".5",l/=i,at.style(o.elem,e,l+a);while(i!==(i=o.cur()/n)&&1!==i&&--s)}return r&&(l=o.start=+l||+n||0,o.unit=a,o.end=r[1]?l+(r[1]+1)*r[2]:+r[2]),o}]};at.Animation=at.extend(B,{tweener:function(e,t){at.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var o,n=0,r=e.length;r>n;n++)o=e[n],xo[o]=xo[o]||[],xo[o].unshift(t)},prefilter:function(e,t){t?Co.unshift(e):Co.push(e)}}),at.speed=function(e,t,o){var n=e&&"object"==typeof e?at.extend({},e):{complete:o||!o&&t||at.isFunction(e)&&e,duration:e,easing:o&&t||t&&!at.isFunction(t)&&t};return n.duration=at.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in at.fx.speeds?at.fx.speeds[n.duration]:at.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){at.isFunction(n.old)&&n.old.call(this),n.queue&&at.dequeue(this,n.queue)},n},at.fn.extend({fadeTo:function(e,t,o,n){return this.filter(At).css("opacity",0).show().end().animate({opacity:t},e,o,n)},animate:function(e,t,o,n){var r=at.isEmptyObject(e),a=at.speed(t,o,n),l=function(){var t=B(this,at.extend({},e),a);(r||at._data(this,"finish"))&&t.stop(!0)};return l.finish=l,r||a.queue===!1?this.each(l):this.queue(a.queue,l)},stop:function(e,t,o){var n=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof e&&(o=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",a=at.timers,l=at._data(this);if(r)l[r]&&l[r].stop&&n(l[r]);else for(r in l)l[r]&&l[r].stop&&yo.test(r)&&n(l[r]);for(r=a.length;r--;)a[r].elem!==this||null!=e&&a[r].queue!==e||(a[r].anim.stop(o),t=!1,a.splice(r,1));(t||!o)&&at.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,o=at._data(this),n=o[e+"queue"],r=o[e+"queueHooks"],a=at.timers,l=n?n.length:0;for(o.finish=!0,at.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;l>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete o.finish})}}),at.each(["toggle","show","hide"],function(e,t){var o=at.fn[t];at.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(D(t,!0),e,n,r)}}),at.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){at.fn[e]=function(e,o,n){return this.animate(t,e,o,n)}}),at.timers=[],at.fx.tick=function(){var e,t=at.timers,o=0;for(mo=at.now();o<t.length;o++)e=t[o],e()||t[o]!==e||t.splice(o--,1);t.length||at.fx.stop(),mo=void 0},at.fx.timer=function(e){at.timers.push(e),e()?at.fx.start():at.timers.pop()},at.fx.interval=13,at.fx.start=function(){go||(go=setInterval(at.fx.tick,at.fx.interval))},at.fx.stop=function(){clearInterval(go),go=null},at.fx.speeds={slow:600,fast:200,_default:400},at.fn.delay=function(e,t){return e=at.fx?at.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,o){var n=setTimeout(t,e);o.stop=function(){clearTimeout(n)}})},function(){var e,t,o,n,r=mt.createElement("div");r.setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=r.getElementsByTagName("a")[0],o=mt.createElement("select"),n=o.appendChild(mt.createElement("option")),t=r.getElementsByTagName("input")[0],e.style.cssText="top:1px",nt.getSetAttribute="t"!==r.className,nt.style=/top/.test(e.getAttribute("style")),nt.hrefNormalized="/a"===e.getAttribute("href"),nt.checkOn=!!t.value,nt.optSelected=n.selected,nt.enctype=!!mt.createElement("form").enctype,o.disabled=!0,nt.optDisabled=!n.disabled,t=mt.createElement("input"),t.setAttribute("value",""),nt.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),nt.radioValue="t"===t.value,e=t=o=n=r=null}();var wo=/\r/g;at.fn.extend({val:function(e){var t,o,n,r=this[0];return arguments.length?(n=at.isFunction(e),this.each(function(o){var r;1===this.nodeType&&(r=n?e.call(this,o,at(this).val()):e,null==r?r="":"number"==typeof r?r+="":at.isArray(r)&&(r=at.map(r,function(e){return null==e?"":e+""})),t=at.valHooks[this.type]||at.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))})):r?(t=at.valHooks[r.type]||at.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(o=t.get(r,"value"))?o:(o=r.value,"string"==typeof o?o.replace(wo,""):null==o?"":o)):void 0}}),at.extend({valHooks:{option:{get:function(e){var t=at.find.attr(e,"value");return null!=t?t:at.text(e)}},select:{get:function(e){for(var t,o,n=e.options,r=e.selectedIndex,a="select-one"===e.type||0>r,l=a?null:[],i=a?r+1:n.length,s=0>r?i:a?r:0;i>s;s++)if(o=n[s],!(!o.selected&&s!==r||(nt.optDisabled?o.disabled:null!==o.getAttribute("disabled"))||o.parentNode.disabled&&at.nodeName(o.parentNode,"optgroup"))){if(t=at(o).val(),a)return t;l.push(t)}return l},set:function(e,t){for(var o,n,r=e.options,a=at.makeArray(t),l=r.length;l--;)if(n=r[l],at.inArray(at.valHooks.option.get(n),a)>=0)try{n.selected=o=!0}catch(i){n.scrollHeight}else n.selected=!1;return o||(e.selectedIndex=-1),r}}}}),at.each(["radio","checkbox"],function(){at.valHooks[this]={set:function(e,t){return at.isArray(t)?e.checked=at.inArray(at(e).val(),t)>=0:void 0}},nt.checkOn||(at.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var So,To,Fo=at.expr.attrHandle,Eo=/^(?:checked|selected)$/i,ko=nt.getSetAttribute,_o=nt.input;at.fn.extend({attr:function(e,t){return Pt(this,at.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){at.removeAttr(this,e)})}}),at.extend({attr:function(e,t,o){var n,r,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?typeof e.getAttribute===Tt?at.prop(e,t,o):(1===a&&at.isXMLDoc(e)||(t=t.toLowerCase(),n=at.attrHooks[t]||(at.expr.match.bool.test(t)?To:So)),void 0===o?n&&"get"in n&&null!==(r=n.get(e,t))?r:(r=at.find.attr(e,t),null==r?void 0:r):null!==o?n&&"set"in n&&void 0!==(r=n.set(e,o,t))?r:(e.setAttribute(t,o+""),o):void at.removeAttr(e,t)):void 0},removeAttr:function(e,t){var o,n,r=0,a=t&&t.match(Ct);if(a&&1===e.nodeType)for(;o=a[r++];)n=at.propFix[o]||o,at.expr.match.bool.test(o)?_o&&ko||!Eo.test(o)?e[n]=!1:e[at.camelCase("default-"+o)]=e[n]=!1:at.attr(e,o,""),e.removeAttribute(ko?o:n)},attrHooks:{type:{set:function(e,t){if(!nt.radioValue&&"radio"===t&&at.nodeName(e,"input")){var o=e.value;return e.setAttribute("type",t),o&&(e.value=o),t}}}}}),To={set:function(e,t,o){return t===!1?at.removeAttr(e,o):_o&&ko||!Eo.test(o)?e.setAttribute(!ko&&at.propFix[o]||o,o):e[at.camelCase("default-"+o)]=e[o]=!0,o}},at.each(at.expr.match.bool.source.match(/\w+/g),function(e,t){var o=Fo[t]||at.find.attr;Fo[t]=_o&&ko||!Eo.test(t)?function(e,t,n){var r,a;return n||(a=Fo[t],Fo[t]=r,r=null!=o(e,t,n)?t.toLowerCase():null,Fo[t]=a),r}:function(e,t,o){return o?void 0:e[at.camelCase("default-"+t)]?t.toLowerCase():null}}),_o&&ko||(at.attrHooks.value={set:function(e,t,o){return at.nodeName(e,"input")?void(e.defaultValue=t):So&&So.set(e,t,o)}}),ko||(So={set:function(e,t,o){var n=e.getAttributeNode(o);return n||e.setAttributeNode(n=e.ownerDocument.createAttribute(o)),n.value=t+="","value"===o||t===e.getAttribute(o)?t:void 0}},Fo.id=Fo.name=Fo.coords=function(e,t,o){var n;return o?void 0:(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},at.valHooks.button={get:function(e,t){var o=e.getAttributeNode(t);return o&&o.specified?o.value:void 0},set:So.set},at.attrHooks.contenteditable={set:function(e,t,o){So.set(e,""===t?!1:t,o)}},at.each(["width","height"],function(e,t){at.attrHooks[t]={set:function(e,o){return""===o?(e.setAttribute(t,"auto"),o):void 0}}})),nt.style||(at.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Ao=/^(?:input|select|textarea|button|object)$/i,Po=/^(?:a|area)$/i;at.fn.extend({prop:function(e,t){return Pt(this,at.prop,e,t,arguments.length>1)},removeProp:function(e){return e=at.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),at.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,o){var n,r,a,l=e.nodeType;return e&&3!==l&&8!==l&&2!==l?(a=1!==l||!at.isXMLDoc(e),a&&(t=at.propFix[t]||t,r=at.propHooks[t]),void 0!==o?r&&"set"in r&&void 0!==(n=r.set(e,o,t))?n:e[t]=o:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]):void 0},propHooks:{tabIndex:{get:function(e){var t=at.find.attr(e,"tabindex");return t?parseInt(t,10):Ao.test(e.nodeName)||Po.test(e.nodeName)&&e.href?0:-1}}}}),nt.hrefNormalized||at.each(["href","src"],function(e,t){at.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),nt.optSelected||(at.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),at.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){at.propFix[this.toLowerCase()]=this}),nt.enctype||(at.propFix.enctype="encoding");var Ro=/[\t\r\n\f]/g;at.fn.extend({addClass:function(e){var t,o,n,r,a,l,i=0,s=this.length,c="string"==typeof e&&e;if(at.isFunction(e))return this.each(function(t){at(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(Ct)||[];s>i;i++)if(o=this[i],n=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(Ro," "):" ")){for(a=0;r=t[a++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");l=at.trim(n),o.className!==l&&(o.className=l)}return this},removeClass:function(e){var t,o,n,r,a,l,i=0,s=this.length,c=0===arguments.length||"string"==typeof e&&e;if(at.isFunction(e))return this.each(function(t){at(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(Ct)||[];s>i;i++)if(o=this[i],n=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(Ro," "):"")){for(a=0;r=t[a++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");l=e?at.trim(n):"",o.className!==l&&(o.className=l)}return this},toggleClass:function(e,t){var o=typeof e;return"boolean"==typeof t&&"string"===o?t?this.addClass(e):this.removeClass(e):this.each(at.isFunction(e)?function(o){at(this).toggleClass(e.call(this,o,this.className,t),t)}:function(){if("string"===o)for(var t,n=0,r=at(this),a=e.match(Ct)||[];t=a[n++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(o===Tt||"boolean"===o)&&(this.className&&at._data(this,"__className__",this.className),this.className=this.className||e===!1?"":at._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",o=0,n=this.length;n>o;o++)if(1===this[o].nodeType&&(" "+this[o].className+" ").replace(Ro," ").indexOf(t)>=0)return!0;return!1}}),at.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){at.fn[t]=function(e,o){return arguments.length>0?this.on(t,null,e,o):this.trigger(t)}}),at.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,o){return this.on(e,null,t,o)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,o,n){return this.on(t,e,o,n)},undelegate:function(e,t,o){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",o)}});var Lo=at.now(),Mo=/\?/,Do=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;at.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var o,n=null,r=at.trim(t+"");return r&&!at.trim(r.replace(Do,function(e,t,r,a){return o&&t&&(n=0),0===n?e:(o=r||t,n+=!a-!r,"")}))?Function("return "+r)():at.error("Invalid JSON: "+t)},at.parseXML=function(t){var o,n;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(n=new DOMParser,o=n.parseFromString(t,"text/xml")):(o=new ActiveXObject("Microsoft.XMLDOM"),o.async="false",o.loadXML(t))}catch(r){o=void 0}return o&&o.documentElement&&!o.getElementsByTagName("parsererror").length||at.error("Invalid XML: "+t),o};var No,Io,Oo=/#.*$/,Bo=/([?&])_=[^&]*/,Uo=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,zo=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ho=/^(?:GET|HEAD)$/,jo=/^\/\//,Go=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Vo={},Wo={},$o="*/".concat("*");try{Io=location.href}catch(Xo){Io=mt.createElement("a"),Io.href="",Io=Io.href}No=Go.exec(Io.toLowerCase())||[],at.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Io,type:"GET",isLocal:zo.test(No[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$o,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":at.parseJSON,"text xml":at.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?H(H(e,at.ajaxSettings),t):H(at.ajaxSettings,e)},ajaxPrefilter:U(Vo),ajaxTransport:U(Wo),ajax:function(e,t){function o(e,t,o,n){var r,u,v,b,C,w=t;2!==y&&(y=2,i&&clearTimeout(i),c=void 0,l=n||"",x.readyState=e>0?4:0,r=e>=200&&300>e||304===e,o&&(b=j(d,x,o)),b=G(d,b,x,r),r?(d.ifModified&&(C=x.getResponseHeader("Last-Modified"),C&&(at.lastModified[a]=C),C=x.getResponseHeader("etag"),C&&(at.etag[a]=C)),204===e||"HEAD"===d.type?w="nocontent":304===e?w="notmodified":(w=b.state,u=b.data,v=b.error,r=!v)):(v=w,(e||!w)&&(w="error",0>e&&(e=0))),x.status=e,x.statusText=(t||w)+"",r?h.resolveWith(p,[u,w,x]):h.rejectWith(p,[x,w,v]),x.statusCode(g),g=void 0,s&&f.trigger(r?"ajaxSuccess":"ajaxError",[x,d,r?u:v]),m.fireWith(p,[x,w]),s&&(f.trigger("ajaxComplete",[x,d]),--at.active||at.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,a,l,i,s,c,u,d=at.ajaxSetup({},t),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?at(p):at.event,h=at.Deferred(),m=at.Callbacks("once memory"),g=d.statusCode||{},v={},b={},y=0,C="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!u)for(u={};t=Uo.exec(l);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?l:null},setRequestHeader:function(e,t){var o=e.toLowerCase();return y||(e=b[o]=b[o]||e,v[e]=t),this},overrideMimeType:function(e){return y||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)g[t]=[g[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||C;return c&&c.abort(t),o(0,t),this}};if(h.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,d.url=((e||d.url||Io)+"").replace(Oo,"").replace(jo,No[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=at.trim(d.dataType||"*").toLowerCase().match(Ct)||[""],null==d.crossDomain&&(n=Go.exec(d.url.toLowerCase()),d.crossDomain=!(!n||n[1]===No[1]&&n[2]===No[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(No[3]||("http:"===No[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=at.param(d.data,d.traditional)),z(Vo,d,t,x),2===y)return x;s=d.global,s&&0===at.active++&&at.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ho.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(Mo.test(a)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Bo.test(a)?a.replace(Bo,"$1_="+Lo++):a+(Mo.test(a)?"&":"?")+"_="+Lo++)),d.ifModified&&(at.lastModified[a]&&x.setRequestHeader("If-Modified-Since",at.lastModified[a]),at.etag[a]&&x.setRequestHeader("If-None-Match",at.etag[a])),(d.data&&d.hasContent&&d.contentType!==!1||t.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+$o+"; q=0.01":""):d.accepts["*"]);for(r in d.headers)x.setRequestHeader(r,d.headers[r]);if(d.beforeSend&&(d.beforeSend.call(p,x,d)===!1||2===y))return x.abort();C="abort";for(r in{success:1,error:1,complete:1})x[r](d[r]);if(c=z(Wo,d,t,x)){x.readyState=1,s&&f.trigger("ajaxSend",[x,d]),d.async&&d.timeout>0&&(i=setTimeout(function(){x.abort("timeout")},d.timeout));try{y=1,c.send(v,o)}catch(w){if(!(2>y))throw w;o(-1,w)}}else o(-1,"No Transport");return x},getJSON:function(e,t,o){return at.get(e,t,o,"json")},getScript:function(e,t){return at.get(e,void 0,t,"script")}}),at.each(["get","post"],function(e,t){at[t]=function(e,o,n,r){return at.isFunction(o)&&(r=r||n,n=o,o=void 0),at.ajax({url:e,type:t,dataType:r,data:o,success:n})}}),at.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){at.fn[t]=function(e){return this.on(t,e)}}),at._evalUrl=function(e){return at.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},at.fn.extend({wrapAll:function(e){if(at.isFunction(e))return this.each(function(t){at(this).wrapAll(e.call(this,t))});if(this[0]){var t=at(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(at.isFunction(e)?function(t){at(this).wrapInner(e.call(this,t))}:function(){var t=at(this),o=t.contents();o.length?o.wrapAll(e):t.append(e)})},wrap:function(e){var t=at.isFunction(e);return this.each(function(o){at(this).wrapAll(t?e.call(this,o):e)})},unwrap:function(){return this.parent().each(function(){at.nodeName(this,"body")||at(this).replaceWith(this.childNodes)}).end()}}),at.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!nt.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||at.css(e,"display"))},at.expr.filters.visible=function(e){return!at.expr.filters.hidden(e)};var Ko=/%20/g,qo=/\[\]$/,Yo=/\r?\n/g,Jo=/^(?:submit|button|image|reset|file)$/i,Zo=/^(?:input|select|textarea|keygen)/i;
at.param=function(e,t){var o,n=[],r=function(e,t){t=at.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=at.ajaxSettings&&at.ajaxSettings.traditional),at.isArray(e)||e.jquery&&!at.isPlainObject(e))at.each(e,function(){r(this.name,this.value)});else for(o in e)V(o,e[o],t,r);return n.join("&").replace(Ko,"+")},at.fn.extend({serialize:function(){return at.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=at.prop(this,"elements");return e?at.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!at(this).is(":disabled")&&Zo.test(this.nodeName)&&!Jo.test(e)&&(this.checked||!Rt.test(e))}).map(function(e,t){var o=at(this).val();return null==o?null:at.isArray(o)?at.map(o,function(e){return{name:t.name,value:e.replace(Yo,"\r\n")}}):{name:t.name,value:o.replace(Yo,"\r\n")}}).get()}}),at.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&W()||$()}:W;var Qo=0,en={},tn=at.ajaxSettings.xhr();e.ActiveXObject&&at(e).on("unload",function(){for(var e in en)en[e](void 0,!0)}),nt.cors=!!tn&&"withCredentials"in tn,tn=nt.ajax=!!tn,tn&&at.ajaxTransport(function(e){if(!e.crossDomain||nt.cors){var t;return{send:function(o,n){var r,a=e.xhr(),l=++Qo;if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)a[r]=e.xhrFields[r];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(r in o)void 0!==o[r]&&a.setRequestHeader(r,o[r]+"");a.send(e.hasContent&&e.data||null),t=function(o,r){var i,s,c;if(t&&(r||4===a.readyState))if(delete en[l],t=void 0,a.onreadystatechange=at.noop,r)4!==a.readyState&&a.abort();else{c={},i=a.status,"string"==typeof a.responseText&&(c.text=a.responseText);try{s=a.statusText}catch(u){s=""}i||!e.isLocal||e.crossDomain?1223===i&&(i=204):i=c.text?200:404}c&&n(i,s,c,a.getAllResponseHeaders())},e.async?4===a.readyState?setTimeout(t):a.onreadystatechange=en[l]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),at.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return at.globalEval(e),e}}}),at.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),at.ajaxTransport("script",function(e){if(e.crossDomain){var t,o=mt.head||at("head")[0]||mt.documentElement;return{send:function(n,r){t=mt.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,o){(o||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,o||r(200,"success"))},o.insertBefore(t,o.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var on=[],nn=/(=)\?(?=&|$)|\?\?/;at.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=on.pop()||at.expando+"_"+Lo++;return this[e]=!0,e}}),at.ajaxPrefilter("json jsonp",function(t,o,n){var r,a,l,i=t.jsonp!==!1&&(nn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(t.data)&&"data");return i||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=at.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,i?t[i]=t[i].replace(nn,"$1"+r):t.jsonp!==!1&&(t.url+=(Mo.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return l||at.error(r+" was not called"),l[0]},t.dataTypes[0]="json",a=e[r],e[r]=function(){l=arguments},n.always(function(){e[r]=a,t[r]&&(t.jsonpCallback=o.jsonpCallback,on.push(r)),l&&at.isFunction(a)&&a(l[0]),l=a=void 0}),"script"):void 0}),at.parseHTML=function(e,t,o){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(o=t,t=!1),t=t||mt;var n=pt.exec(e),r=!o&&[];return n?[t.createElement(n[1])]:(n=at.buildFragment([e],t,r),r&&r.length&&at(r).remove(),at.merge([],n.childNodes))};var rn=at.fn.load;at.fn.load=function(e,t,o){if("string"!=typeof e&&rn)return rn.apply(this,arguments);var n,r,a,l=this,i=e.indexOf(" ");return i>=0&&(n=e.slice(i,e.length),e=e.slice(0,i)),at.isFunction(t)?(o=t,t=void 0):t&&"object"==typeof t&&(a="POST"),l.length>0&&at.ajax({url:e,type:a,dataType:"html",data:t}).done(function(e){r=arguments,l.html(n?at("<div>").append(at.parseHTML(e)).find(n):e)}).complete(o&&function(e,t){l.each(o,r||[e.responseText,t,e])}),this},at.expr.filters.animated=function(e){return at.grep(at.timers,function(t){return e===t.elem}).length};var an=e.document.documentElement;at.offset={setOffset:function(e,t,o){var n,r,a,l,i,s,c,u=at.css(e,"position"),d=at(e),p={};"static"===u&&(e.style.position="relative"),i=d.offset(),a=at.css(e,"top"),s=at.css(e,"left"),c=("absolute"===u||"fixed"===u)&&at.inArray("auto",[a,s])>-1,c?(n=d.position(),l=n.top,r=n.left):(l=parseFloat(a)||0,r=parseFloat(s)||0),at.isFunction(t)&&(t=t.call(e,o,i)),null!=t.top&&(p.top=t.top-i.top+l),null!=t.left&&(p.left=t.left-i.left+r),"using"in t?t.using.call(e,p):d.css(p)}},at.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){at.offset.setOffset(this,e,t)});var t,o,n={top:0,left:0},r=this[0],a=r&&r.ownerDocument;return a?(t=a.documentElement,at.contains(t,r)?(typeof r.getBoundingClientRect!==Tt&&(n=r.getBoundingClientRect()),o=X(a),{top:n.top+(o.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(o.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var e,t,o={top:0,left:0},n=this[0];return"fixed"===at.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),at.nodeName(e[0],"html")||(o=e.offset()),o.top+=at.css(e[0],"borderTopWidth",!0),o.left+=at.css(e[0],"borderLeftWidth",!0)),{top:t.top-o.top-at.css(n,"marginTop",!0),left:t.left-o.left-at.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||an;e&&!at.nodeName(e,"html")&&"static"===at.css(e,"position");)e=e.offsetParent;return e||an})}}),at.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var o=/Y/.test(t);at.fn[e]=function(n){return Pt(this,function(e,n,r){var a=X(e);return void 0===r?a?t in a?a[t]:a.document.documentElement[n]:e[n]:void(a?a.scrollTo(o?at(a).scrollLeft():r,o?r:at(a).scrollTop()):e[n]=r)},e,n,arguments.length,null)}}),at.each(["top","left"],function(e,t){at.cssHooks[t]=E(nt.pixelPosition,function(e,o){return o?(o=oo(e,t),ro.test(o)?at(e).position()[t]+"px":o):void 0})}),at.each({Height:"height",Width:"width"},function(e,t){at.each({padding:"inner"+e,content:t,"":"outer"+e},function(o,n){at.fn[n]=function(n,r){var a=arguments.length&&(o||"boolean"!=typeof n),l=o||(n===!0||r===!0?"margin":"border");return Pt(this,function(t,o,n){var r;return at.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===n?at.css(t,o,l):at.style(t,o,n,l)},t,a?n:void 0,a,null)}})}),at.fn.size=function(){return this.length},at.fn.andSelf=at.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return at});var ln=e.jQuery,sn=e.$;return at.noConflict=function(t){return e.$===at&&(e.$=sn),t&&e.jQuery===at&&(e.jQuery=ln),at},typeof t===Tt&&(e.jQuery=e.$=at),at}),function(){var e;e=function(e){var t,o;return t=!1,e(function(){var n;return n=(document.body||document.documentElement).style,t=void 0!==n.animation||void 0!==n.WebkitAnimation||void 0!==n.MozAnimation||void 0!==n.MsAnimation||void 0!==n.OAnimation,e(window).bind("keyup.vex",function(e){return 27===e.keyCode?o.closeByEscape():void 0})}),o={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(t){return t=e.extend({},o.defaultOptions,t),t.id=o.globalID,o.globalID+=1,t.$vex=e("<div>").addClass(o.baseClassNames.vex).addClass(t.className).css(t.css).data({vex:t}),t.$vexOverlay=e("<div>").addClass(o.baseClassNames.overlay).addClass(t.overlayClassName).css(t.overlayCSS).data({vex:t}),t.overlayClosesOnClick&&t.$vexOverlay.bind("click.vex",function(t){return t.target===this?o.close(e(this).data().vex.id):void 0}),t.$vex.append(t.$vexOverlay),t.$vexContent=e("<div>").addClass(o.baseClassNames.content).addClass(t.contentClassName).css(t.contentCSS).append(t.content).data({vex:t}),t.$vex.append(t.$vexContent),t.showCloseButton&&(t.$closeButton=e("<div>").addClass(o.baseClassNames.close).addClass(t.closeClassName).css(t.closeCSS).data({vex:t}).bind("click.vex",function(){return o.close(e(this).data().vex.id)}),t.$vexContent.append(t.$closeButton)),e(t.appendLocation).append(t.$vex),o.setupBodyClassName(t.$vex),t.afterOpen&&t.afterOpen(t.$vexContent,t),setTimeout(function(){return t.$vexContent.trigger("vexOpen",t)},0),t.$vexContent},getAllVexes:function(){return e("."+o.baseClassNames.vex+':not(".'+o.baseClassNames.closing+'") .'+o.baseClassNames.content)},getVexByID:function(t){return o.getAllVexes().filter(function(){return e(this).data().vex.id===t})},close:function(e){var t;if(!e){if(t=o.getAllVexes().last(),!t.length)return!1;e=t.data().vex.id}return o.closeByID(e)},closeAll:function(){var t;return t=o.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=t?t.length:void 0)?(e.each(t.reverse(),function(e,t){return o.closeByID(t)}),!0):!1},closeByID:function(n){var r,a,l,i,s;return a=o.getVexByID(n),a.length?(r=a.data().vex.$vex,s=e.extend({},a.data().vex),l=function(){return s.beforeClose?s.beforeClose(a,s):void 0},i=function(){return a.trigger("vexClose",s),r.remove(),s.afterClose?s.afterClose(a,s):void 0},t?(l(),r.unbind(o.animationEndEvent).bind(o.animationEndEvent,function(){return i()}).addClass(o.baseClassNames.closing)):(l(),i()),!0):void 0},closeByEscape:function(){var t,n,r;return r=o.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=r?r.length:void 0)?(n=Math.max.apply(Math,r),t=o.getVexByID(n),t.data().vex.escapeButtonCloses!==!0?!1:o.closeByID(n)):!1},setupBodyClassName:function(t){return t.bind("vexOpen.vex",function(){return e("body").addClass(o.baseClassNames.open)}).bind("vexClose.vex",function(){return o.getAllVexes().length?void 0:e("body").removeClass(o.baseClassNames.open)})},hideLoading:function(){return e(".vex-loading-spinner").remove()},showLoading:function(){return o.hideLoading(),e("body").append('<div class="vex-loading-spinner '+o.defaultOptions.className+'"></div>')}}},"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):window.vex=e(jQuery)}.call(this),function(){var e;e=function(e,t){var o,n;return null==t?e.error("Vex is required to use vex.dialog"):(o=function(t){var o;return o={},e.each(t.serializeArray(),function(){return o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o},n={},n.buttons={YES:{text:"OK",type:"submit",className:"vex-dialog-button-primary"},NO:{text:"Cancel",type:"button",className:"vex-dialog-button-secondary",click:function(e){return e.data().vex.value=!1,t.close(e.data().vex.id)}}},n.defaultOptions={callback:function(){},afterOpen:function(){},message:"Message",input:'<input name="vex" type="hidden" value="_vex-empty-value" />',value:!1,buttons:[n.buttons.YES,n.buttons.NO],showCloseButton:!1,onSubmit:function(r){var a,l;return a=e(this),l=a.parent(),r.preventDefault(),r.stopPropagation(),l.data().vex.value=n.getFormValueOnSubmit(o(a)),t.close(l.data().vex.id)},focusFirstInput:!0},n.defaultAlertOptions={message:"Alert",buttons:[n.buttons.YES]},n.defaultConfirmOptions={message:"Confirm"},n.open=function(o){var r;return o=e.extend({},t.defaultOptions,n.defaultOptions,o),o.content=n.buildDialogForm(o),o.beforeClose=function(e){return o.callback(e.data().vex.value)},r=t.open(o),o.focusFirstInput&&r.find('input[type="submit"], textarea, input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="email"], input[type="month"], input[type="number"], input[type="password"], input[type="search"], input[type="tel"], input[type="text"], input[type="time"], input[type="url"], input[type="week"]').first().focus(),r},n.alert=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend({},n.defaultAlertOptions,t),n.open(t)},n.confirm=function(t){return"string"==typeof t?e.error("dialog.confirm(options) requires options.callback."):(t=e.extend({},n.defaultConfirmOptions,t),n.open(t))},n.prompt=function(t){var o;return"string"==typeof t?e.error("dialog.prompt(options) requires options.callback."):(o={message:'<label for="vex">'+(t.label||"Prompt:")+"</label>",input:'<input name="vex" type="text" class="vex-dialog-prompt-input" placeholder="'+(t.placeholder||"")+'"  value="'+(t.value||"")+'" />'},t=e.extend({},o,t),n.open(t))},n.buildDialogForm=function(t){var o,r,a;return o=e('<form class="vex-dialog-form" />'),a=e('<div class="vex-dialog-message" />'),r=e('<div class="vex-dialog-input" />'),o.append(a.append(t.message)).append(r.append(t.input)).append(n.buttonsToDOM(t.buttons)).bind("submit.vex",t.onSubmit),o},n.getFormValueOnSubmit=function(e){return e.vex||""===e.vex?"_vex-empty-value"===e.vex?!0:e.vex:e},n.buttonsToDOM=function(o){var n;return n=e('<div class="vex-dialog-buttons" />'),e.each(o,function(r,a){return n.append(e('<input type="'+a.type+'" />').val(a.text).addClass(a.className+" vex-dialog-button "+(0===r?"vex-first ":"")+(r===o.length-1?"vex-last ":"")).bind("click.vex",function(o){return a.click?a.click(e(this).parents("."+t.baseClassNames.content),o):void 0}))}),n},n)},"function"==typeof define&&define.amd?define(["jquery","vex"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("vex")):window.vex.dialog=e(window.jQuery,window.vex)}.call(this);
//# sourceMappingURL=ethercalc.js.map