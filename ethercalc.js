var SocialCalc;SocialCalc||(SocialCalc={});
SocialCalc.Constants={textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",
s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"2",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #C0C0C0;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",
defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",defaultColnameClass:"",defaultColnameStyle:"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;",
defaultRownameClass:"",defaultRownameStyle:"font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",
s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"images/sc-",
defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',
s_statusline_circref:'<span style="color:red;">Circular reference: ',s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",
ietUnknownFunction:"Unknown function ",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",
MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderStyle:"backgroundColor:#CCC;",TCpanesliderClass:"",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",
TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",
TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",
TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#404040;",SCTabbackground:"background-color:#CCC;",
SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",SCToolbartext:"font-size:x-small;font-weight:bold;color:#FFF;padding-bottom:4px;",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",
SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",
SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",
SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",
SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",ISCButtonBorderNormal:"#404040",ISCButtonBorderHover:"#999",ISCButtonBorderDown:"#FFF",ISCButtonDownBackground:"#888",
s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",
s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",
s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",s_loc_delete_contents:"Delete Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",
s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_horizontal:"Horizontal",s_loc_insert_column:"Insert Column",s_loc_insert_row:"Insert Row",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",
s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",
s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",
s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",
s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:["Sunday","Monday","Tuesday","Wednesday","Thursday",
"Friday","Saturday"],s_FormatNumber_daynames3:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s_FormatNumber_monthnames:["January","February","March","April","May","June","July","August","September","October","November","December"],s_FormatNumber_monthnames3:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",
s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",
s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",
s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",
s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",
s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',
s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",
s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",
s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",
s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",
s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",
s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',
s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',
s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",
s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",
s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",
s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",
s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",
s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",
s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",
s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',
s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',
s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",
s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",
s_fdef_YEAR:"Returns the year part of a date value. ",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period [, factor]",s_farg_find:"string1, string2 [, start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",s_farg_hlookup:"value, range, row, [rangelookup]",
s_farg_iffunc:"logical-expression, true-value, false-value",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",s_farg_replace:"text1, start, length, text2",
s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext [, occurrence]",s_farg_sumif:"range1, criteria [, range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",function_classlist:["all","stat","lookup","datetime","financial","test","math","text"],s_fclass_all:"All",s_fclass_stat:"Statistics",
s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",lastone:null};
SocialCalc.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",
TDpopupElement:""};SocialCalc.ConstantsSetClasses=function(a){var c=SocialCalc.ConstantsDefaultClasses,b=SocialCalc.Constants,d,a=a||"";for(d in c)if(typeof c[d]=="string")b[d+"Class"]=a+(c[d]||d),b[d+"Style"]!==void 0&&(b[d+"Style"]="");else if(typeof c[d]=="object")b[d+"Class"]=a+(c[d].classname||d),b[d+"Style"]=c[d].style};SocialCalc||(SocialCalc={});SocialCalc.Callbacks={expand_wiki:null,expand_markup:function(a,c,b){return SocialCalc.default_expand_markup(a,c,b)},MakePageLink:null,NormalizeSheetName:null};SocialCalc.Cell=function(a){this.coord=a;this.datavalue="";this.datatype=null;this.formula="";this.valuetype="b"};
SocialCalc.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3};
SocialCalc.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"};SocialCalc.Sheet=function(){SocialCalc.ResetSheet(this);this.statuscallbackparams=this.statuscallback=null};
SocialCalc.ResetSheet=function(a){a.cells={};a.attribs={lastcol:1,lastrow:1,defaultlayout:0};a.rowattribs={hide:{},height:{}};a.colattribs={width:{},hide:{}};a.names={};a.layouts=[];a.layouthash={};a.fonts=[];a.fonthash={};a.colors=[];a.colorhash={};a.borderstyles=[];a.borderstylehash={};a.cellformats=[];a.cellformathash={};a.valueformats=[];a.valueformathash={};a.copiedfrom="";a.changes=new SocialCalc.UndoStack;a.renderneeded=!1;a.changedrendervalues=!0;a.recalcchangedavalue=!1};
SocialCalc.Sheet.prototype.ResetSheet=function(){SocialCalc.ResetSheet(this)};SocialCalc.Sheet.prototype.AddCell=function(a){return this.cells[a.coord]=a};SocialCalc.Sheet.prototype.GetAssuredCell=function(a){return this.cells[a]||this.AddCell(new SocialCalc.Cell(a))};SocialCalc.Sheet.prototype.ParseSheetSave=function(a){SocialCalc.ParseSheetSave(a,this)};SocialCalc.Sheet.prototype.CellFromStringParts=function(a,c,b){return SocialCalc.CellFromStringParts(this,a,c,b)};
SocialCalc.Sheet.prototype.CreateSheetSave=function(a,c){return SocialCalc.CreateSheetSave(this,a,c)};SocialCalc.Sheet.prototype.CellToString=function(a){return SocialCalc.CellToString(this,a)};SocialCalc.Sheet.prototype.CanonicalizeSheet=function(a){return SocialCalc.CanonicalizeSheet(this,a)};SocialCalc.Sheet.prototype.EncodeCellAttributes=function(a){return SocialCalc.EncodeCellAttributes(this,a)};SocialCalc.Sheet.prototype.EncodeSheetAttributes=function(){return SocialCalc.EncodeSheetAttributes(this)};
SocialCalc.Sheet.prototype.DecodeCellAttributes=function(a,c,b){return SocialCalc.DecodeCellAttributes(this,a,c,b)};SocialCalc.Sheet.prototype.DecodeSheetAttributes=function(a){return SocialCalc.DecodeSheetAttributes(this,a)};SocialCalc.Sheet.prototype.ScheduleSheetCommands=function(a,c,b){return SocialCalc.ScheduleSheetCommands(this,a,c,b)};SocialCalc.Sheet.prototype.SheetUndo=function(){return SocialCalc.SheetUndo(this)};SocialCalc.Sheet.prototype.SheetRedo=function(){return SocialCalc.SheetRedo(this)};
SocialCalc.Sheet.prototype.CreateAuditString=function(){return SocialCalc.CreateAuditString(this)};SocialCalc.Sheet.prototype.GetStyleNum=function(a,c){return SocialCalc.GetStyleNum(this,a,c)};SocialCalc.Sheet.prototype.GetStyleString=function(a,c){return SocialCalc.GetStyleString(this,a,c)};SocialCalc.Sheet.prototype.RecalcSheet=function(){return SocialCalc.RecalcSheet(this)};
SocialCalc.ParseSheetSave=function(a,c){var b=a.split(/\r\n|\n/),d=[],e,g,h,j,k=SocialCalc.Constants;for(e=0;e<b.length;e++)switch(d=b[e],d=d.split(":"),d[0]){case "cell":h=c.GetAssuredCell(d[1]);g=2;c.CellFromStringParts(h,d,g);break;case "col":j=d[1];for(g=2;h=d[g++];)switch(h){case "w":c.colattribs.width[j]=d[g++];break;case "hide":c.colattribs.hide[j]=d[g++];break;default:throw k.s_pssUnknownColType+" '"+h+"'";}break;case "row":j=d[1]-0;for(g=2;h=d[g++];)switch(h){case "h":c.rowattribs.height[j]=
d[g++]-0;break;case "hide":c.rowattribs.hide[j]=d[g++];break;default:throw k.s_pssUnknownRowType+" '"+h+"'";}break;case "sheet":j=c.attribs;for(g=1;h=d[g++];)switch(h){case "c":j.lastcol=d[g++]-0;break;case "r":j.lastrow=d[g++]-0;break;case "w":j.defaultcolwidth=d[g++]+"";break;case "h":j.defaultrowheight=d[g++]-0;break;case "tf":j.defaulttextformat=d[g++]-0;break;case "ntf":j.defaultnontextformat=d[g++]-0;break;case "layout":j.defaultlayout=d[g++]-0;break;case "font":j.defaultfont=d[g++]-0;break;
case "tvf":j.defaulttextvalueformat=d[g++]-0;break;case "ntvf":j.defaultnontextvalueformat=d[g++]-0;break;case "color":j.defaultcolor=d[g++]-0;break;case "bgcolor":j.defaultbgcolor=d[g++]-0;break;case "circularreferencecell":j.circularreferencecell=d[g++];break;case "recalc":j.recalc=d[g++];break;case "needsrecalc":j.needsrecalc=d[g++];break;default:g+=1}break;case "name":g=SocialCalc.decodeFromSave(d[1]).toUpperCase();c.names[g]={desc:SocialCalc.decodeFromSave(d[2])};c.names[g].definition=SocialCalc.decodeFromSave(d[3]);
break;case "layout":d=b[e].match(/^layout\:(\d+)\:(.+)$/);c.layouts[d[1]-0]=d[2];c.layouthash[d[2]]=d[1]-0;break;case "font":c.fonts[d[1]-0]=d[2];c.fonthash[d[2]]=d[1]-0;break;case "color":c.colors[d[1]-0]=d[2];c.colorhash[d[2]]=d[1]-0;break;case "border":c.borderstyles[d[1]-0]=d[2];c.borderstylehash[d[2]]=d[1]-0;break;case "cellformat":g=SocialCalc.decodeFromSave(d[2]);c.cellformats[d[1]-0]=g;c.cellformathash[g]=d[1]-0;break;case "valueformat":g=SocialCalc.decodeFromSave(d[2]);c.valueformats[d[1]-
0]=g;c.valueformathash[g]=d[1]-0;break;case "version":break;case "copiedfrom":c.copiedfrom=d[1]+":"+d[2];break;case "clipboardrange":case "clipboard":break;case "":break;default:throw alert(k.s_pssUnknownLineType+" '"+d[0]+"'"),k.s_pssUnknownLineType+" '"+d[0]+"'";}};
SocialCalc.CellFromStringParts=function(a,c,b,d){for(;a=b[d++];)switch(a){case "v":c.datavalue=SocialCalc.decodeFromSave(b[d++])-0;c.datatype="v";c.valuetype="n";break;case "t":c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.datatype="t";c.valuetype=SocialCalc.Constants.textdatadefaulttype;break;case "vt":a=b[d++];c.valuetype=a;a.charAt(0)=="n"?(c.datatype="v",c.datavalue=SocialCalc.decodeFromSave(b[d++])-0):(c.datatype="t",c.datavalue=SocialCalc.decodeFromSave(b[d++]));break;case "vtf":a=b[d++];
c.valuetype=a;c.datavalue=a.charAt(0)=="n"?SocialCalc.decodeFromSave(b[d++])-0:SocialCalc.decodeFromSave(b[d++]);c.formula=SocialCalc.decodeFromSave(b[d++]);c.datatype="f";break;case "vtc":a=b[d++];c.valuetype=a;c.datavalue=a.charAt(0)=="n"?SocialCalc.decodeFromSave(b[d++])-0:SocialCalc.decodeFromSave(b[d++]);c.formula=SocialCalc.decodeFromSave(b[d++]);c.datatype="c";break;case "e":c.errors=SocialCalc.decodeFromSave(b[d++]);break;case "b":c.bt=b[d++]-0;c.br=b[d++]-0;c.bb=b[d++]-0;c.bl=b[d++]-0;break;
case "l":c.layout=b[d++]-0;break;case "f":c.font=b[d++]-0;break;case "c":c.color=b[d++]-0;break;case "bg":c.bgcolor=b[d++]-0;break;case "cf":c.cellformat=b[d++]-0;break;case "ntvf":c.nontextvalueformat=b[d++]-0;break;case "tvf":c.textvalueformat=b[d++]-0;break;case "colspan":c.colspan=b[d++]-0;break;case "rowspan":c.rowspan=b[d++]-0;break;case "cssc":c.cssc=b[d++];break;case "csss":c.csss=SocialCalc.decodeFromSave(b[d++]);break;case "mod":d+=1;break;case "comment":c.comment=SocialCalc.decodeFromSave(b[d++]);
break;default:throw SocialCalc.Constants.s_cfspUnknownCellType+" '"+a+"'";}};SocialCalc.sheetfields=["defaultrowheight","defaultcolwidth","circularreferencecell","recalc","needsrecalc"];SocialCalc.sheetfieldsshort=["h","w","circularreferencecell","recalc","needsrecalc"];SocialCalc.sheetfieldsxlat=["defaulttextformat","defaultnontextformat","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","defaultfont","defaultlayout"];
SocialCalc.sheetfieldsxlatshort=["tf","ntf","tvf","ntvf","color","bgcolor","font","layout"];SocialCalc.sheetfieldsxlatxlt=["cellformat","cellformat","valueformat","valueformat","color","color","font","layout"];
SocialCalc.CreateSheetSave=function(a,c,b){var d,e,g,h,j,k=[];a.CanonicalizeSheet(b||SocialCalc.Constants.doCanonicalizeSheet);var m=a.xlt;e=c?SocialCalc.ParseRange(c):{cr1:{row:1,col:1},cr2:{row:m.maxrow,col:m.maxcol}};b=e.cr1;e=e.cr2;k.push("version:1.5");for(g=b.row;g<=e.row;g++)for(h=b.col;h<=e.col;h++)if(j=SocialCalc.crToCoord(h,g),d=a.cells[j])d=a.CellToString(d),d.length!=0&&(d="cell:"+j+d,k.push(d));for(h=1;h<=m.maxcol;h++)j=SocialCalc.rcColname(h),a.colattribs.width[j]&&k.push("col:"+j+":w:"+
a.colattribs.width[j]),a.colattribs.hide[j]&&k.push("col:"+j+":hide:"+a.colattribs.hide[j]);for(g=1;g<=m.maxrow;g++)a.rowattribs.height[g]&&k.push("row:"+g+":h:"+a.rowattribs.height[g]),a.rowattribs.hide[g]&&k.push("row:"+g+":hide:"+a.rowattribs.hide[g]);d="sheet:c:"+m.maxcol+":r:"+m.maxrow;for(g=0;g<SocialCalc.sheetfields.length;g++)(h=SocialCalc.encodeForSave(a.attribs[SocialCalc.sheetfields[g]]))&&(d+=":"+SocialCalc.sheetfieldsshort[g]+":"+h);for(g=0;g<SocialCalc.sheetfieldsxlat.length;g++)(h=
a.attribs[SocialCalc.sheetfieldsxlat[g]])&&(d+=":"+SocialCalc.sheetfieldsxlatshort[g]+":"+m[SocialCalc.sheetfieldsxlatxlt[g]+"sxlat"][h]);k.push(d);for(g=1;g<m.newborderstyles.length;g++)k.push("border:"+g+":"+m.newborderstyles[g]);for(g=1;g<m.newcellformats.length;g++)k.push("cellformat:"+g+":"+SocialCalc.encodeForSave(m.newcellformats[g]));for(g=1;g<m.newcolors.length;g++)k.push("color:"+g+":"+m.newcolors[g]);for(g=1;g<m.newfonts.length;g++)k.push("font:"+g+":"+m.newfonts[g]);for(g=1;g<m.newlayouts.length;g++)k.push("layout:"+
g+":"+m.newlayouts[g]);for(g=1;g<m.newvalueformats.length;g++)k.push("valueformat:"+g+":"+SocialCalc.encodeForSave(m.newvalueformats[g]));for(g=0;g<m.namesorder.length;g++)d=m.namesorder[g],k.push("name:"+SocialCalc.encodeForSave(d).toUpperCase()+":"+SocialCalc.encodeForSave(a.names[d].desc)+":"+SocialCalc.encodeForSave(a.names[d].definition));c&&k.push("copiedfrom:"+SocialCalc.crToCoord(b.col,b.row)+":"+SocialCalc.crToCoord(e.col,e.row));k.push("");delete a.xlt;return k.join("\n")};
SocialCalc.CellToString=function(a,c){var b,d,e,g,h,j;b="";if(!c)return b;d=SocialCalc.encodeForSave(c.datavalue);c.datatype=="v"?b+=c.valuetype=="n"?":v:"+d:":vt:"+c.valuetype+":"+d:c.datatype=="t"?b+=c.valuetype==SocialCalc.Constants.textdatadefaulttype?":t:"+d:":vt:"+c.valuetype+":"+d:(e=SocialCalc.encodeForSave(c.formula),c.datatype=="f"?b+=":vtf:"+c.valuetype+":"+d+":"+e:c.datatype=="c"&&(b+=":vtc:"+c.valuetype+":"+d+":"+e));c.errors&&(b+=":e:"+SocialCalc.encodeForSave(c.errors));d=c.bt||"";
e=c.br||"";g=c.bb||"";h=c.bl||"";if(a.xlt){j=a.xlt;if(d||e||g||h)b+=":b:"+j.borderstylesxlat[d||0]+":"+j.borderstylesxlat[e||0]+":"+j.borderstylesxlat[g||0]+":"+j.borderstylesxlat[h||0];c.layout&&(b+=":l:"+j.layoutsxlat[c.layout]);c.font&&(b+=":f:"+j.fontsxlat[c.font]);c.color&&(b+=":c:"+j.colorsxlat[c.color]);c.bgcolor&&(b+=":bg:"+j.colorsxlat[c.bgcolor]);c.cellformat&&(b+=":cf:"+j.cellformatsxlat[c.cellformat]);c.textvalueformat&&(b+=":tvf:"+j.valueformatsxlat[c.textvalueformat]);c.nontextvalueformat&&
(b+=":ntvf:"+j.valueformatsxlat[c.nontextvalueformat])}else{if(d||e||g||h)b+=":b:"+d+":"+e+":"+g+":"+h;c.layout&&(b+=":l:"+c.layout);c.font&&(b+=":f:"+c.font);c.color&&(b+=":c:"+c.color);c.bgcolor&&(b+=":bg:"+c.bgcolor);c.cellformat&&(b+=":cf:"+c.cellformat);c.textvalueformat&&(b+=":tvf:"+c.textvalueformat);c.nontextvalueformat&&(b+=":ntvf:"+c.nontextvalueformat)}c.colspan&&(b+=":colspan:"+c.colspan);c.rowspan&&(b+=":rowspan:"+c.rowspan);c.cssc&&(b+=":cssc:"+c.cssc);c.csss&&(b+=":csss:"+SocialCalc.encodeForSave(c.csss));
c.mod&&(b+=":mod:"+c.mod);c.comment&&(b+=":comment:"+SocialCalc.encodeForSave(c.comment));return b};
SocialCalc.CanonicalizeSheet=function(a,c){var b,d,e,g,h,j,k,m=0,n=0,s=["borderstyle","cellformat","color","font","layout","valueformat"],q={namesorder:[]};for(h in a.names)q.namesorder.push(h);q.namesorder.sort();if(!SocialCalc.Constants.doCanonicalizeSheet||!c){for(g=0;g<s.length;g++){h=s[g];q["new"+h+"s"]=a[h+"s"];b=a[h+"s"].length;e=Array(b);e[0]="";for(k=1;k<b;k++)e[k]=k;q[h+"sxlat"]=e}q.maxrow=a.attribs.lastrow;q.maxcol=a.attribs.lastcol}else{for(g=0;g<s.length;g++)h=s[g],q[h+"sUsed"]={};k=
q.colorsUsed;j=q.borderstylesUsed;var p=q.fontsUsed,r=q.layoutsUsed,u=q.cellformatsUsed,t=q.valueformatsUsed;for(d in a.cells)if(e=SocialCalc.coordToCr(d),g=a.cells[d],h=!1,g.valuetype&&g.valuetype!="b"&&(h=!0),g.color&&(k[g.color]=1,h=!0),g.bgcolor&&(k[g.bgcolor]=1,h=!0),g.bt&&(j[g.bt]=1,h=!0),g.br&&(j[g.br]=1,h=!0),g.bb&&(j[g.bb]=1,h=!0),g.bl&&(j[g.bl]=1,h=!0),g.layout&&(r[g.layout]=1,h=!0),g.font&&(p[g.font]=1,h=!0),g.cellformat&&(u[g.cellformat]=1,h=!0),g.textvalueformat&&(t[g.textvalueformat]=
1,h=!0),g.nontextvalueformat&&(t[g.nontextvalueformat]=1,h=!0),h){if(e.row>m)m=e.row;if(e.col>n)n=e.col}for(k=0;k<SocialCalc.sheetfieldsxlat.length;k++)(b=a.attribs[SocialCalc.sheetfieldsxlat[k]])&&(q[SocialCalc.sheetfieldsxlatxlt[k]+"sUsed"][b]=1);h={height:1,hide:1};for(b in h)for(e in a.rowattribs[b])e>m&&(m=e);h={hide:1,width:1};for(b in h)for(d in a.colattribs[b])if(e=SocialCalc.coordToCr(d+"1"),e.col>n)n=e.col;for(g=0;g<s.length;g++){h=s[g];d=[];e=q[h+"sUsed"];for(b in e)d.push(a[h+"s"][b]);
d.sort();d.unshift("");e=[""];j=a[h+"hash"];for(k=1;k<d.length;k++)e[j[d[k]]]=k;q[h+"sxlat"]=e;q["new"+h+"s"]=d}q.maxrow=m||1;q.maxcol=n||1}a.xlt=q};
SocialCalc.EncodeCellAttributes=function(a,c){var b,d,e,g={},h=function(a){g[a]={def:!0,val:""}},j=function(a){for(var c=0;c<a.length;c++)h(a[c])},k=function(a,c){g[a].def=!1;g[a].val=c||""};b=function(a,c){if(c!="*")g[a].def=!1,g[a].val=c};var m=a.GetAssuredCell(c);h("alignhoriz");m.cellformat&&k("alignhoriz",a.cellformats[m.cellformat]);j(["alignvert","padtop","padright","padbottom","padleft"]);m.layout&&(d=a.layouts[m.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),
b("padtop",d[1]),b("padright",d[2]),b("padbottom",d[3]),b("padleft",d[4]),b("alignvert",d[5]));j(["fontfamily","fontlook","fontsize"]);m.font&&(d=a.fonts[m.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),b("fontfamily",d[3]),b("fontsize",d[2]),b("fontlook",d[1]));h("textcolor");m.color&&k("textcolor",a.colors[m.color]);h("bgcolor");m.bgcolor&&k("bgcolor",a.colors[m.bgcolor]);j(["numberformat","textformat"]);m.nontextvalueformat&&k("numberformat",a.valueformats[m.nontextvalueformat]);m.textvalueformat&&
k("textformat",a.valueformats[m.textvalueformat]);j(["colspan","rowspan"]);k("colspan",m.colspan||1);k("rowspan",m.rowspan||1);for(b=0;b<4;b++)d="trbl".charAt(b),e="b"+d,h(e),k(e,m[e]?a.borderstyles[m[e]]:""),h(e+"thickness"),h(e+"style"),h(e+"color"),m[e]&&(d=a.borderstyles[m[e]].match(/(\S+)\s+(\S+)\s+(\S.+)/),k(e+"thickness",d[1]),k(e+"style",d[2]),k(e+"color",d[3]));j(["cssc","csss","mod"]);k("cssc",m.cssc||"");k("csss",m.csss||"");k("mod",m.mod||"n");return g};
SocialCalc.EncodeSheetAttributes=function(a){var c=a.attribs,b={},d=function(a){b[a]={def:!0,val:""}},e=function(a){for(var c=0;c<a.length;c++)d(a[c])},g=function(a,c){b[a].def=!1;b[a].val=c||void 0},h=function(a,c){if(c!="*")b[a].def=!1,b[a].val=c};d("colwidth");c.defaultcolwidth&&g("colwidth",c.defaultcolwidth);d("rowheight");c.rowheight&&g("rowheight",c.defaultrowheight);d("textalignhoriz");c.defaulttextformat&&g("textalignhoriz",a.cellformats[c.defaulttextformat]);d("numberalignhoriz");c.defaultnontextformat&&
g("numberalignhoriz",a.cellformats[c.defaultnontextformat]);e(["alignvert","padtop","padright","padbottom","padleft"]);c.defaultlayout&&(parts=a.layouts[c.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),h("padtop",parts[1]),h("padright",parts[2]),h("padbottom",parts[3]),h("padleft",parts[4]),h("alignvert",parts[5]));e(["fontfamily","fontlook","fontsize"]);c.defaultfont&&(parts=a.fonts[c.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),h("fontfamily",
parts[3]),h("fontsize",parts[2]),h("fontlook",parts[1]));d("textcolor");c.defaultcolor&&g("textcolor",a.colors[c.defaultcolor]);d("bgcolor");c.defaultbgcolor&&g("bgcolor",a.colors[c.defaultbgcolor]);e(["numberformat","textformat"]);c.defaultnontextvalueformat&&g("numberformat",a.valueformats[c.defaultnontextvalueformat]);c.defaulttextvalueformat&&g("textformat",a.valueformats[c.defaulttextvalueformat]);d("recalc");c.recalc&&g("recalc",c.recalc);return b};
SocialCalc.DecodeCellAttributes=function(a,c,b,d){var e,g,h=a.GetAssuredCell(c),j=!1,k=function(a,c,d){b[a]&&(a=b[a].def?"":b[a].val,a!=(c||"")&&n(d+" "+a))},m="",n=function(a){m&&(m+="\n");m+="set "+(d||c)+" "+a;j=!0};k("alignhoriz",a.cellformats[h.cellformat],"cellformat");e=!b.alignvert.def||!b.padtop.def||!b.padright.def||!b.padbottom.def||!b.padleft.def?"padding:"+(b.padtop.def?"* ":b.padtop.val+" ")+(b.padright.def?"* ":b.padright.val+" ")+(b.padbottom.def?"* ":b.padbottom.val+" ")+(b.padleft.def?
"*":b.padleft.val)+";vertical-align:"+(b.alignvert.def?"*;":b.alignvert.val+";"):"";e!=(a.layouts[h.layout]||"")&&n("layout "+e);e=!b.fontlook.def||!b.fontsize.def||!b.fontfamily.def?(b.fontlook.def?"* ":b.fontlook.val+" ")+(b.fontsize.def?"* ":b.fontsize.val+" ")+(b.fontfamily.def?"*":b.fontfamily.val):"";e!=(a.fonts[h.font]||"")&&n("font "+e);k("textcolor",a.colors[h.color],"color");k("bgcolor",a.colors[h.bgcolor],"bgcolor");k("numberformat",a.valueformats[h.nontextvalueformat],"nontextvalueformat");
k("textformat",a.valueformats[h.textvalueformat],"textvalueformat");for(e=0;e<4;e++)g="trbl".charAt(e),g="b"+g,k(g,a.borderstyles[h[g]],g);k("cssc",h.cssc,"cssc");k("csss",h.csss,"csss");if(b.mod&&(e=b.mod.def?"n":b.mod.val,e!=(h.mod||"n")))e=="n"&&(e=""),n("mod "+e);return j?m:null};
SocialCalc.DecodeSheetAttributes=function(a,c){var b,d=a.attribs,e=!1,g=function(a,b,d){c[a]&&(a=c[a].def?"":c[a].val,a!=(b||"")&&j(d+" "+a))},h="",j=function(a){h&&(h+="\n");h+="set sheet "+a;e=!0};g("colwidth",d.defaultcolwidth,"defaultcolwidth");g("rowheight",d.defaultrowheight,"defaultrowheight");g("textalignhoriz",a.cellformats[d.defaulttextformat],"defaulttextformat");g("numberalignhoriz",a.cellformats[d.defaultnontextformat],"defaultnontextformat");b=!c.alignvert.def||!c.padtop.def||!c.padright.def||
!c.padbottom.def||!c.padleft.def?"padding:"+(c.padtop.def?"* ":c.padtop.val+" ")+(c.padright.def?"* ":c.padright.val+" ")+(c.padbottom.def?"* ":c.padbottom.val+" ")+(c.padleft.def?"*":c.padleft.val)+";vertical-align:"+(c.alignvert.def?"*;":c.alignvert.val+";"):"";b!=(a.layouts[d.defaultlayout]||"")&&j("defaultlayout "+b);b=!c.fontlook.def||!c.fontsize.def||!c.fontfamily.def?(c.fontlook.def?"* ":c.fontlook.val+" ")+(c.fontsize.def?"* ":c.fontsize.val+" ")+(c.fontfamily.def?"*":c.fontfamily.val):"";
b!=(a.fonts[d.defaultfont]||"")&&j("defaultfont "+b);g("textcolor",a.colors[d.defaultcolor],"defaultcolor");g("bgcolor",a.colors[d.defaultbgcolor],"defaultbgcolor");g("numberformat",a.valueformats[d.defaultnontextvalueformat],"defaultnontextvalueformat");g("textformat",a.valueformats[d.defaulttextvalueformat],"defaulttextvalueformat");g("recalc",a.attribs.recalc,"recalc");return e?h:null};
SocialCalc.SheetCommandInfo={sheetobj:null,parseobj:null,timerobj:null,firsttimerdelay:50,timerdelay:1,maxtimeslice:100,saveundo:!1,CmdExtensionCallbacks:{},cmdextensionbusy:""};
SocialCalc.ScheduleSheetCommands=function(a,c,b,d){SocialCalc.Callbacks.broadcast&&!d&&c!="redisplay"&&c!="set sheet defaulttextvalueformat text-wiki"&&SocialCalc.Callbacks.broadcast("execute",{cmdstr:c,saveundo:b});d=SocialCalc.SheetCommandInfo;d.sheetobj=a;d.parseobj=new SocialCalc.Parse(c);d.saveundo=b;d.sheetobj.statuscallback&&a.statuscallback(d,"cmdstart","",d.sheetobj.statuscallbackparams);d.saveundo&&d.sheetobj.changes.PushChange("");d.timerobj=window.setTimeout(SocialCalc.SheetCommandsTimerRoutine,
d.firsttimerdelay)};
SocialCalc.SheetCommandsTimerRoutine=function(){var a,c=SocialCalc.SheetCommandInfo,b=new Date;for(c.timerobj=null;!c.parseobj.EOF();){(a=SocialCalc.ExecuteSheetCommand(c.sheetobj,c.parseobj,c.saveundo))&&alert(a);c.parseobj.NextLine();if(c.cmdextensionbusy.length>0){c.sheetobj.statuscallback&&c.sheetobj.statuscallback(c,"cmdextension",c.cmdextensionbusy,c.sheetobj.statuscallbackparams);return}if(new Date-b>=c.maxtimeslice){c.timerobj=window.setTimeout(SocialCalc.SheetCommandsTimerRoutine,c.timerdelay);
return}}c.sheetobj.statuscallback&&c.sheetobj.statuscallback(c,"cmdend","",c.sheetobj.statuscallbackparams)};SocialCalc.ResumeFromCmdExtension=function(){SocialCalc.SheetCommandInfo.cmdextensionbusy="";SocialCalc.SheetCommandsTimerRoutine()};
SocialCalc.ExecuteSheetCommand=function(a,c,b){var d,e,g,h,j,k,m,n,s,q,p,r,u,t,w,x,y,z,B,A,E,J,G,I,v,D,C=a.attribs;v=a.changes;A=SocialCalc.CellProperties;w=SocialCalc.Constants;q=function(){var a=SocialCalc.ParseRange(h);n=a.cr1;s=a.cr2;if(s.col>C.lastcol)C.lastcol=s.col;if(s.row>C.lastrow)C.lastrow=s.row};m="";d=c.RestOfStringNoMove();b&&a.changes.AddDo(d);e=c.NextToken();switch(e){case "set":h=c.NextToken();j=c.NextToken();g=c.RestOfString();c="set "+h+" "+j;if(h=="sheet")switch(a.renderneeded=
!0,j){case "defaultcolwidth":b&&v.AddUndo(c,C[j]);C[j]=g;break;case "defaultcolor":case "defaultbgcolor":b&&v.AddUndo(c,a.GetStyleString("color",C[j]));C[j]=a.GetStyleNum("color",g);break;case "defaultlayout":b&&v.AddUndo(c,a.GetStyleString("layout",C[j]));C[j]=a.GetStyleNum("layout",g);break;case "defaultfont":b&&v.AddUndo(c,a.GetStyleString("font",C[j]));g=="* * *"&&(g="");C[j]=a.GetStyleNum("font",g);break;case "defaulttextformat":case "defaultnontextformat":b&&v.AddUndo(c,a.GetStyleString("cellformat",
C[j]));C[j]=a.GetStyleNum("cellformat",g);break;case "defaulttextvalueformat":case "defaultnontextvalueformat":b&&v.AddUndo(c,a.GetStyleString("valueformat",C[j]));C[j]=a.GetStyleNum("valueformat",g);for(k in a.cells)delete a.cells[k].displaystring;break;case "lastcol":case "lastrow":b&&v.AddUndo(c,C[j]-0);a=g-0;typeof a=="number"&&(C[j]=a>0?a:1);break;case "recalc":b&&v.AddUndo(c,C[j]);g=="off"?C.recalc=g:delete C.recalc;break;default:m=w.s_escUnknownSheetCmd+d}else if(/(^[A-Z])([A-Z])?(:[A-Z][A-Z]?){0,1}$/i.test(h)){a.renderneeded=
!0;h=h.toUpperCase();k=h.indexOf(":");k>=0?(n=SocialCalc.coordToCr(h.substring(0,k)+"1"),s=SocialCalc.coordToCr(h.substring(k+1)+"1")):s=n=SocialCalc.coordToCr(h+"1");for(c=n.col;c<=s.col;c++)j=="width"&&(k=SocialCalc.rcColname(c),b&&v.AddUndo("set "+k+" width",a.colattribs.width[k]),g.length>0?a.colattribs.width[k]=g:delete a.colattribs.width[k])}else if(/([a-z]){0,1}(\d+)/i.test(h)){q();n.row!=s.row||n.col!=s.col||a.celldisplayneeded||a.renderneeded?(a.renderneeded=!0,a.celldisplayneeded=""):a.celldisplayneeded=
SocialCalc.crToCoord(n.col,n.row);for(q=n.row;q<=s.row;q++)for(c=n.col;c<=s.col;c++)k=SocialCalc.crToCoord(c,q),p=a.GetAssuredCell(k),b&&v.AddUndo("set "+k+" all",a.CellToString(p)),j=="value"?(k=g.indexOf(" "),p.datavalue=g.substring(k+1)-0,delete p.errors,p.datatype="v",p.valuetype=g.substring(0,k),delete p.displaystring,delete p.parseinfo,C.needsrecalc="yes"):j=="text"?(k=g.indexOf(" "),p.datavalue=SocialCalc.decodeFromSave(g.substring(k+1)),delete p.errors,p.datatype="t",p.valuetype=g.substring(0,
k),delete p.displaystring,delete p.parseinfo,C.needsrecalc="yes"):j=="formula"?(p.datavalue=0,delete p.errors,p.datatype="f",p.valuetype="e#N/A",p.formula=g,delete p.displaystring,delete p.parseinfo,C.needsrecalc="yes"):j=="constant"?(k=g.indexOf(" "),e=g.substring(k+1).indexOf(" "),p.datavalue=g.substring(k+1,k+1+e)-0,p.valuetype=g.substring(0,k),p.valuetype.charAt(0)=="e"?p.errors=p.valuetype.substring(1):delete p.errors,p.datatype="c",p.formula=g.substring(k+e+2),delete p.displaystring,delete p.parseinfo,
C.needsrecalc="yes"):j=="empty"?(p.datavalue="",delete p.errors,p.datatype=null,p.formula="",p.valuetype="b",delete p.displaystring,delete p.parseinfo,C.needsrecalc="yes"):j=="all"?(g.length>0?(p=new SocialCalc.Cell(k),a.CellFromStringParts(p,g.split(":"),1),a.cells[k]=p):delete a.cells[k],C.needsrecalc="yes"):/^b[trbl]$/.test(j)?(p[j]=a.GetStyleNum("borderstyle",g),a.renderneeded=!0):j=="color"||j=="bgcolor"?p[j]=a.GetStyleNum("color",g):j=="layout"||j=="cellformat"?p[j]=a.GetStyleNum(j,g):j=="font"?
(g=="* * *"&&(g=""),p[j]=a.GetStyleNum("font",g)):j=="textvalueformat"||j=="nontextvalueformat"?(p[j]=a.GetStyleNum("valueformat",g),delete p.displaystring):j=="cssc"?(g=g.replace(/[^a-zA-Z0-9\-]/g,""),p.cssc=g):j=="csss"?(g=g.replace(/\n/g,""),p.csss=g):j=="mod"?(g=g.replace(/[^yY]/g,"").toLowerCase(),p.mod=g):j=="comment"?p.comment=SocialCalc.decodeFromSave(g):m=w.s_escUnknownSetCoordCmd+d}break;case "merge":a.renderneeded=!0;h=c.NextToken();g=c.RestOfString();q();p=a.GetAssuredCell(n.coord);b&&
v.AddUndo("unmerge "+n.coord);s.col>n.col?p.colspan=s.col-n.col+1:delete p.colspan;s.row>n.row?p.rowspan=s.row-n.row+1:delete p.rowspan;a.changedrendervalues=!0;break;case "unmerge":a.renderneeded=!0;h=c.NextToken();g=c.RestOfString();q();p=a.GetAssuredCell(n.coord);b&&v.AddUndo("merge "+n.coord+":"+SocialCalc.crToCoord(n.col+(p.colspan||1)-1,n.row+(p.rowspan||1)-1));delete p.colspan;delete p.rowspan;a.changedrendervalues=!0;break;case "erase":case "cut":a.renderneeded=!0;a.changedrendervalues=!0;
h=c.NextToken();g=c.RestOfString();q();b&&v.AddUndo("changedrendervalues");if(e=="cut")b&&v.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard)),SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(a,h);for(q=n.row;q<=s.row;q++)for(c=n.col;c<=s.col;c++)if(k=SocialCalc.crToCoord(c,q),p=a.GetAssuredCell(k),b&&v.AddUndo("set "+k+" all",a.CellToString(p)),g=="all")delete a.cells[k];else if(g=="formulas")p.datavalue="",p.datatype=null,p.formula="",p.valuetype="b",delete p.errors,
delete p.displaystring,delete p.parseinfo,p.comment&&delete p.comment;else if(g=="formats"){j=new SocialCalc.Cell(k);j.datavalue=p.datavalue;j.datatype=p.datatype;j.formula=p.formula;j.valuetype=p.valuetype;if(p.comment)j.comment=p.comment;a.cells[k]=j}C.needsrecalc="yes";break;case "fillright":case "filldown":a.renderneeded=!0;a.changedrendervalues=!0;b&&v.AddUndo("changedrendervalues");h=c.NextToken();g=c.RestOfString();q();e=="fillright"?(e=!0,r=n.row,u=n.col+1):(e=!1,r=n.row+1,u=n.col);for(q=
r;q<=s.row;q++)for(c=u;c<=s.col;c++){k=SocialCalc.crToCoord(c,q);p=a.GetAssuredCell(k);b&&v.AddUndo("set "+k+" all",a.CellToString(p));e?(t=SocialCalc.crToCoord(n.col,q),w=c-u+1,d=0):(t=SocialCalc.crToCoord(c,n.row),w=0,d=q-r+1);x=a.GetAssuredCell(t);if(g=="all"||g=="formats")for(j in A)A[j]!=1&&(typeof x[j]===void 0||A[j]==3?delete p[j]:p[j]=x[j]);if(g=="all"||g=="formulas")p.datavalue=x.datavalue,p.datatype=x.datatype,p.valuetype=x.valuetype,p.formula=p.datatype=="f"?SocialCalc.OffsetFormulaCoords(x.formula,
w,d):x.formula,delete p.parseinfo,p.errors=x.errors;delete p.displaystring}C.needsrecalc="yes";break;case "copy":h=c.NextToken();g=c.RestOfString();b&&v.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(a,h);break;case "loadclipboard":g=c.RestOfString();b&&v.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.decodeFromSave(g);break;case "clearclipboard":b&&
v.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard="";break;case "paste":a.renderneeded=!0;a.changedrendervalues=!0;b&&v.AddUndo("changedrendervalues");h=c.NextToken();g=c.RestOfString();q();if(!SocialCalc.Clipboard.clipboard)break;e=new SocialCalc.Sheet;e.ParseSheetSave(SocialCalc.Clipboard.clipboard);q=SocialCalc.ParseRange(e.copiedfrom);w=n.col-q.cr1.col;d=n.row-q.cr1.row;y=q.cr2.col-q.cr1.col+1;z=q.cr2.row-q.cr1.row+1;if(n.col+y-
1>C.lastcol)C.lastcol=n.col+y-1;if(n.row+z-1>C.lastrow)C.lastrow=n.row+z-1;for(q=n.row;q<n.row+z;q++)for(c=n.col;c<n.col+y;c++){k=SocialCalc.crToCoord(c,q);p=a.GetAssuredCell(k);b&&v.AddUndo("set "+k+" all",a.CellToString(p));t=SocialCalc.crToCoord(c-w,q-d);x=e.GetAssuredCell(t);if(g=="all"||g=="formats")for(j in A)A[j]!=1&&(typeof x[j]===void 0||A[j]==3?delete p[j]:(k=SocialCalc.CellPropertiesTable[j],p[j]=k&&x[j]?a.GetStyleNum(k,e.GetStyleString(k,x[j])):x[j]));if(g=="all"||g=="formulas")p.datavalue=
x.datavalue,p.datatype=x.datatype,p.valuetype=x.valuetype,p.formula=p.datatype=="f"?SocialCalc.OffsetFormulaCoords(x.formula,w,d):x.formula,delete p.parseinfo,p.errors=x.errors,x.comment?p.comment=x.comment:p.comment&&delete p.comment;delete p.displaystring}C.needsrecalc="yes";break;case "sort":a.renderneeded=!0;a.changedrendervalues=!0;b&&v.AddUndo("changedrendervalues");h=c.NextToken();q();d=[];E=[];for(w=J=0;w<=3;w++)d[w]=c.NextToken(),E[w]=c.NextToken(),d[w]&&(J=w);e={};j=[];G=[];I=[];for(q=n.row;q<=
s.row;q++){for(c=n.col;c<=s.col;c++)k=SocialCalc.crToCoord(c,q),(p=a.cells[k])?(e[k]=a.CellToString(p),b&&v.AddUndo("set "+k+" all",e[k])):b&&v.AddUndo("set "+k+" all");j.push(j.length);G.push([]);I.push([]);slast=I.length-1;for(w=0;w<=J;w++)k=d[w]+q,p=a.GetAssuredCell(k),k=p.datavalue,c=p.valuetype.charAt(0)||"b",c=="t"&&(k=k.toLowerCase()),G[slast].push(k),I[slast].push(c)}j.sort(function(a,c){var b,d,e,g,h;for(b=0;b<=J;b++)if(E[b]=="up"?(d=a,e=c):(d=c,e=a),g=I[d][b],tb=I[e][b],g=="t"?tb=="t"?(d=
G[d][b],e=G[e][b],h=d>e?1:d<e?-1:0):tb=="n"?h=1:tb=="b"?h=E[b]=="up"?-1:1:tb=="e"&&(h=-1):g=="n"?tb=="t"?h=-1:tb=="n"?(d=G[d][b]-0,e=G[e][b]-0,h=d>e?1:d<e?-1:0):tb=="b"?h=E[b]=="up"?-1:1:tb=="e"&&(h=-1):g=="e"?tb=="e"?(d=G[d][b],e=G[e][b],h=d>e?1:d<e?-1:0):h=tb=="b"?E[b]=="up"?-1:1:1:g=="b"&&(h=tb=="b"?0:E[b]=="up"?1:-1),h)return h;return a>c?1:a<c?-1:0});for(q=n.row;q<=s.row;q++){b=j[q-n.row];for(c=n.col;c<=s.col;c++)if(k=SocialCalc.crToCoord(c,q),v=SocialCalc.crToCoord(c,b+n.row),e[v]){p=new SocialCalc.Cell(k);
a.CellFromStringParts(p,e[v].split(":"),1);if(p.datatype=="f")p.formula=SocialCalc.OffsetFormulaCoords(p.formula,0,q-n.row-b);a.cells[k]=p}else delete a.cells[k]}C.needsrecalc="yes";break;case "insertcol":case "insertrow":a.renderneeded=!0;a.changedrendervalues=!0;h=c.NextToken();g=c.RestOfString();q();e=="insertcol"?(w=1,g=n.col,d=0,u=1,B=r=n.col,p=1,y=C.lastrow,b&&v.AddUndo("deletecol "+n.coord)):(w=0,d=g=1,u=n.row,r=1,B=C.lastcol,y=p=n.row,b&&v.AddUndo("deleterow "+n.coord));for(q=C.lastrow;q>=
u;q--)for(c=C.lastcol;c>=g;c--)t=SocialCalc.crToCoord(c,q),k=SocialCalc.crToCoord(c+w,q+d),a.cells[t]?a.cells[k]=a.cells[t]:delete a.cells[k];for(q=p;q<=y;q++)for(c=r;c<=B;c++)for(j in k=SocialCalc.crToCoord(c,q),p=new SocialCalc.Cell(k),a.cells[k]=p,t=SocialCalc.crToCoord(c-w,q-d),x=a.GetAssuredCell(t),A)A[j]==2&&(p[j]=x[j]);for(k in a.cells){if((p=a.cells[k])&&p.datatype=="f")p.formula=SocialCalc.AdjustFormulaCoords(p.formula,n.col,w,n.row,d);p&&delete p.parseinfo}for(D in a.names)if(a.names[D])c=
a.names[D].definition,k="",c.charAt(0)=="="&&(k="=",c=c.substring(1)),a.names[D].definition=k+SocialCalc.AdjustFormulaCoords(c,n.col,w,n.row,d);for(q=C.lastrow;q>=u&&e=="insertrow";q--)for(j in b=q+d,a.rowattribs)k=a.rowattribs[j][q],a.rowattribs[j][b]!=k&&(k?a.rowattribs[j][b]=k:delete a.rowattribs[j][b]);for(c=C.lastcol;c>=g&&e=="insertcol";c--)for(j in q=SocialCalc.rcColname(c),b=SocialCalc.rcColname(c+w),a.colattribs)k=a.colattribs[j][q],a.colattribs[j][b]!=k&&(k?a.colattribs[j][b]=k:delete a.colattribs[j][b]);
C.lastcol+=w;C.lastrow+=d;C.needsrecalc="yes";break;case "deletecol":case "deleterow":a.renderneeded=!0;a.changedrendervalues=!0;h=c.NextToken();g=c.RestOfString();g=C.lastcol;A=C.lastrow;q();e=="deletecol"?(w=n.col-s.col-1,d=0,u=s.col+1,r=1):(w=0,d=n.row-s.row-1,u=1,r=s.row+1);for(q=r;q<=A-d;q++)for(c=u;c<=g-w;c++){k=SocialCalc.crToCoord(c+w,q+d);if(b&&(q<r-d||c<u-w))(p=a.cells[k])?v.AddUndo("set "+k+" all",a.CellToString(p)):v.AddUndo("erase "+k+" all");t=SocialCalc.crToCoord(c,q);(p=a.cells[t])?
a.cells[k]=p:delete a.cells[k]}for(k in a.cells)if(p=a.cells[k])p.datatype=="f"?(q=p.formula,p.formula=SocialCalc.AdjustFormulaCoords(q,n.col,w,n.row,d),p.formula!=q&&(delete p.parseinfo,b&&p.formula.indexOf("#REF!")!=-1&&(c=SocialCalc.coordToCr(k),v.AddUndo("set "+SocialCalc.rcColname(c.col-w)+(c.row-d)+" formula "+q)))):delete p.parseinfo;for(D in a.names)if(a.names[D])c=a.names[D].definition,k="",c.charAt(0)=="="&&(k="=",c=c.substring(1)),a.names[D].definition=k+SocialCalc.AdjustFormulaCoords(c,
n.col,w,n.row,d);for(q=r;q<=A-d&&e=="deleterow";q++)for(j in c=q+d,a.rowattribs)k=a.rowattribs[j][q],a.rowattribs[j][c]!=k&&(b&&v.AddUndo("set "+c+" "+j,a.rowattribs[j][c]),k?a.rowattribs[j][c]=k:delete a.rowattribs[j][c]);for(c=u;c<=g-w&&e=="deletecol";c++)for(j in q=SocialCalc.rcColname(c),p=SocialCalc.rcColname(c+w),a.colattribs)k=a.colattribs[j][q],a.colattribs[j][p]!=k&&(b&&v.AddUndo("set "+p+" "+j,a.colattribs[j][p]),k?a.colattribs[j][p]=k:delete a.colattribs[j][p]);if(b)if(e=="deletecol")for(c=
n.col;c<=s.col;c++)v.AddUndo("insertcol "+SocialCalc.rcColname(c));else for(q=n.row;q<=s.row;q++)v.AddUndo("insertrow "+q);if(e=="deletecol"){if(n.col<=g)s.col<=g?C.lastcol+=w:C.lastcol=n.col-1}else if(n.row<=A)s.row<=A?C.lastrow+=d:C.lastrow=n.row-1;C.needsrecalc="yes";break;case "movepaste":case "moveinsert":var l,H;a.renderneeded=!0;a.changedrendervalues=!0;b&&v.AddUndo("changedrendervalues");h=c.NextToken();p=c.NextToken();g=c.RestOfString();g==""&&(g="all");q();H=SocialCalc.coordToCr(p);w=H.col-
n.col;d=H.row-n.row;y=s.col-n.col+1;z=s.row-n.row+1;l={};for(q=n.row;q<=s.row;q++)for(c=n.col;c<=s.col;c++)if(k=SocialCalc.crToCoord(c,q),p=a.GetAssuredCell(k),b&&v.AddUndo("set "+k+" all",a.CellToString(p)),a.cells[k]){l[k]=new SocialCalc.Cell(k);for(j in A)typeof p[j]!==void 0&&(l[k][j]=p[j],g=="all"&&delete p[j],g=="formulas"&&(A[j]==1||A[j]==3)&&delete p[j],g=="formats"&&A[j]==2&&delete p[j]);if(g=="formulas")p.datavalue="",p.datatype=null,p.formula="",p.valuetype="b";g=="all"&&delete a.cells[k]}e==
"moveinsert"&&(r=u=!1,d==0&&(H.col<n.col||H.col>s.col)?H.col<n.col?(B=n.col-H.col,u=-1):(H.col-=1,w=H.col-s.col,B=H.col-s.col,u=1):w==0&&(H.row<n.row||H.row>s.row)?H.row<n.row?(B=n.row-H.row,r=-1):(H.row-=1,d=H.row-s.row,B=H.row-s.row,r=1):e="movepaste");e={};if(r)for(q=0;q<B;q++)for(c=n.col;c<=s.col;c++){r<0?(t=SocialCalc.crToCoord(c,H.row+B-q-1),k=SocialCalc.crToCoord(c,s.row-q)):(t=SocialCalc.crToCoord(c,H.row-B+q+1),k=SocialCalc.crToCoord(c,n.row+q));x=a.GetAssuredCell(t);b&&v.AddUndo("set "+
t+" all",a.CellToString(x));p=a.GetAssuredCell(k);if(g=="all"||g=="formats")for(j in A)A[j]!=1&&(typeof x[j]===void 0||A[j]==3?delete p[j]:p[j]=x[j]);if(g=="all"||g=="formulas")p.datavalue=x.datavalue,p.datatype=x.datatype,p.valuetype=x.valuetype,p.formula=x.formula,delete p.parseinfo,p.errors=x.errors;delete p.displaystring;e[t]=k}if(u)for(c=0;c<B;c++)for(q=n.row;q<=s.row;q++){u<0?(t=SocialCalc.crToCoord(H.col+B-c-1,q),k=SocialCalc.crToCoord(s.col-c,q)):(t=SocialCalc.crToCoord(H.col-B+c+1,q),k=SocialCalc.crToCoord(n.col+
c,q));x=a.GetAssuredCell(t);b&&v.AddUndo("set "+t+" all",a.CellToString(x));p=a.GetAssuredCell(k);if(g=="all"||g=="formats")for(j in A)A[j]!=1&&(typeof x[j]===void 0||A[j]==3?delete p[j]:p[j]=x[j]);if(g=="all"||g=="formulas")p.datavalue=x.datavalue,p.datatype=x.datatype,p.valuetype=x.valuetype,p.formula=x.formula,delete p.parseinfo,p.errors=x.errors;delete p.displaystring;e[t]=k}if(H.col+y-1>C.lastcol)C.lastcol=H.col+y-1;if(H.row+z-1>C.lastrow)C.lastrow=H.row+z-1;for(q=n.row;q<n.row+z;q++)for(c=n.col;c<
n.col+y;c++)if(k=SocialCalc.crToCoord(c+w,q+d),p=a.GetAssuredCell(k),b&&v.AddUndo("set "+k+" all",a.CellToString(p)),t=SocialCalc.crToCoord(c,q),e[t]=k,g=="all"&&!l[t])delete a.cells[k];else{(x=l[t])||(x=a.GetAssuredCell(t));if(g=="all"||g=="formats")for(j in A)A[j]!=1&&(typeof x[j]===void 0||A[j]==3?delete p[j]:p[j]=x[j]);if(g=="all"||g=="formulas")p.datavalue=x.datavalue,p.datatype=x.datatype,p.valuetype=x.valuetype,p.formula=x.formula,delete p.parseinfo,p.errors=x.errors,x.comment?p.comment=x.comment:
p.comment&&delete p.comment;delete p.displaystring}for(k in a.cells)if(p=a.cells[k])p.datatype=="f"?(q=p.formula,p.formula=SocialCalc.ReplaceFormulaCoords(q,e),p.formula!=q&&(delete p.parseinfo,b&&!e[k]&&v.AddUndo("set "+k+" formula "+q))):delete p.parseinfo;for(D in a.names)if(a.names[D])q=c=a.names[D].definition,k="",c.charAt(0)=="="&&(k="=",c=c.substring(1)),a.names[D].definition=k+SocialCalc.ReplaceFormulaCoords(c,e),b&&a.names[D].definition!=q&&v.AddUndo("name define "+D+" "+q);C.needsrecalc=
"yes";break;case "name":h=c.NextToken();D=c.NextToken();g=c.RestOfString();D=D.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");if(D=="")break;if(h=="define"){if(g=="")break;a.names[D]?(b&&v.AddUndo("name define "+D+" "+a.names[D].definition),a.names[D].definition=g):(b&&v.AddUndo("name delete "+D),a.names[D]={definition:g,desc:""})}else if(h=="desc"){if(a.names[D])b&&v.AddUndo("name desc "+D+" "+a.names[D].desc),a.names[D].desc=g}else h=="delete"&&(b&&(a.names[D].desc&&v.AddUndo("name desc "+D+" "+a.names[D].desc),
v.AddUndo("name define "+D+" "+a.names[D].definition)),delete a.names[D]);C.needsrecalc="yes";break;case "recalc":C.needsrecalc="yes";a.recalconce=!0;break;case "redisplay":a.renderneeded=!0;break;case "changedrendervalues":a.changedrendervalues=!0;break;case "startcmdextension":D=c.NextToken();(v=SocialCalc.SheetCommandInfo.CmdExtensionCallbacks[D])&&v.func(D,v.data,a,c,b);break;default:m=w.s_escUnknownCmd+d}return m};
SocialCalc.SheetUndo=function(a){var c,b=a.changes.TOS(),d="";for(c=b?b.undo.length-1:-1;c>=0;c--)d&&(d+="\n"),d+=b.undo[c];a.changes.Undo();a.ScheduleSheetCommands(d,!1)};SocialCalc.SheetRedo=function(a){var c,b;if(a.changes.Redo()){c=a.changes.TOS();var d="";for(b=0;c&&b<c.command.length;b++)d&&(d+="\n"),d+=c.command[b];a.ScheduleSheetCommands(d,!1)}else a.ScheduleSheetCommands("",!1)};
SocialCalc.CreateAuditString=function(a){for(var c,b="",d=a.changes.stack,e=a.changes.tos,a=0;a<=e;a++)for(c=0;c<d[a].command.length;c++)b+=d[a].command[c]+"\n";return b};SocialCalc.GetStyleNum=function(a,c,b){var d;if(b.length==0)return 0;d=a[c+"hash"][b];if(!d)a[c+"s"].length<1&&a[c+"s"].push(""),d=a[c+"s"].push(b)-1,a[c+"hash"][b]=d,a.changedrendervalues=!0;return d};SocialCalc.GetStyleString=function(a,c,b){return!b?null:a[c+"s"][b]};
SocialCalc.OffsetFormulaCoords=function(a,c,b){var d,e,g,h,j="";d=SocialCalc.Formula;if(!d)return"Need SocialCalc.Formula";var k=d.TokenType,m=k.op,n=k.string,k=k.coord,s=d.TokenOpExpansion,a=d.ParseFormulaIntoTokens(a);for(g=0;g<a.length;g++)if(e=a[g].type,d=a[g].text,e==k){h="";e=SocialCalc.coordToCr(d);d.charAt(0)!="$"?e.col+=c:h+="$";h+=SocialCalc.rcColname(e.col);d.indexOf("$",1)==-1?e.row+=b:h+="$";h+=e.row;if(e.row<1||e.col<1)h="#REF!";j+=h}else j+=e==n?d.indexOf('"')>=0?'"'+d.replace(/"/,
'""')+'"':'"'+d+'"':e==m?s[d]||d:d;return j};
SocialCalc.AdjustFormulaCoords=function(a,c,b,d,e){var g,h,j="",k=!1,m=SocialCalc.Formula;if(!m)return"Need SocialCalc.Formula";var n=m.TokenType,s=n.op,q=n.string,n=n.coord,m=m.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(a);for(h=0;h<parseinfo.length;h++){g=parseinfo[h].type;a=parseinfo[h].text;g==s&&(a=="!"?k=!0:a!=":"&&(k=!1),a=m[a]||a);if(g==n){cr=SocialCalc.coordToCr(a);if((b<0&&cr.col>=c&&cr.col<c-b||e<0&&cr.row>=d&&cr.row<d-e)&&!k)cr.col=0,cr.row=0;k||(cr.col>=c&&(cr.col+=
b),cr.row>=d&&(cr.row+=e));g=a.charAt(0)=="$"?"$"+SocialCalc.rcColname(cr.col):SocialCalc.rcColname(cr.col);g+=a.indexOf("$",1)!=-1?"$"+cr.row:cr.row;if(cr.row<1||cr.col<1)g="#REF!";a=g}else g==q&&(a=a.indexOf('"')>=0?'"'+a.replace(/"/,'""')+'"':'"'+a+'"');j+=a}return j};
SocialCalc.ReplaceFormulaCoords=function(a,c){var b,d,e,g="",h=!1;d=SocialCalc.Formula;if(!d)return"Need SocialCalc.Formula";var j=d.TokenType,k=j.op,m=j.string,j=j.coord,n=d.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(a);for(e=0;e<parseinfo.length;e++)b=parseinfo[e].type,d=parseinfo[e].text,b==k&&(d=="!"?h=!0:d!=":"&&(h=!1),d=n[d]||d),b==j?(cr=SocialCalc.coordToCr(d),b=SocialCalc.crToCoord(cr.col,cr.row),c[b]&&!h&&(cr=SocialCalc.coordToCr(c[b]),b=d.charAt(0)=="$"?"$"+SocialCalc.rcColname(cr.col):
SocialCalc.rcColname(cr.col),b+=d.indexOf("$",1)!=-1?"$"+cr.row:cr.row,d=b)):b==m&&(d=d.indexOf('"')>=0?'"'+d.replace(/"/,'""')+'"':'"'+d+'"'),g+=d;return g};SocialCalc.RecalcInfo={sheet:null,currentState:0,state:{start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,LoadSheet:function(){return!1}};
SocialCalc.RecalcData=function(){this.inrecalc=!0;this.celllist=[];this.celllistitem=0;this.calclist=null;this.calclistlength=0;this.nextcalc=this.lastcalc=this.firstcalc=null;this.count=0;this.checkinfo={}};SocialCalc.RecalcCheckInfo=function(){this.oldcoord=null;this.parsepos=0;this.inrangestart=this.inrange=!1;this.r=this.c=this.r2=this.r1=this.c2=this.c1=this.cr2=this.cr1=null};
SocialCalc.RecalcSheet=function(a){var c=SocialCalc.RecalcInfo;delete a.attribs.circularreferencecell;SocialCalc.Formula.FreshnessInfoReset();SocialCalc.RecalcClearTimeout();c.sheet=a;c.currentState=c.state.start_calc;c.starttime=new Date;a.statuscallback&&a.statuscallback(c,"calcstart",null,a.statuscallbackparams);SocialCalc.RecalcSetTimeout()};SocialCalc.RecalcSetTimeout=function(){var a=SocialCalc.RecalcInfo;a.recalctimer=window.setTimeout(SocialCalc.RecalcTimerRoutine,a.timeslicedelay)};
SocialCalc.RecalcClearTimeout=function(){var a=SocialCalc.RecalcInfo;if(a.recalctimer)window.clearTimeout(a.recalctimer),a.recalctimer=null};SocialCalc.RecalcLoadedSheet=function(a,c,b){var d=SocialCalc.RecalcInfo,e=SocialCalc.Formula,a=SocialCalc.Formula.AddSheetToCache(a||e.SheetCache.waitingForLoading,c);if(b&&a&&a.attribs.recalc!="off")a.previousrecalcsheet=d.sheet,d.sheet=a,d.currentState=d.state.start_calc;e.SheetCache.waitingForLoading=null;SocialCalc.RecalcSetTimeout()};
SocialCalc.RecalcTimerRoutine=function(){var a,c,b,d=new Date,e=0,g=SocialCalc.Formula;if(!g)return"Need SocialCalc.Formula";var h=SocialCalc.RecalcInfo,j=h.sheet;if(j){var k=j.recalcdata,m=function(a,c){j.statuscallback&&j.statuscallback(k,a,c,j.statuscallbackparams)};SocialCalc.RecalcClearTimeout();if(h.currentState==h.state.start_calc){k=new SocialCalc.RecalcData;j.recalcdata=k;for(b in j.cells)b&&k.celllist.push(b);k.calclist={};h.currentState=h.state.order}if(h.currentState==h.state.order){for(;k.celllistitem<
k.celllist.length;)if(b=k.celllist[k.celllistitem++],SocialCalc.RecalcCheckCell(j,b),new Date-d>=h.maxtimeslice){m("calcorder",{coord:b,total:k.celllist.length,count:k.celllistitem});SocialCalc.RecalcSetTimeout();return}m("calccheckdone",k.calclistlength);k.nextcalc=k.firstcalc;h.currentState=h.state.calc;SocialCalc.RecalcSetTimeout()}else if(h.currentState==h.state.start_wait){h.currentState=h.state.done_wait;if(h.LoadSheet&&(a=h.LoadSheet(g.SheetCache.waitingForLoading)))return;SocialCalc.RecalcLoadedSheet(null,
"",!1)}else if(h.currentState==h.state.done_wait)h.currentState=h.state.calc,SocialCalc.RecalcSetTimeout();else{h.currentState!=h.state.calc&&alert("Recalc state error: "+h.currentState+". Error in SocialCalc code.");for(b=j.recalcdata.nextcalc;b;){c=j.cells[b];a=g.evaluate_parsed_formula(c.parseinfo,j,!1);if(g.SheetCache.waitingForLoading){k.nextcalc=b;k.count+=e;m("calcloading",{sheetname:g.SheetCache.waitingForLoading});h.currentState=h.state.start_wait;SocialCalc.RecalcSetTimeout();return}if(g.RemoteFunctionInfo.waitingForServer){k.nextcalc=
b;k.count+=e;m("calcserverfunc",{funcname:g.RemoteFunctionInfo.waitingForServer,coord:b,total:k.calclistlength,count:k.count});h.currentState=h.state.done_wait;return}if(c.datavalue!=a.value||c.valuetype!=a.type)c.datavalue=a.value,c.valuetype=a.type,delete c.displaystring,j.recalcchangedavalue=!0;if(a.error)c.errors=a.error;e++;b=j.recalcdata.calclist[b];if(new Date-d>=h.maxtimeslice){k.nextcalc=b;k.count+=e;m("calcstep",{coord:b,total:k.calclistlength,count:k.count});SocialCalc.RecalcSetTimeout();
return}}k.inrecalc=!1;delete j.recalcdata;delete j.attribs.needsrecalc;h.sheet=j.previousrecalcsheet||null;h.sheet?(h.currentState=h.state.calc,SocialCalc.RecalcSetTimeout()):(g.FreshnessInfo.recalc_completed=!0,m("calcfinished",new Date-h.starttime))}}};
SocialCalc.RecalcCheckCell=function(a,c){var b,d,e,g,h,j,k,m,n=SocialCalc.Formula;if(!n)return"Need SocialCalc.Formula";g=n.TokenType;var s=g.op,q=g.name,p=g.coord,r=a.recalcdata,u=r.checkinfo,t=!1,w=null,x=c;a:for(;x;)if(k=a.cells[x],m=u[x],!k||k.datatype!="f"||m&&typeof m!="object"){if(x=w,u[x])w=u[x].oldcoord}else{m||(m=new SocialCalc.RecalcCheckInfo,u[x]=m);k.errors&&delete k.errors;if(!k.parseinfo)k.parseinfo=n.ParseFormulaIntoTokens(k.formula);b=k.parseinfo;for(g=m.parsepos;g<b.length;g++){if(m.inrange){if(m.inrangestart)m.cr1.col>
m.cr2.col?(m.c1=m.cr2.col,m.c2=m.cr1.col):(m.c1=m.cr1.col,m.c2=m.cr2.col),m.c=m.c1-1,m.cr1.row>m.cr2.row?(m.r1=m.cr2.row,m.r2=m.cr1.row):(m.r1=m.cr1.row,m.r2=m.cr2.row),m.r=m.r1,m.inrangestart=!1;m.c+=1;if(m.c>m.c2){m.r+=1;if(m.r>m.r2){m.inrange=!1;continue}m.c=m.c1}b=SocialCalc.crToCoord(m.c,m.r);m.parsepos=g;m.oldcoord=w;w=x;x=b;if(u[x]&&typeof u[x]=="object")return k.errors=SocialCalc.Constants.s_caccCircRef+c,u[c]=!0,r.firstcalc?r.calclist[r.lastcalc]=c:r.firstcalc=c,r.lastcalc=c,r.calclistlength++,
a.attribs.circularreferencecell=x+"|"+w,k.errors;continue a}e=b[g].type;d=b[g].text;e==s&&(d=="!"?t=!0:d!=":"&&(t=!1));if(e==q)if(h=n.LookupName(a,d),h.type=="range"){if(j=h.value.indexOf("|"),j!=-1){m.cr1=SocialCalc.coordToCr(h.value.substring(0,j));d=h.value.indexOf("|",j+1);m.cr2=SocialCalc.coordToCr(h.value.substring(j+1,d));m.inrange=!0;m.inrangestart=!0;g-=1;continue}}else if(h.type=="coord")e=p,d=h.value;if(e==p)if(g>=2&&b[g-1].type==s&&b[g-1].text==":"&&b[g-2].type==p&&!t)m.cr1=SocialCalc.coordToCr(b[g-
2].text),m.cr2=SocialCalc.coordToCr(d),m.inrange=!0,m.inrangestart=!0,g-=1;else if(!t){d.indexOf("$")!=-1&&(d=d.replace(/\$/g,""));m.parsepos=g+1;m.oldcoord=w;w=x;x=d;if(u[x]&&typeof u[x]=="object")return k.errors=SocialCalc.Constants.s_caccCircRef+c,u[c]=!0,r.firstcalc?r.calclist[r.lastcalc]=c:r.firstcalc=c,r.lastcalc=c,r.calclistlength++,a.attribs.circularreferencecell=x+"|"+w,k.errors;continue a}}t=!1;u[x]=!0;r.firstcalc?r.calclist[r.lastcalc]=x:r.firstcalc=x;r.lastcalc=x;r.calclistlength++;x=
w;w=u[x]?u[x].oldcoord:null}return""};SocialCalc.Parse=function(a){this.str=a;this.pos=0;this.delimiter=" ";this.lineEnd=a.indexOf("\n");if(this.lineEnd<0)this.lineEnd=a.length};SocialCalc.Parse.prototype.NextToken=function(){if(this.pos<0)return"";var a=this.str.indexOf(this.delimiter,this.pos),c=this.pos;if(a>this.lineEnd)a=this.lineEnd;return a>=0?(this.pos=a+1,this.str.substring(c,a)):(this.pos=this.lineEnd,this.str.substring(c,this.lineEnd))};
SocialCalc.Parse.prototype.RestOfString=function(){var a=this.pos;if(this.pos<0||this.pos>=this.lineEnd)return"";this.pos=this.lineEnd;return this.str.substring(a,this.lineEnd)};SocialCalc.Parse.prototype.RestOfStringNoMove=function(){return this.pos<0||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)};SocialCalc.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1;this.lineEnd=this.str.indexOf("\n",this.pos);if(this.lineEnd<0)this.lineEnd=this.str.length};
SocialCalc.Parse.prototype.EOF=function(){return this.pos<0||this.pos>=this.str.length?!0:!1};SocialCalc.UndoStack=function(){this.stack=[];this.tos=-1;this.maxRedo=0;this.maxUndo=50};
SocialCalc.UndoStack.prototype.PushChange=function(a){for(;this.stack.length>0&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:a,undo:[]});this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift();if(this.maxUndo&&this.stack.length>this.maxUndo)this.stack[this.stack.length-this.maxUndo-1].undo=[];this.tos=this.stack.length-1};
SocialCalc.UndoStack.prototype.AddDo=function(){for(var a=[],c=0;c<arguments.length;c++)arguments[c]!=null&&a.push(arguments[c]);this.stack[this.stack.length-1].command.push(a.join(" "))};SocialCalc.UndoStack.prototype.AddUndo=function(){for(var a=[],c=0;c<arguments.length;c++)arguments[c]!=null&&a.push(arguments[c]);this.stack[this.stack.length-1].undo.push(a.join(" "))};SocialCalc.UndoStack.prototype.TOS=function(){return this.tos>=0?this.stack[this.tos]:null};
SocialCalc.UndoStack.prototype.Undo=function(){return this.tos>=0&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)?(this.tos-=1,!0):!1};SocialCalc.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1?(this.tos+=1,!0):!1};SocialCalc.Clipboard={clipboard:""};
SocialCalc.RenderContext=function(a){var c=a.attribs,b=SocialCalc.Constants;this.sheetobj=a;this.showRCHeaders=this.showGrid=this.hideRowsCols=!1;this.rownamewidth=b.defaultRowNameWidth;this.pixelsPerRow=b.defaultAssumedRowHeight;this.cellskip={};this.coordToCR={};this.colwidth=[];this.totalwidth=0;this.rowpanes=[];this.colpanes=[];this.maxrow=this.maxcol=0;this.highlights={};this.cursorsuffix="";this.highlightTypes={cursor:{style:b.defaultHighlightTypeCursorStyle,className:b.defaultHighlightTypeCursorClass},
range:{style:b.defaultHighlightTypeRangeStyle,className:b.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+b.defaultImagePrefix+"cursorinsertup.gif);",className:b.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+b.defaultImagePrefix+"cursorinsertleft.gif);",className:b.defaultHighlightTypeCursorClass},
range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+b.defaultImagePrefix+"range2.gif);",className:""}};this.cellIDprefix=b.defaultCellIDPrefix;this.defaultlinkstyle=null;this.defaultHTMLlinkstyle={type:"html"};this.defaultfontstyle=b.defaultCellFontStyle;this.defaultfontsize=b.defaultCellFontSize;this.defaultfontfamily=b.defaultCellFontFamily;this.defaultlayout=b.defaultCellLayout;this.defaultpanedividerwidth=b.defaultPaneDividerWidth;this.defaultpanedividerheight=b.defaultPaneDividerHeight;
this.gridCSS=b.defaultGridCSS;this.commentClassName=b.defaultCommentClass;this.commentCSS=b.defaultCommentStyle;this.commentNoGridClassName=b.defaultCommentNoGridClass;this.commentNoGridCSS=b.defaultCommentNoGridStyle;this.classnames={colname:b.defaultColnameClass,rowname:b.defaultRownameClass,selectedcolname:b.defaultSelectedColnameClass,selectedrowname:b.defaultSelectedRownameClass,upperleft:b.defaultUpperLeftClass,skippedcell:b.defaultSkippedCellClass,panedivider:b.defaultPaneDividerClass};this.explicitStyles=
{colname:b.defaultColnameStyle,rowname:b.defaultRownameStyle,selectedcolname:b.defaultSelectedColnameStyle,selectedrowname:b.defaultSelectedRownameStyle,upperleft:b.defaultUpperLeftStyle,skippedcell:b.defaultSkippedCellStyle,panedivider:b.defaultPaneDividerStyle};this.cellskip=null;this.needcellskip=!0;this.fonts=[];this.layouts=[];this.needprecompute=!0;if(a)this.rowpanes[0]={first:1,last:c.lastrow},this.colpanes[0]={first:1,last:c.lastcol};else throw b.s_rcMissingSheet;};
SocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){SocialCalc.PrecomputeSheetFontsAndLayouts(this)};SocialCalc.RenderContext.prototype.CalculateCellSkipData=function(){SocialCalc.CalculateCellSkipData(this)};SocialCalc.RenderContext.prototype.CalculateColWidthData=function(){SocialCalc.CalculateColWidthData(this)};SocialCalc.RenderContext.prototype.SetRowPaneFirstLast=function(a,c,b){this.rowpanes[a]={first:c,last:b}};
SocialCalc.RenderContext.prototype.SetColPaneFirstLast=function(a,c,b){this.colpanes[a]={first:c,last:b}};SocialCalc.RenderContext.prototype.CoordInPane=function(a,c,b){return SocialCalc.CoordInPane(this,a,c,b)};SocialCalc.RenderContext.prototype.CellInPane=function(a,c,b,d){return SocialCalc.CellInPane(this,a,c,b,d)};SocialCalc.RenderContext.prototype.InitializeTable=function(a){SocialCalc.InitializeTable(this,a)};
SocialCalc.RenderContext.prototype.RenderSheet=function(a,c){return SocialCalc.RenderSheet(this,a,c)};SocialCalc.RenderContext.prototype.RenderColGroup=function(){return SocialCalc.RenderColGroup(this)};SocialCalc.RenderContext.prototype.RenderColHeaders=function(){return SocialCalc.RenderColHeaders(this)};SocialCalc.RenderContext.prototype.RenderSizingRow=function(){return SocialCalc.RenderSizingRow(this)};
SocialCalc.RenderContext.prototype.RenderRow=function(a,c,b){return SocialCalc.RenderRow(this,a,c,b)};SocialCalc.RenderContext.prototype.RenderSpacingRow=function(){return SocialCalc.RenderSpacingRow(this)};SocialCalc.RenderContext.prototype.RenderCell=function(a,c,b,d,e,g){return SocialCalc.RenderCell(this,a,c,b,d,e,g)};
SocialCalc.PrecomputeSheetFontsAndLayouts=function(a){var c,b,d,e,g,h,j=a.sheetobj;e=j.attribs;if(e.defaultfont)c=j.fonts[e.defaultfont],c=c.replace(/^\*/,SocialCalc.Constants.defaultCellFontStyle),c=c.replace(/(.+)\*(.+)/,"$1"+SocialCalc.Constants.defaultCellFontSize+"$2"),c=c.replace(/\*$/,SocialCalc.Constants.defaultCellFontFamily),b=c.match(/^(\S+? \S+?) (\S+?) (\S.*)$/),a.defaultfontstyle=b[1],a.defaultfontsize=b[2],a.defaultfontfamily=b[3];for(g=1;g<j.fonts.length;g++)b=j.fonts[g],b=b.replace(/^\*/,
a.defaultfontstyle),b=b.replace(/(.+)\*(.+)/,"$1"+a.defaultfontsize+"$2"),b=b.replace(/\*$/,a.defaultfontfamily),b=b.match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/),a.fonts[g]={style:b[1],weight:b[2],size:b[3],family:b[4]};c=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/;d=SocialCalc.Constants.defaultCellLayout.match(c);e=e.defaultlayout?j.layouts[e.defaultlayout].match(c):["","*","*","*","*","*"];for(g=1;g<j.layouts.length;g++){b=j.layouts[g];b=b.match(c);for(h=1;h<=5;h++)b[h]=="*"&&
(b[h]=e[h]!="*"?e[h]:d[h]);a.layouts[g]="padding:"+b[1]+" "+b[2]+" "+b[3]+" "+b[4]+";vertical-align:"+b[5]+";"}a.needprecompute=!1};
SocialCalc.CalculateCellSkipData=function(a){var c,b,d,e,g,h,j,k,m=a.sheetobj;a.maxrow=0;a.maxcol=0;a.cellskip={};for(c=1;c<=m.attribs.lastrow;c++)for(b=1;b<=m.attribs.lastcol;b++)if(d=SocialCalc.crToCoord(b,c),e=m.cells[d],!(e===void 0||a.cellskip[d]))if(g=e.colspan||1,e=e.rowspan||1,g>1||e>1)for(h=c;h<c+e;h++)for(j=b;j<b+g;j++)k=SocialCalc.crToCoord(j,h),k==d?a.coordToCR[d]={row:c,col:b}:a.cellskip[k]=d,h>a.maxrow&&(maxrow=h),j>a.maxcol&&(maxcol=j);a.needcellskip=!1};
SocialCalc.CalculateColWidthData=function(a){var c,b,d,e=a.sheetobj;d=a.showRCHeaders?a.rownamewidth-0:0;for(colpane=0;colpane<a.colpanes.length;colpane++)for(c=a.colpanes[colpane].first;c<=a.colpanes[colpane].last;c++){b=SocialCalc.rcColname(c);b=e.colattribs.width[b]||e.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(b=="blank"||b=="auto")b="";a.colwidth[c]=b+"";d+=b&&b-0>0?b-0:10}a.totalwidth=d};
SocialCalc.InitializeTable=function(a,c){c.style.borderCollapse="collapse";c.cellSpacing="0";c.cellPadding="0";c.style.width=a.totalwidth+"px"};
SocialCalc.RenderSheet=function(a,c,b){var d,e,g,h;if(a.sheetobj.changedrendervalues)a.needcellskip=!0,a.needprecompute=!0,a.sheetobj.changedrendervalues=!1;a.needcellskip&&a.CalculateCellSkipData();a.needprecompute&&a.PrecomputeSheetFontsAndLayouts();a.CalculateColWidthData();g=document.createElement("table");a.InitializeTable(g);d=a.RenderColGroup();g.appendChild(d);h=document.createElement("tbody");h.appendChild(a.RenderSizingRow());a.showRCHeaders&&(d=a.RenderColHeaders())&&h.appendChild(d);for(e=
0;e<a.rowpanes.length;e++){for(rownum=a.rowpanes[e].first;rownum<=a.rowpanes[e].last;rownum++)d=a.RenderRow(rownum,e,b),h.appendChild(d);e<a.rowpanes.length-1&&(d=a.RenderSpacingRow(),h.appendChild(d))}g.appendChild(h);if(c)(a=c.parentNode)&&a.replaceChild(g,c);return g};
SocialCalc.RenderRow=function(a,c,b,d){var e=document.createElement("tr"),g,h,j;if(a.showRCHeaders){h=document.createElement("td");if(a.classnames)h.className=a.classnames.rowname;if(a.explicitStyles)h.style.cssText=a.explicitStyles.rowname;h.width=a.rownamewidth;h.style.verticalAlign="top";h.innerHTML=c+"";e.appendChild(h)}for(j=0;j<a.colpanes.length;j++){for(g=a.colpanes[j].first;g<=a.colpanes[j].last;g++)(h=a.RenderCell(c,g,b,j,null,d))&&e.appendChild(h);if(j<a.colpanes.length-1){h=document.createElement("td");
h.width=a.defaultpanedividerwidth;if(a.classnames.panedivider)h.className=a.classnames.panedivider;if(a.explicitStyles.panedivider)h.style.cssText=a.explicitStyles.panedivider;g=document.createElement("div");g.style.width=a.defaultpanedividerwidth+"px";g.style.overflow="hidden";h.appendChild(g);e.appendChild(h)}}return e};
SocialCalc.RenderSpacingRow=function(a){var c,b,d,e,g=document.createElement("tr");if(a.showRCHeaders){b=document.createElement("td");b.width=a.rownamewidth;b.height=a.defaultpanedividerheight;if(a.classnames.panedivider)b.className=a.classnames.panedivider;if(a.explicitStyles.panedivider)b.style.cssText=a.explicitStyles.panedivider;g.appendChild(b)}for(d=0;d<a.colpanes.length;d++){for(c=a.colpanes[d].first;c<=a.colpanes[d].last;c++){b=document.createElement("td");if(e=a.colwidth[c])b.width=e;b.height=
a.defaultpanedividerheight;if(a.classnames.panedivider)b.className=a.classnames.panedivider;if(a.explicitStyles.panedivider)b.style.cssText=a.explicitStyles.panedivider;b&&g.appendChild(b)}if(d<a.colpanes.length-1){b=document.createElement("td");b.width=a.defaultpanedividerwidth;b.height=a.defaultpanedividerheight;if(a.classnames.panedivider)b.className=a.classnames.panedivider;if(a.explicitStyles.panedivider)b.style.cssText=a.explicitStyles.panedivider;g.appendChild(b)}}return g};
SocialCalc.RenderColHeaders=function(a){var c=document.createElement("tr"),b,d;if(!a.showRCHeaders)return null;d=document.createElement("td");if(a.classnames)d.className=a.classnames.upperleft;if(a.explicitStyles)d.style.cssText=a.explicitStyles.upperleft;d.width=a.rownamewidth;c.appendChild(d);for(colpane=0;colpane<a.colpanes.length;colpane++){for(b=a.colpanes[colpane].first;b<=a.colpanes[colpane].last;b++){d=document.createElement("td");if(a.classnames)d.className=a.classnames.colname;if(a.explicitStyles)d.style.cssText=
a.explicitStyles.colname;d.innerHTML=SocialCalc.rcColname(b);c.appendChild(d)}if(colpane<a.colpanes.length-1){d=document.createElement("td");d.width=a.defaultpanedividerwidth;if(a.classnames.panedivider)d.className=a.classnames.panedivider;if(a.explicitStyles.panedivider)d.style.cssText=a.explicitStyles.panedivider;c.appendChild(d)}}return c};
SocialCalc.RenderColGroup=function(a){var c,b,d,e,g=document.createElement("colgroup");if(a.showRCHeaders)d=document.createElement("col"),d.width=a.rownamewidth,g.appendChild(d);for(c=0;c<a.colpanes.length;c++){for(b=a.colpanes[c].first;b<=a.colpanes[c].last;b++){d=document.createElement("col");if(e=a.colwidth[b])d.width=e;g.appendChild(d)}if(c<a.colpanes.length-1)d=document.createElement("col"),d.width=a.defaultpanedividerwidth,g.appendChild(d)}return g};
SocialCalc.RenderSizingRow=function(a){var c,b,d,e,g=document.createElement("tr");if(a.showRCHeaders)d=document.createElement("td"),d.style.width=a.rownamewidth+"px",d.height="1",g.appendChild(d);for(c=0;c<a.colpanes.length;c++){for(b=a.colpanes[c].first;b<=a.colpanes[c].last;b++){d=document.createElement("td");if(e=a.colwidth[b])d.width=e;d.height="1";g.appendChild(d)}if(c<a.colpanes.length-1)d=document.createElement("td"),d.width=a.defaultpanedividerwidth,d.height="1",g.appendChild(d)}return g};
SocialCalc.RenderCell=function(a,c,b,d,e,g,h){var j=a.sheetobj,k,m,n,s,q="";c-=0;b-=0;var p=SocialCalc.crToCoord(b,c);if(a.cellskip[p]){if(a.CoordInPane(a.cellskip[p],d,e))return null;g=g?SocialCalc.CreatePseudoElement():document.createElement("td");if(a.classnames.skippedcell)g.className=a.classnames.skippedcell;if(a.explicitStyles.skippedcell)g.style.cssText=a.explicitStyles.skippedcell;g.innerHTML="&nbsp;";return g}g=g?SocialCalc.CreatePseudoElement():document.createElement("td");if(a.cellIDprefix)g.id=
a.cellIDprefix+p;(n=j.cells[p])||(n=new SocialCalc.Cell(p));s=j.attribs;scc=SocialCalc.Constants;if(n.colspan>1){for(k=m=1;k<n.colspan;k++)j.colattribs.hide[SocialCalc.rcColname(b+k)]!="yes"&&a.CellInPane(c,b+k,d,e)&&m++;g.colSpan=m}if(n.rowspan>1){for(k=m=1;k<n.rowspan;k++)j.rowattribs.hide[c+k+""]!="yes"&&a.CellInPane(c+k,b,d,e)&&m++;g.rowSpan=m}if(n.displaystring==void 0)n.displaystring=SocialCalc.FormatValueForDisplay(j,n.datavalue,p,h||a.defaultlinkstyle);g.innerHTML=n.displaystring;k=n.layout||
s.defaultlayout;q+=k?a.layouts[k]:scc.defaultCellLayout;(k=n.font||s.defaultfont)?(h=a.fonts[k],q+="font-style:"+h.style+";font-weight:"+h.weight+";font-size:"+h.size+";font-family:"+h.family+";"):(scc.defaultCellFontSize&&(q+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(q+="font-family:"+scc.defaultCellFontFamily+";"));(k=n.color||s.defaultcolor)&&(q+="color:"+j.colors[k]+";");(k=n.bgcolor||s.defaultbgcolor)&&(q+="background-color:"+j.colors[k]+";");(k=n.cellformat)?q+="text-align:"+
j.cellformats[k]+";":(h=n.valuetype.charAt(0),h=="t"?(k=s.defaulttextformat)&&(q+="text-align:"+j.cellformats[k]+";"):h=="n"?(k=s.defaultnontextformat,q+=k?"text-align:"+j.cellformats[k]+";":"text-align:right;"):q+="text-align:left;");(k=n.bt)&&(q+="border-top:"+j.borderstyles[k]+";");if(k=n.br)q+="border-right:"+j.borderstyles[k]+";";else if(a.showGrid&&(h=a.CellInPane(c,b+(n.colspan||1),d,e)?SocialCalc.crToCoord(b+(n.colspan||1),c):"nomatch",a.cellskip[h]&&(h=a.cellskip[h]),!j.cells[h]||!j.cells[h].bl))q+=
"border-right:"+a.gridCSS;if(k=n.bb)q+="border-bottom:"+j.borderstyles[k]+";";else if(a.showGrid&&(h=a.CellInPane(c+(n.rowspan||1),b,d,e)?SocialCalc.crToCoord(b,c+(n.rowspan||1)):"nomatch",a.cellskip[h]&&(h=a.cellskip[h]),!j.cells[h]||!j.cells[h].bt))q+="border-bottom:"+a.gridCSS;(k=n.bl)&&(q+="border-left:"+j.borderstyles[k]+";");if(n.comment)if(a.showGrid){if(a.commentClassName)g.className=(g.className?g.className+" ":"")+a.commentClassName;q+=a.commentCSS}else{if(a.commentNoGridClassName)g.className=
(g.className?g.className+" ":"")+a.commentNoGridClassName;q+=a.commentNoGridCSS}g.style.cssText=q;if(h=a.highlights[p]){h=="cursor"&&(h+=a.cursorsuffix);if(a.highlightTypes[h].className)g.className=(g.className?g.className+" ":"")+a.highlightTypes[h].className;SocialCalc.setStyles(g,a.highlightTypes[h].style)}return g};SocialCalc.CoordInPane=function(a,c,b,d){var e=a.coordToCR[c];if(!e||!e.row||!e.col)throw"Bad coordToCR for "+c;return a.CellInPane(e.row,e.col,b,d)};
SocialCalc.CellInPane=function(a,c,b,d,e){var g=a.rowpanes[d],a=a.colpanes[e];if(!g||!a)throw"CellInPane called with unknown panes "+d+"/"+e;return c<g.first||c>g.last?!1:b<a.first||b>a.last?!1:!0};SocialCalc.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}};SocialCalc.rcColname=function(a){a>702&&(a=702);a<1&&(a=1);var c=(a-1)%26+65;return(a=Math.floor((a-1)/26))?String.fromCharCode(a+64)+String.fromCharCode(c):String.fromCharCode(c)};
SocialCalc.letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];SocialCalc.crToCoord=function(a,c){a<1&&(a=1);a>702&&(a=702);c<1&&(c=1);var b=(a-1)%26,d=Math.floor((a-1)/26);return d?SocialCalc.letters[d-1]+SocialCalc.letters[b]+c:SocialCalc.letters[b]+c};SocialCalc.coordToCol={};SocialCalc.coordToRow={};
SocialCalc.coordToCr=function(a){var c,b,d,e=SocialCalc.coordToRow[a];if(e)return{row:e,col:SocialCalc.coordToCol[a]};for(b=e=c=0;b<a.length;b++)d=a.charCodeAt(b),d!=36&&(d<=57?e=10*e+d-48:d>=97?c=26*c+d-96:d>=65&&(c=26*c+d-64));SocialCalc.coordToCol[a]=c;SocialCalc.coordToRow[a]=e;return{row:e,col:c}};
SocialCalc.ParseRange=function(a){var c,b,d;a||(a="A1:A1");a=a.toUpperCase();c=a.indexOf(":");c>=0?(b=a.substring(0,c),d=SocialCalc.coordToCr(b),d.coord=b,b=a.substring(c+1),c=SocialCalc.coordToCr(b),c.coord=b):(d=SocialCalc.coordToCr(a),d.coord=a,c=SocialCalc.coordToCr(a),c.coord=a);return{cr1:d,cr2:c}};SocialCalc.decodeFromSave=function(a){if(typeof a!="string")return a;if(a.indexOf("\\")==-1)return a;a=a.replace(/\\c/g,":");a=a.replace(/\\n/g,"\n");return a.replace(/\\b/g,"\\")};
SocialCalc.decodeFromAjax=function(a){if(typeof a!="string")return a;if(a.indexOf("\\")==-1)return a;a=a.replace(/\\c/g,":");a=a.replace(/\\n/g,"\n");a=a.replace(/\\e/g,"]]");return a.replace(/\\b/g,"\\")};SocialCalc.encodeForSave=function(a){if(typeof a!="string")return a;a.indexOf("\\")!=-1&&(a=a.replace(/\\/g,"\\b"));a.indexOf(":")!=-1&&(a=a.replace(/:/g,"\\c"));a.indexOf("\n")!=-1&&(a=a.replace(/\n/g,"\\n"));return a};
SocialCalc.special_chars=function(a){/[&<>"]/.test(a)&&(a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;"));return a};SocialCalc.Lookup=function(a,c){for(i=0;i<c.length;i++)if(c[i]>a)return i>0?i-1:null;return c.length-1};SocialCalc.setStyles=function(a,c){var b,d,e,g;if(c){b=c.split(";");for(d=0;d<b.length;d++)e=b[d].indexOf(":"),e!=-1&&(g=b[d].substring(0,e),e=b[d].substring(e+1),g&&e&&(a.style[g]=e))}};
SocialCalc.GetViewportInfo=function(){var a={};if(window.innerWidth)a.width=window.innerWidth,a.height=window.innerHeight,a.horizontalScroll=window.pageXOffset,a.verticalScroll=window.pageYOffset;else if(document.documentElement&&document.documentElement.clientWidth)a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight,a.horizontalScroll=document.documentElement.scrollLeft,a.verticalScroll=document.documentElement.scrollTop;else if(document.body.clientWidth)a.width=
document.body.clientWidth,a.height=document.body.clientHeight,a.horizontalScroll=document.body.scrollLeft,a.verticalScroll=document.body.scrollTop;return a};SocialCalc.GetElementPosition=function(a){for(var c=0,b=0;a;)c+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent;return{left:c,top:b}};
SocialCalc.GetElementPositionWithScroll=function(a){for(var c=0,b=0,d=a;a;){if(a.tagName=="HTML")break;if(a==d)c+=a.offsetLeft,b+=a.offsetTop,d=a.offsetParent;a.scrollLeft&&(c-=a.scrollLeft);a.scrollTop&&(b-=a.scrollTop);a=a.parentNode}return{left:c,top:b}};SocialCalc.LookupElement=function(a,c){var b;for(b=0;b<c.length;b++)if(c[b].element==a)return c[b];return null};SocialCalc.AssignID=function(a,c,b){if(a.idPrefix)c.id=a.idPrefix+b};
SocialCalc.GetCellContents=function(a,c){var b="",d=a.cells[c];if(d)switch(d.datatype){case "v":b=d.datavalue+"";break;case "t":b="'"+d.datavalue;break;case "f":b="="+d.formula;break;case "c":b=d.formula}return b};
SocialCalc.FormatValueForDisplay=function(a,c,b,d){var e,g=a.attribs,h=a.cells[b];h||(h=new SocialCalc.Cell(b));b=h.valuetype||"";e=b.substring(1);b=b.charAt(0);if(h.errors||b=="e")return c=h.errors||e||"Error in cell";if(b=="t"){b=a.valueformats[h.textvalueformat-0]||a.valueformats[g.defaulttextvalueformat-0]||"";if(b=="formula")return c=h.datatype=="f"?SocialCalc.special_chars("="+h.formula)||"&nbsp;":h.datatype=="c"?SocialCalc.special_chars("'"+h.formula)||"&nbsp;":SocialCalc.special_chars("'"+
c)||"&nbsp;";c=SocialCalc.format_text_for_display(c,h.valuetype,b,a,d)}else if(b=="n"){b=h.nontextvalueformat;if(b==null||b=="")b=g.defaultnontextvalueformat;b=a.valueformats[b-0];if(b==null||b=="none")b="";if(b=="formula")return c=h.datatype=="f"?SocialCalc.special_chars("="+h.formula)||"&nbsp;":h.datatype=="c"?SocialCalc.special_chars("'"+h.formula)||"&nbsp;":SocialCalc.special_chars("'"+c)||"&nbsp;";else if(b=="forcetext")return c=h.datatype=="f"?SocialCalc.special_chars("="+h.formula)||"&nbsp;":
h.datatype=="c"?SocialCalc.special_chars(h.formula)||"&nbsp;":SocialCalc.special_chars(c)||"&nbsp;";c=SocialCalc.format_number_for_display(c,h.valuetype,b)}else c="&nbsp;";return c};
SocialCalc.format_text_for_display=function(a,c,b,d,e){var g,c=c.substring(1);if(b=="none"||b==null)b="";/^(text-|custom|hidden)/.test(b)||(b="");if(b==""||b=="General"){c=="h"&&(b="text-html");if(c=="w"||c=="r")b="text-wiki";c=="l"&&(b="text-link");c||(b="text-plain")}if(b!="text-html")SocialCalc.Callbacks.expand_wiki&&/^text-wiki/.test(b)?a=SocialCalc.Callbacks.expand_wiki(a,d,e,b):b=="text-wiki"?a=SocialCalc.special_chars(a):b=="text-wiki"?a=SocialCalc.Callbacks.expand_markup&&SocialCalc.Callbacks.expand_markup(a,
d,e)||SocialCalc.special_chars(a):b=="text-url"?(d=SocialCalc.special_chars(a),e=encodeURI(a),a='<a href="'+e+'">'+d+"</a>"):b=="text-link"?a=SocialCalc.expand_text_link(a,d,e,b):b=="text-image"?(e=encodeURI(a),a='<img src="'+e+'">'):b.substring(0,12)=="text-custom:"?(d=SocialCalc.special_chars(a),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"),e=encodeURI(a),g={},g.r=a,g.s=d,g.u=e,a=b.substring(12),a=a.replace(/@(r|s|u)/g,function(a,c){return g[c]})):b.substring(0,6)=="custom"?(a=SocialCalc.special_chars(a),
a=a.replace(/  /g,"&nbsp; "),a=a.replace(/\n/g,"<br>"),a+=" (custom format)"):b=="hidden"?a="&nbsp;":(a=SocialCalc.special_chars(a),a=a.replace(/  /g,"&nbsp; "),a=a.replace(/\n/g,"<br>"));return a};
SocialCalc.format_number_for_display=function(a,c,b){var d,e=SocialCalc.Constants;d=a-0;c=c.substring(1);if(b=="Auto"||b=="")b=c=="%"?"#,##0.0%":c=="$"?"[$]#,##0.00":c=="dt"?e.defaultFormatdt:c=="d"?e.defaultFormatd:c=="t"?e.defaultFormatt:c=="l"?"logical":"General";return b=="logical"?d?e.defaultDisplayTRUE:e.defaultDisplayFALSE:b=="hidden"?"&nbsp;":SocialCalc.FormatNumber.formatNumberWithFormat(a,b,"")};
SocialCalc.DetermineValueType=function(a){var c=a+"",b="t",d,e;d=c.replace(/^\s+/,"");d=d.replace(/\s+$/,"");if(c.length==0)b="";else if(!c.match(/^\s+$/))if(d.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/))c=d-0,isNaN(c)?c=a+"":b="n";else if(d.match(/^[-+]?\d*(?:\.)?\d*\s*%$/))c=(d.slice(0,-1)-0)/100,b="n%";else if(d.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&d.match(/\d/))c=d.replace(/\$/,"")-0,b="n$";else if(d.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/))c=d.replace(/,/g,"")-0,b="n";else if(d.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/))c=
(d.replace(/[%,]/g,"")-0)/100,b="n%";else if(d.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&d.match(/\d/))c=d.replace(/[\$,]/g,"")-0,b="n$";else if(a=c.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))c=a[3]-0,c=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(c<1E3?c+2E3:c,a[1]-0,a[2]-0)-2415019,b="nd";else if(a=c.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))c=a[1]-0,c=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(c<1E3?c+2E3:c,a[2]-0,a[3]-0)-2415019,b="nd";else if(a=
c.match(/^(\d{1,2}):(\d{1,2})\s*$/))d=a[1]-0,e=a[2]-0,d<24&&e<60&&(c=d/24+e/1440,b="nt");else if(a=c.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))d=a[1]-0,e=a[2]-0,a=a[3]-0,d<24&&e<60&&a<60&&(c=d/24+e/1440+a/86400,b="nt");else if(a=c.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/)){if(e=a[1]-0,d=a[2]-0,(a=a[3]-0)&&a>0)c=e+(e<0?-d/a:d/a),b="n"}else(a=SocialCalc.InputConstants[c.toUpperCase()])?(d=a.indexOf(","),c=a.substring(0,d)-0,b=a.substring(d+1)):d.length>7&&d.substring(0,7).toLowerCase()=="http://"&&
(c=d,b="tl");return{value:c,type:b}};SocialCalc.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"};SocialCalc.default_expand_markup=function(a){a=SocialCalc.special_chars(a);a=a.replace(/  /g,"&nbsp; ");return a=a.replace(/\n/g,"<br>")};
SocialCalc.expand_text_link=function(a,c,b,d){var e;e=SocialCalc.Constants;var c="",g=SocialCalc.ParseCellLinkText(a+"");e=g.desc?SocialCalc.special_chars(g.desc):g.pagename?e.defaultPageLinkFormatString:e.defaultLinkFormatString;a.length>7&&a.substring(0,7).toLowerCase()=="http://"&&a.charAt(a.length-1)!=">"&&(e=e.substring(7));a=g.newwin||!b?' target="_blank"':"";g.pagename?SocialCalc.Callbacks.MakePageLink&&(c=SocialCalc.Callbacks.MakePageLink(g.pagename,g.workspacename,b,d)):c=encodeURI(g.url);
return'<a href="'+c+'"'+a+">"+e+"</a>"};
SocialCalc.ParseCellLinkText=function(a){var c={url:"",desc:"",newwin:!1,pagename:"",workspace:""},b=!1,d=a.length-1,e=0,g=a.lastIndexOf("<"),h=a.lastIndexOf("["),j=a.lastIndexOf("{"),k=-1;if((a.charAt(d)!=">"||g==-1)&&(a.charAt(d)!="]"||h==-1)&&(a.charAt(d)!="}"||a.charAt(d-1)!="]"||j==-1||h==-1||h<j))d++,k=d;else{if(a.charAt(d)==">"){if(k=g-1,g>0&&a.charAt(k)=="<"&&a.charAt(d-1)==">")k--,d--,c.newwin=!0}else if(a.charAt(d)=="]"){if(k=h-1,b=!0,h>0&&a.charAt(k)=="["&&a.charAt(d-1)=="]")k--,d--,c.newwin=
!0}else if(a.charAt(d)=="}"){k=j-1;b=!0;wsend=h;d--;if(h>0&&a.charAt(h-1)=="["&&a.charAt(d-1)=="]")wsend=h-1,d--,c.newwin=!0;a.charAt(wsend-1)==" "&&wsend--;c.workspace=a.substring(j+1,wsend)||""}a.charAt(k)==" "&&k--;a.charAt(e)=='"'&&a.charAt(k)=='"'&&(e++,k--)}b?c.pagename=a.substring(h+1,d)||"":c.url=a.substring(g+1,d)||"";if(k>=e)c.desc=a.substring(e,k+1);return c};
SocialCalc.ConvertSaveToOtherFormat=function(a,c,b){var d,e,g,h;e="";if(c=="scsave")return a;if(a=="")return"";d=new SocialCalc.Sheet;d.ParseSheetSave(a);if(b)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";a=d.copiedfrom?SocialCalc.ParseRange(d.copiedfrom):{cr1:{row:1,col:1},cr2:{row:d.attribs.lastrow,col:d.attribs.lastcol}};if(c=="html")return e=new SocialCalc.RenderContext(d),d.copiedfrom&&(e.rowpanes[0]={first:a.cr1.row,last:a.cr2.row},e.colpanes[0]={first:a.cr1.col,last:a.cr2.col}),
c=document.createElement("div"),a=e.RenderSheet(null,e.defaultHTMLlinkstyle),c.appendChild(a),delete e,delete d,e=c.innerHTML,delete a,delete c,e;for(b=a.cr1.row;b<=a.cr2.row;b++){for(g=a.cr1.col;g<=a.cr2.col;g++)h=SocialCalc.crToCoord(g,b),h=d.GetAssuredCell(h),h=h.errors?h.errors:h.datavalue+"",c=="csv"?(h.indexOf('"')!=-1&&(h=h.replace(/"/g,'""')),/[, \n"]/.test(h)&&(h='"'+h+'"'),g>a.cr1.col&&(h=","+h)):c=="tab"&&(h.indexOf("\n")!=-1&&(h.indexOf('"')!=-1&&(h=h.replace(/"/g,'""')),h='"'+h+'"'),
g>a.cr1.col&&(h="\t"+h)),e+=h;e+="\n"}return e};
SocialCalc.ConvertOtherFormatToSave=function(a,c){var b,d,e,g,h,j,k,m,n,s,q,p,r="",u=function(){s++;s>p&&(p=s);q=SocialCalc.crToCoord(s,n);SocialCalc.SetConvertedCell(b,q,h);h=""};if(c=="scsave")return a;b=new SocialCalc.Sheet;d=a.split(/\r\n|\n/);p=0;if(c=="csv"){n=0;j=!1;for(e=0;e<d.length;e++){if(e==d.length-1&&d[e]=="")break;j?h+="\n":(h="",n++,s=0);g=d[e];for(k=0;k<g.length;k++)m=g.charAt(k),m=='"'?j?k<g.length-1&&g.charAt(k+1)=='"'?(k++,h+='"'):(j=!1,k==g.length-1&&u()):j=!0:(m==","&&!j?u():
h+=m,k==g.length-1&&!j&&u())}if(p>0)b.attribs.lastrow=n,b.attribs.lastcol=p,r=b.CreateSheetSave("A1:"+SocialCalc.crToCoord(p,n))}if(c=="tab"){n=0;j=!1;for(e=0;e<d.length;e++){if(e==d.length-1&&d[e]=="")break;j?h+="\n":(h="",n++,s=0);g=d[e];for(k=0;k<g.length;k++){m=g.charAt(k);if(m=='"'){if(j){k<g.length-1?g.charAt(k+1)=='"'?(k++,h+='"'):g.charAt(k+1)=="\t"&&(k++,j=!1,u()):(j=!1,u());continue}if(h==""){j=!0;continue}}m=="\t"&&!j?u():h+=m;k==g.length-1&&!j&&u()}}if(p>0)b.attribs.lastrow=n,b.attribs.lastcol=
p,r=b.CreateSheetSave("A1:"+SocialCalc.crToCoord(p,n))}return r};SocialCalc.SetConvertedCell=function(a,c,b){a=a.GetAssuredCell(c);c=SocialCalc.DetermineValueType(b);c.type=="n"&&c.value==b?(a.datatype="v",a.valuetype="n",a.datavalue=c.value):c.type.charAt(0)=="t"?(a.datatype="t",a.valuetype=c.type,a.datavalue=c.value):(a.datatype="c",a.valuetype=c.type,a.datavalue=c.value,a.formula=b)};SocialCalc||(SocialCalc={});
SocialCalc.TableEditor=function(a){var c=SocialCalc.Constants;this.context=a;this.fullgrid=this.toplevel=null;this.noEdit=!1;this.timeout=this.cellhandles=this.logo=this.horizontaltablecontrol=this.verticaltablecontrol=this.inputEcho=this.inputBox=this.tableheight=this.height=this.tablewidth=this.width=null;this.ensureecell=this.busy=!1;this.deferredCommands=[];this.lastvisiblecol=this.lastnonscrollingcol=this.firstscrollingcolleft=this.firstscrollingcol=this.lastvisiblerow=this.lastnonscrollingrow=
this.firstscrollingrowtop=this.firstscrollingrow=this.headposition=this.gridposition=null;this.rowpositions=[];this.colpositions=[];this.rowheight=[];this.colwidth=[];this.ecell=null;this.state="start";this.workingvalues={};this.imageprefix=c.defaultImagePrefix;this.idPrefix=c.defaultTableEditorIDPrefix;this.pageUpDnAmount=c.defaultPageUpDnAmount;this.recalcFunction=function(a){if(a.context.sheetobj.RecalcSheet)a.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback,a);else return null};
this.ctrlkeyFunction=function(a,c){var e,g,h,j,k;switch(c){case "[ctrl-c]":case "[ctrl-x]":e=a.pasteTextarea;e.value="";if(h=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col))h=SocialCalc.GetElementPosition(h.element),e.style.left=h.left-1+"px",e.style.top=h.top-1+"px";k=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord;h=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(a.context.sheetobj,k),
"tab");j=c=="[ctrl-c]"||a.noEdit?"copy "+k+" formulas":"cut "+k+" formulas";a.EditorScheduleSheetCommands(j,!0,!1);e.style.display="block";e.value=h;e.focus();e.select();window.setTimeout(function(){if(SocialCalc.GetSpreadsheetControlObject){var a=SocialCalc.GetSpreadsheetControlObject();if(a)a=a.editor.pasteTextarea,a.blur(),a.style.display="none",SocialCalc.KeyboardFocus()}},200);break;case "[ctrl-v]":if(a.noEdit)break;if(g=a.pasteHTMLarea)g.style.visibility="visible",g.focus();else{e=a.pasteTextarea;
e.value="";if(h=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col))h=SocialCalc.GetElementPosition(h.element),e.style.left=h.left-1+"px",e.style.top=h.top-1+"px";e.style.display="block";e.value="";e.focus()}window.setTimeout(function(){if(SocialCalc.GetSpreadsheetControlObject){var a=SocialCalc.GetSpreadsheetControlObject();if(a){var a=a.editor,c=null,b=!1;if(g=a.pasteHTMLarea){var c=String.fromCharCode(65532),d=g.innerHTML;g.innerHTML=d.search(/<(?![Bb][Rr])[A-Za-z]/)>=0?d.replace(/(?:<\/[Tt][Dd]>)/g,
c):d.replace(/&[Nn][Bb][Ss][Pp];/g,c);c=g.innerText.replace(RegExp(c,"g"),"\t");g.innerHTML="";g.blur();g.style.visibility="hidden"}else d=a.pasteTextarea,c=d.value,d.blur(),d.style.display="none";c=c.replace(/\r\n/g,"\n").replace(/\n?$/,"\n");d=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,"tab");if(c==d||c.length-d.length==1&&c.substring(0,c.length-1)==d)b=!0;d="";b||(d="loadclipboard "+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(c,"tab"))+"\n");b=a.range.hasrange?
SocialCalc.crToCoord(a.range.left,a.range.top):a.ecell.coord;d+="paste "+b+" formulas";a.EditorScheduleSheetCommands(d,!0,!1);SocialCalc.KeyboardFocus()}}},200);break;case "[ctrl-z]":return a.EditorScheduleSheetCommands("undo",!0,!1),!1;case "[ctrl-s]":return window.setTimeout(function(){if(SocialCalc.GetSpreadsheetControlObject){var a=SocialCalc.GetSpreadsheetControlObject();if(a){var a=a.editor,c=a.context.sheetobj,b=c.GetAssuredCell(a.ecell.coord),c=window.prompt("Advanced Feature:\n\nCustom Numeric Format or Command",
b.nontextvalueformat?c.valueformats[b.nontextvalueformat-0]||"":"");if(c!=null){if(c.match(/^cmd:/))j=c.substring(4);else if(c.match(/^edit:/)){j=c.substring(5);SocialCalc.CtrlSEditor&&SocialCalc.CtrlSEditor(j);return}else k=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord,j="set "+k+" nontextvalueformat "+c;a.EditorScheduleSheetCommands(j,!0,!1)}}}},200),!1}return!0};a.sheetobj.statuscallback=SocialCalc.EditorSheetStatusCallback;
a.sheetobj.statuscallbackparams=this;this.StatusCallback={};this.MoveECellCallback={};this.RangeChangeCallback={};this.SettingsCallbacks={};this.ecell={coord:"A1",row:1,col:1};a.highlights[this.ecell.coord]="cursor";this.range={hasrange:!1};this.range2={hasrange:!1}};SocialCalc.TableEditor.prototype.CreateTableEditor=function(a,c){return SocialCalc.CreateTableEditor(this,a,c)};SocialCalc.TableEditor.prototype.ResizeTableEditor=function(a,c){return SocialCalc.ResizeTableEditor(this,a,c)};
SocialCalc.TableEditor.prototype.SaveEditorSettings=function(){return SocialCalc.SaveEditorSettings(this)};SocialCalc.TableEditor.prototype.LoadEditorSettings=function(a,c){return SocialCalc.LoadEditorSettings(this,a,c)};SocialCalc.TableEditor.prototype.EditorRenderSheet=function(){SocialCalc.EditorRenderSheet(this)};SocialCalc.TableEditor.prototype.EditorScheduleSheetCommands=function(a,c,b){SocialCalc.EditorScheduleSheetCommands(this,a,c,b)};
SocialCalc.TableEditor.prototype.ScheduleSheetCommands=function(a,c){this.context.sheetobj.ScheduleSheetCommands(a,c)};SocialCalc.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()};SocialCalc.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()};SocialCalc.TableEditor.prototype.EditorStepSet=function(a,c){SocialCalc.EditorStepSet(this,a,c)};
SocialCalc.TableEditor.prototype.GetStatuslineString=function(a,c,b){return SocialCalc.EditorGetStatuslineString(this,a,c,b)};SocialCalc.TableEditor.prototype.EditorMouseRegister=function(){return SocialCalc.EditorMouseRegister(this)};SocialCalc.TableEditor.prototype.EditorMouseUnregister=function(){return SocialCalc.EditorMouseUnregister(this)};SocialCalc.TableEditor.prototype.EditorMouseRange=function(a){return SocialCalc.EditorMouseRange(this,a)};
SocialCalc.TableEditor.prototype.EditorProcessKey=function(a,c){return SocialCalc.EditorProcessKey(this,a,c)};SocialCalc.TableEditor.prototype.EditorAddToInput=function(a,c){return SocialCalc.EditorAddToInput(this,a,c)};SocialCalc.TableEditor.prototype.DisplayCellContents=function(){return SocialCalc.EditorDisplayCellContents(this)};SocialCalc.TableEditor.prototype.EditorSaveEdit=function(a){return SocialCalc.EditorSaveEdit(this,a)};
SocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange=function(a,c){return SocialCalc.EditorApplySetCommandsToRange(this,a,c)};SocialCalc.TableEditor.prototype.MoveECellWithKey=function(a){return SocialCalc.MoveECellWithKey(this,a)};SocialCalc.TableEditor.prototype.MoveECell=function(a){return SocialCalc.MoveECell(this,a)};SocialCalc.TableEditor.prototype.ReplaceCell=function(a,c,b){SocialCalc.ReplaceCell(this,a,c,b)};
SocialCalc.TableEditor.prototype.UpdateCellCSS=function(a,c,b){SocialCalc.UpdateCellCSS(this,a,c,b)};SocialCalc.TableEditor.prototype.SetECellHeaders=function(a){SocialCalc.SetECellHeaders(this,a)};SocialCalc.TableEditor.prototype.EnsureECellVisible=function(){SocialCalc.EnsureECellVisible(this)};SocialCalc.TableEditor.prototype.RangeAnchor=function(a){SocialCalc.RangeAnchor(this,a)};SocialCalc.TableEditor.prototype.RangeExtend=function(a){SocialCalc.RangeExtend(this,a)};
SocialCalc.TableEditor.prototype.RangeRemove=function(){SocialCalc.RangeRemove(this)};SocialCalc.TableEditor.prototype.Range2Remove=function(){SocialCalc.Range2Remove(this)};SocialCalc.TableEditor.prototype.FitToEditTable=function(){SocialCalc.FitToEditTable(this)};SocialCalc.TableEditor.prototype.CalculateEditorPositions=function(){SocialCalc.CalculateEditorPositions(this)};SocialCalc.TableEditor.prototype.ScheduleRender=function(){SocialCalc.ScheduleRender(this)};
SocialCalc.TableEditor.prototype.DoRenderStep=function(){SocialCalc.DoRenderStep(this)};SocialCalc.TableEditor.prototype.SchedulePositionCalculations=function(){SocialCalc.SchedulePositionCalculations(this)};SocialCalc.TableEditor.prototype.DoPositionCalculations=function(){SocialCalc.DoPositionCalculations(this)};SocialCalc.TableEditor.prototype.CalculateRowPositions=function(a,c,b){return SocialCalc.CalculateRowPositions(this,a,c,b)};
SocialCalc.TableEditor.prototype.CalculateColPositions=function(a,c,b){return SocialCalc.CalculateColPositions(this,a,c,b)};SocialCalc.TableEditor.prototype.ScrollRelative=function(a,c){SocialCalc.ScrollRelative(this,a,c)};SocialCalc.TableEditor.prototype.ScrollRelativeBoth=function(a,c){SocialCalc.ScrollRelativeBoth(this,a,c)};SocialCalc.TableEditor.prototype.PageRelative=function(a,c){SocialCalc.PageRelative(this,a,c)};SocialCalc.TableEditor.prototype.LimitLastPanes=function(){SocialCalc.LimitLastPanes(this)};
SocialCalc.TableEditor.prototype.ScrollTableUpOneRow=function(){return SocialCalc.ScrollTableUpOneRow(this)};SocialCalc.TableEditor.prototype.ScrollTableDownOneRow=function(){return SocialCalc.ScrollTableDownOneRow(this)};SocialCalc.TableEditor.prototype.ScrollTableLeftOneCol=function(){return SocialCalc.ScrollTableLeftOneCol(this)};SocialCalc.TableEditor.prototype.ScrollTableRightOneCol=function(){return SocialCalc.ScrollTableRightOneCol(this)};
SocialCalc.CreateTableEditor=function(a,c,b){var d=SocialCalc.Constants,e=SocialCalc.AssignID;a.toplevel=document.createElement("div");a.width=c;a.height=b;a.griddiv=document.createElement("div");a.tablewidth=Math.max(0,c-d.defaultTableControlThickness);a.tableheight=Math.max(0,b-d.defaultTableControlThickness);a.griddiv.style.width=a.tablewidth+"px";a.griddiv.style.height=a.tableheight+"px";a.griddiv.style.overflow="hidden";a.griddiv.style.cursor="default";if(d.cteGriddivClass)a.griddiv.className=
d.cteGriddivClass;e(a,a.griddiv,"griddiv");a.FitToEditTable();a.EditorRenderSheet();a.griddiv.appendChild(a.fullgrid);a.verticaltablecontrol=new SocialCalc.TableControl(a,!0,a.tableheight);a.verticaltablecontrol.CreateTableControl();e(a,a.verticaltablecontrol.main,"tablecontrolv");a.horizontaltablecontrol=new SocialCalc.TableControl(a,!1,a.tablewidth);a.horizontaltablecontrol.CreateTableControl();e(a,a.horizontaltablecontrol.main,"tablecontrolh");b=document.createElement("table");a.layouttable=b;
b.cellSpacing=0;b.cellPadding=0;e(a,b,"layouttable");c=document.createElement("tbody");b.appendChild(c);b=document.createElement("tr");c.appendChild(b);d=document.createElement("td");d.appendChild(a.griddiv);b.appendChild(d);d=document.createElement("td");d.appendChild(a.verticaltablecontrol.main);b.appendChild(d);b=document.createElement("tr");c.appendChild(b);d=document.createElement("td");d.appendChild(a.horizontaltablecontrol.main);b.appendChild(d);d=document.createElement("td");d.style.background=
"url("+a.imageprefix+"logo.gif) no-repeat center center";d.innerHTML="<div style='cursor:pointer;font-size:1px;'><img src='"+a.imageprefix+"1x1.gif' border='0' width='18' height='18'></div>";b.appendChild(d);a.logo=d;e(a,a.logo,"logo");SocialCalc.TooltipRegister(d.firstChild.firstChild,"SocialCalc",null);a.toplevel.appendChild(a.layouttable);if(!a.noEdit)a.inputEcho=new SocialCalc.InputEcho(a),e(a,a.inputEcho.main,"inputecho");a.cellhandles=new SocialCalc.CellHandles(a);c=document.createElement("textarea");
SocialCalc.setStyles(c,"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);");c.value="";a.pasteTextarea=c;e(a,a.pasteTextarea,"pastetextarea");navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//)&&(window.removeEventListener("beforepaste",SocialCalc.SafariPasteFunction,!1),window.addEventListener("beforepaste",SocialCalc.SafariPasteFunction,!1),window.removeEventListener("beforecopy",SocialCalc.SafariPasteFunction,!1),window.addEventListener("beforecopy",
SocialCalc.SafariPasteFunction,!1),window.removeEventListener("beforecut",SocialCalc.SafariPasteFunction,!1),window.addEventListener("beforecut",SocialCalc.SafariPasteFunction,!1));a.toplevel.appendChild(a.pasteTextarea);c=document.createElement("div");c.innerHTML="    <br/>";if(c.firstChild.nodeType==1)c=document.createElement("div"),a.pasteHTMLarea=c,a.toplevel.appendChild(a.pasteHTMLarea),c.contentEditable=!0,e(a,a.pasteHTMLarea,"pastehtmlarea"),SocialCalc.setStyles(c,"display:block;visibility:hidden;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);overflow:hidden");
SocialCalc.MouseWheelRegister(a.toplevel,{WheelMove:SocialCalc.EditorProcessMouseWheel,editor:a});a.inputBox&&a.inputBox.element&&(a.inputBox.element.focus(),a.inputBox.element.blur());SocialCalc.KeyboardSetFocus(a);SocialCalc.EditorSheetStatusCallback(null,"startup",null,a);return a.toplevel};SocialCalc.SafariPasteFunction=function(a){a.preventDefault()};
SocialCalc.ResizeTableEditor=function(a,c,b){var d=SocialCalc.Constants;a.width=c;a.height=b;a.toplevel.style.width=c+"px";a.toplevel.style.height=b+"px";a.tablewidth=Math.max(0,c-d.defaultTableControlThickness);a.tableheight=Math.max(0,b-d.defaultTableControlThickness);a.griddiv.style.width=a.tablewidth+"px";a.griddiv.style.height=a.tableheight+"px";a.verticaltablecontrol.main.style.height=a.tableheight+"px";a.horizontaltablecontrol.main.style.width=a.tablewidth+"px";a.FitToEditTable();a.ScheduleRender()};
SocialCalc.SaveEditorSettings=function(a){var c,b,d=a.context,e=a.range,g="";g+="version:1.0\n";for(c=0;c<d.rowpanes.length;c++)g+="rowpane:"+c+":"+d.rowpanes[c].first+":"+d.rowpanes[c].last+"\n";for(c=0;c<d.colpanes.length;c++)g+="colpane:"+c+":"+d.colpanes[c].first+":"+d.colpanes[c].last+"\n";a.ecell&&(g+="ecell:"+a.ecell.coord+"\n");e.hasrange&&(g+="range:"+e.anchorcoord+":"+e.top+":"+e.bottom+":"+e.left+":"+e.right+"\n");for(b in a.SettingsCallbacks)g+=a.SettingsCallbacks[b].save(a,b);return g};
SocialCalc.LoadEditorSettings=function(a,c,b){var c=c.split(/\r\n|\n/),d=[],e,g,h,j=a.context,k,m;j.rowpanes=[{first:1,last:1}];j.colpanes=[{first:1,last:1}];a.ecell=null;a.range={hasrange:!1};a.range2={hasrange:!1};m=a.range;j.highlights={};k=j.highlights;for(g=0;g<c.length;g++)switch(e=c[g],d=e.split(":"),h=d[0],h){case "version":break;case "rowpane":j.rowpanes[d[1]-0]={first:d[2]-0,last:d[3]-0};break;case "colpane":j.colpanes[d[1]-0]={first:d[2]-0,last:d[3]-0};break;case "ecell":a.ecell=SocialCalc.coordToCr(d[1]);
a.ecell.coord=d[1];k[d[1]]="cursor";break;case "range":m.hasrange=!0;m.anchorcoord=d[1];e=SocialCalc.coordToCr(m.anchorcoord);m.anchorrow=e.row;m.anchorcol=e.col;m.top=d[2]-0;m.bottom=d[3]-0;m.left=d[4]-0;m.right=d[5]-0;for(d=m.top;d<=m.bottom;d++)for(e=m.left;e<=m.right;e++)h=SocialCalc.crToCoord(e,d),k[h]!="cursor"&&(k[h]="range");break;default:a.SettingsCallbacks[h]&&a.SettingsCallbacks[h].load(a,h,e,b)}};
SocialCalc.EditorRenderSheet=function(a){a.EditorMouseUnregister();a.fullgrid=a.context.RenderSheet(a.fullgrid);a.ecell&&a.SetECellHeaders("selected");SocialCalc.AssignID(a,a.fullgrid,"fullgrid");a.EditorMouseRegister()};
SocialCalc.EditorScheduleSheetCommands=function(a,c,b,d){if(a.state=="start"||d)if(a.busy&&!d)a.deferredCommands.push({cmdstr:c,saveundo:b});else switch(c){case "recalc":case "redisplay":a.context.sheetobj.ScheduleSheetCommands(c,!1);break;case "undo":a.SheetUndo();break;case "redo":a.SheetRedo();break;default:a.context.sheetobj.ScheduleSheetCommands(c,b)}};
SocialCalc.EditorSheetStatusCallback=function(a,c,b,d){var e,a=d.context.sheetobj,g=function(a){for(e in d.StatusCallback)d.StatusCallback[e].func&&d.StatusCallback[e].func(d,a,b,d.StatusCallback[e].params)};switch(c){case "startup":break;case "cmdstart":d.busy=!0;a.celldisplayneeded="";break;case "cmdextension":break;case "cmdend":g(c);if(a.changedrendervalues)d.context.PrecomputeSheetFontsAndLayouts(),d.context.CalculateCellSkipData(),a.changedrendervalues=!1;a.celldisplayneeded&&!a.renderneeded&&
(cr=SocialCalc.coordToCr(a.celldisplayneeded),c=SocialCalc.GetEditorCellElement(d,cr.row,cr.col),d.ReplaceCell(c,cr.row,cr.col));if(d.deferredCommands.length){c=d.deferredCommands.shift();d.EditorScheduleSheetCommands(c.cmdstr,c.saveundo,!0);return}a.attribs.needsrecalc&&(a.attribs.recalc!="off"||a.recalconce)&&d.recalcFunction?(d.FitToEditTable(),a.renderneeded=!1,a.recalconce&&delete a.recalconce,d.recalcFunction(d)):a.renderneeded?(d.FitToEditTable(),a.renderneeded=!1,d.ScheduleRender()):d.SchedulePositionCalculations();
return;case "calcstart":d.busy=!0;break;case "calccheckdone":case "calcorder":case "calcstep":case "calcloading":case "calcserverfunc":break;case "calcfinished":g(c);d.ScheduleRender();return;case "schedrender":d.busy=!0;break;case "renderdone":break;case "schedposcalc":d.busy=!0;break;case "doneposcalc":d.deferredCommands.length?(g(c),c=d.deferredCommands.shift(),d.EditorScheduleSheetCommands(c.cmdstr,c.saveundo,!0)):(d.busy=!1,g(c),d.state=="start"&&d.DisplayCellContents());return;default:addmsg("Unknown status: "+
c)}g(c)};SocialCalc.EditorStepInfo={editor:null};
SocialCalc.EditorGetStatuslineString=function(a,c,b,d){var e=SocialCalc.Constants,g,h,j;g="";switch(c){case "moveecell":case "rangechange":case "startup":break;case "cmdstart":d.command=!0;document.body.style.cursor="progress";a.griddiv.style.cursor="progress";g=e.s_statusline_executing;break;case "cmdextension":g="Command Extension: "+b;break;case "cmdend":d.command=!1;break;case "schedrender":g=e.s_statusline_displaying;break;case "renderdone":g=" ";break;case "schedposcalc":g=e.s_statusline_displaying;
break;case "cmdendnorender":case "doneposcalc":document.body.style.cursor="default";a.griddiv.style.cursor="default";break;case "calcorder":g=e.s_statusline_ordering+Math.floor(100*b.count/(b.total||1))+"%";break;case "calcstep":g=e.s_statusline_calculating+Math.floor(100*b.count/(b.total||1))+"%";break;case "calcloading":g=e.s_statusline_calculatingls+": "+b.sheetname;break;case "calcserverfunc":g=e.s_statusline_calculating+Math.floor(100*b.count/(b.total||1))+"%, "+e.s_statusline_doingserverfunc+
b.funcname+e.s_statusline_incell+b.coord;break;case "calcstart":d.calculating=!0;document.body.style.cursor="progress";a.griddiv.style.cursor="progress";g=e.s_statusline_calcstart;break;case "calccheckdone":break;case "calcfinished":d.calculating=!1;break;default:g=c}if(!g&&d.calculating)g=e.s_statusline_calculating;if(!d.calculating&&!d.command&&!g&&a.range.hasrange&&(a.range.left!=a.range.right||a.range.top!=a.range.bottom)){c=0;for(b=a.range.top;b<=a.range.bottom;b++)for(h=a.range.left;h<=a.range.right;h++)(j=
a.context.sheetobj.cells[SocialCalc.crToCoord(h,b)])&&j.valuetype&&j.valuetype.charAt(0)=="n"&&(c+=j.datavalue-0);c=SocialCalc.FormatNumber.formatNumberWithFormat(c,"[,]General","");b=SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom);g=b+" ("+(a.range.right-a.range.left+1)+"x"+(a.range.bottom-a.range.top+1)+") "+e.s_statusline_sum+"="+c+" "+g}g=a.ecell.coord+" &nbsp; "+g;!d.calculating&&a.context.sheetobj.attribs.needsrecalc=="yes"&&(g+=" &nbsp; "+
e.s_statusline_recalcneeded);if(a=a.context.sheetobj.attribs.circularreferencecell)a=a.replace(/\|/," referenced by "),g+=" &nbsp; "+e.s_statusline_circref+a+"</span>";return g};SocialCalc.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:"",mouselastcoord:"",mouseresizecol:"",mouseresizeclientx:null,mouseresizedisplay:null};
SocialCalc.EditorMouseRegister=function(a){var c=SocialCalc.EditorMouseInfo,b=a.fullgrid,d;for(d=0;d<c.registeredElements.length;d++)if(c.registeredElements[d].editor==a){if(c.registeredElements[d].element==b)return;break}d<c.registeredElements.length?c.registeredElements[d].element=b:c.registeredElements.push({element:b,editor:a});if(b.addEventListener)b.addEventListener("mousedown",SocialCalc.ProcessEditorMouseDown,!1),b.addEventListener("dblclick",SocialCalc.ProcessEditorDblClick,!1);else if(b.attachEvent)b.attachEvent("onmousedown",
SocialCalc.ProcessEditorMouseDown),b.attachEvent("ondblclick",SocialCalc.ProcessEditorDblClick);else throw"Browser not supported";c.ignore=!1};
SocialCalc.EditorMouseUnregister=function(a){var c=SocialCalc.EditorMouseInfo,b;for(b=0;b<c.registeredElements.length;b++)if(c.registeredElements[b].editor==a)break;if(b<c.registeredElements.length)a=c.registeredElements[b].element,a.removeEventListener?(a.removeEventListener("mousedown",SocialCalc.ProcessEditorMouseDown,!1),a.removeEventListener("dblclick",SocialCalc.ProcessEditorDblClick,!1)):a.detachEvent&&(a.detachEvent("onmousedown",SocialCalc.ProcessEditorMouseDown),a.detachEvent("ondblclick",
SocialCalc.ProcessEditorDblClick)),c.registeredElements.splice(b,1)};
SocialCalc.ProcessEditorMouseDown=function(a){var c,b,d,e=a||window.event,g=SocialCalc.GetViewportInfo();b=e.clientX+g.horizontalScroll;var h=e.clientY+g.verticalScroll,g=SocialCalc.EditorMouseInfo,j=e.target||e.srcElement;if(!g.ignore){for(c=null;!c&&j;j=j.parentNode)c=SocialCalc.LookupElement(j,g.registeredElements);if(c){if(c=c.editor,g.element=j,d=c.range,(b=SocialCalc.GridMousePosition(c,b,h))&&!b.rowheader)if(g.editor=c,b.colheader&&b.coltoresize)SocialCalc.ProcessEditorColsizeMouseDown(a,j,
b);else if(b.coord)d.hasrange||a.shiftKey&&c.RangeAnchor(),b=c.MoveECell(b.coord),d.hasrange&&(a.shiftKey?c.RangeExtend():c.RangeRemove()),g.mousedowncoord=b,g.mouselastcoord=b,c.EditorMouseRange(b),SocialCalc.KeyboardSetFocus(c),c.state!="start"&&c.inputBox&&c.inputBox.element.focus(),document.addEventListener?(document.addEventListener("mousemove",SocialCalc.ProcessEditorMouseMove,!0),document.addEventListener("mouseup",SocialCalc.ProcessEditorMouseUp,!0)):j.attachEvent&&(j.setCapture(),j.attachEvent("onmousemove",
SocialCalc.ProcessEditorMouseMove),j.attachEvent("onmouseup",SocialCalc.ProcessEditorMouseUp),j.attachEvent("onlosecapture",SocialCalc.ProcessEditorMouseUp)),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1}else g.editor=null}};
SocialCalc.EditorMouseRange=function(a,c){var b,d,e=a.range;switch(a.state){case "input":b=a.inputBox.GetText();d=a.workingvalues;if("(+-*/,:!&<>=^".indexOf(b.slice(-1))>=0&&b.slice(0,1)=="="||b=="=")d.partialexpr=b;d.partialexpr?c&&(e.hasrange?a.inputBox.SetText(d.partialexpr+SocialCalc.crToCoord(e.left,e.top)+":"+SocialCalc.crToCoord(e.right,e.bottom)):a.inputBox.SetText(d.partialexpr+c)):(a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state="start",a.cellhandles.ShowCellHandles(!0),a.EditorSaveEdit(),
a.inputBox.DisplayCellContents(null));break;case "inputboxdirect":a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state="start",a.cellhandles.ShowCellHandles(!0),a.EditorSaveEdit(),a.inputBox.DisplayCellContents(null)}};
SocialCalc.ProcessEditorMouseMove=function(a){var c,b,d=a||window.event;c=SocialCalc.GetViewportInfo();b=d.clientX+c.horizontalScroll;var e=d.clientY+c.verticalScroll,g=SocialCalc.EditorMouseInfo;if((c=g.editor)&&!g.ignore)if(b=SocialCalc.GridMousePosition(c,b,e))if(b&&!b.coord)SocialCalc.SetDragAutoRepeat(c,b);else if(SocialCalc.SetDragAutoRepeat(c,null),b.coord)b.coord!=g.mouselastcoord&&(!a.shiftKey&&!c.range.hasrange&&c.RangeAnchor(g.mousedowncoord),c.MoveECell(b.coord),c.RangeExtend()),g.mouselastcoord=
b.coord,c.EditorMouseRange(b.coord),d.stopPropagation?d.stopPropagation():d.cancelBubble=!0,d.preventDefault?d.preventDefault():d.returnValue=!1};
SocialCalc.ProcessEditorMouseUp=function(a){var c,b,d,a=a||window.event;c=SocialCalc.GetViewportInfo();d=a.clientX+c.horizontalScroll;var e=a.clientY+c.verticalScroll,g=SocialCalc.EditorMouseInfo;if((c=g.editor)&&!g.ignore)if(b=g.element,d=SocialCalc.GridMousePosition(c,d,e),SocialCalc.SetDragAutoRepeat(c,null),d){if(!d.coord)d.coord=c.ecell.coord;c.range.hasrange?(c.MoveECell(d.coord),c.RangeExtend()):d.coord&&d.coord!=g.mousedowncoord&&(c.RangeAnchor(g.mousedowncoord),c.MoveECell(d.coord),c.RangeExtend());
c.EditorMouseRange(d.coord);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.ProcessEditorMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.ProcessEditorMouseUp,!0)):b.detachEvent&&(b.detachEvent("onlosecapture",SocialCalc.ProcessEditorMouseUp),b.detachEvent("onmouseup",SocialCalc.ProcessEditorMouseUp),b.detachEvent("onmousemove",SocialCalc.ProcessEditorMouseMove),
b.releaseCapture());g.editor=null;return!1}};
SocialCalc.ProcessEditorColsizeMouseDown=function(a,c,b){var a=a||window.event,c=SocialCalc.EditorMouseInfo,d=c.editor,e=SocialCalc.GetViewportInfo(),e=a.clientX+e.horizontalScroll;c.mouseresizecolnum=b.coltoresize;c.mouseresizecol=SocialCalc.rcColname(b.coltoresize);c.mousedownclientx=e;e=document.createElement("div");c.mouseresizedisplay=e;e.style.width="auto";e.style.position="absolute";e.style.zIndex=100;e.style.top=d.headposition.top+0+"px";e.style.left=d.colpositions[b.coltoresize]+"px";e.innerHTML=
'<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(d.context.colwidth[c.mouseresizecolnum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+d.context.colwidth[c.mouseresizecolnum]+"</div></td></tr></table>";SocialCalc.setStyles(e.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;");d.toplevel.appendChild(e);document.addEventListener?(document.addEventListener("mousemove",
SocialCalc.ProcessEditorColsizeMouseMove,!0),document.addEventListener("mouseup",SocialCalc.ProcessEditorColsizeMouseUp,!0)):d.toplevel.attachEvent&&(d.toplevel.setCapture(),d.toplevel.attachEvent("onmousemove",SocialCalc.ProcessEditorColsizeMouseMove),d.toplevel.attachEvent("onmouseup",SocialCalc.ProcessEditorColsizeMouseUp),d.toplevel.attachEvent("onlosecapture",SocialCalc.ProcessEditorColsizeMouseUp));a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=
!1};
SocialCalc.ProcessEditorColsizeMouseMove=function(a){var a=a||window.event,c=SocialCalc.EditorMouseInfo,b=c.editor;if(b){var d=SocialCalc.GetViewportInfo(),b=b.context.colwidth[c.mouseresizecolnum]-0+(a.clientX+d.horizontalScroll-c.mousedownclientx);if(b<SocialCalc.Constants.defaultMinimumColWidth)b=SocialCalc.Constants.defaultMinimumColWidth;c=c.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(b-
2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+b+"</div></td></tr></table>";SocialCalc.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;");a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}};
SocialCalc.ProcessEditorColsizeMouseUp=function(a){var c=a||window.event,a=SocialCalc.EditorMouseInfo,b=a.editor;if(b){element=a.element;var d=SocialCalc.GetViewportInfo(),d=c.clientX+d.horizontalScroll;c.stopPropagation?c.stopPropagation():c.cancelBubble=!0;c.preventDefault?c.preventDefault():c.returnValue=!1;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.ProcessEditorColsizeMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.ProcessEditorColsizeMouseUp,
!0)):b.toplevel.detachEvent&&(b.toplevel.detachEvent("onlosecapture",SocialCalc.ProcessEditorColsizeMouseUp),b.toplevel.detachEvent("onmouseup",SocialCalc.ProcessEditorColsizeMouseUp),b.toplevel.detachEvent("onmousemove",SocialCalc.ProcessEditorColsizeMouseMove),b.toplevel.releaseCapture());c=b.context.colwidth[a.mouseresizecolnum]-0+(d-a.mousedownclientx);if(c<SocialCalc.Constants.defaultMinimumColWidth)c=SocialCalc.Constants.defaultMinimumColWidth;b.EditorScheduleSheetCommands("set "+a.mouseresizecol+
" width "+c,!0,!1);b.timeout&&window.clearTimeout(b.timeout);b.timeout=window.setTimeout(SocialCalc.FinishColsize,1);return!1}};SocialCalc.FinishColsize=function(){var a=SocialCalc.EditorMouseInfo,c=a.editor;if(c)c.toplevel.removeChild(a.mouseresizedisplay),a.mouseresizedisplay=null,a.editor=null};SocialCalc.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1E3,editor:null,repeatcallback:null};
SocialCalc.SetDragAutoRepeat=function(a,c,b){var d=SocialCalc.AutoRepeatInfo;d.repeatcallback=b;if(c){d.editor=a;if(d.mouseinfo)if(c.rowheader||c.rowfooter)c.row!=d.mouseinfo.row&&(b=SocialCalc.crToCoord(a.ecell.col,c.row),d.repeatcallback?(a=c.row<d.mouseinfo.row?"left":c.row>d.mouseinfo.row?"right":"",d.repeatcallback(b,a)):(a.MoveECell(b),a.MoveECell(b),a.RangeExtend(),a.EditorMouseRange(b)));else if((c.colheader||c.colfooter)&&c.col!=d.mouseinfo.col)b=SocialCalc.crToCoord(c.col,a.ecell.row),d.repeatcallback?
(a=c.row<d.mouseinfo.row?"left":c.row>d.mouseinfo.row?"right":"",d.repeatcallback(b,a)):(a.MoveECell(b),a.RangeExtend(),a.EditorMouseRange(b));d.mouseinfo=c;if(c.distance<5)d.repeatinterval=333;else if(c.distance<10)d.repeatinterval=250;else if(c.distance<25)d.repeatinterval=100;else if(c.distance<35)d.repeatinterval=75;else{if(d.timer)window.clearTimeout(d.timer),d.timer=null;return}if(!d.timer)d.timer=window.setTimeout(SocialCalc.DragAutoRepeat,d.repeatinterval)}else{if(d.timer)window.clearTimeout(d.timer),
d.timer=null;d.mouseinfo=null}};
SocialCalc.DragAutoRepeat=function(){var a=SocialCalc.AutoRepeatInfo,c=a.mouseinfo,b;c.rowheader?b="left":c.rowfooter?b="right":c.colheader?b="up":c.colfooter&&(b="down");a.repeatcallback?(c=SocialCalc.coordToCr(a.editor.ecell.coord),b=="left"&&c.col>1?c.col--:b=="right"?c.col++:b=="up"&&c.row>1?c.row--:b=="down"&&c.row++,c=SocialCalc.crToCoord(c.col,c.row),a.repeatcallback(c,b)):(c=a.editor.MoveECellWithKey("[a"+b+"]shifted"))&&a.editor.EditorMouseRange(c);a.timer=window.setTimeout(SocialCalc.DragAutoRepeat,
a.repeatinterval)};
SocialCalc.ProcessEditorDblClick=function(a){var c,b,a=a||window.event,d=SocialCalc.GetViewportInfo();b=a.clientX+d.horizontalScroll;var e=a.clientY+d.verticalScroll,d=SocialCalc.EditorMouseInfo,g=a.target||a.srcElement;if(!d.ignore){for(c=null;!c&&g;g=g.parentNode)c=SocialCalc.LookupElement(g,d.registeredElements);if(c){if(c=c.editor,(b=SocialCalc.GridMousePosition(c,b,e))&&b.coord){d.editor=c;d.element=g;sheetobj=c.context.sheetobj;switch(c.state){case "start":SocialCalc.EditorOpenCellEdit(c)}a.stopPropagation?a.stopPropagation():
a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}}else d.editor=null}};
SocialCalc.EditorOpenCellEdit=function(a){var c;if(!a.ecell)return!0;if(!a.inputBox)return!0;if(a.inputBox.element.disabled)return!0;if(a.inputBox.element.style.display=="none"){for(f in a.StatusCallback)a.StatusCallback[f].func(a,"editecell",null,a.StatusCallback[f].params);return!0}a.inputBox.ShowInputBox(!0);a.inputBox.Focus();a.state="inputboxdirect";a.inputBox.SetText("");a.inputBox.DisplayCellContents();a.inputBox.Select("end");c=a.workingvalues;c.partialexpr="";c.ecoord=a.ecell.coord;c.erow=
a.ecell.row;c.ecol=a.ecell.col};
SocialCalc.EditorProcessKey=function(a,c,b){var d,e=a.workingvalues,g=a.range;typeof c!="string"&&(c="");switch(a.state){case "start":b.shiftKey&&c.substr(0,2)=="[a"&&(c+="shifted");c=="[enter]"&&(c="[adown]");c=="[tab]"&&(c=b.shiftKey?"[aleft]":"[aright]");if(c.substr(0,2)=="[a"||c.substr(0,3)=="[pg"||c=="[home]")return a=a.MoveECellWithKey(c),!a;if(c=="[del]"||c=="[backspace]"){a.noEdit||a.EditorApplySetCommandsToRange("empty","");break}if(c=="[esc]"){if(g.hasrange)for(d in a.RangeRemove(),a.MoveECell(g.anchorcoord),
a.StatusCallback)a.StatusCallback[d].func(a,"specialkey",c,a.StatusCallback[d].params);break}if(c=="[f2]"){if(a.noEdit)return!0;SocialCalc.EditorOpenCellEdit(a);break}if(c.length>1&&c.substr(0,1)=="["||c.length==0)return a.ctrlkeyFunction&&c.length>0?a.ctrlkeyFunction(a,c):!0;if(!a.ecell)return!0;if(!a.inputBox)return!0;if(a.inputBox.element.style.display=="none"){for(d in a.StatusCallback)a.StatusCallback[d].func(a,"editecell",c,a.StatusCallback[d].params);return!0}a.inputBox.element.disabled=!1;
a.state="input";a.inputBox.ShowInputBox(!0);a.inputBox.Focus();a.inputBox.SetText(c);a.inputBox.Select("end");e.partialexpr="";e.ecoord=a.ecell.coord;e.erow=a.ecell.row;e.ecol=a.ecell.col;a.RangeRemove();break;case "input":d=a.inputBox.GetText();if(a.inputBox.skipOne)break;if(c=="[esc]"||c=="[enter]"||c=="[tab]"||c&&c.substr(0,2)=="[a"){if("(+-*/,:!&<>=^".indexOf(d.slice(-1))>=0&&d.slice(0,1)=="="||d=="=")e.partialexpr=d;if(e.partialexpr&&(b.shiftKey&&c.substr(0,2)=="[a"&&(c+="shifted"),d=a.MoveECellWithKey(c))){g.hasrange?
a.inputBox.SetText(e.partialexpr+SocialCalc.crToCoord(g.left,g.top)+":"+SocialCalc.crToCoord(g.right,g.bottom)):a.inputBox.SetText(e.partialexpr+d);break}a.inputBox.Blur();a.inputBox.ShowInputBox(!1);a.state="start";a.cellhandles.ShowCellHandles(!0);c!="[esc]"?(a.EditorSaveEdit(),a.ecell.coord!=e.ecoord&&a.MoveECell(e.ecoord),c=="[enter]"&&(c="[adown]"),c=="[tab]"&&(c=b.shiftKey?"[aleft]":"[aright]"),c.substr(0,2)=="[a"&&a.MoveECellWithKey(c)):(a.inputBox.DisplayCellContents(),a.RangeRemove(),a.MoveECell(e.ecoord));
break}if(e.partialexpr&&c=="[backspace]"){a.inputBox.SetText(e.partialexpr);e.partialexpr="";a.RangeRemove();a.MoveECell(e.ecoord);a.inputBox.ShowInputBox(!0);break}if(c=="[f2]")break;g.hasrange&&a.RangeRemove();a.MoveECell(e.ecoord);if(e.partialexpr)a.inputBox.ShowInputBox(!0),e.partialexpr="";return!0;case "inputboxdirect":a.inputBox.GetText();if(c=="[esc]"||c=="[enter]"||c=="[tab]"){a.inputBox.Blur();a.inputBox.ShowInputBox(!1);a.state="start";a.cellhandles.ShowCellHandles(!0);c=="[esc]"?a.inputBox.DisplayCellContents():
(a.EditorSaveEdit(),a.ecell.coord!=e.ecoord&&a.MoveECell(e.ecoord),c=="[enter]"&&(c="[adown]"),c=="[tab]"&&(c=b.shiftKey?"[aleft]":"[aright]"),c.substr(0,2)=="[a"&&a.MoveECellWithKey(c));break}return c=="[f2]"?!1:!0;case "skip-and-start":a.state="start";a.cellhandles.ShowCellHandles(!0);break;default:return!0}return!1};
SocialCalc.EditorAddToInput=function(a,c,b){var d=a.workingvalues;if(!a.noEdit)switch(a.state){case "start":a.state="input";a.inputBox.ShowInputBox(!0);a.inputBox.element.disabled=!1;a.inputBox.Focus();a.inputBox.SetText((b||"")+c);a.inputBox.Select("end");d.partialexpr="";d.ecoord=a.ecell.coord;d.erow=a.ecell.row;d.ecol=a.ecell.col;a.RangeRemove();break;case "input":case "inputboxdirect":a.inputBox.element.focus();if(d.partialexpr)a.inputBox.SetText(d.partialexpr),d.partialexpr="",a.RangeRemove(),
a.MoveECell(d.ecoord);a.inputBox.SetText(a.inputBox.GetText()+c)}};SocialCalc.EditorDisplayCellContents=function(a){a.inputBox&&a.inputBox.DisplayCellContents()};
SocialCalc.EditorSaveEdit=function(a,c){var b,d;b=a.context.sheetobj;var e=a.workingvalues;d=typeof c=="string"?c:a.inputBox.GetText();b=SocialCalc.GetCellContents(b,e.ecoord)+"";d!=b&&(b=d.charAt(0),b=="="&&d.indexOf("\n")==-1?(b="formula",d=d.substring(1)):b=="'"?(b="text t",d=d.substring(1)):d.length==0?b="empty":(b=SocialCalc.DetermineValueType(d),b=b.type=="n"&&d==b.value+""?"value n":b.type.charAt(0)=="t"?"text "+b.type:b.type==""?"text t":"constant "+b.type+" "+b.value),b.charAt(0)=="t"&&(d=
SocialCalc.encodeForSave(d)),a.EditorScheduleSheetCommands("set "+e.ecoord+" "+b+" "+d,!0,!1))};SocialCalc.EditorApplySetCommandsToRange=function(a,c){var b;b=a.ecell;var d=a.range;d.hasrange?(coord=SocialCalc.crToCoord(d.left,d.top)+":"+SocialCalc.crToCoord(d.right,d.bottom),b="set "+coord+" "+c):b="set "+b.coord+" "+c;a.EditorScheduleSheetCommands(b,!0,!1);a.DisplayCellContents()};
SocialCalc.EditorProcessMouseWheel=function(a,c,b,d){d.functionobj.editor.busy||(c>0&&d.functionobj.editor.ScrollRelative(!0,-1),c<0&&d.functionobj.editor.ScrollRelative(!0,1))};
SocialCalc.GridMousePosition=function(a,c,b){var d,e,g={};for(d=1;d<a.rowpositions.length;d++)if(a.rowheight[d]&&a.rowpositions[d]+a.rowheight[d]>b)break;for(e=1;e<a.colpositions.length;e++)if(a.colwidth[e]&&a.colpositions[e]+a.colwidth[e]>c)break;g.row=d;g.col=e;if(a.headposition){if(c<a.headposition.left&&c>=a.gridposition.left)g.rowheader=!0,g.distance=a.headposition.left-c;else if(b<a.headposition.top&&b>a.gridposition.top){g.colheader=!0;g.distance=a.headposition.top-b;g.coltoresize=e-(a.colpositions[e]+
a.colwidth[e]/2>c?1:0)||1;for(c=0;c<a.context.colpanes.length;c++)if(g.coltoresize>=a.context.colpanes[c].first&&g.coltoresize<=a.context.colpanes[c].last)return g;delete g.coltoresize}else if(c>=a.verticaltablecontrol.controlborder)g.rowfooter=!0,g.distance=c-a.verticaltablecontrol.controlborder;else if(b>=a.horizontaltablecontrol.controlborder)g.colfooter=!0,g.distance=b-a.horizontaltablecontrol.controlborder;else if(c<a.gridposition.left)g.rowheader=!0,g.distance=a.headposition.left-c;else if(b<=
a.gridposition.top)g.colheader=!0,g.distance=a.headposition.top-b;else if(g.coord=SocialCalc.crToCoord(g.col,g.row),a.context.cellskip[g.coord])g.coord=a.context.cellskip[g.coord];return g}return null};
SocialCalc.GetEditorCellElement=function(a,c,b){var d,e,g,h,j=0,k=0;for(d=0;d<a.context.rowpanes.length;d++){if(c>=a.context.rowpanes[d].first&&c<=a.context.rowpanes[d].last)for(e=0;e<a.context.colpanes.length;e++){if(b>=a.context.colpanes[e].first&&b<=a.context.colpanes[e].last){j+=c-a.context.rowpanes[d].first+2;for(g=a.context.colpanes[e].first;g<=b;g++)h=a.context.cellskip[SocialCalc.crToCoord(g,c)],(!h||!a.context.CoordInPane(h,d,e))&&k++;return{element:a.griddiv.firstChild.lastChild.childNodes[j].childNodes[k],
rowpane:d,colpane:e}}for(g=a.context.colpanes[e].first;g<=a.context.colpanes[e].last;g++)h=a.context.cellskip[SocialCalc.crToCoord(g,c)],(!h||!a.context.CoordInPane(h,d,e))&&k++;k+=1}j+=a.context.rowpanes[d].last-a.context.rowpanes[d].first+2}return null};
SocialCalc.MoveECellWithKey=function(a,c){var b,d,e,g=!1;if(!a.ecell)return null;c.slice(-7)=="shifted"&&(c=c.slice(0,-7),g=!0);b=a.ecell.row;d=a.ecell.col;e=a.context.sheetobj.cells[a.ecell.coord];switch(c){case "[adown]":b+=e&&e.rowspan||1;break;case "[aup]":b--;break;case "[pgdn]":b+=a.pageUpDnAmount-1+(e&&e.rowspan||1);break;case "[pgup]":b-=a.pageUpDnAmount;break;case "[aright]":d+=e&&e.colspan||1;break;case "[aleft]":d--;break;case "[home]":d=b=1;break;default:return null}a.range.hasrange||
g&&a.RangeAnchor();b=a.MoveECell(SocialCalc.crToCoord(d,b));a.range.hasrange&&(g?a.RangeExtend():a.RangeRemove());return b};
SocialCalc.MoveECell=function(a,c){var b,d,e=a.context.highlights;if(a.ecell){if(a.ecell.coord==c)return c;SocialCalc.Callbacks.broadcast&&SocialCalc.Callbacks.broadcast("ecell",{original:a.ecell.coord,ecell:c});b=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col);delete e[a.ecell.coord];a.range2.hasrange&&a.ecell.row>=a.range2.top&&a.ecell.row<=a.range2.bottom&&a.ecell.col>=a.range2.left&&a.ecell.col<=a.range2.right&&(e[a.ecell.coord]="range2");a.UpdateCellCSS(b,a.ecell.row,a.ecell.col);
a.SetECellHeaders("");a.cellhandles.ShowCellHandles(!1)}else SocialCalc.Callbacks.broadcast&&SocialCalc.Callbacks.broadcast("ecell",{ecell:c});c=a.context.cellskip[c]||c;a.ecell=SocialCalc.coordToCr(c);a.ecell.coord=c;b=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col);e[c]="cursor";for(d in a.MoveECellCallback)a.MoveECellCallback[d](a);a.UpdateCellCSS(b,a.ecell.row,a.ecell.col);a.SetECellHeaders("selected");for(d in a.StatusCallback)a.StatusCallback[d].func(a,"moveecell",c,a.StatusCallback[d].params);
a.busy?a.ensureecell=!0:(a.ensureecell=!1,a.EnsureECellVisible());return c};SocialCalc.EnsureECellVisible=function(a){var c=0,b=0;a.ecell.row>a.lastnonscrollingrow&&(a.ecell.row<a.firstscrollingrow?c=a.ecell.row-a.firstscrollingrow:a.ecell.row>a.lastvisiblerow&&(c=a.ecell.row-a.lastvisiblerow));a.ecell.col>a.lastnonscrollingcol&&(a.ecell.col<a.firstscrollingcol?b=a.ecell.col-a.firstscrollingcol:a.ecell.col>a.lastvisiblecol&&(b=a.ecell.col-a.lastvisiblecol));c!=0||b!=0?a.ScrollRelativeBoth(c,b):a.cellhandles.ShowCellHandles(!0)};
SocialCalc.ReplaceCell=function(a,c,b,d){var e;if(c&&(a=a.context.RenderCell(b,d,c.rowpane,c.colpane,!0,null)))for(e in c.element.innerHTML=a.innerHTML,c.element.style.cssText="",c.element.className=a.className,a.style)a.style[e]!="cssText"&&(c.element.style[e]=a.style[e])};
SocialCalc.UpdateCellCSS=function(a,c,b,d){var e;if(c&&(a=a.context.RenderCell(b,d,c.rowpane,c.colpane,!0,null)))for(e in c.element.style.cssText="",c.element.className=a.className,a.style)a.style[e]!="cssText"&&(c.element.style[e]=a.style[e])};
SocialCalc.SetECellHeaders=function(a,c){var b=a.ecell,d=a.context,e,g,h,j=0,k=0,m;if(b){for(e=0;e<d.rowpanes.length;e++){g=d.rowpanes[e].first;h=d.rowpanes[e].last;if(b.row>=g&&b.row<=h&&(m=a.fullgrid.childNodes[1].childNodes[2+j+b.row-g].childNodes[0])){if(d.classnames)m.className=d.classnames[c+"rowname"];if(d.explicitStyles)m.style.cssText=d.explicitStyles[c+"rowname"];m.style.verticalAlign="top"}j+=h-g+2}for(e=0;e<d.colpanes.length;e++){g=d.colpanes[e].first;h=d.colpanes[e].last;if(b.col>=g&&
b.col<=h&&(m=a.fullgrid.childNodes[1].childNodes[1].childNodes[1+k+b.col-g])){if(d.classnames)m.className=d.classnames[c+"colname"];if(d.explicitStyles)m.style.cssText=d.explicitStyles[c+"colname"]}k+=h-g+2}}};SocialCalc.RangeAnchor=function(a,c){a.range.hasrange&&a.RangeRemove();a.RangeExtend(c)};
SocialCalc.RangeExtend=function(a,c){var b,d,e,g,h,j,k=a.context.highlights;b=a.range;d=a.range2;c?(g=SocialCalc.coordToCr(c),g.coord=c):g=a.ecell;if(g){if(!b.hasrange)b.anchorcoord=g.coord,b.anchorrow=g.row,b.top=g.row,b.bottom=g.row,b.anchorcol=g.col,b.left=g.col,b.right=g.col,b.hasrange=!0;b.anchorrow<g.row?(b.top=b.anchorrow,b.bottom=g.row):(b.top=g.row,b.bottom=b.anchorrow);b.anchorcol<g.col?(b.left=b.anchorcol,b.right=g.col):(b.left=g.col,b.right=b.anchorcol);for(e in k)switch(k[e]){case "range":k[e]=
"unrange";break;case "range2":k[e]="unrange2"}for(g=b.top;g<=b.bottom;g++)for(h=b.left;h<=b.right;h++)switch(e=SocialCalc.crToCoord(h,g),k[e]){case "unrange":k[e]="range";break;case "cursor":break;default:k[e]="newrange"}for(g=d.top;d.hasrange&&g<=d.bottom;g++)for(h=d.left;h<=d.right;h++)switch(e=SocialCalc.crToCoord(h,g),k[e]){case "unrange2":k[e]="range2";break;case "range":case "newrange":case "cursor":break;default:k[e]="newrange2"}for(e in k){switch(k[e]){case "unrange":delete k[e];break;case "newrange":k[e]=
"range";break;case "newrange2":k[e]="range2";break;case "range":case "range2":case "cursor":continue}d=SocialCalc.coordToCr(e);b=SocialCalc.GetEditorCellElement(a,d.row,d.col);a.UpdateCellCSS(b,d.row,d.col)}for(j in a.RangeChangeCallback)a.RangeChangeCallback[j](a);e=SocialCalc.crToCoord(a.range.left,a.range.top);if(a.range.left!=a.range.right||a.range.top!=a.range.bottom)e+=":"+SocialCalc.crToCoord(a.range.right,a.range.bottom);for(j in a.StatusCallback)a.StatusCallback[j].func(a,"rangechange",e,
a.StatusCallback[j].params)}};
SocialCalc.RangeRemove=function(a){var c,b,d,e,g=a.context.highlights,h=a.range,j=a.range2;if(h.hasrange||j.hasrange){for(c=j.top;j.hasrange&&c<=j.bottom;c++)for(b=j.left;b<=j.right;b++)switch(d=SocialCalc.crToCoord(b,c),g[d]){case "range":g[d]="newrange2";break;case "range2":case "cursor":break;default:g[d]="newrange2"}for(d in g){switch(g[d]){case "range":delete g[d];break;case "newrange2":g[d]="range2";break;case "cursor":continue}b=SocialCalc.coordToCr(d);c=SocialCalc.GetEditorCellElement(a,b.row,
b.col);a.UpdateCellCSS(c,b.row,b.col)}h.hasrange=!1;for(e in a.RangeChangeCallback)a.RangeChangeCallback[e](a);for(e in a.StatusCallback)a.StatusCallback[e].func(a,"rangechange","",a.StatusCallback[e].params)}};
SocialCalc.Range2Remove=function(a){var c,b,d,e=a.context.highlights,g=a.range2;if(g.hasrange){for(d in e){switch(e[d]){case "range2":delete e[d];break;case "range":case "cursor":continue}b=SocialCalc.coordToCr(d);c=SocialCalc.GetEditorCellElement(a,b.row,b.col);a.UpdateCellCSS(c,b.row,b.col)}g.hasrange=!1}};
SocialCalc.FitToEditTable=function(a){var c,b,d,e=a.context,g=e.sheetobj;d=e.showRCHeaders?e.rownamewidth-0:0;for(colpane=0;colpane<e.colpanes.length-1;colpane++)for(c=e.colpanes[colpane].first;c<=e.colpanes[colpane].last;c++){b=SocialCalc.rcColname(c);b=g.colattribs.width[b]||g.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(b=="blank"||b=="auto")b="";d+=b&&b-0>0?b-0:10}for(c=e.colpanes[colpane].first;c<=1E4;c++){b=SocialCalc.rcColname(c);b=g.colattribs.width[b]||g.attribs.defaultcolwidth||
SocialCalc.Constants.defaultColWidth;if(b=="blank"||b=="auto")b="";d+=b&&b-0>0?b-0:10;if(d>a.tablewidth)break}e.colpanes[colpane].last=c;c=e.showRCHeaders?1:0;for(d=0;d<e.rowpanes.length-1;d++)c+=e.rowpanes[d].last-e.rowpanes[d].first+1;e.rowpanes[d].last=e.rowpanes[d].first+Math.floor((a.tableheight-c*e.pixelsPerRow)/e.pixelsPerRow)+1};
SocialCalc.CalculateEditorPositions=function(a){var c;a.gridposition=SocialCalc.GetElementPosition(a.griddiv);a.headposition=SocialCalc.GetElementPosition(a.griddiv.firstChild.lastChild.childNodes[2].childNodes[1]);a.rowpositions=[];for(c=0;c<a.context.rowpanes.length;c++)a.CalculateRowPositions(c,a.rowpositions,a.rowheight);for(c=0;c<a.rowpositions.length;c++)if(a.rowpositions[c]>a.gridposition.top+a.tableheight)break;a.lastvisiblerow=c-1;a.colpositions=[];for(c=0;c<a.context.colpanes.length;c++)a.CalculateColPositions(c,
a.colpositions,a.colwidth);for(c=0;c<a.colpositions.length;c++)if(a.colpositions[c]>a.gridposition.left+a.tablewidth)break;a.lastvisiblecol=c-1;a.firstscrollingrow=a.context.rowpanes[a.context.rowpanes.length-1].first;a.firstscrollingrowtop=a.rowpositions[a.firstscrollingrow]||a.headposition.top;a.lastnonscrollingrow=a.context.rowpanes.length-1>0?a.context.rowpanes[a.context.rowpanes.length-2].last:0;a.firstscrollingcol=a.context.colpanes[a.context.colpanes.length-1].first;a.firstscrollingcolleft=
a.colpositions[a.firstscrollingcol]||a.headposition.left;a.lastnonscrollingcol=a.context.colpanes.length-1>0?a.context.colpanes[a.context.colpanes.length-2].last:0;a.verticaltablecontrol.ComputeTableControlPositions();a.horizontaltablecontrol.ComputeTableControlPositions()};
SocialCalc.ScheduleRender=function(a){a.timeout&&window.clearTimeout(a.timeout);SocialCalc.EditorSheetStatusCallback(null,"schedrender",null,a);SocialCalc.EditorStepInfo.editor=a;a.timeout=window.setTimeout(SocialCalc.DoRenderStep,1)};
SocialCalc.DoRenderStep=function(){var a=SocialCalc.EditorStepInfo.editor;a.timeout=null;a.EditorRenderSheet();SocialCalc.EditorSheetStatusCallback(null,"renderdone",null,a);SocialCalc.EditorSheetStatusCallback(null,"schedposcalc",null,a);a.timeout=window.setTimeout(SocialCalc.DoPositionCalculations,1)};
SocialCalc.SchedulePositionCalculations=function(a){SocialCalc.EditorStepInfo.editor=a;SocialCalc.EditorSheetStatusCallback(null,"schedposcalc",null,a);a.timeout=window.setTimeout(SocialCalc.DoPositionCalculations,1)};
SocialCalc.DoPositionCalculations=function(){var a=SocialCalc.EditorStepInfo.editor;a.timeout=null;var c=!1;try{a.CalculateEditorPositions(),c=!0}catch(b){}if(c){a.verticaltablecontrol.PositionTableControlElements();a.horizontaltablecontrol.PositionTableControlElements();SocialCalc.EditorSheetStatusCallback(null,"doneposcalc",null,a);if(a.ensureecell&&a.ecell&&!a.deferredCommands.length)a.ensureecell=!1,a.EnsureECellVisible();a.cellhandles.ShowCellHandles(!0);SocialCalc.Callbacks.broadcast&&SocialCalc.Callbacks.broadcast("ask.ecell")}else typeof $!=
"undefined"&&($(window).trigger("resize"),setTimeout(SocialCalc.DoPositionCalculations,400))};SocialCalc.CalculateRowPositions=function(a,c,b,d){var e,g,h,j,k=a.context,m;if(!k.showRCHeaders)throw"Needs showRCHeaders=true";m=a.fullgrid.lastChild;a=2;for(e=0;e<c;e++)a+=k.rowpanes[e].last-k.rowpanes[e].first+2;g=0;for(c=k.rowpanes[e].first;c<=k.rowpanes[e].last;c++)if(h=m.childNodes[a+g],g++,j=SocialCalc.GetElementPosition(h.firstChild),!b[c])b[c]=j.top,d[c]=h.firstChild.offsetHeight};
SocialCalc.CalculateColPositions=function(a,c,b,d){var e,g,h,j,k=a.context;if(!k.showRCHeaders)throw"Needs showRCHeaders=true";g=a.fullgrid.lastChild;a=1;for(e=0;e<c;e++)a+=k.colpanes[e].last-k.colpanes[e].first+2;h=g.childNodes[1];g=0;for(c=k.colpanes[e].first;c<=k.colpanes[e].last;c++){j=SocialCalc.GetElementPosition(h.childNodes[a+g]);if(!b[c]&&(b[c]=j.left,h.childNodes[a+g]))d[c]=h.childNodes[a+g].offsetWidth;g++}};
SocialCalc.ScrollRelative=function(a,c,b){c?a.ScrollRelativeBoth(b,0):a.ScrollRelativeBoth(0,b)};
SocialCalc.ScrollRelativeBoth=function(a,c,b){var d=a.context,e=d.rowpanes.length,g=e>1?d.rowpanes[e-2].last+1:1;d.rowpanes[e-1].first+c<g&&(c=-d.rowpanes[e-1].first+g);var g=d.colpanes.length,h=g>1?d.colpanes[g-2].last+1:1;d.colpanes[g-1].first+b<h&&(b=-d.colpanes[g-1].first+h);if((c==1||c==-1)&&b==0)c==1?a.ScrollTableUpOneRow():a.ScrollTableDownOneRow(),a.ecell&&a.SetECellHeaders("selected"),a.SchedulePositionCalculations();else if(c!=0||b!=0)d.rowpanes[e-1].first+=c,d.rowpanes[e-1].last+=c,d.colpanes[g-
1].first+=b,d.colpanes[g-1].last+=b,a.FitToEditTable(),a.ScheduleRender()};
SocialCalc.PageRelative=function(a,c,b){var d=a.context,e=c?"rowpanes":"colpanes",d=d[e][d[e].length-1],g=c?"lastvisiblerow":"lastvisiblecol",e=c?a.rowheight:a.colwidth,h=c?SocialCalc.Constants.defaultAssumedRowHeight:SocialCalc.Constants.defaultColWidth;if(b>0)c=a[g],c==d.first&&(c+=1);else{b=c?a.tableheight-(a.firstscrollingrowtop-a.gridposition.top):a.tablewidth-(a.firstscrollingcolleft-a.gridposition.left);b-=e[a[g]]>0?e[a[g]]:h;for(c=d.first-1;c>0;c--){g=e[c]>0?e[c]:h;if(b<g)break;b-=g}e=d.first;
c>=e&&(c=e-1);c<1&&(c=1)}d.first=c;d.last=c+1;a.LimitLastPanes();a.FitToEditTable();a.ScheduleRender()};SocialCalc.LimitLastPanes=function(a){var a=a.context,c;c=a.rowpanes.length;if(c>1&&a.rowpanes[c-1].first<=a.rowpanes[c-2].last)a.rowpanes[c-1].first=a.rowpanes[c-2].last+1;c=a.colpanes.length;if(c>1&&a.colpanes[c-1].first<=a.colpanes[c-2].last)a.colpanes[c-1].first=a.colpanes[c-2].last+1};
SocialCalc.ScrollTableUpOneRow=function(a){var c,b,d,e,g,h,j={},k=a.context,m=k.sheetobj,n=a.fullgrid,s;s=n.lastChild;c=k.showRCHeaders?2:1;for(b=0;b<k.rowpanes.length-1;b++)c+=k.rowpanes[b].last-k.rowpanes[b].first+2;s.removeChild(s.childNodes[c]);k.rowpanes[b].first++;k.rowpanes[b].last++;a.FitToEditTable();k.CalculateColWidthData();a=k.RenderRow(k.rowpanes[b].last,b);s.appendChild(a);maxrowspan=1;a=k.rowpanes[b].first-1;for(g=0;g<k.colpanes.length;g++)for(e=k.colpanes[g].first;e<=k.colpanes[g].last;e++)if(coord=
SocialCalc.crToCoord(e,a),!k.cellskip[coord]&&(h=m.cells[coord])&&h.rowspan>maxrowspan)maxrowspan=h.rowspan;if(maxrowspan>1)for(d=1;d<maxrowspan;d++){if(d+a>=k.rowpanes[b].last)break;e=k.RenderRow(d+a,b);g=s.childNodes[c+d-1];s.replaceChild(e,g)}a=k.rowpanes[b].last;for(g=0;g<k.colpanes.length;g++)for(e=k.colpanes[g].first;e<=k.colpanes[g].last;e++)if(coord=k.cellskip[SocialCalc.crToCoord(e,a)])d=k.coordToCR[coord].row-0,d==k.rowpanes[b].last||d<k.rowpanes[b].first||(h=m.cells[coord])&&h.rowspan>
1&&(j[d]=!0);for(d in j)e=k.RenderRow(d,b),g=s.childNodes[c+(d-k.rowpanes[b].first)],s.replaceChild(e,g);return n};
SocialCalc.ScrollTableDownOneRow=function(a){var c,b,d,e,g,h,j={},k=a.context,m=k.sheetobj,n=a.fullgrid,s;s=n.lastChild;c=k.showRCHeaders?2:1;for(b=0;b<k.rowpanes.length-1;b++)c+=k.rowpanes[b].last-k.rowpanes[b].first+2;s.removeChild(s.childNodes[c+(k.rowpanes[b].last-k.rowpanes[b].first)]);k.rowpanes[b].first--;k.rowpanes[b].last--;a.FitToEditTable();k.CalculateColWidthData();e=k.RenderRow(k.rowpanes[b].first,b);s.insertBefore(e,s.childNodes[c]);maxrowspan=1;a=k.rowpanes[b].first;for(g=0;g<k.colpanes.length;g++)for(e=
k.colpanes[g].first;e<=k.colpanes[g].last;e++)if(coord=SocialCalc.crToCoord(e,a),!k.cellskip[coord]&&(h=m.cells[coord])&&h.rowspan>maxrowspan)maxrowspan=h.rowspan;if(maxrowspan>1)for(d=1;d<maxrowspan;d++){if(d+a>k.rowpanes[b].last)break;e=k.RenderRow(d+a,b);g=s.childNodes[c+d];s.replaceChild(e,g)}a=k.rowpanes[b].last;for(g=0;g<k.colpanes.length;g++)for(e=k.colpanes[g].first;e<=k.colpanes[g].last;e++)if(coord=SocialCalc.crToCoord(e,a),(h=m.cells[coord])&&h.rowspan>1)j[a]=!0;else if(coord=k.cellskip[SocialCalc.crToCoord(e,
a)])d=k.coordToCR[coord].row-0,d==a||d<k.rowpanes[b].first||(h=m.cells[coord])&&h.rowspan>1&&(j[d]=!0);for(d in j)e=k.RenderRow(d,b),g=s.childNodes[c+(d-k.rowpanes[b].first)],s.replaceChild(e,g);return n};SocialCalc.InputBox=function(a,c){if(a)this.element=a,this.editor=c,this.inputEcho=null,c.inputBox=this,a.onmousedown=SocialCalc.InputBoxOnMouseDown,c.MoveECellCallback.formulabar=function(a){a.state=="start"&&c.inputBox.DisplayCellContents(a.ecell.coord)}};
SocialCalc.InputBox.prototype.DisplayCellContents=function(a){SocialCalc.InputBoxDisplayCellContents(this,a)};SocialCalc.InputBox.prototype.ShowInputBox=function(a){this.editor.inputEcho.ShowInputEcho(a)};SocialCalc.InputBox.prototype.GetText=function(){return this.element.value};SocialCalc.InputBox.prototype.SetText=function(a){if(this.element)this.element.value=a,this.editor.inputEcho.SetText(a+"_")};SocialCalc.InputBox.prototype.Focus=function(){SocialCalc.InputBoxFocus(this)};
SocialCalc.InputBox.prototype.Blur=function(){return this.element.blur()};
SocialCalc.InputBox.prototype.Select=function(a){if(this.element)switch(a){case "end":if(document.selection&&document.selection.createRange)try{var c=document.selection.createRange().duplicate();c.moveToElementText(this.element);c.collapse(!1);c.select()}catch(b){if(this.element.selectionStart!=void 0)this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length}else if(this.element.selectionStart!=void 0)this.element.selectionStart=this.element.value.length,
this.element.selectionEnd=this.element.value.length}};SocialCalc.InputBoxDisplayCellContents=function(a,c){var b=SocialCalc.Constants;if(a){if(!c)c=a.editor.ecell.coord;var d=SocialCalc.GetCellContents(a.editor.context.sheetobj,c);d.indexOf("\n")!=-1?(d=b.s_inputboxdisplaymultilinetext,a.element.disabled=!0):a.element.disabled=!1;a.SetText(d)}};
SocialCalc.InputBoxFocus=function(a){if(a){a.element.focus();a=a.editor;a.state="input";var c=a.workingvalues;c.partialexpr="";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col}};
SocialCalc.InputBoxOnMouseDown=function(){var a=SocialCalc.Keyboard.focusTable;if(!a)return!0;var c=a.workingvalues;switch(a.state){case "start":a.state="inputboxdirect";c.partialexpr="";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col;a.inputEcho.ShowInputEcho(!0);break;case "input":c.partialexpr="",a.MoveECell(c.ecoord),a.state="inputboxdirect",SocialCalc.KeyboardFocus()}};
SocialCalc.InputEcho=function(a){var c=SocialCalc.Constants;this.editor=a;this.text="";this.functionbox=this.prompt=this.main=this.container=this.interval=null;this.container=document.createElement("div");SocialCalc.setStyles(this.container,"display:none;position:absolute;zIndex:10;");this.main=document.createElement("div");if(c.defaultInputEchoClass)this.main.className=c.defaultInputEchoClass;c.defaultInputEchoStyle&&SocialCalc.setStyles(this.main,c.defaultInputEchoStyle);this.main.innerHTML="&nbsp;";
this.container.appendChild(this.main);this.prompt=document.createElement("div");if(c.defaultInputEchoPromptClass)this.prompt.className=c.defaultInputEchoPromptClass;c.defaultInputEchoPromptStyle&&SocialCalc.setStyles(this.prompt,c.defaultInputEchoPromptStyle);this.prompt.innerHTML="";this.container.appendChild(this.prompt);SocialCalc.DragRegister(this.main,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,
positionobj:this.container});a.toplevel.appendChild(this.container)};SocialCalc.InputEcho.prototype.ShowInputEcho=function(a){return SocialCalc.ShowInputEcho(this,a)};SocialCalc.InputEcho.prototype.SetText=function(a){return SocialCalc.SetInputEchoText(this,a)};
SocialCalc.ShowInputEcho=function(a,c){var b;if(b=a.editor)if(c){b.cellhandles.ShowCellHandles(!1);if(b=SocialCalc.GetEditorCellElement(b,b.ecell.row,b.ecell.col))b=SocialCalc.GetElementPosition(b.element),a.container.style.left=b.left-1+"px",a.container.style.top=b.top-1+"px";a.container.style.display="block";a.interval&&window.clearInterval(a.interval);a.interval=window.setInterval(SocialCalc.InputEchoHeartbeat,50)}else a.interval&&window.clearInterval(a.interval),a.container.style.display="none"};
SocialCalc.SetInputEchoText=function(a,c){var b=SocialCalc.Constants,d;d=SocialCalc.special_chars(c);d=d.replace(/\n/g,"<br>");if(a.text!=d)a.main.innerHTML=d,a.text=d;d=c.match(/.*[\+\-\*\/\&\^\<\>\=\,\(]([A-Za-z][A-ZA-z]\w*?)\([^\)]*$/);if(c.charAt(0)=="="&&d){if(d=d[1].toUpperCase(),SocialCalc.Formula.FunctionList[d]?(SocialCalc.Formula.FillFunctionInfo(),b=SocialCalc.special_chars(d+"("+SocialCalc.Formula.FunctionArgString(d)+")")):b=b.ietUnknownFunction+d,a.prompt.innerHTML!=b)a.prompt.innerHTML=
b,a.prompt.style.display="block"}else if(a.prompt.style.display!="none")a.prompt.innerHTML="",a.prompt.style.display="none"};SocialCalc.InputEchoHeartbeat=function(){var a=SocialCalc.Keyboard.focusTable;if(!a)return!0;a.inputEcho.SetText(a.inputBox.GetText()+"_")};SocialCalc.InputEchoMouseDown=function(){var a=SocialCalc.Keyboard.focusTable;if(!a)return!0;a.inputBox.element.focus()};
SocialCalc.CellHandles=function(a){if(!a.noEdit){this.editor=a;this.movedmouse=this.noCursorSuffix=!1;this.draghandle=document.createElement("div");SocialCalc.setStyles(this.draghandle,"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;");this.draghandle.innerHTML="&nbsp;";a.toplevel.appendChild(this.draghandle);SocialCalc.AssignID(a,this.draghandle,"draghandle");var c="png";navigator.userAgent.match(/MSIE 6\.0/)&&
(c="gif");this.dragpalette=document.createElement("div");SocialCalc.setStyles(this.dragpalette,"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url("+SocialCalc.Constants.defaultImagePrefix+"drag-handles."+c+");");this.dragpalette.innerHTML="&nbsp;";a.toplevel.appendChild(this.dragpalette);SocialCalc.AssignID(a,this.dragpalette,"dragpalette");this.dragtooltip=document.createElement("div");SocialCalc.setStyles(this.dragtooltip,
"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;");this.dragtooltip.innerHTML="&nbsp;";a.toplevel.appendChild(this.dragtooltip);SocialCalc.AssignID(a,this.dragtooltip,"dragtooltip");this.fillinghandle=document.createElement("div");SocialCalc.setStyles(this.fillinghandle,"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;");this.fillinghandle.innerHTML=
"&nbsp;";a.toplevel.appendChild(this.fillinghandle);SocialCalc.AssignID(a,this.fillinghandle,"fillinghandle");if(this.draghandle.addEventListener)this.draghandle.addEventListener("mousemove",SocialCalc.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener("mousedown",SocialCalc.CellHandlesMouseDown,!1),this.dragpalette.addEventListener("mousemove",SocialCalc.CellHandlesMouseMoveOnHandle,!1);else if(this.draghandle.attachEvent)this.draghandle.attachEvent("onmousemove",SocialCalc.CellHandlesMouseMoveOnHandle),
this.dragpalette.attachEvent("onmousedown",SocialCalc.CellHandlesMouseDown),this.dragpalette.attachEvent("onmousemove",SocialCalc.CellHandlesMouseMoveOnHandle);else throw"Browser not supported";}};SocialCalc.CellHandles.prototype.ShowCellHandles=function(a,c){return SocialCalc.ShowCellHandles(this,a,c)};
SocialCalc.ShowCellHandles=function(a,c,b){var d=a.editor,e=!1,g;if(d){if(c&&(c=d.ecell.row,g=d.ecell.col,d.state=="start"&&!(c>=d.lastvisiblerow)&&!(g>=d.lastvisiblecol)&&!(c<d.firstscrollingrow)&&!(g<d.firstscrollingcol)&&!(d.rowpositions[c+1]+20>d.horizontaltablecontrol.controlborder)&&!(d.rowpositions[c+1]-10<d.headposition.top)&&!(d.colpositions[g+1]+20>d.verticaltablecontrol.controlborder)&&!(d.colpositions[g+1]-30<d.headposition.left))){a.draghandle.style.left=d.colpositions[g+1]-1+"px";a.draghandle.style.top=
d.rowpositions[c+1]-1+"px";a.draghandle.style.display="block";if(b)a.draghandle.style.display="none",a.dragpalette.style.left=d.colpositions[g+1]-45+"px",a.dragpalette.style.top=d.rowpositions[c+1]-45+"px",a.dragpalette.style.display="block",e=SocialCalc.GetViewportInfo(),a.dragtooltip.style.right=e.width-(d.colpositions[g+1]-1)+"px",a.dragtooltip.style.bottom=e.height-(d.rowpositions[c+1]-1)+"px",a.dragtooltip.style.display="none";e=!0}if(!e)a.draghandle.style.display="none";if(!b)a.dragpalette.style.display=
"none",a.dragtooltip.style.display="none"}};
SocialCalc.CellHandlesMouseMoveOnHandle=function(a){var c=SocialCalc.Constants,b=a||window.event,a=b.target||b.srcElement,d=SocialCalc.GetViewportInfo(),e=b.clientX+d.horizontalScroll,d=b.clientY+d.verticalScroll;editor=SocialCalc.Keyboard.focusTable;if(!editor)return!0;b=editor.cellhandles;if(!b.editor)return!0;if(!editor.cellhandles.mouseDown){editor.cellhandles.ShowCellHandles(!0,!0);if(a==b.dragpalette){c=SocialCalc.SegmentDivHit([c.CH_radius1,c.CH_radius2],editor.cellhandles.dragpalette,e,d);
if(c==0){SocialCalc.CellHandlesHoverTimeout();return}if(b.tooltipstimer)window.clearTimeout(b.tooltipstimer),b.tooltipstimer=null;b.tooltipswhichhandle=c;b.tooltipstimer=window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout,700)}if(b.timer)window.clearTimeout(b.timer),b.timer=null;b.timer=window.setTimeout(SocialCalc.CellHandlesHoverTimeout,3E3)}};
SocialCalc.SegmentDivHit=function(a,c,b,d){var e=c.offsetWidth,g=c.offsetHeight,h=c.offsetLeft,c=c.offsetTop,j=0,k=a,m=Math.sqrt(Math.pow(b-h-(e/2-0.5),2)+Math.pow(d-c-(g/2-0.5),2));if(k.length==2)return b>=h&&b<h+e/2&&d>=c&&d<c+g/2&&(m<=a[0]?j=-1:m<=a[1]&&(j=1)),b>=h+e/2&&b<h+e&&d>=c&&d<c+g/2&&(m<=a[0]?j=-2:m<=a[1]&&(j=2)),b>=h+e/2&&b<h+e&&d>=c+g/2&&d<c+g&&(m<=a[0]?j=-3:m<=a[1]&&(j=3)),b>=h&&b<h+e/2&&d>=c+g/2&&d<c+g&&(m<=a[0]?j=-4:m<=a[1]&&(j=4)),j;for(;;)if(b>=h&&b<h+e/2&&d>=c&&d<c+g/2){quadrant+=
"1";j=k[0];if(typeof j=="number")break;k=j;e/=2;g/=2}else if(b>=h+e/2&&b<h+e&&d>=c&&d<c+g/2){quadrant+="2";j=k[1];if(typeof j=="number")break;k=j;e/=2;h+=e;g/=2}else if(b>=h+e/2&&b<h+e&&d>=c+g/2&&d<c+g){quadrant+="3";j=k[2];if(typeof j=="number")break;k=j;e/=2;h+=e;g/=2;c+=g}else if(b>=h&&b<h+e/2&&d>=c+g/2&&d<c+g){quadrant+="4";j=k[3];if(typeof j=="number")break;k=j;e/=2;g/=2;c+=g}else return 0;return j};
SocialCalc.CellHandlesHoverTimeout=function(){editor=SocialCalc.Keyboard.focusTable;if(!editor)return!0;var a=editor.cellhandles;if(a.timer)window.clearTimeout(a.timer),a.timer=null;if(a.tooltipstimer)window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null;editor.cellhandles.ShowCellHandles(!0,!1)};
SocialCalc.CellHandlesTooltipsTimeout=function(){editor=SocialCalc.Keyboard.focusTable;if(!editor)return!0;var a=editor.cellhandles;if(a.tooltipstimer)window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null;var c=a.tooltipswhichhandle;if(c==0)SocialCalc.CellHandlesHoverTimeout();else{if(c==-3)a.dragtooltip.innerHTML=scc.s_CHfillAllTooltip;else if(c==3)a.dragtooltip.innerHTML=scc.s_CHfillContentsTooltip;else if(c==-2)a.dragtooltip.innerHTML=scc.s_CHmovePasteAllTooltip;else if(c==-4)a.dragtooltip.innerHTML=
scc.s_CHmoveInsertAllTooltip;else if(c==2)a.dragtooltip.innerHTML=scc.s_CHmovePasteContentsTooltip;else if(c==4)a.dragtooltip.innerHTML=scc.s_CHmoveInsertContentsTooltip;else{a.dragtooltip.innerHTML="&nbsp;";a.dragtooltip.style.display="none";return}a.dragtooltip.style.display="block"}};
SocialCalc.CellHandlesMouseDown=function(a){var c=SocialCalc.Constants,b,d,a=a||window.event;b=SocialCalc.GetViewportInfo();var e=a.clientX+b.horizontalScroll,g=a.clientY+b.verticalScroll,h=SocialCalc.EditorMouseInfo;b=SocialCalc.Keyboard.focusTable;if(!b)return!0;if(!b.busy){var j=b.cellhandles;j.movedmouse=!1;if(j.timer)window.clearTimeout(j.timer),j.timer=null;if(j.tooltipstimer)window.clearTimeout(j.tooltipstimer),j.tooltipstimer=null;j.dragtooltip.innerHTML="&nbsp;";j.dragtooltip.style.display=
"none";d=b.range;var k=SocialCalc.SegmentDivHit([c.CH_radius1,c.CH_radius2],b.cellhandles.dragpalette,e,g);if(k==1||k==-1||k==0)j.ShowCellHandles(!0,!1);else{h.ignore=!0;if(k==-3)j.dragtype="Fill",j.noCursorSuffix=!1;else if(k==3)j.dragtype="FillC",j.noCursorSuffix=!1;else if(k==-2)j.dragtype="Move",j.noCursorSuffix=!0;else if(k==-4)j.dragtype="MoveI",j.noCursorSuffix=!1;else if(k==2)j.dragtype="MoveC",j.noCursorSuffix=!0;else if(k==4)j.dragtype="MoveIC",j.noCursorSuffix=!1;j.filltype=null;switch(j.dragtype){case "Fill":case "FillC":d.hasrange||
b.RangeAnchor();break;case "Move":case "MoveI":case "MoveC":case "MoveIC":d.hasrange||b.RangeAnchor();b.range2.top=b.range.top;b.range2.right=b.range.right;b.range2.bottom=b.range.bottom;b.range2.left=b.range.left;b.range2.hasrange=!0;b.RangeRemove();break;default:return}j.fillinghandle.style.left=e+"px";j.fillinghandle.style.top=g-17+"px";j.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[j.dragtype]+(c.s_CHindicatorDirectionLookup[b.cellhandles.filltype]||"");j.fillinghandle.style.display=
"block";j.ShowCellHandles(!0,!1);j.mouseDown=!0;h.editor=b;c=b.ecell.coord;j.startingcoord=c;j.startingX=e;j.startingY=g;h.mouselastcoord=c;SocialCalc.KeyboardSetFocus(b);document.addEventListener?(document.addEventListener("mousemove",SocialCalc.CellHandlesMouseMove,!0),document.addEventListener("mouseup",SocialCalc.CellHandlesMouseUp,!0)):j.draghandle.attachEvent&&(j.draghandle.setCapture(),j.draghandle.attachEvent("onmousemove",SocialCalc.CellHandlesMouseMove),j.draghandle.attachEvent("onmouseup",
SocialCalc.CellHandlesMouseUp),j.draghandle.attachEvent("onlosecapture",SocialCalc.CellHandlesMouseUp));a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}}};
SocialCalc.CellHandlesMouseMove=function(a){var c=SocialCalc.Constants,b,d,e,g,a=a||window.event;b=SocialCalc.GetViewportInfo();var h=a.clientX+b.horizontalScroll,j=a.clientY+b.verticalScroll,k=SocialCalc.EditorMouseInfo;if(b=k.editor){var m=b.cellhandles;if(d=SocialCalc.GridMousePosition(b,h,j))if(d&&!d.coord)SocialCalc.SetDragAutoRepeat(b,d,SocialCalc.CellHandlesDragAutoRepeat);else if(SocialCalc.SetDragAutoRepeat(b,null),d.coord){e=SocialCalc.coordToCr(b.cellhandles.startingcoord);g=SocialCalc.coordToCr(d.coord);
m.movedmouse=!0;switch(m.dragtype){case "Fill":case "FillC":if(d.coord==m.startingcoord)m.filltype=null,m.startingX=h,m.startingY=j;else if(m.filltype)if(m.filltype=="Down"){if(g.col=e.col,g.row<e.row)g.row=e.row}else{if(g.row=e.row,g.col<e.col)g.col=e.col}else{if(Math.abs(j-m.startingY)>10)m.filltype="Down";else if(Math.abs(h-m.startingX)>10)m.filltype="Right";g.col=e.col;g.row=e.row}d.coord=SocialCalc.crToCoord(g.col,g.row);d.coord!=k.mouselastcoord&&(b.MoveECell(d.coord),b.RangeExtend());break;
case "Move":case "MoveC":d.coord!=k.mouselastcoord&&(b.MoveECell(d.coord),e=b.range2.right-b.range2.left+d.col,g=b.range2.bottom-b.range2.top+d.row,b.RangeAnchor(SocialCalc.crToCoord(e,g)),b.RangeExtend());break;case "MoveI":case "MoveIC":if(d.coord==m.startingcoord)m.filltype=null,m.startingX=h,m.startingY=j;else if(m.filltype)if(m.filltype=="Vertical"){if(g.col=b.range2.left,g.row>=b.range2.top&&g.row<=b.range2.bottom+1)g.row=b.range2.bottom+2}else{if(g.row=b.range2.top,g.col>=b.range2.left&&g.col<=
b.range2.right+1)g.col=b.range2.right+2}else{if(Math.abs(j-m.startingY)>10)m.filltype="Vertical";else if(Math.abs(h-m.startingX)>10)m.filltype="Horizontal";g.col=e.col;g.row=e.row}d.coord=SocialCalc.crToCoord(g.col,g.row);d.coord!=k.mouselastcoord&&(b.MoveECell(d.coord),m.filltype?(e=b.range2.right-b.range2.left+g.col,g=b.range2.bottom-b.range2.top+g.row,b.RangeAnchor(SocialCalc.crToCoord(e,g)),b.RangeExtend()):b.RangeRemove())}m.fillinghandle.style.left=h+"px";m.fillinghandle.style.top=j-17+"px";
m.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[m.dragtype]+(c.s_CHindicatorDirectionLookup[b.cellhandles.filltype]||"");m.fillinghandle.style.display="block";k.mouselastcoord=d.coord;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}}};
SocialCalc.CellHandlesDragAutoRepeat=function(a,c){var b=SocialCalc.EditorMouseInfo,d=b.editor;if(d){var e=d.cellhandles,g=SocialCalc.coordToCr(d.cellhandles.startingcoord),h=SocialCalc.coordToCr(a),j,k=0,m=0;c=="left"?m=-1:c=="right"?m=1:c=="up"?k=-1:c=="down"&&(k=1);d.ScrollRelativeBoth(k,m);switch(e.dragtype){case "Fill":case "FillC":if(e.filltype)if(e.filltype=="Down"){if(h.col=g.col,h.row<g.row)h.row=g.row}else{if(h.row=g.row,h.col<g.col)h.col=g.col}else h.col=g.col,h.row=g.row;j=SocialCalc.crToCoord(h.col,
h.row);j!=b.mouselastcoord&&(d.MoveECell(a),d.RangeExtend());break;case "Move":case "MoveC":a!=b.mouselastcoord&&(d.MoveECell(a),e=d.range2.right-d.range2.left+d.ecell.col,h=d.range2.bottom-d.range2.top+d.ecell.row,d.RangeAnchor(SocialCalc.crToCoord(e,h)),d.RangeExtend());break;case "MoveI":case "MoveIC":if(e.filltype)if(e.filltype=="Vertical"){if(h.col=d.range2.left,h.row>=d.range2.top&&h.row<=d.range2.bottom+1)h.row=d.range2.bottom+2}else{if(h.row=d.range2.top,h.col>=d.range2.left&&h.col<=d.range2.right+
1)h.col=d.range2.right+2}else h.col=g.col,h.row=g.row;j=SocialCalc.crToCoord(h.col,h.row);j!=b.mouselastcoord&&(d.MoveECell(j),e=d.range2.right-d.range2.left+h.col,h=d.range2.bottom-d.range2.top+h.row,d.RangeAnchor(SocialCalc.crToCoord(e,h)),d.RangeExtend())}b.mouselastcoord=j}};
SocialCalc.CellHandlesMouseUp=function(a){var c,b,d,e,g,h,a=a||window.event;c=SocialCalc.GetViewportInfo();b=a.clientX+c.horizontalScroll;e=a.clientY+c.verticalScroll;var j=SocialCalc.EditorMouseInfo;if(c=j.editor){var k=c.cellhandles;j.ignore=!1;b=SocialCalc.GridMousePosition(c,b,e);SocialCalc.SetDragAutoRepeat(c,null);k.mouseDown=!1;k.noCursorSuffix=!1;k.fillinghandle.style.display="none";b||(b={});if(!b.coord)b.coord=c.ecell.coord;switch(k.dragtype){case "Fill":case "Move":case "MoveI":d=" all";
break;case "FillC":case "MoveC":case "MoveIC":d=" formulas"}if(!k.movedmouse)k.dragtype="Nothing";switch(k.dragtype){case "Nothing":c.Range2Remove();c.RangeRemove();break;case "Fill":case "FillC":e=SocialCalc.coordToCr(k.startingcoord);g=SocialCalc.coordToCr(b.coord);if(k.filltype)k.filltype=="Down"?g.col=e.col:g.row=e.row;b.coord=SocialCalc.crToCoord(g.col,g.row);c.MoveECell(b.coord);c.RangeExtend();b=c.cellhandles.filltype=="Right"?"right":"down";d="fill"+b+" "+SocialCalc.crToCoord(c.range.left,
c.range.top)+":"+SocialCalc.crToCoord(c.range.right,c.range.bottom)+d;c.EditorScheduleSheetCommands(d,!0,!1);break;case "Move":case "MoveC":c.context.cursorsuffix="";d="movepaste "+SocialCalc.crToCoord(c.range2.left,c.range2.top)+":"+SocialCalc.crToCoord(c.range2.right,c.range2.bottom)+" "+c.ecell.coord+d;c.EditorScheduleSheetCommands(d,!0,!1);c.Range2Remove();break;case "MoveI":case "MoveIC":c.context.cursorsuffix="",b=c.range2.right-c.range2.left,e=c.range2.bottom-c.range2.top,g=c.ecell.col-c.range2.left,
h=c.ecell.row-c.range2.top,d="moveinsert "+SocialCalc.crToCoord(c.range2.left,c.range2.top)+":"+SocialCalc.crToCoord(c.range2.right,c.range2.bottom)+" "+c.ecell.coord+d,c.EditorScheduleSheetCommands(d,!0,!1),c.Range2Remove(),c.RangeRemove(),c.cellhandles.filltype==" Horizontal"&&g>0?c.MoveECell(SocialCalc.crToCoord(c.ecell.col-b-1,c.ecell.row)):c.cellhandles.filltype==" Vertical"&&h>0&&c.MoveECell(SocialCalc.crToCoord(c.ecell.col,c.ecell.row-e-1)),c.RangeAnchor(SocialCalc.crToCoord(c.ecell.col+b,
c.ecell.row+e)),c.RangeExtend()}a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.CellHandlesMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.CellHandlesMouseUp,!0)):k.draghandle.detachEvent&&(k.draghandle.detachEvent("onlosecapture",SocialCalc.CellHandlesMouseUp),k.draghandle.detachEvent("onmouseup",SocialCalc.CellHandlesMouseUp),k.draghandle.detachEvent("onmousemove",
SocialCalc.CellHandlesMouseMove),k.draghandle.releaseCapture());j.editor=null;return!1}};
SocialCalc.TableControl=function(a,c,b){var d=SocialCalc.Constants;this.editor=a;this.vertical=c;this.size=b;this.thumbpos=this.scrollareasize=this.scrollareaend=this.scrollareastart=this.morebuttonstart=this.lessbuttonstart=this.panesliderstart=this.endcapstart=this.controlborder=this.thumb=this.scrollarea=this.morebutton=this.lessbutton=this.paneslider=this.endcap=this.main=null;this.controlthickness=d.defaultTableControlThickness;this.sliderthickness=d.defaultTCSliderThickness;this.buttonthickness=
d.defaultTCButtonThickness;this.thumbthickness=d.defaultTCThumbThickness;this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20};SocialCalc.TableControl.prototype.CreateTableControl=function(){return SocialCalc.CreateTableControl(this)};SocialCalc.TableControl.prototype.PositionTableControlElements=function(){SocialCalc.PositionTableControlElements(this)};SocialCalc.TableControl.prototype.ComputeTableControlPositions=function(){SocialCalc.ComputeTableControlPositions(this)};
SocialCalc.CreateTableControl=function(a){var c,b,d=SocialCalc.AssignID,e=SocialCalc.setStyles,g=SocialCalc.Constants,h=a.editor.imageprefix,j=a.vertical?"v":"h";a.main=document.createElement("div");c=a.main.style;c.height=(a.vertical?a.size:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.size)+"px";c.zIndex=0;e(a.main,g.TCmainStyle);c.backgroundImage="url("+h+"main-"+j+".gif)";if(g.TCmainClass)a.main.className=g.TCmainClass;a.main.style.display="none";a.endcap=document.createElement("div");
c=a.endcap.style;c.height=a.controlthickness+"px";c.width=a.controlthickness+"px";c.zIndex=1;c.overflow="hidden";c.position="absolute";e(a.endcap,g.TCendcapStyle);c.backgroundImage="url("+h+"endcap-"+j+".gif)";if(g.TCendcapClass)a.endcap.className=g.TCendcapClass;d(a.editor,a.endcap,"endcap"+j);a.main.appendChild(a.endcap);a.paneslider=document.createElement("div");c=a.paneslider.style;c.height=(a.vertical?a.sliderthickness:a.controlthickness)+"px";c.overflow="hidden";c.width=(a.vertical?a.controlthickness:
a.sliderthickness)+"px";c.position="absolute";c[a.vertical?"top":"left"]="4px";c.zIndex=3;e(a.paneslider,g.TCpanesliderStyle);c.backgroundImage="url("+h+"paneslider-"+j+".gif)";if(g.TCpanesliderClass)a.paneslider.className=g.TCpanesliderClass;d(a.editor,a.paneslider,"paneslider"+j);(function(a,c,b){g["s_"+c+"Tooltip"+b]&&SocialCalc.TooltipRegister(a,g["s_"+c+"Tooltip"+b],null)})(a.paneslider,"paneslider",j);c={MouseDown:SocialCalc.TCPSDragFunctionStart,MouseMove:SocialCalc.TCPSDragFunctionMove,MouseUp:SocialCalc.TCPSDragFunctionStop,
Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.DragRegister(a.paneslider,a.vertical,!a.vertical,c);a.main.appendChild(a.paneslider);a.lessbutton=document.createElement("div");c=a.lessbutton.style;c.height=(a.vertical?a.buttonthickness:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.buttonthickness)+"px";c.zIndex=2;c.overflow="hidden";c.position="absolute";e(a.lessbutton,g.TClessbuttonStyle);c.backgroundImage="url("+h+"less-"+j+"n.gif)";if(g.TClessbuttonClass)a.lessbutton.className=
g.TClessbuttonClass;d(a.editor,a.lessbutton,"lessbutton"+j);b={repeatwait:g.TClessbuttonRepeatWait,repeatinterval:g.TClessbuttonRepeatInterval,normalstyle:"backgroundImage:url("+h+"less-"+j+"n.gif);",downstyle:"backgroundImage:url("+h+"less-"+j+"d.gif);",hoverstyle:"backgroundImage:url("+h+"less-"+j+"h.gif);"};c={MouseDown:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,-1)},Repeat:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,-1)},Disabled:function(){return a.editor.busy}};
SocialCalc.ButtonRegister(a.lessbutton,b,c);a.main.appendChild(a.lessbutton);a.morebutton=document.createElement("div");c=a.morebutton.style;c.height=(a.vertical?a.buttonthickness:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.buttonthickness)+"px";c.zIndex=2;c.overflow="hidden";c.position="absolute";e(a.morebutton,g.TCmorebuttonStyle);c.backgroundImage="url("+h+"more-"+j+"n.gif)";if(g.TCmorebuttonClass)a.morebutton.className=g.TCmorebuttonClass;d(a.editor,a.morebutton,"morebutton"+
j);b={repeatwait:g.TCmorebuttonRepeatWait,repeatinterval:g.TCmorebuttonRepeatInterval,normalstyle:"backgroundImage:url("+h+"more-"+j+"n.gif);",downstyle:"backgroundImage:url("+h+"more-"+j+"d.gif);",hoverstyle:"backgroundImage:url("+h+"more-"+j+"h.gif);"};c={MouseDown:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,1)},Repeat:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,1)},Disabled:function(){return a.editor.busy}};SocialCalc.ButtonRegister(a.morebutton,b,c);a.main.appendChild(a.morebutton);
a.scrollarea=document.createElement("div");c=a.scrollarea.style;c.height=a.controlthickness+"px";c.width=a.controlthickness+"px";c.zIndex=1;c.overflow="hidden";c.position="absolute";e(a.scrollarea,g.TCscrollareaStyle);c.backgroundImage="url("+h+"scrollarea-"+j+".gif)";if(g.TCscrollareaClass)a.scrollarea.className=g.TCscrollareaClass;d(a.editor,a.scrollarea,"scrollarea"+j);b={repeatwait:g.TCscrollareaRepeatWait,repeatinterval:g.TCscrollareaRepeatWait};c={MouseDown:SocialCalc.ScrollAreaClick,Repeat:SocialCalc.ScrollAreaClick,
Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.ButtonRegister(a.scrollarea,b,c);a.main.appendChild(a.scrollarea);a.thumb=document.createElement("div");c=a.thumb.style;c.height=(a.vertical?a.thumbthickness:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.thumbthickness)+"px";c.zIndex=2;c.overflow="hidden";c.position="absolute";e(a.thumb,g.TCthumbStyle);a.thumb.style.backgroundImage="url("+h+"thumb-"+j+"n.gif)";if(g.TCthumbClass)a.thumb.className=g.TCthumbClass;d(a.editor,
a.thumb,"thumb"+j);c={MouseDown:SocialCalc.TCTDragFunctionStart,MouseMove:SocialCalc.TCTDragFunctionMove,MouseUp:SocialCalc.TCTDragFunctionStop,Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.DragRegister(a.thumb,a.vertical,!a.vertical,c);b={normalstyle:"backgroundImage:url("+h+"thumb-"+j+"n.gif)",name:"Thumb",downstyle:"backgroundImage:url("+h+"thumb-"+j+"d.gif)",hoverstyle:"backgroundImage:url("+h+"thumb-"+j+"h.gif)"};SocialCalc.ButtonRegister(a.thumb,b,null);a.main.appendChild(a.thumb);
return a.main};SocialCalc.ScrollAreaClick=function(a,c,b){a=b.functionobj.control;SocialCalc.GetElementPosition(b.element);a.editor.busy||a.editor.PageRelative(a.vertical,(a.vertical?c.clientY:c.clientX)>a.thumbpos?1:-1)};
SocialCalc.PositionTableControlElements=function(a){var c,b,d=a.editor;a.vertical?(c=a.controlborder+"px",a.endcap.style.top=a.endcapstart+"px",a.endcap.style.left=c,a.paneslider.style.top=a.panesliderstart+"px",a.paneslider.style.left=c,a.lessbutton.style.top=a.lessbuttonstart+"px",a.lessbutton.style.left=c,a.morebutton.style.top=a.morebuttonstart+"px",a.morebutton.style.left=c,a.scrollarea.style.top=a.scrollareastart+"px",a.scrollarea.style.left=c,a.scrollarea.style.height=a.scrollareasize+"px",
b=Math.max(d.context.sheetobj.attribs.lastrow,d.firstscrollingrow+1),b=(d.firstscrollingrow-(d.lastnonscrollingrow+1))*(a.scrollareasize-3*a.thumbthickness)/(b-(d.lastnonscrollingrow+1))+a.scrollareastart-1,b=Math.floor(b),a.thumb.style.top=b+"px",a.thumb.style.left=c):(c=a.controlborder+"px",a.endcap.style.left=a.endcapstart+"px",a.endcap.style.top=c,a.paneslider.style.left=a.panesliderstart+"px",a.paneslider.style.top=c,a.lessbutton.style.left=a.lessbuttonstart+"px",a.lessbutton.style.top=c,a.morebutton.style.left=
a.morebuttonstart+"px",a.morebutton.style.top=c,a.scrollarea.style.left=a.scrollareastart+"px",a.scrollarea.style.top=c,a.scrollarea.style.width=a.scrollareasize+"px",b=Math.max(d.context.sheetobj.attribs.lastcol,d.firstscrollingcol+1),b=(d.firstscrollingcol-(d.lastnonscrollingcol+1))*(a.scrollareasize-a.thumbthickness)/(b-d.lastnonscrollingcol)+a.scrollareastart-1,b=Math.floor(b),a.thumb.style.left=b+"px",a.thumb.style.top=c);a.thumbpos=b;a.main.style.display="block"};
SocialCalc.ComputeTableControlPositions=function(a){var c=a.editor;if(!c.gridposition||!c.headposition)throw"Can't compute table control positions before editor positions";a.vertical?(a.controlborder=c.gridposition.left+c.tablewidth,a.endcapstart=c.gridposition.top,a.panesliderstart=c.firstscrollingrowtop-a.sliderthickness,a.lessbuttonstart=c.firstscrollingrowtop-1,a.morebuttonstart=c.gridposition.top+c.tableheight-a.buttonthickness,a.scrollareastart=c.firstscrollingrowtop-1+a.buttonthickness):(a.controlborder=
c.gridposition.top+c.tableheight,a.endcapstart=c.gridposition.left,a.panesliderstart=c.firstscrollingcolleft-a.sliderthickness,a.lessbuttonstart=c.firstscrollingcolleft-1,a.morebuttonstart=c.gridposition.left+c.tablewidth-a.buttonthickness,a.scrollareastart=c.firstscrollingcolleft-1+a.buttonthickness);a.scrollareaend=a.morebuttonstart-1;a.scrollareasize=a.scrollareaend-a.scrollareastart+1};
SocialCalc.TCPSDragFunctionStart=function(a,c,b){var d=b.functionobj.control.editor,e=SocialCalc.Constants;SocialCalc.DragFunctionStart(a,c,b);c.trackingline=document.createElement("div");c.trackingline.style.height=b.vertical?e.TCPStrackinglineThickness:d.tableheight-(d.headposition.top-d.gridposition.top)+"px";c.trackingline.style.width=b.vertical?d.tablewidth-(d.headposition.left-d.gridposition.left)+"px":e.TCPStrackinglineThickness;c.trackingline.style.backgroundImage="url("+d.imageprefix+"trackingline-"+
(b.vertical?"v":"h")+".gif)";if(e.TCPStrackinglineClass)c.trackingline.className=e.TCPStrackinglineClass;SocialCalc.setStyles(c.trackingline,e.TCPStrackinglineStyle);b.vertical?(row=SocialCalc.Lookup(c.clientY+b.functionobj.control.sliderthickness,d.rowpositions),c.trackingline.style.top=(d.rowpositions[row]||d.headposition.top)+"px",c.trackingline.style.left=d.headposition.left+"px",d.context.rowpanes.length-1&&(d.context.SetRowPaneFirstLast(1,d.context.rowpanes[0].last+1,d.context.rowpanes[0].last+
1),d.FitToEditTable(),d.ScheduleRender())):(col=SocialCalc.Lookup(c.clientX+b.functionobj.control.sliderthickness,d.colpositions),c.trackingline.style.top=d.headposition.top+"px",c.trackingline.style.left=(d.colpositions[col]||d.headposition.left)+"px",d.context.colpanes.length-1&&(d.context.SetColPaneFirstLast(1,d.context.colpanes[0].last+1,d.context.colpanes[0].last+1),d.FitToEditTable(),d.ScheduleRender()));d.griddiv.appendChild(c.trackingline)};
SocialCalc.TCPSDragFunctionMove=function(a,c,b){var d,e;e=b.functionobj.control;d=e.sliderthickness;var g=e.editor;if(b.vertical){e=e.morebuttonstart-e.minscrollingpanesize-c.offsetY;if(c.clientY>e)c.clientY=e;e=g.headposition.top-d-c.offsetY;if(c.clientY<e)c.clientY=e;d=SocialCalc.Lookup(c.clientY+d,g.rowpositions);c.trackingline.style.top=(g.rowpositions[d]||g.headposition.top)+"px"}else{e=e.morebuttonstart-e.minscrollingpanesize-c.offsetX;if(c.clientX>e)c.clientX=e;e=g.headposition.left-d-c.offsetX;
if(c.clientX<e)c.clientX=e;d=SocialCalc.Lookup(c.clientX+d,g.colpositions);c.trackingline.style.left=(g.colpositions[d]||g.headposition.left)+"px"}SocialCalc.DragFunctionPosition(a,c,b)};
SocialCalc.TCPSDragFunctionStop=function(a,c,b){var d,e=b.functionobj.control;d=e.sliderthickness;a=e.editor;if(b.vertical){b=e.morebuttonstart-e.minscrollingpanesize-c.offsetY;if(c.clientY>b)c.clientY=b;b=a.headposition.top-d-c.offsetY;if(c.clientY<b)c.clientY=b;d=SocialCalc.Lookup(c.clientY+d,a.rowpositions);if(d>a.context.sheetobj.attribs.lastrow)d=a.context.sheetobj.attribs.lastrow;if(!d||d<=a.context.rowpanes[0].first){if(a.context.rowpanes.length>1)a.context.rowpanes.length=1}else a.context.rowpanes.length-
1?a.timeout||(a.context.SetRowPaneFirstLast(0,a.context.rowpanes[0].first,d-1),a.context.SetRowPaneFirstLast(1,d,d)):(a.context.SetRowPaneFirstLast(0,a.context.rowpanes[0].first,d-1),a.context.SetRowPaneFirstLast(1,d,d))}else{b=e.morebuttonstart-e.minscrollingpanesize-c.offsetX;if(c.clientX>b)c.clientX=b;b=a.headposition.left-d-c.offsetX;if(c.clientX<b)c.clientX=b;d=SocialCalc.Lookup(c.clientX+d,a.colpositions);if(d>a.context.sheetobj.attribs.lastcol)d=a.context.sheetobj.attribs.lastcol;if(!d||d<=
a.context.colpanes[0].first){if(a.context.colpanes.length>1)a.context.colpanes.length=1}else a.context.colpanes.length-1?a.timeout||(a.context.SetColPaneFirstLast(0,a.context.colpanes[0].first,d-1),a.context.SetColPaneFirstLast(1,d,d)):(a.context.SetColPaneFirstLast(0,a.context.colpanes[0].first,d-1),a.context.SetColPaneFirstLast(1,d,d))}a.FitToEditTable();a.griddiv.removeChild(c.trackingline);a.ScheduleRender()};
SocialCalc.TCTDragFunctionStart=function(a,c,b){var d=b.functionobj.control,e=d.editor,g=SocialCalc.Constants;SocialCalc.DragFunctionStart(a,c,b);if(c.thumbstatus){if(c.thumbstatus.rowmsgele)c.thumbstatus.rowmsgele=null;if(c.thumbstatus.rowpreviewele)c.thumbstatus.rowpreviewele=null;e.toplevel.removeChild(c.thumbstatus);c.thumbstatus=null}c.thumbstatus=document.createElement("div");if(b.vertical){if(g.TCTDFSthumbstatusvClass)c.thumbstatus.className=g.TCTDFSthumbstatusvClass;SocialCalc.setStyles(c.thumbstatus,
g.TCTDFSthumbstatusvStyle);c.thumbstatus.style.top=c.clientY+g.TCTDFStopOffsetv+"px";c.thumbstatus.style.left=d.controlborder-10-e.tablewidth/2+"px";c.thumbstatus.style.width=e.tablewidth/2+"px";c.thumbcontext=new SocialCalc.RenderContext(e.context.sheetobj);c.thumbcontext.showGrid=!0;c.thumbcontext.rowpanes=[{first:1,last:1}];a=e.context.colpanes[e.context.colpanes.length-1];c.thumbcontext.colpanes=[{first:a.first,last:a.last}];c.thumbstatus.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td valign="top" style="'+
g.TCTDFSthumbstatusrownumStyle+'" class="'+g.TCTDFSthumbstatusrownumClass+'"><div>msg</div></td><td valign="top"><div style="overflow:hidden;">preview</div></td></tr></table>';c.thumbstatus.rowmsgele=c.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild;c.thumbstatus.rowpreviewele=c.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild;e.toplevel.appendChild(c.thumbstatus);SocialCalc.TCTDragFunctionRowSetStatus(c,e,e.firstscrollingrow||1)}else{if(g.TCTDFSthumbstatushClass)c.thumbstatus.className=
g.TCTDFSthumbstatushClass;SocialCalc.setStyles(c.thumbstatus,g.TCTDFSthumbstatushStyle);c.thumbstatus.style.top=d.controlborder+g.TCTDFStopOffseth+"px";c.thumbstatus.style.left=c.clientX+g.TCTDFSleftOffseth+"px";e.toplevel.appendChild(c.thumbstatus);c.thumbstatus.innerHTML=g.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(e.firstscrollingcol)}};
SocialCalc.TCTDragFunctionRowSetStatus=function(a,c,b){a.thumbstatus.rowmsgele.innerHTML=SocialCalc.Constants.s_TCTDFthumbstatusPrefixv+b+" ";a.thumbcontext.rowpanes=[{first:b,last:b}];a.thumbrowshown=b;a.thumbcontext.RenderSheet(a.thumbstatus.rowpreviewele.firstChild,{type:"html"})};
SocialCalc.TCTDragFunctionMove=function(a,c,b){var d,e;d=b.functionobj.control;e=d.editor;var g=SocialCalc.Constants;if(b.vertical){if(c.clientY>d.scrollareaend-c.offsetY-d.thumbthickness+2)c.clientY=d.scrollareaend-c.offsetY-d.thumbthickness+2;if(c.clientY<d.scrollareastart-c.offsetY-1)c.clientY=d.scrollareastart-c.offsetY-1;c.thumbstatus.style.top=c.clientY+"px";d=(c.clientY+c.offsetY-d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(e.context.sheetobj.attribs.lastrow-e.lastnonscrollingrow)+
e.lastnonscrollingrow+1;d=Math.floor(d);d<=e.lastnonscrollingrow&&(d=e.lastnonscrollingrow+1);if(d>e.context.sheetobj.attribs.lastrow)d=e.context.sheetobj.attribs.lastrow;d!=c.thumbrowshown&&SocialCalc.TCTDragFunctionRowSetStatus(c,e,d)}else{if(c.clientX>d.scrollareaend-c.offsetX-d.thumbthickness+2)c.clientX=d.scrollareaend-c.offsetX-d.thumbthickness+2;if(c.clientX<d.scrollareastart-c.offsetX-1)c.clientX=d.scrollareastart-c.offsetX-1;c.thumbstatus.style.left=c.clientX+"px";d=(c.clientX+c.offsetX-
d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(e.context.sheetobj.attribs.lastcol-e.lastnonscrollingcol)+e.lastnonscrollingcol+1;d=Math.floor(d);d<=e.lastnonscrollingcol&&(d=e.lastnonscrollingcol+1);if(d>e.context.sheetobj.attribs.lastcol)d=e.context.sheetobj.attribs.lastcol;e=g.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(d);c.thumbstatus.innerHTML=e}SocialCalc.DragFunctionPosition(a,c,b)};
SocialCalc.TCTDragFunctionStop=function(a,c,b){var d=b.functionobj.control,a=d.editor;if(b.vertical){b=(c.clientY+c.offsetY-d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(a.context.sheetobj.attribs.lastrow-a.lastnonscrollingrow)+a.lastnonscrollingrow+1;b=Math.floor(b);b<=a.lastnonscrollingrow&&(b=a.lastnonscrollingrow+1);if(b>a.context.sheetobj.attribs.lastrow)b=a.context.sheetobj.attribs.lastrow;a.context.SetRowPaneFirstLast(a.context.rowpanes.length-1,b,b+1)}else{b=(c.clientX+c.offsetX-
d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(a.context.sheetobj.attribs.lastcol-a.lastnonscrollingcol)+a.lastnonscrollingcol+1;b=Math.floor(b);b<=a.lastnonscrollingcol&&(b=a.lastnonscrollingcol+1);if(b>a.context.sheetobj.attribs.lastcol)b=a.context.sheetobj.attribs.lastcol;a.context.SetColPaneFirstLast(a.context.colpanes.length-1,b,b+1)}a.FitToEditTable();if(c.thumbstatus.rowmsgele)c.thumbstatus.rowmsgele=null;if(c.thumbstatus.rowpreviewele)c.thumbstatus.rowpreviewele=null;a.toplevel.removeChild(c.thumbstatus);
c.thumbstatus=null;a.ScheduleRender()};SocialCalc.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,horizontalScroll:0,verticalScroll:0};
SocialCalc.DragRegister=function(a,c,b,d){var e=SocialCalc.DragInfo;d||(d={MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null});e.registeredElements.push({element:a,vertical:c,horizontal:b,functionobj:d});if(a.addEventListener)a.addEventListener("mousedown",SocialCalc.DragMouseDown,!1);else if(a.attachEvent)a.attachEvent("onmousedown",SocialCalc.DragMouseDown);else throw SocialCalc.Constants.s_BrowserNotSupported;
};SocialCalc.DragUnregister=function(a){var c=SocialCalc.DragInfo,b;if(a)for(b=0;b<c.registeredElements.length;b++)if(c.registeredElements[b].element==a){c.registeredElements.splice(b,1);a.removeEventListener?a.removeEventListener("mousedown",SocialCalc.DragMouseDown,!1):a.detachEvent("onmousedown",SocialCalc.DragMouseDown);break}};
SocialCalc.DragMouseDown=function(a){var a=a||window.event,c=SocialCalc.DragInfo,b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);if(b&&(!b||!b.functionobj||!b.functionobj.Disabled||!b.functionobj.Disabled(a,c,b))){c.draggingElement=b;var d=SocialCalc.GetViewportInfo();c.horizontalScroll=d.horizontalScroll;c.verticalScroll=d.verticalScroll;c.clientX=a.clientX+c.horizontalScroll;c.clientY=a.clientY+c.verticalScroll;c.startX=c.clientX;c.startY=c.clientY;c.startZ=b.element.style.zIndex;
c.offsetX=0;c.offsetY=0;b.element.style.zIndex="100";document.addEventListener?(document.addEventListener("mousemove",SocialCalc.DragMouseMove,!0),document.addEventListener("mouseup",SocialCalc.DragMouseUp,!0)):b.element.attachEvent&&(b.element.setCapture(),b.element.attachEvent("onmousemove",SocialCalc.DragMouseMove),b.element.attachEvent("onmouseup",SocialCalc.DragMouseUp),b.element.attachEvent("onlosecapture",SocialCalc.DragMouseUp));a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?
a.preventDefault():a.returnValue=!1;b&&b.functionobj&&b.functionobj.MouseDown&&b.functionobj.MouseDown(a,c,b);return!1}};SocialCalc.DragMouseMove=function(a){var a=a||window.event,c=SocialCalc.DragInfo;c.clientX=a.clientX+c.horizontalScroll;c.clientY=a.clientY+c.verticalScroll;var b=c.draggingElement;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;b&&b.functionobj&&b.functionobj.MouseMove&&b.functionobj.MouseMove(a,c,b);return!1};
SocialCalc.DragMouseUp=function(a){var a=a||window.event,c=SocialCalc.DragInfo;c.clientX=a.clientX+c.horizontalScroll;c.clientY=a.clientY+c.verticalScroll;var b=c.draggingElement;b.element.style.zIndex=c.startZ;b&&b.functionobj&&b.functionobj.MouseUp&&b.functionobj.MouseUp(a,c,b);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.DragMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.DragMouseUp,!0)):
b.element.detachEvent&&(b.element.detachEvent("onlosecapture",SocialCalc.DragMouseUp),b.element.detachEvent("onmouseup",SocialCalc.DragMouseUp),b.element.detachEvent("onmousemove",SocialCalc.DragMouseMove),b.element.releaseCapture());c.draggingElement=null;return!1};SocialCalc.DragFunctionStart=function(a,c,b){b=b.functionobj.positionobj||b.element;a=b.style.top.match(/\d*/);c.offsetY=(a?a[0]-0:0)-c.clientY;a=b.style.left.match(/\d*/);c.offsetX=(a?a[0]-0:0)-c.clientX};
SocialCalc.DragFunctionPosition=function(a,c,b){a=b.functionobj.positionobj||b.element;if(b.vertical)a.style.top=c.clientY+c.offsetY+"px";if(b.horizontal)a.style.left=c.clientX+c.offsetX+"px"};SocialCalc.TooltipInfo={registeredElements:[],registered:!1,tooltipElement:null,timer:null,popupElement:null,clientX:0,clientY:0,offsetX:SocialCalc.Constants.TooltipOffsetX,offsetY:SocialCalc.Constants.TooltipOffsetY};
SocialCalc.TooltipRegister=function(a,c,b){var d=SocialCalc.TooltipInfo;d.registeredElements.push({element:a,tiptext:c,functionobj:b});if(!d.registered){if(document.addEventListener)document.addEventListener("mousemove",SocialCalc.TooltipMouseMove,!1);else if(document.attachEvent)document.attachEvent("onmousemove",SocialCalc.TooltipMouseMove);else throw SocialCalc.Constants.s_BrowserNotSupported;d.registered=!0}};
SocialCalc.TooltipMouseMove=function(a){var c=a||window.event,a=SocialCalc.TooltipInfo;a.viewport=SocialCalc.GetViewportInfo();a.clientX=c.clientX+a.viewport.horizontalScroll;a.clientY=c.clientY+a.viewport.verticalScroll;c=SocialCalc.LookupElement(c.target||c.srcElement,a.registeredElements);if(a.timer)window.clearTimeout(a.timer),a.timer=null;a.popupElement&&SocialCalc.TooltipHide();a.tooltipElement=c||null;if(c&&!SocialCalc.ButtonInfo.buttonDown)a.timer=window.setTimeout(SocialCalc.TooltipWaitDone,
700),a.tooltipElement.element.addEventListener?a.tooltipElement.element.addEventListener("mousedown",SocialCalc.TooltipMouseDown,!1):a.tooltipElement.element.attachEvent&&a.tooltipElement.element.attachEvent("onmousedown",SocialCalc.TooltipMouseDown)};
SocialCalc.TooltipMouseDown=function(){var a=SocialCalc.TooltipInfo;if(a.timer)window.clearTimeout(a.timer),a.timer=null;a.popupElement&&SocialCalc.TooltipHide();if(a.tooltipElement)a.tooltipElement.element.removeEventListener?a.tooltipElement.element.removeEventListener("mousedown",SocialCalc.TooltipMouseDown,!1):a.tooltipElement.element.attachEvent&&a.tooltipElement.element.detachEvent("onmousedown",SocialCalc.TooltipMouseDown),a.tooltipElement=null};
SocialCalc.TooltipDisplay=function(a){var c=SocialCalc.TooltipInfo,b=SocialCalc.Constants,d=a.functionobj&&typeof a.functionobj.offsetx=="number"?a.functionobj.offsetx:c.offsetX,e=a.functionobj&&typeof a.functionobj.offsety=="number"?a.functionobj.offsety:c.offsetY;c.popupElement=document.createElement("div");if(b.TDpopupElementClass)c.popupElement.className=b.TDpopupElementClass;SocialCalc.setStyles(c.popupElement,b.TDpopupElementStyle);c.popupElement.innerHTML=a.tiptext;c.clientX>c.viewport.width/
2?(c.popupElement.style.bottom=c.viewport.height-c.clientY+e+"px",c.popupElement.style.right=c.viewport.width-c.clientX+d+"px"):(c.popupElement.style.bottom=c.viewport.height-c.clientY+e+"px",c.popupElement.style.left=c.clientX+d+"px");if(c.clientY<50)c.popupElement.style.bottom=c.viewport.height-c.clientY+e-50+"px";document.body.appendChild(c.popupElement)};
SocialCalc.TooltipHide=function(){var a=SocialCalc.TooltipInfo;if(a.popupElement)a.popupElement.parentNode.removeChild(a.popupElement),a.popupElement=null};SocialCalc.TooltipWaitDone=function(){var a=SocialCalc.TooltipInfo;a.timer=null;SocialCalc.TooltipDisplay(a.tooltipElement)};SocialCalc.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,horizontalScroll:0,verticalScroll:0,clientX:0,clientY:0};
SocialCalc.ButtonRegister=function(a,c,b){var d=SocialCalc.ButtonInfo;c||(c={});d.registeredElements.push({name:c.name,element:a,normalstyle:c.normalstyle,hoverstyle:c.hoverstyle,downstyle:c.downstyle,repeatwait:c.repeatwait,repeatinterval:c.repeatinterval,functionobj:b});if(a.addEventListener)a.addEventListener("mousedown",SocialCalc.ButtonMouseDown,!1),a.addEventListener("mouseover",SocialCalc.ButtonMouseOver,!1),a.addEventListener("mouseout",SocialCalc.ButtonMouseOut,!1);else if(a.attachEvent)a.attachEvent("onmousedown",
SocialCalc.ButtonMouseDown),a.attachEvent("onmouseover",SocialCalc.ButtonMouseOver),a.attachEvent("onmouseout",SocialCalc.ButtonMouseOut);else throw SocialCalc.Constants.s_BrowserNotSupported;};
SocialCalc.ButtonMouseOver=function(a){var a=a||window.event,c=SocialCalc.ButtonInfo,b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);if(b)if(c.buttonDown){if(c.buttonElement==b)c.doingHover=!0}else c.buttonElement&&c.buttonElement!=b&&c.doingHover&&SocialCalc.setStyles(c.buttonElement.element,c.buttonElement.normalstyle),c.buttonElement=b,c.doingHover=!0,SocialCalc.setStyles(b.element,b.hoverstyle),b&&b.functionobj&&b.functionobj.MouseOver&&b.functionobj.MouseOver(a,c,b)};
SocialCalc.ButtonMouseOut=function(a){var a=a||window.event,c=SocialCalc.ButtonInfo;if(c.buttonDown)c.doingHover=!1;else{var b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);if(c.doingHover)c.buttonElement&&SocialCalc.setStyles(c.buttonElement.element,c.buttonElement.normalstyle),c.buttonElement=null,c.doingHover=!1;b&&b.functionobj&&b.functionobj.MouseOut&&b.functionobj.MouseOut(a,c,b)}};
SocialCalc.ButtonMouseDown=function(a){var a=a||window.event,c=SocialCalc.ButtonInfo,b=SocialCalc.GetViewportInfo(),d=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);if(d&&(!d||!d.functionobj||!d.functionobj.Disabled||!d.functionobj.Disabled(a,c,d)))if(c.buttonElement=d,c.buttonDown=!0,SocialCalc.setStyles(d.element,c.buttonElement.downstyle),document.addEventListener?document.addEventListener("mouseup",SocialCalc.ButtonMouseUp,!0):d.element.attachEvent&&(d.element.setCapture(),
d.element.attachEvent("onmouseup",SocialCalc.ButtonMouseUp),d.element.attachEvent("onlosecapture",SocialCalc.ButtonMouseUp)),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,c.horizontalScroll=b.horizontalScroll,c.verticalScroll=b.verticalScroll,c.clientX=a.clientX+c.horizontalScroll,c.clientY=a.clientY+c.verticalScroll,d&&d.functionobj&&d.functionobj.MouseDown&&d.functionobj.MouseDown(a,c,d),d.repeatwait)c.timer=window.setTimeout(SocialCalc.ButtonRepeat,
d.repeatwait)};
SocialCalc.ButtonMouseUp=function(a){var a=a||window.event,c=SocialCalc.ButtonInfo,b=c.buttonElement;if(c.timer)window.clearTimeout(c.timer),c.timer=null;if(c.buttonDown)a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,document.removeEventListener?document.removeEventListener("mouseup",SocialCalc.ButtonMouseUp,!0):document.detachEvent&&(b.element.detachEvent("onlosecapture",SocialCalc.ButtonMouseUp),b.element.detachEvent("onmouseup",SocialCalc.ButtonMouseUp),
b.element.releaseCapture()),c.buttonElement.downstyle&&(c.doingHover?SocialCalc.setStyles(b.element,c.buttonElement.hoverstyle):SocialCalc.setStyles(b.element,c.buttonElement.normalstyle)),c.buttonDown=!1,b&&b.functionobj&&b.functionobj.MouseUp&&b.functionobj.MouseUp(a,c,b)};
SocialCalc.ButtonRepeat=function(){var a=SocialCalc.ButtonInfo,c=a.buttonElement;if(c)c&&c.functionobj&&c.functionobj.Repeat&&c.functionobj.Repeat(null,a,c),a.timer=window.setTimeout(SocialCalc.ButtonRepeat,c.repeatinterval||100)};SocialCalc.MouseWheelInfo={registeredElements:[]};
SocialCalc.MouseWheelRegister=function(a,c){SocialCalc.MouseWheelInfo.registeredElements.push({element:a,functionobj:c});if(a.addEventListener)a.addEventListener("DOMMouseScroll",SocialCalc.ProcessMouseWheel,!1),a.addEventListener("mousewheel",SocialCalc.ProcessMouseWheel,!1);else if(a.attachEvent)a.attachEvent("onmousewheel",SocialCalc.ProcessMouseWheel);else throw SocialCalc.Constants.s_BrowserNotSupported;};
SocialCalc.ProcessMouseWheel=function(a){var a=a||window.event,c;if(!SocialCalc.Keyboard.passThru){var b=SocialCalc.MouseWheelInfo;c=a.target||a.srcElement;var d;for(d=null;!d&&c;c=c.parentNode)d=SocialCalc.LookupElement(c,b.registeredElements);if(d)(c=a.wheelDelta?a.wheelDelta/120:-a.detail/3)||(c=0),d.functionobj&&d.functionobj.WheelMove&&d.functionobj.WheelMove(a,c,b,d),a.preventDefault&&a.preventDefault(),a.returnValue=!1}};
SocialCalc.keyboardTables={specialKeysCommon:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},specialKeysIE:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysIE:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",
88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysOpera:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysOpera:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysSafari:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",63232:"[aup]",63233:"[adown]",63234:"[aleft]",63235:"[aright]",63272:"[del]",63273:"[home]",
63275:"[end]",63276:"[pgup]",63277:"[pgdn]",63237:"[f2]"},controlKeysSafari:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysSafari:{63236:"[f1]",63238:"[f3]",63239:"[f4]",63240:"[f5]",63241:"[f6]",63242:"[f7]",63243:"[f8]",63244:"[f9]",63245:"[f10]",63246:"[f11]",63247:"[f12]",63289:"[numlock]"},specialKeysFirefox:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",
40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysFirefox:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysFirefox:{16:"[shift]",17:"[ctrl]",18:"[alt]",20:"[capslock]",19:"[pause]",44:"[printscreen]",91:"[windows]",92:"[windows]",112:"[f1]",114:"[f3]",115:"[f4]",116:"[f5]",117:"[f6]",118:"[f7]",119:"[f8]",120:"[f9]",121:"[f10]",122:"[f11]",123:"[f12]",144:"[numlock]",145:"[scrolllock]",224:"[cmd]"}};
SocialCalc.Keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:""};
SocialCalc.KeyboardSetFocus=function(a){SocialCalc.Keyboard.focusTable=a;if(!SocialCalc.Keyboard.areListener)document.onkeydown=SocialCalc.ProcessKeyDown,document.onkeypress=SocialCalc.ProcessKeyPress,SocialCalc.Keyboard.areListener=!0;if(SocialCalc.Keyboard.passThru)SocialCalc.Keyboard.passThru.blur&&SocialCalc.Keyboard.passThru.blur(),SocialCalc.Keyboard.passThru=null;switch(typeof window.focus){case "function":window.focus();break;case "boolean":window.focus=!0}};
SocialCalc.KeyboardFocus=function(){SocialCalc.Keyboard.passThru=null;switch(typeof window.focus){case "function":window.focus();break;case "boolean":window.focus=!0}};
SocialCalc.ProcessKeyDown=function(a){var c=SocialCalc.keyboardTables;c.didProcessKey=!1;c.statusFromProcessKey=!1;c.repeatingKeyPress=!1;var b="",d=!0;if(!SocialCalc.Keyboard.passThru){a=a||window.event;if(a.which==void 0||typeof a.keyIdentifier=="string"){b=c.specialKeysCommon[a.keyCode];if(!b&&(a.ctrlKey&&(b=c.controlKeysIE[a.keyCode]),!b))return!0;d=SocialCalc.ProcessKey(b,a);if(!d)a.preventDefault&&a.preventDefault(),a.returnValue=!1}else{b=c.specialKeysCommon[a.keyCode];if(!b){if(a.ctrlKey||
a.metaKey)b=c.controlKeysIE[a.keyCode];if(!b)return!0}d=SocialCalc.ProcessKey(b,a);c.didProcessKey=!0;c.statusFromProcessKey=d;c.chForProcessKey=b}return d}};
SocialCalc.ProcessKeyPress=function(a){var c=SocialCalc.keyboardTables,b="",a=a||window.event;if(!SocialCalc.Keyboard.passThru){if(c.didProcessKey)return c.repeatingKeyPress?SocialCalc.ProcessKey(c.chForProcessKey,a):(c.repeatingKeyPress=!0,c.statusFromProcessKey);if(a.which==void 0)b=String.fromCharCode(a.keyCode);else{if(!a.which)return!1;if(a.charCode==void 0)if(a.which!=0)if(a.which<32||a.which==144){if(b=c.specialKeysOpera[a.which])return!0}else b=a.ctrlKey?c.controlKeysOpera[a.keyCode]:String.fromCharCode(a.which);
else return!0;else if(a.keyCode==0&&a.charCode==0)return;else if(a.keyCode==a.charCode){if(b=c.specialKeysSafari[a.keyCode],!b){if(c.ignoreKeysSafari[a.keyCode])return!0;b=a.metaKey?c.controlKeysSafari[a.keyCode]:String.fromCharCode(a.which)}}else{if(c.specialKeysFirefox[a.keyCode])return!0;b=String.fromCharCode(a.which);if(a.ctrlKey||a.metaKey)b=c.controlKeysFirefox[a.which]}}c=SocialCalc.ProcessKey(b,a);if(!c)a.preventDefault&&a.preventDefault(),a.returnValue=!1;return c}};
SocialCalc.ProcessKey=function(a,c){var b=SocialCalc.Keyboard.focusTable;return!b?!0:b.EditorProcessKey(a,c)};SocialCalc||(SocialCalc={});SocialCalc.FormatNumber={};SocialCalc.FormatNumber.format_definitions={};SocialCalc.FormatNumber.separatorchar=",";SocialCalc.FormatNumber.decimalchar=".";SocialCalc.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];SocialCalc.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];SocialCalc.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
SocialCalc.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"];SocialCalc.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"};SocialCalc.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"};
SocialCalc.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12};SocialCalc.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600};
SocialCalc.FormatNumber.formatNumberWithFormat=function(a,c){var b=SocialCalc.Constants,d=SocialCalc.FormatNumber,e,g,h,j,k,m,n,s,q,p,r,u="",t,w,x,y,z,B,A,E,J,G,I,v;a-=0;v=a;if(!isFinite(v))return"NaN";var D=v<0?1:0;D&&(v=-v);y=v==0?1:0;d.parse_format_string(d.format_definitions,c);t=d.format_definitions[c];if(!t)throw"Format not parsed error!";w=t.sectioninfo.length-1;if(t.hascomparison)for(y=r=w=0;;y++){e=t.operators[y];g=t.operands[y];if(!e){r&&(c="General",d.parse_format_string(d.format_definitions,
c),t=d.format_definitions[c],w=0);break}if(e==d.commands.section){if(!r)break;r=0;w++}else if(e==d.commands.comparison){r=g.indexOf(":");x=g.substring(0,r);g=g.substring(r+1)-0;if(x=="<"&&a<g||x=="<="&&a<=g||x=="="&&a==g||x=="<>"&&a!=g||x==">="&&a>=g||x==">"&&a>g)break;r=1}}else w>0&&(w==1?D?(D=0,w=1):w=0:w==2&&(D?(D=0,w=1):w=y?2:0));w=t.sectioninfo[w];if(w.commas>0)for(r=0;r<w.commas;r++)v/=1E3;if(w.percent>0)for(r=0;r<w.percent;r++)v*=100;g=1;for(r=0;r<w.fractiondigits;r++)g*=10;y=Math.floor(v*
g+0.5);y/=g;if(typeof y!="number")return"NaN";if(!isFinite(y))return"NaN";g=y+"";if(y==0&&(w.fractiondigits||w.integerdigits))D=0;if(g.indexOf("e")>=0)return a+"";g=g.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);if(!g)return"NaN";y=g[1];if(!y||y=="0")y="";(x=g[2])||(x="");if(w.hasdate){if(a<0)return"??-???-??&nbsp;??:??:??";h=(a-Math.floor(a))*d.datevalues.seconds_in_a_day;j=a*d.datevalues.seconds_in_a_day;k=Math.floor(h/d.datevalues.seconds_in_an_hour);n=Math.floor(j/d.datevalues.seconds_in_an_hour);
h-=k*d.datevalues.seconds_in_an_hour;m=Math.floor(h/60);s=Math.floor(j/60);g=1;for(r=0;r<w.fractiondigits;r++)g*=10;h=Math.floor((h-m*60)*g+0.5);h/=g;j=Math.floor(j*g+0.5);j/=g;h>=60&&(h=0,m++,s++,m>=60&&(m=0,k++,n++,k>=24&&(k=0,a++)));x=h-Math.floor(h)+"";x=x.substring(2);p=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(a+d.datevalues.julian_offset));r=0;for(mspos=w.sectionstart;;mspos++){e=t.operators[mspos];g=t.operands[mspos];if(!e)break;if(e==d.commands.section)break;if(e==
d.commands.date){if((g.toLowerCase()=="am/pm"||g.toLowerCase()=="a/p")&&!q)k>=12?(k-=12,q=g.toLowerCase()=="a/p"?b.s_FormatNumber_pm1:b.s_FormatNumber_pm):q=g.toLowerCase()=="a/p"?b.s_FormatNumber_am1:b.s_FormatNumber_am,g.indexOf(q)<0&&(q=q.toLowerCase());if(r&&(g=="m"||g=="mm"))t.operands[mspos]+="in";r=g.charAt(0)=="h"?1:0}else e!=d.commands.copy&&(r=0)}r=0;for(--mspos;;mspos--){e=t.operators[mspos];g=t.operands[mspos];if(!e)break;if(e==d.commands.section)break;if(e==d.commands.date){if(r&&(g==
"m"||g=="mm"))t.operands[mspos]+="in";r=g=="ss"?1:0}else e!=d.commands.copy&&(r=0)}}A=B=z=0;J=E="";G=b.FormatNumber_separatorchar;G.indexOf(" ")>=0&&(G=G.replace(/ /g,"&nbsp;"));I=b.FormatNumber_decimalchar;I.indexOf(" ")>=0&&(I=I.replace(/ /g,"&nbsp;"));for(r=w.sectionstart;e=t.operators[r];)if(g=t.operands[r++],e==d.commands.copy)u+=g;else if(e==d.commands.color)E=g;else if(e==d.commands.style)J=g;else if(e==d.commands.integer_placeholder){D&&(u+="-",D=0);z++;if(z==1&&y.length>w.integerdigits)for(;B<
y.length-w.integerdigits;B++)u+=y.charAt(B),w.thousandssep&&(e=y.length-B-1,e>2&&e%3==0&&(u+=G));if(y.length<w.integerdigits&&z<=w.integerdigits-y.length){if(g=="0"||g=="?")u+=g=="0"?"0":"&nbsp;",w.thousandssep&&(e=w.integerdigits-z,e>2&&e%3==0&&(u+=G))}else u+=y.charAt(B),w.thousandssep&&(e=y.length-B-1,e>2&&e%3==0&&(u+=G)),B++}else if(e==d.commands.fraction_placeholder){if(A>=x.length){if(g=="0"||g=="?")u+=g=="0"?"0":"&nbsp;"}else u+=x.charAt(A);A++}else if(e==d.commands.decimal)D&&(u+="-",D=0),
u+=I;else if(e==d.commands.currency)D&&(u+="-",D=0),u+=g;else if(e==d.commands.general){if(v!=0&&(g=Math.floor(Math.LOG10E*Math.log(v)),g=Math.pow(10,13-g),v=Math.floor(g*v+0.5)/g,!isFinite(v)))return"NaN";D&&(u+="-");g=v+"";if(g.indexOf("e")>=0)u+=g;else{g=g.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);y=g[1];if(!y||y=="0")y="";(x=g[2])||(x="");A=B=0;if(y.length)for(;B<y.length;B++)u+=y.charAt(B),w.thousandssep&&(e=y.length-B-1,e>2&&e%3==0&&(u+=G));else u+="0";if(x.length)for(u+=I;A<x.length;A++)u+=x.charAt(A)}}else if(e==
d.commands.date)g=g.toLowerCase(),g=="y"||g=="yy"?u+=(p.year+"").substring(2):g=="yyyy"?u+=p.year+"":g=="d"?u+=p.day+"":g=="dd"?(g=1E3+p.day,u+=(g+"").substr(2)):g=="ddd"?(g=Math.floor(a+6)%7,u+=b.s_FormatNumber_daynames3[g]):g=="dddd"?(g=Math.floor(a+6)%7,u+=b.s_FormatNumber_daynames[g]):g=="m"?u+=p.month+"":g=="mm"?(g=1E3+p.month,u+=(g+"").substr(2)):g=="mmm"?u+=b.s_FormatNumber_monthnames3[p.month-1]:g=="mmmm"?u+=b.s_FormatNumber_monthnames[p.month-1]:g=="mmmmm"?u+=b.s_FormatNumber_monthnames[p.month-
1].charAt(0):g=="h"?u+=k+"":g=="h]"?u+=n+"":g=="mmin"?(g=1E3+m+"",u+=g.substr(2)):g=="mm]"?s<100?(g=1E3+s+"",u+=g.substr(2)):u+=s+"":g=="min"?u+=m+"":g=="m]"?u+=s+"":g=="hh"?(g=1E3+k+"",u+=g.substr(2)):g=="s"?(g=Math.floor(h),u+=g+""):g=="ss"?(g=1E3+Math.floor(h)+"",u+=g.substr(2)):g=="am/pm"||g=="a/p"?u+=q:g=="ss]"&&(j<100?(g=1E3+Math.floor(j)+"",u+=g.substr(2)):(g=Math.floor(j),u+=g+""));else if(e==d.commands.section)break;else e!=d.commands.comparison&&(u+="!! Parse error !!");E&&(u='<span style="color:'+
E+';">'+u+"</span>");J&&(u='<span style="'+J+';">'+u+"</span>");return u};
SocialCalc.FormatNumber.parse_format_string=function(a,c){var b=SocialCalc.FormatNumber,d,e,g=1,h,j,k,m,n,s,q,p,r,u,t,w,x;if(!a[c]){d={operators:[],operands:[],sectioninfo:[{}]};a[c]=d;e=0;sectioninfo=d.sectioninfo[e];sectioninfo.sectionstart=0;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;for(x=sectioninfo.percent=0;x<c.length;x++)if(r=c.charAt(x),n)r=='"'?(n=0,d.operators.push(b.commands.copy),d.operands.push(s)):s+=r;else if(q)if(r=="]")if(q=0,r=SocialCalc.FormatNumber.parse_format_bracket(p),
r.operator==b.commands.separator)sectioninfo.thousandssep=1;else{if(r.operator==b.commands.date)sectioninfo.hasdate=1;if(r.operator==b.commands.comparison)d.hascomparison=1;d.operators.push(r.operator);d.operands.push(r.operand)}else p+=r;else if(j)d.operators.push(b.commands.copy),d.operands.push(r),j=!1;else if(k)d.operators.push(b.commands.copy),d.operands.push(r+r+r+r+r),k=!1;else if(m)d.operators.push(b.commands.copy),d.operands.push("&nbsp;"),m=!1;else{if(u){if("general".charAt(u)==r.toLowerCase()){u++;
u==7&&(d.operators.push(b.commands.general),d.operands.push(r),u=0);continue}u=0}if(w){if(w.charAt(0)==r){w+=r;continue}d.operators.push(b.commands.date);d.operands.push(w);sectioninfo.hasdate=1;w=""}if(t)if(t+=r,r=t.toLowerCase(),r!="am/pm".substring(0,r.length)&&r!="a/p".substring(0,r.length))ampstr="";else{if(r=="am/pm"||r=="a/p")d.operators.push(b.commands.date),d.operands.push(t),t=""}else if(r=="#"||r=="0"||r=="?"){if(g){sectioninfo.integerdigits++;if(sectioninfo.commas)sectioninfo.thousandssep=
1,sectioninfo.commas=0;h=1;d.operators.push(b.commands.integer_placeholder)}else sectioninfo.fractiondigits++,d.operators.push(b.commands.fraction_placeholder);d.operands.push(r)}else r=="."?(h=0,d.operators.push(b.commands.decimal),d.operands.push(r),g=0):r=="$"?(h=0,d.operators.push(b.commands.currency),d.operands.push(r)):r==","?h?sectioninfo.commas++:(d.operators.push(b.commands.copy),d.operands.push(r)):r=="%"?(h=0,sectioninfo.percent++,d.operators.push(b.commands.copy),d.operands.push(r)):r==
'"'?(h=0,n=1,s=""):r=="["?(h=0,q=1,p=""):r=="\\"?(j=1,h=0):r=="*"?(k=1,h=0):r=="_"?(m=1,h=0):r==";"?(e++,d.sectioninfo[e]={},sectioninfo=d.sectioninfo[e],sectioninfo.sectionstart=1+d.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,g=1,h=0,d.operators.push(b.commands.section),d.operands.push(r)):r.toLowerCase()=="g"?(u=1,h=0):r.toLowerCase()=="a"?(t=r,h=0):"dmyhHs".indexOf(r)>=0?w=r:(h=0,d.operators.push(b.commands.copy),d.operands.push(r))}if(w)d.operators.push(b.commands.date),
d.operands.push(w),sectioninfo.hasdate=1}};
SocialCalc.FormatNumber.parse_format_bracket=function(a){var c=SocialCalc.FormatNumber,b=SocialCalc.Constants,d={},e;a.charAt(0)=="$"?(d.operator=c.commands.currency,e=a.match(/^\$(.+?)(\-.+?){0,1}$/),d.operand=e?e[1]||b.FormatNumber_defaultCurrency||"$":a.substring(1)||b.FormatNumber_defaultCurrency||"$"):a=="?$"?(d.operator=c.commands.currency,d.operand="[?$]"):c.allowedcolors[a.toUpperCase()]?(d.operator=c.commands.color,d.operand=c.allowedcolors[a.toUpperCase()]):(e=a.match(/^style=([^"]*)$/))?
(d.operator=c.commands.style,d.operand=e[1]):a==","?(d.operator=c.commands.separator,d.operand=a):c.alloweddates[a.toUpperCase()]?(d.operator=c.commands.date,d.operand=c.alloweddates[a.toUpperCase()]):a.match(/^[<>=]/)?(e=a.match(/^([<>=]+)(.+)$/),d.operator=c.commands.comparison,d.operand=e[1]+":"+e[2]):(d.operator=c.commands.copy,d.operand="["+a+"]");return d};
SocialCalc.FormatNumber.convert_date_gregorian_to_julian=function(a,c,b){b=b-32075+SocialCalc.intFunc(1461*(a+4800+SocialCalc.intFunc((c-14)/12))/4);b+=SocialCalc.intFunc(367*(c-2-SocialCalc.intFunc((c-14)/12)*12)/12);b-=SocialCalc.intFunc(3*SocialCalc.intFunc((a+4900+SocialCalc.intFunc((c-14)/12))/100)/4);return b};
SocialCalc.FormatNumber.convert_date_julian_to_gregorian=function(a){var c,b,d,e;a+=68569;c=Math.floor(4*a/146097);a-=Math.floor((146097*c+3)/4);b=Math.floor(4E3*(a+1)/1461001);a=a-Math.floor(1461*b/4)+31;d=Math.floor(80*a/2447);e=a-Math.floor(2447*d/80);a=Math.floor(d/11);return{year:100*(c-49)+b+a,month:d+2-12*a,day:e}};SocialCalc.intFunc=function(a){return a<0?-Math.floor(-a):Math.floor(a)};SocialCalc||(SocialCalc={});SocialCalc.Formula={};SocialCalc.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9};SocialCalc.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7};SocialCalc.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10};
SocialCalc.Formula.CharClassTable={" ":9,"!":3,'"':8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5};
SocialCalc.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z"};SocialCalc.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"};SocialCalc.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9};
SocialCalc.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"};
SocialCalc.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",
n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|t*:t|e*:2|",
"e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}};
SocialCalc.Formula.ParseFormulaIntoTokens=function(a){var c,b,d,e,g,h;c=SocialCalc.Formula;var j=SocialCalc.Constants,k=c.ParseState,m=c.TokenType,n=c.CharClass,s=c.CharClassTable,q=c.UpperCaseTable,p=c.ParsePushToken,r=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,u=[],t="";g=0;d=!1;for(c=0;c<=a.length;c++){c<a.length?(b=a.charAt(c),cclass=s[b]):(b="",cclass=n.eof);if(g==k.num)cclass==n.num?t+=b:cclass==n.numstart&&!d?(d=!0,t+=b):b=="E"||b=="e"?(t+=b,d=!1,g=k.numexp1):(p(u,t,m.num,0),d=!1,g=0);if(g==k.numexp1)cclass==
k.num?g=k.numexp2:(b=="+"||b=="-")&&q[t.charAt(t.length-1)]=="E"?t+=b:b=="E"||b=="e"||(p(u,j.s_parseerrexponent,m.error,0),g=0);g==k.numexp2&&(cclass==n.num?t+=b:(p(u,t,m.num,0),g=0));if(g==k.alpha)cclass==n.num?g=k.coord:cclass==n.alpha||b=="."?t+=b:cclass==n.incoord?g=k.coord:(cclass==n.op||cclass==n.numstart||cclass==n.space||cclass==n.eof?p(u,t.toUpperCase(),m.name,0):p(u,j.s_parseerrchar,m.error,0),g=0);if(g==k.coord)cclass==n.num?t+=b:cclass==n.incoord?t+=b:cclass==n.alpha?g=k.alphanumeric:
(cclass==n.op||cclass==n.numstart||cclass==n.eof||cclass==n.space?(h=r.test(t)?m.coord:m.name,p(u,t.toUpperCase(),h,0)):p(u,j.s_parseerrchar,m.error,0),g=0);g==k.alphanumeric&&(cclass==n.num||cclass==n.alpha?t+=b:(cclass==n.op||cclass==n.numstart||cclass==n.space||cclass==n.eof?p(u,t.toUpperCase(),m.name,0):p(u,j.s_parseerrchar,m.error,0),g=0));g==k.string?cclass==n.quote?g=k.stringquote:cclass==n.eof?(p(u,j.s_parseerrstring,m.error,0),g=0):t+=b:g==k.stringquote?cclass==n.quote?(t+='"',g=k.string):
(p(u,t,m.string,0),g=0):g==k.specialvalue&&(t.charAt(t.length-1)=="!"?(p(u,t,m.name,0),g=0):cclass==n.eof?(p(u,j.s_parseerrspecialvalue,m.error,0),g=0):t+=b);if(g==0)if(cclass==n.num)t=b,g=k.num;else if(cclass==n.numstart)t=b,d=!0,g=k.num;else if(cclass==n.alpha||cclass==n.incoord)t=b,g=k.alpha;else if(cclass==n.specialstart)t=b,g=k.specialvalue;else if(cclass==n.op){t=b;if(u.length>0){if(e=u[u.length-1],g=e.type,e=e.text,g==n.op&&(e=="<"||e==">"))t=e+t,u.pop(),u.length>0?(e=u[u.length-1],g=e.type,
e=e.text):(g=n.eof,e="EOF")}else g=n.eof,e="EOF";h=m.op;if(u.length==0||g==n.op&&e!=")"&&e!="%")if(t=="-")b=t="M";else if(t=="+")b=t="P";else{if(!(t==")"&&e=="(")&&t!="(")h=m.error,t=j.s_parseerrtwoops}else if(t.length>1)t==">="?b=t="G":t=="<="?b=t="L":t=="<>"?b=t="N":(h=m.error,t=j.s_parseerrtwoops);p(u,t,h,b);g=0}else cclass==n.quote?(t="",g=k.string):cclass==n.space?p(u," ",m.space,0):cclass!=n.eof&&p(u,j.s_parseerrchar,m.error,0)}return u};
SocialCalc.Formula.ParsePushToken=function(a,c,b,d){a.push({text:c,type:b,opcode:d})};SocialCalc.Formula.evaluate_parsed_formula=function(a,c,b){var d=SocialCalc.Formula,e;e=d.ConvertInfixToPolish(a);return d.EvaluatePolish(a,e,c,b)};
SocialCalc.Formula.ConvertInfixToPolish=function(a){var c=SocialCalc.Formula,b=SocialCalc.Constants,d=c.TokenType,c=c.TokenPrecedence,e=[],g=[],h="",j,k,m,n;for(j=0;j<a.length;j++)if(k=a[j],m=k.type,n=k.text,m==d.num||m==d.coord||m==d.string)e.push(j);else if(m==d.name)g.push(j),e.push(-1);else if(m!=d.space)if(n==","){for(;g.length&&a[g[g.length-1]].text!="(";)e.push(g.pop());if(g.length==0){h=b.s_parseerrmissingopenparen;break}}else if(n=="(")g.push(j);else if(n==")"){for(;g.length&&a[g[g.length-
1]].text!="(";)e.push(g.pop());if(g.length==0){h=b.s_parseerrcloseparennoopen;break}g.pop();g.length&&a[g[g.length-1]].type==d.name&&e.push(g.pop())}else if(m==d.op){for(g.length&&a[g[g.length-1]].type==d.name&&e.push(g.pop());g.length&&a[g[g.length-1]].type==d.op&&a[g[g.length-1]].text!="(";){m=c[k.opcode];n=c[a[g[g.length-1]].opcode];if(m>=0&&m<n)break;else if(m<0&&(m=-m,n<0&&(n=-n),m<=n))break;e.push(g.pop())}g.push(j)}else{h=m==d.error?n:"Internal error while processing parsed formula. ";break}for(;g.length>
0;){if(a[g[g.length-1]].text=="("){h=b.s_parseerrmissingcloseparen;break}e.push(g.pop())}return h?h:e};
SocialCalc.Formula.EvaluatePolish=function(a,c,b,d){var e=SocialCalc.Formula,g=SocialCalc.Constants,h=e.TokenType,j=e.LookupResultType,k=e.TypeLookupTable,m=e.OperandAsNumber,n=e.OperandAsText,s=e.OperandValueAndType,q=e.OperandsAsCoordOnSheet,p=SocialCalc.format_number_for_display||function(a){return a+""},r="",u={value:"",type:"e#VALUE!",error:g.s_parseerrmissingoperand},t=[],w=function(a,c){t.push({type:a,value:c})},x,y,z,B,A,E;if(!a.length||!(c instanceof Array))return{value:"",type:"e#VALUE!",
error:typeof c=="string"?c:""};for(x=0;x<c.length;x++)if(y=c[x],y==-1)w("start",0);else if(y=a[y],z=y.type,y=y.text,z==h.num)w("n",y-0);else if(z==h.coord)w("coord",y);else if(z==h.string)w("t",y);else if(z==h.op){if(t.length<=0)return u;if(y=="M")z=m(b,t),y=j(z.type,z.type,k.unaryminus),w(y,-z.value);else if(y=="P")z=m(b,t),y=j(z.type,z.type,k.unaryplus),w(y,z.value);else if(y=="%")z=m(b,t),y=j(z.type,z.type,k.unarypercent),w(y,0.01*z.value);else if(y=="&"){if(t.length<=1)return u;B=n(b,t);z=n(b,
t);y=j(z.type,z.type,k.concat);w(y,z.value+B.value)}else if(y==":"){if(t.length<=1)return u;z=e.OperandsAsRangeOnSheet(b,t);z.error&&(r=r||z.error);w(z.type,z.value)}else if(y=="!"){if(t.length<=1)return u;z=q(b,t);z.error&&(r=r||z.error);w(z.type,z.value)}else if(y=="<"||y=="L"||y=="="||y=="G"||y==">"||y=="N"){if(t.length<=1){r=g.s_parseerrmissingoperand;break}B=s(b,t);z=s(b,t);if(z.type.charAt(0)=="n"&&B.type.charAt(0)=="n")A=0,y=="<"?A=z.value<B.value?1:0:y=="L"?A=z.value<=B.value?1:0:y=="="?A=
z.value==B.value?1:0:y=="G"?A=z.value>=B.value?1:0:y==">"?A=z.value>B.value?1:0:y=="N"&&(A=z.value!=B.value?1:0),w("nl",A);else if(z.type.charAt(0)=="e")w(z.type,0);else if(B.type.charAt(0)=="e")w(B.type,0);else{A=z.type.charAt(0);E=B.type.charAt(0);if(A=="n")z.value=p(z.value,"n","");else if(A=="b")z.value="";if(E=="n")B.value=p(B.value,"n","");else if(E=="b")B.value="";A=0;z.value=z.value.toLowerCase();B.value=B.value.toLowerCase();y=="<"?A=z.value<B.value?1:0:y=="L"?A=z.value<=B.value?1:0:y=="="?
A=z.value==B.value?1:0:y=="G"?A=z.value>=B.value?1:0:y==">"?A=z.value>B.value?1:0:y=="N"&&(A=z.value!=B.value?1:0);w("nl",A)}}else{if(t.length<=1){r=g.s_parseerrmissingoperand;break}B=m(b,t);z=m(b,t);if(y=="+")y=j(z.type,B.type,k.plus),w(y,z.value+B.value);else if(y=="-")y=j(z.type,B.type,k.plus),w(y,z.value-B.value);else if(y=="*")y=j(z.type,B.type,k.plus),w(y,z.value*B.value);else if(y=="/")B.value!=0?w("n",z.value/B.value):w("e#DIV/0!",0);else if(y=="^"){z.value=Math.pow(z.value,B.value);z.type=
"n";if(isNaN(z.value))z.value=0,z.type="e#NUM!";w(z.type,z.value)}}}else if(z==h.name){if(r=e.CalculateFunction(y,t,b))break}else{r=g.s_InternalError+"Unknown token "+z+" ("+y+"). ";break}value=t[0]?t[0].value:"";A=t[0]?t[0].type:"";if(A=="name")z=SocialCalc.Formula.LookupName(b,value),value=z.value,A=z.type,r=r||z.error;if(A=="coord")z=s(b,t),value=z.value,A=z.type,A=="b"&&(A="n",value=0);t.length>1&&!r&&(r+=g.s_parseerrerrorinformula);a=A;A.charAt(0)=="e"?r=r||A.substring(1)||g.s_calcerrerrorvalueinformula:
A=="range"&&(c=value.match(/^(.*)\|(.*)\|/),b=c[1].indexOf("!"),c[1]=b>=0?c[1].substring(b+1)+"!"+c[1].substring(0,b).toUpperCase():c[1].toUpperCase(),value=c[1]+":"+c[2].toUpperCase(),d||(r=g.s_formularangeresult+" "+value));r&&a.charAt(0)!="e"&&(value=r,a="e");if(a.charAt(0)=="n"&&(isNaN(value)||!isFinite(value)))value=0,a="e#NUM!",r=isNaN(value)?g.s_calcerrnumericnan:g.s_calcerrnumericoverflow;return{value:value,type:a,error:r}};
SocialCalc.Formula.LookupResultType=function(a,c,b){var d,e;e=b[a];if(!e&&(e=b[a.charAt(0)+"*"],!e))return"e#VALUE! (internal error, missing LookupResultType "+a.charAt(0)+"*)";b=e.indexOf("|"+c+":");if(b>=0){d=e.indexOf("|",b+1);if(d<0)return"e#VALUE! (internal error, incorrect LookupResultType "+e+")";e=e.substring(b+c.length+2,d);return e=="1"?a:e=="2"?c:e}b=e.indexOf("|"+c.charAt(0)+"*:");if(b>=0){d=e.indexOf("|",b+1);if(d<0)return"e#VALUE! (internal error, incorrect LookupResultType "+e+")";
e=e.substring(b+4,d);return e=="1"?a:e=="2"?c:e}return"e#VALUE!"};SocialCalc.Formula.TopOfStackValueAndType=function(a,c){var b=SocialCalc.Formula,d={type:"",value:""},e=c.length;if(!e)return d.error=SocialCalc.Constants.s_InternalError+"no operand on stack",d;d.value=c[e-1].value;d.type=c[e-1].type;c.pop();d.type=="name"&&(d=b.LookupName(a,d.value));return d};
SocialCalc.Formula.OperandAsNumber=function(a,c){var b,d=SocialCalc.Formula.OperandValueAndType(a,c);b=d.type.charAt(0);b=="n"?d.value-=0:b=="b"?(d.type="n",d.value=0):b=="e"?d.value=0:(b=SocialCalc.DetermineValueType?SocialCalc.DetermineValueType(d.value):{value:d.value-0,type:"n"},d.value=b.type.charAt(0)=="n"?b.value-0:0,d.type=b.type);return d};
SocialCalc.Formula.OperandAsText=function(a,c){var b,d=SocialCalc.Formula.OperandValueAndType(a,c);b=d.type.charAt(0);if(b!="t")b=="n"?(d.value=SocialCalc.format_number_for_display?SocialCalc.format_number_for_display(d.value,d.type,""):d.value+="",d.type="t"):b=="b"?(d.value="",d.type="t"):b=="e"?d.value="":(c.value=d.value+"",c.type="t");return d};
SocialCalc.Formula.OperandValueAndType=function(a,c){var b,d,e;b=SocialCalc.Formula;var g={type:"",value:""};d=c.length;if(!d)return g.error=SocialCalc.Constants.s_InternalError+"no operand on stack",g;g.value=c[d-1].value;g.type=c[d-1].type;c.pop();g.type=="name"&&(g=b.LookupName(a,g.value));g.type=="range"&&(g=b.StepThroughRangeDown(c,g.value));if(g.type=="coord"){e=a;d=g.value.indexOf("!");if(d!=-1){e=b.FindInSheetCache(g.value.substring(d+1));if(e==null)return g.type="e#REF!",g.error=SocialCalc.Constants.s_sheetunavailable+
" "+g.value.substring(d+1),g.value=0,g;g.value=g.value.substring(0,d)}e?(d=e.cells[SocialCalc.Formula.PlainCoord(g.value)])?(b=d.valuetype,g.value=d.datavalue):b="b":(b="e#N/A",g.value=0);g.type=b||"b";if(g.type=="b")g.value=0}return g};
SocialCalc.Formula.OperandAsCoord=function(a,c){var b={type:"",value:""},d=c.length;b.value=c[d-1].value;b.type=c[d-1].type;c.pop();b.type=="name"&&(b=SocialCalc.Formula.LookupName(a,b.value));if(b.type!="coord")b.value=SocialCalc.Constants.s_calcerrcellrefmissing,b.type="e#REF!";return b};
SocialCalc.Formula.OperandsAsCoordOnSheet=function(a,c){var b,d,e,g={},h={};e=SocialCalc.Formula;b=c.length;g.value=c[b-1].value;g.type=c[b-1].type;c.pop();b=e.OperandAsSheetName(a,c);d=e.FindInSheetCache(b.value);if(d==null)return h.type="e#REF!",h.value=0,h.error=SocialCalc.Constants.s_sheetunavailable+" "+b.value,h;g.type=="name"&&(g=e.LookupName(d,g.value));h.type=g.type;g.type=="coord"?h.value=g.value+"!"+b.value:g.type=="range"?(e=g.value.indexOf("|"),d=g.value.indexOf("|",e+1),h.value=g.value.substring(0,
e)+"!"+b.value+"|"+g.value.substring(e+1,d)+"|"):g.type.charAt(0)=="e"?h.value=g.value:(h.error=SocialCalc.Constants.s_calcerrcellrefmissing,h.type="e#REF!",h.value=0);return h};
SocialCalc.Formula.OperandsAsRangeOnSheet=function(a,c){var b,d,e,g,h={},j=SocialCalc.Formula,k=SocialCalc.Constants;b=c.length;h.value=c[b-1].value;h.type=c[b-1].type;c.pop();b=j.OperandAsCoord(a,c);if(b.type!="coord")return{value:0,type:"e#REF!"};d=a;e=b.value.indexOf("!");if(e!=-1){g=b.value.indexOf("|",e+1);if(g<0)g=b.value.length;d=j.FindInSheetCache(b.value.substring(e+1,g));if(d==null)return{value:0,type:"e#REF!",errortext:k.s_sheetunavailable+" "+b.value.substring(e+1,g)}}h.type=="name"&&
(h=j.LookupName(d,h.value));return h.type=="coord"?{value:b.value+"|"+h.value+"|",type:"range"}:{value:k.s_calcerrcellrefmissing,type:"e#REF!"}};
SocialCalc.Formula.OperandAsSheetName=function(a,c){var b,d={type:"",value:""};b=c.length;d.value=c[b-1].value;d.type=c[b-1].type;c.pop();if(d.type=="name"){b=SocialCalc.Formula.LookupName(a,d.value);if(!b.value)return d;d.value=b.value;d.type=b.type}if(d.type=="coord")(b=a.cells[SocialCalc.Formula.PlainCoord(d.value)])?(d.value=b.datavalue,d.type=b.valuetype):(d.value="",d.type="b");if(d.type.charAt(0)!="t")d.value="",d.error=SocialCalc.Constants.s_calcerrsheetnamemissing;return d};
SocialCalc.Formula.LookupName=function(a,c){var b,d,e;d=a.names;e={};b=!1;if(d[c.toUpperCase()]){e.value=d[c.toUpperCase()].definition;if(e.value.charAt(0)=="="){if(a.checknamecirc){if(a.checknamecirc[c])return e.type="e#NAME?",e.error=SocialCalc.Constants.s_circularnameref+' "'+c+'".',e}else a.checknamecirc={},b=!0;a.checknamecirc[c]=!0;e=SocialCalc.Formula.ParseFormulaIntoTokens(e.value.substring(1));e=SocialCalc.Formula.evaluate_parsed_formula(e,a,1);delete a.checknamecirc[c];b&&delete a.checknamecirc;
if(e.type!="range")return e}b=e.value.indexOf(":");b!=-1?(e.type="range",e.value=e.value.substring(0,b)+"|"+e.value.substring(b+1)+"|"):e.type="coord";e.value=e.value.toUpperCase()}else(d=SocialCalc.Formula.SpecialConstants[c.toUpperCase()])?(b=d.indexOf(","),e.value=d.substring(0,b)-0,e.type=d.substring(b+1)):(e.value="",e.type="e#NAME?",e.error=SocialCalc.Constants.s_calcerrunknownname+' "'+c+'"');return e};
SocialCalc.Formula.StepThroughRangeDown=function(a,c){var b,d,e,g,h,j,k,m,n=SocialCalc.Formula;g=c.indexOf("|");e=c.indexOf("|",g+1);b=c.substring(0,g);d=c.substring(g+1,e);e=c.substring(e+1)-0;g=b.indexOf("!");g!=-1?(h=b.substring(g),b=b.substring(0,g)):h="";g=d.indexOf("!");g!=-1&&(d=d.substring(0,g));g=n.OrderRangeParts(b,d);m=0;for(k=g.r1;k<=g.r2;k++)for(j=g.c1;j<=g.c2;j++)if(m++,m>e)return(k!=g.r2||j!=g.c2)&&n.PushOperand(a,"range",b+h+"|"+d+"|"+m),{value:SocialCalc.crToCoord(j,k)+h,type:"coord"}};
SocialCalc.Formula.DecodeRangeParts=function(a,c){var b,d,e,g,h=SocialCalc.Formula;e=c.indexOf("|");g=c.indexOf("|",e+1);b=c.substring(0,e);d=c.substring(e+1,g);e=b.indexOf("!");e!=-1?(g=b.substring(e+1),b=b.substring(0,e)):g="";e=d.indexOf("!");e!=-1&&(d=d.substring(0,e));e=a;if(g&&(e=h.FindInSheetCache(g),e==null))return null;b=h.OrderRangeParts(b,d);return{sheetdata:e,sheetname:g,col1num:b.c1,ncols:b.c2-b.c1+1,row1num:b.r1,nrows:b.r2-b.r1+1}};
if(!SocialCalc.Formula.FunctionList)SocialCalc.Formula.FunctionList={};SocialCalc.Formula.FunctionClasses=null;SocialCalc.Formula.FunctionArgDefs={};
SocialCalc.Formula.CalculateFunction=function(a,c,b){var d,e,g,h=SocialCalc.Formula;e="";if(d=h.FunctionList[a]){e=[];g=d[0];d=d[1];h.CopyFunctionArgs(c,e);if(d!=100)if(d<0){if(e.length<-d)return e=h.FunctionArgsError(a,c)}else if(e.length!=d)return e=h.FunctionArgsError(a,c);e=g(a,c,e,b)}else c.length&&c[c.length-1].type=="start"?(c.pop(),h.PushOperand(c,"name",a)):e=SocialCalc.Constants.s_sheetfuncunknownfunction+" "+a+". ";return e};
SocialCalc.Formula.PushOperand=function(a,c,b){a.push({type:c,value:b})};SocialCalc.Formula.CopyFunctionArgs=function(a,c){for(;a.length>0&&a[a.length-1].type!="start";)c.push(a.pop());a.pop()};SocialCalc.Formula.FunctionArgsError=function(a,c){var b=SocialCalc.Constants.s_calcerrincorrectargstofunction+" "+a+". ";SocialCalc.Formula.PushOperand(c,"e#VALUE!",b);return b};SocialCalc.Formula.FunctionSpecificError=function(a,c,b,d){SocialCalc.Formula.PushOperand(c,b,d);return d};
SocialCalc.Formula.CheckForErrorValue=function(a,c){return c.type.charAt(0)=="e"?(a.push(c),!0):!1};
SocialCalc.Formula.FillFunctionInfo=function(){var a=SocialCalc.Formula,c=SocialCalc.Constants,b,d,e;if(!a.FunctionClasses){for(b in a.FunctionList)d=a.FunctionList[b],d[2]&&(a.FunctionArgDefs[d[2]]=c["s_farg_"+d[2]]||""),d[3]||c["s_fdef_"+b]&&(a.FunctionList[b][3]=c["s_fdef_"+b]);a.FunctionClasses={};for(d=0;d<c.function_classlist.length;d++)e=c.function_classlist[d],a.FunctionClasses[e]={name:c["s_fclass_"+e],items:[]};for(b in a.FunctionList){d=a.FunctionList[b];c=d[4]?d[4].split(","):[];c.push("all");
for(d=0;d<c.length;d++)e=c[d],a.FunctionClasses[e].items.push(b)}for(e in a.FunctionClasses)a.FunctionClasses[e].items.sort()}};SocialCalc.Formula.FunctionArgString=function(a){var c=SocialCalc.Formula,a=c.FunctionList[a],b;b=a[2];if(!b)if(a=a[1],a==0)b=" ";else if(a>0){b="v1";for(c=2;c<=a;c++)b+=", v"+c;return b}else if(a<0){b="v1";for(c=2;c<-a;c++)b+=", v"+c;return b+", ..."}else return"nargs: "+a;return b=c.FunctionArgDefs[b]||b};
SocialCalc.Formula.SeriesFunctions=function(a,c,b,d){var e,g;e=SocialCalc.Formula;for(var h=e.OperandValueAndType,j=e.LookupResultType,k=e.TypeLookupTable.plus,m=function(a,b){c.push({type:a,value:b})},n=0,s="",q=0,p=0,r=0,u=1,t,w,x,y,z,B;b.length>0;)if(e=h(d,b),g=e.type.charAt(0),g=="n"&&(q+=1),g!="b"&&(p+=1),g=="b"&&(r+=1),g=="n")g=e.value-0,n+=g,u*=g,t=t!=void 0?g>t?g:t:g,w=w!=void 0?g<w?g:w:g,q==1?(z=g,B=0):(x=z+(g-z)/q,B=y=B+(g-z)*(g-x),z=x),s=j(e.type,s||e.type,k);else if(g=="e"&&s.charAt(0)!=
"e")s=e.type;s=s||"n";switch(a){case "SUM":m(s,n);break;case "PRODUCT":m(s,u);break;case "MIN":m(s,w||0);break;case "MAX":m(s,t||0);break;case "COUNT":m("n",q);break;case "COUNTA":m("n",p);break;case "COUNTBLANK":m("n",r);break;case "AVERAGE":q>0?m(s,n/q):m("e#DIV/0!",0);break;case "STDEV":q>1?m(s,Math.sqrt(y/(q-1))):m("e#DIV/0!",0);break;case "STDEVP":q>1?m(s,Math.sqrt(y/q)):m("e#DIV/0!",0);break;case "VAR":q>1?m(s,y/(q-1)):m("e#DIV/0!",0);break;case "VARP":q>1?m(s,y/q):m("e#DIV/0!",0)}return null};
SocialCalc.Formula.FunctionList.AVERAGE=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.COUNT=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.COUNTA=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.COUNTBLANK=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.MAX=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];
SocialCalc.Formula.FunctionList.MIN=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.PRODUCT=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.STDEV=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.STDEVP=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.SUM=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];
SocialCalc.Formula.FunctionList.VAR=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.VARP=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];
SocialCalc.Formula.DSeriesFunctions=function(a,c,b,d){var e,g,h,j,k,m,n,s,q,p=SocialCalc.Formula,r=p.LookupResultType,u=p.TypeLookupTable.plus,t=function(a,b){c.push({type:a,value:b})};e={};var w=0,x="",y=0,z=0,B=0,A=1,E,J,G,I,v;h=p.TopOfStackValueAndType(d,b);j=p.OperandValueAndType(d,b);b=p.TopOfStackValueAndType(d,b);if(h.type!="range"||b.type!="range")return p.FunctionArgsError(a,c);h=p.DecodeRangeParts(d,h.value);d=p.DecodeRangeParts(d,b.value);j=p.FieldToColnum(h.sheetdata,h.col1num,h.ncols,
h.row1num,j.value,j.type);if(j<=0)t("e#VALUE!",0);else{j=h.col1num+j-1;n=[];for(b=0;b<d.ncols;b++){m=d.sheetdata.GetAssuredCell(SocialCalc.crToCoord(d.col1num+b,d.row1num));criterianum=p.FieldToColnum(h.sheetdata,h.col1num,h.ncols,h.row1num,m.datavalue,m.valuetype);if(criterianum<=0){t("e#VALUE!",0);return}n.push(h.col1num+criterianum-1)}for(b=1;b<h.nrows;b++){s=!1;g=1;a:for(;g<d.nrows;g++){for(k=0;k<d.ncols;k++)if(q=SocialCalc.crToCoord(d.col1num+k,d.row1num+g),m=d.sheetdata.GetAssuredCell(q),q=
m.datavalue,!(typeof q=="string"&&q.length==0)&&(m=n[k],m=SocialCalc.crToCoord(m,h.row1num+b),m=d.sheetdata.GetAssuredCell(m),!p.TestCriteria(m.datavalue,m.valuetype||"b",q)))continue a;s=!0;break a}if(s)if(g=SocialCalc.crToCoord(j,h.row1num+b),m=h.sheetdata.GetAssuredCell(g),e.value=m.datavalue,e.type=m.valuetype,g=e.type.charAt(0),g=="n"&&(y+=1),g!="b"&&(z+=1),g=="b"&&(B+=1),g=="n")v1=e.value-0,w+=v1,A*=v1,E=E!=void 0?v1>E?v1:E:v1,J=J!=void 0?v1<J?v1:J:v1,y==1?(I=v1,v=0):(g=I+(v1-I)/y,v=G=v+(v1-
I)*(v1-g),I=g),x=r(e.type,x||e.type,u);else if(g=="e"&&x.charAt(0)!="e")x=e.type}x=x||"n";switch(a){case "DSUM":t(x,w);break;case "DPRODUCT":t(x,A);break;case "DMIN":t(x,J||0);break;case "DMAX":t(x,E||0);break;case "DCOUNT":t("n",y);break;case "DCOUNTA":t("n",z);break;case "DAVERAGE":y>0?t(x,w/y):t("e#DIV/0!",0);break;case "DSTDEV":y>1?t(x,Math.sqrt(G/(y-1))):t("e#DIV/0!",0);break;case "DSTDEVP":y>1?t(x,Math.sqrt(G/y)):t("e#DIV/0!",0);break;case "DVAR":y>1?t(x,G/(y-1)):t("e#DIV/0!",0);break;case "DVARP":y>
1?t(x,G/y):t("e#DIV/0!",0);break;case "DGET":y==1?t(x,w):y==0?t("e#VALUE!",0):t("e#NUM!",0)}}};SocialCalc.Formula.FunctionList.DAVERAGE=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DCOUNT=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DCOUNTA=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DGET=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];
SocialCalc.Formula.FunctionList.DMAX=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DMIN=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DPRODUCT=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DSTDEV=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DSTDEVP=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];
SocialCalc.Formula.FunctionList.DSUM=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DVAR=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DVARP=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];
SocialCalc.Formula.FieldToColnum=function(a,c,b,d,e,g){var h;if(g.charAt(0)=="n")return g=e-0,g<=0||g>b?0:Math.floor(g);if(g.charAt(0)!="t")return 0;e=e?e.toLowerCase():"";for(g=0;g<b;g++)if(h=a.GetAssuredCell(SocialCalc.crToCoord(c+g,d)),h=h.datavalue,h=(h+"").toLowerCase(),h==e)return g+1;return 0};
SocialCalc.Formula.LookupFunctions=function(a,c,b,d){var e,g,h,j,k,m,n,s,q,p,r;r=SocialCalc.Formula;e=r.OperandValueAndType;var u=function(a,b){c.push({type:a,value:b})};e=e(d,b);if(typeof e.value=="string")e.value=e.value.toLowerCase();g=r.TopOfStackValueAndType(d,b);h=1;if(a=="MATCH"){if(b.length){h=r.OperandAsNumber(d,b);if(h.type.charAt(0)!="n"){u("e#VALUE!",0);return}if(b.length)return r.FunctionArgsError(a,c),0;h=h.value-0}}else{j=r.OperandAsNumber(d,b);if(j.type.charAt(0)!="n"){u("e#VALUE!",
0);return}j=Math.floor(j.value);if(b.length){h=r.OperandAsNumber(d,b);if(h.type.charAt(0)!="n"){u("e#VALUE!",0);return}if(b.length)return r.FunctionArgsError(a,c),0;h=h.value?1:0}}e.type=e.type.charAt(0);e.type=="n"&&(e.value-=0);if(g.type!="range")return r.FunctionArgsError(a,c),0;if(b=r.DecodeRangeParts(d,g.value,g.type)){m=k=g=d=0;if(a=="HLOOKUP"){if(k=1,j>b.nrows){u("e#REF!",0);return}}else if(a=="VLOOKUP"){if(m=1,j>b.ncols){u("e#REF!",0);return}}else if(a=="MATCH")if(b.ncols>1){if(b.nrows>1){u("e#N/A",
0);return}k=1}else m=1;else return r.FunctionArgsError(a,c),0;if(j<1&&a!="MATCH")return u("e#VALUE!",0),0;for(;;){r=SocialCalc.crToCoord(b.col1num+d,b.row1num+g);p=b.sheetdata.GetAssuredCell(r);r=p.datavalue;p=p.valuetype?p.valuetype.charAt(0):"b";p=="n"&&(r-=0);if(h)if(e.type=="n"&&p=="n"){if(e.value==r)break;if(h>0&&e.value>r||h<0&&e.value<r)n=1,s=d,q=g;else if(n){n=2;break}}else{if(e.type=="t"&&p=="t"){r=typeof r=="string"?r.toLowerCase():"";if(e.value==r)break;if(h>0&&e.value>r||h<0&&e.value<
r)n=1,s=d,q=g;else if(n){n=2;break}}}else if(e.type=="n"&&p=="n"){if(e.value==r)break}else if(e.type=="t"&&p=="t"&&(r=typeof r=="string"?r.toLowerCase():"",e.value==r))break;g+=m;d+=k;if(g>=b.nrows||d>=b.ncols){if(n){n=2;break}u("e#N/A",0);return}}n==2&&(g=q,d=s);a=="MATCH"?(r=d+g+1,p="n"):(r=SocialCalc.crToCoord(b.col1num+d+(a=="VLOOKUP"?j-1:0),b.row1num+g+(a=="HLOOKUP"?j-1:0)),p=b.sheetdata.GetAssuredCell(r),r=p.datavalue,p=p.valuetype);u(p,r)}else u("e#REF!",0)};
SocialCalc.Formula.FunctionList.HLOOKUP=[SocialCalc.Formula.LookupFunctions,-3,"hlookup","","lookup"];SocialCalc.Formula.FunctionList.MATCH=[SocialCalc.Formula.LookupFunctions,-2,"match","","lookup"];SocialCalc.Formula.FunctionList.VLOOKUP=[SocialCalc.Formula.LookupFunctions,-3,"vlookup","","lookup"];
SocialCalc.Formula.IndexFunction=function(a,c,b,d){var e,g,h,j,k=SocialCalc.Formula,m=function(a,b){c.push({type:a,value:b})};e=k.TopOfStackValueAndType(d,b);if(e.type!="range")return k.FunctionArgsError(a,c),0;g=k.DecodeRangeParts(d,e.value,e.type);e=g.sheetname?"!"+g.sheetname:"";h={value:0};j={value:0};if(b.length){h=k.OperandAsNumber(d,b);if(h.type.charAt(0)!="n"||h.value<0){m("e#VALUE!",0);return}if(b.length){j=k.OperandAsNumber(d,b);if(j.type.charAt(0)!="n"||j.value<0){m("e#VALUE!",0);return}if(b.length)return k.FunctionArgsError(a,
c),0}else if(g.nrows==1)j.value=h.value,h.value=0}h.value>g.nrows||j.value>g.ncols?m("e#REF!",0):(h.value==0?j.value==0?g.nrows==1&&g.ncols==1?(a=SocialCalc.crToCoord(g.col1num,g.row1num)+e,b="coord"):(a=SocialCalc.crToCoord(g.col1num,g.row1num)+e+"|"+SocialCalc.crToCoord(g.col1num+g.ncols-1,g.row1num+g.nrows-1)+"|",b="range"):g.nrows==1?(a=SocialCalc.crToCoord(g.col1num+j.value-1,g.row1num)+e,b="coord"):(a=SocialCalc.crToCoord(g.col1num+j.value-1,g.row1num)+e+"|"+SocialCalc.crToCoord(g.col1num+j.value-
1,g.row1num+g.nrows-1)+"|",b="range"):j.value==0?g.ncols==1?(a=SocialCalc.crToCoord(g.col1num,g.row1num+h.value-1)+e,b="coord"):(a=SocialCalc.crToCoord(g.col1num,g.row1num+h.value-1)+e+"|"+SocialCalc.crToCoord(g.col1num+g.ncols-1,g.row1num+h.value-1)+"|",b="range"):(a=SocialCalc.crToCoord(g.col1num+j.value-1,g.row1num+h.value-1)+e,b="coord"),m(b,a))};SocialCalc.Formula.FunctionList.INDEX=[SocialCalc.Formula.IndexFunction,-1,"index","","lookup"];
SocialCalc.Formula.CountifSumifFunctions=function(a,c,b,d){var e,g,h,j,k=0,m="",n=0,s=SocialCalc.Formula,q=s.OperandValueAndType,p=s.LookupResultType,r=s.TypeLookupTable.plus;e=s.TopOfStackValueAndType(d,b);g=s.OperandAsText(d,b);if(a=="SUMIF")if(b.length==1)h=s.TopOfStackValueAndType(d,b);else if(b.length==0)h={value:e.value,type:e.type};else return s.FunctionArgsError(a,c),0;else h={value:e.value,type:e.type};if(g.type.charAt(0)=="n")g.value+="";else if(g.type.charAt(0)=="e")g.value=null;else if(g.type.charAt(0)==
"b")g.value=null;if(e.type!="coord"&&e.type!="range")return s.FunctionArgsError(a,c),0;if(a=="SUMIF"&&h.type!="coord"&&h.type!="range")return s.FunctionArgsError(a,c),0;b.push(e);e=[];for(e.push(h);b.length;)if(h=q(d,b),j=q(d,e),s.TestCriteria(h.value,h.type,g.value))if(n+=1,j.type.charAt(0)=="n")k+=j.value-0,m=p(j.type,m||j.type,r);else if(j.type.charAt(0)=="e"&&m.charAt(0)!="e")m=j.type;a=="SUMIF"?c.push({type:m||"n",value:k}):a=="COUNTIF"&&c.push({type:"n",value:n})};
SocialCalc.Formula.FunctionList.COUNTIF=[SocialCalc.Formula.CountifSumifFunctions,2,"rangec","","stat"];SocialCalc.Formula.FunctionList.SUMIF=[SocialCalc.Formula.CountifSumifFunctions,-2,"sumif","","stat"];SocialCalc.Formula.IfFunction=function(a,c,b,d){a=SocialCalc.Formula.OperandValueAndType(d,b);d=a.type.charAt(0);if(d!="n"&&d!="b")c.push({type:"e#VALUE!",value:0});else return a.value||b.pop(),c.push(b.pop()),a.value&&b.pop(),null};
SocialCalc.Formula.FunctionList.IF=[SocialCalc.Formula.IfFunction,3,"iffunc","","test"];
SocialCalc.Formula.DateFunction=function(a,c,b,d){var a=SocialCalc.Formula,e=0,g=a.OperandAsNumber(d,b),h=a.OperandAsNumber(d,b),b=a.OperandAsNumber(d,b),d=a.LookupResultType(g.type,h.type,a.TypeLookupTable.twoargnumeric),d=a.LookupResultType(d,b.type,a.TypeLookupTable.twoargnumeric);d.charAt(0)=="n"&&(e=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(Math.floor(g.value),Math.floor(h.value),Math.floor(b.value))-SocialCalc.FormatNumber.datevalues.julian_offset,d="nd");a.PushOperand(c,d,e)};
SocialCalc.Formula.FunctionList.DATE=[SocialCalc.Formula.DateFunction,3,"date","","datetime"];SocialCalc.Formula.TimeFunction=function(a,c,b,d){var a=SocialCalc.Formula,e=0,g=a.OperandAsNumber(d,b),h=a.OperandAsNumber(d,b),b=a.OperandAsNumber(d,b),d=a.LookupResultType(g.type,h.type,a.TypeLookupTable.twoargnumeric),d=a.LookupResultType(d,b.type,a.TypeLookupTable.twoargnumeric);d.charAt(0)=="n"&&(e=(g.value*3600+h.value*60+b.value)/86400,d="nt");a.PushOperand(c,d,e)};
SocialCalc.Formula.FunctionList.TIME=[SocialCalc.Formula.TimeFunction,3,"hms","","datetime"];
SocialCalc.Formula.DMYFunctions=function(a,c,b,d){var e,g=SocialCalc.Formula,h=0,j=g.OperandAsNumber(d,b),k=g.LookupResultType(j.type,j.type,g.TypeLookupTable.oneargnumeric);if(k.charAt(0)=="n")switch(e=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(j.value+SocialCalc.FormatNumber.datevalues.julian_offset)),a){case "DAY":h=e.day;break;case "MONTH":h=e.month;break;case "YEAR":h=e.year;break;case "WEEKDAY":e={value:1};if(b.length){e=g.OperandAsNumber(d,b);if(e.type.charAt(0)!="n"||
e.value<1||e.value>3){g.PushOperand(c,"e#VALUE!",0);return}if(b.length){g.FunctionArgsError(a,c);return}}a=6;e.value>1&&(a-=1);h=Math.floor(j.value+a)%7+(e.value<3?1:0)}g.PushOperand(c,k,h)};SocialCalc.Formula.FunctionList.DAY=[SocialCalc.Formula.DMYFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.MONTH=[SocialCalc.Formula.DMYFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.YEAR=[SocialCalc.Formula.DMYFunctions,1,"v","","datetime"];
SocialCalc.Formula.FunctionList.WEEKDAY=[SocialCalc.Formula.DMYFunctions,-1,"weekday","","datetime"];
SocialCalc.Formula.HMSFunctions=function(a,c,b,d){var e,g=SocialCalc.Formula,h=0,j=g.OperandAsNumber(d,b),k=g.LookupResultType(j.type,j.type,g.TypeLookupTable.oneargnumeric);if(k.charAt(0)=="n"){if(j.value<0){g.PushOperand(c,"e#NUM!",0);return}e=j.value-Math.floor(j.value);e*=24;b=Math.floor(e);e-=Math.floor(e);e*=60;d=Math.floor(e);e-=Math.floor(e);e*=60;e=Math.floor(e+(j.value>=0?0.5:-0.5));a=="HOUR"?h=b:a=="MINUTE"?h=d:a=="SECOND"&&(h=e)}g.PushOperand(c,k,h)};
SocialCalc.Formula.FunctionList.HOUR=[SocialCalc.Formula.HMSFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.MINUTE=[SocialCalc.Formula.HMSFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.SECOND=[SocialCalc.Formula.HMSFunctions,1,"v","","datetime"];
SocialCalc.Formula.ExactFunction=function(a,c,b,d){var a=SocialCalc.Formula,e=0,g="nl",h=a.OperandValueAndType(d,b),j=h.type.charAt(0),b=a.OperandValueAndType(d,b),d=b.type.charAt(0);if(j=="t")d=="t"?e=h.value==b.value?1:0:d=="b"?e=h.value.length?0:1:d=="n"?e=h.value==b.value+""?1:0:d=="e"?(e=b.value,g=b.type):e=0;else if(j=="n")d=="n"?e=h.value-0==b.value-0?1:0:d=="b"?e=0:d=="t"?e=h.value+""==b.value?1:0:d=="e"?(e=b.value,g=b.type):e=0;else if(j=="b")d=="t"?e=b.value.length?0:1:d=="b"?e=1:d=="n"?
e=0:d=="e"?(e=b.value,g=b.type):e=0;else if(j=="e")e=h.value,g=h.type;a.PushOperand(c,g,e)};SocialCalc.Formula.FunctionList.EXACT=[SocialCalc.Formula.ExactFunction,2,"","","text"];SocialCalc.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],UPPER:[1]};
SocialCalc.Formula.StringFunctions=function(a,c,b,d){var e,g,h,j=SocialCalc.Formula;h=0;var k="e#VALUE!",m=b.length,n=j.ArgList[a],s=[],q=[];for(e=1;e<=m;e++){if(e>n.length){j.FunctionArgsError(a,c);return}n[e-1]==0?g=j.OperandAsNumber(d,b):n[e-1]==1?g=j.OperandAsText(d,b):n[e-1]==-1&&(g=j.OperandValueAndType(d,b));s[e]=g.value;q[e]=g.type;if(g.type.charAt(0)=="e"){j.PushOperand(c,g.type,h);return}}switch(a){case "FIND":h=q[3]?s[3]-1:0;h<0?h="Start is before string":(h=s[2].indexOf(s[1],h),h>=0?(h+=
1,k="n"):h="Not found");break;case "LEFT":h=q[2]?s[2]-0:1;h<0?h="Negative length":(h=s[1].substring(0,h),k="t");break;case "LEN":h=s[1].length;k="n";break;case "LOWER":h=s[1].toLowerCase();k="t";break;case "MID":a=s[2]-0;h=s[3]-0;h<1||a<1?h="Bad arguments":(h=s[1].substring(a-1,a+h-1),k="t");break;case "PROPER":h=s[1].replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});k="t";break;case "REPLACE":a=s[2]-0;h=s[3]-0;h<0||a<1?h="Bad arguments":(h=s[1].substring(0,a-1)+
s[4]+s[1].substring(a-1+h),k="t");break;case "REPT":a=s[2]-0;if(a<0)h="Negative count";else{for(h="";a>0;a--)h+=s[1];k="t"}break;case "RIGHT":h=q[2]?s[2]-0:1;h<0?h="Negative length":(h=s[1].slice(-h),k="t");break;case "SUBSTITUTE":fulltext=s[1];oldtext=s[2];newtext=s[3];if(s[4]!=null){if(which=s[4]-0,which<=0){h="Non-positive instance number";break}}else which=0;oldpos=a=0;for(h="";;)if(pos=fulltext.indexOf(oldtext,oldpos),pos>=0){a++;h+=fulltext.substring(oldpos,pos);if(which==0)h+=newtext;else if(which==
a){h+=newtext+fulltext.substring(pos+oldtext.length);break}else h+=oldtext;oldpos=pos+oldtext.length}else{h+=fulltext.substring(oldpos);break}k="t";break;case "TRIM":h=s[1];h=h.replace(/^ */,"");h=h.replace(/ *$/,"");h=h.replace(/ +/g," ");k="t";break;case "UPPER":h=s[1].toUpperCase(),k="t"}j.PushOperand(c,k,h)};SocialCalc.Formula.FunctionList.FIND=[SocialCalc.Formula.StringFunctions,-2,"find","","text"];SocialCalc.Formula.FunctionList.LEFT=[SocialCalc.Formula.StringFunctions,-2,"tc","","text"];
SocialCalc.Formula.FunctionList.LEN=[SocialCalc.Formula.StringFunctions,1,"txt","","text"];SocialCalc.Formula.FunctionList.LOWER=[SocialCalc.Formula.StringFunctions,1,"txt","","text"];SocialCalc.Formula.FunctionList.MID=[SocialCalc.Formula.StringFunctions,3,"mid","","text"];SocialCalc.Formula.FunctionList.PROPER=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.REPLACE=[SocialCalc.Formula.StringFunctions,4,"replace","","text"];
SocialCalc.Formula.FunctionList.REPT=[SocialCalc.Formula.StringFunctions,2,"tc","","text"];SocialCalc.Formula.FunctionList.RIGHT=[SocialCalc.Formula.StringFunctions,-1,"tc","","text"];SocialCalc.Formula.FunctionList.SUBSTITUTE=[SocialCalc.Formula.StringFunctions,-3,"subs","","text"];SocialCalc.Formula.FunctionList.TRIM=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.UPPER=[SocialCalc.Formula.StringFunctions,1,"v","","text"];
SocialCalc.Formula.IsFunctions=function(a,c,b,d){var e=SocialCalc.Formula,g=0,b=e.OperandValueAndType(d,b),d=b.type.charAt(0);switch(a){case "ISBLANK":g=b.type=="b"?1:0;break;case "ISERR":g=d=="e"?b.type=="e#N/A"?0:1:0;break;case "ISERROR":g=d=="e"?1:0;break;case "ISLOGICAL":g=b.type=="nl"?1:0;break;case "ISNA":g=b.type=="e#N/A"?1:0;break;case "ISNONTEXT":g=d=="t"?0:1;break;case "ISNUMBER":g=d=="n"?1:0;break;case "ISTEXT":g=d=="t"?1:0}e.PushOperand(c,"nl",g)};
SocialCalc.Formula.FunctionList.ISBLANK=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISERR=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISERROR=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISLOGICAL=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISNA=[SocialCalc.Formula.IsFunctions,1,"v","","test"];
SocialCalc.Formula.FunctionList.ISNONTEXT=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISNUMBER=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISTEXT=[SocialCalc.Formula.IsFunctions,1,"v","","test"];
SocialCalc.Formula.NTVFunctions=function(a,c,b,d){var e=SocialCalc.Formula,g=0,h="e#VALUE!",b=e.OperandValueAndType(d,b),d=b.type.charAt(0);switch(a){case "N":g=d=="n"?b.value-0:0;h="n";break;case "T":g=d=="t"?b.value+"":"";h="t";break;case "VALUE":d=="n"||d=="b"?(g=b.value||0,h="n"):d=="t"&&(b=SocialCalc.DetermineValueType(b.value),b.type.charAt(0)!="n"?(g=0,h="e#VALUE!"):(g=b.value-0,h="n"))}if(d=="e")h=b.type;e.PushOperand(c,h,g)};
SocialCalc.Formula.FunctionList.N=[SocialCalc.Formula.NTVFunctions,1,"v","","math"];SocialCalc.Formula.FunctionList.T=[SocialCalc.Formula.NTVFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.VALUE=[SocialCalc.Formula.NTVFunctions,1,"v","","text"];
SocialCalc.Formula.Math1Functions=function(a,c,b,d){var e={},g=SocialCalc.Formula,d=g.OperandAsNumber(d,b),b=d.value;e.type=g.LookupResultType(d.type,d.type,g.TypeLookupTable.oneargnumeric);if(e.type=="n")switch(a){case "ABS":b=Math.abs(b);break;case "ACOS":b>=-1&&b<=1?b=Math.acos(b):e.type="e#NUM!";break;case "ASIN":b>=-1&&b<=1?b=Math.asin(b):e.type="e#NUM!";break;case "ATAN":b=Math.atan(b);break;case "COS":b=Math.cos(b);break;case "DEGREES":b=b*180/Math.PI;break;case "EVEN":b=b<0?-b:b;b!=Math.floor(b)?
b=Math.floor(b+1)+Math.floor(b+1)%2:b+=b%2;d.value<0&&(b=-b);break;case "EXP":b=Math.exp(b);break;case "FACT":a=1;for(b=Math.floor(b);b>0;b--)a*=b;b=a;break;case "INT":b=Math.floor(b);break;case "LN":if(b<=0)e.type="e#NUM!",e.error=SocialCalc.Constants.s_sheetfunclnarg;b=Math.log(b);break;case "LOG10":if(b<=0)e.type="e#NUM!",e.error=SocialCalc.Constants.s_sheetfunclog10arg;b=Math.log(b)/Math.log(10);break;case "ODD":b=b<0?-b:b;b!=Math.floor(b)?b=Math.floor(b+1)+(1-Math.floor(b+1)%2):b+=1-b%2;d.value<
0&&(b=-b);break;case "RADIANS":b=b*Math.PI/180;break;case "SIN":b=Math.sin(b);break;case "SQRT":b>=0?b=Math.sqrt(b):e.type="e#NUM!";break;case "TAN":Math.cos(b)!=0?b=Math.tan(b):e.type="e#NUM!"}e.value=b;c.push(e);return null};SocialCalc.Formula.FunctionList.ABS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.ACOS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.ASIN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.FunctionList.ATAN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.COS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.DEGREES=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.EVEN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.EXP=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.FunctionList.FACT=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.INT=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.LN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.LOG10=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.ODD=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.FunctionList.RADIANS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.SIN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.SQRT=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.TAN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.Math2Functions=function(a,c,b,d){var e,g,h={};g=SocialCalc.Formula;e=g.OperandAsNumber(d,b);b=g.OperandAsNumber(d,b);h.type=g.LookupResultType(e.type,b.type,g.TypeLookupTable.twoargnumeric);if(h.type=="n")switch(a){case "ATAN2":e.value==0&&b.value==0?h.type="e#DIV/0!":h.value=Math.atan2(b.value,e.value);break;case "POWER":h.value=Math.pow(e.value,b.value);if(isNaN(h.value))h.value=0,h.type="e#NUM!";break;case "MOD":b.value==0?h.type="e#DIV/0!":(a=e.value/b.value,a=Math.floor(a),
h.value=e.value-a*b.value);break;case "TRUNC":a=1;if(b.value>=0){b.value=Math.floor(b.value);for(g=0;g<b.value;g++)a*=10;h.value=Math.floor(Math.abs(e.value)*a)/a}else if(b.value<0){b.value=Math.floor(-b.value);for(g=0;g<b.value;g++)a*=10;h.value=Math.floor(Math.abs(e.value)/a)*a}if(e.value<0)h.value=-h.value}c.push(h);return null};SocialCalc.Formula.FunctionList.ATAN2=[SocialCalc.Formula.Math2Functions,2,"xy","","math"];
SocialCalc.Formula.FunctionList.MOD=[SocialCalc.Formula.Math2Functions,2,"","","math"];SocialCalc.Formula.FunctionList.POWER=[SocialCalc.Formula.Math2Functions,2,"","","math"];SocialCalc.Formula.FunctionList.TRUNC=[SocialCalc.Formula.Math2Functions,2,"valpre","","math"];
SocialCalc.Formula.LogFunction=function(a,c,b,d){var e,g={},h=SocialCalc.Formula;g.value=0;e=h.OperandAsNumber(d,b);g.type=h.LookupResultType(e.type,e.type,h.TypeLookupTable.oneargnumeric);if(b.length==1){if(b=h.OperandAsNumber(d,b),b.type.charAt(0)!="n"||b.value<=0)return h.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfunclogsecondarg),0}else if(b.length!=0)return h.FunctionArgsError(a,c),0;else b={value:Math.E,type:"n"};if(g.type=="n"){if(e.value<=0)return h.FunctionSpecificError(a,
c,"e#NUM!",SocialCalc.Constants.s_sheetfunclogfirstarg),0;g.value=Math.log(e.value)/Math.log(b.value)}c.push(g)};SocialCalc.Formula.FunctionList.LOG=[SocialCalc.Formula.LogFunction,-1,"log","","math"];
SocialCalc.Formula.RoundFunction=function(a,c,b,d){var e,g,h=SocialCalc.Formula;g=0;var j="e#VALUE!";e=h.OperandValueAndType(d,b);j=h.LookupResultType(e.type,e.type,h.TypeLookupTable.oneargnumeric);if(b.length==1){if(b=h.OperandValueAndType(d,b),b.type.charAt(0)!="n")return h.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfuncroundsecondarg),0}else if(b.length!=0)return h.FunctionArgsError(a,c),0;else b={value:0,type:"n"};if(j=="n")if(b.value-=0,b.value==0)g=Math.round(e.value);else if(b.value>
0){a=1;b.value=Math.floor(b.value);for(g=0;g<b.value;g++)a*=10;e=Math.round(e.value*a);g=e/a}else if(b.value<0){a=1;b.value=Math.floor(-b.value);for(g=0;g<b.value;g++)a*=10;e=Math.round(e.value/a);g=e*a}h.PushOperand(c,j,g)};SocialCalc.Formula.FunctionList.ROUND=[SocialCalc.Formula.RoundFunction,-1,"vp","","math"];
SocialCalc.Formula.AndOrFunctions=function(a,c,b,d){var e,g,h=SocialCalc.Formula,j="";for(a=="AND"?g=1:a=="OR"&&(g=0);b.length;)if(e=h.OperandValueAndType(d,b),e.type.charAt(0)=="n")e.value-=0,a=="AND"?g=e.value!=0?g:0:a=="OR"&&(g=e.value!=0?1:g),j=h.LookupResultType(e.type,j||"nl",h.TypeLookupTable.propagateerror);else if(e.type.charAt(0)=="e"&&j.charAt(0)!="e")j=e.type;j.length<1&&(j="e#VALUE!",g=0);h.PushOperand(c,j,g)};
SocialCalc.Formula.FunctionList.AND=[SocialCalc.Formula.AndOrFunctions,-1,"vn","","test"];SocialCalc.Formula.FunctionList.OR=[SocialCalc.Formula.AndOrFunctions,-1,"vn","","test"];SocialCalc.Formula.NotFunction=function(a,c,b,d){var a=0,e=SocialCalc.Formula,b=e.OperandValueAndType(d,b),d=e.LookupResultType(b.type,b.type,e.TypeLookupTable.propagateerror);b.type.charAt(0)=="n"||b.type=="b"?(a=b.value-0!=0?0:1,d="nl"):b.type.charAt(0)=="t"&&(d="e#VALUE!");e.PushOperand(c,d,a)};
SocialCalc.Formula.FunctionList.NOT=[SocialCalc.Formula.NotFunction,1,"v","","test"];SocialCalc.Formula.ChooseFunction=function(a,c,b,d){var e,g,h=0,j=SocialCalc.Formula,k=j.OperandAsNumber(d,b);if(k.type.charAt(0)!="n")k.value=0;k.value=Math.floor(k.value);for(a=0;b.length;)if(g=j.TopOfStackValueAndType(d,b),a+=1,k.value==a){h=g.value;e=g.type;break}e?j.PushOperand(c,e,h):j.PushOperand(c,"e#VALUE!",0)};SocialCalc.Formula.FunctionList.CHOOSE=[SocialCalc.Formula.ChooseFunction,-2,"choose","","lookup"];
SocialCalc.Formula.ColumnsRowsFunctions=function(a,c,b,d){var e=0,g=SocialCalc.Formula,b=g.TopOfStackValueAndType(d,b);if(b.type=="coord")e=1,a="n";else if(b.type=="range"){d=g.DecodeRangeParts(d,b.value);if(a=="COLUMNS")e=d.ncols;else if(a=="ROWS")e=d.nrows;a="n"}else e=0,a="e#VALUE!";g.PushOperand(c,a,e)};SocialCalc.Formula.FunctionList.COLUMNS=[SocialCalc.Formula.ColumnsRowsFunctions,1,"range","","lookup"];
SocialCalc.Formula.FunctionList.ROWS=[SocialCalc.Formula.ColumnsRowsFunctions,1,"range","","lookup"];
SocialCalc.Formula.ZeroArgFunctions=function(a,c){var b,d,e={value:0};switch(a){case "FALSE":e.type="nl";e.value=0;break;case "NA":e.type="e#N/A";break;case "NOW":b=new Date;d=b.getTimezoneOffset();b=b.getTime()/1E3;e.value=25569+b/86400-d/1440;e.type="ndt";SocialCalc.Formula.FreshnessInfo["volatile"].NOW=!0;break;case "PI":e.type="n";e.value=Math.PI;break;case "TODAY":b=new Date;d=b.getTimezoneOffset();b=b.getTime()/1E3;e.value=Math.floor(25569+b/86400-d/1440);e.type="nd";SocialCalc.Formula.FreshnessInfo["volatile"].TODAY=
!0;break;case "TRUE":e.type="nl",e.value=1}c.push(e);return null};SocialCalc.Formula.FunctionList.FALSE=[SocialCalc.Formula.ZeroArgFunctions,0,"","","test"];SocialCalc.Formula.FunctionList.NA=[SocialCalc.Formula.ZeroArgFunctions,0,"","","test"];SocialCalc.Formula.FunctionList.NOW=[SocialCalc.Formula.ZeroArgFunctions,0,"","","datetime"];SocialCalc.Formula.FunctionList.PI=[SocialCalc.Formula.ZeroArgFunctions,0,"","","math"];
SocialCalc.Formula.FunctionList.TODAY=[SocialCalc.Formula.ZeroArgFunctions,0,"","","datetime"];SocialCalc.Formula.FunctionList.TRUE=[SocialCalc.Formula.ZeroArgFunctions,0,"","","test"];
SocialCalc.Formula.DDBFunction=function(a,c,b,d){var e,g=SocialCalc.Formula,h=g.OperandAsNumber(d,b),j=g.OperandAsNumber(d,b),k=g.OperandAsNumber(d,b),m=g.OperandAsNumber(d,b);if(!g.CheckForErrorValue(c,h)&&!g.CheckForErrorValue(c,j)&&!g.CheckForErrorValue(c,k)&&!g.CheckForErrorValue(c,m)){if(k.value<1)return g.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfuncddblife),0;e={value:2,type:"n"};b.length>0&&(e=g.OperandAsNumber(d,b));if(b.length!=0)return g.FunctionArgsError(a,c),0;if(!g.CheckForErrorValue(c,
e)){b=a=0;for(d=1;d<=m.value-0&&d<=k.value;d++)a=(h.value-b)*(e.value/k.value),h.value-b-a<j.value&&(a=h.value-b-j.value),b+=a;g.PushOperand(c,"n$",a)}}};SocialCalc.Formula.FunctionList.DDB=[SocialCalc.Formula.DDBFunction,-4,"ddb","","financial"];
SocialCalc.Formula.SLNFunction=function(a,c,b,d){var e=SocialCalc.Formula,g=e.OperandAsNumber(d,b),h=e.OperandAsNumber(d,b),b=e.OperandAsNumber(d,b);if(!e.CheckForErrorValue(c,g)&&!e.CheckForErrorValue(c,h)&&!e.CheckForErrorValue(c,b)){if(b.value<1)return e.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfuncslnlife),0;e.PushOperand(c,"n$",(g.value-h.value)/b.value)}};SocialCalc.Formula.FunctionList.SLN=[SocialCalc.Formula.SLNFunction,3,"csl","","financial"];
SocialCalc.Formula.SYDFunction=function(a,c,b,d){var a=SocialCalc.Formula,e=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b),h=a.OperandAsNumber(d,b),d=a.OperandAsNumber(d,b);if(!a.CheckForErrorValue(c,e)&&!a.CheckForErrorValue(c,g)&&!a.CheckForErrorValue(c,h)&&!a.CheckForErrorValue(c,d)){if(h.value<1||d.value<=0)return a.PushOperand(c,"e#NUM!",0),0;b=(h.value+1)*h.value/2;a.PushOperand(c,"n$",(e.value-g.value)*(h.value-d.value+1)/b)}};
SocialCalc.Formula.FunctionList.SYD=[SocialCalc.Formula.SYDFunction,4,"cslp","","financial"];
SocialCalc.Formula.InterestFunctions=function(a,c,b,d){var e,g,h,j,k,m,n,s,q,p=SocialCalc.Formula,r=p.OperandAsNumber(d,b);n=p.OperandAsNumber(d,b);m=p.OperandAsNumber(d,b);e=p.LookupResultType(r.type,n.type,p.TypeLookupTable.twoargnumeric);e=p.LookupResultType(e,m.type,p.TypeLookupTable.twoargnumeric);if(b.length&&(h=p.OperandAsNumber(d,b),e=p.LookupResultType(e,h.type,p.TypeLookupTable.twoargnumeric),b.length&&(j=p.OperandAsNumber(d,b),e=p.LookupResultType(e,j.type,p.TypeLookupTable.twoargnumeric),
b.length))){if(a!="RATE")return p.FunctionArgsError(a,c),0;k=p.OperandAsNumber(d,b);e=p.LookupResultType(e,k.type,p.TypeLookupTable.twoargnumeric)}if(e=="n")switch(a){case "FV":k=r.value;a=n.value;n=m.value;m=h!=null?h.value:0;j=j!=null?j.value?1:0:0;g=h=k==0?-m-n*a:-(m*Math.pow(1+k,a)+n*(1+k*j)*(Math.pow(1+k,a)-1)/k);e="n$";break;case "NPER":k=r.value;n=n.value;m=m.value;h=h!=null?h.value:0;j=j!=null?j.value?1:0:0;if(k==0){if(n==0){p.PushOperand(c,"e#NUM!",0);return}a=(m+h)/-n}else{s=n*(1+k*j)/k;
q=m+s;if(q==0||k<=-1){p.PushOperand(c,"e#NUM!",0);return}s=(s-h)/q;if(s<=0){p.PushOperand(c,"e#NUM!",0);return}s=Math.log(s);q=Math.log(1+k);a=s/q}g=a;e="n";break;case "PMT":k=r.value;a=n.value;m=m.value;h=h!=null?h.value:0;j=j!=null?j.value?1:0:0;if(a==0){p.PushOperand(c,"e#NUM!",0);return}else n=k==0?(h-m)/a:(0-h-m*Math.pow(1+k,a))/((1+k*j)*(Math.pow(1+k,a)-1)/k);g=n;e="n$";break;case "PV":k=r.value;a=n.value;n=m.value;h=h!=null?h.value:0;j=j!=null?j.value?1:0:0;if(k==-1){p.PushOperand(c,"e#DIV/0!",
0);return}else m=k==0?-h-n*a:(-h-n*(1+k*j)*(Math.pow(1+k,a)-1)/k)/Math.pow(1+k,a);g=m;e="n$";break;case "RATE":a=r.value;n=n.value;m=m.value;h=h!=null?h.value:0;j=j!=null?j.value?1:0:0;k=k!=null?k.value:0.1;b=0;delta=1;epsilon=1.0E-7;for(k=k||1.0E-8;(delta>=0?delta:-delta)>epsilon&&k!=s;)if(delta=h+m*Math.pow(1+k,a)+n*(1+k*j)*(Math.pow(1+k,a)-1)/k,q!=null?(q=(delta-q)/(k-s)||0.0010,s=k,k-=delta/q):(s=k,k*=1.1),q=delta,b++,b>=100){p.PushOperand(c,"e#NUM!",0);return}g=k;e="n%"}p.PushOperand(c,e,g)};
SocialCalc.Formula.FunctionList.FV=[SocialCalc.Formula.InterestFunctions,-3,"fv","","financial"];SocialCalc.Formula.FunctionList.NPER=[SocialCalc.Formula.InterestFunctions,-3,"nper","","financial"];SocialCalc.Formula.FunctionList.PMT=[SocialCalc.Formula.InterestFunctions,-3,"pmt","","financial"];SocialCalc.Formula.FunctionList.PV=[SocialCalc.Formula.InterestFunctions,-3,"pv","","financial"];SocialCalc.Formula.FunctionList.RATE=[SocialCalc.Formula.InterestFunctions,-3,"rate","","financial"];
SocialCalc.Formula.NPVFunction=function(a,c,b,d){var e,g,h,j,k=SocialCalc.Formula;e=k.OperandAsNumber(d,b);if(!k.CheckForErrorValue(c,e)){g=0;a="n";for(h=1;b.length;)if(j=k.OperandValueAndType(d,b),j.type.charAt(0)=="n"){h*=1+e.value;if(h==0){k.PushOperand(c,"e#DIV/0!",0);return}g+=j.value/h;a=k.LookupResultType(j.type,a||j.type,k.TypeLookupTable.plus)}else if(j.type.charAt(0)=="e"&&a.charAt(0)!="e"){a=j.type;break}a.charAt(0)=="n"&&(a="n$");k.PushOperand(c,a,g)}};
SocialCalc.Formula.FunctionList.NPV=[SocialCalc.Formula.NPVFunction,-2,"npv","","financial"];
SocialCalc.Formula.IRRFunction=function(a,c,b,d){var e,g,h,j;j=[];var k=[],m=SocialCalc.Formula;for(j.push(b.pop());j.length;)if(e=m.OperandValueAndType(d,j),e.type.charAt(0)=="n")k.push(e.value);else if(e.type.charAt(0)=="e"){m.PushOperand(c,"e#VALUE!",0);return}if(k.length){e={value:0};if(b.length){e=m.OperandAsNumber(d,b);if(e.type.charAt(0)!="n"&&e.type.charAt(0)!="b"){m.PushOperand(c,"e#VALUE!",0);return}if(b.length){m.FunctionArgsError(a,c);return}}e.value=e.value||0.1;a=0;b=e.value;for(d=1;(d>=
0?d:-d)>1.0E-7&&b!=h;){d=0;e=1;for(j=0;j<k.length;j++){e*=1+b;if(e==0){m.PushOperand(c,"e#DIV/0!",0);return}d+=k[j]/e}g!=null?(g=(d-g)/(b-h),h=b,b-=d/g):(h=b,b*=1.1);g=d;a++;if(a>=20){m.PushOperand(c,"e#NUM!",0);return}}m.PushOperand(c,"n%",b)}else m.PushOperand(c,"e#NUM!",0)};SocialCalc.Formula.FunctionList.IRR=[SocialCalc.Formula.IRRFunction,-1,"irr","","financial"];SocialCalc.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null};
SocialCalc.Formula.FindInSheetCache=function(a){var c=SocialCalc.Formula.SheetCache,a=SocialCalc.Formula.NormalizeSheetName(a);if(c.sheets[a])return c.sheets[a].sheet;if(c.waitingForLoading)return null;c.waitingForLoading=a;return null};
SocialCalc.Formula.AddSheetToCache=function(a,c){var b=null,d=SocialCalc.Formula.SheetCache,e=d.constants,g=SocialCalc.Formula.NormalizeSheetName(a);c&&(b=new SocialCalc.Sheet,b.ParseSheetSave(c));d.sheets[g]={sheet:b,recalcstate:e.asloaded,name:g};SocialCalc.Formula.FreshnessInfo.sheets[g]=!0;return b};SocialCalc.Formula.NormalizeSheetName=function(a){return SocialCalc.Callbacks.NormalizeSheetName?SocialCalc.Callbacks.NormalizeSheetName(a):a.toLowerCase()};SocialCalc.Formula.RemoteFunctionInfo={waitingForServer:null};
SocialCalc.Formula.FreshnessInfo={sheets:{},"volatile":{},recalc_completed:!1};SocialCalc.Formula.FreshnessInfoReset=function(){var a=SocialCalc.Formula.FreshnessInfo;a.sheets={};a["volatile"]={};a.recalc_completed=!1};SocialCalc.Formula.PlainCoord=function(a){return a.indexOf("$")==-1?a:a.replace(/\$/g,"")};
SocialCalc.Formula.OrderRangeParts=function(a,c){var b,d,e={};b=SocialCalc.coordToCr(a);d=SocialCalc.coordToCr(c);b.col>d.col?(e.c1=d.col,e.c2=b.col):(e.c1=b.col,e.c2=d.col);b.row>d.row?(e.r1=d.row,e.r2=b.row):(e.r1=b.row,e.r2=d.row);return e};
SocialCalc.Formula.TestCriteria=function(a,c,b){var d,e,g;if(b==null)return!1;b+="";d=b.charAt(0);d=="="||d=="<"||d==">"?b=b.substring(1):(d=b.substring(0,2),d=="<="||d=="<>"||d==">="?b=b.substring(2):d="none");b=SocialCalc.DetermineValueType(b);if(!b.type){if(d=="none")return!1;if(c.charAt(0)=="b"){if(d=="=")return!0}else if(d=="<>")return!0;return!1}e=!1;if(b.type.charAt(0)=="n"&&c.charAt(0)=="t"&&(g=SocialCalc.DetermineValueType(a),g.type.charAt(0)=="n"))a=g.value,c=g.type;if(c.charAt(0)=="n"&&
b.type.charAt(0)=="n")switch(a-=0,b.value-=0,d){case "<":e=a<b.value;break;case "<=":e=a<=b.value;break;case "=":case "none":e=a==b.value;break;case ">=":e=a>=b.value;break;case ">":e=a>b.value;break;case "<>":e=a!=b.value}else if(c.charAt(0)=="e")e=!1;else if(b.type.charAt(0)=="e")e=!1;else{c.charAt(0)=="n"&&(a=SocialCalc.format_number_for_display(a,"n",""));if(b.type.charAt(0)=="n")return!1;a=a?a.toLowerCase():"";b.value=b.value?b.value.toLowerCase():"";switch(d){case "<":e=a<b.value;break;case "<=":e=
a<=b.value;break;case "=":e=a==b.value;break;case "none":e=a.substring(0,b.value.length)==b.value;break;case ">=":e=a>=b.value;break;case ">":e=a>b.value;break;case "<>":e=a!=b.value}}return e};SocialCalc||(SocialCalc={});SocialCalc.Popup={};SocialCalc.Popup.Types={};SocialCalc.Popup.Controls={};SocialCalc.Popup.Current={};SocialCalc.Popup.imagePrefix="images/sc-";SocialCalc.Popup.LocalizeString=function(a){return a};SocialCalc.Popup.Create=function(a,c,b){var d=SocialCalc.Popup.Types[a];d&&d.Create&&d.Create(a,c,b)};
SocialCalc.Popup.SetValue=function(a,c){var b=SocialCalc.Popup,d=b.Types,e=b.Controls;e[a]?(b=e[a].type,d=d[b],e=e[a].data,d&&d.Create&&(d.SetValue(b,a,c),e.attribs&&e.attribs.changedcallback&&e.attribs.changedcallback(e.attribs,a,c))):alert("Unknown control "+a)};
SocialCalc.Popup.SetDisabled=function(a,c){var b=SocialCalc.Popup,d=b.Types,e=b.Controls;if(e[a]){if(e=e[a].type,(d=d[e])&&d.Create){if(b.Current.id&&a==b.Current.id)d.Hide(e,b.Current.id),b.Current.id=null;d.SetDisabled(e,a,c)}}else alert("Unknown control "+a)};SocialCalc.Popup.GetValue=function(a){var c=SocialCalc.Popup,b=c.Types,c=c.Controls;if(c[a])return c=c[a].type,(b=b[c])&&b.Create?b.GetValue(c,a):null;else alert("Unknown control "+a)};
SocialCalc.Popup.Initialize=function(a,c){var b=SocialCalc.Popup,d=b.Types,b=b.Controls;b[a]?(b=b[a].type,(d=d[b])&&d.Initialize&&d.Initialize(b,a,c)):alert("Unknown control "+a)};SocialCalc.Popup.Reset=function(a){var c=SocialCalc.Popup.Types;c[a].Reset&&c[a].Reset(a)};
SocialCalc.Popup.CClick=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;if(d[a]){if(!d[a].data||!d[a].data.disabled){var e=d[a].type,g=b[e];if(c.Current.id&&(b[d[c.Current.id].type].Hide(e,c.Current.id),a==c.Current.id)){c.Current.id=null;return}g&&g.Show&&g.Show(e,a);c.Current.id=a}}else alert("Unknown control "+a)};SocialCalc.Popup.Close=function(){var a=SocialCalc.Popup;a.Current.id&&a.CClick(a.Current.id)};
SocialCalc.Popup.Cancel=function(){var a=SocialCalc.Popup;if(a.Current.id){var c=a.Controls[a.Current.id].type;a.Types[c].Cancel(c,a.Current.id);a.Current.id=null}};
SocialCalc.Popup.CreatePopupDiv=function(a,c){var b,d=SocialCalc.Popup.Controls[a].data,e=document.createElement("div");e.style.position="absolute";b=SocialCalc.GetElementPositionWithScroll(d.mainele);e.style.top=b.top+d.mainele.offsetHeight+"px";e.style.left=b.left+"px";e.style.zIndex=100;e.style.backgroundColor="#FFF";e.style.border="1px solid black";if(c.width)e.style.width=c.width;d.mainele.appendChild(e);if(c.title&&(e.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+
c.title+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.Popup.Cancel();">&nbsp;X&nbsp;</td></tr></table>',c.moveable))d.dragregistered=e.firstChild.firstChild.firstChild.firstChild,SocialCalc.DragRegister(d.dragregistered,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:e});return e};
SocialCalc.Popup.EnsurePosition=function(a,c){function b(a){var c=SocialCalc.GetElementPositionWithScroll(a);c.height=a.offsetHeight;c.width=a.offsetWidth;c.bottom=c.top+c.height;c.right=c.left+c.width;return c}var d=SocialCalc.Popup.Controls[a].data,e=d.mainele.firstChild;if(e){var d=d.popupele,g=b(d),h=b(c),e=b(e);if(e.bottom+g.height<h.bottom&&e.left+g.width<h.right)d.style.top=e.bottom+"px",d.style.left=e.left+"px";else if(e.top-g.height>h.top&&e.left+g.width<h.right)d.style.top=e.top-g.height+
"px",d.style.left=e.left+"px";else if(e.bottom+g.height<h.bottom&&e.right-g.width>h.left)d.style.top=e.bottom+"px",d.style.left=e.right-g.width+"px";else if(e.top-g.height>h.top&&e.right-g.width>h.left)d.style.top=e.top-g.height+"px",d.style.left=e.right-g.width+"px";else if(e.bottom+g.height<h.bottom&&g.width<h.width)d.style.top=e.bottom+"px",d.style.left=h.left+Math.floor((h.width-g.width)/2)+"px";else if(e.top-g.height>h.top&&g.width<h.width)d.style.top=e.top-g.height+"px",d.style.left=h.left+
Math.floor((h.width-g.width)/2)+"px";else if(g.height<h.height&&e.right+g.width<h.right)d.style.top=h.top+Math.floor((h.height-g.height)/2)+"px",d.style.left=e.right+"px";else if(g.height<h.height&&e.left-g.width>h.left)d.style.top=h.top+Math.floor((h.height-g.height)/2)+"px",d.style.left=e.left-g.width+"px"}else alert("No main popup element firstChild.")};SocialCalc.Popup.DestroyPopupDiv=function(a,c){if(a)a.innerHTML="",SocialCalc.DragUnregister(c),a.parentNode&&a.parentNode.removeChild(a)};
SocialCalc.Popup.RGBToHex=function(a){var c=SocialCalc.Popup;return a==""?"000000":(a=a.match(/(\d+)\D+(\d+)\D+(\d+)/))?c.ToHex(a[1])+c.ToHex(a[2])+c.ToHex(a[3]):"000000"};SocialCalc.Popup.HexDigits="0123456789ABCDEF";SocialCalc.Popup.ToHex=function(a){var c=SocialCalc.Popup,b=a%16;return c.HexDigits.charAt(Math.floor(a/16))+c.HexDigits.charAt(b)};
SocialCalc.Popup.FromHex=function(a){var c=SocialCalc.Popup,b=c.HexDigits.indexOf(a.charAt(0).toUpperCase()),a=c.HexDigits.indexOf(a.charAt(1).toUpperCase());return(b>=0?b:0)*16+(a>=0?a:0)};SocialCalc.Popup.HexToRGB=function(a){var c=SocialCalc.Popup;return"rgb("+c.FromHex(a.substring(1,3))+","+c.FromHex(a.substring(3,5))+","+c.FromHex(a.substring(5,7))+")"};SocialCalc.Popup.makeRGB=function(a,c,b){return"rgb("+(a>0?a:0)+","+(c>0?c:0)+","+(b>0?b:0)+")"};
SocialCalc.Popup.splitRGB=function(a){return(a=a.match(/(\d+)\D+(\d+)\D+(\d+)\D/))?{r:a[1]-0,g:a[2]-0,b:a[3]-0}:{r:0,g:0,b:0}};SocialCalc.Popup.Types.List={};
SocialCalc.Popup.Types.List.Create=function(a,c,b){var d=SocialCalc.Popup.Controls,a={type:a,value:"",display:"",data:{}};d[c]?alert("Already created "+c):(d[c]=a,d=a.data,d.attribs=b||{},(b=document.getElementById(c))?(d.mainele=b,b.innerHTML='<input style="cursor:pointer;width:'+(d.attribs.inputWidth||"100px")+';font-size:smaller;" onfocus="this.blur();" onclick="SocialCalc.Popup.CClick(\''+c+'\');" value="">',d.options=[]):alert("Missing element "+c))};
SocialCalc.Popup.Types.List.SetValue=function(a,c,b){a=SocialCalc.Popup.Controls[c].data;a.value=b;a.custom=!1;for(b=0;b<a.options.length;b++)if(o=a.options[b],(!o.a||!o.a.skip&&!o.a.custom&&!o.a.cancel)&&o.v==a.value){a.display=o.o;break}if(b==a.options.length)a.display="Custom",a.custom=!0;if(a.mainele&&a.mainele.firstChild)a.mainele.firstChild.value=a.display};
SocialCalc.Popup.Types.List.SetDisabled=function(a,c,b){a=SocialCalc.Popup.Controls[c].data;a.disabled=b;if(a.mainele&&a.mainele.firstChild)a.mainele.firstChild.disabled=b};SocialCalc.Popup.Types.List.GetValue=function(a,c){return SocialCalc.Popup.Controls[c].data.value};SocialCalc.Popup.Types.List.Initialize=function(a,c,b){var d,a=SocialCalc.Popup,e=a.Controls[c].data;for(d in b.attribs)e.attribs[d]=b.attribs[d];e.options=b?b.options:[];b.value&&a.SetValue(c,b.value)};
SocialCalc.Popup.Types.List.Reset=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;if(c.Current.id&&d[c.Current.id].type==a)b[a].Hide(a,c.Current.id),c.Current.id=null};
SocialCalc.Popup.Types.List.Show=function(a,c){var b;b=SocialCalc.Popup;var d=b.Controls[c].data,e="";d.popupele=b.CreatePopupDiv(c,d.attribs);d.custom?(e=SocialCalc.Popup.Types.List.MakeCustom(a,c),b=document.createElement("div"),b.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+e+"</div>",d.customele=b.firstChild.firstChild.childNodes[1],d.listdiv=null):(e=SocialCalc.Popup.Types.List.MakeList(a,c),b=document.createElement("div"),b.innerHTML='<div style="cursor:default;padding:4px;">'+
e+"</div>",d.customele=null,d.listdiv=b.firstChild);d.contentele=b;if(d.mainele&&d.mainele.firstChild)d.mainele.firstChild.disabled=!0;d.popupele.appendChild(b);d.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,d.attribs.ensureWithin)};
SocialCalc.Popup.Types.List.MakeList=function(a,c){var b,d,e,g=SocialCalc.Popup.Controls[c].data,h='<table cellspacing="0" cellpadding="0"><tr>';h+='<td style="vertical-align:top;">';g.ncols=1;for(b=0;b<g.options.length;b++){d=g.options[b];if(d.a){if(d.a.newcol){h+='</td><td style="vertical-align:top;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align:top;">';g.ncols+=1;continue}if(d.a.skip){h+='<div style="font-size:x-small;white-space:nowrap;">'+d.o+"</div>";continue}}e=d.v==g.value&&(!d.a||
!d.a.custom&&!d.a.cancel)?"background-color:#DDF;":"";h+='<div style="font-size:x-small;white-space:nowrap;'+e+'" onclick="SocialCalc.Popup.Types.List.ItemClicked(\''+c+"','"+b+"');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove('"+c+"',this);\">"+d.o+"</div>"}h+="</td></tr></table>";return h};
SocialCalc.Popup.Types.List.MakeCustom=function(a,c){var b=SocialCalc.Popup.LocalizeString,d="",d=SocialCalc.Popup.Controls[c].data.value,d=SocialCalc.special_chars(d);return d='<div style="white-space:nowrap;"><br><input id="customvalue" value="'+d+'"><br><br><input style="font-size:smaller;" type="button" value="'+b("OK")+'" onclick="SocialCalc.Popup.Types.List.CustomOK(\''+c+'\');return false;"><input style="font-size:smaller;" type="button" value="'+b("List")+'" onclick="SocialCalc.Popup.Types.List.CustomToList(\''+
c+'\');"><input style="font-size:smaller;" type="button" value="'+b("Cancel")+'" onclick="SocialCalc.Popup.Close();"><br></div>'};
SocialCalc.Popup.Types.List.ItemClicked=function(a,c){var b,d,e,g=SocialCalc.Popup.Controls[a].data;(b=g.options[c].a)&&b.custom?(b=g.contentele,d=SocialCalc.Popup.Types.List.MakeCustom("List",a),e=document.createElement("div"),e.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+d+"</div>",g.customele=e.firstChild.firstChild.childNodes[1],g.listdiv=null,g.contentele=e,g.popupele.replaceChild(e,b),g.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,g.attribs.ensureWithin)):
((!b||!b.cancel)&&SocialCalc.Popup.SetValue(a,g.options[c].v),SocialCalc.Popup.Close())};SocialCalc.Popup.Types.List.CustomToList=function(a){var c,b,d,e=SocialCalc.Popup.Controls[a].data;c=e.contentele;b=SocialCalc.Popup.Types.List.MakeList("List",a);d=document.createElement("div");d.innerHTML='<div style="cursor:default;padding:4px;">'+b+"</div>";e.customele=null;e.listdiv=d.firstChild;e.contentele=d;e.popupele.replaceChild(d,c);e.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,e.attribs.ensureWithin)};
SocialCalc.Popup.Types.List.CustomOK=function(a){SocialCalc.Popup.SetValue(a,SocialCalc.Popup.Controls[a].data.customele.value);SocialCalc.Popup.Close()};SocialCalc.Popup.Types.List.MouseMove=function(a,c){var b,d,e=SocialCalc.Popup.Controls[a].data;if(b=e.listdiv){var g=b.firstChild.firstChild.firstChild;for(b=0;b<e.ncols;b++)for(d=0;d<g.childNodes[b*2].childNodes.length;d++)g.childNodes[b*2].childNodes[d].style.backgroundColor="#FFF";c.style.backgroundColor="#DDF"}};
SocialCalc.Popup.Types.List.Hide=function(a,c){var b=SocialCalc.Popup,d=b.Controls[c].data;b.DestroyPopupDiv(d.popupele,d.dragregistered);d.popupele=null;if(d.mainele&&d.mainele.firstChild)d.mainele.firstChild.disabled=!1};SocialCalc.Popup.Types.List.Cancel=function(a,c){SocialCalc.Popup.Types.List.Hide(a,c)};SocialCalc.Popup.Types.ColorChooser={};
SocialCalc.Popup.Types.ColorChooser.Create=function(a,c,b){var d=SocialCalc.Popup.Controls,a={type:a,value:"",display:"",data:{}};d[c]?alert("Already created "+c):(d[c]=a,d=a.data,d.attribs=b||{},b=d.attribs,d.value="",(a=document.getElementById(c))?(d.mainele=a,a.innerHTML='<div style="cursor:pointer;border:1px solid black;vertical-align:top;width:'+(b.sampleWidth||"15px")+";height:"+(b.sampleHeight||"15px")+';" onclick="SocialCalc.Popup.Types.ColorChooser.ControlClicked(\''+c+"');\">&nbsp;</div>"):
alert("Missing element "+c))};
SocialCalc.Popup.Types.ColorChooser.SetValue=function(a,c,b){var a=SocialCalc.Popup,c=a.Controls[c].data,d=c.attribs;c.value=b;c.custom=!1;if(c.mainele&&c.mainele.firstChild)c.value?(c.mainele.firstChild.style.backgroundColor=c.value,b=d.backgroundImage?"url("+a.imagePrefix+d.backgroundImage+")":"",a="center center"):(c.mainele.firstChild.style.backgroundColor="#FFF",d.backgroundImageDefault?(b="url("+a.imagePrefix+d.backgroundImageDefault+")",a="center center"):(b="url("+a.imagePrefix+"defaultcolor.gif)",
a="left top")),c.mainele.firstChild.style.backgroundPosition=a,c.mainele.firstChild.style.backgroundImage=b};
SocialCalc.Popup.Types.ColorChooser.SetDisabled=function(a,c,b){var a=SocialCalc.Popup,d=a.Controls[c].data,e=d.attribs;d.disabled=b;if(d.mainele&&d.mainele.firstChild)b?(d.mainele.firstChild.style.backgroundColor="#DDD",e.backgroundImageDisabled?(img="url("+a.imagePrefix+e.backgroundImageDisabled+")",pos="center center"):(img="url("+a.imagePrefix+"defaultcolor.gif)",pos="left top"),d.mainele.firstChild.style.backgroundPosition=pos,d.mainele.firstChild.style.backgroundImage=img):a.SetValue(c,d.value)};
SocialCalc.Popup.Types.ColorChooser.GetValue=function(a,c){return SocialCalc.Popup.Controls[c].data.value};SocialCalc.Popup.Types.ColorChooser.Initialize=function(a,c,b){var d,a=SocialCalc.Popup,e=a.Controls[c].data;for(d in b.attribs)e.attribs[d]=b.attribs[d];b.value&&a.SetValue(c,b.value)};SocialCalc.Popup.Types.ColorChooser.Reset=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;if(c.Current.id&&d[c.Current.id].type==a)b[a].Hide(a,c.Current.id),c.Current.id=null};
SocialCalc.Popup.Types.ColorChooser.Show=function(a,c){var b,d;b=SocialCalc.Popup;var e=b.Controls[c].data;d="";e.oldvalue=e.value;e.popupele=b.CreatePopupDiv(c,e.attribs);e.custom?(d=SocialCalc.Popup.Types.ColorChooser.MakeCustom(a,c),b=document.createElement("div"),b.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+d+"</div>",e.customele=b.firstChild.firstChild.childNodes[2]):(d=SocialCalc.Popup.Types.ColorChooser.CreateGrid(a,c),b=document.createElement("div"),b.style.padding=
"3px",b.style.backgroundColor="#CCC",b.appendChild(d),e.customele=null);e.contentele=b;e.popupele.appendChild(b);e.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,e.attribs.ensureWithin)};
SocialCalc.Popup.Types.ColorChooser.MakeCustom=function(a,c){var b=SocialCalc.Popup,d=b.LocalizeString,e="";return e='<div style="white-space:nowrap;"><br>#<input id="customvalue" style="width:75px;" value="'+b.Controls[c].data.value+'"><br><br><input style="font-size:smaller;" type="button" value="'+d("OK")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomOK(\''+c+'\');return false;"><input style="font-size:smaller;" type="button" value="'+d("Grid")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\''+
c+"');\"><br></div>"};SocialCalc.Popup.Types.ColorChooser.ItemClicked=function(){SocialCalc.Popup.Close()};SocialCalc.Popup.Types.ColorChooser.CustomToList=function(){};SocialCalc.Popup.Types.ColorChooser.CustomOK=function(a){var c=SocialCalc.Popup;c.SetValue(a,c.Controls[a].data.customele.value);c.Close()};SocialCalc.Popup.Types.ColorChooser.Hide=function(a,c){var b=SocialCalc.Popup,d=b.Controls[c].data;b.DestroyPopupDiv(d.popupele,d.dragregistered);d.popupele=null};
SocialCalc.Popup.Types.ColorChooser.Cancel=function(a,c){var b=SocialCalc.Popup;b.SetValue(c,b.Controls[c].data.oldvalue);SocialCalc.Popup.Types.ColorChooser.Hide(a,c)};
SocialCalc.Popup.Types.ColorChooser.CreateGrid=function(a,c){var b,d,e,g,h,j=SocialCalc.Popup,k=j.Types,m=j.LocalizeString;b=j.Controls[c].data;b.grid={};var n=b.grid,s=document.createElement("div");b=document.createElement("table");b.cellSpacing=0;b.cellPadding=0;b.style.width="100px";n.table=b;b=document.createElement("tbody");n.table.appendChild(b);n.tbody=b;for(d=0;d<16;d++){e=document.createElement("tr");for(g=0;g<5;g++)h={},n[d+","+g]=h,b=document.createElement("td"),b.style.fontSize="1px",
b.innerHTML="&nbsp;",b.style.height="10px",g<=1?(b.style.width="17px",b.style.borderRight="3px solid white"):(b.style.width="20px",b.style.backgroundRepeat="no-repeat"),e.appendChild(b),h.ele=b;n.tbody.appendChild(e)}s.appendChild(n.table);b=document.createElement("div");b.style.marginTop="3px";b.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td style="width:17px;background-color:#FFF;background-image:url('+j.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;" title="'+
m("Default")+'">&nbsp;</td><td style="width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;" title="'+m("Custom")+'">#</td><td style="width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;">'+m("OK")+"</td></tr></table>";n.defaultbox=b.firstChild.firstChild.firstChild.childNodes[0];n.defaultbox.onclick=k.ColorChooser.DefaultClicked;n.custom=b.firstChild.firstChild.firstChild.childNodes[1];n.custom.onclick=k.ColorChooser.CustomClicked;n.msg=b.firstChild.firstChild.firstChild.childNodes[2];
n.msg.onclick=k.ColorChooser.CloseOK;s.appendChild(b);n.table.onmousedown=k.ColorChooser.GridMouseDown;k.ColorChooser.DetermineColors(c);k.ColorChooser.SetColors(c);return s};SocialCalc.Popup.Types.ColorChooser.gridToG=function(a,c,b){return a[c+","+b]};
SocialCalc.Popup.Types.ColorChooser.DetermineColors=function(a){var c=SocialCalc.Popup,b=c.Types.ColorChooser,d=c.Controls[a].data,a=d.grid,e,g=c.splitRGB(d.value),d=2;e=16-Math.floor((g.r+16)/16);a["selectedrow"+d]=e;for(e=0;e<16;e++)b.gridToG(a,e,d).rgb=c.makeRGB(17*(15-e),0,0);d=3;e=16-Math.floor((g.g+16)/16);a["selectedrow"+d]=e;for(e=0;e<16;e++)b.gridToG(a,e,d).rgb=c.makeRGB(0,17*(15-e),0);d=4;e=16-Math.floor((g.b+16)/16);a["selectedrow"+d]=e;for(e=0;e<16;e++)b.gridToG(a,e,d).rgb=c.makeRGB(0,
0,17*(15-e));d=1;for(e=0;e<16;e++)b.gridToG(a,e,d).rgb=c.makeRGB(17*(15-e),17*(15-e),17*(15-e));var d=0,c=[0,68,153,204,255],g=["400","310","420","440","442","340","040","042","032","044","024","004","204","314","402","414"],h;for(e=0;e<16;e++)h=g[e],b.gridToG(a,e,d).rgb="rgb("+c[h.charAt(0)-0]+","+c[h.charAt(1)-0]+","+c[h.charAt(2)-0]+")"};
SocialCalc.Popup.Types.ColorChooser.SetColors=function(a){var c,b,d,e=SocialCalc.Popup,g=e.Types.ColorChooser,h=e.Controls[a].data,j=h.grid;for(c=0;c<16;c++)for(b=0;b<5;b++)d=g.gridToG(j,c,b),d.ele.style.backgroundColor=d.rgb,d.ele.title=e.RGBToHex(d.rgb),d.ele.style.backgroundImage=j["selectedrow"+b]==c?"url("+e.imagePrefix+"chooserarrow.gif)":"";e.SetValue(a,h.value);j.msg.style.backgroundColor=h.value;a=e.splitRGB(h.value||"rgb(255,255,255)");j.msg.style.color=a.r+a.g+a.b<220?"#FFF":"#000";h.value?
(j.msg.style.backgroundImage="",j.msg.title=e.RGBToHex(h.value)):(j.msg.style.backgroundColor="#FFF",j.msg.style.backgroundImage="url("+e.imagePrefix+"defaultcolor.gif)",j.msg.title="Default")};
SocialCalc.Popup.Types.ColorChooser.GridMouseDown=function(a){var c=a||window.event,a=SocialCalc.Popup,b=a.Types.ColorChooser,d=a.Current.id;if(d){var e=a.Controls[d].data,g=e.grid;switch(c.type){case "mousedown":g.mousedown=!0;break;case "mouseup":g.mousedown=!1;break;case "mousemove":if(!g.mousedown)return}var h=SocialCalc.GetViewportInfo(),j=c.clientX+h.horizontalScroll,h=c.clientY+h.verticalScroll,c=SocialCalc.GetElementPosition(g.table),h=Math.floor((h-c.top-2)/10),h=h<0?0:h,j=Math.floor((j-
c.left)/20),j=j<0?0:j>4?4:j,g=b.gridToG(g,h<0?0:h>15?15:h,j).ele.style.backgroundColor,c=a.splitRGB(g),h=a.splitRGB(e.value);switch(j){case 2:e.value=a.makeRGB(c.r,h.g,h.b);break;case 3:e.value=a.makeRGB(h.r,c.g,h.b);break;case 4:e.value=a.makeRGB(h.r,h.g,c.b);break;case 0:case 1:e.value=g}b.DetermineColors(d);b.SetColors(d)}};SocialCalc.Popup.Types.ColorChooser.ControlClicked=function(a){var c=SocialCalc.Popup,b=c.Types.ColorChooser,d=c.Current.id;!d||a!=d?c.CClick(a):b.CloseOK()};
SocialCalc.Popup.Types.ColorChooser.DefaultClicked=function(){var a=SocialCalc.Popup,c=a.Current.id;if(c)a=a.Controls[c].data,a.value="",SocialCalc.Popup.SetValue(c,a.value),SocialCalc.Popup.Close()};
SocialCalc.Popup.Types.ColorChooser.CustomClicked=function(){var a=SocialCalc.Popup,c=a.Current.id;if(c){var b=a.Controls[c].data,d,e,g;d=b.contentele;e=SocialCalc.Popup.Types.ColorChooser.MakeCustom("ColorChooser",c);g=document.createElement("div");g.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+e+"</div>";b.customele=g.firstChild.firstChild.childNodes[2];b.contentele=g;b.popupele.replaceChild(g,d);b.customele.value=a.RGBToHex(b.value);b.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,
b.attribs.ensureWithin)}};
SocialCalc.Popup.Types.ColorChooser.CustomToGrid=function(a){var c,b;c=SocialCalc.Popup;var d=c.Controls[a].data;SocialCalc.Popup.SetValue(a,c.HexToRGB("#"+d.customele.value));var e;c=d.contentele;e=SocialCalc.Popup.Types.ColorChooser.CreateGrid("ColorChooser",a);b=document.createElement("div");b.style.padding="3px";b.style.backgroundColor="#CCC";b.appendChild(e);d.customele=null;d.contentele=b;d.popupele.replaceChild(b,c);d.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,d.attribs.ensureWithin)};
SocialCalc.Popup.Types.ColorChooser.CustomOK=function(a){var c=SocialCalc.Popup;SocialCalc.Popup.SetValue(a,c.HexToRGB("#"+c.Controls[a].data.customele.value));SocialCalc.Popup.Close()};SocialCalc.Popup.Types.ColorChooser.CloseOK=function(){var a=SocialCalc.Popup,c=a.Current.id;c&&(SocialCalc.Popup.SetValue(c,a.Controls[c].data.value),SocialCalc.Popup.Close())};SocialCalc||(alert("Main SocialCalc code module needed"),SocialCalc={});SocialCalc.TableEditor||alert("SocialCalc TableEditor code module needed");SocialCalc.CurrentSpreadsheetControlObject=null;
SocialCalc.SpreadsheetControl=function(){var a=SocialCalc.Constants;this.spreadsheetDiv=this.parentNode=null;this.viewheight=this.width=this.height=this.requestedSpaceBelow=this.requestedWidth=this.requestedHeight=0;this.tabs=[];this.tabnums={};this.tabreplacements={};this.currentTab=-1;this.views={};this.editorDiv=this.spreadsheetDiv=this.editor=this.context=this.sheet=null;this.moverange=this.sortrange="";this.idPrefix="SocialCalc-";this.multipartBoundary="SocialCalcSpreadsheetControlSave";this.imagePrefix=
a.defaultImagePrefix;this.toolbarbackground=a.SCToolbarbackground;this.tabbackground=a.SCTabbackground;this.tabselectedCSS=a.SCTabselectedCSS;this.tabplainCSS=a.SCTabplainCSS;this.toolbartext=a.SCToolbartext;this.formulabarheight=a.SCFormulabarheight;this.statuslineheight=a.SCStatuslineheight;this.statuslineCSS=a.SCStatuslineCSS;this.ExportCallback=null;this.sheet=new SocialCalc.Sheet;this.context=new SocialCalc.RenderContext(this.sheet);this.context.showGrid=!0;this.context.showRCHeaders=!0;this.editor=
new SocialCalc.TableEditor(this.context);this.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+"statusline",recalcid1:this.idPrefix+"divider_recalc",recalcid2:this.idPrefix+"button_recalc"}};SocialCalc.CurrentSpreadsheetControlObject=this;this.editor.MoveECellCallback.movefrom=function(a){var b=SocialCalc.GetSpreadsheetControlObject();b.context.cursorsuffix="";if(a.range2.hasrange&&!a.cellhandles.noCursorSuffix){if(a.ecell.row==
a.range2.top&&(a.ecell.col<a.range2.left||a.ecell.col>a.range2.right+1))b.context.cursorsuffix="insertleft";if(a.ecell.col==a.range2.left&&(a.ecell.row<a.range2.top||a.ecell.row>a.range2.bottom+1))b.context.cursorsuffix="insertup"}};this.formulabuttons={formulafunctions:{image:"formuladialog.gif",tooltip:"Functions",command:SocialCalc.SpreadsheetControl.DoFunctionList},multilineinput:{image:"multilinedialog.gif",tooltip:"Multi-line Input Box",command:SocialCalc.SpreadsheetControl.DoMultiline},link:{image:"linkdialog.gif",
tooltip:"Link Input Box",command:SocialCalc.SpreadsheetControl.DoLink},sum:{image:"sumdialog.gif",tooltip:"Auto Sum",command:SocialCalc.SpreadsheetControl.DoSum}};this.tabnums.edit=this.tabs.length;this.tabs.push({name:"edit",text:"Edit",html:' <div id="%id.edittools" style="padding:10px 0px 0px 0px;">&nbsp;<img id="%id.button_undo" src="%img.undo.gif" style="vertical-align:bottom;"> <img id="%id.button_redo" src="%img.redo.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_copy" src="%img.copy.gif" style="vertical-align:bottom;"> <img id="%id.button_cut" src="%img.cut.gif" style="vertical-align:bottom;"> <img id="%id.button_paste" src="%img.paste.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_delete" src="%img.delete.gif" style="vertical-align:bottom;"> <img id="%id.button_pasteformats" src="%img.pasteformats.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_filldown" src="%img.filldown.gif" style="vertical-align:bottom;"> <img id="%id.button_fillright" src="%img.fillright.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_movefrom" src="%img.movefromoff.gif" style="vertical-align:bottom;"> <img id="%id.button_movepaste" src="%img.movepasteoff.gif" style="vertical-align:bottom;"> <img id="%id.button_moveinsert" src="%img.moveinsertoff.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_alignleft" src="%img.alignleft.gif" style="vertical-align:bottom;"> <img id="%id.button_aligncenter" src="%img.aligncenter.gif" style="vertical-align:bottom;"> <img id="%id.button_alignright" src="%img.alignright.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_borderon" src="%img.borderson.gif" style="vertical-align:bottom;">  <img id="%id.button_borderoff" src="%img.bordersoff.gif" style="vertical-align:bottom;">  <img id="%id.button_swapcolors" src="%img.swapcolors.gif" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_merge" src="%img.merge.gif" style="vertical-align:bottom;">  <img id="%id.button_unmerge" src="%img.unmerge.gif" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_insertrow" src="%img.insertrow.gif" style="vertical-align:bottom;">  <img id="%id.button_insertcol" src="%img.insertcol.gif" style="vertical-align:bottom;"> &nbsp; <img id="%id.button_deleterow" src="%img.deleterow.gif" style="vertical-align:bottom;">  <img id="%id.button_deletecol" src="%img.deletecol.gif" style="vertical-align:bottom;">  &nbsp;<img id="%id.divider_recalc" src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_recalc" src="%img.recalc.gif" style="vertical-align:bottom;">  </div>',
oncreate:null,onclick:null});this.tabnums.settings=this.tabs.length;this.tabs.push({name:"settings",text:"Format",html:'<div id="%id.settingstools" style="display:none;"> <div id="%id.sheetsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id="%id.settings-savesheet" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'sheet\');">   <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">   <input type="button" value="%loc!Show Cell Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'cell\');return false;">   </td></tr></table> </div> <div id="%id.cellsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!CELL SETTINGS!: <span id="%id.settingsecell">&nbsp;</span></div>   </td></tr><tr><td>  <input id="%id.settings-savecell" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'cell\');">  <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">  <input type="button" value="%loc!Show Sheet Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'sheet\');return false;">  </td></tr></table> </div></div>',
view:"settings",onclick:function(a){SocialCalc.SettingsControls.idPrefix=a.idPrefix;SocialCalc.SettingControlReset();var b=a.sheet.EncodeSheetAttributes(),d=a.sheet.EncodeCellAttributes(a.editor.ecell.coord);SocialCalc.SettingsControlLoadPanel(a.views.settings.values.sheetspanel,b);SocialCalc.SettingsControlLoadPanel(a.views.settings.values.cellspanel,d);document.getElementById(a.idPrefix+"settingsecell").innerHTML=a.editor.ecell.coord;SocialCalc.SpreadsheetControlSettingsSwitch("cell");a.views.settings.element.style.height=
a.viewheight+"px";a.views.settings.element.firstChild.style.height=a.viewheight+"px";b=a.editor.range.hasrange?SocialCalc.crToCoord(a.editor.range.left,a.editor.range.top)+":"+SocialCalc.crToCoord(a.editor.range.right,a.editor.range.bottom):a.editor.ecell.coord;document.getElementById(a.idPrefix+"settings-savecell").value=SocialCalc.LocalizeString("Save to")+": "+b},onclickFocus:!0});this.views.settings={name:"settings",values:{},oncreate:function(a,b){var d=SocialCalc.Constants;b.values.sheetspanel=
{colorchooser:{id:a.idPrefix+"scolorchooser"},formatnumber:{setting:"numberformat",type:"PopupList",id:a.idPrefix+"formatnumber",initialdata:d.SCFormatNumberFormats},formattext:{setting:"textformat",type:"PopupList",id:a.idPrefix+"formattext",initialdata:d.SCFormatTextFormats},fontfamily:{setting:"fontfamily",type:"PopupList",id:a.idPrefix+"fontfamily",initialdata:d.SCFormatFontfamilies},fontlook:{setting:"fontlook",type:"PopupList",id:a.idPrefix+"fontlook",initialdata:d.SCFormatFontlook},fontsize:{setting:"fontsize",
type:"PopupList",id:a.idPrefix+"fontsize",initialdata:d.SCFormatFontsizes},textalignhoriz:{setting:"textalignhoriz",type:"PopupList",id:a.idPrefix+"textalignhoriz",initialdata:d.SCFormatTextAlignhoriz},numberalignhoriz:{setting:"numberalignhoriz",type:"PopupList",id:a.idPrefix+"numberalignhoriz",initialdata:d.SCFormatNumberAlignhoriz},alignvert:{setting:"alignvert",type:"PopupList",id:a.idPrefix+"alignvert",initialdata:d.SCFormatAlignVertical},textcolor:{setting:"textcolor",type:"ColorChooser",id:a.idPrefix+
"textcolor"},bgcolor:{setting:"bgcolor",type:"ColorChooser",id:a.idPrefix+"bgcolor"},padtop:{setting:"padtop",type:"PopupList",id:a.idPrefix+"padtop",initialdata:d.SCFormatPadsizes},padright:{setting:"padright",type:"PopupList",id:a.idPrefix+"padright",initialdata:d.SCFormatPadsizes},padbottom:{setting:"padbottom",type:"PopupList",id:a.idPrefix+"padbottom",initialdata:d.SCFormatPadsizes},padleft:{setting:"padleft",type:"PopupList",id:a.idPrefix+"padleft",initialdata:d.SCFormatPadsizes},colwidth:{setting:"colwidth",
type:"PopupList",id:a.idPrefix+"colwidth",initialdata:d.SCFormatColwidth},recalc:{setting:"recalc",type:"PopupList",id:a.idPrefix+"recalc",initialdata:d.SCFormatRecalc}};b.values.cellspanel={name:"cell",colorchooser:{id:a.idPrefix+"scolorchooser"},cformatnumber:{setting:"numberformat",type:"PopupList",id:a.idPrefix+"cformatnumber",initialdata:d.SCFormatNumberFormats},cformattext:{setting:"textformat",type:"PopupList",id:a.idPrefix+"cformattext",initialdata:d.SCFormatTextFormats},cfontfamily:{setting:"fontfamily",
type:"PopupList",id:a.idPrefix+"cfontfamily",initialdata:d.SCFormatFontfamilies},cfontlook:{setting:"fontlook",type:"PopupList",id:a.idPrefix+"cfontlook",initialdata:d.SCFormatFontlook},cfontsize:{setting:"fontsize",type:"PopupList",id:a.idPrefix+"cfontsize",initialdata:d.SCFormatFontsizes},calignhoriz:{setting:"alignhoriz",type:"PopupList",id:a.idPrefix+"calignhoriz",initialdata:d.SCFormatTextAlignhoriz},calignvert:{setting:"alignvert",type:"PopupList",id:a.idPrefix+"calignvert",initialdata:d.SCFormatAlignVertical},
ctextcolor:{setting:"textcolor",type:"ColorChooser",id:a.idPrefix+"ctextcolor"},cbgcolor:{setting:"bgcolor",type:"ColorChooser",id:a.idPrefix+"cbgcolor"},cbt:{setting:"bt",type:"BorderSide",id:a.idPrefix+"cbt"},cbr:{setting:"br",type:"BorderSide",id:a.idPrefix+"cbr"},cbb:{setting:"bb",type:"BorderSide",id:a.idPrefix+"cbb"},cbl:{setting:"bl",type:"BorderSide",id:a.idPrefix+"cbl"},cpadtop:{setting:"padtop",type:"PopupList",id:a.idPrefix+"cpadtop",initialdata:d.SCFormatPadsizes},cpadright:{setting:"padright",
type:"PopupList",id:a.idPrefix+"cpadright",initialdata:d.SCFormatPadsizes},cpadbottom:{setting:"padbottom",type:"PopupList",id:a.idPrefix+"cpadbottom",initialdata:d.SCFormatPadsizes},cpadleft:{setting:"padleft",type:"PopupList",id:a.idPrefix+"cpadleft",initialdata:d.SCFormatPadsizes}};SocialCalc.SettingsControlInitializePanel(b.values.sheetspanel);SocialCalc.SettingsControlInitializePanel(b.values.cellspanel)},replacements:{itemtitle:{regex:/\%itemtitle\./g,replacement:'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},
sectiontitle:{regex:/\%sectiontitle\./g,replacement:'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},parttitle:{regex:/\%parttitle\./g,replacement:'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},itembody:{regex:/\%itembody\./g,replacement:'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},bodypart:{regex:/\%bodypart\./g,replacement:'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}},
divStyle:"border:1px solid black;overflow:auto;",html:'<div id="%id.scolorchooser" style="display:none;position:absolute;z-index:20;"></div><table cellspacing="0" cellpadding="0"> <tr><td style="vertical-align:top;"><table id="%id.sheetsettingstable" style="display:none;" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.formatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.formattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id="%id.textalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id="%id.numberalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.alignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.fontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.fontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.fontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.textcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.bgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.padtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.padright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.padbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.padleft"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.colwidth"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.recalc"></span>    </td>   </tr></table> </td></tr></table><table id="%id.cellsettingstable" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.cformatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.cformattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id="%id.calignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.calignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.cfontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.cfontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.cfontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.ctextcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.cbgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0">    <tr><td %bodypart. colspan="3"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id="%id.cbt-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbt-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbr-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbr-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbb-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbb-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbl-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbl-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.cpadtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.cpadright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.cpadbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.cpadleft"></span>    </td>   </tr></table> </td></tr></table> </td><td style="vertical-align:top;padding:12px 0px 0px 12px;">  <div style="width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;">   <table cellspacing="0" cellpadding="0"><tr>    <td id="sample-text" style="height:100px;width:100px;"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'};
this.tabnums.sort=this.tabs.length;this.tabs.push({name:"sort",text:"Sort",html:' <div id="%id.sorttools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:4px;width:160px;">    <div style="%tbt.">%loc!Set Cells To Sort!</div>    <select id="%id.sortlist" size="1" onfocus="%s.CmdGotFocus(this);"><option selected>[select range]</option></select>    <input type="button" value="%loc!OK!" onclick="%s.DoCmd(this, \'ok-setsort\');" style="font-size:x-small;">   </td>   <td style="vertical-align:middle;padding-right:16px;width:100px;text-align:right;">    <div style="%tbt.">&nbsp;</div>    <input type="button" id="%id.sortbutton" value="%loc!Sort Cells! A1:A1" onclick="%s.DoCmd(this, \'dosort\');" style="visibility:hidden;">   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Major Sort!</div>      <select id="%id.majorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="majorsort" id="%id.majorsortup" value="up" checked><span style="font-size:x-small;color:#FFF;">%loc!Up!</span><br>      <input type="radio" name="majorsort" id="%id.majorsortdown" value="down"><span style="font-size:x-small;color:#FFF;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Minor Sort!</div>      <select id="%id.minorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="minorsort" id="%id.minorsortup" value="up" checked><span style="font-size:x-small;color:#FFF;">%loc!Up!</span><br>      <input type="radio" name="minorsort" id="%id.minorsortdown" value="down"><span style="font-size:x-small;color:#FFF;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Last Sort!</div>      <select id="%id.lastsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="lastsort" id="%id.lastsortup" value="up" checked><span style="font-size:x-small;color:#FFF;">%loc!Up!</span><br>      <input type="radio" name="lastsort" id="%id.lastsortdown" value="down"><span style="font-size:x-small;color:#FFF;">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',
onclick:SocialCalc.SpreadsheetControlSortOnclick});this.editor.SettingsCallbacks.sort={save:SocialCalc.SpreadsheetControlSortSave,load:SocialCalc.SpreadsheetControlSortLoad};this.tabnums.audit=this.tabs.length;this.tabs.push({name:"audit",text:"Audit",html:'<div id="%id.audittools" style="display:none;"> <div style="%tbt.">&nbsp;</div></div>',view:"audit",onclick:function(a){var b=SocialCalc.LocalizeString,d,e,g='<table cellspacing="0" cellpadding="0" style="margin-bottom:10px;"><tr><td style="font-size:small;padding:6px;"><b>'+
b("Audit Trail This Session")+":</b><br><br>",h=a.sheet.changes.stack,j=a.sheet.changes.tos;for(d=0;d<h.length;d++){d==j+1&&(g+='<br></td></tr><tr><td style="font-size:small;background-color:#EEE;padding:6px;">'+b("UNDONE STEPS")+":<br>");for(e=0;e<h[d].command.length;e++)g+=SocialCalc.special_chars(h[d].command[e])+"<br>"}a.views.audit.element.innerHTML=g+"</td></tr></table>";SocialCalc.CmdGotFocus(!0)},onclickFocus:!0});this.views.audit={name:"audit",divStyle:"border:1px solid black;overflow:auto;",
html:"Audit Trail"};this.tabnums.comment=this.tabs.length;this.tabs.push({name:"comment",text:"Comment",html:'<div id="%id.commenttools" style="display:none;"><table cellspacing="0" cellpadding="0"><tr><td><textarea id="%id.commenttext" style="font-size:small;height:32px;width:600px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea></td><td style="vertical-align:top;">&nbsp;<input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlCommentSet();" style="font-size:x-small;"></td></tr></table></div>',
view:"sheet",onclick:SocialCalc.SpreadsheetControlCommentOnclick,onunclick:SocialCalc.SpreadsheetControlCommentOnunclick});this.tabnums.names=this.tabs.length;this.tabs.push({name:"names",text:"Names",html:'<div id="%id.namestools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">%loc!Existing Names!</div>    <select id="%id.nameslist" size="1" onchange="%s.SpreadsheetControlNamesChangedName();" onfocus="%s.CmdGotFocus(this);"><option selected>[New]</option></select>   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Name!</div>    <input type="text" id="%id.namesname" style="font-size:x-small;width:75px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Description!</div>    <input type="text" id="%id.namesdesc" style="font-size:x-small;width:150px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Value!</div>    <input type="text" id="%id.namesvalue" width="16" style="font-size:x-small;width:100px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:12px;width:100px;">    <div style="%tbt.">%loc!Set Value To!</div>    <input type="button" id="%id.namesrangeproposal" value="A1" onclick="%s.SpreadsheetControlNamesSetValue();" style="font-size:x-small;">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">&nbsp;</div>    <input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlNamesSave();" style="font-size:x-small;">    <input type="button" value="%loc!Delete!" onclick="%s.SpreadsheetControlNamesDelete()" style="font-size:x-small;">   </td>  </tr></table></div>',
view:"sheet",onclick:SocialCalc.SpreadsheetControlNamesOnclick,onunclick:SocialCalc.SpreadsheetControlNamesOnunclick});this.tabnums.clipboard=this.tabs.length;this.tabs.push({name:"clipboard",text:"Clipboard",html:'<div id="%id.clipboardtools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">     &nbsp;    </div>   </td>  </tr></table></div>',view:"clipboard",onclick:SocialCalc.SpreadsheetControlClipboardOnclick,
onclickFocus:"clipboardtext"});this.views.clipboard={name:"clipboard",divStyle:"overflow:auto;",html:' <div style="font-size:x-small;padding:5px 0px 10px 0px;">  <b>%loc!Display Clipboard in!:</b>  <input type="radio" id="%id.clipboardformat-tab" name="%id.clipboardformat" checked onclick="%s.SpreadsheetControlClipboardFormat(\'tab\');"> %loc!Tab-delimited format! &nbsp;  <input type="radio" id="%id.clipboardformat-csv" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'csv\');"> %loc!CSV format! &nbsp;  <input type="radio" id="%id.clipboardformat-scsave" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'scsave\');"> %loc!SocialCalc-save format! </div> <input type="button" value="%loc!Load SocialCalc Clipboard With This!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardLoad();">&nbsp;  <input type="button" value="%loc!Clear SocialCalc Clipboard!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardClear();">&nbsp;  <br> <textarea id="%id.clipboardtext" style="font-size:small;height:350px;width:800px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea>'}};
SocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(a,c,b,d){return SocialCalc.InitializeSpreadsheetControl(this,a,c,b,d)};SocialCalc.SpreadsheetControl.prototype.DoOnResize=function(){return SocialCalc.DoOnResize(this)};SocialCalc.SpreadsheetControl.prototype.SizeSSDiv=function(){return SocialCalc.SizeSSDiv(this)};SocialCalc.SpreadsheetControl.prototype.ExecuteCommand=function(a,c){return SocialCalc.SpreadsheetControlExecuteCommand(this,a,c)};
SocialCalc.SpreadsheetControl.prototype.CreateSheetHTML=function(){return SocialCalc.SpreadsheetControlCreateSheetHTML(this)};SocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(a){return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this,a)};SocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(a){return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this,a)};
SocialCalc.SpreadsheetControl.prototype.CreateCellHTML=function(a){return SocialCalc.SpreadsheetControlCreateCellHTML(this,a)};SocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave=function(a){return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this,a)};SocialCalc.SpreadsheetControl.prototype.ParseSheetSave=function(a){return this.sheet.ParseSheetSave(a)};SocialCalc.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()};
SocialCalc.InitializeSpreadsheetControl=function(a,c,b,d,e){var g=SocialCalc.Constants,h=SocialCalc.LocalizeString,j=SocialCalc.LocalizeSubstrings,k,m,n,s=a.tabs,q=a.views;a.requestedHeight=b;a.requestedWidth=d;a.requestedSpaceBelow=e;typeof c=="string"&&(c=document.getElementById(c));c==null&&alert("SocialCalc.SpreadsheetControl not given parent node.");a.parentNode=c;a.spreadsheetDiv=document.createElement("div");a.SizeSSDiv();for(b=c.firstChild;b!=null;b=c.firstChild)c.removeChild(b);b='<div><div style="'+
a.toolbarbackground+'padding:12px 10px 10px 4px;height:40px;">';for(d=0;d<s.length;d++)b+=s[d].html;b+='</div><div style="'+a.tabbackground+'padding-bottom:4px;margin:0px 0px 8px 0px;"><table cellpadding="0" cellspacing="0"><tr>';for(d=0;d<s.length;d++)b+='  <td id="%id.'+s[d].name+'tab" style="'+(d==0?a.tabselectedCSS:a.tabplainCSS)+'" onclick="%s.SetTab(this);">'+h(s[d].text)+"</td>";b+=" </tr></table></div></div>";a.currentTab=0;for(m in a.tabreplacements)b=b.replace(a.tabreplacements[m].regex,
a.tabreplacements[m].replacement);b=b.replace(/\%s\./g,"SocialCalc.");b=b.replace(/\%id\./g,a.idPrefix);b=b.replace(/\%tbt\./g,a.toolbartext);b=b.replace(/\%img\./g,a.imagePrefix);b=j(b);a.spreadsheetDiv.innerHTML=b;c.appendChild(a.spreadsheetDiv);a.Buttons={button_undo:{tooltip:"Undo",command:"undo"},button_redo:{tooltip:"Redo",command:"redo"},button_copy:{tooltip:"Copy",command:"copy"},button_cut:{tooltip:"Cut",command:"cut"},button_paste:{tooltip:"Paste",command:"paste"},button_pasteformats:{tooltip:"Paste Formats",
command:"pasteformats"},button_delete:{tooltip:"Delete Contents",command:"delete"},button_filldown:{tooltip:"Fill Down",command:"filldown"},button_fillright:{tooltip:"Fill Right",command:"fillright"},button_movefrom:{tooltip:"Set/Clear Move From",command:"movefrom"},button_movepaste:{tooltip:"Move Paste",command:"movepaste"},button_moveinsert:{tooltip:"Move Insert",command:"moveinsert"},button_alignleft:{tooltip:"Align Left",command:"align-left"},button_aligncenter:{tooltip:"Align Center",command:"align-center"},
button_alignright:{tooltip:"Align Right",command:"align-right"},button_borderon:{tooltip:"Borders On",command:"borderon"},button_borderoff:{tooltip:"Borders Off",command:"borderoff"},button_swapcolors:{tooltip:"Swap Colors",command:"swapcolors"},button_merge:{tooltip:"Merge Cells",command:"merge"},button_unmerge:{tooltip:"Unmerge Cells",command:"unmerge"},button_insertrow:{tooltip:"Insert Row",command:"insertrow"},button_insertcol:{tooltip:"Insert Column",command:"insertcol"},button_deleterow:{tooltip:"Delete Row",
command:"deleterow"},button_deletecol:{tooltip:"Delete Column",command:"deletecol"},button_recalc:{tooltip:"Recalc",command:"recalc"}};for(n in a.Buttons)(c=document.getElementById(a.idPrefix+n))?(c.style.border="1px solid "+g.ISCButtonBorderNormal,SocialCalc.TooltipRegister(c,h(a.Buttons[n].tooltip),{}),SocialCalc.ButtonRegister(c,{normalstyle:"border:1px solid "+g.ISCButtonBorderNormal+";backgroundColor:"+g.ISCButtonBorderNormal+";",hoverstyle:"border:1px solid "+g.ISCButtonBorderHover+";backgroundColor:"+
g.ISCButtonBorderNormal+";",downstyle:"border:1px solid "+g.ISCButtonBorderDown+";backgroundColor:"+g.ISCButtonDownBackground+";"},{MouseDown:SocialCalc.DoButtonCmd,command:a.Buttons[n].command})):alert("Button "+(a.idPrefix+n)+" missing");a.formulabarDiv=document.createElement("div");a.formulabarDiv.style.height=a.formulabarheight+"px";a.formulabarDiv.innerHTML='<input type="text" size="60" value="">&nbsp;';a.spreadsheetDiv.appendChild(a.formulabarDiv);new SocialCalc.InputBox(a.formulabarDiv.firstChild,
a.editor);for(n in a.formulabuttons)c=document.createElement("img"),c.id=a.idPrefix+n,c.src=a.imagePrefix+a.formulabuttons[n].image,c.style.verticalAlign="middle",c.style.border="1px solid #FFF",c.style.marginLeft="4px",SocialCalc.TooltipRegister(c,h(a.formulabuttons[n].tooltip),{}),SocialCalc.ButtonRegister(c,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:a.formulabuttons[n].command}),
a.formulabarDiv.appendChild(c);for(d=0;d<s.length;d++)if(s[d].oncreate)s[d].oncreate(a,s[d].name);a.nonviewheight=a.statuslineheight+a.spreadsheetDiv.firstChild.offsetHeight+a.spreadsheetDiv.lastChild.offsetHeight;a.viewheight=a.height-a.nonviewheight;a.editorDiv=a.editor.CreateTableEditor(a.width,a.viewheight);a.spreadsheetDiv.appendChild(a.editorDiv);for(k in q){b=q[k].html;for(m in q[k].replacements)b=b.replace(q[k].replacements[m].regex,q[k].replacements[m].replacement);b=b.replace(/\%s\./g,"SocialCalc.");
b=b.replace(/\%id\./g,a.idPrefix);b=b.replace(/\%tbt\./g,a.toolbartext);b=b.replace(/\%img\./g,a.imagePrefix);g=document.createElement("div");SocialCalc.setStyles(g,q[k].divStyle);g.style.display="none";g.style.width=a.width+"px";g.style.height=a.viewheight+"px";b=j(b);g.innerHTML=b;a.spreadsheetDiv.appendChild(g);q[k].element=g;if(q[k].oncreate)q[k].oncreate(a,q[k])}q.sheet={name:"sheet",element:a.editorDiv};a.statuslineDiv=document.createElement("div");a.statuslineDiv.style.cssText=a.statuslineCSS;
a.statuslineDiv.style.height=a.statuslineheight-(a.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(a.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px";a.statuslineDiv.id=a.idPrefix+"statusline";a.spreadsheetDiv.appendChild(a.statuslineDiv)};SocialCalc.LocalizeString=function(a){var c=SocialCalc.LocalizeStringList[a];c||(c=SocialCalc.Constants["s_loc_"+a.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||a,SocialCalc.LocalizeStringList[a]=c);return c};SocialCalc.LocalizeStringList={};
SocialCalc.LocalizeSubstrings=function(a){var c=SocialCalc.LocalizeString;return a.replace(/%(loc|ssc)!(.*?)!/g,function(a,d,e){return d=="ssc"?SocialCalc.Constants[e]||alert("Missing constant: "+e):c(e)})};SocialCalc.GetSpreadsheetControlObject=function(){var a=SocialCalc.CurrentSpreadsheetControlObject;if(a)return a};
SocialCalc.DoOnResize=function(a){var c,b=a.views;if(a.SizeSSDiv()){for(vname in b)c=b[vname].element,c.style.width=a.width+"px",c.style.height=a.height-a.nonviewheight+"px";a.editor.ResizeTableEditor(a.width,a.height-a.nonviewheight)}};
SocialCalc.SizeSSDiv=function(a){var c,b,d,e;d=!1;c=SocialCalc.GetViewportInfo();b=SocialCalc.GetElementPosition(a.parentNode);b.bottom=0;b.right=0;e=a.parentNode.style;e.marginTop&&(b.top+=e.marginTop.slice(0,-2)-0);e.marginBottom&&(b.bottom+=e.marginBottom.slice(0,-2)-0);e.marginLeft&&(b.left+=e.marginLeft.slice(0,-2)-0);e.marginRight&&(b.right+=e.marginRight.slice(0,-2)-0);e=a.requestedHeight||c.height-(b.top+b.bottom+10)-(a.requestedSpaceBelow||0);if(a.height!=e)a.height=e,a.spreadsheetDiv.style.height=
e+"px",d=!0;e=a.requestedWidth||c.width-(b.left+b.right+10)||700;if(a.width!=e)a.width=e,a.spreadsheetDiv.style.width=e+"px",d=!0;return d};
SocialCalc.SetTab=function(a){var c,b,d,e,g,h={},j={},k=SocialCalc.GetSpreadsheetControlObject(),m=k.tabs,n=k.views,a=typeof a=="string"?a:a.id.slice(k.idPrefix.length,-3);if(k.editor.busy&&(!m[k.currentTab].view||m[k.currentTab].view=="sheet"))for(e=0;e<m.length;e++)if(m[e].name==a&&m[e].view&&m[e].view!="sheet")return;if(k.tabs[k.currentTab].onunclick)k.tabs[k.currentTab].onunclick(k,k.tabs[k.currentTab].name);for(e=0;e<m.length;e++)c=m[e].name,h[c]=document.getElementById(k.idPrefix+c+"tab"),j[c]=
document.getElementById(k.idPrefix+c+"tools"),c==a?(b=e,j[c].style.display="block",h[c].style.cssText=k.tabselectedCSS):(j[c].style.display="none",h[c].style.cssText=k.tabplainCSS);k.currentTab=b;if(m[b].onclick)m[b].onclick(k,a);for(g in n)!m[b].view&&g=="sheet"||m[b].view==g?(n[g].element.style.display="block",d=g):n[g].element.style.display="none";m[b].onclickFocus?(b=m[b].onclickFocus,typeof b=="string"&&(b=document.getElementById(k.idPrefix+b),b.focus()),SocialCalc.CmdGotFocus(b)):SocialCalc.KeyboardFocus();
if(n[d].needsresize&&n[d].onresize)n[d].needsresize=!1,n[d].onresize(k,n[d]);d=="sheet"?(k.statuslineDiv.style.display="block",k.editor.ScheduleRender()):k.statuslineDiv.style.display="none"};
SocialCalc.SpreadsheetControlStatuslineCallback=function(a,c,b,d){var e=document.getElementById(d.statuslineid);if(e)e.innerHTML=a.GetStatuslineString(c,b,d);switch(c){case "cmdendnorender":case "calcfinished":case "doneposcalc":c=document.getElementById(d.recalcid1);d=document.getElementById(d.recalcid2);if(!c||!d)break;a.context.sheetobj.attribs.needsrecalc=="yes"?(c.style.display="inline",d.style.display="inline"):(c.style.display="none",d.style.display="none")}};
SocialCalc.UpdateSortRangeProposal=function(a){document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+"sortlist").options[0].text=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):SocialCalc.LocalizeString("[select range]")};
SocialCalc.LoadColumnChoosers=function(a){var c=SocialCalc.LocalizeString,b,d,e,g;a.sortrange&&a.sortrange.indexOf(":")==-1?(b=SocialCalc.Formula.LookupName(a.sheet,a.sortrange||""),b.type=="range"?(b=b.value.match(/^(.*)\|(.*)\|$/),b=b[1]+":"+b[2]):b="A1:A1"):b=a.sortrange;var h=SocialCalc.ParseRange(b);e=document.getElementById(a.idPrefix+"majorsort");g=e.selectedIndex;e.options.length=0;e.options[e.options.length]=new Option(c("[None]"),"");for(b=h.cr1.col;b<=h.cr2.col;b++)d=SocialCalc.rcColname(b),
e.options[e.options.length]=new Option(c("Column ")+d,d);e.selectedIndex=g>1&&g<=h.cr2.col-h.cr1.col+1?g:1;e=document.getElementById(a.idPrefix+"minorsort");g=e.selectedIndex;e.options.length=0;e.options[e.options.length]=new Option(c("[None]"),"");for(b=h.cr1.col;b<=h.cr2.col;b++)d=SocialCalc.rcColname(b),e.options[e.options.length]=new Option(d,d);e.selectedIndex=g>0&&g<=h.cr2.col-h.cr1.col+1?g:0;e=document.getElementById(a.idPrefix+"lastsort");g=e.selectedIndex;e.options.length=0;e.options[e.options.length]=
new Option(c("[None]"),"");for(b=h.cr1.col;b<=h.cr2.col;b++)d=SocialCalc.rcColname(b),e.options[e.options.length]=new Option(d,d);e.selectedIndex=g>0&&g<=h.cr2.col-h.cr1.col+1?g:0};SocialCalc.CmdGotFocus=function(a){SocialCalc.Keyboard.passThru=a};SocialCalc.DoButtonCmd=function(a,c,b){SocialCalc.DoCmd(b.element,b.functionobj.command)};
SocialCalc.DoCmd=function(a,c){var b,d,e,g,h,j;g=SocialCalc.GetSpreadsheetControlObject();e=g.editor;switch(c){case "undo":g.ExecuteCommand("undo","");break;case "redo":g.ExecuteCommand("redo","");break;case "fill-rowcolstuff":case "fill-text":e=c.substring(5);d=document.getElementById(g.idPrefix+e+"list");for(b=d.length=0;b<SocialCalc.SpreadsheetCmdTable[e].length;b++)d.options[b]=new Option(SocialCalc.SpreadsheetCmdTable[e][b].t);c="changed-"+e;case "changed-rowcolstuff":case "changed-text":e=c.substring(8);
d=document.getElementById(g.idPrefix+e+"list");d=SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[e][d.selectedIndex].s];g=document.getElementById(g.idPrefix+e+"slist");for(b=g.length=0;b<(d.length||0);b++)g.options[b]=new Option(d[b].t,d[b].s);return;case "ok-rowcolstuff":case "ok-text":e=c.substring(3);d=document.getElementById(g.idPrefix+e+"list");g=document.getElementById(g.idPrefix+e+"slist");b=SocialCalc.SpreadsheetCmdTable[e][d.selectedIndex].c;d=g[g.selectedIndex].value;
SocialCalc.SpreadsheetControlExecuteCommand(a,b,d);break;case "ok-setsort":b=document.getElementById(g.idPrefix+"sortlist");g.sortrange=b.selectedIndex==0?e.range.hasrange?SocialCalc.crToCoord(e.range.left,e.range.top)+":"+SocialCalc.crToCoord(e.range.right,e.range.bottom):e.ecell.coord+":"+e.ecell.coord:b.options[b.selectedIndex].value;d=document.getElementById(g.idPrefix+"sortbutton");d.value=SocialCalc.LocalizeString("Sort ")+g.sortrange;d.style.visibility="visible";SocialCalc.LoadColumnChoosers(g);
a&&a.blur&&a.blur();SocialCalc.KeyboardFocus();return;case "dosort":if(g.sortrange&&g.sortrange.indexOf(":")==-1){e=SocialCalc.Formula.LookupName(g.sheet,g.sortrange||"");if(e.type!="range")return;e=e.value.match(/^(.*)\|(.*)\|$/);e=e[1]+":"+e[2]}else e=g.sortrange;if(e=="A1:A1")return;b="sort "+e+" ";e=document.getElementById(g.idPrefix+"majorsort");d=document.getElementById(g.idPrefix+"majorsortup");b+=e.options[e.selectedIndex].value+(d.checked?" up":" down");e=document.getElementById(g.idPrefix+
"minorsort");e.selectedIndex>0&&(d=document.getElementById(g.idPrefix+"minorsortup"),b+=" "+e.options[e.selectedIndex].value+(d.checked?" up":" down"));e=document.getElementById(g.idPrefix+"lastsort");e.selectedIndex>0&&(d=document.getElementById(g.idPrefix+"lastsortup"),b+=" "+e.options[e.selectedIndex].value+(d.checked?" up":" down"));g.ExecuteCommand(b,"");break;case "merge":b=SocialCalc.SpreadsheetCmdLookup[c]||"";d=SocialCalc.SpreadsheetCmdSLookup[c]||"";g.ExecuteCommand(b,d);e.range.hasrange&&
(e.MoveECell(SocialCalc.crToCoord(e.range.left,e.range.top)),e.RangeRemove());break;case "movefrom":e.range2.hasrange?(g.context.cursorsuffix="",e.Range2Remove(),g.ExecuteCommand("redisplay","")):e.range.hasrange?(e.range2.top=e.range.top,e.range2.right=e.range.right,e.range2.bottom=e.range.bottom,e.range2.left=e.range.left,e.range2.hasrange=!0,e.MoveECell(SocialCalc.crToCoord(e.range.left,e.range.top))):(e.range2.top=e.ecell.row,e.range2.right=e.ecell.col,e.range2.bottom=e.ecell.row,e.range2.left=
e.ecell.col,e.range2.hasrange=!0);b=e.range2.hasrange?"":"off";d=document.getElementById(g.idPrefix+"button_movefrom");d.src=g.imagePrefix+"movefrom"+b+".gif";d=document.getElementById(g.idPrefix+"button_movepaste");d.src=g.imagePrefix+"movepaste"+b+".gif";d=document.getElementById(g.idPrefix+"button_moveinsert");d.src=g.imagePrefix+"moveinsert"+b+".gif";e.range2.hasrange&&e.RangeRemove();break;case "movepaste":case "moveinsert":if(e.range2.hasrange)g.context.cursorsuffix="",b=c+" "+SocialCalc.crToCoord(e.range2.left,
e.range2.top)+":"+SocialCalc.crToCoord(e.range2.right,e.range2.bottom)+" "+e.ecell.coord,g.ExecuteCommand(b,""),e.Range2Remove(),d=document.getElementById(g.idPrefix+"button_movefrom"),d.src=g.imagePrefix+"movefromoff.gif",d=document.getElementById(g.idPrefix+"button_movepaste"),d.src=g.imagePrefix+"movepasteoff.gif",d=document.getElementById(g.idPrefix+"button_moveinsert"),d.src=g.imagePrefix+"moveinsertoff.gif";break;case "swapcolors":b=g.sheet;h=b.GetAssuredCell(e.ecell.coord);d=b.attribs.defaultcolor?
b.colors[b.attribs.defaultcolor]:"rgb(0,0,0)";j=b.attribs.defaultbgcolor?b.colors[b.attribs.defaultbgcolor]:"rgb(255,255,255)";e=h.color?b.colors[h.color]:d;e==j&&(e="");b=h.bgcolor?b.colors[h.bgcolor]:j;b==d&&(b="");g.ExecuteCommand("set %C color "+b+"%Nset %C bgcolor "+e,"");break;default:b=SocialCalc.SpreadsheetCmdLookup[c]||"",d=SocialCalc.SpreadsheetCmdSLookup[c]||"",g.ExecuteCommand(b,d)}a&&a.blur&&a.blur();SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetCmdLookup={copy:"copy %C all",cut:"cut %C all",paste:"paste %C all",pasteformats:"paste %C formats","delete":"erase %C formulas",filldown:"filldown %C all",fillright:"fillright %C all",erase:"erase %C all",borderon:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",borderoff:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",merge:"merge %C",unmerge:"unmerge %C","align-left":"set %C cellformat left","align-center":"set %C cellformat center","align-right":"set %C cellformat right",
"align-default":"set %C cellformat",insertrow:"insertrow %C",insertcol:"insertcol %C",deleterow:"deleterow %C",deletecol:"deletecol %C",undo:"undo",redo:"redo",recalc:"recalc"};SocialCalc.SpreadsheetCmdSLookup={borderon:"1px solid rgb(0,0,0)",borderoff:""};
SocialCalc.SpreadsheetControlExecuteCommand=function(a,c,b){var a=SocialCalc.GetSpreadsheetControlObject().editor,d={P:"%",N:"\n"};a.range.hasrange?(d.R=SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom),d.C=d.R,d.W=SocialCalc.rcColname(a.range.left)+":"+SocialCalc.rcColname(a.range.right)):(d.C=a.ecell.coord,d.R=a.ecell.coord+":"+a.ecell.coord,d.W=SocialCalc.rcColname(SocialCalc.coordToCr(a.ecell.coord).col));d.S=b;c=c.replace(/%C/g,d.C);c=c.replace(/%R/g,
d.R);c=c.replace(/%N/g,d.N);c=c.replace(/%S/g,d.S);c=c.replace(/%W/g,d.W);c=c.replace(/%P/g,d.P);a.EditorScheduleSheetCommands(c,!0,!1)};SocialCalc.SpreadsheetControlCreateSheetHTML=function(a){var c,b;c="";c=new SocialCalc.RenderContext(a.sheet);a=document.createElement("div");b=c.RenderSheet(null,{type:"html"});a.appendChild(b);delete c;c=a.innerHTML;delete b;delete a;return c};
SocialCalc.SpreadsheetControlCreateCellHTML=function(a,c,b){var d="",d=a.sheet.cells[c];if(!d)return"";d=d.displaystring==void 0?SocialCalc.FormatValueForDisplay(a.sheet,d.datavalue,c,b||a.context.defaultHTMLlinkstyle):d.displaystring;d=="&nbsp;"&&(d="");return d};
SocialCalc.SpreadsheetControlCreateCellHTMLSave=function(a,c,b){var d,e,g,h,j,k=[];d=c?SocialCalc.ParseRange(c):{cr1:{row:1,col:1},cr2:{row:a.sheet.attribs.lastrow,col:a.sheet.attribs.lastcol}};c=d.cr1;d=d.cr2;k.push("version:1.0");for(e=c.row;e<=d.row;e++)for(g=c.col;g<=d.col;g++)if(h=SocialCalc.crToCoord(g,e),j=a.sheet.cells[h])j=j.displaystring==void 0?SocialCalc.FormatValueForDisplay(a.sheet,j.datavalue,h,b||a.context.defaultHTMLlinkstyle):j.displaystring,j!="&nbsp;"&&k.push(h+":"+SocialCalc.encodeForSave(j));
k.push("");return k.join("\n")};
SocialCalc.SpreadsheetControl.DoFunctionList=function(){var a,c,b=SocialCalc.Formula,d=SocialCalc.Constants.function_classlist,e=SocialCalc.GetSpreadsheetControlObject(),g=e.idPrefix+"function";c=document.getElementById(g+"dialog");if(!c){b.FillFunctionInfo();c='<table><tr><td><span style="font-size:x-small;font-weight:bold">%loc!Category!</span><br><select id="'+g+'class" size="'+d.length+'" style="width:120px;" onchange="SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);">';for(a=
0;a<d.length;a++)c+='<option value="'+d[a]+'"'+(a==0?" selected>":">")+SocialCalc.special_chars(b.FunctionClasses[d[a]].name)+"</option>";c+='</select></td><td>&nbsp;&nbsp;</td><td id="'+g+'list"><span style="font-size:x-small;font-weight:bold">%loc!Functions!</span><br><select id="'+g+'name" size="'+d.length+'" style="width:240px;" onchange="SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);" ondblclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">';c+=SocialCalc.SpreadsheetControl.GetFunctionNamesStr("all");
c+='</td></tr><tr><td colspan="3"><div id="'+g+'desc" style="width:380px;height:80px;overflow:auto;font-size:x-small;">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(b.FunctionClasses[d[0]].items[0])+'</div><div style="width:380px;text-align:right;padding-top:6px;font-size:small;"><input type="button" value="%loc!Paste!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();"></div></td></tr></table>';
b=document.createElement("div");b.id=g+"dialog";b.style.position="absolute";d=SocialCalc.GetViewportInfo();b.style.top=d.height/3+"px";b.style.left=d.width/3+"px";b.style.zIndex=100;b.style.backgroundColor="#FFF";b.style.border="1px solid black";b.style.width="400px";c=SocialCalc.LocalizeSubstrings('<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;%loc!Function List!</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+
c+"</div>");b.innerHTML=c;SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b});e.spreadsheetDiv.appendChild(b);c=document.getElementById(g+"name");c.focus();SocialCalc.CmdGotFocus(c)}};
SocialCalc.SpreadsheetControl.GetFunctionNamesStr=function(a){var c,b="";c=SocialCalc.Formula.FunctionClasses[a];for(a=0;a<c.items.length;a++)b+='<option value="'+c.items[a]+'"'+(a==0?" selected>":">")+c.items[a]+"</option>";return b};SocialCalc.SpreadsheetControl.FillFunctionNames=function(a,c){var b,d;b=SocialCalc.Formula;c.length=0;d=b.FunctionClasses[a];for(b=0;b<d.items.length;b++)if(c.options[b]=new Option(d.items[b],d.items[b]),b==0)c.options[b].selected=!0};
SocialCalc.SpreadsheetControl.GetFunctionInfoStr=function(a){var c=SocialCalc.Formula,b=c.FunctionList[a],d=SocialCalc.special_chars,a="<b>"+a+"("+d(c.FunctionArgString(a))+")</b><br>";a+=d(b[3]);return a};SocialCalc.SpreadsheetControl.FunctionClassChosen=function(a){var c=SocialCalc.GetSpreadsheetControlObject().idPrefix+"function",b=SocialCalc.Formula;SocialCalc.SpreadsheetControl.FillFunctionNames(a,document.getElementById(c+"name"));SocialCalc.SpreadsheetControl.FunctionChosen(b.FunctionClasses[a].items[0])};
SocialCalc.SpreadsheetControl.FunctionChosen=function(a){var c=SocialCalc.GetSpreadsheetControlObject().idPrefix+"function";document.getElementById(c+"desc").innerHTML=SocialCalc.SpreadsheetControl.GetFunctionInfoStr(a)};SocialCalc.SpreadsheetControl.HideFunctions=function(){var a=SocialCalc.GetSpreadsheetControlObject(),a=document.getElementById(a.idPrefix+"functiondialog");a.innerHTML="";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a)};
SocialCalc.SpreadsheetControl.DoFunctionPaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=document.getElementById(a.idPrefix+"functionname"),a=document.getElementById(a.idPrefix+"multilinetextarea"),b=b.value+"(";SocialCalc.SpreadsheetControl.HideFunctions();a?(a.value+=b,a.focus(),SocialCalc.CmdGotFocus(a)):c.EditorAddToInput(b,"=")};
SocialCalc.SpreadsheetControl.DoMultiline=function(){var a=SocialCalc.LocalizeSubstrings,c,b,d=SocialCalc.GetSpreadsheetControlObject(),e=d.editor,g=e.workingvalues,d=SocialCalc.GetSpreadsheetControlObject(),h=d.idPrefix+"multiline";c=document.getElementById(h+"dialog");if(!c){switch(e.state){case "start":g.ecoord=e.ecell.coord;g.erow=e.ecell.row;g.ecol=e.ecell.col;e.RangeRemove();b=SocialCalc.GetCellContents(e.context.sheetobj,g.ecoord);break;case "input":case "inputboxdirect":b=e.inputBox.GetText()}e.inputBox.element.disabled=
!0;b=SocialCalc.special_chars(b);c='<textarea id="'+h+'textarea" style="width:380px;height:120px;margin:10px 0px 0px 6px;">'+b+'</textarea><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;">'+a('<input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilinePaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilineClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();"></div></div>');
b=document.createElement("div");b.id=h+"dialog";b.style.position="absolute";e=SocialCalc.GetViewportInfo();b.style.top=e.height/3+"px";b.style.left=e.width/3+"px";b.style.zIndex=100;b.style.backgroundColor="#FFF";b.style.border="1px solid black";b.style.width="400px";b.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+a("&nbsp;%loc!Multi-line Input Box!")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+
c+"</div>";SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b});d.spreadsheetDiv.appendChild(b);c=document.getElementById(h+"textarea");c.focus();SocialCalc.CmdGotFocus(c)}};
SocialCalc.SpreadsheetControl.HideMultiline=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,a=document.getElementById(a.idPrefix+"multilinedialog");a.innerHTML="";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a);switch(c.state){case "start":c.inputBox.DisplayCellContents(null);break;case "input":case "inputboxdirect":c.inputBox.element.disabled=!1,c.inputBox.Focus()}};
SocialCalc.SpreadsheetControl.DoMultilineClear=function(){var a=SocialCalc.GetSpreadsheetControlObject(),a=document.getElementById(a.idPrefix+"multilinetextarea");a.value="";a.focus()};
SocialCalc.SpreadsheetControl.DoMultilinePaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=c.workingvalues,a=document.getElementById(a.idPrefix+"multilinetextarea").value;SocialCalc.SpreadsheetControl.HideMultiline();switch(c.state){case "start":b.partialexpr="";b.ecoord=c.ecell.coord;b.erow=c.ecell.row;b.ecol=c.ecell.col;break;case "input":case "inputboxdirect":c.inputBox.Blur(),c.inputBox.ShowInputBox(!1),c.state="start"}c.EditorSaveEdit(a)};
SocialCalc.SpreadsheetControl.DoLink=function(){var a=SocialCalc.LocalizeString,c,b,d,e,g=SocialCalc.GetSpreadsheetControlObject();d=g.editor;e=d.workingvalues;var g=SocialCalc.GetSpreadsheetControlObject(),h=g.idPrefix+"link";b=document.getElementById(h+"dialog");if(!b){switch(d.state){case "start":e.ecoord=d.ecell.coord;e.erow=d.ecell.row;e.ecol=d.ecell.col;d.RangeRemove();c=SocialCalc.GetCellContents(d.context.sheetobj,e.ecoord);break;case "input":case "inputboxdirect":c=d.inputBox.GetText()}d.inputBox.element.disabled=
!0;c.charAt(0)=="'"&&(c=c.slice(1));b=SocialCalc.ParseCellLinkText(c);SocialCalc.special_chars(c);c=g.sheet.cells[d.ecell.coord];d=!c||!c.textvalueformat?" checked":"";e=b.newwin?" checked":"";c='<div style="padding:6px 0px 4px 6px;"><span style="font-size:smaller;">'+a("Description")+'</span><br><input type="text" id="'+h+'desc" style="width:380px;" value="'+SocialCalc.special_chars(b.desc)+'"><br><span style="font-size:smaller;">'+a("URL")+'</span><br><input type="text" id="'+h+'url" style="width:380px;" value="'+
SocialCalc.special_chars(b.url)+'"><br>';SocialCalc.Callbacks.MakePageLink&&(c+='<span style="font-size:smaller;">'+a("Page Name")+'</span><br><input type="text" id="'+h+'pagename" style="width:380px;" value="'+SocialCalc.special_chars(b.pagename)+'"><br><span style="font-size:smaller;">'+a("Workspace")+'</span><br><input type="text" id="'+h+'workspace" style="width:380px;" value="'+SocialCalc.special_chars(b.workspace)+'"><br>');c+=SocialCalc.LocalizeSubstrings('<input type="checkbox" id="'+h+'format"'+
d+'>&nbsp;<span style="font-size:smaller;">%loc!Set to Link format!</span><br><input type="checkbox" id="'+h+'popup"'+e+'>&nbsp;<span style="font-size:smaller;">%loc!Show in new browser window!</span></div><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;"><input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkPaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideLink();"></div></div>');
b=document.createElement("div");b.id=h+"dialog";b.style.position="absolute";d=SocialCalc.GetViewportInfo();b.style.top=d.height/3+"px";b.style.left=d.width/3+"px";b.style.zIndex=100;b.style.backgroundColor="#FFF";b.style.border="1px solid black";b.style.width="400px";b.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;'+a("Link Input Box")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideLink();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+
c+"</div>";SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b});g.spreadsheetDiv.appendChild(b);b=document.getElementById(h+"url");b.focus();SocialCalc.CmdGotFocus(b)}};
SocialCalc.SpreadsheetControl.HideLink=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,a=document.getElementById(a.idPrefix+"linkdialog");a.innerHTML="";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a);switch(c.state){case "start":c.inputBox.DisplayCellContents(null);break;case "input":case "inputboxdirect":c.inputBox.element.disabled=!1,c.inputBox.Focus()}};
SocialCalc.SpreadsheetControl.DoLinkClear=function(){var a=SocialCalc.GetSpreadsheetControlObject();document.getElementById(a.idPrefix+"linkdesc").value="";document.getElementById(a.idPrefix+"linkpagename").value="";document.getElementById(a.idPrefix+"linkworkspace").value="";a=document.getElementById(a.idPrefix+"linkurl");a.value="";a.focus()};
SocialCalc.SpreadsheetControl.DoLinkPaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=c.workingvalues,d=document.getElementById(a.idPrefix+"linkdesc"),e=document.getElementById(a.idPrefix+"linkurl"),g=document.getElementById(a.idPrefix+"linkpagename"),h=document.getElementById(a.idPrefix+"linkworkspace"),j=document.getElementById(a.idPrefix+"linkformat"),k="",m,n;document.getElementById(a.idPrefix+"linkpopup").checked?(a="<<",k=">>",m="[[",n="]]"):(a="<",k=">",m="[",n="]");
k=g&&g.value?h.value?d.value+"{"+h.value+m+g.value+n+"}":d.value+m+g.value+n:d.value+a+e.value+k;SocialCalc.SpreadsheetControl.HideLink();switch(c.state){case "start":b.partialexpr="";b.ecoord=c.ecell.coord;b.erow=c.ecell.row;b.ecol=c.ecell.col;break;case "input":case "inputboxdirect":c.inputBox.Blur(),c.inputBox.ShowInputBox(!1),c.state="start"}j.checked&&SocialCalc.SpreadsheetControlExecuteCommand(null,"set %C textvalueformat text-link","");c.EditorSaveEdit(k)};
SocialCalc.SpreadsheetControl.DoSum=function(){var a,c,b,d,e=SocialCalc.GetSpreadsheetControlObject().editor,g=e.context.sheetobj;if(e.range.hasrange)a=SocialCalc.crToCoord(e.range.left,e.range.top)+":"+SocialCalc.crToCoord(e.range.right,e.range.bottom),a="set "+SocialCalc.crToCoord(e.range.right,e.range.bottom+1)+" formula sum("+a+")";else if(a=e.ecell.row-1,b=e.ecell.col,a<=1)a="set "+e.ecell.coord+" constant e#REF! 0 #REF!";else{for(d=!1;a>0;){c=SocialCalc.crToCoord(b,a);c=g.GetAssuredCell(c);
if(!c.datatype||c.datatype=="t"){if(d){a++;break}}else d=!0;a--}a="set "+e.ecell.coord+" formula sum("+SocialCalc.crToCoord(b,a)+":"+SocialCalc.crToCoord(b,e.ecell.row-1)+")"}e.EditorScheduleSheetCommands(a,!0,!1)};
SocialCalc.SpreadsheetControlSortOnclick=function(a){var c,b,d=[],e=document.getElementById(a.idPrefix+"sortlist");SocialCalc.LoadColumnChoosers(a);a.editor.RangeChangeCallback.sort=SocialCalc.UpdateSortRangeProposal;for(c in a.sheet.names)d.push(c);d.sort();e.length=0;e.options[0]=new Option(SocialCalc.LocalizeString("[select range]"));for(b=0;b<d.length;b++)if(c=d[b],e.options[b+1]=new Option(c,c),c==a.sortrange)e.options[b+1].selected=!0;if(a.sortrange=="")e.options[0].selected=!0;SocialCalc.UpdateSortRangeProposal(a.editor);
SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlSortSave=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c,b,d;c="sort:"+SocialCalc.encodeForSave(a.sortrange)+":";b=document.getElementById(a.idPrefix+"majorsort");d=document.getElementById(a.idPrefix+"majorsortup");c+=b.selectedIndex+(d.checked?":up":":down");b=document.getElementById(a.idPrefix+"minorsort");b.selectedIndex>0?(d=document.getElementById(a.idPrefix+"minorsortup"),c+=":"+b.selectedIndex+(d.checked?":up":":down")):c+="::";b=document.getElementById(a.idPrefix+
"lastsort");b.selectedIndex>0?(d=document.getElementById(a.idPrefix+"lastsortup"),c+=":"+b.selectedIndex+(d.checked?":up":":down")):c+="::";return c+"\n"};
SocialCalc.SpreadsheetControlSortLoad=function(a,c,b){a=SocialCalc.GetSpreadsheetControlObject();b=b.split(":");a.sortrange=SocialCalc.decodeFromSave(b[1]);c=document.getElementById(a.idPrefix+"sortbutton");a.sortrange?(c.value=SocialCalc.LocalizeString("Sort ")+a.sortrange,c.style.visibility="visible"):c.style.visibility="hidden";SocialCalc.LoadColumnChoosers(a);sele=document.getElementById(a.idPrefix+"majorsort");sele.selectedIndex=b[2]-0;document.getElementById(a.idPrefix+"majorsort"+b[3]).checked=
!0;sele=document.getElementById(a.idPrefix+"minorsort");b[4]?(sele.selectedIndex=b[4]-0,document.getElementById(a.idPrefix+"minorsort"+b[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"minorsortup").checked=!0);sele=document.getElementById(a.idPrefix+"lastsort");b[6]?(sele.selectedIndex=b[6]-0,document.getElementById(a.idPrefix+"lastsort"+b[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"lastsortup").checked=!0);return!0};
SocialCalc.SpreadsheetControlCommentOnclick=function(a,c){a.editor.MoveECellCallback.comment=SocialCalc.SpreadsheetControlCommentMoveECell;SocialCalc.SpreadsheetControlCommentDisplay(a,c);SocialCalc.KeyboardFocus()};SocialCalc.SpreadsheetControlCommentDisplay=function(a){var c="";a.editor.ecell&&a.editor.ecell.coord&&a.sheet.cells[a.editor.ecell.coord]&&(c=a.sheet.cells[a.editor.ecell.coord].comment||"");document.getElementById(a.idPrefix+"commenttext").value=c};
SocialCalc.SpreadsheetControlCommentMoveECell=function(){SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(),"comment")};
SocialCalc.SpreadsheetControlCommentSet=function(){var a=SocialCalc.GetSpreadsheetControlObject();a.ExecuteCommand("set %C comment "+SocialCalc.encodeForSave(document.getElementById(a.idPrefix+"commenttext").value));var c=SocialCalc.GetEditorCellElement(a.editor,a.editor.ecell.row,a.editor.ecell.col);a.editor.UpdateCellCSS(c,a.editor.ecell.row,a.editor.ecell.col);SocialCalc.KeyboardFocus()};SocialCalc.SpreadsheetControlCommentOnunclick=function(a){delete a.editor.MoveECellCallback.comment};
SocialCalc.SpreadsheetControlNamesOnclick=function(a){document.getElementById(a.idPrefix+"namesname").value="";document.getElementById(a.idPrefix+"namesdesc").value="";document.getElementById(a.idPrefix+"namesvalue").value="";a.editor.RangeChangeCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;a.editor.MoveECellCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;SocialCalc.SpreadsheetControlNamesRangeChange(a.editor);SocialCalc.SpreadsheetControlNamesFillNameList();SocialCalc.SpreadsheetControlNamesChangedName()};
SocialCalc.SpreadsheetControlNamesFillNameList=function(){var a=SocialCalc.LocalizeString,c,b=[],d=SocialCalc.GetSpreadsheetControlObject(),e=document.getElementById(d.idPrefix+"nameslist"),g=document.getElementById(d.idPrefix+"namesname").value.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");for(c in d.sheet.names)b.push(c);b.sort();e.length=0;e.options[0]=b.length>0?new Option(a("[New]")):new Option(a("[None]"));for(a=0;a<b.length;a++)if(c=b[a],e.options[a+1]=new Option(c,c),c==g)e.options[a+1].selected=
!0;if(g=="")e.options[0].selected=!0};
SocialCalc.SpreadsheetControlNamesChangedName=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"nameslist"),c=c.options[c.selectedIndex].value;a.sheet.names[c]?(document.getElementById(a.idPrefix+"namesname").value=c,document.getElementById(a.idPrefix+"namesdesc").value=a.sheet.names[c].desc||"",document.getElementById(a.idPrefix+"namesvalue").value=a.sheet.names[c].definition||""):(document.getElementById(a.idPrefix+"namesname").value="",document.getElementById(a.idPrefix+
"namesdesc").value="",document.getElementById(a.idPrefix+"namesvalue").value="")};SocialCalc.SpreadsheetControlNamesRangeChange=function(a){var c=SocialCalc.GetSpreadsheetControlObject();document.getElementById(c.idPrefix+"namesrangeproposal").value=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord};SocialCalc.SpreadsheetControlNamesOnunclick=function(a){delete a.editor.RangeChangeCallback.names;delete a.editor.MoveECellCallback.names};
SocialCalc.SpreadsheetControlNamesSetValue=function(){var a=SocialCalc.GetSpreadsheetControlObject();document.getElementById(a.idPrefix+"namesvalue").value=document.getElementById(a.idPrefix+"namesrangeproposal").value;SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlNamesSave=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"namesname").value;SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();c!=""&&a.ExecuteCommand("name define "+c+" "+document.getElementById(a.idPrefix+"namesvalue").value+"\nname desc "+c+" "+document.getElementById(a.idPrefix+"namesdesc").value)};
SocialCalc.SpreadsheetControlNamesDelete=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"namesname").value;SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();c!=""&&a.ExecuteCommand("name delete "+c);SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlClipboardOnclick=function(a){a=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(a.idPrefix+"clipboardtext");document.getElementById(a.idPrefix+"clipboardformat-tab").checked=!0;clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,"tab")};
SocialCalc.SpreadsheetControlClipboardFormat=function(a){var c=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(c.idPrefix+"clipboardtext");clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,a)};
SocialCalc.SpreadsheetControlClipboardLoad=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c="tab";SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();document.getElementById(a.idPrefix+"clipboardformat-csv").checked?c="csv":document.getElementById(a.idPrefix+"clipboardformat-scsave").checked&&(c="scsave");a.editor.EditorScheduleSheetCommands("loadclipboard "+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(document.getElementById(a.idPrefix+"clipboardtext").value,c)),
!0,!1)};SocialCalc.SpreadsheetControlClipboardClear=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"clipboardtext");c.value="";a.editor.EditorScheduleSheetCommands("clearclipboard",!0,!1);c.focus()};SocialCalc.SpreadsheetControlClipboardExport=function(){var a=SocialCalc.GetSpreadsheetControlObject();a.ExportCallback&&a.ExportCallback(a);SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlSettingsSwitch=function(a){SocialCalc.SettingControlReset();var c=SocialCalc.GetSpreadsheetControlObject(),b=document.getElementById(c.idPrefix+"sheetsettingstable"),d=document.getElementById(c.idPrefix+"cellsettingstable"),e=document.getElementById(c.idPrefix+"sheetsettingstoolbar"),g=document.getElementById(c.idPrefix+"cellsettingstoolbar");a=="sheet"?(b.style.display="block",d.style.display="none",e.style.display="block",g.style.display="none",SocialCalc.SettingsControlSetCurrentPanel(c.views.settings.values.sheetspanel)):
(b.style.display="none",d.style.display="block",e.style.display="none",g.style.display="block",SocialCalc.SettingsControlSetCurrentPanel(c.views.settings.values.cellspanel))};
SocialCalc.SettingsControlSave=function(a){var c,b,d=SocialCalc.GetSpreadsheetControlObject(),e=SocialCalc.SettingsControlUnloadPanel(SocialCalc.SettingsControls.CurrentPanel);SocialCalc.SetTab(d.tabs[0].name);SocialCalc.KeyboardFocus();a=="sheet"?b=d.sheet.DecodeSheetAttributes(e):a=="cell"&&(d.editor.range.hasrange&&(c=SocialCalc.crToCoord(d.editor.range.left,d.editor.range.top)+":"+SocialCalc.crToCoord(d.editor.range.right,d.editor.range.bottom)),b=d.sheet.DecodeCellAttributes(d.editor.ecell.coord,
e,c));b&&d.editor.EditorScheduleSheetCommands(b,!0,!1)};
SocialCalc.SpreadsheetControlCreateSpreadsheetSave=function(a,c){var b="",d="",e,g;if(c)for(e in c)g=c[e].charAt(c[e]-1)!="\n"?"\n":"",b+="--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+c[e]+g,d+="part:"+e+"\n";return"socialcalc:version:1.0\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary="+a.multipartBoundary+"\n--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n# SocialCalc Spreadsheet Control Save\nversion:1.0\npart:sheet\npart:edit\npart:audit\n"+d+
"--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+a.CreateSheetSave()+"--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+a.editor.SaveEditorSettings()+"--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+a.sheet.CreateAuditString()+b+"--"+a.multipartBoundary+"--\n"};
SocialCalc.SpreadsheetControlDecodeSpreadsheetSave=function(a,c){var b,d,e,g,h,j,k,m={},n=[];b=c.search(/^MIME-Version:\s1\.0/mi);if(b<0)return m;d=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/mig;d.lastIndex=b;e=d.exec(c);if(d.lastIndex<=0)return m;b=e[1];g=RegExp("^--"+b+"(?:\r\n|\n)","mg");g.lastIndex=d.lastIndex;g.exec(c);d=/(?:\r\n|\n)(?:\r\n|\n)/gm;d.lastIndex=g.lastIndex;e=d.exec(c);if(!e)return m;h=d.lastIndex;g.lastIndex=h;e=g.exec(c);if(!e)return m;e=e.index;h=c.substring(h,e).split(/\r\n|\n/);
for(j=0;j<h.length;j++)switch(line=h[j],k=line.split(":"),k[0]){case "part":n.push(k[1])}for(pnum=0;pnum<n.length;pnum++){d.lastIndex=e;e=d.exec(c);if(!e)break;h=d.lastIndex;pnum==n.length-1&&(g=RegExp("^--"+b+"--$","mg"));g.lastIndex=h;e=g.exec(c);if(!e)break;e=e.index;m[n[pnum]]={start:h,end:e}}return m};SocialCalc.SettingsControls={Controls:{},CurrentPanel:null};
SocialCalc.SettingsControlSetCurrentPanel=function(a){SocialCalc.SettingsControls.CurrentPanel=a;SocialCalc.SettingsControls.PopupChangeCallback({panelobj:a},"",null)};SocialCalc.SettingsControlInitializePanel=function(a){var c,b=SocialCalc.SettingsControls;for(c in a)c!="name"&&(ctrl=b.Controls[a[c].type])&&ctrl.Initialize&&ctrl.Initialize(a,c)};
SocialCalc.SettingsControlLoadPanel=function(a,c){var b,d=SocialCalc.SettingsControls;for(b in a)b!="name"&&(ctrl=d.Controls[a[b].type])&&ctrl.SetValue&&ctrl.SetValue(a,b,c[a[b].setting])};SocialCalc.SettingsControlUnloadPanel=function(a){var c,b=SocialCalc.SettingsControls,d={};for(c in a)c!="name"&&(ctrl=b.Controls[a[c].type])&&ctrl.GetValue&&(d[a[c].setting]=ctrl.GetValue(a,c));return d};
SocialCalc.SettingsControls.PopupChangeCallback=function(a){var c=SocialCalc.Constants,b=document.getElementById("sample-text");if(b&&a&&a.panelobj){var d=SocialCalc.CurrentSpreadsheetControlObject.idPrefix,e=a.panelobj.name=="cell"?"c":"",g,h;h=c.defaultCellLayout.match(/^padding.(\S+) (\S+) (\S+) (\S+).vertical.align.(\S+);$/)||[];h={color:["textcolor"],backgroundColor:["bgcolor","#FFF"],fontSize:["fontsize",c.defaultCellFontSize],fontFamily:["fontfamily"],paddingTop:["padtop",h[1]],paddingRight:["padright",
h[2]],paddingBottom:["padbottom",h[3]],paddingLeft:["padleft",h[4]],verticalAlign:["alignvert",h[5]]};for(g in h)c=SocialCalc.Popup.GetValue(d+e+h[g][0])||h[g][1]||"",b.style[g]=c;if(e=="c"){h={borderTop:"cbt",borderRight:"cbr",borderBottom:"cbb",borderLeft:"cbl"};for(g in h)c=SocialCalc.SettingsControls.BorderSideGetValue(a.panelobj,h[g]),b.style[g]=c?c.val||"":"";c=SocialCalc.Popup.GetValue(d+"calignhoriz");b.style.textAlign=c||"left"}else b.style.border="",c=SocialCalc.Popup.GetValue(d+"textalignhoriz"),
b.style.textAlign=c||"left",c=SocialCalc.Popup.GetValue(d+"numberalignhoriz");b.childNodes[1].style.textAlign=c||"right";h=(c=SocialCalc.Popup.GetValue(d+e+"fontlook"))?c.match(/^(\S+) (\S+)$/)||[]:[];b.style.fontStyle=h[1]||"";b.style.fontWeight=h[2]||"";c=SocialCalc.Popup.GetValue(d+e+"formatnumber")||"General";a=SocialCalc.FormatNumber.formatNumberWithFormat(9.8765,c,"");d=SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5,c,"");d!="??-???-??&nbsp;??:??:??"&&(a+="<br>"+d);b.childNodes[1].innerHTML=
a}};SocialCalc.SettingsControls.PopupListSetValue=function(a,c,b){if(b){var d=SocialCalc.Popup;b.def?d.SetValue(a[c].id,""):d.SetValue(a[c].id,b.val)}else alert(c+" no value")};SocialCalc.SettingsControls.PopupListGetValue=function(a,c){var b=a[c];return!b?null:(b=SocialCalc.Popup.GetValue(b.id))?{def:!1,val:b}:{def:!0,val:0}};
SocialCalc.SettingsControls.PopupListInitialize=function(a,c){var b,d,e,g;b=SocialCalc.SettingsControls;b=a[c].initialdata||b.Controls[a[c].type].InitialData||"";b=SocialCalc.LocalizeSubstrings(b);var h=b.split(/\|/),j=[];for(b=0;b<(h.length||0);b++)d=h[b],e=d.indexOf(":"),g=d.substring(0,e),g.indexOf("\\")!=-1&&(g=g.replace(/\\c/g,":"),g=g.replace(/\\b/g,"\\")),g=SocialCalc.special_chars(g),j[b]=g=="[custom]"?{o:SocialCalc.Constants.s_PopupListCustom,v:d.substring(e+1),a:{custom:!0}}:g=="[cancel]"?
{o:SocialCalc.Constants.s_PopupListCancel,v:"",a:{cancel:!0}}:g=="[break]"?{o:"-----",v:"",a:{skip:!0}}:g=="[newcol]"?{o:"",v:"",a:{newcol:!0}}:{o:g,v:d.substring(e+1)};SocialCalc.Popup.Create("List",a[c].id,{});SocialCalc.Popup.Initialize(a[c].id,{options:j,attribs:{changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};SocialCalc.SettingsControls.PopupListReset=function(){SocialCalc.Popup.Reset("List")};
SocialCalc.SettingsControls.Controls.PopupList={SetValue:SocialCalc.SettingsControls.PopupListSetValue,GetValue:SocialCalc.SettingsControls.PopupListGetValue,Initialize:SocialCalc.SettingsControls.PopupListInitialize,OnReset:SocialCalc.SettingsControls.PopupListReset,ChangedCallback:null};SocialCalc.SettingsControls.ColorChooserSetValue=function(a,c,b){if(b){var d=SocialCalc.Popup;b.def?d.SetValue(a[c].id,""):d.SetValue(a[c].id,b.val)}else alert(c+" no value")};
SocialCalc.SettingsControls.ColorChooserGetValue=function(a,c){var b=SocialCalc.Popup.GetValue(a[c].id);return b?{def:!1,val:b}:{def:!0,val:0}};SocialCalc.SettingsControls.ColorChooserInitialize=function(a,c){SocialCalc.Popup.Create("ColorChooser",a[c].id,{});SocialCalc.Popup.Initialize(a[c].id,{attribs:{title:"&nbsp;",moveable:!0,width:"106px",changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};SocialCalc.SettingsControls.ColorChooserReset=function(){SocialCalc.Popup.Reset("ColorChooser")};
SocialCalc.SettingsControls.Controls.ColorChooser={SetValue:SocialCalc.SettingsControls.ColorChooserSetValue,GetValue:SocialCalc.SettingsControls.ColorChooserGetValue,Initialize:SocialCalc.SettingsControls.ColorChooserInitialize,OnReset:SocialCalc.SettingsControls.ColorChooserReset,ChangedCallback:null};
SocialCalc.SettingsControls.BorderSideSetValue=function(a,c,b){a=a[c].id;if(b){if(c=document.getElementById(a+"-onoff-bcb"))b.val?(c.checked=!0,c.value=b.val,b=b.val.match(/(\S+)\s+(\S+)\s+(\S.+)/),a+="-color",SocialCalc.Popup.SetValue(a,b[3]),SocialCalc.Popup.SetDisabled(a,!1)):(c.checked=!1,c.value=b.val,a+="-color",SocialCalc.Popup.SetValue(a,""),SocialCalc.Popup.SetDisabled(a,!0))}else alert(c+" no value")};
SocialCalc.SettingsControls.BorderSideGetValue=function(a,c){var b,d=a[c].id;if(b=document.getElementById(d+"-onoff-bcb"))return b.checked?(b=SocialCalc.Popup.GetValue(d+"-color"),{def:!1,val:"1px solid "+(b||"rgb(0,0,0)")}):{def:!1,val:""}};
SocialCalc.SettingsControls.BorderSideInitialize=function(a,c){var b=a[c].id;SocialCalc.Popup.Create("ColorChooser",b+"-color",{});SocialCalc.Popup.Initialize(b+"-color",{attribs:{title:"&nbsp;",width:"106px",moveable:!0,changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};
SocialCalc.SettingsControlOnchangeBorder=function(a){var c=SocialCalc.SettingsControls,b=c.CurrentPanel,d=a.id.match(/(^.*\-)(\w+)\-(\w+)\-(\w+)$/);if(d){var e=d[2],b=b[e].type;switch(d[4]){case "bcb":a.checked?c.Controls[b].SetValue(c.CurrentPanel,e,{def:!1,val:a.value||"1px solid rgb(0,0,0)"}):c.Controls[b].SetValue(c.CurrentPanel,e,{def:!1,val:""})}}};
SocialCalc.SettingsControls.Controls.BorderSide={SetValue:SocialCalc.SettingsControls.BorderSideSetValue,GetValue:SocialCalc.SettingsControls.BorderSideGetValue,OnClick:SocialCalc.SettingsControls.ColorComboOnClick,Initialize:SocialCalc.SettingsControls.BorderSideInitialize,InitialData:{thickness:"1 pixel:1px",style:"Solid:solid"},ChangedCallback:null};SocialCalc.SettingControlReset=function(){var a=SocialCalc.SettingsControls,c;for(c in a.Controls)a.Controls[c].OnReset&&a.Controls[c].OnReset(c)};
SocialCalc.OtherSaveParts={};
SocialCalc.CtrlSEditor=function(a){var c,b;if(a.length>0)c=SocialCalc.special_chars(SocialCalc.OtherSaveParts[a]||"");else for(b in c="Listing of Parts\n",SocialCalc.OtherSaveParts)c+=SocialCalc.special_chars("\nPart: "+b+"\n=====\n"+SocialCalc.OtherSaveParts[b]+"\n");b=document.createElement("div");b.style.cssText="position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;";b.id="socialcalc-editbox";b.innerHTML=a+'<br><br><textarea id="socialcalc-editbox-textarea" style="width:250px;height:200px;">'+
c+"</textarea><br><br><input type=button onclick=\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '"+a+'\');" value="OK">';document.body.appendChild(b);a=document.getElementById("socialcalc-editbox-textarea");a.focus();SocialCalc.CmdGotFocus(a)};SocialCalc.CtrlSEditorDone=function(a,c){var b=document.getElementById(a+"-textarea").value;c.length>0&&(b.length>0?SocialCalc.OtherSaveParts[c]=b:delete SocialCalc.OtherSaveParts[c]);b=document.getElementById(a);SocialCalc.KeyboardFocus();b.parentNode.removeChild(b)};(function(){Class=function(a,c){if(!a)throw"Class requires a class definition string as its first argument";if(!c)throw"Class requires a class wrapper function as its second argument";if(!a.match(/^([\w\.]+)(?:\(\s*([\w\.]+)\s*\))?(?:\s+(.*?)\s*)?$/))throw"Can't parse Class Definition: '"+a+"'";var b=RegExp.$1,d=RegExp.$2||"",e=[];RegExp.$3&&(e=RegExp.$3.split(/\s+/));for(var g=[],h=!0,j=0,k=e.length;j<k;j++){var m=e[j];m=="-nostrict"&&(h=!1);m.match(/^-inc=(.+)$/)&&(g=RegExp.$1.split(","))}for(var e=
b.split("."),n=Class.global,j=0;j<e.length;j++)n[e[j]]||(n[e[j]]=function(){try{this.init()}catch(a){}}),n=n[e[j]];n.className=b;n.isa=function(a){if(n.baseClassName=a)n.prototype=eval("new "+a+"()"),n.prototype.superFunc=function(c){return eval(a).prototype[c]}};n.isa(d);n.global=Class.global;n.addGlobal=function(){this.newGlobals++;return Class.global};n.extend=function(a){if(typeof a!="object")throw"extend requires an object of name:value pairs";for(var c in a)n.prototype[c]=a[c]};b=0;for(d=g.length;b<
d;b++)j=g[b],g[b]=j=="proto"?n.prototype:j=="this"?n:Class.global[j];h?Class.eval_strict(c,n,g):c.apply(n,g);return n}})();Class.global=this;Class.eval_strict=function(a,c,b){var d=0,e;for(e in Class.global)d++;c.newGlobals=0;a.apply(c,b);a=0;for(e in Class.global)a++;if(d+c.newGlobals!=a)throw"Class '"+c.className+"' defines "+(a-d)+" new global JavaScript variables without using this.addGlobal()";delete c.newGlobals};Class("Document.Emitter",function(){var a=this.prototype;a.className="Document.Emitter";a.instantiate=function(){return eval("new "+this.className+"()")};a.init=function(){this.output=""};a.content=function(){return this.output};a.insert=function(a){this.output+=a.output}});Class("Document.Emitter.HTML(Document.Emitter)",function(){var a=this.prototype;a.className="Document.Emitter.HTML";a.begin_node=function(a){var b=a.type;switch(b){case "asis":case "line":break;case "br":case "hr":this.output+="<"+b+" />";break;case "html":this.output+='<span class="wafl">Raw HTML section. Edit in Wiki Text mode.</span>';break;case "waflparagraph":case "waflphrase":case "im":if(a._wafl.match(/^image:\s*(\S+)(?:\s+size=(\w+))?/)){var a="if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/"+
a._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'",b=RegExp.$1,d=RegExp.$2;switch(d){case "small":d="100";break;case "medium":d="300";break;case "large":d="600"}d&&(d=' width="'+d+'"');this.output+='<img src="'+b.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,
"&gt;")+'" onload="'+a+'"'+d+" />";break}this.output+='<span class="wafl">'+a._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"</span>";break;case "a":case "wikilink":this.output+='<a href="'+encodeURI(a._href)+'">';break;case "file":this.output+='<a title="(network resource)" href="'+encodeURI(a._href)+'">';break;case "ul":case "ol":case "table":case "tr":this.output+="<"+b+">\n";break;default:this.output+="<"+
b+">"}};a.end_node=function(a){a=a.type;switch(a){case "asis":case "br":case "hr":case "html":case "waflparagraph":case "waflphrase":case "im":break;case "line":this.output+="<br />";break;case "file":case "wikilink":this.output+="</a>";break;default:this.output+=a.search(/^(?:p|ul|ol|li|h\d|table|tr|td)$/)==0?"</"+a+">\n":"</"+a+">"}};a.text_node=function(a){this.output+=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}});Class("Document.Parser",function(){var a=this.prototype;a.className="Document.Parser";a.init=function(){};a.parse=function(a,b){this.input=a.search(/\n$/)==-1?a+"\n":a;if(b)this.receiver=b;this.receiver.init();this.grammar=this.create_grammar();this.parse_blocks("top");return this.receiver.content()};a.create_grammar=function(){throw"Please define create_grammar in a derived class of Document.Parser.";};a.parse_blocks=function(a){if(a=this.grammar[a].blocks)for(;this.input.length;){for(var b=this.input.length,
d=0;d<a.length;d++){var e=a[d],g=this.find_match("matched_block",e);if(g){this.input=this.input.substr(g.end);this.handle_match(e,g);break}}if(this.input.length>=b)throw this.classname+": Reduction error for:\n"+this.input+"\n"+JSON.stringify(this);}};a.handle_match=function(a,b){var d=this.grammar[a];this.subparse(d.blocks?"parse_blocks":"parse_phrases",b,a,d.filter)};a.find_match=function(a,b){var d=this.grammar[b].match;if(!d)throw"no regexp for type: "+b;if(d=this.input.match(d))return d=this[a].call(this,
d,this.grammar[b].lookbehind),d.type=this.grammar[b].type||b,d};a.parse_phrases=function(a){if(a=this.grammar[a].phrases)for(;this.input.length;){for(var b=null,d=0;d<a.length;d++){var e=this.find_match("matched_phrase",a[d]);if(e&&(!b||e.begin<b.begin))if(b=e,b.begin==0)break}if(!b){this.receiver.text_node(this.input||"");break}b.begin!=0&&this.receiver.text_node(this.input.substr(0,b.begin)||"");this.input=this.input.substr(b.end);this.handle_match(b.type,b)}else this.receiver.text_node(this.input||
"")};a.subparse=function(a,b,d,e){b.type=this.grammar[d].type;if(b.type==null)b.type=d;e=e?e(b):null;b.type&&this.receiver.begin_node(b);var g=eval("new "+this.className+"()");g.input=e==null?b.text:e;g.grammar=this.grammar;g.receiver=this.receiver.instantiate();g[a].call(g,d);this.receiver.insert(g.receiver);b.type&&this.receiver.end_node(b)};a.matched_block=function(a){return{begin:a.index,text:a[1],end:a[0].length,1:a[2],2:a[3],3:a[4]}};a.matched_phrase=function(a,b){if(b){var d=a[2],e=this.input.indexOf(a[1]);
return{text:d,begin:e,end:e+a[1].length,1:RegExp.$2,2:RegExp.$3,3:RegExp.$4}}return{begin:a.index,text:a[1],end:a.index+a[0].length,1:a[2],2:a[3],3:a[4]}}});Class("Document.Parser.Wikitext(Document.Parser)",function(){var a=this.prototype;a.className="Document.Parser.Wikitext";a.init=function(){};a.create_grammar=function(){var a=["pre","html","hr","hx","waflparagraph","ul","ol","blockquote","p","empty","else"],b=["waflphrase","asis","wikilink","wikilink2","a","im","mail","file","tt","b","i","del","a"],d=function(a,c){c="\\"+(c||a);a="\\"+a;return{match:RegExp("(?:^|[^"+a+"\\w])("+a+"(?=\\S)(?!"+c+")(.*?)"+c+"(?=[^"+c+"\\w]|$))"),phrases:a=="\\`"?null:
b,lookbehind:!0}},e={yahoo:"yahoo",ymsgr:"yahoo",callto:"callto",callme:"callto",skype:"callto",aim:"aim"},g={aim:"AIM: %1",yahoo:"Yahoo: %1",callto:"Skype: %1"},h="(\\b(",j;for(j in e)h+=j+"|";h=h.replace(/\|$/,")\\:([^\\s\\>\\)]+))");j=function(a,c){var b=RegExp("(^|\n)"+c+" *","g");return{match:RegExp("^("+a+"+ .*\n(?:[*-+#]+ .*\n)*)(?:s*\n)?"),blocks:["ul","ol","subl","li"],filter:function(a){return a.text.replace(b,"$1")}}};return{_all_blocks:a,_all_phrases:b,top:{blocks:a},ol:j("#","[*#]"),
ul:j("[-+*]","[-+*#]"),blockquote:{match:/^((?:>[^\n]*\n)+)(?:\s*\n)?/,blocks:["blockquote","line"],filter:function(a){return a.text.replace(/(^|\n)>\ ?/g,"$1")}},line:{match:/([^\n]*)\n/,phrases:b},subl:{type:"li",match:/^(([^\n]*)\n[*#]+\ [^\n]*\n(?:[*#]+\ [^\n]*\n)*)(?:\s*\n)?/,blocks:["ul","ol","li2"]},li:{match:/([^\n]*)\n/,phrases:b},li2:{type:"",match:/([^\n]*)\n/,phrases:b},html:{match:/^(\.html\ *\n(?:[^\n]*\n)*?\.html)\ *\n(?:\s*\n)?/,filter:function(a){a._html=a.text;return""}},pre:{match:/^\.pre\ *\n((?:[^\n]*\n)*?)\.pre\ *\n(?:\s*\n)?/},
hr:{match:/^--+(?:\s*\n)?/},hx:{match:/^((\^+) *([^\n]*?)(\s+=+)?\s*?\n+)/,phrases:b,filter:function(a){a.type="h"+a["1"].length;return a[2]}},p:{match:/^((?:(?!(?:(?:\^+|\#+|\*+|\-+) |\>|\.\w+\s*\n|\{[^\}]+\}\s*\n))[^\n]*\S[^\n]*\n)+(?:(?=^|\n)\s*\n)*)/,phrases:b,filter:function(a){return a.text.replace(/\n$/,"")}},empty:{match:/^(\s*\n)/,filter:function(a){a.type=""}},"else":{match:/^(([^\n]*)\n)/,phrases:[],filter:function(a){a.type="p"}},waflparagraph:{match:/^\{(.*)\}[\ \t]*\n(?:\s*\n)?/,filter:function(a){a._wafl=
a._label=a.text;return""}},waflphrase:{match:/(?:^|[\s\-])((?:"([^\n]+?)")?\{([\w-]+(?=[\:\ \}])(?:\s*:)?\s*[^\n]*?\s*)\}(?=[\W_]|$))/,filter:function(a){a._wafl=a[2];a._label=a[1]||a._wafl;return""},lookbehind:!0},asis:{match:/(\{\{([^\n]*?)\}\}(\}*))/,filter:function(a){a.type="";return a[1]+a[2]}},wikilink:{match:/(?:^|[_\W])(\[()(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(a){a._href="?"+a[2];return a.text||a[2]},lookbehind:!0},wikilink2:{type:"wikilink",match:/(?:"([^"]*)"\s*)(\[(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,
filter:function(a){a._href="?"+a[2];return a[1]||a[2]}},a:{match:/((?:"([^"]*)"\s*)?<?((?:http|https|ftp|irc|file):(?:\/\/)?[\;\/\?\:\@\&\=\+\$\,\[\]\#A-Za-z0-9\-\_\.\!\~\*\'\(\)]+[A-Za-z0-9\/#])>?)/,filter:function(a){a._href=a[2];return a[1]||a[2]}},file:{match:/((?:"([^"]*)")?<(\\\\[^\s\>\)]+)>)/,filter:function(a){var c=a[2].replace(/^\\\\/,"");a._href="file://"+c.replace(/\\/g,"/");return a["1"]||c}},im:{match:RegExp(h),filter:function(a){a._wafl=a[1]+": "+a[2];a._label=(g[e[a[1]]]||"%1").replace(/%1/g,
a[2]);return""}},mail:{match:/([\w+%\-\.]+@(?:[\w\-]+\.)+[\w\-]+)/,filter:function(a){a.type="a";a._href="mailto:"+a.text.replace(/%/g,"%25")}},tt:d("`"),b:d("*"),i:d("_"),del:d("-")}}});(function(a,c){function b(a){return l.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function d(a){if(!ga[a]){var c=v.body,b=l("<"+a+">").appendTo(c),d=b.css("display");b.remove();if(d==="none"||d===""){N||(N=v.createElement("iframe"),N.frameBorder=N.width=N.height=0);c.appendChild(N);if(!U||!N.createElement)U=(N.contentWindow||N.contentDocument).document,U.write((v.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),U.close();b=U.createElement(a);U.body.appendChild(b);
d=l.css(b,"display");c.removeChild(N)}ga[a]=d}return ga[a]}function e(a,c){var b={};l.each(ra.concat.apply([],ra.slice(0,c)),function(){b[this]=a});return b}function g(){ba=c}function h(){setTimeout(g,0);return ba=l.now()}function j(){try{return new a.XMLHttpRequest}catch(c){}}function k(a,c,b,d){if(l.isArray(c))l.each(c,function(c,e){b||Ra.test(a)?d(a,e):k(a+"["+(typeof e=="object"||l.isArray(e)?c:"")+"]",e,b,d)});else if(!b&&c!=null&&typeof c=="object")for(var e in c)k(a+"["+e+"]",c[e],b,d);else d(a,
c)}function m(a,b,d,e,g,h){g=g||b.dataTypes[0];h=h||{};h[g]=!0;for(var g=a[g],j=0,k=g?g.length:0,l=a===ha,n;j<k&&(l||!n);j++)n=g[j](b,d,e),typeof n=="string"&&(!l||h[n]?n=c:(b.dataTypes.unshift(n),n=m(a,b,d,e,n,h)));(l||!n)&&!h["*"]&&(n=m(a,b,d,e,"*",h));return n}function n(a){return function(c,b){var F;typeof c!="string"&&(b=c,c="*");if(l.isFunction(b))for(var d=c.toLowerCase().split(sa),e=0,g=d.length,h,j;e<g;e++)h=d[e],(j=/^\+/.test(h))&&(h=h.substr(1)||"*"),F=a[h]=a[h]||[],h=F,h[j?"unshift":"push"](b)}}
function s(a,c,b){var d=c==="width"?a.offsetWidth:a.offsetHeight,e=c==="width"?Sa:Ta;if(d>0)return b!=="border"&&l.each(e,function(){b||(d-=parseFloat(l.css(a,"padding"+this))||0);b==="margin"?d+=parseFloat(l.css(a,b+this))||0:d-=parseFloat(l.css(a,"border"+this+"Width"))||0}),d+"px";d=V(a,c,c);if(d<0||d==null)d=a.style[c]||0;d=parseFloat(d)||0;b&&l.each(e,function(){d+=parseFloat(l.css(a,"padding"+this))||0;b!=="padding"&&(d+=parseFloat(l.css(a,"border"+this+"Width"))||0);b==="margin"&&(d+=parseFloat(l.css(a,
b+this))||0)});return d+"px"}function q(a,c){c.src?l.ajax({url:c.src,async:!1,dataType:"script"}):l.globalEval((c.text||c.textContent||c.innerHTML||"").replace(Ua,"/*$0*/"));c.parentNode&&c.parentNode.removeChild(c)}function p(a){l.nodeName(a,"input")?r(a):"getElementsByTagName"in a&&l.grep(a.getElementsByTagName("input"),r)}function r(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function u(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in
a?a.querySelectorAll("*"):[]}function t(a,c){var b;if(c.nodeType===1){c.clearAttributes&&c.clearAttributes();c.mergeAttributes&&c.mergeAttributes(a);b=c.nodeName.toLowerCase();if(b==="object")c.outerHTML=a.outerHTML;else if(b!=="input"||a.type!=="checkbox"&&a.type!=="radio")if(b==="option")c.selected=a.defaultSelected;else{if(b==="input"||b==="textarea")c.defaultValue=a.defaultValue}else a.checked&&(c.defaultChecked=c.checked=a.checked),c.value!==a.value&&(c.value=a.value);c.removeAttribute(l.expando)}}
function w(a,c){if(c.nodeType===1&&l.hasData(a)){var b=l.expando,d=l.data(a),e=l.data(c,d);if(d=d[b]){var g=d.events,e=e[b]=l.extend({},d);if(g){delete e.handle;e.events={};for(var h in g){b=0;for(d=g[h].length;b<d;b++)l.event.add(c,h+(g[h][b].namespace?".":"")+g[h][b].namespace,g[h][b],g[h][b].data)}}}}}function x(a,c,b){c=c||0;if(l.isFunction(c))return l.grep(a,function(a,d){return!!c.call(a,d,a)===b});if(c.nodeType)return l.grep(a,function(a){return a===c===b});if(typeof c=="string"){var d=l.grep(a,
function(a){return a.nodeType===1});if(Va.test(c))return l.filter(c,d,!b);c=l.filter(c,d)}return l.grep(a,function(a){return l.inArray(a,c)>=0===b})}function y(a,c){return(a&&a!=="*"?a+".":"")+c.replace(Wa,"`").replace(Xa,"&")}function z(a){var c,b,d,e,g,h,j,k,m,n,p,q=[];e=[];g=l._data(this,"events");if(!(a.liveFired===this||!g||!g.live||a.target.disabled||a.button&&a.type==="click")){a.namespace&&(p=RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)"));a.liveFired=this;var s=
g.live.slice(0);for(j=0;j<s.length;j++)g=s[j],g.origType.replace(ia,"")===a.type?e.push(g.selector):s.splice(j--,1);e=l(a.target).closest(e,a.currentTarget);k=0;for(m=e.length;k<m;k++){n=e[k];for(j=0;j<s.length;j++)if(g=s[j],n.selector===g.selector&&(!p||p.test(g.namespace))&&!n.elem.disabled){h=n.elem;d=null;if(g.preType==="mouseenter"||g.preType==="mouseleave")a.type=g.preType,(d=l(a.relatedTarget).closest(g.selector)[0])&&l.contains(h,d)&&(d=h);(!d||d!==h)&&q.push({elem:h,handleObj:g,level:n.level})}}k=
0;for(m=q.length;k<m;k++){e=q[k];if(b&&e.level>b)break;a.currentTarget=e.elem;a.data=e.handleObj.data;a.handleObj=e.handleObj;p=e.handleObj.origHandler.apply(e.elem,arguments);if(p===!1||a.isPropagationStopped())if(b=e.level,p===!1&&(c=!1),a.isImmediatePropagationStopped())break}return c}}function B(a,b,d){var e=l.extend({},d[0]);e.type=a;e.originalEvent={};e.liveFired=c;l.event.handle.call(b,e);e.isDefaultPrevented()&&d[0].preventDefault()}function A(){return!0}function E(){return!1}function J(a,
b,d){var e=b+"defer",g=b+"queue",h=b+"mark",j=l.data(a,e,c,!0);j&&(d==="queue"||!l.data(a,g,c,!0))&&(d==="mark"||!l.data(a,h,c,!0))&&setTimeout(function(){!l.data(a,g,c,!0)&&!l.data(a,h,c,!0)&&(l.removeData(a,e,!0),j.resolve())},0)}function G(a){for(var c in a)if(c!=="toJSON")return!1;return!0}function I(a,b,d){if(d===c&&a.nodeType===1)if(d="data-"+b.replace(Oa,"$1-$2").toLowerCase(),d=a.getAttribute(d),typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:l.isNaN(d)?Na.test(d)?l.parseJSON(d):
d:parseFloat(d)}catch(e){}l.data(a,b,d)}else d=c;return d}var v=a.document,D=a.navigator,C=a.location,l=function(){function b(){if(!d.isReady){try{v.documentElement.doScroll("left")}catch(a){setTimeout(b,1);return}d.ready()}}var d=function(a,c){return new d.fn.init(a,c,h)},e=a.jQuery,g=a.$,h,j=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,k=/\S/,l=/^\s+/,m=/\s+$/,n=/\d/,p=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,q=/^[\],:{}\s]*$/,s=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
t=/(?:^|:|,)(?:\s*\[)+/g,u=/(webkit)[ \/]([\w.]+)/,w=/(opera)(?:.*version)?[ \/]([\w.]+)/,x=/(msie) ([\w.]+)/,y=/(mozilla)(?:.*? rv:([\w.]+))?/,Za=/-([a-z])/ig,$a=function(a,c){return c.toUpperCase()},Z=D.userAgent,ca,W,ab=Object.prototype.toString,z=Object.prototype.hasOwnProperty,ja=Array.prototype.push,A=Array.prototype.slice,B=String.prototype.trim,C=Array.prototype.indexOf,E={};d.fn=d.prototype={constructor:d,init:function(a,b,e){var g,h;if(!a)return this;if(a.nodeType)return this.context=this[0]=
a,this.length=1,this;if(a==="body"&&!b&&v.body)return this.context=v,this[0]=v.body,this.selector=a,this.length=1,this;if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=j.exec(a):g=[null,a,null];if(g&&(g[1]||!b)){if(g[1])return h=(b=b instanceof d?b[0]:b)?b.ownerDocument||b:v,(e=p.exec(a))?d.isPlainObject(b)?(a=[v.createElement(e[1])],d.fn.attr.call(a,b,!0)):a=[h.createElement(e[1])]:(e=d.buildFragment([g[1]],[h]),a=(e.cacheable?d.clone(e.fragment):e.fragment).childNodes),
d.merge(this,a);if((b=v.getElementById(g[2]))&&b.parentNode){if(b.id!==g[2])return e.find(a);this.length=1;this[0]=b}this.context=v;this.selector=a;return this}return!b||b.jquery?(b||e).find(a):this.constructor(b).find(a)}if(d.isFunction(a))return e.ready(a);a.selector!==c&&(this.selector=a.selector,this.context=a.context);return d.makeArray(a,this)},selector:"",jquery:"1.6.2",length:0,size:function(){return this.length},toArray:function(){return A.call(this,0)},get:function(a){return a==null?this.toArray():
a<0?this[this.length+a]:this[a]},pushStack:function(a,c,b){var e=this.constructor();d.isArray(a)?ja.apply(e,a):d.merge(e,a);e.prevObject=this;e.context=this.context;c==="find"?e.selector=this.selector+(this.selector?" ":"")+b:c&&(e.selector=this.selector+"."+c+"("+b+")");return e},each:function(a,c){return d.each(this,a,c)},ready:function(a){d.bindReady();ca.done(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},
slice:function(){return this.pushStack(A.apply(this,arguments),"slice",A.call(arguments).join(","))},map:function(a){return this.pushStack(d.map(this,function(c,b){return a.call(c,b,c)}))},end:function(){return this.prevObject||this.constructor(null)},push:ja,sort:[].sort,splice:[].splice};d.fn.init.prototype=d.fn;d.extend=d.fn.extend=function(){var a,b,e,g,h,F,j=arguments[0]||{},k=1,l=arguments.length,P=!1;typeof j=="boolean"&&(P=j,j=arguments[1]||{},k=2);typeof j!="object"&&!d.isFunction(j)&&(j=
{});for(l===k&&(j=this,--k);k<l;k++)if((a=arguments[k])!=null)for(b in a)e=j[b],g=a[b],j!==g&&(P&&g&&(d.isPlainObject(g)||(h=d.isArray(g)))?(h?(h=!1,F=e&&d.isArray(e)?e:[]):F=e&&d.isPlainObject(e)?e:{},j[b]=d.extend(P,F,g)):g!==c&&(j[b]=g));return j};d.extend({noConflict:function(c){a.$===d&&(a.$=g);c&&a.jQuery===d&&(a.jQuery=e);return d},isReady:!1,readyWait:1,holdReady:function(a){a?d.readyWait++:d.ready(!0)},ready:function(a){if(a===!0&&!--d.readyWait||a!==!0&&!d.isReady){if(!v.body)return setTimeout(d.ready,
1);d.isReady=!0;a!==!0&&--d.readyWait>0||(ca.resolveWith(v,[d]),d.fn.trigger&&d(v).trigger("ready").unbind("ready"))}},bindReady:function(){if(!ca){ca=d._Deferred();if(v.readyState==="complete")return setTimeout(d.ready,1);if(v.addEventListener)v.addEventListener("DOMContentLoaded",W,!1),a.addEventListener("load",d.ready,!1);else if(v.attachEvent){v.attachEvent("onreadystatechange",W);a.attachEvent("onload",d.ready);var c=!1;try{c=a.frameElement==null}catch(e){}v.documentElement.doScroll&&c&&b()}}},
isFunction:function(a){return d.type(a)==="function"},isArray:Array.isArray||function(a){return d.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNaN:function(a){return a==null||!n.test(a)||isNaN(a)},type:function(a){return a==null?String(a):E[ab.call(a)]||"object"},isPlainObject:function(a){if(!a||d.type(a)!=="object"||a.nodeType||d.isWindow(a))return!1;if(a.constructor&&!z.call(a,"constructor")&&!z.call(a.constructor.prototype,"isPrototypeOf"))return!1;
for(var b in a);return b===c||z.call(a,b)},isEmptyObject:function(a){for(var c in a)return!1;return!0},error:function(a){throw a;},parseJSON:function(c){if(typeof c!="string"||!c)return null;c=d.trim(c);if(a.JSON&&a.JSON.parse)return a.JSON.parse(c);if(q.test(c.replace(s,"@").replace(r,"]").replace(t,"")))return(new Function("return "+c))();d.error("Invalid JSON: "+c)},parseXML:function(c,b,e){a.DOMParser?(e=new DOMParser,b=e.parseFromString(c,"text/xml")):(b=new ActiveXObject("Microsoft.XMLDOM"),
b.async="false",b.loadXML(c));e=b.documentElement;(!e||!e.nodeName||e.nodeName==="parsererror")&&d.error("Invalid XML: "+c);return b},noop:function(){},globalEval:function(c){c&&k.test(c)&&(a.execScript||function(c){a.eval.call(a,c)})(c)},camelCase:function(a){return a.replace(Za,$a)},nodeName:function(a,c){return a.nodeName&&a.nodeName.toUpperCase()===c.toUpperCase()},each:function(a,b,e){var g,h=0,F=a.length,j=F===c||d.isFunction(a);if(e)if(j)for(g in a){if(b.apply(a[g],e)===!1)break}else for(;h<
F;){if(b.apply(a[h++],e)===!1)break}else if(j)for(g in a){if(b.call(a[g],g,a[g])===!1)break}else for(;h<F;)if(b.call(a[h],h,a[h++])===!1)break;return a},trim:B?function(a){return a==null?"":B.call(a)}:function(a){return a==null?"":(a+"").replace(l,"").replace(m,"")},makeArray:function(a,c){var b=c||[];if(a!=null){var e=d.type(a);a.length==null||e==="string"||e==="function"||e==="regexp"||d.isWindow(a)?ja.call(b,a):d.merge(b,a)}return b},inArray:function(a,c){if(C)return C.call(c,a);for(var b=0,d=
c.length;b<d;b++)if(c[b]===a)return b;return-1},merge:function(a,b){var d=a.length,e=0;if(typeof b.length=="number")for(var g=b.length;e<g;e++)a[d++]=b[e];else for(;b[e]!==c;)a[d++]=b[e++];a.length=d;return a},grep:function(a,c,b){for(var d=[],e,b=!!b,g=0,h=a.length;g<h;g++)e=!!c(a[g],g),b!==e&&d.push(a[g]);return d},map:function(a,b,e){var g,h,F=[],j=0,k=a.length;if(a instanceof d||k!==c&&typeof k=="number"&&(k>0&&a[0]&&a[k-1]||k===0||d.isArray(a)))for(;j<k;j++)g=b(a[j],j,e),g!=null&&(F[F.length]=
g);else for(h in a)g=b(a[h],h,e),g!=null&&(F[F.length]=g);return F.concat.apply([],F)},guid:1,proxy:function(a,b){if(typeof b=="string")var e=a[b],b=a,a=e;if(!d.isFunction(a))return c;var g=A.call(arguments,2),e=function(){return a.apply(b,g.concat(A.call(arguments)))};e.guid=a.guid=a.guid||e.guid||d.guid++;return e},access:function(a,b,e,g,h,F){var j=a.length;if(typeof b=="object"){for(var k in b)d.access(a,k,b[k],g,h,e);return a}if(e!==c){g=!F&&g&&d.isFunction(e);for(k=0;k<j;k++)h(a[k],b,g?e.call(a[k],
k,h(a[k],b)):e,F);return a}return j?h(a[0],b):c},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();a=u.exec(a)||w.exec(a)||x.exec(a)||a.indexOf("compatible")<0&&y.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(c,b){return new a.fn.init(c,b)}d.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(b,e){e&&e instanceof d&&!(e instanceof a)&&(e=a(e));return d.fn.init.call(this,
b,e,c)};a.fn.init.prototype=a.fn;var c=a(v);return a},browser:{}});d.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,c){E["[object "+c+"]"]=c.toLowerCase()});Z=d.uaMatch(Z);Z.browser&&(d.browser[Z.browser]=!0,d.browser.version=Z.version);d.browser.webkit&&(d.browser.safari=!0);k.test("\u00a0")&&(l=/^[\s\xA0]+/,m=/[\s\xA0]+$/);h=d(v);v.addEventListener?W=function(){v.removeEventListener("DOMContentLoaded",W,!1);d.ready()}:v.attachEvent&&(W=function(){v.readyState===
"complete"&&(v.detachEvent("onreadystatechange",W),d.ready())});return d}(),H="done fail isResolved isRejected promise then always pipe".split(" "),pa=[].slice;l.extend({_Deferred:function(){var a=[],c,b,d,e={done:function(){if(!d){var b=arguments,g,h,j,k,P;c&&(P=c,c=0);g=0;for(h=b.length;g<h;g++)j=b[g],k=l.type(j),k==="array"?e.done.apply(e,j):k==="function"&&a.push(j);P&&e.resolveWith(P[0],P[1])}return this},resolveWith:function(e,g){if(!d&&!c&&!b){g=g||[];b=1;try{for(;a[0];)a.shift().apply(e,g)}finally{c=
[e,g],b=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!!b||!!c},cancel:function(){d=1;a=[];return this}};return e},Deferred:function(a){var c=l._Deferred(),b=l._Deferred(),d;l.extend(c,{then:function(a,b){c.done(a).fail(b);return this},always:function(){return c.done.apply(c,arguments).fail.apply(this,arguments)},fail:b.done,rejectWith:b.resolveWith,reject:b.resolve,isRejected:b.isResolved,pipe:function(a,b){return l.Deferred(function(d){l.each({done:[a,
"resolve"],fail:[b,"reject"]},function(a,b){var e=b[0],g=b[1],h;l.isFunction(e)?c[a](function(){(h=e.apply(this,arguments))&&l.isFunction(h.promise)?h.promise().then(d.resolve,d.reject):d[g](h)}):c[a](d[g])})}).promise()},promise:function(a){if(a==null){if(d)return d;d=a={}}for(var b=H.length;b--;)a[H[b]]=c[H[b]];return a}});c.done(b.cancel).fail(c.cancel);delete c.cancel;a&&a.call(c,c);return c},when:function(a){function c(a){return function(c){b[a]=arguments.length>1?pa.call(arguments,0):c;--g||
h.resolveWith(h,pa.call(b,0))}}var b=arguments,d=0,e=b.length,g=e,h=e<=1&&a&&l.isFunction(a.promise)?a:l.Deferred();if(e>1){for(;d<e;d++)b[d]&&l.isFunction(b[d].promise)?b[d].promise().then(c(d),h.reject):--g;g||h.resolveWith(h,b)}else h!==a&&h.resolveWith(h,e?[a]:[]);return h.promise()}});l.support=function(){var a=v.createElement("div"),c=v.documentElement,b,d,e,g,h,j,k;a.setAttribute("className","t");a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";
b=a.getElementsByTagName("*");d=a.getElementsByTagName("a")[0];if(!b||!b.length||!d)return{};e=v.createElement("select");g=e.appendChild(v.createElement("option"));b=a.getElementsByTagName("input")[0];j={leadingWhitespace:a.firstChild.nodeType===3,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.55$/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,
checkOn:b.value==="on",optSelected:g.selected,getSetAttribute:a.className!=="t",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0};b.checked=!0;j.noCloneChecked=b.cloneNode(!0).checked;e.disabled=!0;j.optDisabled=!g.disabled;try{delete a.test}catch(m){j.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function(){j.noCloneEvent=!1}),a.cloneNode(!0).fireEvent("onclick"));
b=v.createElement("input");b.value="t";b.setAttribute("type","radio");j.radioValue=b.value==="t";b.setAttribute("checked","checked");a.appendChild(b);d=v.createDocumentFragment();d.appendChild(a.firstChild);j.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="";a.style.width=a.style.paddingLeft="1px";e=v.getElementsByTagName("body")[0];d=v.createElement(e?"div":"body");g={visibility:"hidden",width:0,height:0,border:0,margin:0};e&&l.extend(g,{position:"absolute",left:-1E3,top:-1E3});
for(k in g)d.style[k]=g[k];d.appendChild(a);c=e||c;c.insertBefore(d,c.firstChild);j.appendChecked=b.checked;j.boxModel=a.offsetWidth===2;"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,j.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",j.shrinkWrapBlocks=a.offsetWidth!==2);a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";e=a.getElementsByTagName("td");b=e[0].offsetHeight===0;e[0].style.display=
"";e[1].style.display="none";j.reliableHiddenOffsets=b&&e[0].offsetHeight===0;a.innerHTML="";v.defaultView&&v.defaultView.getComputedStyle&&(h=v.createElement("div"),h.style.width="0",h.style.marginRight="0",a.appendChild(h),j.reliableMarginRight=(parseInt((v.defaultView.getComputedStyle(h,null)||{marginRight:0}).marginRight,10)||0)===0);d.innerHTML="";c.removeChild(d);if(a.attachEvent)for(k in{submit:1,change:1,focusin:1})h="on"+k,(b=h in a)||(a.setAttribute(h,"return;"),b=typeof a[h]=="function"),
j[k+"Bubbles"]=b;d=d=e=g=e=h=a=b=null;return j}();l.boxModel=l.support.boxModel;var Na=/^(?:\{.*\}|\[.*\])$/,Oa=/([a-z])([A-Z])/g;l.extend({cache:{},uuid:0,expando:"jQuery"+(l.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?l.cache[a[l.expando]]:a[l.expando];return!!a&&!G(a)},data:function(a,b,d,e){if(l.acceptData(a)){var g=l.expando,h=typeof b=="string",j=a.nodeType,k=j?l.cache:a,m=j?a[l.expando]:
a[l.expando]&&l.expando;if(m&&(!e||!m||k[m][g])||!(h&&d===c)){m||(j?a[l.expando]=m=++l.uuid:m=l.expando);k[m]||(k[m]={},j||(k[m].toJSON=l.noop));if(typeof b=="object"||typeof b=="function")e?k[m][g]=l.extend(k[m][g],b):k[m]=l.extend(k[m],b);a=k[m];e&&(a[g]||(a[g]={}),a=a[g]);d!==c&&(a[l.camelCase(b)]=d);return b==="events"&&!a[b]?a[g]&&a[g].events:h?a[l.camelCase(b)]||a[b]:a}}},removeData:function(c,b,d){if(l.acceptData(c)){var e=l.expando,g=c.nodeType,h=g?l.cache:c,j=g?c[l.expando]:l.expando;if(h[j]){if(b){var k=
d?h[j][e]:h[j];if(k&&(delete k[b],!G(k)))return}if(d&&(delete h[j][e],!G(h[j])))return;b=h[j][e];l.support.deleteExpando||h!=a?delete h[j]:h[j]=null;b?(h[j]={},g||(h[j].toJSON=l.noop),h[j][e]=b):g&&(l.support.deleteExpando?delete c[l.expando]:c.removeAttribute?c.removeAttribute(l.expando):c[l.expando]=null)}}},_data:function(a,c,b){return l.data(a,c,b,!0)},acceptData:function(a){if(a.nodeName){var c=l.noData[a.nodeName.toLowerCase()];if(c)return c!==!0&&a.getAttribute("classid")===c}return!0}});l.fn.extend({data:function(a,
b){var d=null;if(typeof a=="undefined"){if(this.length&&(d=l.data(this[0]),this[0].nodeType===1))for(var e=this[0].attributes,g,h=0,j=e.length;h<j;h++)g=e[h].name,g.indexOf("data-")===0&&(g=l.camelCase(g.substring(5)),I(this[0],g,d[g]));return d}if(typeof a=="object")return this.each(function(){l.data(this,a)});var k=a.split(".");k[1]=k[1]?"."+k[1]:"";return b===c?(d=this.triggerHandler("getData"+k[1]+"!",[k[0]]),d===c&&this.length&&(d=l.data(this[0],a),d=I(this[0],a,d)),d===c&&k[1]?this.data(k[0]):
d):this.each(function(){var c=l(this),d=[k[0],b];c.triggerHandler("setData"+k[1]+"!",d);l.data(this,a,b);c.triggerHandler("changeData"+k[1]+"!",d)})},removeData:function(a){return this.each(function(){l.removeData(this,a)})}});l.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",l.data(a,b,(l.data(a,b,c,!0)||0)+1,!0))},_unmark:function(a,b,d){a!==!0&&(d=b,b=a,a=!1);if(b){var d=d||"fx",e=d+"mark";(a=a?0:(l.data(b,e,c,!0)||1)-1)?l.data(b,e,a,!0):(l.removeData(b,e,!0),J(b,d,"mark"))}},queue:function(a,
b,d){if(a){var b=(b||"fx")+"queue",e=l.data(a,b,c,!0);d&&(!e||l.isArray(d)?e=l.data(a,b,l.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,c){var c=c||"fx",b=l.queue(a,c),d=b.shift();d==="inprogress"&&(d=b.shift());d&&(c==="fx"&&b.unshift("inprogress"),d.call(a,function(){l.dequeue(a,c)}));b.length||(l.removeData(a,c+"queue",!0),J(a,c,"queue"))}});l.fn.extend({queue:function(a,b){typeof a!="string"&&(b=a,a="fx");return b===c?l.queue(this[0],a):this.each(function(){var c=l.queue(this,
a,b);a==="fx"&&c[0]!=="inprogress"&&l.dequeue(this,a)})},dequeue:function(a){return this.each(function(){l.dequeue(this,a)})},delay:function(a,c){a=l.fx?l.fx.speeds[a]||a:a;c=c||"fx";return this.queue(c,function(){var b=this;setTimeout(function(){l.dequeue(b,c)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a){function b(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(a=c);var a=a||"fx",d=l.Deferred(),e=this,g=e.length,h=1,j=a+"defer",k=a+"queue";a+="mark";for(var m;g--;)if(m=
l.data(e[g],j,c,!0)||(l.data(e[g],k,c,!0)||l.data(e[g],a,c,!0))&&l.data(e[g],j,l._Deferred(),!0))h++,m.done(b);b();return d.promise()}});var qa=/[\n\t\r]/g,fa=/\s+/,Pa=/\r/g,Qa=/^(?:button|input)$/i,bb=/^(?:button|input|object|select|textarea)$/i,cb=/^a(?:rea)?$/i,ta=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,db=/\:|^on/,L,ua;l.fn.extend({attr:function(a,c){return l.access(this,a,c,!0,l.attr)},removeAttr:function(a){return this.each(function(){l.removeAttr(this,
a)})},prop:function(a,c){return l.access(this,a,c,!0,l.prop)},removeProp:function(a){a=l.propFix[a]||a;return this.each(function(){try{this[a]=c,delete this[a]}catch(b){}})},addClass:function(a){var c,b,d,e,g,h,j;if(l.isFunction(a))return this.each(function(c){l(this).addClass(a.call(this,c,this.className))});if(a&&typeof a=="string"){c=a.split(fa);b=0;for(d=this.length;b<d;b++)if(e=this[b],e.nodeType===1)if(!e.className&&c.length===1)e.className=a;else{g=" "+e.className+" ";h=0;for(j=c.length;h<
j;h++)~g.indexOf(" "+c[h]+" ")||(g+=c[h]+" ");e.className=l.trim(g)}}return this},removeClass:function(a){var b,d,e,g,h,j,k;if(l.isFunction(a))return this.each(function(c){l(this).removeClass(a.call(this,c,this.className))});if(a&&typeof a=="string"||a===c){b=(a||"").split(fa);d=0;for(e=this.length;d<e;d++)if(g=this[d],g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(qa," ");j=0;for(k=b.length;j<k;j++)h=h.replace(" "+b[j]+" "," ");g.className=l.trim(h)}else g.className=""}return this},
toggleClass:function(a,c){var b=typeof a,d=typeof c=="boolean";return l.isFunction(a)?this.each(function(b){l(this).toggleClass(a.call(this,b,this.className,c),c)}):this.each(function(){if(b==="string")for(var e,g=0,h=l(this),j=c,k=a.split(fa);e=k[g++];)j=d?j:!h.hasClass(e),h[j?"addClass":"removeClass"](e);else if(b==="undefined"||b==="boolean")this.className&&l._data(this,"__className__",this.className),this.className=this.className||a===!1?"":l._data(this,"__className__")||""})},hasClass:function(a){for(var a=
" "+a+" ",c=0,b=this.length;c<b;c++)if((" "+this[c].className+" ").replace(qa," ").indexOf(a)>-1)return!0;return!1},val:function(a){var b,d,e=this[0];if(!arguments.length){if(e){if((b=l.valHooks[e.nodeName.toLowerCase()]||l.valHooks[e.type])&&"get"in b&&(d=b.get(e,"value"))!==c)return d;d=e.value;return typeof d=="string"?d.replace(Pa,""):d==null?"":d}return c}var g=l.isFunction(a);return this.each(function(d){var e=l(this),h;if(this.nodeType===1&&(g?h=a.call(this,d,e.val()):h=a,h==null?h="":typeof h==
"number"?h+="":l.isArray(h)&&(h=l.map(h,function(a){return a==null?"":a+""})),b=l.valHooks[this.nodeName.toLowerCase()]||l.valHooks[this.type],!b||!("set"in b)||b.set(this,h,"value")===c))this.value=h})}});l.extend({valHooks:{option:{get:function(a){var c=a.attributes.value;return!c||c.specified?a.value:a.text}},select:{get:function(a){var c,b=a.selectedIndex,d=[],e=a.options,a=a.type==="select-one";if(b<0)return null;for(var g=a?b:0,h=a?b+1:e.length;g<h;g++)if(c=e[g],c.selected&&(l.support.optDisabled?
!c.disabled:c.getAttribute("disabled")===null)&&(!c.parentNode.disabled||!l.nodeName(c.parentNode,"optgroup"))){c=l(c).val();if(a)return c;d.push(c)}return a&&!d.length&&e.length?l(e[b]).val():d},set:function(a,c){var b=l.makeArray(c);l(a).find("option").each(function(){this.selected=l.inArray(l(this).val(),b)>=0});b.length||(a.selectedIndex=-1);return b}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,b,d,e){var g=a.nodeType;
if(!a||g===3||g===8||g===2)return c;if(e&&b in l.attrFn)return l(a)[b](d);if(!("getAttribute"in a))return l.prop(a,b,d);var h,j;(e=g!==1||!l.isXMLDoc(a))&&(b=l.attrFix[b]||b,j=l.attrHooks[b],j||(ta.test(b)?j=ua:L&&b!=="className"&&(l.nodeName(a,"form")||db.test(b))&&(j=L)));if(d!==c){if(d===null)return l.removeAttr(a,b),c;if(j&&"set"in j&&e&&(h=j.set(a,d,b))!==c)return h;a.setAttribute(b,""+d);return d}if(j&&"get"in j&&e&&(h=j.get(a,b))!==null)return h;h=a.getAttribute(b);return h===null?c:h},removeAttr:function(a,
c){var b;a.nodeType===1&&(c=l.attrFix[c]||c,l.support.getSetAttribute?a.removeAttribute(c):(l.attr(a,c,""),a.removeAttributeNode(a.getAttributeNode(c))),ta.test(c)&&(b=l.propFix[c]||c)in a&&(a[b]=!1))},attrHooks:{type:{set:function(a,c){if(Qa.test(a.nodeName)&&a.parentNode)l.error("type property can't be changed");else if(!l.support.radioValue&&c==="radio"&&l.nodeName(a,"input")){var b=a.value;a.setAttribute("type",c);b&&(a.value=b);return c}}},tabIndex:{get:function(a){var b=a.getAttributeNode("tabIndex");
return b&&b.specified?parseInt(b.value,10):bb.test(a.nodeName)||cb.test(a.nodeName)&&a.href?0:c}},value:{get:function(a,c){return L&&l.nodeName(a,"button")?L.get(a,c):c in a?a.value:null},set:function(a,c,b){if(L&&l.nodeName(a,"button"))return L.set(a,c,b);a.value=c}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",
contenteditable:"contentEditable"},prop:function(a,b,d){var e=a.nodeType;if(!a||e===3||e===8||e===2)return c;var g,h;(e!==1||!l.isXMLDoc(a))&&(b=l.propFix[b]||b,h=l.propHooks[b]);return d!==c?h&&"set"in h&&(g=h.set(a,d,b))!==c?g:a[b]=d:h&&"get"in h&&(g=h.get(a,b))!==c?g:a[b]},propHooks:{}});ua={get:function(a,b){return l.prop(a,b)?b.toLowerCase():c},set:function(a,c,b){var d;c===!1?l.removeAttr(a,b):(d=l.propFix[b]||b,d in a&&(a[d]=!0),a.setAttribute(b,b.toLowerCase()));return b}};l.support.getSetAttribute||
(l.attrFix=l.propFix,L=l.attrHooks.name=l.attrHooks.title=l.valHooks.button={get:function(a,b){var d;return(d=a.getAttributeNode(b))&&d.nodeValue!==""?d.nodeValue:c},set:function(a,c,b){if(a=a.getAttributeNode(b))return a.nodeValue=c}},l.each(["width","height"],function(a,c){l.attrHooks[c]=l.extend(l.attrHooks[c],{set:function(a,b){if(b==="")return a.setAttribute(c,"auto"),b}})}));l.support.hrefNormalized||l.each(["href","src","width","height"],function(a,b){l.attrHooks[b]=l.extend(l.attrHooks[b],
{get:function(a){a=a.getAttribute(b,2);return a===null?c:a}})});l.support.style||(l.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||c},set:function(a,c){return a.style.cssText=""+c}});l.support.optSelected||(l.propHooks.selected=l.extend(l.propHooks.selected,{get:function(){}}));l.support.checkOn||l.each(["radio","checkbox"],function(){l.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}});l.each(["radio","checkbox"],function(){l.valHooks[this]=
l.extend(l.valHooks[this],{set:function(a,c){if(l.isArray(c))return a.checked=l.inArray(l(a).val(),c)>=0}})});var ia=/\.(.*)$/,ka=/^(?:textarea|input|select)$/i,Wa=/\./g,Xa=/ /g,eb=/[^\w\s.|`]/g,fb=function(a){return a.replace(eb,"\\$&")};l.event={add:function(a,b,d,e){if(a.nodeType!==3&&a.nodeType!==8){if(d===!1)d=E;else if(!d)return;var g,h;d.handler&&(g=d,d=g.handler);d.guid||(d.guid=l.guid++);if(h=l._data(a)){var j=h.events,k=h.handle;j||(h.events=j={});k||(h.handle=k=function(a){return typeof l!=
"undefined"&&(!a||l.event.triggered!==a.type)?l.event.handle.apply(k.elem,arguments):c});k.elem=a;for(var b=b.split(" "),m,n=0,p;m=b[n++];){h=g?l.extend({},g):{handler:d,data:e};m.indexOf(".")>-1?(p=m.split("."),m=p.shift(),h.namespace=p.slice(0).sort().join(".")):(p=[],h.namespace="");h.type=m;h.guid||(h.guid=d.guid);var q=j[m],s=l.event.special[m]||{};if(!q&&(q=j[m]=[],!s.setup||s.setup.call(a,e,p,k)===!1))a.addEventListener?a.addEventListener(m,k,!1):a.attachEvent&&a.attachEvent("on"+m,k);s.add&&
(s.add.call(a,h),h.handler.guid||(h.handler.guid=d.guid));q.push(h);l.event.global[m]=!0}a=null}}},global:{},remove:function(a,b,d,e){if(a.nodeType!==3&&a.nodeType!==8){d===!1&&(d=E);var g,h,j=0,k,m,n,p,q,s,r=l.hasData(a)&&l._data(a),t=r&&r.events;if(r&&t)if(b&&b.type&&(d=b.handler,b=b.type),!b||typeof b=="string"&&b.charAt(0)===".")for(g in b=b||"",t)l.event.remove(a,g+b);else{for(b=b.split(" ");g=b[j++];)if(p=g,k=g.indexOf(".")<0,m=[],k||(m=g.split("."),g=m.shift(),n=RegExp("(^|\\.)"+l.map(m.slice(0).sort(),
fb).join("\\.(?:.*\\.)?")+"(\\.|$)")),q=t[g])if(d){p=l.event.special[g]||{};for(h=e||0;h<q.length;h++)if(s=q[h],d.guid===s.guid){if(k||n.test(s.namespace))e==null&&q.splice(h--,1),p.remove&&p.remove.call(a,s);if(e!=null)break}if(q.length===0||e!=null&&q.length===1)(!p.teardown||p.teardown.call(a,m)===!1)&&l.removeEvent(a,g,r.handle),delete t[g]}else for(h=0;h<q.length;h++)if(s=q[h],k||n.test(s.namespace))l.event.remove(a,p,s.handler,h),q.splice(h--,1);if(l.isEmptyObject(t))(b=r.handle)&&(b.elem=null),
delete r.events,delete r.handle,l.isEmptyObject(r)&&l.removeData(a,c,!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(b,d,e,g){var h=b.type||b,j=[],k;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0);h.indexOf(".")>=0&&(j=h.split("."),h=j.shift(),j.sort());if(e&&!l.event.customEvent[h]||l.event.global[h]){b=typeof b=="object"?b[l.expando]?b:new l.Event(h,b):new l.Event(h);b.type=h;b.exclusive=k;b.namespace=j.join(".");b.namespace_re=RegExp("(^|\\.)"+j.join("\\.(?:.*\\.)?")+"(\\.|$)");
if(g||!e)b.preventDefault(),b.stopPropagation();if(e){if(!(e.nodeType===3||e.nodeType===8)){b.result=c;b.target=e;d=d!=null?l.makeArray(d):[];d.unshift(b);j=e;g=h.indexOf(":")<0?"on"+h:"";do k=l._data(j,"handle"),b.currentTarget=j,k&&k.apply(j,d),g&&l.acceptData(j)&&j[g]&&j[g].apply(j,d)===!1&&(b.result=!1,b.preventDefault()),j=j.parentNode||j.ownerDocument||j===b.target.ownerDocument&&a;while(j&&!b.isPropagationStopped());if(!b.isDefaultPrevented()){var m,j=l.event.special[h]||{};if((!j._default||
j._default.call(e.ownerDocument,b)===!1)&&(h!=="click"||!l.nodeName(e,"a"))&&l.acceptData(e)){try{g&&e[h]&&(m=e[g],m&&(e[g]=null),l.event.triggered=h,e[h]())}catch(n){}m&&(e[g]=m);l.event.triggered=c}}return b.result}}else l.each(l.cache,function(){var a=this[l.expando];a&&a.events&&a.events[h]&&l.event.trigger(b,d,a.handle.elem)})}},handle:function(b){var b=l.event.fix(b||a.event),d=((l._data(this,"events")||{})[b.type]||[]).slice(0),e=!b.exclusive&&!b.namespace,g=Array.prototype.slice.call(arguments,
0);g[0]=b;b.currentTarget=this;for(var h=0,j=d.length;h<j;h++){var k=d[h];if(e||b.namespace_re.test(k.namespace))if(b.handler=k.handler,b.data=k.data,b.handleObj=k,k=k.handler.apply(this,g),k!==c&&(b.result=k,k===!1&&(b.preventDefault(),b.stopPropagation())),b.isImmediatePropagationStopped())break}return b.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[l.expando])return a;for(var b=a,a=l.Event(b),d=this.props.length,e;d;)e=this.props[--d],a[e]=b[e];a.target||(a.target=a.srcElement||v);a.target.nodeType===3&&(a.target=a.target.parentNode);!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);if(a.pageX==null&&a.clientX!=null)d=a.target.ownerDocument||v,b=d.documentElement,d=d.body,a.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0),a.pageY=
a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0);a.which==null&&(a.charCode!=null||a.keyCode!=null)&&(a.which=a.charCode!=null?a.charCode:a.keyCode);!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey);!a.which&&a.button!==c&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1E8,proxy:l.proxy,special:{ready:{setup:l.bindReady,teardown:l.noop},live:{add:function(a){l.event.add(this,y(a.origType,a.selector),l.extend({},a,{handler:z,guid:a.handler.guid}))},remove:function(a){l.event.remove(this,
y(a.origType,a.selector),a)}},beforeunload:{setup:function(a,c,b){l.isWindow(this)&&(this.onbeforeunload=b)},teardown:function(a,c){this.onbeforeunload===c&&(this.onbeforeunload=null)}}}};l.removeEvent=v.removeEventListener?function(a,c,b){a.removeEventListener&&a.removeEventListener(c,b,!1)}:function(a,c,b){a.detachEvent&&a.detachEvent("on"+c,b)};l.Event=function(a,c){if(!this.preventDefault)return new l.Event(a,c);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||
a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?A:E):this.type=a;c&&l.extend(this,c);this.timeStamp=l.now();this[l.expando]=!0};l.Event.prototype={preventDefault:function(){this.isDefaultPrevented=A;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=A;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=
A;this.stopPropagation()},isDefaultPrevented:E,isPropagationStopped:E,isImmediatePropagationStopped:E};var va=function(a){var c=a.relatedTarget,b=!1,d=a.type;a.type=a.data;c!==this&&(c&&(b=l.contains(this,c)),b||(l.event.handle.apply(this,arguments),a.type=d))},wa=function(a){a.type=a.data;l.event.handle.apply(this,arguments)};l.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,c){l.event.special[a]={setup:function(b){l.event.add(this,c,b&&b.selector?wa:va,a)},teardown:function(a){l.event.remove(this,
c,a&&a.selector?wa:va)}}});l.support.submitBubbles||(l.event.special.submit={setup:function(){if(l.nodeName(this,"form"))return!1;else l.event.add(this,"click.specialSubmit",function(a){var c=a.target,b=c.type;(b==="submit"||b==="image")&&l(c).closest("form").length&&B("submit",this,arguments)}),l.event.add(this,"keypress.specialSubmit",function(a){var c=a.target,b=c.type;(b==="text"||b==="password")&&l(c).closest("form").length&&a.keyCode===13&&B("submit",this,arguments)})},teardown:function(){l.event.remove(this,
".specialSubmit")}});if(!l.support.changeBubbles){var aa,xa=function(a){var c=a.type,b=a.value;c==="radio"||c==="checkbox"?b=a.checked:c==="select-multiple"?b=a.selectedIndex>-1?l.map(a.options,function(a){return a.selected}).join("-"):"":l.nodeName(a,"select")&&(b=a.selectedIndex);return b},da=function(a,b){var d=a.target,e,g;if(ka.test(d.nodeName)&&!d.readOnly&&(e=l._data(d,"_change_data"),g=xa(d),(a.type!=="focusout"||d.type!=="radio")&&l._data(d,"_change_data",g),!(e===c||g===e)))if(e!=null||
g)a.type="change",a.liveFired=c,l.event.trigger(a,b,d)};l.event.special.change={filters:{focusout:da,beforedeactivate:da,click:function(a){var c=a.target,b=l.nodeName(c,"input")?c.type:"";(b==="radio"||b==="checkbox"||l.nodeName(c,"select"))&&da.call(this,a)},keydown:function(a){var c=a.target,b=l.nodeName(c,"input")?c.type:"";(a.keyCode===13&&!l.nodeName(c,"textarea")||a.keyCode===32&&(b==="checkbox"||b==="radio")||b==="select-multiple")&&da.call(this,a)},beforeactivate:function(a){a=a.target;l._data(a,
"_change_data",xa(a))}},setup:function(){if(this.type==="file")return!1;for(var a in aa)l.event.add(this,a+".specialChange",aa[a]);return ka.test(this.nodeName)},teardown:function(){l.event.remove(this,".specialChange");return ka.test(this.nodeName)}};aa=l.event.special.change.filters;aa.focus=aa.beforeactivate}l.support.focusinBubbles||l.each({focus:"focusin",blur:"focusout"},function(a,c){function b(a){var d=l.event.fix(a);d.type=c;d.originalEvent={};l.event.trigger(d,null,d.target);d.isDefaultPrevented()&&
a.preventDefault()}var d=0;l.event.special[c]={setup:function(){d++===0&&v.addEventListener(a,b,!0)},teardown:function(){--d===0&&v.removeEventListener(a,b,!0)}}});l.each(["bind","one"],function(a,b){l.fn[b]=function(a,d,e){var g;if(typeof a=="object"){for(var h in a)this[b](h,d,a[h],e);return this}if(arguments.length===2||d===!1)e=d,d=c;b==="one"?(g=function(a){l(this).unbind(a,g);return e.apply(this,arguments)},g.guid=e.guid||l.guid++):g=e;if(a==="unload"&&b!=="one")this.one(a,d,e);else{h=0;for(var j=
this.length;h<j;h++)l.event.add(this[h],a,g,d)}return this}});l.fn.extend({unbind:function(a,c){if(typeof a=="object"&&!a.preventDefault)for(var b in a)this.unbind(b,a[b]);else{b=0;for(var d=this.length;b<d;b++)l.event.remove(this[b],a,c)}return this},delegate:function(a,c,b,d){return this.live(c,b,d,a)},undelegate:function(a,c,b){return arguments.length===0?this.unbind("live"):this.die(c,null,b,a)},trigger:function(a,c){return this.each(function(){l.event.trigger(a,c,this)})},triggerHandler:function(a,
c){if(this[0])return l.event.trigger(a,c,this[0],!0)},toggle:function(a){var c=arguments,b=a.guid||l.guid++,d=0,e=function(b){var e=(l.data(this,"lastToggle"+a.guid)||0)%d;l.data(this,"lastToggle"+a.guid,e+1);b.preventDefault();return c[e].apply(this,arguments)||!1};for(e.guid=b;d<c.length;)c[d++].guid=b;return this.click(e)},hover:function(a,c){return this.mouseenter(a).mouseleave(c||a)}});var la={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};l.each(["live","die"],
function(a,b){l.fn[b]=function(a,d,e,g){var h=0,j,k,F=g||this.selector,m=g?this:l(this.context);if(typeof a=="object"&&!a.preventDefault){for(j in a)m[b](j,d,a[j],F);return this}if(b==="die"&&!a&&g&&g.charAt(0)===".")return m.unbind(g),this;if(d===!1||l.isFunction(d))e=d||E,d=c;for(a=(a||"").split(" ");(g=a[h++])!=null;)if(j=ia.exec(g),k="",j&&(k=j[0],g=g.replace(ia,"")),g==="hover")a.push("mouseenter"+k,"mouseleave"+k);else if(j=g,la[g]?(a.push(la[g]+k),g+=k):g=(la[g]||g)+k,b==="live"){k=0;for(var n=
m.length;k<n;k++)l.event.add(m[k],"live."+y(g,F),{data:d,selector:F,handler:e,origType:g,origHandler:e,preType:j})}else m.unbind("live."+y(g,F),e);return this}});l.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,c){l.fn[c]=function(a,b){b==null&&(b=a,a=null);return arguments.length>0?this.bind(c,a,b):this.trigger(c)};l.attrFn&&(l.attrFn[c]=
!0)});(function(){function a(c,b,d,e,g,h){for(var g=0,j=e.length;g<j;g++){var k=e[g];if(k){for(var l=!1,k=k[c];k;){if(k.sizcache===d){l=e[k.sizset];break}if(k.nodeType===1)if(h||(k.sizcache=d,k.sizset=g),typeof b!="string"){if(k===b){l=!0;break}}else if(n.filter(b,[k]).length>0){l=k;break}k=k[c]}e[g]=l}}}function b(a,c,d,e,g,h){for(var g=0,j=e.length;g<j;g++){var k=e[g];if(k){for(var l=!1,k=k[a];k;){if(k.sizcache===d){l=e[k.sizset];break}k.nodeType===1&&!h&&(k.sizcache=d,k.sizset=g);if(k.nodeName.toLowerCase()===
c){l=k;break}k=k[a]}e[g]=l}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,g=Object.prototype.toString,h=!1,j=!0,k=/\\/g,m=/\W/;[0,0].sort(function(){j=!1;return 0});var n=function(a,c,b,e){var b=b||[],h=c=c||v;if(c.nodeType!==1&&c.nodeType!==9)return[];if(!a||typeof a!="string")return b;var j,k,l,F,m,M,Q=!0,s=n.isXML(c),r=[],u=a;do if(d.exec(""),j=d.exec(u))if(u=j[3],r.push(j[1]),j[2]){F=j[3];break}while(j);
if(r.length>1&&q.exec(a))if(r.length===2&&p.relative[r[0]])k=y(r[0]+r[1],c);else for(k=p.relative[r[0]]?[c]:n(r.shift(),c);r.length;)a=r.shift(),p.relative[a]&&(a+=r.shift()),k=y(a,k);else if(!e&&r.length>1&&c.nodeType===9&&!s&&p.match.ID.test(r[0])&&!p.match.ID.test(r[r.length-1])&&(m=n.find(r.shift(),c,s),c=m.expr?n.filter(m.expr,m.set)[0]:m.set[0]),c){m=e?{expr:r.pop(),set:t(e)}:n.find(r.pop(),r.length===1&&(r[0]==="~"||r[0]==="+")&&c.parentNode?c.parentNode:c,s);k=m.expr?n.filter(m.expr,m.set):
m.set;for(r.length>0?l=t(k):Q=!1;r.length;)j=M=r.pop(),p.relative[M]?j=r.pop():M="",j==null&&(j=c),p.relative[M](l,j,s)}else l=[];l||(l=k);l||n.error(M||a);if(g.call(l)==="[object Array]")if(Q)if(c&&c.nodeType===1)for(a=0;l[a]!=null;a++)l[a]&&(l[a]===!0||l[a].nodeType===1&&n.contains(c,l[a]))&&b.push(k[a]);else for(a=0;l[a]!=null;a++)l[a]&&l[a].nodeType===1&&b.push(k[a]);else b.push.apply(b,l);else t(l,b);F&&(n(F,h,b,e),n.uniqueSort(b));return b};n.uniqueSort=function(a){if(w&&(h=j,a.sort(w),h))for(var c=
1;c<a.length;c++)a[c]===a[c-1]&&a.splice(c--,1);return a};n.matches=function(a,c){return n(a,null,null,c)};n.matchesSelector=function(a,c){return n(c,null,null,[a]).length>0};n.find=function(a,c,b){var d;if(!a)return[];for(var e=0,g=p.order.length;e<g;e++){var h,j=p.order[e];if(h=p.leftMatch[j].exec(a)){var l=h[1];h.splice(1,1);if(l.substr(l.length-1)!=="\\"&&(h[1]=(h[1]||"").replace(k,""),d=p.find[j](h,c,b),d!=null)){a=a.replace(p.match[j],"");break}}}d||(d=typeof c.getElementsByTagName!="undefined"?
c.getElementsByTagName("*"):[]);return{set:d,expr:a}};n.filter=function(a,b,d,e){for(var g,h,j=a,k=[],l=b,F=b&&b[0]&&n.isXML(b[0]);a&&b.length;){for(var m in p.filter)if((g=p.leftMatch[m].exec(a))!=null&&g[2]){var M,Q,P=p.filter[m];Q=g[1];h=!1;g.splice(1,1);if(Q.substr(Q.length-1)!=="\\"){l===k&&(k=[]);if(p.preFilter[m])if(g=p.preFilter[m](g,l,d,k,e,F)){if(g===!0)continue}else h=M=!0;if(g)for(var q=0;(Q=l[q])!=null;q++)if(Q){M=P(Q,g,q,l);var r=e^!!M;d&&M!=null?r?h=!0:l[q]=!1:r&&(k.push(Q),h=!0)}if(M!==
c){d||(l=k);a=a.replace(p.match[m],"");if(!h)return[];break}}}if(a===j)if(h==null)n.error(a);else break;j=a}return l};n.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var p=n.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,
CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,c){var b=typeof c=="string",d=b&&!m.test(c),
b=b&&!d;d&&(c=c.toLowerCase());for(var d=0,e=a.length,g;d<e;d++)if(g=a[d]){for(;(g=g.previousSibling)&&g.nodeType!==1;);a[d]=b||g&&g.nodeName.toLowerCase()===c?g||!1:g===c}b&&n.filter(c,a,!0)},">":function(a,c){var b,d=typeof c=="string",e=0,g=a.length;if(d&&!m.test(c))for(c=c.toLowerCase();e<g;e++){if(b=a[e])b=b.parentNode,a[e]=b.nodeName.toLowerCase()===c?b:!1}else{for(;e<g;e++)(b=a[e])&&(a[e]=d?b.parentNode:b.parentNode===c);d&&n.filter(c,a,!0)}},"":function(c,d,g){var h,j=e++,k=a;typeof d=="string"&&
!m.test(d)&&(d=d.toLowerCase(),h=d,k=b);k("parentNode",d,j,c,h,g)},"~":function(c,d,g){var h,j=e++,k=a;typeof d=="string"&&!m.test(d)&&(d=d.toLowerCase(),h=d,k=b);k("previousSibling",d,j,c,h,g)}},find:{ID:function(a,c,b){if(typeof c.getElementById!="undefined"&&!b)return(a=c.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,c){if(typeof c.getElementsByName!="undefined"){for(var b=[],d=c.getElementsByName(a[1]),e=0,g=d.length;e<g;e++)d[e].getAttribute("name")===a[1]&&b.push(d[e]);return b.length===
0?null:b}},TAG:function(a,c){if(typeof c.getElementsByTagName!="undefined")return c.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,c,b,d,e,g){a=" "+a[1].replace(k,"")+" ";if(g)return a;for(var g=0,h;(h=c[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?b||d.push(h):b&&(c[g]=!1));return!1},ID:function(a){return a[1].replace(k,"")},TAG:function(a){return a[1].replace(k,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||n.error(a[0]);
a[2]=a[2].replace(/^\+|\s*/g,"");var c=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=c[1]+(c[2]||1)-0;a[3]=c[3]-0}else a[2]&&n.error(a[0]);a[0]=e++;return a},ATTR:function(a,c,b,d,e,g){c=a[1]=a[1].replace(k,"");!g&&p.attrMap[c]&&(a[1]=p.attrMap[c]);a[4]=(a[4]||a[5]||"").replace(k,"");a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,c,b,e,g){if(a[1]==="not")if((d.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=n(a[3],
null,null,c);else return a=n.filter(a[3],c,b,1^g),b||e.push.apply(e,a),!1;else if(p.match.POS.test(a[0])||p.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,c,b){return!!n(b[3],
a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var c=a.getAttribute("type"),b=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===b&&(c===b||c===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===
a.type},submit:function(a){var c=a.nodeName.toLowerCase();return(c==="input"||c==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var c=a.nodeName.toLowerCase();return(c==="input"||c==="button")&&"reset"===a.type},button:function(a){var c=a.nodeName.toLowerCase();return c==="input"&&"button"===a.type||c==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},
setFilters:{first:function(a,c){return c===0},last:function(a,c,b,d){return c===d.length-1},even:function(a,c){return c%2===0},odd:function(a,c){return c%2===1},lt:function(a,c,b){return c<b[3]-0},gt:function(a,c,b){return c>b[3]-0},nth:function(a,c,b){return b[3]-0===c},eq:function(a,c,b){return b[3]-0===c}},filter:{PSEUDO:function(a,c,b,d){var e=c[1],g=p.filters[e];if(g)return g(a,b,c,d);if(e==="contains")return(a.textContent||a.innerText||n.getText([a])||"").indexOf(c[3])>=0;if(e==="not"){c=c[3];
b=0;for(d=c.length;b<d;b++)if(c[b]===a)return!1;return!0}n.error(e)},CHILD:function(a,c){var b=c[1],d=a;switch(b){case "only":case "first":for(;d=d.previousSibling;)if(d.nodeType===1)return!1;if(b==="first")return!0;d=a;case "last":for(;d=d.nextSibling;)if(d.nodeType===1)return!1;return!0;case "nth":var b=c[2],e=c[3];if(b===1&&e===0)return!0;var g=c[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){for(var j=0,d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++j);h.sizcache=g}d=
a.nodeIndex-e;return b===0?d===0:d%b===0&&d/b>=0}},ID:function(a,c){return a.nodeType===1&&a.getAttribute("id")===c},TAG:function(a,c){return c==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===c},CLASS:function(a,c){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(c)>-1},ATTR:function(a,c){var b=c[1],b=p.attrHandle[b]?p.attrHandle[b](a):a[b]!=null?a[b]:a.getAttribute(b),d=b+"",e=c[2],g=c[4];return b==null?e==="!=":e==="="?d===g:e==="*="?d.indexOf(g)>=0:e==="~="?(" "+d+" ").indexOf(g)>=
0:g?e==="!="?d!==g:e==="^="?d.indexOf(g)===0:e==="$="?d.substr(d.length-g.length)===g:e==="|="?d===g||d.substr(0,g.length+1)===g+"-":!1:d&&b!==!1},POS:function(a,c,b,d){var e=p.setFilters[c[2]];if(e)return e(a,b,c,d)}}},q=p.match.POS,s=function(a,c){return"\\"+(c-0+1)},r;for(r in p.match)p.match[r]=RegExp(p.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),p.leftMatch[r]=RegExp(/(^(?:.|\r|\n)*?)/.source+p.match[r].source.replace(/\\(\d+)/g,s));var t=function(a,c){a=Array.prototype.slice.call(a,0);
return c?(c.push.apply(c,a),c):a};try{Array.prototype.slice.call(v.documentElement.childNodes,0)}catch(u){t=function(a,c){var b=0,d=c||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;b<e;b++)d.push(a[b]);else for(;a[b];b++)d.push(a[b]);return d}}var w,x;v.documentElement.compareDocumentPosition?w=function(a,c){return a===c?(h=!0,0):!a.compareDocumentPosition||!c.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(c)&
4?-1:1}:(w=function(a,c){if(a===c)return h=!0,0;if(a.sourceIndex&&c.sourceIndex)return a.sourceIndex-c.sourceIndex;var b,d,e=[],g=[];b=a.parentNode;d=c.parentNode;var j=b;if(b===d)return x(a,c);if(!b)return-1;if(!d)return 1;for(;j;)e.unshift(j),j=j.parentNode;for(j=d;j;)g.unshift(j),j=j.parentNode;b=e.length;d=g.length;for(j=0;j<b&&j<d;j++)if(e[j]!==g[j])return x(e[j],g[j]);return j===b?x(a,g[j],-1):x(e[j],c,1)},x=function(a,c,b){if(a===c)return b;for(a=a.nextSibling;a;){if(a===c)return-1;a=a.nextSibling}return 1});
n.getText=function(a){for(var c="",b,d=0;a[d];d++)b=a[d],b.nodeType===3||b.nodeType===4?c+=b.nodeValue:b.nodeType!==8&&(c+=n.getText(b.childNodes));return c};(function(){var a=v.createElement("div"),b="script"+(new Date).getTime(),d=v.documentElement;a.innerHTML="<a name='"+b+"'/>";d.insertBefore(a,d.firstChild);v.getElementById(b)&&(p.find.ID=function(a,b,d){if(typeof b.getElementById!="undefined"&&!d)return(b=b.getElementById(a[1]))?b.id===a[1]||typeof b.getAttributeNode!="undefined"&&b.getAttributeNode("id").nodeValue===
a[1]?[b]:c:[]},p.filter.ID=function(a,c){var b=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&b&&b.nodeValue===c});d.removeChild(a);d=a=null})();(function(){var a=v.createElement("div");a.appendChild(v.createComment(""));a.getElementsByTagName("*").length>0&&(p.find.TAG=function(a,c){var b=c.getElementsByTagName(a[1]);if(a[1]==="*"){for(var d=[],e=0;b[e];e++)b[e].nodeType===1&&d.push(b[e]);b=d}return b});a.innerHTML="<a href='#'></a>";a.firstChild&&typeof a.firstChild.getAttribute!=
"undefined"&&a.firstChild.getAttribute("href")!=="#"&&(p.attrHandle.href=function(a){return a.getAttribute("href",2)});a=null})();v.querySelectorAll&&function(){var a=n,c=v.createElement("div");c.innerHTML="<p class='TEST'></p>";if(!c.querySelectorAll||c.querySelectorAll(".TEST").length!==0){n=function(c,b,d,e){b=b||v;if(!e&&!n.isXML(b)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(c);if(g&&(b.nodeType===1||b.nodeType===9)){if(g[1])return t(b.getElementsByTagName(c),d);if(g[2]&&p.find.CLASS&&b.getElementsByClassName)return t(b.getElementsByClassName(g[2]),
d)}if(b.nodeType===9){if(c==="body"&&b.body)return t([b.body],d);if(g&&g[3]){var h=b.getElementById(g[3]);if(!h||!h.parentNode)return t([],d);if(h.id===g[3])return t([h],d)}try{return t(b.querySelectorAll(c),d)}catch(j){}}else if(b.nodeType===1&&b.nodeName.toLowerCase()!=="object"){var g=b,k=(h=b.getAttribute("id"))||"__sizzle__",l=b.parentNode,F=/^\s*[+~]/.test(c);h?k=k.replace(/'/g,"\\$&"):b.setAttribute("id",k);F&&l&&(b=b.parentNode);try{if(!F||l)return t(b.querySelectorAll("[id='"+k+"'] "+c),
d)}catch(m){}finally{h||g.removeAttribute("id")}}}return a(c,b,d,e)};for(var b in a)n[b]=a[b];c=null}}();(function(){var a=v.documentElement,c=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(c){var b=!c.call(v.createElement("div"),"div"),d=!1;try{c.call(v.documentElement,"[test!='']:sizzle")}catch(e){d=!0}n.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!n.isXML(a))try{if(d||!p.match.PSEUDO.test(e)&&!/!=/.test(e)){var g=c.call(a,
e);if(g||!b||a.document&&a.document.nodeType!==11)return g}}catch(h){}return n(e,null,null,[a]).length>0}}})();(function(){var a=v.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(a.getElementsByClassName&&a.getElementsByClassName("e").length!==0&&(a.lastChild.className="e",a.getElementsByClassName("e").length!==1))p.order.splice(1,0,"CLASS"),p.find.CLASS=function(a,c,b){if(typeof c.getElementsByClassName!="undefined"&&!b)return c.getElementsByClassName(a[1])},
a=null})();v.documentElement.contains?n.contains=function(a,c){return a!==c&&(a.contains?a.contains(c):!0)}:v.documentElement.compareDocumentPosition?n.contains=function(a,c){return!!(a.compareDocumentPosition(c)&16)}:n.contains=function(){return!1};n.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1};var y=function(a,c){for(var b,d=[],e="",g=c.nodeType?[c]:c;b=p.match.PSEUDO.exec(a);)e+=b[0],a=a.replace(p.match.PSEUDO,"");a=p.relative[a]?a+"*":a;b=0;for(var h=
g.length;b<h;b++)n(a,g[b],d);return n.filter(e,d)};l.find=n;l.expr=n.selectors;l.expr[":"]=l.expr.filters;l.unique=n.uniqueSort;l.text=n.getText;l.isXMLDoc=n.isXML;l.contains=n.contains})();var gb=/Until$/,hb=/^(?:parents|prevUntil|prevAll)/,ib=/,/,Va=/^.[^:#\[\.,]*$/,jb=Array.prototype.slice,ya=l.expr.match.POS,kb={children:!0,contents:!0,next:!0,prev:!0};l.fn.extend({find:function(a){var c=this,b,d;if(typeof a!="string")return l(a).filter(function(){b=0;for(d=c.length;b<d;b++)if(l.contains(c[b],
this))return!0});var e=this.pushStack("","find",a),g,h,j;b=0;for(d=this.length;b<d;b++)if(g=e.length,l.find(a,this[b],e),b>0)for(h=g;h<e.length;h++)for(j=0;j<g;j++)if(e[j]===e[h]){e.splice(h--,1);break}return e},has:function(a){var c=l(a);return this.filter(function(){for(var a=0,b=c.length;a<b;a++)if(l.contains(this,c[a]))return!0})},not:function(a){return this.pushStack(x(this,a,!1),"not",a)},filter:function(a){return this.pushStack(x(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a==
"string"?l.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,c){var b=[],d,e,g=this[0];if(l.isArray(a)){var h,j={},k=1;if(g&&a.length){d=0;for(e=a.length;d<e;d++)h=a[d],j[h]||(j[h]=ya.test(h)?l(h,c||this.context):h);for(;g&&g.ownerDocument&&g!==c;){for(h in j)d=j[h],(d.jquery?d.index(g)>-1:l(g).is(d))&&b.push({selector:h,elem:g,level:k});g=g.parentNode;k++}}return b}h=ya.test(a)||typeof a!="string"?l(a,c||this.context):0;d=0;for(e=this.length;d<e;d++)for(g=this[d];g;){if(h?h.index(g)>
-1:l.find.matchesSelector(g,a)){b.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===c||g.nodeType===11)break}b=b.length>1?l.unique(b):b;return this.pushStack(b,"closest",a)},index:function(a){return!a||typeof a=="string"?l.inArray(this[0],a?l(a):this.parent().children()):l.inArray(a.jquery?a[0]:a,this)},add:function(a,c){var b=typeof a=="string"?l(a,c):l.makeArray(a&&a.nodeType?[a]:a),d=l.merge(this.get(),b);return this.pushStack(!b[0]||!b[0].parentNode||b[0].parentNode.nodeType===11||!d[0]||
!d[0].parentNode||d[0].parentNode.nodeType===11?d:l.unique(d))},andSelf:function(){return this.add(this.prevObject)}});l.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return l.dir(a,"parentNode")},parentsUntil:function(a,c,b){return l.dir(a,"parentNode",b)},next:function(a){return l.nth(a,2,"nextSibling")},prev:function(a){return l.nth(a,2,"previousSibling")},nextAll:function(a){return l.dir(a,"nextSibling")},prevAll:function(a){return l.dir(a,"previousSibling")},
nextUntil:function(a,c,b){return l.dir(a,"nextSibling",b)},prevUntil:function(a,c,b){return l.dir(a,"previousSibling",b)},siblings:function(a){return l.sibling(a.parentNode.firstChild,a)},children:function(a){return l.sibling(a.firstChild)},contents:function(a){return l.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:l.makeArray(a.childNodes)}},function(a,c){l.fn[a]=function(b,d){var e=l.map(this,c,b),g=jb.call(arguments);gb.test(a)||(d=b);d&&typeof d=="string"&&(e=l.filter(d,e));
e=this.length>1&&!kb[a]?l.unique(e):e;(this.length>1||ib.test(d))&&hb.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}});l.extend({filter:function(a,c,b){b&&(a=":not("+a+")");return c.length===1?l.find.matchesSelector(c[0],a)?[c[0]]:[]:l.find.matches(a,c)},dir:function(a,b,d){for(var e=[],a=a[b];a&&a.nodeType!==9&&(d===c||a.nodeType!==1||!l(a).is(d));)a.nodeType===1&&e.push(a),a=a[b];return e},nth:function(a,c,b){for(var c=c||1,d=0;a;a=a[b])if(a.nodeType===1&&++d===c)break;return a},
sibling:function(a,c){for(var b=[];a;a=a.nextSibling)a.nodeType===1&&a!==c&&b.push(a);return b}});var lb=/ jQuery\d+="(?:\d+|null)"/g,ma=/^\s+/,za=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Aa=/<([\w:]+)/,mb=/<tbody/i,nb=/<|&#?\w+;/,Ba=/<(?:script|object|embed|option|style)/i,Ca=/checked\s*(?:[^=]|=\s*.checked.)/i,ob=/\/(java|ecma)script/i,Ua=/^\s*<!(?:\[CDATA\[|\-\-)/,K={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,
"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};K.optgroup=K.option;K.tbody=K.tfoot=K.colgroup=K.caption=K.thead;K.th=K.td;l.support.htmlSerialize||(K._default=[1,"div<div>","</div>"]);l.fn.extend({text:function(a){return l.isFunction(a)?this.each(function(c){var b=l(this);b.text(a.call(this,c,b.text()))}):typeof a!="object"&&
a!==c?this.empty().append((this[0]&&this[0].ownerDocument||v).createTextNode(a)):l.text(this)},wrapAll:function(a){if(l.isFunction(a))return this.each(function(c){l(this).wrapAll(a.call(this,c))});if(this[0]){var c=l(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&c.insertBefore(this[0]);c.map(function(){for(var a=this;a.firstChild&&a.firstChild.nodeType===1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return l.isFunction(a)?this.each(function(c){l(this).wrapInner(a.call(this,
c))}):this.each(function(){var c=l(this),b=c.contents();b.length?b.wrapAll(a):c.append(a)})},wrap:function(a){return this.each(function(){l(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){l.nodeName(this,"body")||l(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},
before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=l(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,l(arguments[0]).toArray());
return a}},remove:function(a,c){for(var b=0,d;(d=this[b])!=null;b++)if(!a||l.filter(a,[d]).length)!c&&d.nodeType===1&&(l.cleanData(d.getElementsByTagName("*")),l.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,c;(c=this[a])!=null;a++)for(c.nodeType===1&&l.cleanData(c.getElementsByTagName("*"));c.firstChild;)c.removeChild(c.firstChild);return this},clone:function(a,c){a=a==null?!1:a;c=c==null?a:c;return this.map(function(){return l.clone(this,a,c)})},
html:function(a){if(a===c)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(lb,""):null;if(typeof a=="string"&&!Ba.test(a)&&(l.support.leadingWhitespace||!ma.test(a))&&!K[(Aa.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(za,"<$1></$2>");try{for(var b=0,d=this.length;b<d;b++)this[b].nodeType===1&&(l.cleanData(this[b].getElementsByTagName("*")),this[b].innerHTML=a)}catch(e){this.empty().append(a)}}else l.isFunction(a)?this.each(function(c){var b=l(this);b.html(a.call(this,c,b.html()))}):
this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(l.isFunction(a))return this.each(function(c){var b=l(this),d=b.html();b.replaceWith(a.call(this,c,d))});typeof a!="string"&&(a=l(a).detach());return this.each(function(){var c=this.nextSibling,b=this.parentNode;l(this).remove();c?l(c).before(a):l(b).append(a)})}return this.length?this.pushStack(l(l.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,
b,d){var e,g,h,j=a[0],k=[];if(!l.support.checkClone&&arguments.length===3&&typeof j=="string"&&Ca.test(j))return this.each(function(){l(this).domManip(a,b,d,!0)});if(l.isFunction(j))return this.each(function(e){var g=l(this);a[0]=j.call(this,e,b?g.html():c);g.domManip(a,b,d)});if(this[0]){h=j&&j.parentNode;l.support.parentNode&&h&&h.nodeType===11&&h.childNodes.length===this.length?e={fragment:h}:e=l.buildFragment(a,this,k);h=e.fragment;h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){b=
b&&l.nodeName(g,"tr");g=0;for(var m=this.length,n=m-1;g<m;g++)d.call(b?l.nodeName(this[g],"table")?this[g].getElementsByTagName("tbody")[0]||this[g].appendChild(this[g].ownerDocument.createElement("tbody")):this[g]:this[g],e.cacheable||m>1&&g<n?l.clone(h,!0,!0):h)}k.length&&l.each(k,q)}return this}});l.buildFragment=function(a,c,b){var d,e,g,h;c&&c[0]&&(h=c[0].ownerDocument||c[0]);h.createDocumentFragment||(h=v);a.length===1&&typeof a[0]=="string"&&a[0].length<512&&h===v&&a[0].charAt(0)==="<"&&!Ba.test(a[0])&&
(l.support.checkClone||!Ca.test(a[0]))&&(e=!0,g=l.fragments[a[0]],g&&g!==1&&(d=g));d||(d=h.createDocumentFragment(),l.clean(a,h,d,b));e&&(l.fragments[a[0]]=g?d:1);return{fragment:d,cacheable:e}};l.fragments={};l.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,c){l.fn[a]=function(b){var d=[],b=l(b),e=this.length===1&&this[0].parentNode;if(e&&e.nodeType===11&&e.childNodes.length===1&&b.length===1)return b[c](this[0]),this;for(var e=
0,g=b.length;e<g;e++){var h=(e>0?this.clone(!0):this).get();l(b[e])[c](h);d=d.concat(h)}return this.pushStack(d,a,b.selector)}});l.extend({clone:function(a,c,b){var d=a.cloneNode(!0),e,g,h;if((!l.support.noCloneEvent||!l.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!l.isXMLDoc(a)){t(a,d);e=u(a);g=u(d);for(h=0;e[h];++h)t(e[h],g[h])}if(c&&(w(a,d),b)){e=u(a);g=u(d);for(h=0;e[h];++h)w(e[h],g[h])}return d},clean:function(a,c,b,d){c=c||v;typeof c.createElement=="undefined"&&(c=c.ownerDocument||
c[0]&&c[0].ownerDocument||v);for(var e=[],g,h=0,j;(j=a[h])!=null;h++)if(typeof j=="number"&&(j+=""),j){if(typeof j=="string")if(nb.test(j)){j=j.replace(za,"<$1></$2>");g=(Aa.exec(j)||["",""])[1].toLowerCase();var k=K[g]||K._default,m=k[0],n=c.createElement("div");for(n.innerHTML=k[1]+j+k[2];m--;)n=n.lastChild;if(!l.support.tbody){m=mb.test(j);k=g==="table"&&!m?n.firstChild&&n.firstChild.childNodes:k[1]==="<table>"&&!m?n.childNodes:[];for(g=k.length-1;g>=0;--g)l.nodeName(k[g],"tbody")&&!k[g].childNodes.length&&
k[g].parentNode.removeChild(k[g])}!l.support.leadingWhitespace&&ma.test(j)&&n.insertBefore(c.createTextNode(ma.exec(j)[0]),n.firstChild);j=n.childNodes}else j=c.createTextNode(j);var q;if(!l.support.appendChecked)if(j[0]&&typeof(q=j.length)=="number")for(g=0;g<q;g++)p(j[g]);else p(j);j.nodeType?e.push(j):e=l.merge(e,j)}if(b){a=function(a){return!a.type||ob.test(a.type)};for(h=0;e[h];h++)d&&l.nodeName(e[h],"script")&&(!e[h].type||e[h].type.toLowerCase()==="text/javascript")?d.push(e[h].parentNode?
e[h].parentNode.removeChild(e[h]):e[h]):(e[h].nodeType===1&&(c=l.grep(e[h].getElementsByTagName("script"),a),e.splice.apply(e,[h+1,0].concat(c))),b.appendChild(e[h]))}return e},cleanData:function(a){for(var c,b,d=l.cache,e=l.expando,g=l.event.special,h=l.support.deleteExpando,j=0,k;(k=a[j])!=null;j++)if(!k.nodeName||!l.noData[k.nodeName.toLowerCase()])if(b=k[l.expando]){if((c=d[b]&&d[b][e])&&c.events){for(var m in c.events)g[m]?l.event.remove(k,m):l.removeEvent(k,m,c.handle);c.handle&&(c.handle.elem=
null)}h?delete k[l.expando]:k.removeAttribute&&k.removeAttribute(l.expando);delete d[b]}}});var Da=/alpha\([^)]*\)/i,pb=/opacity=([^)]*)/,qb=/([A-Z]|^ms)/g,Ea=/^-?\d+(?:px)?$/i,rb=/^-?\d/,sb=/^[+\-]=/,ub=/[^+\-\.\de]+/g,vb={position:"absolute",visibility:"hidden",display:"block"},Sa=["Left","Right"],Ta=["Top","Bottom"],V,Fa,Ga;l.fn.css=function(a,b){return arguments.length===2&&b===c?this:l.access(this,a,b,!0,function(a,b,d){return d!==c?l.style(a,b,d):l.css(a,b)})};l.extend({cssHooks:{opacity:{get:function(a,
c){if(c){var b=V(a,"opacity","opacity");return b===""?"1":b}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":l.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,d,e){if(a&&a.nodeType!==3&&a.nodeType!==8&&a.style){var g,h=l.camelCase(b),j=a.style,k=l.cssHooks[h],b=l.cssProps[h]||h;if(d===c)return k&&"get"in k&&(g=k.get(a,!1,e))!==c?g:j[b];e=typeof d;if(!(e==="number"&&isNaN(d)||d==null))if(e===
"string"&&sb.test(d)&&(d=+d.replace(ub,"")+parseFloat(l.css(a,b)),e="number"),e==="number"&&!l.cssNumber[h]&&(d+="px"),!k||!("set"in k)||(d=k.set(a,d))!==c)try{j[b]=d}catch(m){}}},css:function(a,b,d){var e,g,b=l.camelCase(b);g=l.cssHooks[b];b=l.cssProps[b]||b;b==="cssFloat"&&(b="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==c)return e;if(V)return V(a,b)},swap:function(a,c,b){var d={},e;for(e in c)d[e]=a.style[e],a.style[e]=c[e];b.call(a);for(e in c)a.style[e]=d[e]}});l.curCSS=l.css;l.each(["height",
"width"],function(a,c){l.cssHooks[c]={get:function(a,b,d){var e;if(b){if(a.offsetWidth!==0)return s(a,c,d);l.swap(a,vb,function(){e=s(a,c,d)});return e}},set:function(a,c){if(!Ea.test(c))return c;c=parseFloat(c);if(c>=0)return c+"px"}}});l.support.opacity||(l.cssHooks.opacity={get:function(a,c){return pb.test((c&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":c?"1":""},set:function(a,c){var b=a.style,d=a.currentStyle;b.zoom=1;var e=l.isNaN(c)?"":"alpha(opacity="+
c*100+")",d=d&&d.filter||b.filter||"";b.filter=Da.test(d)?d.replace(Da,e):d+" "+e}});l(function(){l.support.reliableMarginRight||(l.cssHooks.marginRight={get:function(a,c){var b;l.swap(a,{display:"inline-block"},function(){c?b=V(a,"margin-right","marginRight"):b=a.style.marginRight});return b}})});v.defaultView&&v.defaultView.getComputedStyle&&(Fa=function(a,b){var d,e,b=b.replace(qb,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return c;if(e=e.getComputedStyle(a,null))d=e.getPropertyValue(b),
d===""&&!l.contains(a.ownerDocument.documentElement,a)&&(d=l.style(a,b));return d});v.documentElement.currentStyle&&(Ga=function(a,c){var b,d=a.currentStyle&&a.currentStyle[c],e=a.runtimeStyle&&a.runtimeStyle[c],g=a.style;!Ea.test(d)&&rb.test(d)&&(b=g.left,e&&(a.runtimeStyle.left=a.currentStyle.left),g.left=c==="fontSize"?"1em":d||0,d=g.pixelLeft+"px",g.left=b,e&&(a.runtimeStyle.left=e));return d===""?"auto":d});V=Fa||Ga;l.expr&&l.expr.filters&&(l.expr.filters.hidden=function(a){var c=a.offsetHeight;
return a.offsetWidth===0&&c===0||!l.support.reliableHiddenOffsets&&(a.style.display||l.css(a,"display"))==="none"},l.expr.filters.visible=function(a){return!l.expr.filters.hidden(a)});var wb=/%20/g,Ra=/\[\]$/,Ha=/\r?\n/g,xb=/#.*$/,yb=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,zb=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Ab=/^(?:GET|HEAD)$/,Bb=/^\/\//,Ia=/\?/,Cb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Db=/^(?:select|textarea)/i,sa=/\s+/,
Eb=/([?&])_=[^&]*/,Ja=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ka=l.fn.load,ha={},La={},O,R;try{O=C.href}catch(Kb){O=v.createElement("a"),O.href="",O=O.href}R=Ja.exec(O.toLowerCase())||[];l.fn.extend({load:function(a,b,d){if(typeof a!="string"&&Ka)return Ka.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0)var g=a.slice(e,a.length),a=a.slice(0,e);e="GET";b&&(l.isFunction(b)?(d=b,b=c):typeof b=="object"&&(b=l.param(b,l.ajaxSettings.traditional),e="POST"));var h=
this;l.ajax({url:a,type:e,dataType:"html",data:b,complete:function(a,c,b){b=a.responseText;a.isResolved()&&(a.done(function(a){b=a}),h.html(g?l("<div>").append(b.replace(Cb,"")).find(g):b));d&&h.each(d,[b,c,a])}});return this},serialize:function(){return l.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?l.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Db.test(this.nodeName)||zb.test(this.type))}).map(function(a,
c){var b=l(this).val();return b==null?null:l.isArray(b)?l.map(b,function(a){return{name:c.name,value:a.replace(Ha,"\r\n")}}):{name:c.name,value:b.replace(Ha,"\r\n")}}).get()}});l.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,c){l.fn[c]=function(a){return this.bind(c,a)}});l.each(["get","post"],function(a,b){l[b]=function(a,d,e,g){l.isFunction(d)&&(g=g||e,e=d,d=c);return l.ajax({type:b,url:a,data:d,success:e,dataType:g})}});l.extend({getScript:function(a,
b){return l.get(a,c,b,"script")},getJSON:function(a,c,b){return l.get(a,c,b,"json")},ajaxSetup:function(a,c){c?l.extend(!0,a,l.ajaxSettings,c):(c=a,a=l.extend(!0,l.ajaxSettings,c));for(var b in{context:1,url:1})b in c?a[b]=c[b]:b in l.ajaxSettings&&(a[b]=l.ajaxSettings[b]);return a},ajaxSettings:{url:O,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|widget):$/.test(R[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",
html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":l.parseJSON,"text xml":l.parseXML}},ajaxPrefilter:n(ha),ajaxTransport:n(La),ajax:function(a,b){function d(a,b,m,q){if(x!==2){x=2;v&&clearTimeout(v);u=c;s=q||"";A.readyState=a?4:0;var r,F,t;if(m){var q=e,M=A,w=q.contents,z=q.dataTypes,P=q.responseFields,B,C,
D,E;for(C in P)C in m&&(M[P[C]]=m[C]);for(;z[0]==="*";)z.shift(),B===c&&(B=q.mimeType||M.getResponseHeader("content-type"));if(B)for(C in w)if(w[C]&&w[C].test(B)){z.unshift(C);break}if(z[0]in m)D=z[0];else{for(C in m){if(!z[0]||q.converters[C+" "+z[0]]){D=C;break}E||(E=C)}D=D||E}D?(D!==z[0]&&z.unshift(D),m=m[D]):m=void 0}else m=c;if(a>=200&&a<300||a===304){if(e.ifModified){if(B=A.getResponseHeader("Last-Modified"))l.lastModified[p]=B;if(B=A.getResponseHeader("Etag"))l.etag[p]=B}if(a===304)b="notmodified",
r=!0;else try{B=e;B.dataFilter&&(m=B.dataFilter(m,B.dataType));var H=B.dataTypes;C={};var G,I,Ya=H.length,J,T=H[0],K,N,S,L,O;for(G=1;G<Ya;G++){if(G===1)for(I in B.converters)typeof I=="string"&&(C[I.toLowerCase()]=B.converters[I]);K=T;T=H[G];if(T==="*")T=K;else if(K!=="*"&&K!==T){N=K+" "+T;S=C[N]||C["* "+T];if(!S)for(L in O=c,C)if(J=L.split(" "),J[0]===K||J[0]==="*")if(O=C[J[1]+" "+T]){L=C[L];L===!0?S=O:O===!0&&(S=L);break}!S&&!O&&l.error("No conversion from "+N.replace(" "," to "));S!==!0&&(m=S?
S(m):O(L(m)))}}F=m;b="success";r=!0}catch(R){b="parsererror",t=R}}else if(t=b,!b||a)b="error",a<0&&(a=0);A.status=a;A.statusText=b;r?j.resolveWith(g,[F,b,A]):j.rejectWith(g,[A,b,t]);A.statusCode(n);n=c;y&&h.trigger("ajax"+(r?"Success":"Error"),[A,e,r?F:t]);k.resolveWith(g,[A,b]);y&&(h.trigger("ajaxComplete",[A,e]),--l.active||l.event.trigger("ajaxStop"))}}typeof a=="object"&&(b=a,a=c);var b=b||{},e=l.ajaxSetup({},b),g=e.context||e,h=g!==e&&(g.nodeType||g instanceof l)?l(g):l.event,j=l.Deferred(),
k=l._Deferred(),n=e.statusCode||{},p,q={},r={},s,t,u,v,w,x=0,y,z,A={readyState:0,setRequestHeader:function(a,b){if(!x){var c=a.toLowerCase(),a=r[c]=r[c]||a;q[a]=b}return this},getAllResponseHeaders:function(){return x===2?s:null},getResponseHeader:function(a){var b;if(x===2){if(!t)for(t={};b=yb.exec(s);)t[b[1].toLowerCase()]=b[2];b=t[a.toLowerCase()]}return b===c?null:b},overrideMimeType:function(a){x||(e.mimeType=a);return this},abort:function(a){a=a||"abort";u&&u.abort(a);d(0,a);return this}};j.promise(A);
A.success=A.done;A.error=A.fail;A.complete=k.done;A.statusCode=function(a){if(a){var b;if(x<2)for(b in a)n[b]=[n[b],a[b]];else b=a[A.status],A.then(b,b)}return this};e.url=((a||e.url)+"").replace(xb,"").replace(Bb,R[1]+"//");e.dataTypes=l.trim(e.dataType||"*").toLowerCase().split(sa);e.crossDomain==null&&(w=Ja.exec(e.url.toLowerCase()),e.crossDomain=!(!w||w[1]==R[1]&&w[2]==R[2]&&(w[3]||(w[1]==="http:"?80:443))==(R[3]||(R[1]==="http:"?80:443))));e.data&&e.processData&&typeof e.data!="string"&&(e.data=
l.param(e.data,e.traditional));m(ha,e,b,A);if(x===2)return!1;y=e.global;e.type=e.type.toUpperCase();e.hasContent=!Ab.test(e.type);y&&l.active++===0&&l.event.trigger("ajaxStart");if(!e.hasContent&&(e.data&&(e.url+=(Ia.test(e.url)?"&":"?")+e.data),p=e.url,e.cache===!1)){w=l.now();var B=e.url.replace(Eb,"$1_="+w);e.url=B+(B===e.url?(Ia.test(e.url)?"&":"?")+"_="+w:"")}(e.data&&e.hasContent&&e.contentType!==!1||b.contentType)&&A.setRequestHeader("Content-Type",e.contentType);e.ifModified&&(p=p||e.url,
l.lastModified[p]&&A.setRequestHeader("If-Modified-Since",l.lastModified[p]),l.etag[p]&&A.setRequestHeader("If-None-Match",l.etag[p]));A.setRequestHeader("Accept",e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+(e.dataTypes[0]!=="*"?", */*; q=0.01":""):e.accepts["*"]);for(z in e.headers)A.setRequestHeader(z,e.headers[z]);if(e.beforeSend&&(e.beforeSend.call(g,A,e)===!1||x===2))return A.abort(),!1;for(z in{success:1,error:1,complete:1})A[z](e[z]);if(u=m(La,e,b,A)){A.readyState=1;
y&&h.trigger("ajaxSend",[A,e]);e.async&&e.timeout>0&&(v=setTimeout(function(){A.abort("timeout")},e.timeout));try{x=1,u.send(q,d)}catch(C){status<2?d(-1,C):l.error(C)}}else d(-1,"No Transport");return A},param:function(a,b){var d=[],e=function(a,b){b=l.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};b===c&&(b=l.ajaxSettings.traditional);if(l.isArray(a)||a.jquery&&!l.isPlainObject(a))l.each(a,function(){e(this.name,this.value)});else for(var g in a)k(g,a[g],b,e);return d.join("&").replace(wb,
"+")}});l.extend({active:0,lastModified:{},etag:{}});var Fb=l.now(),ea=/(\=)\?(&|$)|\?\?/i;l.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return l.expando+"_"+Fb++}});l.ajaxPrefilter("json jsonp",function(b,c,d){c=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ea.test(b.url)||c&&ea.test(b.data))){var e,g=b.jsonpCallback=l.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h=a[g],j=b.url,k=b.data,m="$1"+g+
"$2";b.jsonp!==!1&&(j=j.replace(ea,m),b.url===j&&(c&&(k=k.replace(ea,m)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+g)));b.url=j;b.data=k;a[g]=function(a){e=[a]};d.always(function(){a[g]=h;e&&l.isFunction(h)&&a[g](e[0])});b.converters["script json"]=function(){e||l.error(g+" was not called");return e[0]};b.dataTypes[0]="json";return"script"}});l.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},
converters:{"text script":function(a){l.globalEval(a);return a}}});l.ajaxPrefilter("script",function(a){a.cache===c&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});l.ajaxTransport("script",function(a){if(a.crossDomain){var b,d=v.head||v.getElementsByTagName("head")[0]||v.documentElement;return{send:function(e,g){b=v.createElement("script");b.async="async";a.scriptCharset&&(b.charset=a.scriptCharset);b.src=a.url;b.onload=b.onreadystatechange=function(a,e){if(e||!b.readyState||/loaded|complete/.test(b.readyState))b.onload=
b.onreadystatechange=null,d&&b.parentNode&&d.removeChild(b),b=c,e||g(200,"success")};d.insertBefore(b,d.firstChild)},abort:function(){b&&b.onload(0,1)}}}});var na=a.ActiveXObject?function(){for(var a in X)X[a](0,1)}:!1,Gb=0,X;l.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&j()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:j;(function(a){l.extend(l.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})})(l.ajaxSettings.xhr());l.support.ajax&&
l.ajaxTransport(function(b){if(!b.crossDomain||l.support.cors){var d;return{send:function(e,g){var h=b.xhr(),j,k;b.username?h.open(b.type,b.url,b.async,b.username,b.password):h.open(b.type,b.url,b.async);if(b.xhrFields)for(k in b.xhrFields)h[k]=b.xhrFields[k];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType);!b.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(k in e)h.setRequestHeader(k,e[k])}catch(m){}h.send(b.hasContent&&b.data||null);d=function(a,
e){var k,m,n,p,q;try{if(d&&(e||h.readyState===4))if(d=c,j&&(h.onreadystatechange=l.noop,na&&delete X[j]),e)h.readyState!==4&&h.abort();else{k=h.status;n=h.getAllResponseHeaders();p={};(q=h.responseXML)&&q.documentElement&&(p.xml=q);p.text=h.responseText;try{m=h.statusText}catch(r){m=""}!k&&b.isLocal&&!b.crossDomain?k=p.text?200:404:k===1223&&(k=204)}}catch(s){e||g(-1,s)}p&&g(k,m,p,n)};!b.async||h.readyState===4?d():(j=++Gb,na&&(X||(X={},l(a).unload(na)),X[j]=d),h.onreadystatechange=d)},abort:function(){d&&
d(0,1)}}}});var ga={},N,U,Hb=/^(?:toggle|show|hide)$/,Ib=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Y,ra=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],ba,oa=a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame;l.fn.extend({show:function(a,b,c){var g;if(a||a===0)return this.animate(e("show",3),a,b,c);b=0;for(c=this.length;b<c;b++)a=this[b],a.style&&(g=a.style.display,!l._data(a,
"olddisplay")&&g==="none"&&(g=a.style.display=""),g===""&&l.css(a,"display")==="none"&&l._data(a,"olddisplay",d(a.nodeName)));for(b=0;b<c;b++)if(a=this[b],a.style&&(g=a.style.display,g===""||g==="none"))a.style.display=l._data(a,"olddisplay")||"";return this},hide:function(a,b,c){if(a||a===0)return this.animate(e("hide",3),a,b,c);a=0;for(b=this.length;a<b;a++)this[a].style&&(c=l.css(this[a],"display"),c!=="none"&&!l._data(this[a],"olddisplay")&&l._data(this[a],"olddisplay",c));for(a=0;a<b;a++)this[a].style&&
(this[a].style.display="none");return this},_toggle:l.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";l.isFunction(a)&&l.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:l(this).is(":hidden");l(this)[b?"show":"hide"]()}):this.animate(e("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,e){var g=l.speed(b,c,e);if(l.isEmptyObject(a))return this.each(g.complete,
[!1]);a=l.extend({},a);return this[g.queue===!1?"each":"queue"](function(){var F;g.queue===!1&&l._mark(this);var b=l.extend({},g),c=this.nodeType===1,e=c&&l(this).is(":hidden"),h,j,k,m,n,p,q,r;b.animatedProperties={};for(k in a){h=l.camelCase(k);k!==h&&(a[h]=a[k],delete a[k]);j=a[h];l.isArray(j)?(b.animatedProperties[h]=j[1],F=a[h]=j[0],j=F):b.animatedProperties[h]=b.specialEasing&&b.specialEasing[h]||b.easing||"swing";if(j==="hide"&&e||j==="show"&&!e)return b.complete.call(this);c&&(h==="height"||
h==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],l.css(this,"display")==="inline"&&l.css(this,"float")==="none"&&(l.support.inlineBlockNeedsLayout?(m=d(this.nodeName),m==="inline"?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}b.overflow!=null&&(this.style.overflow="hidden");for(k in a)c=new l.fx(this,b,k),j=a[k],Hb.test(j)?c[j==="toggle"?e?"show":"hide":j]():(n=Ib.exec(j),p=c.cur(),n?
(q=parseFloat(n[2]),r=n[3]||(l.cssNumber[k]?"":"px"),r!=="px"&&(l.style(this,k,(q||1)+r),p*=(q||1)/c.cur(),l.style(this,k,p+r)),n[1]&&(q=(n[1]==="-="?-1:1)*q+p),c.custom(p,q,r)):c.custom(p,j,""));return!0})},stop:function(a,b){a&&this.queue([]);this.each(function(){var a=l.timers,c=a.length;for(b||l._unmark(!0,this);c--;)a[c].elem===this&&(b&&a[c](!0),a.splice(c,1))});b||this.dequeue();return this}});l.each({slideDown:e("show",1),slideUp:e("hide",1),slideToggle:e("toggle",1),fadeIn:{opacity:"show"},
fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){l.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});l.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?l.extend({},a):{complete:c||!c&&b||l.isFunction(a)&&a,duration:a,easing:c&&b||b&&!l.isFunction(b)&&b};d.duration=l.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in l.fx.speeds?l.fx.speeds[d.duration]:l.fx.speeds._default;d.old=d.complete;d.complete=function(a){l.isFunction(d.old)&&d.old.call(this);d.queue!==
!1?l.dequeue(this):a!==!1&&l._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});l.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(l.fx.step[this.prop]||l.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];
var a,b=l.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,b,c){function d(a){return e.step(a)}var e=this,g=l.fx,j;this.startTime=ba||h();this.start=a;this.end=b;this.unit=c||this.unit||(l.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;d.elem=this.elem;d()&&l.timers.push(d)&&!Y&&(oa?(Y=!0,j=function(){Y&&(oa(j),g.tick())},oa(j)):Y=setInterval(g.tick,g.interval))},show:function(){this.options.orig[this.prop]=l.style(this.elem,this.prop);
this.options.show=!0;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());l(this.elem).show()},hide:function(){this.options.orig[this.prop]=l.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b=ba||h(),c=!0,d=this.elem,e=this.options,g,j;if(a||b>=e.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();e.animatedProperties[this.prop]=!0;for(g in e.animatedProperties)e.animatedProperties[g]!==!0&&(c=!1);if(c){e.overflow!=
null&&!l.support.shrinkWrapBlocks&&l.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]});e.hide&&l(d).hide();if(e.hide||e.show)for(var k in e.animatedProperties)l.style(d,k,e.orig[k]);e.complete.call(d)}return!1}e.duration==Infinity?this.now=b:(j=b-this.startTime,this.state=j/e.duration,this.pos=l.easing[e.animatedProperties[this.prop]](this.state,j,0,1,e.duration),this.now=this.start+(this.end-this.start)*this.pos);this.update();return!0}};l.extend(l.fx,{tick:function(){for(var a=
l.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||l.fx.stop()},interval:13,stop:function(){clearInterval(Y);Y=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){l.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}});l.expr&&l.expr.filters&&(l.expr.filters.animated=function(a){return l.grep(l.timers,function(b){return a===
b.elem}).length});var Jb=/^t(?:able|d|h)$/i,Ma=/^(?:body|html)$/i;"getBoundingClientRect"in v.documentElement?l.fn.offset=function(a){var c=this[0],d;if(a)return this.each(function(b){l.offset.setOffset(this,a,b)});if(!c||!c.ownerDocument)return null;if(c===c.ownerDocument.body)return l.offset.bodyOffset(c);try{d=c.getBoundingClientRect()}catch(e){}var g=c.ownerDocument,h=g.documentElement;if(!d||!l.contains(h,c))return d?{top:d.top,left:d.left}:{top:0,left:0};c=g.body;g=b(g);return{top:d.top+(g.pageYOffset||
l.support.boxModel&&h.scrollTop||c.scrollTop)-(h.clientTop||c.clientTop||0),left:d.left+(g.pageXOffset||l.support.boxModel&&h.scrollLeft||c.scrollLeft)-(h.clientLeft||c.clientLeft||0)}}:l.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){l.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return l.offset.bodyOffset(b);l.offset.initialize();var c,d=b.offsetParent,e=b.ownerDocument,g=e.documentElement,h=e.body;c=(e=e.defaultView)?e.getComputedStyle(b,
null):b.currentStyle;for(var j=b.offsetTop,k=b.offsetLeft;(b=b.parentNode)&&b!==h&&b!==g;){if(l.offset.supportsFixedPosition&&c.position==="fixed")break;c=e?e.getComputedStyle(b,null):b.currentStyle;j-=b.scrollTop;k-=b.scrollLeft;b===d&&(j+=b.offsetTop,k+=b.offsetLeft,l.offset.doesNotAddBorder&&(!l.offset.doesAddBorderForTableAndCells||!Jb.test(b.nodeName))&&(j+=parseFloat(c.borderTopWidth)||0,k+=parseFloat(c.borderLeftWidth)||0),d=b.offsetParent);l.offset.subtractsBorderForOverflowNotVisible&&c.overflow!==
"visible"&&(j+=parseFloat(c.borderTopWidth)||0,k+=parseFloat(c.borderLeftWidth)||0)}if(c.position==="relative"||c.position==="static")j+=h.offsetTop,k+=h.offsetLeft;l.offset.supportsFixedPosition&&c.position==="fixed"&&(j+=Math.max(g.scrollTop,h.scrollTop),k+=Math.max(g.scrollLeft,h.scrollLeft));return{top:j,left:k}};l.offset={initialize:function(){var a=v.body,b=v.createElement("div"),c,d,e,g=parseFloat(l.css(a,"marginTop"))||0;l.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,
width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,a.firstChild);c=b.firstChild;d=c.firstChild;e=c.nextSibling.firstChild.firstChild;this.doesNotAddBorder=d.offsetTop!==5;this.doesAddBorderForTableAndCells=
e.offsetTop===5;d.style.position="fixed";d.style.top="20px";this.supportsFixedPosition=d.offsetTop===20||d.offsetTop===15;d.style.position=d.style.top="";c.style.overflow="hidden";c.style.position="relative";this.subtractsBorderForOverflowNotVisible=d.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==g;a.removeChild(b);l.offset.initialize=l.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;l.offset.initialize();l.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(l.css(a,
"marginTop"))||0,c+=parseFloat(l.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=l.css(a,"position");d==="static"&&(a.style.position="relative");var e=l(a),g=e.offset(),h=l.css(a,"top"),j=l.css(a,"left"),k={},m={},n,p;(d==="absolute"||d==="fixed")&&l.inArray("auto",[h,j])>-1?(m=e.position(),n=m.top,p=m.left):(n=parseFloat(h)||0,p=parseFloat(j)||0);l.isFunction(b)&&(b=b.call(a,c,g));b.top!=null&&(k.top=b.top-g.top+n);b.left!=null&&(k.left=b.left-g.left+p);"using"in b?
b.using.call(a,k):e.css(k)}};l.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=Ma.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(l.css(a,"marginTop"))||0;c.left-=parseFloat(l.css(a,"marginLeft"))||0;d.top+=parseFloat(l.css(b[0],"borderTopWidth"))||0;d.left+=parseFloat(l.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||
v.body;a&&!Ma.test(a.nodeName)&&l.css(a,"position")==="static";)a=a.offsetParent;return a})}});l.each(["Left","Top"],function(a,d){var e="scroll"+d;l.fn[e]=function(d){var g,h;return d===c?(g=this[0],!g?null:(h=b(g))?"pageXOffset"in h?h[a?"pageYOffset":"pageXOffset"]:l.support.boxModel&&h.document.documentElement[e]||h.document.body[e]:g[e]):this.each(function(){(h=b(this))?h.scrollTo(a?l(h).scrollLeft():d,a?d:l(h).scrollTop()):this[e]=d})}});l.each(["Height","Width"],function(a,b){var d=b.toLowerCase();
l.fn["inner"+b]=function(){var a=this[0];return a&&a.style?parseFloat(l.css(a,d,"padding")):null};l.fn["outer"+b]=function(a){var b=this[0];return b&&b.style?parseFloat(l.css(b,d,a?"margin":"border")):null};l.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(l.isFunction(a))return this.each(function(b){var c=l(this);c[d](a.call(this,b,c[d]()))});if(l.isWindow(e)){var g=e.document.documentElement["client"+b];return e.document.compatMode==="CSS1Compat"&&g||e.document.body["client"+b]||
g}return e.nodeType===9?Math.max(e.documentElement["client"+b],e.body["scroll"+b],e.documentElement["scroll"+b],e.body["offset"+b],e.documentElement["offset"+b]):a===c?(e=l.css(e,d),g=parseFloat(e),l.isNaN(g)?e:g):this.css(d,typeof a=="string"?a:a+"px")}});a.jQuery=a.$=l})(window);
